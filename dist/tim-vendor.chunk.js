"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk"] = self["webpackChunk"] || []).push([["tim-vendor"],{

/***/ "./node_modules/tim-js-sdk/tim-js.js":
/*!*******************************************!*\
  !*** ./node_modules/tim-js-sdk/tim-js.js ***!
  \*******************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval("!function(e,t){ true?module.exports=t():0}(this,(function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){i(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&c(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,n){return(d=l()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var s=new(Function.bind.apply(e,o));return n&&c(s,n.prototype),s}).apply(null,arguments)}function p(e){var t=\"function\"==typeof Map?new Map:void 0;return(p=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf(\"[native code]\")))return e;var n;if(\"function\"!=typeof e)throw new TypeError(\"Super expression must either be null or a function\");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return d(e,arguments,u(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),c(o,e)})(e)}function g(e,t){if(null==e)return{};var n,o,s=function(e,t){if(null==e)return{};var n,o,s={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function h(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function _(e,t){if(t&&(\"object\"==typeof t||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return h(e)}function f(e){var t=l();return function(){var n,o=u(e);if(t){var s=u(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return _(this,n)}}function v(e,t){return M(e)||function(e,t){var n=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null==n)return;var o,s,a=[],i=!0,r=!1;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);i=!0);}catch(u){r=!0,s=u}finally{try{i||null==n.return||n.return()}finally{if(r)throw s}}return a}(e,t)||I(e,t)||T()}function m(e){return function(e){if(Array.isArray(e))return C(e)}(e)||y(e)||I(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function M(e){if(Array.isArray(e))return e}function y(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function I(e,t){if(e){if(\"string\"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function T(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function D(e,t){var n=\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(!n){if(Array.isArray(e)||(n=I(e))||t&&e&&\"number\"==typeof e.length){n&&(e=n);var o=0,s=function(){};return{s:s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}var a,i=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){r=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(r)throw a}}}}var k={SDK_READY:\"sdkStateReady\",SDK_NOT_READY:\"sdkStateNotReady\",SDK_DESTROY:\"sdkDestroy\",MESSAGE_RECEIVED:\"onMessageReceived\",MESSAGE_MODIFIED:\"onMessageModified\",MESSAGE_REVOKED:\"onMessageRevoked\",MESSAGE_READ_BY_PEER:\"onMessageReadByPeer\",MESSAGE_READ_RECEIPT_RECEIVED:\"onMessageReadReceiptReceived\",MESSAGE_EXTENSIONS_UPDATED:\"onMessageExtensionsUpdated\",MESSAGE_EXTENSIONS_DELETED:\"onMessageExtensionsDeleted\",CONVERSATION_LIST_UPDATED:\"onConversationListUpdated\",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:\"onTotalUnreadMessageCountUpdated\",CONVERSATION_GROUP_LIST_UPDATED:\"onConversationGroupListUpdated\",CONVERSATION_IN_GROUP_UPDATED:\"onConversationInGroupUpdated\",GROUP_LIST_UPDATED:\"onGroupListUpdated\",GROUP_SYSTEM_NOTICE_RECEIVED:\"receiveGroupSystemNotice\",GROUP_ATTRIBUTES_UPDATED:\"groupAttributesUpdated\",GROUP_COUNTER_UPDATED:\"onGroupCounterUpdated\",TOPIC_CREATED:\"onTopicCreated\",TOPIC_DELETED:\"onTopicDeleted\",TOPIC_UPDATED:\"onTopicUpdated\",PROFILE_UPDATED:\"onProfileUpdated\",USER_STATUS_UPDATED:\"onUserStatusUpdated\",BLACKLIST_UPDATED:\"blacklistUpdated\",FRIEND_LIST_UPDATED:\"onFriendListUpdated\",FRIEND_GROUP_LIST_UPDATED:\"onFriendGroupListUpdated\",FRIEND_APPLICATION_LIST_UPDATED:\"onFriendApplicationListUpdated\",KICKED_OUT:\"kickedOut\",ERROR:\"error\",NET_STATE_CHANGE:\"netStateChange\",SDK_RELOAD:\"sdkReload\"},E={MSG_TEXT:\"TIMTextElem\",MSG_IMAGE:\"TIMImageElem\",MSG_SOUND:\"TIMSoundElem\",MSG_AUDIO:\"TIMSoundElem\",MSG_FILE:\"TIMFileElem\",MSG_FACE:\"TIMFaceElem\",MSG_VIDEO:\"TIMVideoFileElem\",MSG_GEO:\"TIMLocationElem\",MSG_LOCATION:\"TIMLocationElem\",MSG_GRP_TIP:\"TIMGroupTipElem\",MSG_GRP_SYS_NOTICE:\"TIMGroupSystemNoticeElem\",MSG_CUSTOM:\"TIMCustomElem\",MSG_MERGER:\"TIMRelayElem\",MSG_PRIORITY_HIGH:\"High\",MSG_PRIORITY_NORMAL:\"Normal\",MSG_PRIORITY_LOW:\"Low\",MSG_PRIORITY_LOWEST:\"Lowest\",CONV_C2C:\"C2C\",CONV_GROUP:\"GROUP\",CONV_TOPIC:\"TOPIC\",CONV_SYSTEM:\"@TIM#SYSTEM\",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:\"Private\",GRP_WORK:\"Private\",GRP_PUBLIC:\"Public\",GRP_CHATROOM:\"ChatRoom\",GRP_MEETING:\"ChatRoom\",GRP_AVCHATROOM:\"AVChatRoom\",GRP_COMMUNITY:\"Community\",GRP_MBR_ROLE_OWNER:\"Owner\",GRP_MBR_ROLE_ADMIN:\"Admin\",GRP_MBR_ROLE_MEMBER:\"Member\",GRP_MBR_ROLE_CUSTOM:\"Custom\",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:\"AcceptAndNotify\",MSG_REMIND_ACPT_NOT_NOTE:\"AcceptNotNotify\",MSG_REMIND_DISCARD:\"Discard\",GENDER_UNKNOWN:\"Gender_Type_Unknown\",GENDER_FEMALE:\"Gender_Type_Female\",GENDER_MALE:\"Gender_Type_Male\",KICKED_OUT_MULT_ACCOUNT:\"multipleAccount\",KICKED_OUT_MULT_DEVICE:\"multipleDevice\",KICKED_OUT_USERSIG_EXPIRED:\"userSigExpired\",KICKED_OUT_REST_API:\"REST_API_Kick\",ALLOW_TYPE_ALLOW_ANY:\"AllowType_Type_AllowAny\",ALLOW_TYPE_NEED_CONFIRM:\"AllowType_Type_NeedConfirm\",ALLOW_TYPE_DENY_ANY:\"AllowType_Type_DenyAny\",FORBID_TYPE_NONE:\"AdminForbid_Type_None\",FORBID_TYPE_SEND_OUT:\"AdminForbid_Type_SendOut\",JOIN_OPTIONS_FREE_ACCESS:\"FreeAccess\",JOIN_OPTIONS_NEED_PERMISSION:\"NeedPermission\",JOIN_OPTIONS_DISABLE_APPLY:\"DisableApply\",JOIN_STATUS_SUCCESS:\"JoinedSuccess\",JOIN_STATUS_ALREADY_IN_GROUP:\"AlreadyInGroup\",JOIN_STATUS_WAIT_APPROVAL:\"WaitAdminApproval\",INVITE_OPTIONS_DISABLE_INVITE:\"DisableInvite\",INVITE_OPTIONS_NEED_PERMISSION:\"NeedPermission\",INVITE_OPTIONS_FREE_ACCESS:\"FreeAccess\",GRP_PROFILE_OWNER_ID:\"ownerID\",GRP_PROFILE_CREATE_TIME:\"createTime\",GRP_PROFILE_LAST_INFO_TIME:\"lastInfoTime\",GRP_PROFILE_MEMBER_NUM:\"memberNum\",GRP_PROFILE_MAX_MEMBER_NUM:\"maxMemberNum\",GRP_PROFILE_JOIN_OPTION:\"joinOption\",GRP_PROFILE_INVITE_OPTION:\"inviteOption\",GRP_PROFILE_INTRODUCTION:\"introduction\",GRP_PROFILE_NOTIFICATION:\"notification\",GRP_PROFILE_MUTE_ALL_MBRS:\"muteAllMembers\",SNS_ADD_TYPE_SINGLE:\"Add_Type_Single\",SNS_ADD_TYPE_BOTH:\"Add_Type_Both\",SNS_DELETE_TYPE_SINGLE:\"Delete_Type_Single\",SNS_DELETE_TYPE_BOTH:\"Delete_Type_Both\",SNS_APPLICATION_TYPE_BOTH:\"Pendency_Type_Both\",SNS_APPLICATION_SENT_TO_ME:\"Pendency_Type_ComeIn\",SNS_APPLICATION_SENT_BY_ME:\"Pendency_Type_SendOut\",SNS_APPLICATION_AGREE:\"Response_Action_Agree\",SNS_APPLICATION_AGREE_AND_ADD:\"Response_Action_AgreeAndAdd\",SNS_CHECK_TYPE_BOTH:\"CheckResult_Type_Both\",SNS_CHECK_TYPE_SINGLE:\"CheckResult_Type_Single\",SNS_TYPE_NO_RELATION:\"CheckResult_Type_NoRelation\",SNS_TYPE_A_WITH_B:\"CheckResult_Type_AWithB\",SNS_TYPE_B_WITH_A:\"CheckResult_Type_BWithA\",SNS_TYPE_BOTH_WAY:\"CheckResult_Type_BothWay\",NET_STATE_CONNECTED:\"connected\",NET_STATE_CONNECTING:\"connecting\",NET_STATE_DISCONNECTED:\"disconnected\",MSG_AT_ALL:\"__kImSDK_MesssageAtALL__\",READ_ALL_C2C_MSG:\"readAllC2CMessage\",READ_ALL_GROUP_MSG:\"readAllGroupMessage\",READ_ALL_MSG:\"readAllMessage\",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3},S=function(){function e(){o(this,e),this.cache=[],this.options=null}return a(e,[{key:\"use\",value:function(e){if(\"function\"!=typeof e)throw\"middleware must be a function\";return this.cache.push(e),this}},{key:\"next\",value:function(e){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:\"run\",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),e}(),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.high=t,this.low=n}return a(e,[{key:\"equal\",value:function(e){return null!==e&&(this.low===e.low&&this.high===e.high)}},{key:\"toString\",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t=\"0\"+t,n--;return e+t}}]),e}(),A={TEST:{CHINA:{DEFAULT:\"wss://wss-dev.tim.qq.com\"},OVERSEA:{DEFAULT:\"wss://wss-dev.tim.qq.com\"},SINGAPORE:{DEFAULT:\"wss://wsssgp-dev.im.qcloud.com\"},KOREA:{DEFAULT:\"wss://wsskr-dev.im.qcloud.com\"},GERMANY:{DEFAULT:\"wss://wssger-dev.im.qcloud.com\"},IND:{DEFAULT:\"wss://wssind-dev.im.qcloud.com\"},JPN:{DEFAULT:\"wss://wssjpn-dev.im.qcloud.com\"},USA:{DEFAULT:\"wss://wssusa-dev.im.qcloud.com\"}},PRODUCTION:{CHINA:{DEFAULT:\"wss://wss.im.qcloud.com\",BACKUP:\"wss://wss.tim.qq.com\",STAT:\"https://events.im.qcloud.com\",ANYCAST:\"wss://162.14.13.203\"},OVERSEA:{DEFAULT:\"wss://wss.im.qcloud.com\",BACKUP:\"wss://wss.my-imcloud.com\",STAT:\"https://api.my-imcloud.com\"},SINGAPORE:{DEFAULT:\"wss://wsssgp.im.qcloud.com\",BACKUP:\"wss://wsssgp.my-imcloud.com\",STAT:\"https://apisgp.my-imcloud.com\"},KOREA:{DEFAULT:\"wss://wsskr.im.qcloud.com\",BACKUP:\"wss://wsskr.my-imcloud.com\",STAT:\"https://apikr.my-imcloud.com\"},GERMANY:{DEFAULT:\"wss://wssger.im.qcloud.com\",BACKUP:\"wss://wssger.my-imcloud.com\",STAT:\"https://apiger.my-imcloud.com\"},IND:{DEFAULT:\"wss://wssind.my-imcloud.com\",BACKUP:\"wss://wssind.im.qcloud.com\",STAT:\"https://apiind.my-imcloud.com\"},JPN:{DEFAULT:\"wss://wssjpn.im.qcloud.com\",BACKUP:\"wss://wssjpn.my-imcloud.com\",STAT:\"https://apijpn.my-imcloud.com\"},USA:{DEFAULT:\"wss://wssusa.im.qcloud.com\",BACKUP:\"wss://wssusa.my-imcloud.com\",STAT:\"https://apiusa.my-imcloud.com\"}}},R={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15},N=\"1.7.3\",O=537048168,G=\"CHINA\",U=\"OVERSEA\",P=\"SINGAPORE\",b=\"KOREA\",w=\"GERMANY\",F=\"IND\",q=\"JPN\",x=\"USA\",V={HOST:{CURRENT:{DEFAULT:\"wss://wss.im.qcloud.com\",STAT:\"https://events.im.qcloud.com\"},setCurrent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G;this.CURRENT=A.PRODUCTION[e]}},NAME:{OPEN_IM:\"openim\",OPEN_IM_MSG_EXT:\"openim_msg_ext_http_svc\",GROUP:\"group_open_http_svc\",GROUP_AVCHATROOM:\"group_open_avchatroom_http_svc\",GROUP_COMMUNITY:\"million_group_open_http_svc\",GROUP_ATTR:\"group_open_attr_http_svc\",FRIEND:\"sns\",PROFILE:\"profile\",RECENT_CONTACT:\"recentcontact\",PIC:\"openpic\",BIG_GROUP_NO_AUTH:\"group_open_http_noauth_svc\",BIG_GROUP_LONG_POLLING:\"group_open_long_polling_http_svc\",BIG_GROUP_LONG_POLLING_NO_AUTH:\"group_open_long_polling_http_noauth_svc\",IM_OPEN_STAT:\"imopenstat\",WEB_IM:\"webim\",IM_COS_SIGN:\"im_cos_sign_svr\",CUSTOM_UPLOAD:\"im_cos_msg\",HEARTBEAT:\"heartbeat\",IM_OPEN_PUSH:\"im_open_push\",IM_OPEN_STATUS:\"im_open_status\",IM_LONG_MESSAGE:\"im_long_msg\",IM_CONFIG_MANAGER:\"im_sdk_config_mgr\",STAT_SERVICE:\"StatSvc\",OVERLOAD_PUSH:\"OverLoadPush\",IM_MSG_AUDIT_MGR:\"im_msg_audit_mgr\",TUIROOM_SVR:\"tui_room_svr\",IM_OPEN_TRANSLATE:\"im_open_translate\"},CMD:{LOGIN:\"wslogin\",LOGOUT_LONG_POLL:\"longpollinglogout\",LOGOUT:\"wslogout\",HELLO:\"wshello\",STAT_BACKGROUND:\"ws_stat_background\",STAT_FOREGROUND:\"ws_stat_foreground\",SET_TOKEN:\"ws_stat_settoken\",PORTRAIT_GET:\"portrait_get_all\",PORTRAIT_SET:\"portrait_set\",GET_LONG_POLL_ID:\"getlongpollingid\",LONG_POLL:\"longpolling\",AVCHATROOM_LONG_POLL:\"get_msg\",ADD_FRIEND:\"friend_add\",UPDATE_FRIEND:\"friend_update\",GET_FRIEND_LIST:\"friend_get\",GET_FRIEND_PROFILE:\"friend_get_specified\",DELETE_FRIEND:\"friend_delete\",CHECK_FRIEND:\"friend_check\",GET_FRIEND_GROUP_LIST:\"group_get\",RESPOND_FRIEND_APPLICATION:\"friend_response\",GET_FRIEND_APPLICATION_LIST:\"pendency_get\",DELETE_FRIEND_APPLICATION:\"pendency_delete\",REPORT_FRIEND_APPLICATION:\"pendency_report\",GET_GROUP_APPLICATION:\"get_pendency\",CREATE_FRIEND_GROUP:\"group_add\",DELETE_FRIEND_GROUP:\"group_delete\",UPDATE_FRIEND_GROUP:\"group_update\",GET_BLACKLIST:\"black_list_get\",ADD_BLACKLIST:\"black_list_add\",DELETE_BLACKLIST:\"black_list_delete\",CREATE_GROUP:\"create_group\",GET_JOINED_GROUPS:\"get_joined_group_list\",SET_GROUP_ATTRIBUTES:\"set_group_attr\",MODIFY_GROUP_ATTRIBUTES:\"modify_group_attr\",DELETE_GROUP_ATTRIBUTES:\"delete_group_attr\",CLEAR_GROUP_ATTRIBUTES:\"clear_group_attr\",GET_GROUP_ATTRIBUTES:\"get_group_attr\",SEND_MESSAGE:\"sendmsg\",REVOKE_C2C_MESSAGE:\"msgwithdraw\",DELETE_C2C_MESSAGE:\"delete_c2c_msg_ramble\",MODIFY_C2C_MESSAGE:\"modify_c2c_msg\",MODIFY_C2C_MESSAGE_EXTENSIONS:\"set_key_values\",GET_C2C_MESSAGE_EXTENSIONS:\"get_key_values\",SEND_GROUP_MESSAGE:\"send_group_msg\",REVOKE_GROUP_MESSAGE:\"group_msg_recall\",DELETE_GROUP_MESSAGE:\"delete_group_ramble_msg_by_seq\",MODIFY_GROUP_MESSAGE:\"modify_group_msg\",MODIFY_GROUP_MESSAGE_EXTENSIONS:\"group_set_key_values\",GET_GROUP_MESSAGE_EXTENSIONS:\"group_get_key_values\",GET_GROUP_INFO:\"get_group_self_member_info\",GET_GROUP_MEMBER_INFO:\"get_specified_group_member_info\",GET_GROUP_MEMBER_LIST:\"get_group_member_info\",GET_AVCHATROOM_MEMBER_LIST:\"get_members\",MARK_AVCHATROOM_MEMBER_INFO:\"modify_user_info\",QUIT_GROUP:\"quit_group\",CHANGE_GROUP_OWNER:\"change_group_owner\",DESTROY_GROUP:\"destroy_group\",ADD_GROUP_MEMBER:\"add_group_member\",DELETE_GROUP_MEMBER:\"delete_group_member\",BAN_AVCHATROOM_MEMBER:\"ban_group_member\",SEARCH_GROUP_BY_ID:\"get_group_public_info\",APPLY_JOIN_GROUP:\"apply_join_group\",HANDLE_APPLY_JOIN_GROUP:\"handle_apply_join_group\",HANDLE_INVITE_JOIN_GROUP:\"handle_invite_join_permission_group\",HANDLE_GROUP_INVITATION:\"handle_invite_join_group\",MODIFY_GROUP_INFO:\"modify_group_base_info\",MODIFY_GROUP_MEMBER_INFO:\"modify_group_member_info\",DELETE_GROUP_SYSTEM_MESSAGE:\"deletemsg\",DELETE_GROUP_AT_TIPS:\"deletemsg\",GET_GROUP_NOTIFY:\"get_group_notify\",GET_CONVERSATION_LIST:\"get\",PAGING_GET_CONVERSATION_LIST:\"page_get\",DELETE_CONVERSATION:\"batch_delete\",CLEAR_HISTORY_MESSAGE:\"clear_msg\",PIN_CONVERSATION:\"top\",SET_CONVERSATION_CUSTOM_DATA:\"mark_contact\",MARK_CONVERSATION:\"mark_contact\",CREATE_CONVERSATION_GROUP:\"create_contact_group\",DELETE_CONVERSATION_GROUP:\"del_contact_group\",UPDATE_CONVERSATION_GROUP:\"update_contact_group\",GET_CONVERSATION_GROUP_LIST:\"get_contact_group\",GET_MESSAGES:\"getmsg\",GET_C2C_ROAM_MESSAGES:\"getroammsg\",SET_C2C_PEER_MUTE_NOTIFICATIONS:\"set_c2c_peer_mute_notifications\",GET_C2C_PEER_MUTE_NOTIFICATIONS:\"get_c2c_peer_mute_notifications\",GET_GROUP_ROAM_MESSAGES:\"group_msg_get\",GET_READ_RECEIPT:\"get_group_msg_receipt\",GET_READ_RECEIPT_DETAIL:\"get_group_msg_receipt_detail\",SEND_READ_RECEIPT:\"group_msg_receipt\",SEND_C2C_READ_RECEIPT:\"c2c_msg_read_receipt\",SET_C2C_MESSAGE_READ:\"msgreaded\",GET_PEER_READ_TIME:\"get_peer_read_time\",SET_GROUP_MESSAGE_READ:\"msg_read_report\",FILE_READ_AND_WRITE_AUTHKEY:\"authkey\",FILE_UPLOAD:\"pic_up\",COS_SIGN:\"cos\",COS_PRE_SIG:\"pre_sig\",VIDEO_COVER:\"video_cover\",TIM_WEB_REPORT_V2:\"tim_web_report_v2\",BIG_DATA_HALLWAY_AUTH_KEY:\"authkey\",GET_ONLINE_MEMBER_NUM:\"get_online_member_num\",ALIVE:\"alive\",MESSAGE_PUSH:\"msg_push\",MULTI_MESSAGE_PUSH:\"multi_msg_push_ws\",MESSAGE_PUSH_ACK:\"ws_msg_push_ack\",STATUS_FORCE_OFFLINE:\"stat_forceoffline\",DOWNLOAD_MERGER_MESSAGE:\"get_relay_json_msg\",UPLOAD_MERGER_MESSAGE:\"save_relay_json_msg\",FETCH_CLOUD_CONTROL_CONFIG:\"fetch_config\",PUSHED_CLOUD_CONTROL_CONFIG:\"push_configv2\",FETCH_COMMERCIAL_CONFIG:\"fetch_imsdk_purchase_bitsv2\",PUSHED_COMMERCIAL_CONFIG:\"push_imsdk_purchase_bitsv2\",KICK_OTHER:\"KickOther\",OVERLOAD_NOTIFY:\"notify2\",SET_ALL_MESSAGE_READ:\"read_all_unread_msg\",CREATE_TOPIC:\"create_topic\",DELETE_TOPIC:\"destroy_topic\",UPDATE_TOPIC_PROFILE:\"modify_topic\",GET_TOPIC_LIST:\"get_topic\",SET_SELF_STATUS:\"ws_set_custom_status\",GET_USER_STATUS:\"ws_get_user_status\",SUBSCRIBE_USER_STATUS:\"ws_status_subscribe\",UNSUBSCRIBE_USER_STATUS:\"ws_status_unsubscribe\",GET_RPOFANITY_LIST:\"get_local_words\",TRANSLATE_TEXT:\"ws_batch_trans_text\",UPDATE_GROUP_COUNTER:\"update_group_counter\",GET_GROUP_COUNTER:\"get_group_counter\"},CHANNEL:{SOCKET:1,XHR:2,AUTO:0},NAME_VERSION:{openim:\"v4\",group_open_http_svc:\"v4\",sns:\"v4\",profile:\"v4\",recentcontact:\"v4\",openpic:\"v4\",group_open_http_noauth_svc:\"v4\",group_open_long_polling_http_svc:\"v4\",group_open_long_polling_http_noauth_svc:\"v4\",imopenstat:\"v4\",im_cos_sign_svr:\"v4\",im_cos_msg:\"v4\",webim:\"v4\",im_open_push:\"v4\",im_open_status:\"v4\"}},B={SEARCH_MSG:new L(0,Math.pow(2,0)).toString(),SEARCH_GRP_SNS:new L(0,Math.pow(2,1)).toString(),AVCHATROOM_HISTORY_MSG:new L(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new L(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new L(0,Math.pow(2,4)).toString(),AVCHATROOM_MBR_LIST:new L(0,Math.pow(2,6)).toString(),USER_STATUS:new L(0,Math.pow(2,7)).toString(),CONV_MARK:new L(0,Math.pow(2,9)).toString(),CONV_GROUP:new L(0,Math.pow(2,10)).toString(),AVCHATROOM_BAN_MBR:new L(0,Math.pow(2,11)).toString(),MSG_EXT:new L(0,Math.pow(2,13)).toString(),GRP_COUNTER:new L(0,Math.pow(2,15)).toString()},H=\"c2c_text_message\",K=\"c2c_custom_message\",W=\"group_text_message\",Y=\"group_custom_message\",j=\"user_profile\",z=\"group_profile\",J=\"group_member_profile\";V.HOST.setCurrent(G);var X=\"undefined\"!=typeof wx&&\"function\"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Z=X&&\"function\"==typeof wx.createGamePortal,Q=\"undefined\"!=typeof qq&&\"function\"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),$=\"undefined\"!=typeof tt&&\"function\"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),ee=\"undefined\"!=typeof swan&&\"function\"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),te=\"undefined\"!=typeof my&&\"function\"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),ne=\"undefined\"!=typeof jd&&\"function\"==typeof jd.getSystemInfoSync,oe=\"undefined\"!=typeof uni&&\"undefined\"==typeof window&&\"function\"==typeof uni.requireNativePlugin,se=\"undefined\"!=typeof uni,ae=X||Q||$||ee||te||oe||ne,ie=(\"undefined\"!=typeof uni||\"undefined\"!=typeof window)&&!ae,re=Q?qq:$?tt:ee?swan:te?my:X?wx:oe?uni:ne?jd:{},ue=ie&&window&&window.navigator&&window.navigator.userAgent||\"\",ce=/(micromessenger|webbrowser)/i.test(ue),le=/AppleWebKit\\/([\\d.]+)/i.exec(ue);le&&parseFloat(le.pop());var de,pe,ge=(de=\"WEB\",ce?de=\"WEB\":Q?de=\"QQ_MP\":$?de=\"TT_MP\":ee?de=\"BAIDU_MP\":te?de=\"ALI_MP\":X?de=\"WX_MP\":oe&&(de=\"UNI_NATIVE_APP\"),R[de]),he=/iPad/i.test(ue),_e=/iPhone/i.test(ue)&&!he,fe=/iPod/i.test(ue),ve=_e||he||fe,me=(pe=ue.match(/OS (\\d+)_/i))&&pe[1]?pe[1]:null,Me=/Android/i.test(ue),ye=function(){var e=ue.match(/Android (\\d+)(?:\\.(\\d+))?(?:\\.(\\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+\".\"+e[2]):t||null}();!function(){var e=ue.match(/Chrome\\/(\\d+)/);e&&e[1]&&parseFloat(e[1])}();var Ie=/MSIE/.test(ue)||ue.indexOf(\"Trident\")>-1&&ue.indexOf(\"rv:11.0\")>-1,Ce=function(){var e=/MSIE\\s(\\d+)\\.\\d/.exec(ue),t=e&&parseFloat(e[1]);return!t&&/Trident\\/7.0/i.test(ue)&&/rv:11.0/.test(ue)&&(t=11),t}();!function(){var e=ue.match(/TBS\\/(\\d+)/i);if(e&&e[1])e[1]}();var Te,De,ke=/Windows/i.test(ue),Ee=/MAC OS X/i.test(ue),Se=ie&&\"undefined\"!=typeof Worker&&!Ie,Le=Me||ve,Ae=ie&&void 0!==window.tencent_cloud_im_csig_flutter_for_web_25F_cy;Te=\"undefined\"!=typeof console?console:\"undefined\"!=typeof __webpack_require__.g&&__webpack_require__.g.console?__webpack_require__.g.console:\"undefined\"!=typeof window&&window.console?window.console:{};for(var Re=function(){},Ne=[\"assert\",\"clear\",\"count\",\"debug\",\"dir\",\"dirxml\",\"error\",\"group\",\"groupCollapsed\",\"groupEnd\",\"info\",\"log\",\"profile\",\"profileEnd\",\"table\",\"time\",\"timeEnd\",\"timeStamp\",\"trace\",\"warn\"],Oe=Ne.length;Oe--;)De=Ne[Oe],console[De]||(Te[De]=Re);var Ge=Te,Ue=0,Pe=function(){return(new Date).getTime()+Ue},be=function(){Ue=0},we=function(){return Math.floor(Pe()/1e3)},Fe=0;function qe(){return Kt()?\"%c TIM %c\":\"TIM\"}function xe(){var e,t=((e=new Date).setTime(Pe()),e);return t.toLocaleTimeString(\"en-US\",{hour12:!1})+\".\"+function(e){var t;switch(e.toString().length){case 1:t=\"00\"+e;break;case 2:t=\"0\"+e;break;default:t=e}return t}(t.getMilliseconds())}var Ve={arguments2String:function(e){var t=\"\";if(1===e.length)t=e[0];else for(var n=0,o=e.length;n<o;n++)rt(e[n])?ct(e[n])?t+=gt(e[n]):t+=JSON.stringify(e[n]):t+=e[n],t+=\" \";return t},_exec:function(e,t){Kt()?Ge[e](qe(),\"background:#0abf5b; padding:1px; border-radius:3px; color: #fff\",\"background:transparent\",xe(),t):Ge[e](\"\".concat(qe(),\" \").concat(xe(),\" \").concat(t))},d:function(){if(Fe<=-1){var e=this.arguments2String(arguments);this._exec(\"debug\",e)}},l:function(){if(Fe<=0){var e=this.arguments2String(arguments);this._exec(\"log\",e)}},log:function(){if(Fe<=0){var e=this.arguments2String(arguments);this._exec(\"log\",e)}},i:function(){if(Fe<=1){var e=this.arguments2String(arguments);this._exec(\"info\",e)}},w:function(){if(Fe<=2){var e=this.arguments2String(arguments);this._exec(\"warn\",e)}},e:function(){if(Fe<=3){var e=this.arguments2String(arguments);this._exec(\"error\",e)}},setLevel:function(e){e<4&&this._exec(\"log\",\"set level from \"+Fe+\" to \"+e),Fe=e},getLevel:function(){return Fe}},Be={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},He={NICK:\"Tag_Profile_IM_Nick\",GENDER:\"Tag_Profile_IM_Gender\",BIRTHDAY:\"Tag_Profile_IM_BirthDay\",LOCATION:\"Tag_Profile_IM_Location\",SELFSIGNATURE:\"Tag_Profile_IM_SelfSignature\",ALLOWTYPE:\"Tag_Profile_IM_AllowType\",LANGUAGE:\"Tag_Profile_IM_Language\",AVATAR:\"Tag_Profile_IM_Image\",MESSAGESETTINGS:\"Tag_Profile_IM_MsgSettings\",ADMINFORBIDTYPE:\"Tag_Profile_IM_AdminForbidType\",LEVEL:\"Tag_Profile_IM_Level\",ROLE:\"Tag_Profile_IM_Role\"},Ke={UNKNOWN:\"Gender_Type_Unknown\",FEMALE:\"Gender_Type_Female\",MALE:\"Gender_Type_Male\"},We={NONE:\"AdminForbid_Type_None\",SEND_OUT:\"AdminForbid_Type_SendOut\"},Ye={NEED_CONFIRM:\"AllowType_Type_NeedConfirm\",ALLOW_ANY:\"AllowType_Type_AllowAny\",DENY_ANY:\"AllowType_Type_DenyAny\"},je=\"JoinedSuccess\",ze=\"WaitAdminApproval\",Je=\"@TGS#_\",Xe=\"@TOPIC#_\",Ze=[\"url\"],Qe=function(e){return\"map\"===lt(e)},$e=function(e){return\"file\"===lt(e)},et=function(e){return null!==e&&(\"number\"==typeof e&&!isNaN(e-0)||\"object\"===n(e)&&e.constructor===Number)},nt=function(e){return\"string\"==typeof e},ot=function(e){return null!==e&&\"object\"===n(e)},st=function(e){if(\"object\"!==n(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var o=t;null!==Object.getPrototypeOf(o);)o=Object.getPrototypeOf(o);return t===o},at=function(e){return\"function\"==typeof Array.isArray?Array.isArray(e):\"array\"===lt(e)},it=function(e){return void 0===e},rt=function(e){return at(e)||ot(e)},ut=function(e){return\"function\"==typeof e},ct=function(e){return e instanceof Error},lt=function(e){return Object.prototype.toString.call(e).match(/^\\[object (.*)\\]$/)[1].toLowerCase()},dt=function(e){if(\"string\"!=typeof e)return!1;var t=e[0];return!/[^a-zA-Z0-9]/.test(t)};Date.now||(Date.now=function(){return(new Date).getTime()});var pt=function e(t,n,o,s){if(!rt(t)||!rt(n))return 0;for(var a,i=0,r=Object.keys(n),u=0,c=r.length;u<c;u++)if(a=r[u],!(it(n[a])||o&&o.includes(a)))if(rt(t[a])&&rt(n[a]))i+=e(t[a],n[a],o,s);else{if(s&&s.includes(n[a]))continue;t[a]!==n[a]&&(t[a]=n[a],i+=1)}return i},gt=function(e){return JSON.stringify(e,[\"message\",\"code\"])},ht=function(e){if(0===e.length)return 0;for(var t=0,n=0,o=\"undefined\"!=typeof document&&void 0!==document.characterSet?document.characterSet:\"UTF-8\";void 0!==e[t];)n+=e[t++].charCodeAt[t]<=255?1:!1===o?3:2;return n},_t=function(e){var t=e||99999999;return Math.round(Math.random()*t)},ft=\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\",vt=ft.length,mt=function(e,t){for(var n in e)if(e[n]===t)return!0;return!1},Mt={},yt=function(e){return-1===e.indexOf(\"http://\")||-1===e.indexOf(\"https://\")?\"https://\"+e:e.replace(/https|http/,\"https\")},It=function e(t){if(0===Object.getOwnPropertyNames(t).length)return Object.create(null);var o=Array.isArray(t)?[]:Object.create(null),s=\"\";for(var a in t)null!==t[a]?void 0!==t[a]?(s=n(t[a]),[\"string\",\"number\",\"function\",\"boolean\"].indexOf(s)>=0?o[a]=t[a]:o[a]=e(t[a])):o[a]=void 0:o[a]=null;return o};function Ct(e,t){if(!at(e)||!at(t))return!1;var n=!1;return t.forEach((function(t){var o=t.key,s=t.value,a=e.find((function(e){return e.key===o}));a?a.value!==s&&(a.value=s,n=!0):(e.push({key:o,value:s}),n=!0)})),n}var Tt=function(e){return e===E.GRP_AVCHATROOM},Dt=function(e){var t=e.type,n=e.groupID;return t===E.GRP_COMMUNITY||\"\".concat(n).startsWith(Je)&&!\"\".concat(n).includes(Xe)},kt=function(e){return\"\".concat(e).startsWith(Je)&&\"\".concat(e).includes(Xe)},Et=function(e){return nt(e)&&e.slice(0,3)===E.CONV_C2C},St=function(e){return nt(e)&&e.slice(0,5)===E.CONV_GROUP},Lt=function(e){return nt(e)&&e===E.CONV_SYSTEM};function At(e,t){var n={};return Object.keys(e).forEach((function(o){n[o]=t(e[o],o)})),n}function Rt(e){return ae?new Promise((function(t,n){re.getImageInfo({src:e,success:function(e){t({width:e.width,height:e.height})},fail:function(){t({width:0,height:0})}})})):Ie&&9===Ce?Promise.resolve({width:0,height:0}):new Promise((function(t,n){var o=new Image;o.onload=function(){t({width:this.width,height:this.height}),o=null},o.onerror=function(){t({width:0,height:0}),o=null},o.src=e}))}function Nt(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return\"\".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function Ot(){var e=\"unknown\";if(Ee&&(e=\"mac\"),ke&&(e=\"windows\"),ve&&(e=\"ios\"),Me&&(e=\"android\"),ae)try{var t=re.getSystemInfoSync().platform;void 0!==t&&(e=t)}catch(n){}return e}function Gt(e,t){e=e.split(\".\"),t=t.split(\".\");for(var n=Math.max(e.length,t.length);e.length<n;)e.push(\"0\");for(;t.length<n;)t.push(\"0\");for(var o=0;o<n;o++){var s=parseInt(e[o]),a=parseInt(t[o]);if(s>a)return 1;if(s<a)return-1}return 0}function Ut(e){var t=e.originUrl,n=void 0===t?void 0:t,o=e.originWidth,s=e.originHeight,a=e.min,i=void 0===a?198:a,r=parseInt(o),u=parseInt(s),c={url:void 0,width:0,height:0};if((r<=u?r:u)<=i)c.url=n,c.width=r,c.height=u;else{u<=r?(c.width=Math.ceil(r*i/u),c.height=i):(c.width=i,c.height=Math.ceil(u*i/r));var l=n&&n.indexOf(\"?\")>-1?\"\".concat(n,\"&\"):\"\".concat(n,\"?\");c.url=\"\".concat(l,198===i?\"imageView2/3/w/198/h/198\":\"imageView2/3/w/720/h/720\")}return it(n)?(c.url,g(c,Ze)):c}function Pt(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function bt(e){var t=e.servcmd;return t.slice(t.indexOf(\".\")+1)}function wt(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function Ft(e,t){return e.includes(t)}function qt(e,t){return e.includes(t)}function xt(e){return e.split(Xe)[0]}var Vt=function(e,t,n){if(it(t))return\"\";switch(e){case E.MSG_TEXT:return t.text;case E.MSG_IMAGE:return n?\"[Image]\":\"[图片]\";case E.MSG_LOCATION:return n?\"[Location]\":\"[位置]\";case E.MSG_AUDIO:return n?\"[Voice]\":\"[语音]\";case E.MSG_VIDEO:return n?\"[Video]\":\"[视频]\";case E.MSG_FILE:return n?\"[File]\":\"[文件]\";case E.MSG_CUSTOM:return n?\"[Custom Messages]\":\"[自定义消息]\";case E.MSG_GRP_TIP:return n?\"[Group Notification]\":\"[群提示消息]\";case E.MSG_GRP_SYS_NOTICE:return n?\"[Group System Message]\":\"[群系统通知]\";case E.MSG_FACE:return n?\"[Animated Sticker]\":\"[动画表情]\";case E.MSG_MERGER:return n?\"[Chat Record]\":\"[聊天记录]\";default:return\"\"}};function Bt(e){return e===E.MSG_TEXT||e===E.MSG_CUSTOM||e===E.MSG_LOCATION||e===E.MSG_FACE}function Ht(e){var t=[];if(!nt(e))return t;var n=e.length;if(0===n)return t;for(var o=n-1;o>=0;o--)\"1\"===e[o]&&t.push(Math.pow(2,n-o-1));return t}function Kt(){return!Ie&&!ae}function Wt(e){return\"the length of userIDList cannot exceed \".concat(e)}function Yt(e,t){if(e){var n=e;return t&&(e.startsWith(\"http://\")?n=e.replace(/^http:\\/\\/[^/]+/,t):e.startsWith(\"https://\")&&(n=e.replace(/^https:\\/\\/[^/]+/,t))),n}}var jt=Object.prototype.hasOwnProperty;function zt(e){if(null==e)return!0;if(\"boolean\"==typeof e)return!1;if(\"number\"==typeof e)return 0===e;if(\"string\"==typeof e)return 0===e.length;if(\"function\"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return\"\"===e.message;if(st(e)){for(var t in e)if(jt.call(e,t))return!1;return!0}return!(!Qe(e)&&(n=e,\"set\"!==lt(n))&&!$e(e))&&0===e.size;var n}function Jt(e,t,n){if(void 0===t)return!0;var o=!0;if(st(t))Object.keys(t).forEach((function(s){var a=1===e.length?e[0][s]:void 0;o=!!Xt(a,t[s],n,s)&&o}));else if(at(t))for(var s=0;s<t.length;s++)o=!!Xt(e[s],t[s],n,t[s].name)&&o;if(o)return o;throw new Error(\"Params validate failed.\")}function Xt(e,t,n,o){if(void 0===t)return!0;var s=!0;if(t.required&&zt(e)&&(Ve.e(\"[\".concat(n,'] Missing required params: \"').concat(o,'\".')),s=!1),!zt(e)){var a=lt(e),i=t.type.toLowerCase();a!==i&&(\"asyncfunction\"===a&&\"function\"===i||(Ve.e(\"[\".concat(n,'] Invalid params: type check failed for \"').concat(o,'\".Expected ').concat(t.type,\".\")),s=!1))}return t.validator&&!t.validator(e)&&(Ve.e(\"[\".concat(n,\"] Invalid params: custom validator check failed for params.\")),s=!1),s}var Zt,Qt={UNSEND:\"unSend\",SUCCESS:\"success\",FAIL:\"fail\"},$t={NOT_START:\"notStart\",PENDING:\"pending\",RESOLVED:\"resolved\",REJECTED:\"rejected\"},en=function(e){if(!e)return!1;if(Et(e)||St(e)||Lt(e))return!0;var t=Sn(\"InvalidConversationID\",e);return t&&Ve.w(t),!1},tn=function(e){\"\"!==e.desc&&\"\"!==Sn(\"API_REFER\")&&Ve.w(\"[\".concat(e.api,\"] | \").concat(e.param,\" | \").concat(e.desc,\", \").concat(Sn(\"API_REFER\")).concat(e.api))},nn=function(){return Sn(\"StringRequiredLog\")},on=function(e){return Sn(\"NonEmptyStringRequiredLog\",e)},sn=function(){return Sn(\"NumberRequiredLog\")},an=function(){return Sn(\"UndefinedNotAllowedLog\")},rn=function(){return Sn(\"FileRequiredLog\")},un=function(){return Sn(\"FunctionRequiredLog\")},cn=function(){return Sn(\"ArrayRequiredLog\")},ln=function(){return Sn(\"NonEmptyArrayLog\")},dn=function(){return Sn(\"CallbackMissingLog\")},pn=function(){return Sn(\"PositiveIntegerRequiredLog\")},gn=function(e,t){return Sn(\"StringNotLongerThanLog\",e,t)},hn=function(e,t){return Sn(\"NumberLessThanLog\",e,t)},_n=function(e){return Sn(\"KeyValueStringRequiredLog\",e)},fn=function(){return Sn(\"PlainObjectRequiredLog\")},vn=function(){return Sn(\"NonEmptyContentRequiredLog\")},mn=function(){return Sn(\"FileNotSelectedLog\")},Mn=function(){return Sn(\"MessageInstanceRequiredLog\")},yn=function(){return Sn(\"NonAnonymousFunctionLog\")},In=function(){return Sn(\"MessageExtensionNotAvailableLog\")},Cn={type:\"String\",required:!0},Tn={type:\"Array\",required:!0},Dn={type:\"Object\",required:!0},kn={type:\"Boolean\",required:!0},En={type:\"number\",required:!0},Sn=null,Ln={hookGetAPITips:function(e){Sn=e},login:{userID:Cn,userSig:Cn},addToBlacklist:{userIDList:Tn},removeFromBlacklist:{userIDList:Tn},on:[{name:\"eventName\",type:\"String\",validator:function(e){return\"string\"==typeof e&&0!==e.length||(tn({api:\"on\",param:\"eventName\",desc:on(\"eventName\")}),!1)}},{name:\"handler\",type:\"Function\",validator:function(e){return\"function\"!=typeof e?(tn({api:\"on\",param:\"handler\",desc:un()}),!1):(\"\"===e.name&&tn({api:\"on\",param:\"handler\",desc:yn()}),!0)}}],once:[{name:\"eventName\",type:\"String\",validator:function(e){return\"string\"==typeof e&&0!==e.length||(tn({api:\"once\",param:\"eventName\",desc:on(\"eventName\")}),!1)}},{name:\"handler\",type:\"Function\",validator:function(e){return\"function\"!=typeof e?(tn({api:\"once\",param:\"handler\",desc:un()}),!1):(\"\"===e.name&&tn({api:\"once\",param:\"handler\",desc:yn()}),!0)}}],off:[{name:\"eventName\",type:\"String\",validator:function(e){return\"string\"==typeof e&&0!==e.length||(tn({api:\"off\",param:\"eventName\",desc:on(\"eventName\")}),!1)}},{name:\"handler\",type:\"Function\",validator:function(e){return\"function\"!=typeof e?(tn({api:\"off\",param:\"handler\",desc:un()}),!1):(\"\"===e.name&&tn({api:\"off\",param:\"handler\",desc:yn()}),!0)}}],sendMessage:[t({name:\"message\"},Dn)],setMessageExtensions:[t(t({name:\"message\"},Dn),{},{validator:function(e){return e.status===Qt.SUCCESS&&!0===e.isSupportExtension||(tn({api:\"setMessageExtensions\",param:\"message\",desc:In()}),!1)}}),t({name:\"extensions\"},Tn)],getMessageExtensions:[t(t({name:\"message\"},Dn),{},{validator:function(e){return e.status===Qt.SUCCESS&&!0===e.isSupportExtension||(tn({api:\"getMessageExtensions\",param:\"message\",desc:In()}),!1)}})],deleteMessageExtensions:[t(t({name:\"message\"},Dn),{},{validator:function(e){return e.status===Qt.SUCCESS&&!0===e.isSupportExtension||(tn({api:\"deleteMessageExtensions\",param:\"message\",desc:In()}),!1)}})],getMessageList:{conversationID:t(t({},Cn),{},{validator:function(e){return en(e)}}),nextReqMessageID:{type:\"String\"},count:{type:\"Number\",validator:function(e){return!(!it(e)&&!/^[1-9][0-9]*$/.test(e))||(tn({api:\"getMessageList\",param:\"count\",desc:pn()}),!1)}}},getMessageListHopping:{conversationID:t(t({},Cn),{},{validator:function(e){return en(e)}}),sequence:{type:\"Number\"},time:{type:\"Number\"},direction:{type:\"Number\",validator:function(e){return!(!it(e)&&0!==e&&1!==e)||(tn({api:\"getMessageListHopping\",param:\"direction\",desc:Sn(\"0Or1RequiredLog\")}),!1)}},count:{type:\"Number\",validator:function(e){return!(!it(e)&&!/^[1-9][0-9]*$/.test(e))||(tn({api:\"getMessageListHopping\",param:\"count\",desc:pn}),!1)}}},setMessageRead:{conversationID:t(t({},Cn),{},{validator:function(e){return en(e)}})},setAllMessageRead:{scope:{type:\"String\",required:!1,validator:function(e){return!e||-1!==[E.READ_ALL_C2C_MSG,E.READ_ALL_GROUP_MSG,E.READ_ALL_MSG].indexOf(e)||(tn({api:\"setAllMessageRead\",param:\"scope\",desc:\"TIM.TYPES.READ_ALL_C2C_MSG or TIM.TYPES.READ_ALL_GROUP_MSG or TIM.TYPES.READ_ALL_MSG required\"}),!1)}}},getConversationProfile:[t(t({name:\"conversationID\"},Cn),{},{validator:function(e){return en(e)}})],clearHistoryMessage:[t(t({name:\"conversationID\"},Cn),{},{validator:function(e){return en(e)}})],pinConversation:{conversationID:t(t({},Cn),{},{validator:function(e){return en(e)}}),isPinned:t({},kn)},setConversationCustomData:{conversationIDList:t({},Tn),customData:{type:\"String\",validator:function(e){return nt(e)?!(e.length>256)||(tn({api:\"setConversationCustomData\",param:\"customData\",desc:gn(\"customData\",256)}),!1):(tn({api:\"setConversationCustomData\",param:\"customData\",desc:nn()}),!1)}}},markConversation:{conversationIDList:t({},Tn),markType:{type:\"number\",validator:function(e){return et(e)?e<=0?(tn({api:\"markConversation\",param:\"markType\",desc:(t=\"markType\",n=0,Sn(\"NumberGreaterThanLog\",t,n))}),!1):!(e>=Math.pow(2,64))||(tn({api:\"markConversation\",param:\"markType\",desc:hn(\"markType\",\"Math.pow(2,64)\")}),!1):(tn({api:\"markConversation\",param:\"markType\",desc:sn()}),!1);var t,n}},enableMark:t({},kn)},createConversationGroup:{conversationIDList:t({},Tn),groupName:t(t({},Cn),{},{validator:function(e){return!!e&&(!(e.length>32)||(tn({api:\"createConversationGroup\",param:\"groupName\",desc:gn(\"groupName\",32)}),!1))}})},deleteConversationGroup:[t({name:\"groupName\"},Cn)],renameConversationGroup:{oldName:t({},Cn),newName:t(t({},Cn),{},{validator:function(e){return!!e&&(!(e.length>32)||(tn({api:\"renameConversationGroup\",param:\"newName\",desc:gn(\"newName\",32)}),!1))}})},addConversationsToGroup:{conversationIDList:t({},Tn),groupName:t({},Cn)},deleteConversationsFromGroup:{conversationIDList:t({},Tn),groupName:t({},Cn)},getGroupList:{groupProfileFilter:{type:\"Array\"}},getGroupProfile:{groupID:Cn,groupCustomFieldFilter:{type:\"Array\"},memberCustomFieldFilter:{type:\"Array\"}},getGroupProfileAdvance:{groupIDList:Tn},createGroup:{name:Cn},joinGroup:{groupID:Cn,type:{type:\"String\"},applyMessage:{type:\"String\"}},quitGroup:[t({name:\"groupID\"},Cn)],handleApplication:{message:Dn,handleAction:Cn,handleMessage:{type:\"String\"}},changeGroupOwner:{groupID:Cn,newOwnerID:Cn},updateGroupProfile:{groupID:Cn,muteAllMembers:{type:\"Boolean\"}},dismissGroup:[t({name:\"groupID\"},Cn)],searchGroupByID:[t({name:\"groupID\"},Cn)],initGroupAttributes:{groupID:Cn,groupAttributes:t(t({},Dn),{},{validator:function(e){var t=!0;return Object.keys(e).forEach((function(n){if(!nt(e[n]))return tn({api:\"initGroupAttributes\",param:\"groupAttributes\",desc:_n(\"value\")}),t=!1})),t}})},setGroupAttributes:{groupID:Cn,groupAttributes:t(t({},Dn),{},{validator:function(e){var t=!0;return Object.keys(e).forEach((function(n){if(!nt(e[n]))return tn({api:\"setGroupAttributes\",param:\"groupAttributes\",desc:_n(\"value\")}),t=!1})),t}})},deleteGroupAttributes:{groupID:Cn,keyList:{type:\"Array\",validator:function(e){if(it(e)||!at(e))return tn({api:\"deleteGroupAttributes\",param:\"keyList\",desc:cn()}),!1;if(!zt(e)){var t=!0;return e.forEach((function(e){if(!nt(e))return tn({api:\"deleteGroupAttributes\",param:\"keyList\",desc:Sn(\"StringArrayRequiredLog\")}),t=!1})),t}return!0}}},getGroupAttributes:{groupID:Cn,keyList:{type:\"Array\",validator:function(e){if(it(e)||!at(e))return tn({api:\"getGroupAttributes\",param:\"keyList\",desc:cn()}),!1;if(!zt(e)){var t=!0;return e.forEach((function(e){if(!nt(e))return tn({api:\"getGroupAttributes\",param:\"keyList\",desc:_n(\"key\")}),t=!1})),t}return!0}}},setGroupCounters:{groupID:Cn,counters:Dn},increaseGroupCounter:{groupID:Cn,key:Cn,value:En},decreaseGroupCounter:{groupID:Cn,key:Cn,value:En},getGroupCounters:{groupID:Cn},getGroupMemberList:{groupID:Cn,count:{type:\"Number\"}},getGroupMemberProfile:{groupID:Cn,userIDList:Tn,memberCustomFieldFilter:{type:\"Array\"}},addGroupMember:{groupID:Cn,userIDList:Tn},setGroupMemberRole:{groupID:Cn,userID:Cn,role:Cn},setGroupMemberMuteTime:{groupID:Cn,userID:Cn,muteTime:{type:\"Number\",validator:function(e){return e>=0}}},setGroupMemberNameCard:{groupID:Cn,userID:{type:\"String\"},nameCard:{type:\"String\",validator:function(e){return nt(e)?(e.length,!0):(tn({api:\"setGroupMemberNameCard\",param:\"nameCard\",desc:nn()}),!1)}}},setGroupMemberCustomField:{groupID:Cn,userID:{type:\"String\"},memberCustomField:Tn},deleteGroupMember:{groupID:Cn},markGroupMemberList:{groupID:Cn,markType:{type:\"number\",validator:function(e){return et(e)?!(e<1e3)||(tn({api:\"markGroupMemberList\",param:\"markType\",desc:(t=\"markType\",n=1e3,Sn(\"NumberGreaterOrEqualLog\",t,n))}),!1):(tn({api:\"markGroupMemberList\",param:\"markType\",desc:sn()}),!1);var t,n}},userIDList:t({},Tn),enableMark:t({},kn)},createTextMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){return st(e)?nt(e.text)?0!==e.text.length||(tn({api:\"createTextMessage\",param:\"payload.text\",desc:vn()}),!1):(tn({api:\"createTextMessage\",param:\"payload.text\",desc:nn()}),!1):(tn({api:\"createTextMessage\",param:\"payload\",desc:fn()}),!1)}})},createTextAtMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){return st(e)?nt(e.text)?0===e.text.length?(tn({api:\"createTextAtMessage\",param:\"payload.text\",desc:vn()}),!1):!(e.atUserList&&!at(e.atUserList))||(tn({api:\"createTextAtMessage\",param:\"payload.atUserList\",desc:cn()}),!1):(tn({api:\"createTextAtMessage\",param:\"payload.text\",desc:nn()}),!1):(tn({api:\"createTextAtMessage\",param:\"payload\",desc:fn()}),!1)}})},createCustomMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){return st(e)?e.data&&!nt(e.data)?(tn({api:\"createCustomMessage\",param:\"payload.data\",desc:nn()}),!1):e.description&&!nt(e.description)?(tn({api:\"createCustomMessage\",param:\"payload.description\",desc:nn()}),!1):!(e.extension&&!nt(e.extension))||(tn({api:\"createCustomMessage\",param:\"payload.extension\",desc:nn()}),!1):(tn({api:\"createCustomMessage\",param:\"payload\",desc:fn()}),!1)}})},createImageMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){if(!st(e))return tn({api:\"createImageMessage\",param:\"payload\",desc:fn()}),!1;if(it(e.file))return tn({api:\"createImageMessage\",param:\"payload.file\",desc:an()}),!1;if(ie){if(!(e.file instanceof HTMLInputElement||$e(e.file)))return st(e.file)&&\"undefined\"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(tn({api:\"createImageMessage\",param:\"payload.file\",desc:mn()}),!1):(tn({api:\"createImageMessage\",param:\"payload.file\",desc:rn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return tn({api:\"createImageMessage\",param:\"payload.file\",desc:mn()}),!1}return!0},onProgress:{type:\"Function\",required:!1,validator:function(e){return it(e)&&tn({api:\"createImageMessage\",param:\"onProgress\",desc:dn()}),!0}}})},createAudioMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){return!!st(e)||(tn({api:\"createAudioMessage\",param:\"payload\",desc:fn()}),!1)}}),onProgress:{type:\"Function\",required:!1,validator:function(e){return it(e)&&tn({api:\"createAudioMessage\",param:\"onProgress\",desc:dn()}),!0}}},createVideoMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){if(!st(e))return tn({api:\"createVideoMessage\",param:\"payload\",desc:fn()}),!1;if(it(e.file))return tn({api:\"createVideoMessage\",param:\"payload.file\",desc:an()}),!1;if(ie){if(!(e.file instanceof HTMLInputElement||$e(e.file)))return st(e.file)&&\"undefined\"!=typeof uni?!!$e(e.file.tempFile)||(tn({api:\"createVideoMessage\",param:\"payload.file\",desc:mn()}),!1):(tn({api:\"createVideoMessage\",param:\"payload.file\",desc:rn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return tn({api:\"createVideoMessage\",param:\"payload.file\",desc:mn()}),!1}return!0}}),onProgress:{type:\"Function\",required:!1,validator:function(e){return it(e)&&tn({api:\"createVideoMessage\",param:\"onProgress\",desc:dn()}),!0}}},createFaceMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){return st(e)?et(e.index)?!!nt(e.data)||(tn({api:\"createFaceMessage\",param:\"payload.data\",desc:nn()}),!1):(tn({api:\"createFaceMessage\",param:\"payload.index\",desc:sn()}),!1):(tn({api:\"createFaceMessage\",param:\"payload\",desc:fn()}),!1)}})},createFileMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){if(!st(e))return tn({api:\"createFileMessage\",param:\"payload\",desc:fn()}),!1;if(it(e.file))return tn({api:\"createFileMessage\",param:\"payload.file\",desc:an()}),!1;if(ie){if(!(e.file instanceof HTMLInputElement||$e(e.file)))return st(e.file)&&\"undefined\"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(tn({api:\"createFileMessage\",param:\"payload.file\",desc:mn()}),!1):(tn({api:\"createFileMessage\",param:\"payload.file\",desc:rn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return tn({api:\"createFileMessage\",param:\"payload.file\",desc:mn()}),!1}return!0}}),onProgress:{type:\"Function\",required:!1,validator:function(e){return it(e)&&tn({api:\"createFileMessage\",param:\"onProgress\",desc:dn()}),!0}}},createLocationMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){return st(e)?nt(e.description)?et(e.longitude)?!!et(e.latitude)||(tn({api:\"createLocationMessage\",param:\"payload.latitude\",desc:sn()}),!1):(tn({api:\"createLocationMessage\",param:\"payload.longitude\",desc:sn()}),!1):(tn({api:\"createLocationMessage\",param:\"payload.description\",desc:nn()}),!1):(tn({api:\"createLocationMessage\",param:\"payload\",desc:fn()}),!1)}})},createMergerMessage:{to:Cn,conversationType:Cn,payload:t(t({},Dn),{},{validator:function(e){if(zt(e.messageList))return tn({api:\"createMergerMessage\",param:\"payload.messageList\",desc:ln()}),!1;if(zt(e.compatibleText))return tn({api:\"createMergerMessage\",param:\"payload.compatibleText\",desc:on(\"compatibleText\")}),!1;var t=!1;return e.messageList.forEach((function(e){e.status===Qt.FAIL&&(t=!0)})),!t||(tn({api:\"createMergerMessage\",param:\"payload.messageList\",desc:Sn(\"MergeFailedMessageLog\")}),!1)}})},revokeMessage:[t(t({name:\"message\"},Dn),{},{validator:function(e){return zt(e)?(tn({api:\"revokeMessage\",param:\"message\",desc:Mn()}),!1):e.conversationType===E.CONV_SYSTEM?(tn({api:\"revokeMessage\",param:\"message\",desc:Sn(\"MessageCanBeRevokedDesc\")}),!1):!0!==e.isRevoked||(tn({api:\"revokeMessage\",param:\"message\",desc:Sn(\"MessageRevokedLog\")}),!1)}})],deleteMessage:[t(t({name:\"messageList\"},Tn),{},{validator:function(e){return!zt(e)||(tn({api:\"deleteMessage\",param:\"messageList\",desc:ln()}),!1)}})],translateText:{sourceTextList:Tn,sourceLanguage:Cn,targetLanguage:Cn},modifyMessage:[t(t({name:\"message\"},Dn),{},{validator:function(e){return zt(e)?(tn({api:\"modifyMessage\",param:\"message\",desc:Mn()}),!1):e.conversationType===E.CONV_SYSTEM?(tn({api:\"modifyMessage\",param:\"message\",desc:Sn(\"MessageCanBeModifiedLog\")}),!1):!0!==e._onlineOnlyFlag||(tn({api:\"modifyMessage\",param:\"message\",desc:Sn(\"OnlineMessageNotSupportLog\")}),!1)}})],getUserProfile:{userIDList:{type:\"Array\",validator:function(e){return at(e)?(0===e.length&&tn({api:\"getUserProfile\",param:\"userIDList\",desc:ln()}),!0):(tn({api:\"getUserProfile\",param:\"userIDList\",desc:cn()}),!1)}}},updateMyProfile:{profileCustomField:{type:\"Array\",validator:function(e){return!!it(e)||(!!at(e)||(tn({api:\"updateMyProfile\",param:\"profileCustomField\",desc:cn()}),!1))}}},setSelfStatus:{customStatus:{type:\"String\",validator:function(e){return!!nt(e)||(tn({api:\"setSelfStatus\",param:\"customStatus\",desc:nn()}),!1)}}},getUserStatus:{userIDList:{type:\"Array\",validator:function(e){return at(e)?0!==e.length||(tn({api:\"getUserStatus\",param:\"userIDList\",desc:ln()}),!1):(tn({api:\"getUserStatus\",param:\"userIDList\",desc:cn()}),!1)}}},subscribeUserStatus:{userIDList:{type:\"Array\",validator:function(e){return at(e)?0!==e.length||(tn({api:\"subscribeUserStatus\",param:\"userIDList\",desc:ln()}),!1):(tn({api:\"subscribeUserStatus\",param:\"userIDList\",desc:cn()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:\"Array\",validator:function(e){return!e||(!!at(e)||(tn({api:\"subscribeUserStatus\",param:\"userIDList\",desc:cn()}),!1))}}},addFriend:{to:Cn,source:{type:\"String\",required:!0,validator:function(e){return!!e&&(e.startsWith(\"AddSource_Type_\")?!(e.replace(\"AddSource_Type_\",\"\").length>8)||(tn({api:\"addFriend\",param:\"source\",desc:gn(\"keyword\",8)}),!1):(tn({api:\"addFriend\",param:\"source\",desc:Sn(\"SourcePrefixLog\")}),!1))}},remark:{type:\"String\",required:!1,validator:function(e){return!(nt(e)&&e.length>96)||(tn({api:\"addFriend\",param:\"remark\",desc:gn(\"remark\",96)}),!1)}}},deleteFriend:{userIDList:Tn},checkFriend:{userIDList:Tn},getFriendProfile:{userIDList:Tn},updateFriend:{userID:Cn,remark:{type:\"String\",required:!1,validator:function(e){return!(nt(e)&&e.length>96)||(tn({api:\"updateFriend\",param:\"remark\",desc:gn(\"remark\",96)}),!1)}},friendCustomField:{type:\"Array\",required:!1,validator:function(e){if(e){if(!at(e))return tn({api:\"updateFriend\",param:\"friendCustomField\",desc:cn()}),!1;var t=!0;return e.forEach((function(e){return nt(e.key)&&-1!==e.key.indexOf(\"Tag_SNS_Custom\")?nt(e.value)?e.key.replace(\"Tag_SNS_Custom_\",\"\").length>8?(tn({api:\"updateFriend\",param:\"friendCustomField\",desc:gn(\"keyword\",8)}),t=!1):void 0:(tn({api:\"updateFriend\",param:\"friendCustomField\",desc:_n(\"value\")}),t=!1):(tn({api:\"updateFriend\",param:\"friendCustomField\",desc:Sn(\"FriendCustomFieldPrefixLog\")}),t=!1)})),t}return!0}}},acceptFriendApplication:{userID:Cn},refuseFriendApplication:{userID:Cn},deleteFriendApplication:{userID:Cn},createFriendGroup:{name:Cn},deleteFriendGroup:{name:Cn},addToFriendGroup:{name:Cn,userIDList:Tn},removeFromFriendGroup:{name:Cn,userIDList:Tn},renameFriendGroup:{oldName:Cn,newName:Cn},sendMessageReadReceipt:[{name:\"messageList\",type:\"Array\",validator:function(e){return at(e)?0!==e.length||(tn({api:\"sendMessageReadReceipt\",param:\"messageList\",desc:ln()}),!1):(tn({api:\"sendMessageReadReceipt\",param:\"messageList\",desc:cn()}),!1)}}],getMessageReadReceiptList:[{name:\"messageList\",type:\"Array\",validator:function(e){return at(e)?0!==e.length||(tn({api:\"getMessageReadReceiptList\",param:\"messageList\",desc:ln()}),!1):(tn({api:\"getMessageReadReceiptList\",param:\"messageList\",desc:cn()}),!1)}}],createTopicInCommunity:{groupID:Cn,topicName:Cn},deleteTopicFromCommunity:{groupID:Cn,topicIDList:{type:\"Array\",validator:function(e){return!e||(!!at(e)||(tn({api:\"deleteTopicFromCommunity\",param:\"topicIDList\",desc:cn()}),!1))}}},updateTopicProfile:{groupID:Cn,topicID:Cn},getTopicList:{groupID:Cn,topicIDList:{type:\"Array\",validator:function(e){return!e||(!!at(e)||(tn({api:\"getTopicList\",param:\"topicIDList\",desc:cn()}),!1))}}}},An={login:1,logout:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,setMessageRemindType:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,callExperimentalAPI:1},Rn=1,Nn=2,On=3,Gn=4,Un=6,Pn=7,bn=8,wn=9,Fn=10,qn=11,xn=12,Vn=13,Bn=14,Hn=15,Kn=16,Wn=17,Yn=18,jn=19,zn=20,Jn=21,Xn=22,Zn=23,Qn=24,$n=25,eo=26,to=27,no=28,oo=29,so=30,ao=31,io=32,ro=37,uo=function(){function e(t){o(this,e),this._m=t,this._n=\"\"}return a(e,[{key:\"isLoggedIn\",value:function(){return this._m.getModule(xn).isLoggedIn()}},{key:\"isOversea\",value:function(){return this._m.getModule(xn).isOversea()}},{key:\"isPrivateNetWork\",value:function(){return this._m.getModule(xn).isPrivateNetWork()}},{key:\"getFileDownloadProxy\",value:function(){return this._m.getModule(xn).getFileDownloadProxy()}},{key:\"getMyUserID\",value:function(){return this._m.getModule(xn).getUserID()}},{key:\"getMyTinyID\",value:function(){return this._m.getModule(xn).getTinyID()}},{key:\"getSDKAppID\",value:function(){return this._m.getModule(xn).getSDKAppID()}},{key:\"isIntl\",value:function(){return this._m.getModule(xn).isIntl()}},{key:\"isDevMode\",value:function(){return this._m.getModule(xn).isDevMode()}},{key:\"getModule\",value:function(e){return this._m.getModule(e)}},{key:\"getPlatform\",value:function(){return ge}},{key:\"getNetworkType\",value:function(){return this._m.getModule(Hn).getNetworkType()}},{key:\"probeNetwork\",value:function(e){return this._m.getModule(Hn).probe(e)}},{key:\"getCloudConfig\",value:function(e){return this._m.getModule(Zn).getCloudConfig(e)}},{key:\"emitOuterEvent\",value:function(e,t){this._m.getOuterEmitterInstance().emit(e,t)}},{key:\"emitInnerEvent\",value:function(e,t){this._m.getInnerEmitterInstance().emit(e,t)}},{key:\"getInnerEmitterInstance\",value:function(){return this._m.getInnerEmitterInstance()}},{key:\"generateTjgID\",value:function(e){return this._m.getModule(xn).getTinyID()+\"-\"+e.random}},{key:\"filterModifiedMessage\",value:function(e){if(!zt(e)){var t=e.filter((function(e){return!0===e.isModified}));t.length>0&&this.emitOuterEvent(k.MESSAGE_MODIFIED,t)}}},{key:\"filterUnmodifiedMessage\",value:function(e){return zt(e)?[]:e.filter((function(e){return!1===e.isModified}))}},{key:\"request\",value:function(e){return this._m.getModule(zn).request(e)}},{key:\"canIUse\",value:function(e){return this._m.getModule(to).canIUse(e)}},{key:\"getErrorMessage\",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:\"outputWarning\",value:function(e,t,n){var o=this.getErrorMessage(e,t,n);o&&Ve.w(o)}}]),e}(),co=\"wslogin\",lo=\"wslogout\",po=\"wshello\",go=\"KickOther\",ho=\"getmsg\",_o=\"authkey\",fo=\"sendmsg\",vo=\"send_group_msg\",mo=\"portrait_get_all\",Mo=\"portrait_set\",yo=\"black_list_get\",Io=\"black_list_add\",Co=\"black_list_delete\",To=\"msgwithdraw\",Do=\"msgreaded\",ko=\"set_c2c_peer_mute_notifications\",Eo=\"get_c2c_peer_mute_notifications\",So=\"getroammsg\",Lo=\"get_peer_read_time\",Ao=\"delete_c2c_msg_ramble\",Ro=\"modify_c2c_msg\",No=\"set_key_values\",Oo=\"get_key_values\",Go=\"page_get\",Uo=\"get\",Po=\"batch_delete\",bo=\"clear_msg\",wo=\"top\",Fo=\"deletemsg\",qo=\"set_conv_custom_data\",xo=\"mark_contact\",Vo=\"create_contact_group\",Bo=\"del_contact_group\",Ho=\"update_contact_group\",Ko=\"add_conv_to_group\",Wo=\"del_conv_from_group\",Yo=\"get_contact_group\",jo=\"get_joined_group_list\",zo=\"get_group_self_member_info\",Jo=\"create_group\",Xo=\"destroy_group\",Zo=\"modify_group_base_info\",Qo=\"apply_join_group\",$o=\"apply_join_group_noauth\",es=\"quit_group\",ts=\"get_group_public_info\",ns=\"change_group_owner\",os=\"handle_apply_join_group\",ss=\"handle_invite_join_permission_group\",as=\"handle_invite_join_group\",is=\"group_msg_recall\",rs=\"msg_read_report\",us=\"read_all_unread_msg\",cs=\"group_msg_get\",ls=\"get_group_msg_receipt\",ds=\"group_msg_receipt\",ps=\"c2c_msg_read_receipt\",gs=\"get_group_msg_receipt_detail\",hs=\"get_pendency\",_s=\"deletemsg\",fs=\"get_msg\",vs=\"get_msg_noauth\",ms=\"get_online_member_num\",Ms=\"delete_group_ramble_msg_by_seq\",ys=\"modify_group_msg\",Is=\"set_group_attr\",Cs=\"modify_group_attr\",Ts=\"delete_group_attr\",Ds=\"clear_group_attr\",ks=\"get_group_attr\",Es=\"group_set_key_values\",Ss=\"group_get_key_values\",Ls=\"get_group_notify\",As=\"update_group_counter\",Rs=\"get_group_counter\",Ns=\"get_group_member_info\",Os=\"get_members\",Gs=\"get_specified_group_member_info\",Us=\"add_group_member\",Ps=\"delete_group_member\",bs=\"ban_group_member\",ws=\"modify_group_member_info\",Fs=\"modify_user_info\",qs=\"cos\",xs=\"pre_sig\",Vs=\"video_cover\",Bs=\"tim_web_report_v2\",Hs=\"alive\",Ks=\"msg_push\",Ws=\"multi_msg_push_ws\",Ys=\"ws_msg_push_ack\",js=\"stat_forceoffline\",zs=\"save_relay_json_msg\",Js=\"get_relay_json_msg\",Xs=\"fetch_config\",Zs=\"push_configv2\",Qs=\"fetch_imsdk_purchase_bitsv2\",$s=\"push_imsdk_purchase_bitsv2\",ea=\"notify2\",ta=\"create_topic\",na=\"destroy_topic\",oa=\"modify_topic\",sa=\"get_topic\",aa=\"ws_set_custom_status\",ia=\"ws_get_user_status\",ra=\"ws_status_subscribe\",ua=\"ws_status_unsubscribe\",ca=\"ws_stat_background\",la=\"ws_stat_foreground\",da=\"ws_stat_settoken\",pa=\"get_local_words\",ga=\"ws_batch_trans_text\",ha={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MESSAGE_SEND_FAIL:2100,MESSAGE_SEND_FAIL_NOT_IN_AVCHATROOM:2101,MESSAGE_SEND_NEED_MESSAGE_INSTANCE:2105,MESSAGE_SEND_INVALID_CONVERSATION_TYPE:2106,MESSAGE_FILE_IS_EMPTY:2108,MESSAGE_ONPROGRESS_FUNCTION_ERROR:2109,MESSAGE_REVOKE_FAIL:2110,MESSAGE_DELETE_FAIL:2111,MESSAGE_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MESSAGE_LIST_EMPTY:2114,MESSAGE_SEND_GROUP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GROUP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,MESSAGE_IMAGE_SELECT_FILE_FIRST:2251,MESSAGE_IMAGE_TYPES_LIMIT:2252,MESSAGE_IMAGE_SIZE_LIMIT:2253,MESSAGE_AUDIO_UPLOAD_FAIL:2300,MESSAGE_AUDIO_SIZE_LIMIT:2301,MESSAGE_VIDEO_UPLOAD_FAIL:2350,MESSAGE_VIDEO_SIZE_LIMIT:2351,MESSAGE_VIDEO_TYPES_LIMIT:2352,MESSAGE_FILE_UPLOAD_FAIL:2400,MESSAGE_FILE_SELECT_FILE_FIRST:2401,MESSAGE_FILE_SIZE_LIMIT:2402,MESSAGE_FILE_URL_IS_EMPTY:2403,MESSAGE_MERGER_TYPE_INVALID:2450,MESSAGE_MERGER_KEY_INVALID:2451,MESSAGE_MERGER_DOWNLOAD_FAIL:2452,MESSAGE_FORWARD_TYPE_INVALID:2453,MESSAGE_MODIFY_CONFLICT:2480,MESSAGE_MODIFY_DISABLED_IN_AVCHATROOM:2481,CONVERSATION_NOT_FOUND:2500,USER_OR_GROUP_NOT_FOUND:2501,CONVERSATION_UN_RECORDED_TYPE:2502,INVALID_CONVERSATION_ID:2503,ILLEGAL_GROUP_TYPE:2600,CANNOT_JOIN_WORK:2601,ILLEGAL_GROUP_ID:2602,CANNOT_FIND_GROUP:2603,CANNOT_CHANGE_OWNER_IN_AVCHATROOM:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,CANNOT_DISMISS_WORK:2622,MEMBER_NOT_IN_GROUP:2623,JOIN_GROUP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AVCHATROOM:2661,CANNOT_JOIN_NON_AVCHATROOM_WITHOUT_LOGIN:2662,NOT_OWNER:2681,CANNOT_SET_MEMBER_ROLE_IN_WORK_AND_AVCHATROOM:2682,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GROUP_EXISTED:2710,FRIEND_GROUP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,CANNOT_FIND_PROTOCOL:2997,CANNOT_FIND_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,CANNOT_USE_COMMERCIAL_ABILITY:3122,PROFANITY_FOUND:3123,MESSAGE_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022},_a=\"networkRTT\",fa=\"messageE2EDelay\",va=\"sendMessageC2C\",ma=\"sendMessageGroup\",Ma=\"sendMessageGroupAV\",ya=\"sendMessageRichMedia\",Ia=\"cosUpload\",Ca=\"messageReceivedGroup\",Ta=\"messageReceivedGroupAVPush\",Da=\"messageReceivedGroupAVPull\",ka=(i(Zt={},_a,2),i(Zt,fa,3),i(Zt,va,4),i(Zt,ma,5),i(Zt,Ma,6),i(Zt,ya,7),i(Zt,Ca,8),i(Zt,Ta,9),i(Zt,Da,10),i(Zt,Ia,11),Zt),Ea={info:4,warning:5,error:6},Sa={wifi:1,\"2g\":2,\"3g\":3,\"4g\":4,\"5g\":5,unknown:6,none:7,online:8},La={login:4},Aa=function(){function e(t){o(this,e),this._n=\"SSOLogData\",this.eventType=La[t]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message=\"\",this.moreMessage=\"\",this.extension=t,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=Pe()}return a(e,[{key:\"updateTimeStamp\",value:function(){this.timestamp=Pe()}},{key:\"start\",value:function(e){return this._startts=e,this}},{key:\"end\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._sentFlag){var n=Pe();0===this.costTime&&(this.costTime=n-this._startts),this.setMoreMessage(\"startts:\".concat(this._startts,\" endts:\").concat(n)),t?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout((function(){e._sentFlag=!0,e._eventStatModule&&e._eventStatModule.pushIn(e)}),0)}}},{key:\"setError\",value:function(e,t,n){if(!(e instanceof Error))return Ve.w(\"\".concat(this._n,\".setError value not instanceof Error, please check!\")),this;if(this._sentFlag)return this;if(this.setNetworkType(n),t)e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message);else{var o=ha.NO_NETWORK;this.setCode(o)}return this.setLevel(\"error\"),this}},{key:\"setCode\",value:function(e){return it(e)||this._sentFlag||(\"ECONNABORTED\"===e&&(this.code=103),et(e)?this.code=e:Ve.w(\"\".concat(this._n,\".setCode value not a number, please check!\"),e,n(e))),this}},{key:\"setMessage\",value:function(e){return it(e)||this._sentFlag||(et(e)&&(this.message=e.toString()),nt(e)&&(this.message=e)),this}},{key:\"setCostTime\",value:function(e){return this.costTime=e,this}},{key:\"setLevel\",value:function(e){return it(e)||this._sentFlag||(this.level=Ea[e]),this}},{key:\"setMoreMessage\",value:function(e){return zt(this.moreMessage)?this.moreMessage=\"\".concat(e):this.moreMessage+=\" \".concat(e),this}},{key:\"setNetworkType\",value:function(e){if(it(e))Ve.w(\"\".concat(this._n,\".setNetworkType value is undefined, please check!\"));else{var t=Sa[e.toLowerCase()];it(t)||(this.networkType=t)}return this}},{key:\"getStartTs\",value:function(){return this._startts}},{key:\"setUIPlatform\",value:function(e){this.uiPlatform=e}}],[{key:\"bindEventStatModule\",value:function(t){e.prototype._eventStatModule=t}}]),e}(),Ra=function(){function e(t){o(this,e),this.type=E.MSG_TEXT,this.content={text:t.text||\"\"}}return a(e,[{key:\"setText\",value:function(e){this.content.text=e}},{key:\"sendable\",value:function(){return 0!==this.content.text.length}}]),e}(),Na=function(){function e(t,n){o(this,e),this._imageMemoryURL=\"\",this._fileDownloadProxy=n,ae?this.createImageDataASURLInWXMiniApp(t.file):this.createImageDataASURLInWeb(t.file),this._initImageInfoModel(),this.type=E.MSG_IMAGE,this._percent=0,this.content={imageFormat:t.imageFormat||Be.UNKNOWN,uuid:t.uuid,imageInfoArray:[]},this.initImageInfoArray(t.imageInfoArray),this._autoFixUrl()}return a(e,[{key:\"_initImageInfoModel\",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=_t(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.url||\"\",this.url=Yt(t.url||e._imageMemoryURL,e._fileDownloadProxy)},this._ImageInfoModel.prototype={setSizeType:function(e){this.sizeType=e},setType:function(e){this.type=e},setImageUrl:function(e){e&&(this.imageUrl=e)},getImageUrl:function(){return this.imageUrl}}}},{key:\"initImageInfoArray\",value:function(e){for(var t=0,n=null,o=null;t<=2;)o=it(e)||it(e[t])?{type:0,size:0,width:0,height:0,url:\"\"}:e[t],(n=new this._ImageInfoModel(o)).setSizeType(t+1),n.setType(t),this.addImageInfo(n),t++;this.updateAccessSideImageInfoArray()}},{key:\"updateImageInfoArray\",value:function(e){for(var t,n=this.content.imageInfoArray.length,o=0;o<n;o++)t=this.content.imageInfoArray[o],e[o].size&&(t.size=e[o].size),e[o].url&&t.setImageUrl(e[o].url),e[o].width&&(t.width=e[o].width),e[o].height&&(t.height=e[o].height)}},{key:\"_autoFixUrl\",value:function(){for(var e=this.content.imageInfoArray.length,t=\"\",n=\"\",o=[\"http\",\"https\"],s=null,a=0;a<e;a++)this.content.imageInfoArray[a].url&&\"\"!==(s=this.content.imageInfoArray[a]).imageUrl&&(n=s.imageUrl.slice(0,s.imageUrl.indexOf(\"://\")+1),t=s.imageUrl.slice(s.imageUrl.indexOf(\"://\")+1),o.indexOf(n)<0&&(n=\"https:\"),this.content.imageInfoArray[a].setImageUrl([n,t].join(\"\")))}},{key:\"updatePercent\",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:\"updateImageFormat\",value:function(e){this.content.imageFormat=Be[e.toUpperCase()]||Be.UNKNOWN}},{key:\"createImageDataASURLInWeb\",value:function(e){void 0!==e&&e.files.length>0&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:\"createImageDataASURLInWXMiniApp\",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:\"replaceImageInfo\",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:\"addImageInfo\",value:function(e){this.content.imageInfoArray.length>=3||this.content.imageInfoArray.push(e)}},{key:\"updateAccessSideImageInfoArray\",value:function(){var e=this.content.imageInfoArray,t=e[0],n=t.width,o=void 0===n?0:n,s=t.height,a=void 0===s?0:s;0!==o&&0!==a&&(Pt(e),Object.assign(e[2],Ut({originWidth:o,originHeight:a,min:720})))}},{key:\"sendable\",value:function(){return 0!==this.content.imageInfoArray.length&&(\"\"!==this.content.imageInfoArray[0].imageUrl&&0!==this.content.imageInfoArray[0].size)}}]),e}(),Oa=function(){function e(t){o(this,e),this.type=E.MSG_FACE,this.content=t||null}return a(e,[{key:\"sendable\",value:function(){return null!==this.content}}]),e}(),Ga=function(){function e(t,n){o(this,e),this.type=E.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:t.second,size:t.size,url:Yt(t.url,n),remoteAudioUrl:t.url||\"\",uuid:t.uuid}}return a(e,[{key:\"updatePercent\",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:\"updateAudioUrl\",value:function(e){this.content.remoteAudioUrl=e}},{key:\"sendable\",value:function(){return\"\"!==this.content.remoteAudioUrl}}]),e}(),Ua={from:!0,groupID:!0,groupName:!0,to:!0},Pa=function(){function e(t){o(this,e),this.type=E.MSG_GRP_TIP,this.content={},this._initContent(t)}return a(e,[{key:\"_initContent\",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case\"remarkInfo\":break;case\"groupProfile\":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case\"operatorInfo\":break;case\"memberInfoList\":case\"msgMemberInfo\":t._updateMemberList(e[n]);break;case\"memberExtraInfo\":case\"onlineMemberInfo\":break;case\"memberNum\":t.content[n]=e[n],t.content.memberCount=e[n];break;case\"newGroupProfile\":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}})),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:\"_initGroupProfile\",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];Ua[o]&&(this.content.groupProfile[o]=e[o])}}},{key:\"_updateMemberList\",value:function(e){zt(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach((function(t){e.forEach((function(e){t.userID===e.userID&&Object.assign(t,e)}))}))}},{key:\"_initNewGroupProfile\",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];\"muteAllMembers\"!==o?this.content.newGroupProfile[o]=e[o]:this.content.newGroupProfile[o]=1===e[o]}}}]),e}(),ba={from:!0,groupID:!0,groupName:!0,to:!0},wa=function(){function e(t){o(this,e),this.type=E.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(t)}return a(e,[{key:\"_initContent\",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case\"memberInfoList\":break;case\"remarkInfo\":t.content.handleMessage=e[n];break;case\"groupProfile\":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}}))}},{key:\"_initGroupProfile\",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];ba[o]&&(\"groupName\"===o?this.content.groupProfile.name=e[o]:this.content.groupProfile[o]=e[o])}}}]),e}(),Fa=function(){function e(t,n){o(this,e),this.type=E.MSG_FILE,this._percent=0;var s=this._getFileInfo(t);this.content={downloadFlag:2,fileUrl:Yt(t.url,n)||\"\",uuid:t.uuid,fileName:s.name||\"\",fileSize:s.size||0}}return a(e,[{key:\"_getFileInfo\",value:function(e){if(!it(e.fileName)&&!it(e.fileSize))return{size:e.fileSize,name:e.fileName};var t=e.file.files[0];if(oe){if(t.path&&-1!==t.path.indexOf(\".\")){var n=t.path.slice(t.path.lastIndexOf(\".\")+1).toLowerCase();t.type=n,t.name||(t.name=\"\".concat(_t(999999),\".\").concat(n))}t.name||(t.type=\"\",t.name=t.path.slice(t.path.lastIndexOf(\"/\")+1).toLowerCase()),t.suffix&&(t.type=t.suffix),t.url||(t.url=t.path)}return{size:t.size,name:t.name}}},{key:\"updatePercent\",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:\"updateFileUrl\",value:function(e){this.content.fileUrl=e}},{key:\"sendable\",value:function(){return\"\"!==this.content.fileUrl&&(\"\"!==this.content.fileName&&0!==this.content.fileSize)}}]),e}(),qa=function(){function e(t){o(this,e),this.type=E.MSG_CUSTOM,this.content={data:t.data||\"\",description:t.description||\"\",extension:t.extension||\"\"}}return a(e,[{key:\"setData\",value:function(e){return this.content.data=e,this}},{key:\"setDescription\",value:function(e){return this.content.description=e,this}},{key:\"setExtension\",value:function(e){return this.content.extension=e,this}},{key:\"sendable\",value:function(){return 0!==this.content.data.length||0!==this.content.description.length||0!==this.content.extension.length}}]),e}(),xa=function(){function e(t,n){o(this,e),this.type=E.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:t.remoteVideoUrl||t.videoUrl||\"\",videoFormat:t.videoFormat,videoSecond:parseInt(t.videoSecond,10),videoSize:t.videoSize,videoUrl:Yt(t.videoUrl,n),videoDownloadFlag:2,videoUUID:t.videoUUID,thumbUUID:t.thumbUUID,thumbFormat:t.thumbFormat,thumbWidth:t.thumbWidth,snapshotWidth:t.thumbWidth,thumbHeight:t.thumbHeight,snapshotHeight:t.thumbHeight,thumbSize:t.thumbSize,snapshotSize:t.thumbSize,thumbDownloadFlag:2,thumbUrl:Yt(t.thumbUrl,n),snapshotUrl:Yt(t.thumbUrl,n)}}return a(e,[{key:\"updatePercent\",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:\"updateVideoUrl\",value:function(e){e&&(this.content.remoteVideoUrl=e)}},{key:\"updateSnapshotInfo\",value:function(e){var t=e.snapshotUrl,n=e.snapshotWidth,o=e.snapshotHeight;zt(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),zt(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),zt(o)||(this.content.thumbHeight=this.content.snapshotHeight=Number(o))}},{key:\"sendable\",value:function(){return\"\"!==this.content.remoteVideoUrl}}]),e}(),Va=function(){function e(t){o(this,e),this.type=E.MSG_LOCATION;var n=t.description,s=t.longitude,a=t.latitude;this.content={description:n,longitude:s,latitude:a}}return a(e,[{key:\"sendable\",value:function(){return!0}}]),e}(),Ba=function(){function e(t,n){if(o(this,e),this.from=t.from,this.messageSender=t.from,this.time=t.time,this.messageSequence=t.sequence,this.clientSequence=t.clientSequence||t.sequence,this.messageRandom=t.random,this.cloudCustomData=t.cloudCustomData||\"\",this.clientTime=t.clientTime||void 0,t.ID)this.ID=t.ID||\"\",this.nick=t.nick||\"\",this.avatar=t.avatar||\"\",this.messageBody=[{type:t.type,payload:t.payload}],t.conversationType.startsWith(E.CONV_C2C)?this.receiverUserID=t.to:t.conversationType.startsWith(E.CONV_GROUP)&&(this.receiverGroupID=t.to),this.messageReceiver=t.to;else{this.nick=t.nick||\"\",this.avatar=t.avatar||\"\",this.messageBody=[];var s=t.elements[0].type,a=t.elements[0].content;this._patchRichMediaPayload(s,a),this._updateRichMediaDownloadUrl(s,a,n),s===E.MSG_MERGER?this.messageBody.push({type:s,payload:new Ha(a).content}):this.messageBody.push({type:s,payload:a}),t.groupID&&(this.receiverGroupID=t.groupID,this.messageReceiver=t.groupID),t.to&&(this.receiverUserID=t.to,this.messageReceiver=t.to),this.ID=\"\".concat(t.tinyID,\"-\").concat(t.clientTime,\"-\").concat(t.random)}}return a(e,[{key:\"_patchRichMediaPayload\",value:function(e,t){e===E.MSG_IMAGE?t.imageInfoArray.forEach((function(e){!e.imageUrl&&e.url&&(e.imageUrl=e.url,e.sizeType=e.type,1===e.type?e.type=0:3===e.type&&(e.type=1))})):e===E.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===E.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===E.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}},{key:\"_updateRichMediaDownloadUrl\",value:function(e,t,n){n&&(e===E.MSG_IMAGE?t.imageInfoArray.forEach((function(e){e.url=Yt(e.url,n)})):e===E.MSG_VIDEO?(t.videoUrl=Yt(t.videoUrl,n),t.snapshotUrl=Yt(t.thumbUrl,n),t.snapshotHeight=t.thumbHeight,t.snapshotWidth=t.thumbWidth):e===E.MSG_AUDIO?t.url=Yt(t.url,n):e===E.MSG_FILE&&(t.fileUrl=Yt(t.fileUrl,n)))}}]),e}(),Ha=function(){function e(t,n){if(o(this,e),this.type=E.MSG_MERGER,this.content={downloadKey:\"\",pbDownloadKey:\"\",messageList:[],title:\"\",abstractList:[],compatibleText:\"\",version:0,layersOverLimit:!1},t.downloadKey){var s=t.downloadKey,a=t.pbDownloadKey,i=t.title,r=t.abstractList,u=t.compatibleText,c=t.version;this.content.downloadKey=s,this.content.pbDownloadKey=a,this.content.title=i,this.content.abstractList=r,this.content.compatibleText=u,this.content.version=c||0}else if(zt(t.messageList))1===t.layersOverLimit&&(this.content.layersOverLimit=!0);else{var l=t.messageList,d=t.title,p=t.abstractList,g=t.compatibleText,h=t.version,_=[];l.forEach((function(e){if(!zt(e)){var t=new Ba(e,n);_.push(t)}})),this.content.messageList=_,this.content.title=d,this.content.abstractList=p,this.content.compatibleText=g,this.content.version=h||0}}return a(e,[{key:\"sendable\",value:function(){return!zt(this.content.messageList)||!zt(this.content.downloadKey)}}]),e}(),Ka={1:E.MSG_PRIORITY_HIGH,2:E.MSG_PRIORITY_NORMAL,3:E.MSG_PRIORITY_LOW,4:E.MSG_PRIORITY_LOWEST},Wa=function(){function e(t){o(this,e),this.ID=\"\",this.conversationID=t.conversationID||null,this.conversationType=t.conversationType||E.CONV_C2C,this.conversationSubType=t.conversationSubType,this.time=t.time||Math.ceil(Date.now()/1e3),this.sequence=t.sequence||0,this.clientSequence=t.clientSequence||t.sequence||0,this.random=t.random||0===t.random?t.random:_t(),this.priority=this._computePriority(t.priority),this.nick=t.nick||\"\",this.avatar=t.avatar||\"\",this.isPeerRead=!1,this.nameCard=\"\",this._elements=[],this.isPlaceMessage=t.isPlaceMessage||0,this.isRevoked=2===t.isPlaceMessage||8===t.msgFlagBits,this.from=t.from||null,this.to=t.to||null,this.flow=\"\",this.isSystemMessage=t.isSystemMessage||!1,this.protocol=t.protocol||\"JSON\",this.isResend=!1,this.isRead=!1,this.status=t.status||Qt.SUCCESS,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=t.cloudCustomData||\"\",this.isDeleted=!1,this.isModified=!1,this._isExcludedFromUnreadCount=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromUnreadCount),this._isExcludedFromLastMessage=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromLastMessage),this.clientTime=t.clientTime||we()||0,this.senderTinyID=t.senderTinyID||t.tinyID||\"\",this.readReceiptInfo=t.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0},this.needReadReceipt=!0===t.needReadReceipt||1===t.needReadReceipt,this.version=t.messageVersion||0,this.isBroadcastMessage=t.isBroadcastMessage||!1,this._receiverList=t.receiverList||void 0,this.isSupportExtension=!0===t.isSupportExtension||1===t.isSupportExtension,this.revoker=t.revokerInfo&&t.revokerInfo.revoker||null,this.reInitialize(t.currentUser),this.extractGroupInfo(t.groupProfile||null),this.handleGroupAtInfo(t),this.initC2CReadReceiptInfo(t.readReceiptSentByPeer)}return a(e,[{key:\"elements\",get:function(){return this._elements}},{key:\"getElements\",value:function(){return this._elements}},{key:\"extractGroupInfo\",value:function(e){if(null!==e){nt(e.nick)&&(this.nick=e.nick),nt(e.avatar)&&(this.avatar=e.avatar);var t=e.messageFromAccountExtraInformation;st(t)&&nt(t.nameCard)&&(this.nameCard=t.nameCard)}}},{key:\"handleGroupAtInfo\",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach((function(e){e!==E.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:e}),t.atUserList.push(e)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(E.MSG_AT_ALL))})),at(e.groupAtInfo)&&e.groupAtInfo.forEach((function(e){0===e.groupAtAllFlag?t.atUserList.push(e.groupAtUserID):1===e.groupAtAllFlag&&t.atUserList.push(E.MSG_AT_ALL)}))}},{key:\"getGroupAtInfoList\",value:function(){return this._groupAtInfoList}},{key:\"_initProxy\",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:\"reInitialize\",value:function(e){e&&(this.status=this.from?Qt.SUCCESS:Qt.UNSEND,!this.from&&(this.from=e)),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:\"isSendable\",value:function(){return 0!==this._elements.length&&(\"function\"==typeof this._elements[0].sendable&&this._elements[0].sendable())}},{key:\"_initTo\",value:function(e){this.conversationType===E.CONV_GROUP&&(this.to=e.groupID)}},{key:\"_initSequence\",value:function(e){0===this.clientSequence&&e&&(this.clientSequence=function(e){if(!e)return!1;if(void 0===Mt[e]){var t=new Date,n=\"3\".concat(t.getHours()).slice(-2),o=\"0\".concat(t.getMinutes()).slice(-2),s=\"0\".concat(t.getSeconds()).slice(-2);Mt[e]=parseInt([n,o,s,\"0001\"].join(\"\")),n=null,o=null,s=null,Ve.l(\"autoIncrementIndex start index:\".concat(Mt[e]))}return Mt[e]++}(e)),0===this.sequence&&this.conversationType===E.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:\"generateMessageID\",value:function(){this.from===E.CONV_SYSTEM&&(this.senderTinyID=\"144115198244471703\"),this.ID=\"\".concat(this.senderTinyID,\"-\").concat(this.clientTime,\"-\").concat(this.random)}},{key:\"_initFlow\",value:function(e){\"\"!==e&&(e===this.from?(this.flow=\"out\",this.isRead=!0):this.flow=\"in\")}},{key:\"_concatConversationID\",value:function(e){var t=this.to,n=\"\",o=this.conversationType;o!==E.CONV_SYSTEM?(n=o===E.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID=n?\"\".concat(o).concat(n):null):this.conversationID=E.CONV_SYSTEM}},{key:\"isElement\",value:function(e){return e instanceof Ra||e instanceof Na||e instanceof Oa||e instanceof Ga||e instanceof Fa||e instanceof xa||e instanceof Pa||e instanceof wa||e instanceof qa||e instanceof Va||e instanceof Ha}},{key:\"setElement\",value:function(e,t){var n=this;if(this.isElement(e))return this._elements=[e],void this._initProxy();var o=function(e){if(e.type&&e.content)switch(e.type){case E.MSG_TEXT:n.setTextElement(e.content);break;case E.MSG_IMAGE:n.setImageElement(e.content,t);break;case E.MSG_AUDIO:n.setAudioElement(e.content,t);break;case E.MSG_FILE:n.setFileElement(e.content,t);break;case E.MSG_VIDEO:n.setVideoElement(e.content,t);break;case E.MSG_CUSTOM:n.setCustomElement(e.content);break;case E.MSG_LOCATION:n.setLocationElement(e.content);break;case E.MSG_GRP_TIP:n.setGroupTipElement(e.content);break;case E.MSG_GRP_SYS_NOTICE:n.setGroupSystemNoticeElement(e.content);break;case E.MSG_FACE:n.setFaceElement(e.content);break;case E.MSG_MERGER:n.setMergerElement(e.content,t)}};if(at(e))for(var s=0;s<e.length;s++)o(e[s]);else o(e);this._initProxy()}},{key:\"clearElement\",value:function(){this._elements.length=0}},{key:\"setTextElement\",value:function(e){var t=\"string\"==typeof e?e:e.text,n=new Ra({text:t});this._elements.push(n)}},{key:\"setImageElement\",value:function(e,t){var n=new Na(e,t);this._elements.push(n)}},{key:\"setAudioElement\",value:function(e,t){var n=new Ga(e,t);this._elements.push(n)}},{key:\"setFileElement\",value:function(e,t){var n=new Fa(e,t);this._elements.push(n)}},{key:\"setVideoElement\",value:function(e,t){var n=new xa(e,t);this._elements.push(n)}},{key:\"setLocationElement\",value:function(e){var t=new Va(e);this._elements.push(t)}},{key:\"setCustomElement\",value:function(e){var t=new qa(e);this._elements.push(t)}},{key:\"setGroupTipElement\",value:function(e){var t={},n=e.operationType;if(zt(e.memberInfoList)?e.operatorInfo&&(t=e.operatorInfo):n!==E.GRP_TIP_MBR_JOIN&&n!==E.GRP_TIP_MBR_KICKED_OUT&&n!==E.GRP_TIP_MBR_SET_ADMIN&&n!==E.GRP_TIP_MBR_CANCELED_ADMIN||(t=e.memberInfoList[0]),!zt(e.memberExtraInfo)){var o=e.memberExtraInfo.reason;e.msgMemberInfo.forEach((function(e){e.reason=o}))}var s=t,a=s.nick,i=s.avatar;nt(a)&&(this.nick=a),nt(i)&&(this.avatar=i);var r=new Pa(e);this._elements.push(r)}},{key:\"setGroupSystemNoticeElement\",value:function(e){var t=new wa(e);this._elements.push(t)}},{key:\"setFaceElement\",value:function(e){var t=new Oa(e);this._elements.push(t)}},{key:\"setMergerElement\",value:function(e,t){var n=new Ha(e,t);this._elements.push(n)}},{key:\"setIsRead\",value:function(e){this.isRead=e}},{key:\"setRelayFlag\",value:function(e){this._relayFlag=e}},{key:\"getRelayFlag\",value:function(){return this._relayFlag}},{key:\"_computePriority\",value:function(e){if(it(e))return E.MSG_PRIORITY_NORMAL;if(nt(e)&&-1!==Object.values(Ka).indexOf(e))return e;if(et(e)){var t=\"\"+e;if(-1!==Object.keys(Ka).indexOf(t))return Ka[t]}return E.MSG_PRIORITY_NORMAL}},{key:\"setNickAndAvatar\",value:function(e){var t=e.nick,n=e.avatar;nt(t)&&(this.nick=t),nt(n)&&(this.avatar=n)}},{key:\"setNameCard\",value:function(e){nt(e)&&(this.nameCard=e)}},{key:\"initC2CReadReceiptInfo\",value:function(e){this.conversationType===E.CONV_C2C&&!0===this.needReadReceipt&&(this.readReceiptInfo.isPeerRead=1===e)}}]),e}(),Ya=function(e){return{code:0,data:e||{}}},ja=function(e){r(n,e);var t=f(n);function n(e){var s;o(this,n),s=t.call(this);var a=e.code,i=e.message,r=e.data;return s.code=a,s.message=i||s._getErrorMessage(s.code),s.data=r||{},s}return a(n)}(p(Error)),za=null,Ja=function(e){za=e},Xa=function(e){return Promise.resolve(Ya(e))},Za=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof ja)return t&&null!==za&&za.emit(k.ERROR,e),Promise.reject(e);if(e instanceof Error){var n=new ja({code:ha.UNCAUGHT_ERROR});return t&&null!==za&&za.emit(k.ERROR,n),Promise.reject(n)}if(!it(e)&&!it(e.code)){var o=new ja(e);return t&&null!==za&&za.emit(k.ERROR,o),Promise.reject(o)}},Qa=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"C2CModule\",t._messageFromUnreadDBMap=new Map,t._signalingFromUnreadDBList=[],t}return a(s,[{key:\"onNewC2CMessage\",value:function(e){var t=e.dataList,n=e.isInstantMessage,o=e.C2CRemainingUnreadList,s=e.C2CPairUnreadList;Ve.d(\"\".concat(this._n,\".onNewC2CMessage count:\").concat(t.length,\" isInstantMessage:\").concat(n));var a=this._newC2CMessageStoredAndSummary({dataList:t,C2CRemainingUnreadList:o,C2CPairUnreadList:s,isInstantMessage:n}),i=a.conversationOptionsList,r=a.messageList,u=a.isUnreadC2CMessage;(this.filterModifiedMessage(r),i.length>0)&&this.getModule(qn).onNewMessage({conversationOptionsList:i,isInstantMessage:n,isUnreadC2CMessage:u});var c=this.filterUnmodifiedMessage(r);n&&c.length>0&&this.emitOuterEvent(k.MESSAGE_RECEIVED,c),r.length=0}},{key:\"_newC2CMessageStoredAndSummary\",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,o=e.C2CPairUnreadList,s=e.isInstantMessage,a=null,i=[],r=[],u={},c=this.getModule(Kn),l=this.getModule(eo),d=!1,p=this.getModule(qn),g=this.getFileDownloadProxy(),h=0,_=t.length;h<_;h++)if(this._isSignaling(t[h]))this._signalingFromUnreadDBList.push(t[h].eventArray[0].c2CNotifyMsgArray[0]);else{var f=t[h];f.currentUser=this.getMyUserID(),f.conversationType=E.CONV_C2C,f.isSystemMessage=!!f.isSystemMessage,(it(f.nick)||it(f.avatar))&&(d=!0,Ve.d(\"\".concat(this._n,\"._newC2CMessageStoredAndSummary nick or avatar missing!\"))),a=new Wa(f),f.elements=c.parseElements(f.elements,f.from),a.setElement(f.elements,g),a.setNickAndAvatar({nick:f.nick,avatar:f.avatar});var v=a.conversationID;if(s){if(1===this._messageFromUnreadDBMap.get(a.ID))continue;var m=!1;if(a.from!==this.getMyUserID()){var M=p.getLatestMessageSentByPeer(v);if(M){var y=M.nick,I=M.avatar;d?a.setNickAndAvatar({nick:y,avatar:I}):y===a.nick&&I===a.avatar||(m=!0)}}else{var C=p.getLatestMessageSentByMe(v);if(C){var T=C.nick,D=C.avatar;T===a.nick&&D===a.avatar||p.modifyMessageSentByMe({conversationID:v,latestNick:a.nick,latestAvatar:a.avatar})}}var k=1===t[h].isModified;if(p.isMessageSentByCurrentInstance(a)?a.isModified=k:k=!1,0===f.msgLifeTime)a._onlineOnlyFlag=!0,p.isMessageSentByCurrentInstance(a)||r.push(a);else{if(!p.pushIntoMessageList(r,a,k))continue;m&&(p.modifyMessageSentByPeer({conversationID:v,latestNick:a.nick,latestAvatar:a.avatar}),p.updateUserProfileSpecifiedKey({conversationID:v,nick:a.nick,avatar:a.avatar}))}s&&a.clientTime>0&&l.addMessageDelay(a.clientTime)}else this._messageFromUnreadDBMap.set(a.ID,1);if(0!==f.msgLifeTime){if(!1===a._onlineOnlyFlag){var S=p.getLastMessageTime(v);if(et(S)&&a.time<S)continue;if(it(u[v])){var L=0;\"in\"===a.flow&&(a._isExcludedFromUnreadCount||(L=1)),u[v]=i.push({conversationID:v,unreadCount:L,type:a.conversationType,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?\"\":a})-1}else{var A=u[v];i[A].type=a.conversationType,i[A].subType=a.conversationSubType,i[A].lastMessage=a._isExcludedFromLastMessage?\"\":a,\"in\"===a.flow&&(a._isExcludedFromUnreadCount||i[A].unreadCount++)}}}else a._onlineOnlyFlag=!0}this._handleSignalingFromUnreadDB();var R=!1;if(at(o))for(var N=function(e,t){if(o[e].unreadCount>0){R=!0;var n=i.find((function(t){return t.conversationID===\"C2C\".concat(o[e].from)}));n?n.unreadCount=o[e].unreadCount:i.push({conversationID:\"C2C\".concat(o[e].from),unreadCount:o[e].unreadCount,type:E.CONV_C2C})}},O=0,G=o.length;O<G;O++)N(O);if(at(n))for(var U=function(e,t){i.find((function(t){return t.conversationID===\"C2C\".concat(n[e].from)}))||i.push({conversationID:\"C2C\".concat(n[e].from),type:E.CONV_C2C,lastMsgTime:n[e].lastMsgTime})},P=0,b=n.length;P<b;P++)U(P);return{conversationOptionsList:i,messageList:r,isUnreadC2CMessage:R}}},{key:\"_isSignaling\",value:function(e){var t=e.eventArray;return!(!at(t)||10!==t[0].event)}},{key:\"_handleSignalingFromUnreadDB\",value:function(){var e=this._signalingFromUnreadDBList.length;if(Ve.l(\"\".concat(this._n,\"._handleSignalingFromUnreadDB signalingCount:\").concat(e)),0!==e){var t=[];this._signalingFromUnreadDBList.forEach((function(e){e.hasOwnProperty(\"c2cMessageRevokedNotify\")&&t.push(e)})),this.onC2CMessageRevoked({dataList:t}),this._signalingFromUnreadDBList.length=0,t.length=0}}},{key:\"onC2CMessageRevoked\",value:function(e){var t=this,n=this.getModule(qn),o=[],s=null,a=!0;e.dataList.forEach((function(e){if(e.c2cMessageRevokedNotify){var i=e.c2cMessageRevokedNotify.revokedInfos;it(i)||i.forEach((function(e){var i=t.getMyUserID()===e.from?\"\".concat(E.CONV_C2C).concat(e.to):\"\".concat(E.CONV_C2C).concat(e.from);s=n.revoke(i,e.sequence,e.random);var r=e.revokerInfo&&e.revokerInfo.revoker;if(s)s.revoker||(s.revoker=r,o.push(s));else{var u={conversationID:i,sequence:e.sequence,time:e.time,revoker:r};n.isLastMessageRevoked(u)&&(o.push(u),a=!1)}}))}})),0!==o.length&&(n.onMessageRevoked(o),!0===a&&(Ve.l(\"\".concat(this._n,\".onC2CMessageRevoked count:\").concat(o.length)),this.emitOuterEvent(k.MESSAGE_REVOKED,o)))}},{key:\"onC2CMessageReadReceipt\",value:function(e){var t=this;e.dataList.forEach((function(e){if(!zt(e.c2cMessageReadReceipt)){var n=e.c2cMessageReadReceipt.to;e.c2cMessageReadReceipt.uinPairReadArray.forEach((function(e){var o=e.peerReadTime;Ve.d(\"\".concat(t._n,\"._onC2CMessageReadReceipt to:\").concat(n,\" peerReadTime:\").concat(o));var s=\"\".concat(E.CONV_C2C).concat(n),a=t.getModule(qn);a.recordPeerReadTime(s,o),a.updateMessageIsPeerReadProperty(s,o)}))}}))}},{key:\"onC2CMessageReadNotice\",value:function(e){var t=this;e.dataList.forEach((function(e){if(!zt(e.c2cMessageReadNotice)){var n=t.getModule(qn);e.c2cMessageReadNotice.uinPairReadArray.forEach((function(e){var o=e.from,s=e.peerReadTime;Ve.d(\"\".concat(t._n,\".onC2CMessageReadNotice from:\").concat(o,\" lastReadTime:\").concat(s));var a=\"\".concat(E.CONV_C2C).concat(o);n.updateIsReadAfterReadReport({conversationID:a,lastMessageTime:s}),n.updateUnreadCount(a)}))}}))}},{key:\"onC2CMessageModified\",value:function(e){Ve.d(\"\".concat(this._n,\".onC2CMessageModified options:\"),JSON.stringify(e));var n=this.getModule(qn);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:E.CONV_C2C}))}))}},{key:\"onReadReceiptList\",value:function(e){Ve.d(\"\".concat(this._n,\".onReadReceiptList options:\"),JSON.stringify(e));var t=e.dataList,n=t.userID,o=t.readReceiptList;this.getModule(qn).updateReadReceiptInfo({userID:n,readReceiptList:o})}},{key:\"sendMessage\",value:function(e,t){var n=this._createC2CMessagePack(e,t);return this.request(n)}},{key:\"_createC2CMessagePack\",value:function(e,t){var n=null;t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),!0===t.onlineUserOnly&&(n?n.disablePush=!0:n={disablePush:!0}));var o=\"\";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(o=e.cloudCustomData);var s=[];if(st(t)&&st(t.messageControlInfo)){var a=t.messageControlInfo,i=a.excludedFromUnreadCount,r=a.excludedFromLastMessage,u=a.excludedFromContentModeration;!0===i&&s.push(\"NoUnread\"),!0===r&&s.push(\"NoLastMsg\"),!0===u&&s.push(\"NoMsgCheck\")}var c=this.isOnlineMessage(e,t)?0:void 0;return{protocolName:fo,tjgID:this.generateTjgID(e),requestData:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:e.getElements(),cloudCustomData:o,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:c,nick:e.nick,avatar:e.avatar,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||\"\",desc:n.description||\"\",ext:n.extension||\"\",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||\"\"}}:void 0,messageControlInfo:0!==c?s:void 0,clientTime:e.clientTime,needReadReceipt:!0===e.needReadReceipt?1:0,isSupportExtension:!0===e.isSupportExtension?1:0}}}},{key:\"_isVoipPush\",value:function(e){var t=void 0;return it(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:\"isOnlineMessage\",value:function(e,t){return!(!t||!0!==t.onlineUserOnly)}},{key:\"revokeMessage\",value:function(e){return this.request({protocolName:To,requestData:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:\"deleteMessage\",value:function(e){var t=e.to,n=e.keyList;return Ve.l(\"\".concat(this._n,\".deleteMessage toAccount:\").concat(t,\" count:\").concat(n.length)),this.request({protocolName:Ao,requestData:{fromAccount:this.getMyUserID(),to:t,keyList:n}})}},{key:\"modifyRemoteMessage\",value:function(e){var t=e.from,n=e.to,o=e.version,s=void 0===o?0:o,a=e.sequence,i=e.random,r=e.time,u=e.payload,c=e.type,l=e.cloudCustomData,d=void 0;return Bt(c)&&(d=[]).push({type:c,content:u}),this.request({protocolName:Ro,requestData:{from:t,to:n,version:s,sequence:a,random:i,time:r,elements:d,cloudCustomData:l}})}},{key:\"setMessageRead\",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageTime,s=\"\".concat(this._n,\".setMessageRead\");Ve.l(\"\".concat(s,\" conversationID:\").concat(n,\" lastMessageTime:\").concat(o)),et(o)||this.outputWarning(\"DoNotModifyLastTime\");var a=new Aa(\"setC2CMessageRead\");return a.setMessage(\"conversationID:\".concat(n,\" lastMessageTime:\").concat(o)),this.request({protocolName:Do,requestData:{C2CMsgReaded:{cookie:\"\",C2CMsgReadedItem:[{toAccount:n.replace(\"C2C\",\"\"),lastMessageTime:o,receipt:1}]}}}).then((function(){a.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(s,\" ok\"));var e=t.getModule(qn);return e.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:o}),e.updateUnreadCount(n),Ya()})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.l(\"\".concat(s,\" failed. error:\"),e),Za(e)}))}},{key:\"getRoamingMessage\",value:function(e){var t=this,n=\"\".concat(this._n,\".getRoamingMessage\"),o=e.peerAccount,s=e.conversationID,a=e.count,i=e.lastMessageTime,r=e.messageKey,u=\"peerAccount:\".concat(o,\" count:\").concat(a||15,\" lastMessageTime:\").concat(i||0,\" messageKey:\").concat(r);Ve.l(\"\".concat(n,\" \").concat(u));var c=new Aa(\"getC2CRoamingMessages\");return this.request({protocolName:So,requestData:{peerAccount:o,count:a||15,lastMessageTime:i||0,messageKey:r}}).then((function(e){var o=e.data,a=o.complete,i=o.messageList,r=o.messageKey,l=o.lastMessageTime;it(i)?Ve.l(\"\".concat(n,\" ok. complete:\").concat(a,\" but messageList is undefined!\")):Ve.l(\"\".concat(n,\" ok. complete:\").concat(a,\" count:\").concat(i.length)),c.setNetworkType(t.getNetworkType()).setMessage(\"\".concat(u,\" complete:\").concat(a,\" length:\").concat(i.length)).end();var d=t.getModule(qn);1===a&&d.setCompleted(s);var p=d.onRoamingMessage(i,s);d.modifyMessageList(s),d.updateIsRead(s),d.updateRoamingMessageKeyAndTime(s,r,l);var g=d.getPeerReadTime(s);if(Ve.l(\"\".concat(n,\" update isPeerRead property. conversationID:\").concat(s,\" peerReadTime:\").concat(g)),g)d.updateMessageIsPeerReadProperty(s,g);else{var h=s.replace(E.CONV_C2C,\"\");t.getRemotePeerReadTime([h]).then((function(){d.updateMessageIsPeerReadProperty(s,d.getPeerReadTime(s))}))}var _=\"\";if(p.length>0)_=p[0].ID;else{var f=d.getLocalOldestMessage(s);f&&(_=f.ID)}return Ve.l(\"\".concat(n,\" nextReqID:\").concat(_,\" stored message count:\").concat(p.length)),{nextReqID:_,storedMessageList:p}})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];c.setMessage(u).setError(e,o,s).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"getRoamingMessagesHopping\",value:function(e){var t=this,n=\"\".concat(this._n,\".getRoamingMessagesHopping\"),o=e.peerAccount,s=e.time,a=void 0===s?0:s,i=e.count,r=e.direction,u=\"\".concat(E.CONV_C2C).concat(o),c=\"peerAccount:\".concat(o,\" count:\").concat(i,\" time:\").concat(a,\" direction:\").concat(r);Ve.l(\"\".concat(n,\" \").concat(c));var l=new Aa(\"getC2CRoamingMessagesHopping\");return this.request({protocolName:So,requestData:{peerAccount:o,count:i+1,lastMessageTime:a,direction:r}}).then((function(e){var o=e.data,s=o.complete,a=o.messageList,i=void 0===a?[]:a,d=o.lastMessageTime;Ve.l(\"\".concat(n,\" ok. complete:\").concat(s,\" count:\").concat(i.length)),l.setNetworkType(t.getNetworkType()).setMessage(\"\".concat(c,\" complete:\").concat(s,\" length:\").concat(i.length)).end(),1!==s&&(1===r?i.pop():i.shift());var p=t.getModule(qn).onRoamingMessage(i,u,!1);t._modifyMessageList(u,p);var g=t._computeResult({complete:s,lastMessageTime:d,resultList:p});return Ya(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];l.setMessage(c).setError(e,o,s).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_computeResult\",value:function(e){var t=e.complete,n=void 0===t?0:t,o=e.lastMessageTime,s=e.resultList,a={messageList:m(void 0===s?[]:s),isCompleted:!1,nextMessageTime:\"\"};return 1===n?(a.isCompleted=!0,a):(a.nextMessageTime=o,a)}},{key:\"_modifyMessageList\",value:function(e,t){var n=this.getModule(qn).getLocalConversation(e);if(n)for(var o=n.userProfile.nick,s=n.userProfile.avatar,a=this.getModule(Gn).getNickAndAvatarByUserID(this.getMyUserID()),i=a.nick,r=a.avatar,u=t.length-1;u>=0;u--){var c=t[u];\"in\"===c.flow&&(c.nick!==o&&c.setNickAndAvatar({nick:o}),c.avatar!==s&&c.setNickAndAvatar({avatar:s})),\"out\"===c.flow&&(c.nick!==i&&c.setNickAndAvatar({nick:i}),c.avatar!==r&&c.setNickAndAvatar({avatar:r}))}}},{key:\"getRemotePeerReadTime\",value:function(e){var t=this,n=\"\".concat(this._n,\".getRemotePeerReadTime\");if(zt(e))return Ve.w(\"\".concat(n,\" userIDList is empty!\")),Promise.resolve();var o=new Aa(\"getPeerReadTime\");return Ve.l(\"\".concat(n,\" userIDList:\").concat(e)),this.request({protocolName:Lo,requestData:{userIDList:e}}).then((function(s){var a=s.data.peerReadTimeList;Ve.l(\"\".concat(n,\" ok. peerReadTimeList:\").concat(a));for(var i=\"\",r=t.getModule(qn),u=0;u<e.length;u++)i+=\"\".concat(e[u],\"-\").concat(a[u],\" \"),a[u]>0&&r.recordPeerReadTime(\"C2C\".concat(e[u]),a[u]);o.setNetworkType(t.getNetworkType()).setMessage(i).end()})).catch((function(e){t.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e)}))}},{key:\"sendReadReceipt\",value:function(e){var t=this,n=e[0].conversationID.replace(E.CONV_C2C,\"\"),o=new Aa(\"sendC2CReadReceipt\");o.setMessage(\"peerAccount:\".concat(n));var s=this.getMyUserID(),a=e.filter((function(e){return e.from!==s&&!0===e.needReadReceipt})).map((function(e){return{fromAccount:e.from,toAccount:e.to,sequence:e.sequence,random:e.random,time:e.time,clientTime:e.clientTime}}));if(0===a.length)return Za({code:ha.READ_RECEIPT_MESSAGE_LIST_EMPTY});var i=\"\".concat(this._n,\".sendReadReceipt\");return Ve.l(\"\".concat(i,\". peerAccount:\").concat(n,\" messageInfoList length:\").concat(a.length)),this.request({protocolName:ps,requestData:{peerAccount:n,messageInfoList:a}}).then((function(e){return o.end(),Ve.l(\"\".concat(i,\" ok\")),Ya()})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.w(\"\".concat(i,\" failed. error:\"),e),Za(e)}))}},{key:\"getReadReceiptList\",value:function(e){var t=\"\".concat(this._n,\".getReadReceiptList\"),n=this.getMyUserID(),o=e.filter((function(e){return e.from===n&&!0===e.needReadReceipt}));return Ve.l(\"\".concat(t,\" userID:\").concat(n,\" messageList length:\").concat(o.length)),Xa({messageList:o})}},{key:\"getMessageExtensions\",value:function(e,t){return Ve.l(\"\".concat(this._n,\".getMessageExtensions startSequence:\").concat(t)),this.request({protocolName:Oo,requestData:{from:e.from,to:e.to,messageKey:this._getMessageKey(e),startSequence:t}})}},{key:\"modifyMessageExtensions\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ve.l(\"\".concat(this._n,\".modifyMessageExtensions operateType:\").concat(n)),this.request({protocolName:No,requestData:{from:e.from,to:e.to,messageKey:this._getMessageKey(e),extensionList:t,operateType:n}})}},{key:\"_getMessageKey\",value:function(e){var t=e.clientSequence,n=e.random,o=e.time;return\"\".concat(t,\"_\").concat(n,\"_\").concat(o)}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._messageFromUnreadDBMap.clear(),this._signalingFromUnreadDBList.length=0}}]),s}(uo),$a=function(){function e(){o(this,e),this.list=new Map,this._n=\"MessageListHandler\",this._latestMessageSentByPeerMap=new Map,this._latestMessageSentByMeMap=new Map}return a(e,[{key:\"getLocalOldestMessageByConversationID\",value:function(e){if(!e)return null;if(!this.list.has(e))return null;var t=this.list.get(e).values();return t?t.next().value:null}},{key:\"pushIn\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.conversationID,o=!0;this.list.has(n)||this.list.set(n,new Map);var s=this._getUniqueIDOfMessage(e),a=this.list.get(n).has(s);if(a){var i=this.list.get(n).get(s);if(!t||!0===i.isModified)return o=!1}return this.list.get(n).set(s,e),this._setLatestMessageSentByPeer(n,e),this._setLatestMessageSentByMe(n,e),o}},{key:\"unshift\",value:function(e,t){var n;if(at(e)?e.length>0&&(n=e[0].conversationID,this._unshiftMultipleMessages(e,t)):(n=e.conversationID,this._unshiftSingleMessage(e,t)),n&&n.startsWith(E.CONV_C2C)){var o=Array.from(this.list.get(n).values()),s=o.length;if(0===s)return;for(var a=s-1;a>=0;a--)if(\"out\"===o[a].flow){this._setLatestMessageSentByMe(n,o[a]);break}for(var i=s-1;i>=0;i--)if(\"in\"===o[i].flow){this._setLatestMessageSentByPeer(n,o[i]);break}}}},{key:\"_unshiftSingleMessage\",value:function(e,t){var n=e.conversationID,o=this._getUniqueIDOfMessage(e);if(!this.list.has(n))return this.list.set(n,new Map),this.list.get(n).set(o,e),void t.push(e);var s=this.list.get(n),a=Array.from(s);s.has(o)||(a.unshift([o,e]),this.list.set(n,new Map(a)),t.push(e))}},{key:\"_unshiftMultipleMessages\",value:function(e,t){for(var n=e.length,o=[],s=e[0].conversationID,a=this.list.get(s),i=this.list.has(s)?Array.from(a):[],r=0;r<n;r++){var u=this._getUniqueIDOfMessage(e[r]);a&&a.has(u)||(o.push([u,e[r]]),t.push(e[r]))}this.list.set(s,new Map(o.concat(i)))}},{key:\"remove\",value:function(e){var t=e.conversationID,n=this._getUniqueIDOfMessage(e);this.list.has(t)&&this.list.get(t).delete(n)}},{key:\"revoke\",value:function(e,t,n){if(Ve.d(\"revoke message\",e,t,n),this.list.has(e)){var o,s=D(this.list.get(e));try{for(s.s();!(o=s.n()).done;){var a=v(o.value,2)[1];if(a.sequence===t&&(it(n)||a.random===n))return a.isRevoked||(a.isRevoked=!0),a}}catch(i){s.e(i)}finally{s.f()}}return null}},{key:\"removeByConversationID\",value:function(e){this.list.has(e)&&(this.list.delete(e),this._latestMessageSentByPeerMap.delete(e),this._latestMessageSentByMeMap.delete(e))}},{key:\"findMessage\",value:function(e){var t,n=null,o=D(this.list);try{for(o.s();!(t=o.n()).done;)for(var s=m(v(t.value,2)[1].values()),a=s.length,i=0;i<a;i++)if(s[i].ID===e){n=s[i];break}}catch(r){o.e(r)}finally{o.f()}return n}},{key:\"updateMessageIsPeerReadProperty\",value:function(e,t){var n=[];if(this.list.has(e)){var o,s=D(this.list.get(e));try{for(s.s();!(o=s.n()).done;){var a=v(o.value,2)[1];a.time<=t&&!a.isPeerRead&&\"out\"===a.flow&&(a.isPeerRead=!0,n.push(a))}}catch(i){s.e(i)}finally{s.f()}Ve.l(\"\".concat(this._n,\".updateMessageIsPeerReadProperty conversationID:\").concat(e,\" peerReadTime:\").concat(t,\" count:\").concat(n.length))}return n}},{key:\"updateMessageIsModifiedProperty\",value:function(e){var t=e.conversationID;if(this.list.has(t)){var n=this._getUniqueIDOfMessage(e),o=this.list.get(t).get(n);o&&(o.isModified=!0)}}},{key:\"hasLocalMessageList\",value:function(e){return this.list.has(e)}},{key:\"getLocalMessageList\",value:function(e){return this.hasLocalMessageList(e)?m(this.list.get(e).values()):[]}},{key:\"hasLocalMessage\",value:function(e,t){for(var n=!1,o=this.getLocalMessageList(e),s=o.length,a=0;a<s;a++)o[a].ID===t&&(n=!0);return n}},{key:\"getLocalMessage\",value:function(e,t){for(var n=null,o=this.getLocalMessageList(e),s=o.length,a=0;a<s;a++)if(o[a].ID===t){n=o[a];break}return n}},{key:\"getLocalLastMessage\",value:function(e){var t=this.getLocalMessageList(e);return t[t.length-1]}},{key:\"getLocalOldestMessage\",value:function(e){return this.getLocalMessageList(e)[0]}},{key:\"_setLatestMessageSentByPeer\",value:function(e,t){e.startsWith(E.CONV_C2C)&&\"in\"===t.flow&&this._latestMessageSentByPeerMap.set(e,t)}},{key:\"_setLatestMessageSentByMe\",value:function(e,t){e.startsWith(E.CONV_C2C)&&\"out\"===t.flow&&this._latestMessageSentByMeMap.set(e,t)}},{key:\"getLatestMessageSentByPeer\",value:function(e){return this._latestMessageSentByPeerMap.get(e)}},{key:\"getLatestMessageSentByMe\",value:function(e){return this._latestMessageSentByMeMap.get(e)}},{key:\"modifyMessageSentByPeer\",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar,s=this.list.get(t);if(!zt(s)){var a=Array.from(s.values()),i=a.length;if(0!==i){for(var r=null,u=0,c=!1,l=i-1;l>=0;l--)\"in\"===a[l].flow&&((r=a[l]).nick!==n&&(r.setNickAndAvatar({nick:n}),c=!0),r.avatar!==o&&(r.setNickAndAvatar({avatar:o}),c=!0),c&&(u+=1));Ve.l(\"\".concat(this._n,\".modifyMessageSentByPeer conversationID:\").concat(t,\" count:\").concat(u))}}}},{key:\"modifyMessageSentByMe\",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar,s=this.list.get(t);if(!zt(s)){var a=Array.from(s.values()),i=a.length;if(0!==i){for(var r=null,u=0,c=!1,l=i-1;l>=0;l--)\"out\"===a[l].flow&&((r=a[l]).nick!==n&&(r.setNickAndAvatar({nick:n}),c=!0),r.avatar!==o&&(r.setNickAndAvatar({avatar:o}),c=!0),c&&(u+=1));Ve.l(\"\".concat(this._n,\".modifyMessageSentByMe conversationID:\").concat(t,\" count:\").concat(u))}}}},{key:\"getTopicConversationIDList\",value:function(e){return m(this.list.keys()).filter((function(t){return t.startsWith(\"\".concat(E.CONV_GROUP).concat(e))}))}},{key:\"traversal\",value:function(){if(0!==this.list.size&&-1===Ve.getLevel()){console.group(\"conversationID-messageCount\");var e,t=D(this.list);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2),o=n[0],s=n[1];console.log(\"\".concat(o,\"-\").concat(s.size))}}catch(a){t.e(a)}finally{t.f()}console.groupEnd()}}},{key:\"onMessageModified\",value:function(e,t){if(!this.list.has(e))return{isUpdated:!1,message:null};var n=this._getUniqueIDOfMessage(t),o=this.list.get(e).has(n);if(Ve.d(\"\".concat(this._n,\".onMessageModified conversationID:\").concat(e,\" uniqueID:\").concat(n,\" has:\").concat(o)),o){var s=this.list.get(e).get(n),a=t.messageVersion,i=t.elements,r=t.cloudCustomData;return s.version<a?(s.version=a,s._elements=JSON.parse(JSON.stringify(i)),s.payload=JSON.parse(JSON.stringify(i[0].content)),s.type=i[0].type,s.cloudCustomData=r,s.isModified=!0,{isUpdated:!0,message:s}):{isUpdated:!1,message:s}}return{isUpdated:!1,message:null}}},{key:\"_getUniqueIDOfMessage\",value:function(e){var t=e.from,n=e.to,o=e.random,s=e.sequence,a=e.time;return\"\".concat(t,\"-\").concat(n,\"-\").concat(o,\"-\").concat(s,\"-\").concat(a)}},{key:\"reset\",value:function(){this.list.clear(),this._latestMessageSentByPeerMap.clear(),this._latestMessageSentByMeMap.clear()}}]),e}(),ei=\"_a2KeyAndTinyIDUpdated\",ti=\"_cloudConfigUpdated\",ni=\"_profileUpdated\";function oi(e){this.mixin(e)}oi.mixin=function(e){var t=e.prototype||e;t._isReady=!1,t.ready=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this._isReady?void(t?e.call(this):setTimeout(e,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(e))},t.triggerReady=function(){var e=this;this._isReady=!0,setTimeout((function(){var t=e._readyQueue;e._readyQueue=[],t&&t.length>0&&t.forEach((function(e){e.call(this)}),e)}),1)},t.resetReady=function(){this._isReady=!1,this._readyQueue=[]},t.isReady=function(){return this._isReady}};var si=[\"jpg\",\"jpeg\",\"gif\",\"png\",\"bmp\",\"image\",\"webp\"],ai=[\"mp4\",\"quicktime\",\"mov\"],ii=1,ri=2,ui=3,ci=255,li=function(){function e(t){var n=this;o(this,e),zt(t)||(this.userID=t.userID||\"\",this.nick=t.nick||\"\",this.gender=t.gender||\"\",this.birthday=t.birthday||0,this.location=t.location||\"\",this.selfSignature=t.selfSignature||\"\",this.allowType=t.allowType||E.ALLOW_TYPE_ALLOW_ANY,this.language=t.language||0,this.avatar=t.avatar||\"\",this.messageSettings=t.messageSettings||0,this.adminForbidType=t.adminForbidType||E.FORBID_TYPE_NONE,this.level=t.level||0,this.role=t.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],zt(t.profileCustomField)||t.profileCustomField.forEach((function(e){n.profileCustomField.push({key:e.key,value:e.value})})))}return a(e,[{key:\"validate\",value:function(e){var t=!0,n=\"\";if(zt(e))return{valid:!1,tips:\"empty options\"};if(e.profileCustomField)for(var o=e.profileCustomField.length,s=null,a=0;a<o;a++){if(s=e.profileCustomField[a],!nt(s.key)||-1===s.key.indexOf(\"Tag_Profile_Custom\"))return{valid:!1,tips:\"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom\"};if(!nt(s.value))return{valid:!1,tips:\"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String\"}}for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(\"profileCustomField\"===i)continue;if(zt(e[i])&&!nt(e[i])&&!et(e[i])){n=\"key:\"+i+\", invalid value:\"+e[i],t=!1;continue}switch(i){case\"nick\":nt(e[i])||(n=\"nick must be a string\",t=!1),ht(e[i])>500&&(n=\"nick name limited: must less than or equal to \".concat(500,\" bytes, current size: \").concat(ht(e[i]),\" bytes\"),t=!1);break;case\"gender\":mt(Ke,e.gender)||(n=\"key:gender, invalid value:\"+e.gender,t=!1);break;case\"birthday\":et(e.birthday)||(n=\"birthday must be a number\",t=!1);break;case\"location\":nt(e.location)||(n=\"location must be a string\",t=!1);break;case\"selfSignature\":nt(e.selfSignature)||(n=\"selfSignature must be a string\",t=!1);break;case\"allowType\":mt(Ye,e.allowType)||(n=\"key:allowType, invalid value:\"+e.allowType,t=!1);break;case\"language\":et(e.language)||(n=\"language must be a number\",t=!1);break;case\"avatar\":nt(e.avatar)||(n=\"avatar must be a string\",t=!1);break;case\"messageSettings\":0!==e.messageSettings&&1!==e.messageSettings&&(n=\"messageSettings must be 0 or 1\",t=!1);break;case\"adminForbidType\":mt(We,e.adminForbidType)||(n=\"key:adminForbidType, invalid value:\"+e.adminForbidType,t=!1);break;case\"level\":et(e.level)||(n=\"level must be a number\",t=!1);break;case\"role\":et(e.role)||(n=\"role must be a number\",t=!1);break;default:n=\"unknown key:\"+i+\"  \"+e[i],t=!1}}return{valid:t,tips:n}}}]),e}(),di=a((function e(t){o(this,e),this.value=t,this.next=null})),pi=function(){function e(t){o(this,e),this.MAX_LENGTH=t,this.pTail=null,this.pNodeToDel=null,this.map=new Map}return a(e,[{key:\"set\",value:function(e){var t=new di(e);if(this.map.size<this.MAX_LENGTH)null===this.pTail?(this.pTail=t,this.pNodeToDel=t):(this.pTail.next=t,this.pTail=t),this.map.set(e,1);else{var n=this.pNodeToDel;this.pNodeToDel=this.pNodeToDel.next,this.map.delete(n.value),n.next=null,n=null,this.pTail.next=t,this.pTail=t,this.map.set(e,1)}}},{key:\"has\",value:function(e){return this.map.has(e)}},{key:\"delete\",value:function(e){this.has(e)&&this.map.delete(e)}},{key:\"tail\",value:function(){return this.pTail}},{key:\"size\",value:function(){return this.map.size}},{key:\"data\",value:function(){return Array.from(this.map.keys())}},{key:\"reset\",value:function(){for(var e;null!==this.pNodeToDel;)e=this.pNodeToDel,this.pNodeToDel=this.pNodeToDel.next,e.next=null,e=null;this.pTail=null,this.map.clear()}}]),e}(),gi=[\"groupID\",\"name\",\"avatar\",\"type\",\"introduction\",\"notification\",\"ownerID\",\"selfInfo\",\"createTime\",\"infoSequence\",\"lastInfoTime\",\"lastMessage\",\"nextMessageSeq\",\"memberNum\",\"maxMemberNum\",\"memberList\",\"joinOption\",\"groupCustomField\",\"muteAllMembers\",\"isSupportTopic\",\"inviteOption\",\"_lastRevokedTime\"],hi=function(){function e(t){o(this,e),this.groupID=\"\",this.name=\"\",this.avatar=\"\",this.type=\"\",this.introduction=\"\",this.notification=\"\",this.ownerID=\"\",this.createTime=\"\",this.infoSequence=\"\",this.lastInfoTime=\"\",this.selfInfo={messageRemindType:\"\",joinTime:\"\",nameCard:\"\",role:\"\",userID:\"\",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:\"\",lastSequence:\"\",fromAccount:\"\",messageForShow:\"\"},this.nextMessageSeq=\"\",this.memberNum=\"\",this.memberCount=\"\",this.maxMemberNum=\"\",this.maxMemberCount=\"\",this.joinOption=\"\",this.inviteOption=\"\",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(t)}return a(e,[{key:\"memberNum\",get:function(){return this.memberCount},set:function(e){}},{key:\"maxMemberNum\",get:function(){return this.maxMemberCount},set:function(e){}},{key:\"_initGroup\",value:function(e){for(var t in e)gi.indexOf(t)<0||(\"selfInfo\"!==t?(\"memberNum\"===t&&(this.memberCount=e[t]),\"maxMemberNum\"===t&&(this.maxMemberCount=e[t]),\"isSupportTopic\"!==t?this[t]=e[t]:this.isSupportTopic=1===e[t]):this.updateSelfInfo(e[t]))}},{key:\"updateGroup\",value:function(e){var t=this;e.appid=void 0,e.grossTopicNextMsgSeq=void 0,e.selfInfo&&(e.selfInfo.grossTopicReadSeq=void 0);var n=JSON.parse(JSON.stringify(e));n.lastMsgTime&&(this.lastMessage.lastTime=n.lastMsgTime),it(n.muteAllMembers)||(\"On\"===n.muteAllMembers?n.muteAllMembers=!0:n.muteAllMembers=!1),n.groupCustomField&&Ct(this.groupCustomField,n.groupCustomField),it(n.memberNum)||(this.memberCount=n.memberNum),it(n.maxMemberNum)||(this.maxMemberCount=n.maxMemberNum),it(n.isSupportTopic)||(this.isSupportTopic=et(n.isSupportTopic)?1===n.isSupportTopic:n.isSupportTopic),pt(this,n,[\"members\",\"errorCode\",\"lastMsgTime\",\"groupCustomField\",\"memberNum\",\"maxMemberNum\",\"isSupportTopic\"]),at(n.members)&&n.members.length>0&&n.members.forEach((function(e){e.userID===t.selfInfo.userID&&pt(t.selfInfo,e,[\"sequence\"])}))}},{key:\"updateSelfInfo\",value:function(e){var n={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList};pt(this.selfInfo,t({},n),[],[\"\",null,void 0,0,NaN])}},{key:\"setSelfNameCard\",value:function(e){this.selfInfo.nameCard=e}}]),e}(),_i=function(e,n){return it(e)?{lastTime:0,lastSequence:0,fromAccount:0,messageForShow:\"\",payload:null,type:\"\",isRevoked:!1,cloudCustomData:\"\",onlineOnlyFlag:!1,nick:\"\",nameCard:\"\",version:0,isPeerRead:!1,revoker:null}:e instanceof Wa?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||\"\",messageForShow:Vt(e.type,e.payload,n),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||\"\",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||\"\",nameCard:e.nameCard||\"\",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:t(t({},e),{},{messageForShow:Vt(e.type,e.payload,n)})},fi=function(){function e(t,n){o(this,e),this.conversationID=t.conversationID||\"\",this.unreadCount=t.unreadCount||0,this.type=t.type||\"\",this.lastMessage=_i(t.lastMessage,n),t.lastMsgTime&&(this.lastMessage.lastTime=t.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=t.peerReadTime||0,this.groupAtInfoList=[],this.remark=\"\",this.isPinned=t.isPinned||!1,this.messageRemindType=\"\",this.markList=t.markList||[],this.customData=t.customData||\"\",this.conversationGroupList=t.conversationGroupList||[],this._initProfile(t)}return a(e,[{key:\"toAccount\",get:function(){return this.conversationID.startsWith(E.CONV_C2C)?this.conversationID.replace(E.CONV_C2C,\"\"):this.conversationID.startsWith(E.CONV_GROUP)?this.conversationID.replace(E.CONV_GROUP,\"\"):\"\"}},{key:\"subType\",get:function(){return this.groupProfile?this.groupProfile.type:\"\"}},{key:\"_initProfile\",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case\"userProfile\":t.userProfile=e.userProfile;break;case\"groupProfile\":t.groupProfile=e.groupProfile}})),it(this.userProfile)&&this.type===E.CONV_C2C?this.userProfile=new li({userID:e.conversationID.replace(\"C2C\",\"\")}):it(this.groupProfile)&&this.type===E.CONV_GROUP&&(this.groupProfile=new hi({groupID:e.conversationID.replace(\"GROUP\",\"\")}))}},{key:\"updateUnreadCount\",value:function(e){var t=e.nextUnreadCount,n=e.isFromGetConversations,o=e.isUnreadC2CMessage;it(t)||(Tt(this.subType)?this.unreadCount=0:n&&this.type===E.CONV_GROUP||n&&this.type===E.CONV_TOPIC||o&&this.type===E.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:\"updateLastMessage\",value:function(e){this.lastMessage=_i(e)}},{key:\"updateGroupAtInfoList\",value:function(e){if(!this._isNeedMergeGroupAtInfo(e)){var t,n=(M(t=e.groupAtType)||y(t)||I(t)||T()).slice(0);-1!==n.indexOf(E.CONV_AT_ME)&&-1!==n.indexOf(E.CONV_AT_ALL)&&(n=[E.CONV_AT_ALL_AT_ME]);var o={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:n,__random:e.__random,__sequence:e.__sequence};this.groupAtInfoList.push(o)}}},{key:\"_isNeedMergeGroupAtInfo\",value:function(e){var t=e.groupID,n=e.sequence;if(!Dt({groupID:t}))return!1;var o=!1;return this.groupAtInfoList.forEach((function(t){t.messageSequence===n&&(t.atTypeArray.indexOf(E.CONV_AT_ME)>-1&&e.groupAtType.indexOf(E.CONV_AT_ALL)>-1&&(t.atTypeArray=[E.CONV_AT_ALL_AT_ME]),t.atTypeArray.indexOf(E.CONV_AT_ALL)>-1&&e.groupAtType.indexOf(E.CONV_AT_ME)>-1&&(t.atTypeArray=[E.CONV_AT_ALL_AT_ME],t.__random=e.__random,t.__sequence=e.__sequence),o=!0)})),o}},{key:\"clearGroupAtInfoList\",value:function(){this.groupAtInfoList.length=0}},{key:\"reduceUnreadCount\",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:\"isLastMessageRevoked\",value:function(e){var t=e.sequence,n=e.time;return this.type===E.CONV_C2C&&t===this.lastMessage.lastSequence&&n===this.lastMessage.lastTime||this.type===E.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:\"setLastMessageRevoked\",value:function(e){this.lastMessage.isRevoked=e}},{key:\"setLastMessageRevoker\",value:function(e){this.lastMessage.revoker=e}}]),e}(),vi=function(){function e(t){o(this,e),this._conversationModule=t,this._n=\"MessageRemindHandler\",this._updateSequence=0}return a(e,[{key:\"getC2CMessageRemindType\",value:function(){var e=this,t=\"\".concat(this._n,\".getC2CMessageRemindType\");return this._conversationModule.request({protocolName:Eo,updateSequence:this._updateSequence}).then((function(n){Ve.l(\"\".concat(t,\" ok\"));var o=n.data,s=o.updateSequence,a=o.muteFlagList;e._updateSequence=s,e._patchC2CMessageRemindType(a)})).catch((function(e){Ve.e(\"\".concat(t,\" failed. error:\"),e)}))}},{key:\"_patchC2CMessageRemindType\",value:function(e){var t=this,n=0,o=\"\";at(e)&&e.length>0&&e.forEach((function(e){var s=e.userID,a=e.muteFlag;0===a?o=E.MSG_REMIND_ACPT_AND_NOTE:1===a?o=E.MSG_REMIND_DISCARD:2===a&&(o=E.MSG_REMIND_ACPT_NOT_NOTE),!0===t._conversationModule.patchMessageRemindType({ID:s,isC2CConversation:!0,messageRemindType:o})&&(n+=1)})),Ve.l(\"\".concat(this._n,\"._patchC2CMessageRemindType count:\").concat(n))}},{key:\"set\",value:function(e){return e.groupID?this._setGroupMessageRemindType(e):at(e.userIDList)?this._setC2CMessageRemindType(e):void 0}},{key:\"_setGroupMessageRemindType\",value:function(e){var t=this,n=\"\".concat(this._n,\"._setGroupMessageRemindType\"),o=e.groupID,s=e.messageRemindType,a=\"groupID:\".concat(o,\" messageRemindType:\").concat(s),i=new Aa(\"setMessageRemindType\");return i.setMessage(a),this._getModule(wn).modifyGroupMemberInfo({groupID:o,messageRemindType:s,userID:this._conversationModule.getMyUserID()}).then((function(){i.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok. \").concat(a));var o=t.onGroupMessageRemindTypeUpdated(e);return t._conversationModule.emitTotalUnreadMessageCountUpdate(),Ya(o)})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"onGroupMessageRemindTypeUpdated\",value:function(e){var t=e.groupID,n=e.messageRemindType,o=this._getModule(Pn).getLocalGroupProfile(t);if(o&&(o.selfInfo.messageRemindType=n),kt(t)){var s=t,a=xt(s),i=this._getModule(Fn).getLocalTopic(a,s);return i&&(i.updateSelfInfo({messageRemindType:n}),this._conversationModule.emitOuterEvent(k.TOPIC_UPDATED,{groupID:a,topic:i})),{topic:i}}return this._conversationModule.patchMessageRemindType({ID:t,isC2CConversation:!1,messageRemindType:n})&&this._emitConversationUpdate(),{group:o}}},{key:\"_setC2CMessageRemindType\",value:function(e){var t=this,n=\"\".concat(this._n,\"._setC2CMessageRemindType\"),o=e.userIDList,s=e.messageRemindType,a=o.slice(0,30),i=0;s===E.MSG_REMIND_DISCARD?i=1:s===E.MSG_REMIND_ACPT_NOT_NOTE&&(i=2);var r=\"userIDList:\".concat(a,\" messageRemindType:\").concat(s),u=new Aa(\"setMessageRemindType\");return u.setMessage(r),this._conversationModule.request({protocolName:ko,requestData:{userIDList:a,muteFlag:i}}).then((function(e){u.setNetworkType(t._conversationModule.getNetworkType()).end();var o=e.data,i=o.updateSequence,r=o.errorList;t._updateSequence=i;var c=[],l=[];at(r)&&r.forEach((function(e){c.push(e.userID),l.push({userID:e.userID,code:e.errorCode})}));var d=a.filter((function(e){return-1===c.indexOf(e)}));Ve.l(\"\".concat(n,\" ok. successUserIDList:\").concat(d,\" failureUserIDList:\").concat(JSON.stringify(l)));var p=0;return d.forEach((function(e){t._conversationModule.patchMessageRemindType({ID:e,isC2CConversation:!0,messageRemindType:s})&&(p+=1)})),p>=1&&t._emitConversationUpdate(),a.length=c.length=0,t._conversationModule.emitTotalUnreadMessageCountUpdate(),Xa({successUserIDList:d.map((function(e){return{userID:e}})),failureUserIDList:l})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_getModule\",value:function(e){return this._conversationModule.getModule(e)}},{key:\"_emitConversationUpdate\",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:\"setUpdateSequence\",value:function(e){this._updateSequence=e}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._updateSequence=0}}]),e}(),mi=function(){function e(t){o(this,e),this._conversationModule=t,this._n=\"ConvGroupHandler\",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=$t.NOT_START}return a(e,[{key:\"setConvCustomData\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"setConvCustomData\"),o=e.conversationIDList,s=e.customData;Ve.l(\"\".concat(n,\" options:\"),e);var a=new Aa(\"setConvCustomData\");a.setMessage(JSON.stringify(e));var i={fromAccount:this._getMyUserID(),itemList:[]},r=[],u=[];return o.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(u,e),!0;if(!Et(e)&&!St(e))return t._onConversationIDInvalid(u,e),!0;var n={operationType:2,contactItem:void 0,customMark:s};Et(e)?n.contactItem={type:1,toAccount:e.replace(E.CONV_C2C,\"\")}:St(e)&&(n.contactItem={type:2,groupID:e.replace(E.CONV_GROUP,\"\")}),i.itemList.push(n)})),u.length===o.length?Xa({successConversationIDList:r,failureConversationIDList:u}):this._conversationModule.request({protocolName:qo,requestData:i}).then((function(e){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var o=e.data.resultItem;if(at(o)){var i,c,l=!1;o.forEach((function(e){i=t._concatConversationID(e.contactItem),0===e.resultCode?(r.push(i),(c=t._getLocalConversation(i))&&c.customData!==s&&(c.customData=s,l=!0)):u.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===l&&t._emitConversationUpdate()}return Ya({successConversationIDList:r,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"markConversation\",value:function(e){var t=this;if(!this._conversationModule.canIUse(B.CONV_MARK))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"markConversation\"),o=e.conversationIDList,s=e.markType,a=e.enableMark;Ve.l(\"\".concat(n,\" options:\"),e);var i=new Aa(\"markConversation\");i.setMessage(JSON.stringify(e));var r=void 0,u=void 0,c=this._getFlagBit(s);!0===a?u=[c]:r=[c];var l={fromAccount:this._getMyUserID(),itemList:[]},d=[],p=[];return o.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(p,e),!0;if(!Et(e)&&!St(e))return t._onConversationIDInvalid(p,e),!0;var n={operationType:1,contactItem:void 0,clearMark:r,setMark:u};Et(e)?n.contactItem={type:1,toAccount:e.replace(E.CONV_C2C,\"\")}:St(e)&&(n.contactItem={type:2,groupID:e.replace(E.CONV_GROUP,\"\")}),l.itemList.push(n)})),p.length===o.length?Xa({successConversationIDList:d,failureConversationIDList:p}):this._conversationModule.request({protocolName:xo,requestData:l}).then((function(e){i.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var o=e.data.resultItem;if(at(o)){var r,u,c=!1;o.forEach((function(e){if(r=t._concatConversationID(e.contactItem),0===e.resultCode){if(d.push(r),u=t._getLocalConversation(r)){var n=u.markList.indexOf(s);!0===a?-1===n&&(u.markList.push(s),c=!0):-1!==n&&(u.markList.splice(n,1),c=!0)}}else p.push({conversationID:r,code:e.resultCode,message:e.resultInfo})})),!0===c&&t._emitConversationUpdate()}return Ya({successConversationIDList:d,failureConversationIDList:p})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"getLocalConvGroupList\",value:function(){var e=this;return Ve.l(\"\".concat(this._n,\".getLocalConvGroupList pagingStatus:\").concat(this._pagingStatus)),this._pagingStatus===$t.REJECTED?this.getRemoteConvGroupList().then((function(){return Ya(m(e._convGroupMap.values()))})):Xa(m(this._convGroupMap.values()))}},{key:\"getRemoteConvGroupList\",value:function(){var e=this,t=\"\".concat(this._n,\".getRemoteConvGroupList\");return this._pagingStatus=$t.PENDING,this._conversationModule.request({protocolName:Yo,requestData:{fromAccount:this._getMyUserID(),startIndex:this._startIndex,startTime:we()}}).then((function(n){var o,s,a=n.data,i=a.completeFlag,r=a.contactItem,u=a.nextStartIndex,c=void 0===u?0:u,l=a.groupItem;(e._startIndex=c,Ve.l(\"\".concat(t,\" completeFlag:\").concat(i,\" nextStartIndex:\").concat(c)),at(l)&&l.forEach((function(t){var n=t.convGroupID,o=t.groupName;e._convGroupMap.set(n,o)})),at(r))&&r.forEach((function(t){var n=t.standardMark,a=t.customData,i=t.convGroupIDList;if(o=e._concatConversationID(t),(s=e._getLocalConversation(o))&&(s.markList=Ht(n),s.customData=a||\"\",at(i))){var r=[];i.forEach((function(t){e._convGroupMap.has(t)&&r.push(e._convGroupMap.get(t))})),s.conversationGroupList=[].concat(r),r.length=0}}));if(0===i)return e.getRemoteConvGroupList();1===i&&(e._pagingStatus=$t.RESOLVED,e._emitConversationUpdate(),e._emitConvGroupListUpdate())})).catch((function(n){e._pagingStatus=$t.REJECTED,Ve.w(\"\".concat(t,\" failed. error:\"),n)}))}},{key:\"createConvGroup\",value:function(e){var t=this;if(!this._conversationModule.canIUse(B.CONV_GROUP))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"createConvGroup\");Ve.l(\"\".concat(n,\" options:\"),e);var o=new Aa(\"createConvGroup\");o.setMessage(JSON.stringify(e));var s=e.groupName,a=e.conversationIDList,i={fromAccount:this._getMyUserID(),itemList:[{groupName:s,contactItem:[]}]},r=[],u=[];return a.forEach((function(e){return t._hasLocalConversation(e)?Et(e)||St(e)?void(Et(e)?i.itemList[0].contactItem.push({type:1,toAccount:e.replace(E.CONV_C2C,\"\")}):St(e)&&i.itemList[0].contactItem.push({type:2,groupID:e.replace(E.CONV_GROUP,\"\")})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===a.length?Xa({successConversationIDList:r,failureConversationIDList:u}):this._conversationModule.request({protocolName:Vo,requestData:i}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var a=e.data.groupResultItem[0],i=a.groupItem,c=a.resultItem;if(st(i)&&(t._convGroupMap.set(i.convGroupID,i.groupName),t._emitConvGroupListUpdate()),at(c)){var l,d,p=!1;c.forEach((function(e){l=t._concatConversationID(e.contactItem),0===e.resultCode?(r.push(l),(d=t._getLocalConversation(l))&&-1===d.conversationGroupList.indexOf(s)&&(d.conversationGroupList.push(s),p=!0)):u.push({conversationID:l,code:e.resultCode,message:e.resultInfo})})),!0===p&&(t._emitConversationUpdate(),t._emitConvGroupListUpdate())}return Ya({successConversationIDList:r,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"deleteConvGroup\",value:function(e){var t=this;if(!this._conversationModule.canIUse(B.CONV_GROUP))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"deleteConvGroup\");Ve.l(\"\".concat(n,\" groupName:\").concat(e));var o=new Aa(\"deleteConvGroup\");return o.setMessage(e),this._conversationModule.request({protocolName:Bo,requestData:{fromAccount:this._getMyUserID(),groupName:[e]}}).then((function(s){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var a=s.data.groupItem;if(at(a)){var i=!1;a.forEach((function(e){t._convGroupMap.has(e.convGroupID)&&(t._convGroupMap.delete(e.convGroupID),i=!0)})),!0===i&&t._emitConvGroupListUpdate()}t._eraseFromConversationGroupList([e])})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"renameConvGroup\",value:function(e){var t=this;if(!this._conversationModule.canIUse(B.CONV_GROUP))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"renameConvGroup\");Ve.l(\"\".concat(n,\" options:\"),e);var o=new Aa(\"renameConvGroup\");o.setMessage(JSON.stringify(e));var s=e.oldName,a=e.newName;return this._conversationModule.request({protocolName:Ho,requestData:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:s,newName:a}}}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var i=e.data.updateGroupResult.convGroupID;t._convGroupMap.set(i,a),t._emitConvGroupListUpdate();var r,u,c=t._conversationModule.getLocalConversationList(),l=!1;c.forEach((function(e){r=e.conversationGroupList,-1!==(u=r.indexOf(s))&&(r.splice(u,1,a),l=!0)})),!0===l&&t._emitConversationUpdate()})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"addConvsToGroup\",value:function(e){var t=this;if(!this._conversationModule.canIUse(B.CONV_GROUP))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"addConvsToGroup\");Ve.l(\"\".concat(n,\" options:\"),e);var o=new Aa(\"addConvsToGroup\");o.setMessage(JSON.stringify(e));var s=e.conversationIDList,a=e.groupName,i={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:a,updateItem:[]}},r=[],u=[];return s.forEach((function(e){return t._hasLocalConversation(e)?Et(e)||St(e)?void(Et(e)?i.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:e.replace(E.CONV_C2C,\"\")}}):St(e)&&i.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:e.replace(E.CONV_GROUP,\"\")}})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===s.length?Xa({successConversationIDList:r,failureConversationIDList:u}):this._conversationModule.request({protocolName:Ko,requestData:i}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var s=e.data.updateGroupResult.contactResultItem;if(at(s)){var i,c,l=!1;s.forEach((function(e){i=t._concatConversationID(e.contactItem),0===e.resultCode?(c=t._getLocalConversation(i))&&-1===c.conversationGroupList.indexOf(a)&&(c.conversationGroupList.push(a),r.push(i),l=!0):u.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(a))}return Ya({successConversationIDList:r,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"deleteConvsFromGroup\",value:function(e){var t=this;if(!this._conversationModule.canIUse(B.CONV_GROUP))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"deleteConvsFromGroup\");Ve.l(\"\".concat(n,\" options:\"),e);var o=new Aa(\"deleteConvsFromGroup\");o.setMessage(JSON.stringify(e));var s=e.conversationIDList,a=e.groupName,i={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:a,updateItem:[]}},r=[],u=[];return s.forEach((function(e){return t._hasLocalConversation(e)?Et(e)||St(e)?void(Et(e)?i.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:e.replace(E.CONV_C2C,\"\")}}):St(e)&&i.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:e.replace(E.CONV_GROUP,\"\")}})):(t._onConversationIDInvalid(u,e),!0):(t._onConversationNotFound(u,e),!0)})),u.length===s.length?Xa({successConversationIDList:r,failureConversationIDList:u}):this._conversationModule.request({protocolName:Wo,requestData:i}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var s=e.data.updateGroupResult.contactResultItem;if(at(s)){var i,c,l=!1;s.forEach((function(e){if(i=t._concatConversationID(e.contactItem),0===e.resultCode){if(c=t._getLocalConversation(i)){var n=c.conversationGroupList.indexOf(a);-1!==n&&(c.conversationGroupList.splice(n,1),r.push(i),l=!0)}}else u.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(a))}return Ya({successConversationIDList:r,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"onConvMarkUpdated\",value:function(e){var t=this;if(!zt(e)){var n,o;Ve.d(\"\".concat(this._n,\".onConvMarkUpdated markItemList:\"),e);var s=!1;e.forEach((function(e){var a=e.recentContactItem,i=e.optType,r=e.standardMark,u=e.customMark;if(n=t._concatConversationID(a),o=t._getLocalConversation(n))if(1===i){var c=Ht(r);!0!==function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,o=e.length;n<o;n++)if(e[n]!==t[n])return!1;return!0}(o.markList,c)&&(o.markList=c,s=!0)}else 2===i&&o.customData!==u&&void 0!==u&&(o.customData=u,s=!0)})),!0===s&&this._emitConversationUpdate()}}},{key:\"onConvGroupCreated\",value:function(e){var t=this;Ve.d(\"\".concat(this._n,\".onConvGroupCreated resultList:\"),e);var n=!1,o=!1;at(e)&&(e.forEach((function(e){var s=e.msgGroupItem,a=s.groupID,i=s.groupName;t._convGroupMap.get(a)!==i&&(t._convGroupMap.set(a,i),o=!0);var r,u,c=e.msgRecentContactItem;at(c)&&c.forEach((function(e){r=t._concatConversationID(e),(u=t._getLocalConversation(r))&&-1===u.conversationGroupList.indexOf(i)&&(u.conversationGroupList.push(i),n=!0)}))})),!0===n&&this._emitConversationUpdate(),!0===o&&this._emitConvGroupListUpdate())}},{key:\"onConvGroupDeleted\",value:function(e){var t=this;Ve.d(\"\".concat(this._n,\".onConvGroupDeleted groupItemList:\"),e);var n=[];if(at(e)){var o=!1;e.forEach((function(e){var s=e.groupID,a=e.groupName;t._convGroupMap.has(s)&&(t._convGroupMap.delete(s),o=!0,n.push(a))})),!0===o&&this._emitConvGroupListUpdate()}this._eraseFromConversationGroupList(n)}},{key:\"_eraseFromConversationGroupList\",value:function(e){zt(e)||(this._conversationModule.getLocalConversationList().forEach((function(t){t.conversationGroupList=t.conversationGroupList.filter((function(t){return!e.includes(t)}))})),this._emitConversationUpdate())}},{key:\"onConvGroupNameUpdated\",value:function(e){Ve.d(\"\".concat(this._n,\".onConvGroupNameUpdated options:\"),e);var t=e.groupID,n=e.groupName,o=e.oldGroupName;if(this._convGroupMap.get(t)!==n){this._convGroupMap.set(t,n),this._emitConvGroupListUpdate();var s,a,i=this._conversationModule.getLocalConversationList(),r=!1;i.forEach((function(e){s=e.conversationGroupList,-1!==(a=s.indexOf(o))&&(s.splice(a,1,n),r=!0)})),!0===r&&this._emitConversationUpdate()}}},{key:\"onConvInGroupUpdated\",value:function(e){var t=this;Ve.d(\"\".concat(this._n,\".onConvInGroupUpdated options:\"),e);var n=e.oldGroupName,o=e.recentContactUpdateGroupItem;if(at(o)){var s,a,i,r=!1;o.forEach((function(e){var o=e.contactOptType,u=e.recentContactItem;s=t._concatConversationID(u),(a=t._getLocalConversation(s))&&(i=a.conversationGroupList.indexOf(n),1===o?-1===i&&(a.conversationGroupList.push(n),r=!0):2===o&&-1!==i&&(a.conversationGroupList.splice(i,1),r=!0))})),!0===r&&(this._emitConversationUpdate(),this._emitConvInGroupUpdate(n))}}},{key:\"onConvAddedToOrDeletedFromGroup\",value:function(e){var t=this;Ve.d(\"\".concat(this._n,\".onConvAddedToOrDeletedFromGroup options:\"),e);var n=e.msgRecentContactItem,o=e.msgRecentContactUpdateContactItem,s=this._concatConversationID(n),a=this._getLocalConversation(s);if(a&&at(o)){var i,r=!1;o.forEach((function(e){var n=e.groupOptType,o=e.recentContactGroupItem.groupName;i=a.conversationGroupList.indexOf(o),1===n?-1===i&&(a.conversationGroupList.push(o),r=!0):2===n&&-1!==i&&(a.conversationGroupList.splice(i,1),r=!0),!0===r&&t._emitConvInGroupUpdate(o)})),!0===r&&this._emitConversationUpdate()}}},{key:\"onConvGroupListSynced\",value:function(e){var t=this;at(e)&&0!==e.length&&(Ve.l(\"\".concat(this._n,\".onConvGroupListSynced groupItemList:\"),e),e.forEach((function(e){t._convGroupMap.set(e.convGroupID,e.groupName)})))}},{key:\"getConvGroupListByID\",value:function(e){var t=this;if(!zt(e)){var n=[];return e.forEach((function(e){t._convGroupMap.has(e)&&n.push(t._convGroupMap.get(e))})),n}}},{key:\"_onConversationNotFound\",value:function(e,t){e.push({conversationID:t,code:ha.CONVERSATION_NOT_FOUND,message:this._conversationModule.getErrorMessage(ha.CONVERSATION_NOT_FOUND)})}},{key:\"_onConversationIDInvalid\",value:function(e,t){e.push({conversationID:t,code:ha.INVALID_CONVERSATION_ID,message:this._conversationModule.getErrorMessage(ha.INVALID_CONVERSATION_ID)})}},{key:\"_getFlagBit\",value:function(e){for(var t=e.toString(2),n=t.length,o=n-1;o>=0;o--)if(\"1\"===t[o])return n-o-1}},{key:\"_concatConversationID\",value:function(e){var t,n=e.type,o=e.to,s=e.groupID,a=e.userID;return 1===n?it(a)?it(o)||(t=\"\".concat(E.CONV_C2C).concat(o)):t=\"\".concat(E.CONV_C2C).concat(a):2===n&&(t=\"\".concat(E.CONV_GROUP).concat(s)),t}},{key:\"_getMyUserID\",value:function(){return this._conversationModule.getMyUserID()}},{key:\"_insertConversationGroup\",value:function(e,t){var n=this._getLocalConversation(e);if(n){var o=n.conversationGroupList;-1===o.indexOf(t)&&o.push(t)}}},{key:\"_getLocalConversation\",value:function(e){return this._conversationModule.getLocalConversation(e)}},{key:\"_hasLocalConversation\",value:function(e){return this._conversationModule.hasLocalConversation(e)}},{key:\"_emitConversationUpdate\",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:\"_emitConvGroupListUpdate\",value:function(){this._conversationModule.emitOuterEvent(k.CONVERSATION_GROUP_LIST_UPDATED,m(this._convGroupMap.values()))}},{key:\"_emitConvInGroupUpdate\",value:function(e){var t={groupName:e,conversationList:[]},n=this._conversationModule.getLocalConversationList();t.conversationList=n.filter((function(t){return t.conversationGroupList.includes(e)})),this._conversationModule.emitOuterEvent(k.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=$t.NOT_START}}]),e}(),Mi=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"ConversationModule\",oi.mixin(h(t)),t._messageListHandler=new $a,t._messageRemindHandler=new vi(h(t)),t._convGroupHandler=new mi(h(t)),t.singlyLinkedList=new pi(100),t._pagingStatus=$t.NOT_START,t._pagingTimeStamp=0,t._pagingStartIndex=0,t._pagingPinnedTimeStamp=0,t._pagingPinnedStartIndex=0,t._pagingConvIDMap=new Map,t._convIDFromUnreadDBMap=new Map,t._conversationMap=new Map,t._tmpGroupList=[],t._tmpGroupAtTipsList=[],t._peerReadTimeMap=new Map,t._completedMap=new Map,t._roamingMessageKeyAndTimeMap=new Map,t._roamingMessageSequenceMap=new Map,t._remoteGroupReadSequenceMap=new Map,t._convTotalUnreadCount=0,t._pagingGetCostList=[],t._initListeners(),t}return a(s,[{key:\"_initListeners\",value:function(){var e=this.getInnerEmitterInstance();e.on(ei,this._initLocalConversationList,this),e.on(ni,this._onProfileUpdated,this)}},{key:\"onCheckTimer\",value:function(e){e%60==0&&this._messageListHandler.traversal()}},{key:\"_initLocalConversationList\",value:function(){var e=this,t=new Aa(\"_initLocalConversationList\");Ve.l(\"\".concat(this._n,\".\").concat(\"_initLocalConversationList\"));var n=\"\",o=this._getStorageConversationList(),s=this.isIntl();if(o){for(var a=o.length,i=0;i<a;i++){var r=o[i];if(r){if(r.conversationID===\"\".concat(E.CONV_C2C,\"@TLS#ERROR\")||r.conversationID===\"\".concat(E.CONV_C2C,\"@TLS#NOT_FOUND\"))continue;if(r.groupProfile){var u=r.groupProfile.type;if(Tt(u))continue}}this._conversationMap.set(o[i].conversationID,new fi(o[i],s))}this.emitConversationUpdate(!0,!1),n=\"count:\".concat(a)}else n=\"count:0\";t.setNetworkType(this.getNetworkType()).setMessage(n).end(),this.getModule(Un)||this.triggerReady(),this.ready((function(){e._tmpGroupList.length>0&&(e.updateConversationGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)})),this.syncConversationList()}},{key:\"onMessageSent\",value:function(e){this._onSendOrReceiveMessage({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:\"onNewMessage\",value:function(e){this._onSendOrReceiveMessage(e)}},{key:\"_onSendOrReceiveMessage\",value:function(e){var t=this,n=e.conversationOptionsList,o=e.isInstantMessage,s=void 0===o||o,a=e.isUnreadC2CMessage,i=void 0!==a&&a,r=e.updateUnreadCount,u=void 0===r||r;this._isReady?0!==n.length&&(this._getC2CPeerReadTime(n),this._updateLocalConversationList({conversationOptionsList:n,isInstantMessage:s,isUnreadC2CMessage:i,isFromGetConversations:!1,updateUnreadCount:u}),s||(this._convIDFromUnreadDBMap=new Map([].concat(m(this._convIDFromUnreadDBMap),m(n.map((function(e){return[e.conversationID,1]}))))),this._diffAndDeleteConversation()),this._setStorageConversationList(),n.filter((function(e){return e.type===E.CONV_TOPIC})).length>0||this.emitConversationUpdate()):this.ready((function(){t._onSendOrReceiveMessage(e)}))}},{key:\"updateConversationGroupProfile\",value:function(e){var t=this;if(!at(e)||0!==e.length)if(0!==this._conversationMap.size){var n=!1;e.forEach((function(e){var o=\"GROUP\".concat(e.groupID);if(t._conversationMap.has(o)){n=!0;var s=t._conversationMap.get(o);s.groupProfile=JSON.parse(JSON.stringify(e)),s.lastMessage.lastSequence<e.nextMessageSeq&&(s.lastMessage.lastSequence=e.nextMessageSeq-1),s.subType||(s.subType=e.type)}})),n&&this.emitConversationUpdate(!0,!1)}else this._tmpGroupList=e}},{key:\"_updateConversationUserProfile\",value:function(e){var t=this;e.data.forEach((function(e){var n=\"C2C\".concat(e.userID);t._conversationMap.has(n)&&(t._conversationMap.get(n).userProfile=e)})),this.emitConversationUpdate(!0,!1)}},{key:\"onMessageRevoked\",value:function(e){var t=this;if(0!==e.length){var n=null,o=!1,s=[];e.forEach((function(e){(n=t._conversationMap.get(e.conversationID))&&(n.type===E.CONV_TOPIC?s.push(e):(n.reduceUnreadCount()&&(o=!0),n.isLastMessageRevoked({sequence:e.sequence,time:e.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),o=!0)))})),this.getModule(Fn).onMessageRevoked(s),o&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())}}},{key:\"isLastMessageRevoked\",value:function(e){var t=!1,n=e.conversationID,o=e.sequence,s=e.time,a=this._conversationMap.get(n);a&&(t=a.type===E.CONV_TOPIC?this.getModule(Fn).isLastMessageRevoked({topicID:n.replace(E.CONV_GROUP,\"\"),sequence:o}):a.isLastMessageRevoked({sequence:o,time:s}));return Ve.l(\"\".concat(this._n,\".isLastMessageRevoked options:\").concat(JSON.stringify(e),\" ret:\").concat(t)),t}},{key:\"onMessageDeleted\",value:function(e){var t=this;if(0!==e.length){var n=null;e.forEach((function(e){(n=t._messageListHandler.getLocalMessage(e.conversationID,e.ID))&&(n.isDeleted=!0),e!==n&&(e.isDeleted=!0)}));for(var o=e[0].conversationID,s=this._messageListHandler.getLocalMessageList(o),a={},i=s.length-1;i>=0;i--)if(!s[i].isDeleted){a=s[i];break}var r=this._conversationMap.get(o);if(r){var u=!1;r.lastMessage.lastSequence===a.sequence&&r.lastMessage.lastTime===a.time||(zt(a)&&(a=void 0),r.updateLastMessage(a),r.type!==E.CONV_TOPIC&&(u=!0),Ve.l(\"\".concat(this._n,\".onMessageDeleted. update conversationID:\").concat(o,\" with lastMessage:\"),r.lastMessage)),o.startsWith(E.CONV_C2C)&&this.updateUnreadCount(o),u&&this.emitConversationUpdate(!0,!1)}}}},{key:\"onMessageModified\",value:function(e){var t=e.conversationType,n=e.from,o=e.to,s=e.time,a=e.sequence,i=e.elements,r=e.cloudCustomData,u=e.messageVersion,c=this.getMyUserID(),l=\"\".concat(t).concat(o);o===c&&t===E.CONV_C2C&&(l=\"\".concat(t).concat(n));var d=this._messageListHandler.onMessageModified(l,e),p=d.isUpdated,g=d.message;!0===p&&this.emitOuterEvent(k.MESSAGE_MODIFIED,[g]);var h=this._isTopicConversation(l);if(Ve.l(\"\".concat(this._n,\".onMessageModified isUpdated:\").concat(p,\" isTopicMessage:\").concat(h,\" from:\").concat(n,\" to:\").concat(o)),h){this.getModule(Fn).onMessageModified(e)}else{var _=this._conversationMap.get(l);if(_){var f=_.lastMessage;Ve.d(\"\".concat(this._n.onMessageModified,\" lastMessage:\"),JSON.stringify(f),\"options:\",JSON.stringify(e)),f&&f.lastTime===s&&f.lastSequence===a&&f.version!==u&&(f.type=i[0].type,f.payload=i[0].content,f.messageForShow=Vt(f.type,f.payload,this.isIntl()),f.cloudCustomData=r,f.version=u,this.emitConversationUpdate(!0,!1))}}return g}},{key:\"onNewGroupAtTips\",value:function(e){var n=this,o=e.dataList,s=null;o.forEach((function(e){e.groupAtTips?s=e.groupAtTips:e.elements?s=t(t({},e.elements),{},{sync:!0}):e.groupAtType&&(s=t(t({},e),{},{sync:!0})),s.__random=e.random,s.__sequence=e.clientSequence,n._tmpGroupAtTipsList.push(s)})),Ve.d(\"\".concat(this._n,\".onNewGroupAtTips isReady:\").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:\"_handleGroupAtTipsList\",value:function(){var e=this;if(0!==this._tmpGroupAtTipsList.length){var t=!1;this._tmpGroupAtTipsList.forEach((function(n){var o=n.groupID,s=n.from,a=n.topicID,i=void 0===a?void 0:a,r=n.sync,u=void 0!==r&&r;if(s!==e.getMyUserID())if(it(i)){var c=e._conversationMap.get(\"\".concat(E.CONV_GROUP).concat(o));c&&(c.updateGroupAtInfoList(n),t=!0)}else{var l=e._conversationMap.get(\"\".concat(E.CONV_GROUP).concat(i));if(l){l.updateGroupAtInfoList(n);var d=e.getModule(Fn),p=l.groupAtInfoList;d.onConversationProxy({topicID:i,groupAtInfoList:p})}if(zt(l)&&u)e.updateTopicConversation([{conversationID:\"\".concat(E.CONV_GROUP).concat(i),type:E.CONV_TOPIC}]),e._conversationMap.get(\"\".concat(E.CONV_GROUP).concat(i)).updateGroupAtInfoList(n)}})),t&&this.emitConversationUpdate(!0,!1),this._tmpGroupAtTipsList.length=0}}},{key:\"_getC2CPeerReadTime\",value:function(e){var t=this,n=[];if(e.forEach((function(e){t._conversationMap.has(e.conversationID)||e.type!==E.CONV_C2C||n.push(e.conversationID.replace(E.CONV_C2C,\"\"))})),n.length>0){Ve.d(\"\".concat(this._n,\"._getC2CPeerReadTime userIDList:\").concat(n));var o=this.getModule(Un);o&&o.getRemotePeerReadTime(n)}}},{key:\"_getStorageConversationList\",value:function(){return this.getModule(Vn).getItem(\"conversationMap\")}},{key:\"_setStorageConversationList\",value:function(){var e=this.getLocalConversationList().filter((function(e){return e.type===E.CONV_C2C||e.type===E.CONV_GROUP&&e.lastMessage.type!==E.MSG_GRP_TIP})).slice(0,20).map((function(e){return{conversationID:e.conversationID,type:e.type,subType:e.subType,lastMessage:e.lastMessage,groupProfile:e.groupProfile,userProfile:e.userProfile}}));this.getModule(Vn).setItem(\"conversationMap\",e)}},{key:\"emitConversationUpdate\",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversationList();if(t){var o=this.getModule(Pn);o&&o.updateGroupLastMessage(n)}e&&this.emitOuterEvent(k.CONVERSATION_LIST_UPDATED)}},{key:\"getLocalConversationList\",value:function(){return m(this._conversationMap.values()).filter((function(e){return e.type!==E.CONV_TOPIC}))}},{key:\"getLocalConversation\",value:function(e){return this._conversationMap.get(e)}},{key:\"hasLocalConversation\",value:function(e){return this._conversationMap.has(e)}},{key:\"getLocalOldestMessage\",value:function(e){return this._messageListHandler.getLocalOldestMessage(e)}},{key:\"syncConversationList\",value:function(){var e=this,t=new Aa(\"syncConversationList\");return this._pagingStatus===$t.NOT_START&&this._conversationMap.clear(),this._pagingGetConversationList().then((function(n){var o=function(e){if(at(e)&&0!==e.length){var t=0;return e.forEach((function(e){t+=e})),(t/e.length).toFixed(0)}}(e._pagingGetCostList);return Ve.l(\"\".concat(e._n,\".\").concat(\"syncConversationList\",\". sum \").concat(function(e){if(at(e)&&0!==e.length){var t=0;return e.forEach((function(e){t+=e})),t.toFixed(0)}}(e._pagingGetCostList),\" ms, average \").concat(o,\" ms\")),e._pagingGetCostList.length=0,e._pagingStatus=$t.RESOLVED,e._diffAndDeleteConversation(),e.emitConversationUpdate(!0,!1),e._setStorageConversationList(),e._handleC2CPeerReadTime(),e._patchConversationProperties(),t.setMessage(e._conversationMap.size).setMoreMessage(o).setNetworkType(e.getNetworkType()).end(),n})).catch((function(n){return e._pagingStatus=$t.REJECTED,t.setMessage(e._pagingTimeStamp),e.probeNetwork().then((function(e){var o=v(e,2),s=o[0],a=o[1];t.setError(n,s,a).end()})),Za(n)}))}},{key:\"_diffAndDeleteConversation\",value:function(){var e=this;if(this._isSyncCompleted()){var t=[];this._conversationMap.forEach((function(n,o){!e._pagingConvIDMap.has(o)&&e._convIDFromUnreadDBMap.has(o)&&(e._conversationMap.delete(o),t.push(o))})),Ve.l(\"\".concat(this._n,\"._diffAndDeleteConversation list:\").concat(t))}}},{key:\"_patchConversationProperties\",value:function(){var e=this,t=Date.now(),n=this.checkAndPatchRemark(),o=this._messageRemindHandler.getC2CMessageRemindType(),s=this.getModule(Pn).getGroupList();Promise.all([n,o,s]).then((function(){var n=Date.now()-t;Ve.l(\"\".concat(e._n,\"._patchConversationProperties ok. cost \").concat(n,\" ms\")),e.emitConversationUpdate(!0,!1),e.emitTotalUnreadMessageCountUpdate()}))}},{key:\"_pagingGetConversationList\",value:function(){var e=this,t=\"\".concat(this._n,\"._pagingGetConversationList\");Ve.l(\"\".concat(t,\" timeStamp:\").concat(this._pagingTimeStamp,\" startIndex:\").concat(this._pagingStartIndex)+\" pinnedTimeStamp:\".concat(this._pagingPinnedTimeStamp,\" pinnedStartIndex:\").concat(this._pagingPinnedStartIndex));var n=Date.now();return this._pagingStatus=$t.PENDING,this.request({protocolName:Go,requestData:{fromAccount:this.getMyUserID(),timeStamp:this._pagingTimeStamp,startIndex:this._pagingStartIndex,pinnedTimeStamp:this._pagingPinnedTimeStamp,pinnedStartIndex:this._pagingPinnedStartIndex,orderType:1}}).then((function(o){var s=o.data,a=s.completeFlag,i=s.conversations,r=void 0===i?[]:i,u=s.timeStamp,c=s.startIndex,l=s.pinnedTimeStamp,d=s.pinnedStartIndex,p=s.groupItem,g=Date.now()-n;if(e._pagingGetCostList.push(g),Ve.l(\"\".concat(t,\" ok. completeFlag:\").concat(a,\" count:\").concat(r.length,\" cost \").concat(g,\" ms\")),e._convGroupHandler.onConvGroupListSynced(p),r.length>0){var h=e._getConversationOptions(r);e._pagingConvIDMap=new Map([].concat(m(e._pagingConvIDMap),m(h.map((function(e){return[e.conversationID,1]}))))),e._updateLocalConversationList({conversationOptionsList:h,isFromGetConversations:!0}),e.isLoggedIn()&&e.emitConversationUpdate()}if(!e._isReady){if(!e.isLoggedIn())return Xa();e.triggerReady()}return e._pagingTimeStamp=u,e._pagingStartIndex=c,e._pagingPinnedTimeStamp=l,e._pagingPinnedStartIndex=d,1!==a?e._pagingGetConversationList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),Xa())})).catch((function(n){throw e.isLoggedIn()&&(e._isReady||(Ve.w(\"\".concat(t,\" failed. error:\"),n),e.triggerReady())),n}))}},{key:\"_updateLocalConversationList\",value:function(e){var t,n=e.isFromGetConversations,o=e.isInstantMessage,s=Date.now();t=this._getTmpConversationListMapping(e),this._conversationMap=new Map(this._sortConversationList([].concat(m(t.toBeUpdatedConversationList),m(this._conversationMap)))),n||(this._updateUserOrGroupProfile(t.newConversationList),o&&this.emitTotalUnreadMessageCountUpdate()),Ve.d(\"\".concat(this._n,\"._updateLocalConversationList cost \").concat(Date.now()-s,\" ms\"))}},{key:\"_getTmpConversationListMapping\",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,o=e.isInstantMessage,s=e.isUnreadC2CMessage,a=void 0!==s&&s,i=e.updateUnreadCount,r=[],u=[],c=this.getModule(Pn),l=this.getModule(bn),d=this.isIntl(),p=0,g=t.length;p<g;p++){var h=new fi(t[p],d),_=h.conversationID;if(_!==\"\".concat(E.CONV_C2C,\"@TLS#ERROR\")&&_!==\"\".concat(E.CONV_C2C,\"@TLS#NOT_FOUND\"))if(this._conversationMap.has(_)){var f=this._conversationMap.get(_),v=[\"unreadCount\",\"allowType\",\"adminForbidType\",\"payload\",\"isPinned\"];!1===o&&v.push(\"lastMessage\");var m=t[p].lastMessage,M=!it(m);M||t[p].type===E.CONV_TOPIC||this._onLastMessageNotExist(t[p]),it(o)&&M&&null===f.lastMessage.payload&&(f.lastMessage.payload=m.payload),zt(f.lastMessage.revoker)||(f.lastMessage.revoker=null),pt(f,h,v,[null,void 0,\"\",0,NaN]),!0===i&&f.updateUnreadCount({nextUnreadCount:h.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:a}),o&&M&&(m.payload&&(f.lastMessage.payload=m.payload),f.type===E.CONV_GROUP&&(f.lastMessage.nameCard=m.nameCard,f.lastMessage.nick=m.nick)),M&&f.lastMessage.cloudCustomData!==m.cloudCustomData&&(f.lastMessage.cloudCustomData=m.cloudCustomData||\"\"),this._conversationMap.delete(_),r.push([_,f])}else{if(h.type===E.CONV_GROUP&&c){var y=h.groupProfile.groupID,I=c.getLocalGroupProfile(y);I&&(h.groupProfile=I,!0===i&&h.updateUnreadCount({nextUnreadCount:0}))}else if(h.type===E.CONV_C2C){var C=_.replace(E.CONV_C2C,\"\");l&&l.isMyFriend(C)&&(h.remark=l.getFriendRemark(C))}u.push(h),r.push([_,h])}}var T=this.getModule(Fn);return r.forEach((function(e){if(e[1].type===E.CONV_TOPIC){var t=e[1],n=t.conversationID,o=t.unreadCount,s=t.groupAtInfoList;T.onConversationProxy({topicID:n.replace(E.CONV_GROUP,\"\"),unreadCount:o,groupAtInfoList:zt(s)?void 0:s})}})),{toBeUpdatedConversationList:r,newConversationList:u}}},{key:\"_onLastMessageNotExist\",value:function(e){new Aa(\"lastMessageNotExist\").setMessage(\"\".concat(JSON.stringify(e))).setNetworkType(this.getNetworkType()).end()}},{key:\"_sortConversationList\",value:function(e){var t=[],n=[],o=[],s=[];return e.forEach((function(e){!0===e[1].isPinned?zt(e[1].lastMessage.lastTime)?n.push(e):t.push(e):zt(e[1].lastMessage.lastTime)?s.push(e):o.push(e)})),t.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})).concat(n).concat(o.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime}))).concat(s)}},{key:\"_sortConversationListAndEmitEvent\",value:function(){this._conversationMap=new Map(this._sortConversationList(m(this._conversationMap))),this.emitConversationUpdate(!0,!1)}},{key:\"_updateUserOrGroupProfile\",value:function(e){var t=this;if(0!==e.length){var n=[],o=[],s=this.getModule(Gn),a=this.getModule(Pn);e.forEach((function(e){if(e.type===E.CONV_C2C)n.push(e.toAccount);else if(e.type===E.CONV_GROUP){var t=e.toAccount;a.hasLocalGroup(t)?e.groupProfile=a.getLocalGroupProfile(t):o.push(t)}})),Ve.l(\"\".concat(this._n,\"._updateUserOrGroupProfile c2cUserIDList:\").concat(n,\" groupIDList:\").concat(o)),n.length>0&&s.getUserProfile({userIDList:n}).then((function(e){var n=e.data;at(n)?n.forEach((function(e){t._doUpdateUserProfile(\"C2C\".concat(e.userID),e)})):t._doUpdateUserProfile(\"C2C\".concat(n.userID),n)})),o.length>0&&a.getGroupProfileAdvance({groupIDList:o,responseFilter:{groupBaseInfoFilter:[\"Type\",\"Name\",\"FaceUrl\"]}}).then((function(e){e.data.successGroupList.forEach((function(e){var n=\"GROUP\".concat(e.groupID);if(t._conversationMap.has(n)){var o=t._conversationMap.get(n);pt(o.groupProfile,e,[],[null,void 0,\"\",0,NaN]),!o.subType&&e.type&&(o.subType=e.type)}}))}))}}},{key:\"_doUpdateUserProfile\",value:function(e,t){this.hasLocalConversation(e)&&(this.getLocalConversation(e).userProfile=t)}},{key:\"_getConversationOptions\",value:function(e){var n=this,o=[],s=e.filter((function(e){var t=e.type,n=e.userID;return 1===t&&\"@TLS#NOT_FOUND\"!==n&&\"@TLS#ERROR\"!==n||2===t})),a=this.getMyUserID(),i=s.map((function(e){if(it(e.lastMsg)&&(e.lastMsg={elements:[]}),1===e.type){var s={userID:e.userID,nick:e.peerNick,avatar:e.peerAvatar};return o.push(s),{conversationID:\"C2C\".concat(e.userID),type:\"C2C\",lastMessage:{lastTime:e.time,lastSequence:e.sequence,fromAccount:e.lastC2CMsgFromAccount,messageForShow:e.messageShow,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:null,payload:e.lastMsg.elements[0]?n._amendLayersOverLimitProperty(e.lastMsg.elements[0].content):null,cloudCustomData:e.lastMsg.cloudCustomData||\"\",isRevoked:8===e.lastMessageFlag,onlineOnlyFlag:!1,nick:\"\",nameCard:\"\",version:0,isPeerRead:e.lastC2CMsgFromAccount===a&&e.time<=e.c2cPeerReadTime,revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null},userProfile:new li(s),peerReadTime:e.c2cPeerReadTime,isPinned:1===e.isPinned,messageRemindType:\"\",customData:e.customMark||\"\",markList:Ht(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId)}}return{conversationID:\"GROUP\".concat(e.groupID),type:\"GROUP\",lastMessage:t(t({lastTime:e.time,lastSequence:e.sequence,fromAccount:e.msgGroupFromAccount,messageForShow:e.messageShow},n._patchTypeAndPayload(e)),{},{cloudCustomData:e.lastMsg.cloudCustomData||\"\",isRevoked:2===e.lastMessageFlag,onlineOnlyFlag:!1,nick:e.senderNick||\"\",nameCard:e.senderNameCard||\"\",revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null}),groupProfile:new hi({groupID:e.groupID,name:e.groupNick,avatar:e.groupImage}),unreadCount:e.unreadCount,peerReadTime:0,isPinned:1===e.isPinned,messageRemindType:\"\",version:0,customData:e.customMark||\"\",markList:Ht(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId)}}));o.length>0&&this.getModule(Gn).onConversationsProfileUpdated(o);return i}},{key:\"_patchTypeAndPayload\",value:function(e){var n=e.lastMsg,o=n.event,s=void 0===o?void 0:o,a=n.elements,i=void 0===a?[]:a,r=n.groupTips,u=void 0===r?{}:r;if(!it(s)&&!zt(u)){var c=new Wa(u);c.setElement({type:E.MSG_GRP_TIP,content:t(t({},u.elements),{},{groupProfile:u.groupProfile})});var l=JSON.parse(JSON.stringify(c.payload));return c=null,{type:E.MSG_GRP_TIP,payload:l}}return{type:i[0]?i[0].type:null,payload:i[0]?this._amendLayersOverLimitProperty(i[0].content):null}}},{key:\"_amendLayersOverLimitProperty\",value:function(e){var t=e.layersOverLimit;return 0===t?e.layersOverLimit=!1:1===t&&(e.layersOverLimit=!0),e}},{key:\"getLocalMessageList\",value:function(e){return this._messageListHandler.getLocalMessageList(e)}},{key:\"deleteLocalMessage\",value:function(e){e instanceof Wa&&this._messageListHandler.remove(e)}},{key:\"onConversationDeleted\",value:function(e){if(at(e)){var t=e.map((function(e){var t=e.type,n=e.userID,o=e.groupID;return 1===t?\"\".concat(E.CONV_C2C).concat(n):2===t?\"\".concat(E.CONV_GROUP).concat(o):void 0}));Ve.l(\"\".concat(this._n,\".onConversationDeleted conversationIDList:\").concat(t)),this.deleteLocalConversationList(t)}}},{key:\"onConversationPinned\",value:function(e){var t=this;if(at(e)){var n=!1;e.forEach((function(e){var o,s=e.type,a=e.userID,i=e.groupID;1===s?o=t.getLocalConversation(\"\".concat(E.CONV_C2C).concat(a)):2===s&&(o=t.getLocalConversation(\"\".concat(E.CONV_GROUP).concat(i))),o&&(Ve.l(\"\".concat(t._n,\".onConversationPinned conversationID:\").concat(o.conversationID,\" isPinned:\").concat(o.isPinned)),o.isPinned||(o.isPinned=!0,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:\"onConversationUnpinned\",value:function(e){var t=this;if(at(e)){var n=!1;e.forEach((function(e){var o,s=e.type,a=e.userID,i=e.groupID;1===s?o=t.getLocalConversation(\"\".concat(E.CONV_C2C).concat(a)):2===s&&(o=t.getLocalConversation(\"\".concat(E.CONV_GROUP).concat(i))),o&&(Ve.l(\"\".concat(t._n,\".onConversationUnpinned conversationID:\").concat(o.conversationID,\" isPinned:\").concat(o.isPinned)),o.isPinned&&(o.isPinned=!1,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:\"getMessageList\",value:function(e){var t=this,n=e.conversationID,o=e.nextReqMessageID,s=e.count,a=\"\".concat(this._n,\".getMessageList\"),i=this.getLocalConversation(n),r=\"\";if(i&&i.groupProfile&&(r=i.groupProfile.type),Tt(r))return Ve.l(\"\".concat(a,\" not available in avchatroom. conversationID:\").concat(n)),Xa({messageList:[],nextReqMessageID:\"\",isCompleted:!0});(it(s)||s>15)&&(s=15),!o&&this._isNotInCommunity(n)&&(this._messageListHandler.removeByConversationID(n),this._completedMap.delete(n),this._roamingMessageSequenceMap.delete(n));var u=this._computeRemainingCount({conversationID:n,nextReqMessageID:o}),c=this._completedMap.has(n);if(Ve.l(\"\".concat(a,\" conversationID:\").concat(n,\" nextReqMessageID:\").concat(o)+\" remainingCount:\".concat(u,\" count:\").concat(s,\" isCompleted:\").concat(c)),this._needGetHistory({conversationID:n,remainingCount:u,count:s}))return this.getHistoryMessages({conversationID:n,nextReqMessageID:o,count:20}).then((function(e){var o=e.nextReqID,s=e.storedMessageList,i=t._completedMap.has(n),r=s;u>0&&(r=t._messageListHandler.getLocalMessageList(n).slice(0,s.length+u));var c={nextReqMessageID:i?\"\":o,messageList:r,isCompleted:i};return Ve.l(\"\".concat(a,\" ret.nextReqMessageID:\").concat(c.nextReqMessageID,\" ret.isCompleted:\").concat(c.isCompleted,\" ret.length:\").concat(r.length)),Ya(c)}));this.modifyMessageList(n);var l=this._getMessageListFromMemory({conversationID:n,nextReqMessageID:o,count:s});return Xa(l)}},{key:\"_getMessageListFromMemory\",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=e.count,s=\"\".concat(this._n,\"._getMessageListFromMemory\"),a=this._messageListHandler.getLocalMessageList(t),i=a.length,r=0,u={isCompleted:!1,nextReqMessageID:\"\",messageList:[]};return n?(r=a.findIndex((function(e){return e.ID===n})))>o?(u.messageList=a.slice(r-o,r),u.nextReqMessageID=a[r-o].ID):(u.messageList=a.slice(0,r),u.isCompleted=!0):i>o?(r=i-o,u.messageList=a.slice(r,i),u.nextReqMessageID=a[r].ID):(u.messageList=a.slice(0,i),u.isCompleted=!0),Ve.l(\"\".concat(s,\" conversationID:\").concat(t)+\" ret.nextReqMessageID:\".concat(u.nextReqMessageID,\" ret.isCompleted:\").concat(u.isCompleted,\" ret.length:\").concat(u.messageList.length)),u}},{key:\"getMessageListHopping\",value:function(e){var t=e.conversationID,n=e.sequence,o=e.time,s=e.count,a=e.direction,i=void 0===a?0:a;if((it(s)||s>15)&&(s=15),t.startsWith(E.CONV_C2C)){var r=this.getModule(Un),u=t.replace(E.CONV_C2C,\"\");return r.getRoamingMessagesHopping({peerAccount:u,time:o,count:s,direction:i})}if(t.startsWith(E.CONV_GROUP)){var c=this.getModule(Pn),l=t.replace(E.CONV_GROUP,\"\");return c.getRoamingMessagesHopping({groupID:l,sequence:n,count:s,direction:i})}}},{key:\"_computeRemainingCount\",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=this._messageListHandler.getLocalMessageList(t),s=o.length;if(!n)return s;var a=0;return Et(t)?a=o.findIndex((function(e){return e.ID===n})):St(t)&&(a=-1!==n.indexOf(\"-\")?o.findIndex((function(e){return e.ID===n})):o.findIndex((function(e){return e.sequence===n}))),-1===a&&(a=0),a}},{key:\"_getMessageListSize\",value:function(e){return this._messageListHandler.getLocalMessageList(e).length}},{key:\"_needGetHistory\",value:function(e){var t=e.conversationID,n=e.remainingCount,o=e.count,s=this.getLocalConversation(t),a=\"\";return s&&s.groupProfile&&(a=s.groupProfile.type),!Lt(t)&&!Tt(a)&&(!(St(t)&&this._isPagingGetGroupListCompleted()&&this._getLocalGroupCount()<=4e3&&!this._hasLocalGroup(t)&&!this._isTopicConversation(t))&&(n<=o&&!this._completedMap.has(t)))}},{key:\"_isTopicConversation\",value:function(e){var t=e.replace(E.CONV_GROUP,\"\");return kt(t)}},{key:\"getHistoryMessages\",value:function(e){var t=e.conversationID,n=e.count;if(t===E.CONV_SYSTEM)return Xa();var o=15;n>20&&(o=20);var s=null;if(Et(t)){var a=this._roamingMessageKeyAndTimeMap.has(t);return(s=this.getModule(Un))?s.getRoamingMessage({conversationID:t,peerAccount:t.replace(E.CONV_C2C,\"\"),count:o,lastMessageTime:a?this._roamingMessageKeyAndTimeMap.get(t).lastMessageTime:0,messageKey:a?this._roamingMessageKeyAndTimeMap.get(t).messageKey:\"\"}):Za({code:ha.CANNOT_FIND_MODULE})}if(St(t)){if(!(s=this.getModule(Pn)))return Za({code:ha.CANNOT_FIND_MODULE});var i=null;this._conversationMap.has(t)&&(i=this._conversationMap.get(t).lastMessage);var r=0;i&&(r=i.lastSequence);var u=this._roamingMessageSequenceMap.get(t);return s.getRoamingMessage({conversationID:t,groupID:t.replace(E.CONV_GROUP,\"\"),count:o,sequence:u||r})}return Xa()}},{key:\"patchConversationLastMessage\",value:function(e){var t=this.getLocalConversation(e);if(t){var n=t.lastMessage,o=n.messageForShow,s=n.payload;if(zt(o)||zt(s)){var a=this._messageListHandler.getLocalMessageList(e);if(0===a.length)return;var i=a[a.length-1];Ve.l(\"\".concat(this._n,\".patchConversationLastMessage conversationID:\").concat(e,\" payload:\"),i.payload),t.updateLastMessage(i)}}}},{key:\"onRoamingMessage\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=n.startsWith(E.CONV_C2C)?E.CONV_C2C:E.CONV_GROUP,a=null,i=[],r=[],u=0,c=e.length,l=null,d=s===E.CONV_GROUP,p=this.getModule(Kn),g=this.getFileDownloadProxy(),h=function(){u=d?e.length-1:0,c=d?0:e.length},_=function(){d?--u:++u},f=function(){return d?u>=c:u<c};for(h();f();_())if(d&&1===e[u].sequence&&o&&this.setCompleted(n),1!==e[u].isPlaceMessage)if((a=new Wa(e[u])).to=e[u].to,s!==E.CONV_GROUP||it(e[u].topicID)||(a.to=e[u].topicID),a.isSystemMessage=!!e[u].isSystemMessage,a.conversationType=s,4===e[u].event?l={type:E.MSG_GRP_TIP,content:t(t({},e[u].elements),{},{groupProfile:e[u].groupProfile})}:(e[u].elements=p.parseElements(e[u].elements,e[u].from),l=e[u].elements),d||a.setNickAndAvatar({nick:e[u].nick,avatar:e[u].avatar}),zt(l)){var v=new Aa(\"emptyMessageBody\");v.setMessage(\"from:\".concat(a.from,\" to:\").concat(a.to,\" sequence:\").concat(a.sequence,\" event:\").concat(e[u].event)),v.setNetworkType(this.getNetworkType()).setLevel(\"warning\").end()}else a.setElement(l,g),a.reInitialize(this.getMyUserID()),i.push(a);return h=_=f=null,o?(this._messageListHandler.unshift(i,r),i=null,r):(r=null,i)}},{key:\"findMessage\",value:function(e){return this._messageListHandler.findMessage(e)}},{key:\"_isNotInCommunity\",value:function(e){var t=!1;if(e.startsWith(E.CONV_GROUP)&&this._isTopicConversation(e)){var n=xt(e.replace(E.CONV_GROUP,\"\"));this.getModule(Pn).hasLocalGroup(n)||(t=!0)}return t}},{key:\"deleteTopicRoamingMessageInfo\",value:function(e){var t=this;Dt({groupID:e})&&this._messageListHandler.getTopicConversationIDList(e).forEach((function(e){t._messageListHandler.removeByConversationID(e),t._completedMap.delete(e),t._roamingMessageSequenceMap.delete(e)}))}},{key:\"deleteGroupRomaingMessageInfo\",value:function(e){var t=\"\".concat(E.CONV_GROUP).concat(e);this._messageListHandler.removeByConversationID(t),this._completedMap.delete(t),this._roamingMessageSequenceMap.delete(t)}},{key:\"setMessageRead\",value:function(e){var t=e.conversationID,n=this.getLocalConversation(t);if(Ve.l(\"\".concat(this._n,\".setMessageRead conversationID:\").concat(t,\" unreadCount:\").concat(n?n.unreadCount:0)),!n)return Xa();if(n.type!==E.CONV_GROUP&&n.type!==E.CONV_TOPIC||zt(n.groupAtInfoList)||this.deleteGroupAtTips(t),0===n.unreadCount)return Xa();if(n.type===E.CONV_GROUP&&!this._hasLocalGroup(t))return 0!==n.unreadCount&&(n.unreadCount=0,this.emitConversationUpdate(!0,!1)),Xa();var o=this._messageListHandler.getLocalLastMessage(t),s=n.lastMessage.lastTime;o&&s<o.time&&(s=o.time);var a=n.lastMessage.lastSequence;if(o&&a<o.sequence&&(a=o.sequence),n.type===E.CONV_TOPIC&&it(o)){var i=this.getModule(Fn),r=t.replace(E.CONV_GROUP,\"\"),u=xt(r),c=i.getLocalTopic(u,r);c&&(a=c.nextMessageSeq-1)}var l=null;switch(n.type){case E.CONV_C2C:return(l=this.getModule(Un))?l.setMessageRead({conversationID:t,lastMessageTime:s}):Za({code:ha.CANNOT_FIND_MODULE});case E.CONV_GROUP:case E.CONV_TOPIC:return(l=this.getModule(Pn))?l.setMessageRead({conversationID:t,lastMessageSeq:a}):Za({code:ha.CANNOT_FIND_MODULE});case E.CONV_SYSTEM:return n.unreadCount=0,this.emitConversationUpdate(!0,!1),Xa();default:return Xa()}}},{key:\"setAllMessageRead\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=\"setAllMessageRead\",o=\"\".concat(this._n,\".\").concat(n);t.scope||(t.scope=E.READ_ALL_MSG),Ve.l(\"\".concat(o,\" options:\"),t);var s=this._createSetAllMessageReadPack(t);if(0===s.readAllC2CMessage&&0===s.groupMessageReadInfoList.length)return Xa();var a=new Aa(n);return this.request({protocolName:us,requestData:s}).then((function(n){var o=n.data,s=e._handleAllMessageRead(o);return a.setMessage(\"scope:\".concat(t.scope,\" failureGroups:\").concat(JSON.stringify(s))).setNetworkType(e.getNetworkType()).end(),Xa()})).catch((function(t){return e.probeNetwork().then((function(e){var n=v(e,2),o=n[0],s=n[1];a.setError(t,o,s).end()})),Ve.w(\"\".concat(o,\" failed. error:\"),t),Za({code:t&&t.code?t.code:ha.MESSAGE_UNREAD_ALL_FAIL,message:t&&t.message?t.message:void 0})}))}},{key:\"setConversationCustomData\",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:\"markConversation\",value:function(e){return this._convGroupHandler.markConversation(e)}},{key:\"getConversationGroupList\",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:\"createConversationGroup\",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:\"deleteConversationGroup\",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:\"renameConversationGroup\",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:\"addConversationsToGroup\",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:\"deleteConversationsFromGroup\",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:\"onConversationMarkUpdated\",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:\"onConversationGroupCreated\",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:\"onConversationGroupDeleted\",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:\"onConversationGroupNameUpdated\",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:\"onConversationInGroupUpdated\",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:\"onConversationAddedToOrDeletedFromGroup\",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:\"_getConversationLastMessageSequence\",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastSequence;return t&&n<t.sequence&&(n=t.sequence),n}},{key:\"_getConversationLastMessageTime\",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastTime;return t&&n<t.time&&(n=t.time),n}},{key:\"_createSetAllMessageReadPack\",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},o=e.scope,s=D(this._conversationMap);try{for(s.s();!(t=s.n()).done;){var a=v(t.value,2)[1];if(a.unreadCount>0)if(a.type===E.CONV_C2C&&0===n.readAllC2CMessage){if(o===E.READ_ALL_MSG)n.readAllC2CMessage=1;else if(o===E.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else if(a.type===E.CONV_GROUP&&(o===E.READ_ALL_GROUP_MSG||o===E.READ_ALL_MSG)){var i=this._getConversationLastMessageSequence(a);n.groupMessageReadInfoList.push({groupID:a.groupProfile.groupID,messageSequence:i})}}}catch(r){s.e(r)}finally{s.f()}return n}},{key:\"onPushedAllMessageRead\",value:function(e){this._handleAllMessageRead(e)}},{key:\"_handleAllMessageRead\",value:function(e){var t=e.groupMessageReadInfoList,n=e.readAllC2CMessage,o=this._parseGroupReadInfo(t);return this._updateAllConversationUnreadCount({readAllC2CMessage:n})>=1&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate()),o}},{key:\"_parseGroupReadInfo\",value:function(e){var t=[];if(e&&e.length)for(var n=0,o=e.length;n<o;n++){var s=e[n],a=s.groupID,i=s.sequence,r=s.retCode,u=s.lastMessageSeq;it(r)?this._remoteGroupReadSequenceMap.set(a,u):(this._remoteGroupReadSequenceMap.set(a,i),0!==r&&t.push(\"\".concat(a,\"-\").concat(i,\"-\").concat(r)))}return t}},{key:\"_updateAllConversationUnreadCount\",value:function(e){var t,n=e.readAllC2CMessage,o=0,s=D(this._conversationMap);try{for(s.s();!(t=s.n()).done;){var a=v(t.value,2),i=a[0],r=a[1];if(r.unreadCount>=1){if(1===n&&r.type===E.CONV_C2C){var u=this._getConversationLastMessageTime(r);this.updateIsReadAfterReadReport({conversationID:i,lastMessageTime:u})}else if(r.type===E.CONV_GROUP){var c=i.replace(E.CONV_GROUP,\"\");if(this._remoteGroupReadSequenceMap.has(c)){var l=this._remoteGroupReadSequenceMap.get(c),d=this._getConversationLastMessageSequence(r);this.updateIsReadAfterReadReport({conversationID:i,remoteReadSequence:l}),d>=l&&this._remoteGroupReadSequenceMap.delete(c)}}this.updateUnreadCount(i,!1)&&(o+=1)}}}catch(p){s.e(p)}finally{s.f()}return o}},{key:\"isRemoteRead\",value:function(e){var t=e.conversationID,n=e.sequence,o=t.replace(E.CONV_GROUP,\"\"),s=!1;if(this._remoteGroupReadSequenceMap.has(o)){var a=this._remoteGroupReadSequenceMap.get(o);n<=a&&(s=!0,Ve.l(\"\".concat(this._n,\".isRemoteRead conversationID:\").concat(t,\" messageSequence:\").concat(n,\" remoteReadSequence:\").concat(a))),n>=a+10&&this._remoteGroupReadSequenceMap.delete(o)}return s}},{key:\"updateIsReadAfterReadReport\",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,o=e.lastMessageTime,s=this._messageListHandler.getLocalMessageList(t);if(0!==s.length)for(var a,i=s.length-1;i>=0;i--)if(a=s[i],!(o&&a.time>o||n&&a.sequence>n)){if(\"in\"===a.flow&&a.isRead)break;a.setIsRead(!0)}}},{key:\"updateUnreadCount\",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!1,o=this.getLocalConversation(e),s=this._messageListHandler.getLocalMessageList(e);if(o){var a=o.unreadCount,i=s.filter((function(e){return!e.isRead&&!e._onlineOnlyFlag&&!e.isDeleted})).length;if(a!==i&&(o.unreadCount=i,n=!0,Ve.l(\"\".concat(this._n,\".updateUnreadCount from \").concat(a,\" to \").concat(i,\", conversationID:\").concat(e)),!0===t&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())),n&&o.type===E.CONV_TOPIC){var r=o.unreadCount,u=this.getModule(Fn),c=e.replace(E.CONV_GROUP,\"\");u.onConversationProxy({topicID:c,unreadCount:r})}return n}}},{key:\"clearGroupAtInfoList\",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversation(e);if(n&&n.groupAtInfoList.length>0){if(n.clearGroupAtInfoList(),Ve.l(\"\".concat(this._n,\".clearGroupAtInfoList conversationID:\").concat(e)),n.type===E.CONV_TOPIC){var o=n.groupAtInfoList,s=this.getModule(Fn),a=e.replace(E.CONV_GROUP,\"\");s.onConversationProxy({topicID:a,groupAtInfoList:o})}!0===t&&this.emitConversationUpdate(!0,!1)}}},{key:\"updateReadReceiptInfo\",value:function(e){var t=this,n=e.userID,o=void 0===n?void 0:n,s=e.groupID,a=void 0===s?void 0:s,i=e.readReceiptList;if(!zt(i)){var r=[];if(it(o)){if(!it(a)){var u=\"\".concat(E.CONV_GROUP).concat(a);i.forEach((function(e){var n=e.tinyID,o=e.clientTime,s=e.random,i=e.readCount,c=e.unreadCount,l=\"\".concat(n,\"-\").concat(o,\"-\").concat(s),d=t._messageListHandler.getLocalMessage(u,l),p={groupID:a,messageID:l,readCount:0,unreadCount:0};d&&(et(i)&&(d.readReceiptInfo.readCount=i,p.readCount=i),et(c)&&(d.readReceiptInfo.unreadCount=c,p.unreadCount=c),r.push(p))}))}}else{var c=\"\".concat(E.CONV_C2C).concat(o);i.forEach((function(e){var n=e.tinyID,s=e.clientTime,a=e.random,i=\"\".concat(n,\"-\").concat(s,\"-\").concat(a),u=t._messageListHandler.getLocalMessage(c,i);if(u){u.readReceiptInfo.isPeerRead=!0;var l={userID:o,messageID:i,isPeerRead:!0};r.push(l)}}))}r.length>0&&this.emitOuterEvent(k.MESSAGE_READ_RECEIPT_RECEIVED,r)}}},{key:\"recomputeGroupUnreadCount\",value:function(e){var t=e.conversationID,n=e.count,o=this.getLocalConversation(t);if(o){var s=o.unreadCount,a=s-n;a<0&&(a=0),o.unreadCount=a,Ve.l(\"\".concat(this._n,\".recomputeGroupUnreadCount from \").concat(s,\" to \").concat(a,\", conversationID:\").concat(t))}}},{key:\"updateIsRead\",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&0!==n.length&&!Lt(t.type)){for(var o=[],s=0,a=n.length;s<a;s++)\"in\"!==n[s].flow?\"out\"!==n[s].flow||n[s].isRead||n[s].setIsRead(!0):o.push(n[s]);var i=0;if(t.type===E.CONV_C2C){var r=o.slice(-t.unreadCount).filter((function(e){return e.isRevoked})).length;i=o.length-t.unreadCount-r}else i=o.length-t.unreadCount;for(var u=0;u<i&&!o[u].isRead;u++)o[u].setIsRead(!0)}}},{key:\"deleteGroupAtTips\",value:function(e){var t=this,n=\"\".concat(this._n,\".deleteGroupAtTips\");Ve.l(\"\".concat(n));var o=this._conversationMap.get(e);if(!o)return Promise.resolve();var s=o.groupAtInfoList;if(0===s.length)return Promise.resolve();var a=void 0;e.startsWith(E.CONV_GROUP)&&(a=e.replace(E.CONV_GROUP,\"\"));var i=m(s);if((Dt({groupID:a})||kt(a))&&0===(i=s.filter((function(e){return!e.atTypeArray.includes(E.CONV_AT_ALL)}))).length)return this.clearGroupAtInfoList(e,!1),Promise.resolve();var r=this.getMyUserID();return this.request({protocolName:Fo,requestData:{messageListToDelete:i.map((function(e){return{from:e.from,to:r,messageSeq:e.__sequence,messageRandom:e.__random,groupID:it(e.topicID)?e.groupID:e.topicID}}))}}).then((function(){return Ve.l(\"\".concat(n,\" ok. count:\").concat(s.length)),t.clearGroupAtInfoList(e,!1),Promise.resolve()})).catch((function(e){return Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"appendToMessageList\",value:function(e){this._messageListHandler.pushIn(e)}},{key:\"setMessageRandom\",value:function(e){this.singlyLinkedList.set(e.random)}},{key:\"deleteMessageRandom\",value:function(e){this.singlyLinkedList.delete(e.random)}},{key:\"pushIntoMessageList\",value:function(e,t,n){return!(!this._messageListHandler.pushIn(t,n)||this._isMessageFromCurrentInstance(t)&&!n)&&(e.push(t),!0)}},{key:\"_isMessageFromCurrentInstance\",value:function(e){return this.singlyLinkedList.has(e.random)}},{key:\"revoke\",value:function(e,t,n){return this._messageListHandler.revoke(e,t,n)}},{key:\"getPeerReadTime\",value:function(e){return this._peerReadTimeMap.get(e)}},{key:\"recordPeerReadTime\",value:function(e,t){this._peerReadTimeMap.has(e)?this._peerReadTimeMap.get(e)<t&&this._peerReadTimeMap.set(e,t):this._peerReadTimeMap.set(e,t)}},{key:\"updateMessageIsPeerReadProperty\",value:function(e,t){if(e.startsWith(E.CONV_C2C)&&t>0){var n=this._messageListHandler.updateMessageIsPeerReadProperty(e,t);if(n.length>0&&this.emitOuterEvent(k.MESSAGE_READ_BY_PEER,n),this._conversationMap.has(e)){var o=this._conversationMap.get(e).lastMessage;zt(o)||o.fromAccount===this.getMyUserID()&&o.lastTime<=t&&!o.isPeerRead&&(o.isPeerRead=!0,this.emitConversationUpdate(!0,!1))}}}},{key:\"updateMessageIsModifiedProperty\",value:function(e){this._messageListHandler.updateMessageIsModifiedProperty(e)}},{key:\"setCompleted\",value:function(e){Ve.l(\"\".concat(this._n,\".setCompleted. conversationID:\").concat(e)),this._completedMap.set(e,!0)}},{key:\"updateRoamingMessageKeyAndTime\",value:function(e,t,n){this._roamingMessageKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:\"updateRoamingMessageSequence\",value:function(e,t){this._roamingMessageSequenceMap.set(e,t)}},{key:\"getConversationList\",value:function(e){var t=this,n=\"getConversationList\",o=\"\".concat(this._n,\".\").concat(n),s=\"pagingStatus:\".concat(this._pagingStatus,\", local conversation count:\").concat(this._conversationMap.size,\", options:\").concat(e);if(Ve.l(\"\".concat(o,\". \").concat(s)),this._pagingStatus===$t.REJECTED){var a=new Aa(n);return a.setMessage(s),this.syncConversationList().then((function(){a.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return Ya({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}if(0===this._conversationMap.size){var i=new Aa(n);return i.setMessage(s),this.syncConversationList().then((function(){i.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return Ya({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}var r=this._getConversationList(e);return Ve.l(\"\".concat(o,\". returned conversation count:\").concat(r.length)),Xa({conversationList:r,isSyncCompleted:this._isSyncCompleted()})}},{key:\"_getConversationList\",value:function(e){if(it(e))return this.getLocalConversationList();if(at(e))return 0===e.length?[]:this.getLocalConversationList().filter((function(t){return e.includes(t.conversationID)}));if(st(e)){var t=e.type,n=e.markType,o=e.groupName;return this.getLocalConversationList().filter((function(e){return(t!==E.CONV_C2C&&t!==E.CONV_GROUP||e.type===t)&&(!nt(o)||e.conversationGroupList.includes(o))&&(!et(n)||e.markList.includes(n))}))}return[]}},{key:\"_handleC2CPeerReadTime\",value:function(){var e,t=D(this._conversationMap);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2),o=n[0],s=n[1];s.type===E.CONV_C2C&&(Ve.d(\"\".concat(this._n,\"._handleC2CPeerReadTime conversationID:\").concat(o,\" peerReadTime:\").concat(s.peerReadTime)),this.recordPeerReadTime(o,s.peerReadTime))}}catch(a){t.e(a)}finally{t.f()}}},{key:\"_isPagingGetGroupListCompleted\",value:function(){return this.getModule(Pn).isPagingGetCompleted()}},{key:\"_getLocalGroupCount\",value:function(){return this.getModule(Pn).getLocalGroupList().length}},{key:\"_hasLocalGroup\",value:function(e){return this.getModule(Pn).hasLocalGroup(e.replace(E.CONV_GROUP,\"\"))}},{key:\"getConversationProfile\",value:function(e){var t,n=this;if((t=this._conversationMap.has(e)?this._conversationMap.get(e):new fi({conversationID:e,type:e.slice(0,3)===E.CONV_C2C?E.CONV_C2C:E.CONV_GROUP},this.isIntl()))._isInfoCompleted||t.type===E.CONV_SYSTEM)return Xa({conversation:t});if(St(e)&&!this._hasLocalGroup(e))return Xa({conversation:t});var o=\"\".concat(this._n,\".\").concat(\"getConversationProfile\"),s=new Aa(\"getConversationProfile\");return Ve.l(\"\".concat(o,\". conversationID:\").concat(e,\" remark:\").concat(t.remark,\" lastMessage:\"),t.lastMessage),this._updateUserOrGroupProfileCompletely(t).then((function(a){s.setNetworkType(n.getNetworkType()).setMessage(\"conversationID:\".concat(e,\" unreadCount:\").concat(a.data.conversation.unreadCount)).end();var i=n.getModule(bn);if(i&&t.type===E.CONV_C2C){var r=e.replace(E.CONV_C2C,\"\");if(i.isMyFriend(r)){var u=i.getFriendRemark(r);t.remark!==u&&(t.remark=u,Ve.l(\"\".concat(o,\". conversationID:\").concat(e,\" patch remark:\").concat(t.remark)))}}return Ve.l(\"\".concat(o,\" ok. conversationID:\").concat(e)),a})).catch((function(t){return n.probeNetwork().then((function(n){var o=v(n,2),a=o[0],i=o[1];s.setError(t,a,i).setMessage(\"conversationID:\".concat(e)).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),t),Za(t)}))}},{key:\"_updateUserOrGroupProfileCompletely\",value:function(e){var t=this;return e.type===E.CONV_C2C?this.getModule(Gn).getUserProfile({userIDList:[e.toAccount]}).then((function(n){var o=n.data;return 0===o.length?Za(new ja({code:ha.USER_OR_GROUP_NOT_FOUND})):(e.userProfile=o[0],e._isInfoCompleted=!0,t._unshiftConversation(e),Xa({conversation:e}))})):this.getModule(Pn).getGroupProfile({groupID:e.toAccount}).then((function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._unshiftConversation(e),Xa({conversation:e})}))}},{key:\"_unshiftConversation\",value:function(e){e instanceof fi&&!this._conversationMap.has(e.conversationID)&&(this._conversationMap=new Map([[e.conversationID,e]].concat(m(this._conversationMap))),this._setStorageConversationList(),this.emitConversationUpdate(!0,!1))}},{key:\"_onProfileUpdated\",value:function(e){var t=this;e.data.forEach((function(e){var n=e.userID;if(n===t.getMyUserID())t._onMyProfileModified({latestNick:e.nick,latestAvatar:e.avatar});else{var o=t._conversationMap.get(\"\".concat(E.CONV_C2C).concat(n));o&&(o.userProfile=e)}}))}},{key:\"_isSyncCompleted\",value:function(){return this._pagingStatus===$t.RESOLVED}},{key:\"_errorLog\",value:function(e,t,n,o){var s=new Error(\"Params validate failed.\"),a=\"\".concat(this.getErrorMessage(\"API_REFER\")).concat(e);throw Ve.w(\"[\".concat(e,\"] | \").concat(t,\" | \").concat(this.getErrorMessage(n,o),\", \").concat(a)),Ve.e(\"[\".concat(e,\"] Invalid \").concat(t,\": type check failed for \").concat(t,\".\")),s}},{key:\"_isValidConversationID\",value:function(e){return Et(e)||St(e)||Lt(e)}},{key:\"deleteConversation\",value:function(e){var t=this,n=\"deleteConversation\";return nt(e)||ot(e)||this._errorLog(n,\"options\",\"StringOrObjectRequiredLog\"),nt(e)?(this._isValidConversationID(e)||this._errorLog(n,\"options\",\"InvalidConversationID\",e),Ve.l(\"\".concat(this._n,\".\").concat(n,\" conversationID:\").concat(e)),this.deleteConversationList({conversationIDList:[e],flag:1})):(at(e.conversationIDList)||this._errorLog(n,\"conversationIDList\",\"ArrayRequiredLog\"),0===e.conversationIDList.length&&this._errorLog(n,\"conversationIDList\",\"NonEmptyArrayLog\"),e.conversationIDList.forEach((function(e){t._isValidConversationID(e)||t._errorLog(n,\"conversationIDList\",\"InvalidConversationID\",e)})),\"clearHistoryMessage\"in e&&\"boolean\"!=typeof e.clearHistoryMessage&&this._errorLog(n,\"clearHistoryMessage\",\"BooleanRequiredLog\"),e.conversationIDList.length>100&&(e.conversationIDList=e.conversationIDList.slice(0,100)),this.deleteConversationList(e))}},{key:\"deleteConversationList\",value:function(e){var t=this,n=e.conversationIDList,o=void 0===n?[]:n,s=e.clearHistoryMessage,a=void 0===s||s,i=e.flag,r=void 0===i?0:i,u=\"\".concat(this._n,\".\").concat(\"deleteConversationList\");Ve.l(\"\".concat(u,\" conversationIDList.length:\").concat(o.length,\" clearHistoryMessage:\").concat(a));var c=new Aa(\"deleteConversationList\");return c.setMessage(\"conversationIDList:\".concat(o)),Promise.all([this.rmLocalOnlyConversationList(o),this.rmLocalAndRemoteConversationList(o,a)]).then((function(e){c.setNetworkType(t.getNetworkType()).end();var n=[].concat(m(e[0]),m(e[1]));return 0===n.length?Za(new ja({code:ha.CONVERSATION_NOT_FOUND})):(Ve.l(\"\".concat(u,\" ok\")),Xa(1===r?{conversationID:n[0]}:{conversationIDList:n}))})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];c.setError(e,o,s).end()})),Ve.e(\"\".concat(u,\" failed. error:\"),e),Za(e)}))}},{key:\"rmLocalOnlyConversationList\",value:function(e){var t=this;return e.filter((function(e){if(!t._conversationMap.has(e))return!1;var n=t.getLocalConversation(e).type;return n!==E.CONV_GROUP||t._hasLocalGroup(e)?n===E.CONV_SYSTEM&&(t.getModule(Pn).deleteGroupSystemNotice({messageList:t._messageListHandler.getLocalMessageList(e)}),t.deleteLocalConversation(e),!0):(t.deleteLocalConversation(e),!0)}))}},{key:\"rmLocalAndRemoteConversationList\",value:function(e,t){var n=this,o={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:t?1:0};return e.forEach((function(e){if(n._conversationMap.has(e)){var t=n.getLocalConversation(e).type;t===E.CONV_C2C?o.conversationList.push({toAccount:e.replace(t,\"\"),type:1}):t===E.CONV_GROUP&&n._hasLocalGroup(e)&&o.conversationList.push({toGroupID:e.replace(t,\"\"),type:2})}})),0===o.conversationList.length?[]:this.request({protocolName:Po,requestData:o}).then((function(e){var t=[];return e.data.resultList.length>0&&e.data.resultList.map((function(e){if(0===e.code){var n=1===e.type?\"\".concat(E.CONV_C2C).concat(e.to):\"\".concat(E.CONV_GROUP).concat(e.groupID);t.push(n)}})),n.deleteLocalConversationList(t),t}))}},{key:\"clearHistoryMessage\",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(e))return Za({code:ha.CONVERSATION_NOT_FOUND});var o=this._conversationMap.get(e).type;if(o===E.CONV_C2C)n.type=1,n.toAccount=e.replace(E.CONV_C2C,\"\");else{if(o!==E.CONV_GROUP)return o===E.CONV_SYSTEM?(this.getModule(Pn).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(e)}),Xa({conversationID:e})):Za({code:ha.CONVERSATION_UN_RECORDED_TYPE});n.type=2,n.toGroupID=e.replace(E.CONV_GROUP,\"\")}var s=\"\".concat(this._n,\".\").concat(\"clearHistoryMessage\"),a=new Aa(\"clearHistoryMessage\");return a.setMessage(\"conversationID:\".concat(e)),Ve.l(\"\".concat(s,\". conversationID:\").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.request({protocolName:bo,requestData:n})})).then((function(){a.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(s,\" ok\")),t._messageListHandler.removeByConversationID(e),t.setCompleted(e);var n=t.getLocalConversation(e);return n&&(n.updateLastMessage(),t._sortConversationListAndEmitEvent()),Xa({conversationID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.e(\"\".concat(s,\" failed. error:\"),e),Za(e)}))}},{key:\"pinConversation\",value:function(e){var t=this,n=e.conversationID,o=e.isPinned;if(!this._conversationMap.has(n))return Za({code:ha.CONVERSATION_NOT_FOUND});var s=this.getLocalConversation(n);if(s.isPinned===o)return Xa({conversationID:n});var a=\"\".concat(this._n,\".\").concat(\"pinConversation\"),i=new Aa(\"pinConversation\");i.setMessage(\"conversationID:\".concat(n,\" isPinned:\").concat(o)),Ve.l(\"\".concat(a,\". conversationID:\").concat(n,\" isPinned:\").concat(o));var r=null;return Et(n)?r={type:1,toAccount:n.replace(E.CONV_C2C,\"\")}:St(n)&&(r={type:2,groupID:n.replace(E.CONV_GROUP,\"\")}),this.request({protocolName:wo,requestData:{fromAccount:this.getMyUserID(),operationType:!0===o?1:2,itemList:[r]}}).then((function(){return i.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(a,\" ok\")),s.isPinned!==o&&(s.isPinned=o,t._sortConversationListAndEmitEvent()),Ya({conversationID:n})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(a,\" failed. error:\"),e),Za(e)}))}},{key:\"setMessageRemindType\",value:function(e){return this._messageRemindHandler.set(e)}},{key:\"patchMessageRemindType\",value:function(e){var t=e.ID,n=e.isC2CConversation,o=e.messageRemindType,s=!1,a=this.getLocalConversation(n?\"\".concat(E.CONV_C2C).concat(t):\"\".concat(E.CONV_GROUP).concat(t));return a&&a.messageRemindType!==o&&(a.messageRemindType=o,s=!0),Ve.d(\"\".concat(this._n,\".patchMessageRemindType options:\"),e,\"ret:\".concat(s)),s}},{key:\"onC2CMessageRemindTypeSynced\",value:function(e){var t=this,n=\"\".concat(this._n,\".onC2CMessageRemindTypeSynced\");Ve.d(n,e),e.dataList.forEach((function(e){if(!zt(e.muteNotificationsSync)){var o,s=e.muteNotificationsSync,a=s.to,i=s.updateSequence,r=s.muteFlag;t._messageRemindHandler.setUpdateSequence(i),0===r?o=E.MSG_REMIND_ACPT_AND_NOTE:1===r?o=E.MSG_REMIND_DISCARD:2===r&&(o=E.MSG_REMIND_ACPT_NOT_NOTE);var u=0;t.patchMessageRemindType({ID:a,isC2CConversation:!0,messageRemindType:o})&&(u+=1),Ve.l(\"\".concat(n,\" updateCount:\").concat(u)),u>=1&&t.emitConversationUpdate(!0,!1)}}))}},{key:\"onGroupMessageRemindTypeSynced\",value:function(e){Ve.d(\"\".concat(this._n,\".onGroupMessageRemindTypeSynced options:\"),e),this._messageRemindHandler.onGroupMessageRemindTypeUpdated(e)}},{key:\"deleteLocalConversation\",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._conversationMap.has(e);if(Ve.d(\"\".concat(this._n,\".deleteLocalConversation conversationID:\").concat(e,\" has:\").concat(n)),n&&(this._conversationMap.delete(e),this._roamingMessageKeyAndTimeMap.has(e)&&this._roamingMessageKeyAndTimeMap.delete(e),this._roamingMessageSequenceMap.has(e)&&this._roamingMessageSequenceMap.delete(e),this._setStorageConversationList(),this._messageListHandler.removeByConversationID(e),this._completedMap.delete(e),t)){var o=!this._isTopicConversation(e);this.emitConversationUpdate(o,!1)}}},{key:\"deleteLocalConversationList\",value:function(e){var t=this,n=0,o=!1;e.forEach((function(e){t._conversationMap.has(e)&&(n+=t._conversationMap.get(e).unreadCount||0,t.deleteLocalConversation(e,!1),o=!0)})),Ve.l(\"\".concat(this._n,\".deleteLocalConversationList conversationIDList.length:\").concat(e.length,\" isConvIDExisted:\").concat(o)),o&&(this.emitConversationUpdate(!0,!1),n>0&&this.emitTotalUnreadMessageCountUpdate())}},{key:\"isMessageSentByCurrentInstance\",value:function(e){return!(!this._messageListHandler.hasLocalMessage(e.conversationID,e.ID)&&!this.singlyLinkedList.has(e.random))}},{key:\"modifyMessageList\",value:function(e){if(e.startsWith(E.CONV_C2C)&&this._conversationMap.has(e)){var t=this._conversationMap.get(e),n=Date.now();this._messageListHandler.modifyMessageSentByPeer({conversationID:e,latestNick:t.userProfile.nick,latestAvatar:t.userProfile.avatar});var o=this.getModule(Gn).getNickAndAvatarByUserID(this.getMyUserID());this._messageListHandler.modifyMessageSentByMe({conversationID:e,latestNick:o.nick,latestAvatar:o.avatar}),Ve.l(\"\".concat(this._n,\".modifyMessageList conversationID:\").concat(e,\" cost \").concat(Date.now()-n,\" ms\"))}}},{key:\"updateUserProfileSpecifiedKey\",value:function(e){Ve.l(\"\".concat(this._n,\".updateUserProfileSpecifiedKey options:\"),e);var t=e.conversationID,n=e.nick,o=e.avatar;if(this._conversationMap.has(t)){var s=this._conversationMap.get(t).userProfile;nt(n)&&s.nick!==n&&(s.nick=n),nt(o)&&s.avatar!==o&&(s.avatar=o),this.emitConversationUpdate(!0,!1)}}},{key:\"_onMyProfileModified\",value:function(e){var n=this,o=this.getLocalConversationList(),s=Date.now();o.forEach((function(o){n.modifyMessageSentByMe(t({conversationID:o.conversationID},e))})),Ve.l(\"\".concat(this._n,\"._onMyProfileModified. modify all messages sent by me, cost \").concat(Date.now()-s,\" ms\"))}},{key:\"modifyMessageSentByMe\",value:function(e){this._messageListHandler.modifyMessageSentByMe(e)}},{key:\"getLatestMessageSentByMe\",value:function(e){return this._messageListHandler.getLatestMessageSentByMe(e)}},{key:\"modifyMessageSentByPeer\",value:function(e){this._messageListHandler.modifyMessageSentByPeer(e)}},{key:\"getLatestMessageSentByPeer\",value:function(e){return this._messageListHandler.getLatestMessageSentByPeer(e)}},{key:\"pushIntoNoticeResult\",value:function(e,t){return!(!this._messageListHandler.pushIn(t)||this.singlyLinkedList.has(t.random))&&(e.push(t),!0)}},{key:\"getLocalLastMessage\",value:function(e){return this._messageListHandler.getLocalLastMessage(e)}},{key:\"checkAndPatchRemark\",value:function(){var e=Promise.resolve();if(0===this._conversationMap.size)return e;var t=this.getModule(bn);if(!t)return e;var n=m(this._conversationMap.values()).filter((function(e){return e.type===E.CONV_C2C}));if(0===n.length)return e;var o=0;return n.forEach((function(e){var n=e.conversationID.replace(E.CONV_C2C,\"\");if(t.isMyFriend(n)){var s=t.getFriendRemark(n);e.remark!==s&&(e.remark=s,o+=1)}})),Ve.l(\"\".concat(this._n,\".checkAndPatchRemark. c2c conversation count:\").concat(n.length,\", patched count:\").concat(o)),e}},{key:\"updateTopicConversation\",value:function(e){this._updateLocalConversationList({conversationOptionsList:e,isFromGetConversations:!0})}},{key:\"sendReadReceipt\",value:function(e){var t=e[0],n=null;return t.conversationType===E.CONV_C2C?n=this._m.getModule(Un):t.conversationType===E.CONV_GROUP&&(n=this._m.getModule(Pn)),n?n.sendReadReceipt(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"getReadReceiptList\",value:function(e){var t=e[0],n=null;return t.conversationType===E.CONV_C2C?n=this._m.getModule(Un):t.conversationType===E.CONV_GROUP&&(n=this._m.getModule(Pn)),n?n.getReadReceiptList(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"getLastMessageTime\",value:function(e){var t=this.getLocalConversation(e);return t?t.lastMessage.lastTime:0}},{key:\"getTotalUnreadMessageCount\",value:function(){var e=this.getLocalConversationList(),t=0;return e.forEach((function(e){e.type!==E.CONV_SYSTEM&&(\"\"!==e.messageRemindType&&e.messageRemindType!==E.MSG_REMIND_ACPT_AND_NOTE||(t+=e.unreadCount))})),t}},{key:\"emitTotalUnreadMessageCountUpdate\",value:function(){var e=this.getTotalUnreadMessageCount();this._convTotalUnreadCount!==e&&(Ve.l(\"\".concat(this._n,\".emitTotalUnreadMessageCountUpdate from \").concat(this._convTotalUnreadCount,\" to \").concat(e)),this._convTotalUnreadCount=e,this.emitOuterEvent(k.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._pagingStatus=$t.NOT_START,this._messageListHandler.reset(),this._messageRemindHandler.reset(),this._roamingMessageKeyAndTimeMap.clear(),this._roamingMessageSequenceMap.clear(),this.singlyLinkedList.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._conversationMap.clear(),this._pagingTimeStamp=0,this._pagingStartIndex=0,this._pagingPinnedTimeStamp=0,this._pagingPinnedStartIndex=0,this._remoteGroupReadSequenceMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this.resetReady()}}]),s}(uo),yi=function(){function e(t){o(this,e),this._groupModule=t,this._n=\"GroupTipsHandler\",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map}return a(e,[{key:\"onCheckTimer\",value:function(e){e%1==0&&this._cachedGroupTipsMap.size>0&&this._checkCachedGroupTips()}},{key:\"_checkCachedGroupTips\",value:function(){var e=this;this._cachedGroupTipsMap.forEach((function(t,n){var o=e._checkCountMap.get(n),s=e._groupModule.hasLocalGroup(n);Ve.l(\"\".concat(e._n,\"._checkCachedGroupTips groupID:\").concat(n,\" hasLocalGroup:\").concat(s,\" checkCount:\").concat(o)),s?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):(o++,e._checkCountMap.set(n,o))}))}},{key:\"onNewGroupTips\",value:function(e){Ve.d(\"\".concat(this._n,\".onReceiveGroupTips count:\").concat(e.dataList.length));var t=this.newGroupTipsStoredAndSummary(e),n=t.eventDataList,o=t.result,s=t.AVChatRoomMessageList;(s.length>0&&this._groupModule.onAVChatRoomMessage(s),n.length>0)&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(qn).onNewMessage({conversationOptionsList:n,isInstantMessage:!0}));o.length>0&&(this._groupModule.emitOuterEvent(k.MESSAGE_RECEIVED,o),this.handleMessageList(o))}},{key:\"newGroupTipsStoredAndSummary\",value:function(e){for(var n=this,o=e.event,s=e.dataList,a=null,i=[],r=[],u={},c=[],l=function(e,l){var d=It(s[e]);if(6===o){if(n._groupModule.isGroupAttributesUpdatedNotice(d))return\"continue\";if(n._groupModule.isGroupCountersNotice(d))return\"continue\"}var p=d.groupProfile,g=p.groupID,h=p.communityType,_=void 0===h?0:h,f=p.topicID,v=void 0===f?void 0:f,m=p.invisible,M=void 0,y=n._groupModule.isMessageFromTopic(_,v);if(y){M=E.CONV_TOPIC,d.to=v;var I=n._groupModule.getModule(Fn);I.hasLocalTopic(g,v)||n._getTopicPendingMap.has(v)||(n._getTopicPendingMap.set(v,1),I.getTopicList({groupID:g,topicIDList:[v]}).finally((function(){n._getTopicPendingMap.delete(v)})))}var C=n._groupModule.hasLocalGroup(g);if(!C&&n._groupModule.isUnjoinedAVChatRoom(g))return\"continue\";if(!C&&!y)return n._cacheGroupTipsAndProbe({groupID:g,event:o,item:d}),\"continue\";if(n._groupModule.isMessageFromOrToAVChatroom(g))return d.event=o,c.push(d),\"continue\";if(d.currentUser=n._groupModule.getMyUserID(),d.conversationType=E.CONV_GROUP,(a=new Wa(d)).setElement({type:E.MSG_GRP_TIP,content:t(t({},d.elements),{},{groupProfile:d.groupProfile})}),a.isSystemMessage=!1,1===m)return n._qualityStat(a),\"continue\";var T=n._groupModule.getModule(qn),D=a,k=D.conversationID,S=D.sequence;if(6===o)a._onlineOnlyFlag=!0,r.push(a);else if(!T.pushIntoNoticeResult(r,a))return\"continue\";if(n._groupModule.isMessageFromCommunityOfTopic(_,v))return\"continue\";if(6===o&&T.getLocalConversation(k))return\"continue\";6!==o&&n._qualityStat(a);var L=T.isRemoteRead({conversationID:k,sequence:S});if(it(u[k])){var A=0;\"in\"===a.flow&&(a._isExcludedFromUnreadCount||a._onlineOnlyFlag||L||(A=1)),u[k]=i.push({conversationID:k,unreadCount:A,type:it(M)?a.conversationType:M,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?\"\":a})-1}else{var R=u[k];i[R].type=a.conversationType,i[R].subType=a.conversationSubType,i[R].lastMessage=a._isExcludedFromLastMessage?\"\":a,\"in\"===a.flow&&(a._isExcludedFromUnreadCount||a._onlineOnlyFlag||L||i[R].unreadCount++)}},d=0,p=s.length;d<p;d++)l(d);return{eventDataList:i,result:r,AVChatRoomMessageList:c}}},{key:\"_qualityStat\",value:function(e){this._groupModule.getModule(eo).addMessageSequence({key:Ca,message:e})}},{key:\"handleMessageList\",value:function(e){var t=this;e.forEach((function(e){switch(e.payload.operationType){case 1:t._onNewMemberComeIn(e);break;case 2:t._onMemberQuit(e);break;case 3:t._onMemberKickedOut(e);break;case 4:t._onMemberSetAdmin(e);break;case 5:t._onMemberCancelledAdmin(e);break;case 6:t._onGroupProfileModified(e);break;case 7:t._onMemberInfoModified(e);break;case 8:t._onTopicProfileUpdated(e);break;default:Ve.w(\"\".concat(t._n,\".handleMessageList unknown operationType:\").concat(e.payload.operationType))}}))}},{key:\"_onNewMemberComeIn\",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,s=this._groupModule.getLocalGroupProfile(o);s&&et(n)&&s.memberCount!==n&&(s.memberCount=n,this._updateConversationGroupProfile(s))}},{key:\"_onMemberQuit\",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,s=this._groupModule.getLocalGroupProfile(o);s&&et(n)&&s.memberCount!==n&&(s.memberCount=n,this._updateConversationGroupProfile(s)),this._groupModule.getModule(wn).deleteLocalGroupMembers(o,e.payload.userIDList)}},{key:\"_onMemberKickedOut\",value:function(e){var t=e.payload,n=t.memberNum,o=t.groupProfile.groupID,s=this._groupModule.getLocalGroupProfile(o);s&&et(n)&&s.memberCount!==n&&(s.memberCount=n,this._updateConversationGroupProfile(s)),this._groupModule.getModule(wn).deleteLocalGroupMembers(o,e.payload.userIDList)}},{key:\"_updateConversationGroupProfile\",value:function(e){this._groupModule.getModule(qn).updateConversationGroupProfile([e])}},{key:\"_onMemberSetAdmin\",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,o=this._groupModule.getModule(wn);n.forEach((function(e){var n=o.getLocalGroupMemberInfo(t,e);n&&n.updateRole(E.GRP_MBR_ROLE_ADMIN)}))}},{key:\"_onMemberCancelledAdmin\",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,o=this._groupModule.getModule(wn);n.forEach((function(e){var n=o.getLocalGroupMemberInfo(t,e);n&&n.updateRole(E.GRP_MBR_ROLE_MEMBER)}))}},{key:\"_onGroupProfileModified\",value:function(e){var t=this,n=e.payload,o=n.newGroupProfile,s=n.groupProfile.groupID,a=this._groupModule.getLocalGroupProfile(s);Object.keys(o).forEach((function(e){switch(e){case\"ownerID\":t._ownerChanged(a,o);break;case\"groupName\":a.name=o[e];break;default:a[e]=o[e]}}));var i=!a.isSupportTopic;this._groupModule.emitGroupListUpdate(!0,i)}},{key:\"_ownerChanged\",value:function(e,t){var n=e.groupID,o=this._groupModule.getLocalGroupProfile(n),s=this._groupModule.getMyUserID();if(s===t.ownerID){o.updateGroup({selfInfo:{role:E.GRP_MBR_ROLE_OWNER}});var a=this._groupModule.getModule(wn),i=a.getLocalGroupMemberInfo(n,s),r=this._groupModule.getLocalGroupProfile(n).ownerID,u=a.getLocalGroupMemberInfo(n,r);i&&i.updateRole(E.GRP_MBR_ROLE_OWNER),u&&u.updateRole(E.GRP_MBR_ROLE_MEMBER)}}},{key:\"_onMemberInfoModified\",value:function(e){var t=e.to,n=e.payload,o=n.groupProfile,s=n.memberList,a=o.groupID;kt(t)&&this._updateTopicMuteTime(e);var i=this._groupModule.getModule(wn);s.forEach((function(e){var t=i.getLocalGroupMemberInfo(a,e.userID);t&&et(e.muteTime)&&t.updateMuteUntil(e.muteTime)}))}},{key:\"_updateTopicMuteTime\",value:function(e){var t=e.to,n=e.payload,o=n.groupProfile,s=n.memberList,a=void 0===s?[]:s,i=this._groupModule.getModule(Fn),r=o.groupID,u=i.getLocalTopic(r,t);if(u){for(var c=!1,l=0;l<a.length;l++){var d=a[l];if(d.userID===this._groupModule.getMyUserID()&&d.muteTime>=0){u.updateSelfInfo({muteTime:d.muteTime}),c=!0;break}}c&&this._groupModule.emitOuterEvent(k.TOPIC_UPDATED,{groupID:r,topic:u})}}},{key:\"_onTopicProfileUpdated\",value:function(e){var n=e.payload,o=n.groupProfile.groupID,s=n.newTopicInfo;this._groupModule.getModule(Fn).onTopicProfileUpdated(t({groupID:o,topicID:e.to},s))}},{key:\"_cacheGroupTips\",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:\"_deleteCachedGroupTips\",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:\"_notifyCachedGroupTips\",value:function(e){var t=this,n=this._cachedGroupTipsMap.get(e)||[];n.forEach((function(e){t.onNewGroupTips(e)})),this._deleteCachedGroupTips(e),Ve.l(\"\".concat(this._n,\"._notifyCachedGroupTips groupID:\").concat(e,\" count:\").concat(n.length))}},{key:\"_cacheGroupTipsAndProbe\",value:function(e){var t=this,n=e.groupID,o=e.event,s=e.item;this._cacheGroupTips(n,{event:o,dataList:[s]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===E.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupTips(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupTips(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Ve.l(\"\".concat(this._n,\"._cacheGroupTipsAndProbe groupID:\").concat(n))}},{key:\"reset\",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear()}}]),e}(),Ii=function(){function e(t){o(this,e),this._groupModule=t,this._n=\"CommonGroupHandler\",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map,this._isPagingGetCompleted=!1,t.getInnerEmitterInstance().once(ei,this._initGroupList,this)}return a(e,[{key:\"onCheckTimer\",value:function(e){e%1==0&&this._cachedGroupMessageMap.size>0&&this._checkCachedGroupMessage()}},{key:\"_checkCachedGroupMessage\",value:function(){var e=this;this._cachedGroupMessageMap.forEach((function(t,n){var o=e._checkCountMap.get(n),s=e._groupModule.hasLocalGroup(n);Ve.l(\"\".concat(e._n,\"._checkCachedGroupMessage groupID:\").concat(n,\" hasLocalGroup:\").concat(s,\" checkCount:\").concat(o)),s?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):(o++,e._checkCountMap.set(n,o))}))}},{key:\"_initGroupList\",value:function(){var e=this;Ve.l(\"\".concat(this._n,\"._initGroupList\"));var t=new Aa(\"getGroupListInStorage\"),n=this._groupModule.getStorageGroupList();if(at(n)&&n.length>0){n.forEach((function(t){e._groupModule.initGroupMap(t)})),this._groupModule.emitGroupListUpdate(!0,!1);var o=this._groupModule.getLocalGroupList().length;t.setNetworkType(this._groupModule.getNetworkType()).setMessage(\"group count:\".concat(o)).end()}else t.setNetworkType(this._groupModule.getNetworkType()).setMessage(\"group count:0\").end();Ve.l(\"\".concat(this._n,\"._initGroupList ok\"))}},{key:\"handleUpdateGroupLastMessage\",value:function(e){var n=\"\".concat(this._n,\".handleUpdateGroupLastMessage\");if(Ve.l(\"\".concat(n,\" conversation count:\").concat(e.length,\", local group count:\").concat(this._groupModule.getLocalGroupList().length)),0!==this._groupModule.getGroupMap().size){for(var o,s,a,i=!1,r=0,u=e.length;r<u;r++)(o=e[r]).type===E.CONV_GROUP&&(s=o.conversationID.split(/^GROUP/)[1],(a=this._groupModule.getLocalGroupProfile(s))&&(a.lastMessage=t({},o.lastMessage),i=!0));i&&(this._groupModule.sortLocalGroupList(),this._groupModule.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:\"onNewGroupMessage\",value:function(e){Ve.d(\"\".concat(this._n,\".onNewGroupMessage count:\").concat(e.dataList.length));var t=this._newGroupMessageStoredAndSummary(e),n=t.conversationOptionsList,o=t.messageList,s=t.AVChatRoomMessageList;(s.length>0&&this._groupModule.onAVChatRoomMessage(s),this._groupModule.filterModifiedMessage(o),n.length>0)&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(qn).onNewMessage({conversationOptionsList:n,isInstantMessage:e.isInstantMessage||!0,updateUnreadCount:e.updateUnreadCount||!0}));var a=this._groupModule.filterUnmodifiedMessage(o);a.length>0&&this._groupModule.emitOuterEvent(k.MESSAGE_RECEIVED,a),o.length=0}},{key:\"_newGroupMessageStoredAndSummary\",value:function(e){var t=this,n=e.dataList,o=e.event,s=e.isInstantMessage,a=null,i=[],r=[],u=[],c={},l=this._groupModule.getModule(Kn),d=this._groupModule.getFileDownloadProxy(),p=n.length;p>1&&n.sort((function(e,t){return e.sequence-t.sequence}));for(var g=function(e){var p=It(n[e]),g=p.groupProfile,h=g.groupID,_=g.communityType,f=void 0===_?0:_,v=g.topicID,m=void 0===v?void 0:v,M=g.invisible,y=void 0,I=t._groupModule.isMessageFromTopic(f,m);if(I){y=E.CONV_TOPIC,p.to=m;var C=t._groupModule.getModule(Fn);C.hasLocalTopic(h,m)||t._getTopicPendingMap.has(m)||(t._getTopicPendingMap.set(m,1),C.getTopicList({groupID:h,topicIDList:[m]}).finally((function(){t._getTopicPendingMap.delete(m)})))}var T=t._groupModule.hasLocalGroup(h);if(!T&&t._groupModule.isUnjoinedAVChatRoom(h))return\"continue\";if(!T&&!I)return t._cacheGroupMessageAndProbe({groupID:h,event:o,item:p}),\"continue\";if(t._groupModule.isMessageFromOrToAVChatroom(h))return p.event=o,u.push(p),\"continue\";if(p.currentUser=t._groupModule.getMyUserID(),p.conversationType=E.CONV_GROUP,p.isSystemMessage=!!p.isSystemMessage,a=new Wa(p),p.elements=l.parseElements(p.elements,p.from),a.setElement(p.elements,d),1===M)return t._qualityStat(s,a),\"continue\";var D=1===n[e].isModified,k=t._groupModule.getModule(qn);if(k.isMessageSentByCurrentInstance(a)?a.isModified=D:D=!1,1===p.onlineOnlyFlag)a._onlineOnlyFlag=!0,k.isMessageSentByCurrentInstance(a)||r.push(a);else{if(t._groupModule.isMessageFromCommunityOfTopic(f,m))return r.push(a),\"continue\";if(!k.pushIntoMessageList(r,a,D))return\"continue\";t._qualityStat(s,a);var S=a,L=S.conversationID,A=S.sequence,R=k.isRemoteRead({conversationID:L,sequence:A});if(it(c[L])){var N=0;\"in\"===a.flow&&(a._isExcludedFromUnreadCount||R||(N=1)),c[L]=i.push({conversationID:L,unreadCount:N,type:it(y)?a.conversationType:y,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?\"\":a})-1}else{var O=c[L];i[O].type=it(y)?a.conversationType:y,i[O].subType=a.conversationSubType,i[O].lastMessage=a._isExcludedFromLastMessage?\"\":a,\"in\"===a.flow&&(a._isExcludedFromUnreadCount||R||i[O].unreadCount++)}}},h=0;h<p;h++)g(h);return{conversationOptionsList:i,messageList:r,AVChatRoomMessageList:u}}},{key:\"_qualityStat\",value:function(e,t){var n=this._groupModule.getModule(eo);n.addMessageSequence({key:Ca,message:t}),e&&t.clientTime>0&&n.addMessageDelay(t.clientTime)}},{key:\"onGroupMessageRevoked\",value:function(e){var t=this._groupModule.getModule(qn),n=[],o=null,s=!0;e.dataList.forEach((function(e){var a=e.elements.revokedInfos;it(a)||a.forEach((function(e){var a=zt(e.topicID)?\"GROUP\".concat(e.groupID):\"GROUP\".concat(e.topicID);o=t.revoke(a,e.sequence,e.random);var i=e.revokerInfo&&e.revokerInfo.revoker;if(o)o.revoker=i,n.push(o);else{var r={conversationID:a,to:e.topicID||\"\",sequence:e.sequence,time:e.time,revoker:i};t.isLastMessageRevoked(r)&&(n.push(r),s=!1)}}))})),0!==n.length&&(t.onMessageRevoked(n),!0===s&&(Ve.l(\"\".concat(this._n,\".onGroupMessageRevoked count:\").concat(n.length)),this._groupModule.emitOuterEvent(k.MESSAGE_REVOKED,n)))}},{key:\"_groupListTreeShaking\",value:function(e){for(var t=new Map(m(this._groupModule.getGroupMap())),n=0,o=e.length;n<o;n++)t.delete(e[n].groupID);this._groupModule.hasJoinedAVChatRoom()&&this._groupModule.getJoinedAVChatRoom().forEach((function(e){t.delete(e)}));this._groupModule.getGroupMap().forEach((function(e,n){e.isSupportTopic&&t.delete(n)}));for(var s=m(t.keys()),a=0,i=s.length;a<i;a++)this._groupModule.deleteGroup(s[a])}},{key:\"getGroupList\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"getGroupList\"),o=new Aa(\"getGroupList\");Ve.l(\"\".concat(n));var s={introduction:\"Introduction\",notification:\"Notification\",createTime:\"CreateTime\",ownerID:\"Owner_Account\",lastInfoTime:\"LastInfoTime\",memberNum:\"MemberNum\",maxMemberNum:\"MaxMemberNum\",joinOption:\"ApplyJoinOption\",inviteOption:\"InviteJoinOption\",muteAllMembers:\"ShutUpAllMember\"},a=[\"Type\",\"Name\",\"FaceUrl\",\"NextMsgSeq\",\"LastMsgTime\",\"AtInfoList\",\"LastRecallTime\"],i=[];e&&e.groupProfileFilter&&e.groupProfileFilter.forEach((function(e){s[e]&&a.push(s[e])}));var r=(e||{}).isGroupWithTopicOnly,u=void 0!==r&&r;return this._pagingGetGroupList({limit:50,offset:0,groupBaseInfoFilter:a,groupList:i,isGroupWithTopicOnly:u}).then((function(){Ve.l(\"\".concat(n,\" ok. count:\").concat(i.length,\" isGroupWithTopicOnly:\").concat(u)),u||t._groupListTreeShaking(i),t._groupModule.updateGroupMap(i);var e=t._groupModule.getLocalGroupList().length;o.setNetworkType(t._groupModule.getNetworkType()).setMessage(\"remote count:\".concat(i.length,\", after tree shaking, local count:\").concat(e,\", isGroupWithTopicOnly:\").concat(u)).end(),t.tempConversationList&&(t.handleUpdateGroupLastMessage(t.tempConversationList),t.tempConversationList=null),t._groupModule.patchGroupMessageRemindType(),t._groupModule.recomputeUnreadCount(),t._groupModule.emitGroupListUpdate(!0,!u);var s=t._groupModule.getLocalGroupList();if(u){var a=s.filter((function(e){return!0===e.isSupportTopic}));return Ya({groupList:a})}return t._isPagingGetCompleted=!0,Ya({groupList:s})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"isPagingGetCompleted\",value:function(){return this._isPagingGetCompleted}},{key:\"_pagingGetGroupList\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"_pagingGetGroupList\"),o=e.isCommunityRelay,s=void 0!==o&&o,a=e.isGroupWithTopicOnly,i=void 0!==a&&a,r=e.limit,u=e.offset,c=e.groupBaseInfoFilter,l=e.groupList;if(i)return this._pagingGetGroupListWithTopic({limit:r,offset:u,groupBaseInfoFilter:c,groupList:l});var d=new Aa(\"_pagingGetGroupList\");return this._groupModule.request({protocolName:jo,requestData:{type:s?E.GRP_COMMUNITY:void 0,memberAccount:this._groupModule.getMyUserID(),limit:r,offset:u,responseFilter:{groupBaseInfoFilter:c,selfInfoFilter:[\"Role\",\"JoinTime\",\"MsgFlag\",\"MsgSeq\"]}}}).then((function(e){var o=e.data,a=o.groups,i=void 0===a?[]:a,p=o.totalCount;l.push.apply(l,m(i)),t._handleGroupAtInfoWithoutTopic(s,i);var g=u+r,h=!(p>g),_=\"offset:\".concat(u,\" totalCount:\").concat(p,\" isCompleted:\").concat(h,\" \")+\"currentCount:\".concat(l.length,\" isCommunityRelay:\").concat(s);return d.setNetworkType(t._groupModule.getNetworkType()).setMessage(\"\".concat(_)).end(),s||h?!s&&h?(Ve.l(\"\".concat(n,\" start to get community list\")),u=0,t._pagingGetGroupList({limit:r,offset:u,groupBaseInfoFilter:c,groupList:l,isCommunityRelay:!0})):s&&!h?(u=g,t._pagingGetGroupList({limit:r,offset:u,groupBaseInfoFilter:c,groupList:l,isCommunityRelay:!0})):(Ve.l(\"\".concat(n,\" ok. totalCount:\").concat(l.length)),Ya({groupList:l})):(u=g,t._pagingGetGroupList({limit:r,offset:u,groupBaseInfoFilter:c,groupList:l}))})).catch((function(e){return 11e3!==e.code&&t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];d.setMessage(\"isCommunityRelay:\".concat(s)).setError(e,o,a).end()})),s?(11e3===e.code&&(d=null,Ve.l(\"\".concat(n,\" ok. community unavailable\"))),Xa({groupList:l})):Za(e)}))}},{key:\"_pagingGetGroupListWithTopic\",value:function(e){var t=this,n=\"\".concat(this._n,\"._pagingGetGroupListWithTopic\"),o=e.limit,s=e.offset,a=e.groupBaseInfoFilter,i=e.groupList,r=new Aa(\"pagingGetGroupListWithTopic\");return this._groupModule.request({protocolName:jo,requestData:{type:E.GRP_COMMUNITY,memberAccount:this._groupModule.getMyUserID(),limit:o,offset:s,responseFilter:{groupBaseInfoFilter:a,selfInfoFilter:[\"Role\",\"JoinTime\",\"MsgFlag\",\"MsgSeq\"]},isSupportTopic:1}}).then((function(e){var u=e.data,c=u.groups,l=void 0===c?[]:c,d=u.totalCount;i.push.apply(i,m(l));var p=s+o,g=!(d>p),h=\"offset:\".concat(s,\" totalCount:\").concat(d,\" isCompleted:\").concat(g,\" \")+\"currentCount:\".concat(i.length);return r.setNetworkType(t._groupModule.getNetworkType()).setMessage(\"\".concat(h)).end(),g?(Ve.l(\"\".concat(n,\" ok. totalCount:\").concat(i.length)),Ya({groupList:i})):(s=p,t._pagingGetGroupListWithTopic({limit:o,offset:s,groupBaseInfoFilter:a,groupList:i}))})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];r.setError(e,o,s).end()})),Za(e)}))}},{key:\"_cacheGroupMessage\",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:\"_deleteCachedGroupMessage\",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:\"_notifyCachedGroupMessage\",value:function(e){var t=this,n=this._cachedGroupMessageMap.get(e)||[];n.forEach((function(e){t.onNewGroupMessage(e)})),this._deleteCachedGroupMessage(e),Ve.l(\"\".concat(this._n,\"._notifyCachedGroupMessage groupID:\").concat(e,\" count:\").concat(n.length))}},{key:\"_cacheGroupMessageAndProbe\",value:function(e){var t=this,n=e.groupID,o=e.event,s=e.item;this._cacheGroupMessage(n,{event:o,dataList:[s]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===E.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupMessage(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupMessage(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Ve.l(\"\".concat(this._n,\"._cacheGroupMessageAndProbe groupID:\").concat(n))}},{key:\"_handleGroupAtInfoWithoutTopic\",value:function(e,n){var o=this;e&&0!==n.length&&n.forEach((function(e){var n=e.groupID,s=e.groupAtInfoList,a=[];it(s)||(s.forEach((function(e){a.push(t(t({},e),{},{groupID:n}))})),o._groupModule.getModule(qn).onNewGroupAtTips({dataList:a}))}))}},{key:\"reset\",value:function(){this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear(),this._isPagingGetCompleted=!1,this._groupModule.getInnerEmitterInstance().once(ei,this._initGroupList,this)}}]),e}(),Ci=1,Ti=2,Di=3,ki=4,Ei=5,Si=function(){function e(t){o(this,e),this._groupModule=t,this._n=\"GroupAttributesHandler\",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(ti,this._onCloudConfigUpdated,this)}return a(e,[{key:\"_onCloudConfigUpdated\",value:function(){var e=this._groupModule.getCloudConfig(\"grp_attr_cache_time\");it(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:\"updateLocalMainSequenceOnReconnected\",value:function(){this._groupAttributesMap.forEach((function(e){e.localMainSequence=0}))}},{key:\"isGroupAttributesUpdatedNotice\",value:function(e){var t=e.to,n=e.elements.newGroupProfile,o=!it(n)&&!zt(n.groupAttributeOption);return o&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:n.groupAttributeOption}),o}},{key:\"_onGroupAttributesUpdated\",value:function(e){var t=this,n=e.groupID,o=e.groupAttributeOption,s=o.mainSequence,a=o.isWithChangedAttributeInfo,i=o.groupAttributeList,r=void 0===i?[]:i,u=o.operationType;if(Ve.l(\"\".concat(this._n,\".onGroupAttributesUpdated. \")+\"groupID:\".concat(n,\" isWithChangedAttributeInfo:\").concat(a,\" operationType:\").concat(u)),!it(u)){this._groupAttributesCopy=this._getCachedAttributes({groupID:n});var c=s-this._getLocalGroupAttributes(n).localMainSequence;if(0!==c){if(1===a&&1===c)return this._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:s,groupAttributeList:r,operationType:u}),void this._emitGroupAttributesUpdated(n);if(this._hasLocalGroupAttributes(n)){var l=this._getLocalGroupAttributes(n).avChatRoomKey;this._getGroupAttributes({groupID:n,avChatRoomKey:l}).then((function(){t._emitGroupAttributesUpdated(n)}))}}}}},{key:\"initGroupAttributesCache\",value:function(e){var t=e.groupID,n=e.avChatRoomKey,o=void 0===n?void 0:n;this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:o}),Ve.l(\"\".concat(this._n,\".initGroupAttributesCache groupID:\").concat(t,\" avChatRoomKey:\").concat(o))}},{key:\"initGroupAttributes\",value:function(e){var t=this,n=e.groupID,o=e.groupAttributes,s=this._getLocalGroupAttributes(n),a=s.remoteMainSequence,i=s.avChatRoomKey,r=new Aa(\"initGroupAttributes\");return r.setMessage(\"groupID:\".concat(n,\" avChatRoomKey:\").concat(i,\" mainSequence:\").concat(a)),this._groupModule.request({protocolName:Is,requestData:{groupID:n,avChatRoomKey:i,mainSequence:a,groupAttributeList:this._transformGroupAttributes(o)}}).then((function(e){Ve.l(\"\".concat(t._n,\".\").concat(\"initGroupAttributes\",\" ok. groupID:\").concat(n));var s=e.data,a=s.mainSequence,i=m(s.groupAttributeList);return i.forEach((function(e){e.value=o[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:a,groupAttributeList:i,operationType:Ci}),t._emitGroupAttributesUpdated(n),r.setNetworkType(t._groupModule.getNetworkType()).end(),Ya({groupAttributes:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];r.setError(e,o,s).end()})),Za(e)}))}},{key:\"setGroupAttributes\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"setGroupAttributes\"),o=e.groupID,s=e.groupAttributes,a=this._getLocalGroupAttributes(o),i=a.remoteMainSequence,r=a.avChatRoomKey,u=a.attributes,c=this._transformGroupAttributes(s);c.forEach((function(e){var t=e.key;e.sequence=0,u.has(t)&&(e.sequence=u.get(t).sequence)}));var l=new Aa(\"setGroupAttributes\");return l.setMessage(\"groupID:\".concat(o,\" groupAttributes:\").concat(JSON.stringify(s))),Ve.l(\"\".concat(n,\". groupID:\").concat(o,\" mainSequence:\").concat(i)),this._groupModule.request({protocolName:Cs,requestData:{groupID:o,avChatRoomKey:r,mainSequence:i,groupAttributeList:c}}).then((function(e){Ve.l(\"\".concat(n,\" ok.\"));var a=e.data,i=a.mainSequence,r=m(a.groupAttributeList);return r.forEach((function(e){e.value=s[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:o}),t._refreshCachedGroupAttributes({groupID:o,remoteMainSequence:i,groupAttributeList:r,operationType:Ti}),t._emitGroupAttributesUpdated(o),l.setNetworkType(t._groupModule.getNetworkType()).end(),Ya({groupAttributes:s})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];l.setError(e,o,s).end()})),Za(e)}))}},{key:\"deleteGroupAttributes\",value:function(e){var t=this,n=e.groupID,o=e.keyList,s=void 0===o?[]:o,a=this._getLocalGroupAttributes(n),i=a.remoteMainSequence,r=a.avChatRoomKey,u=a.attributes,c=m(u.keys()),l=Ds,d=Di,p={groupID:n,avChatRoomKey:r,mainSequence:i},g=[];s.length>0&&(c=[],l=Ts,d=ki,s.forEach((function(e){var t=0;u.has(e)&&(t=u.get(e).sequence,c.push(e)),g.push({key:e,sequence:t})})),p.groupAttributeList=g);var h=new Aa(\"deleteGroupAttributes\");return h.setMessage(\"groupID:\".concat(n,\" mainSequence:\").concat(i,\" keyList:\").concat(s,\" protocolName:\").concat(l)),this._groupModule.request({protocolName:l,requestData:p}).then((function(e){Ve.l(\"\".concat(t._n,\".\").concat(\"deleteGroupAttributes\",\" ok. groupID:\").concat(n));var o=e.data.mainSequence;return t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:o,groupAttributeList:g,operationType:d}),t._emitGroupAttributesUpdated(n),h.setNetworkType(t._groupModule.getNetworkType()).end(),Ya({keyList:c})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];h.setError(e,o,s).end()})),Za(e)}))}},{key:\"getGroupAttributes\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"getGroupAttributes\"),o=e.groupID,s=this._getLocalGroupAttributes(o),a=s.avChatRoomKey,i=s.lastUpdateTime,r=s.localMainSequence,u=s.remoteMainSequence,c=new Aa(\"getGroupAttributes\");if(c.setMessage(\"groupID:\".concat(o,\" localMainSequence:\").concat(r,\" remoteMainSequence:\").concat(u,\" keyList:\").concat(e.keyList)),Date.now()-i>=this.CACHE_EXPIRE_TIME||r<u)return this._getGroupAttributes({groupID:o,avChatRoomKey:a}).then((function(s){c.setMoreMessage(\"get attributes from remote. count:\".concat(s.length)).setNetworkType(t._groupModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" from remote. groupID:\").concat(o));var a=t._getCachedAttributes(e);return Ya({groupAttributes:a})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];c.setError(e,o,s).end()})),Za(e)}));c.setMoreMessage(\"get attributes from cache\").setNetworkType(this._groupModule.getNetworkType()).end(),Ve.l(\"\".concat(n,\" from cache. groupID:\").concat(o));var l=this._getCachedAttributes(e);return Xa({groupAttributes:l})}},{key:\"_getGroupAttributes\",value:function(e){var n=this,o=0;return it(e.avChatRoomKey)||(o=1),this._groupModule.request({protocolName:ks,requestData:t(t({},e),{},{groupType:o})}).then((function(t){Ve.l(\"\".concat(n._n,\"._getGroupAttributes ok. groupID:\").concat(e.groupID));var o=t.data,s=o.mainSequence,a=o.groupAttributeList,i=m(a);return it(s)||n._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:s,groupAttributeList:i,operationType:Ei}),a})).catch((function(e){return Za(e)}))}},{key:\"_refreshCachedGroupAttributes\",value:function(e){var t=e.groupID,n=e.remoteMainSequence,o=e.groupAttributeList,s=e.operationType;if(this._hasLocalGroupAttributes(t)){var a=this._getLocalGroupAttributes(t),i=a.localMainSequence;if(s===Ei||n-i==1)a.remoteMainSequence=n,a.localMainSequence=n,a.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:a,groupAttributeList:o,operationType:s});else{if(i===n)return;a.remoteMainSequence=n}this._groupAttributesMap.set(t,a);var r=\"operationType:\".concat(s,\" localMainSequence:\").concat(i,\" remoteMainSequence:\").concat(n);Ve.l(\"\".concat(this._n,\"._refreshCachedGroupAttributes. \").concat(r))}}},{key:\"_getCachedAttributes\",value:function(e){var t=e.groupID,n=e.keyList,o=void 0===n?[]:n,s={};if(this._hasLocalGroupAttributes(t)){var a=this._getLocalGroupAttributes(t).attributes;if(o.length>0)o.forEach((function(e){a.has(e)&&(s[e]=a.get(e).value)}));else{var i,r=D(a.keys());try{for(r.s();!(i=r.n()).done;){var u=i.value;s[u]=a.get(u).value}}catch(c){r.e(c)}finally{r.f()}}}return s}},{key:\"_updateCachedAttributes\",value:function(e){var t=e.groupAttributes,n=e.groupAttributeList,o=e.operationType;o!==Di?o!==ki?(o===Ci&&t.attributes.clear(),n.forEach((function(e){var n=e.key,o=e.value,s=e.sequence;t.attributes.set(n,{value:o,sequence:s})}))):n.forEach((function(e){t.attributes.delete(e.key)})):t.attributes.clear()}},{key:\"_hasLocalGroupAttributes\",value:function(e){return this._groupAttributesMap.has(e)}},{key:\"_getLocalGroupAttributes\",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:\"_transformGroupAttributes\",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:\"_emitGroupAttributesUpdated\",value:function(e){var t=this._getCachedAttributes({groupID:e}),n=this._computeAttrChangedInfo(t),o=n.updatedKeyList,s=n.deletedKeyList;Ve.l(\"\".concat(this._n,\"._emitGroupAttributesUpdated update:\").concat(o.length,\", delete:\").concat(s.length)),0===o.length&&0===s.length||this._groupModule.emitOuterEvent(k.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t,updatedKeyList:o,deletedKeyList:s})}},{key:\"_computeAttrChangedInfo\",value:function(e){var t=this,n=[],o=[];return Object.keys(e).forEach((function(o){e[o]!==t._groupAttributesCopy[o]&&n.push(o)})),Object.keys(this._groupAttributesCopy).forEach((function(t){it(e[t])&&o.push(t)})),this._groupAttributesCopy={},{updatedKeyList:n,deletedKeyList:o}}},{key:\"deleteLocalGroupAttributes\",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:\"reset\",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),e}(),Li=\"Set\",Ai=\"Increase\",Ri=\"Decrease\",Ni=function(){function e(t){o(this,e),this._groupModule=t,this._n=\"GroupCountersHandler\",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(ti,this._onCloudConfigUpdated,this)}return a(e,[{key:\"_onCloudConfigUpdated\",value:function(){var e=this._groupModule.getCloudConfig(\"grp_counter_expire_time\");it(e)||(this.EXPIRE_TIME=Number(e))}},{key:\"isGroupCountersNotice\",value:function(e){var t=e.to,n=e.elements.groupCounterInfo,o=!1;return zt(n)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:n}),o=!0),o}},{key:\"_onGroupCountersUpdated\",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach((function(e){var o=e.type,s=e.groupCounterSeq,a=e.counterList,i=void 0===a?[]:a;0!==o&&2!==o||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:s,counterList:i}),i.forEach((function(e){t._groupModule.emitOuterEvent(k.GROUP_COUNTER_UPDATED,{groupID:n,key:e.key,value:e.value})}))),1===o&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:s,counterList:i})})),Ve.l(\"\".concat(this._n,\"._onGroupCountersUpdated groupID:\").concat(n))}},{key:\"initGroupCountersCache\",value:function(e){var t=e.groupID,n=e.avChatRoomKey;this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:n}),Ve.l(\"\".concat(this._n,\".initGroupCountersCache groupID:\").concat(t,\" avChatRoomKey:\").concat(n))}},{key:\"setGroupCounters\",value:function(e){var t=this;if(!this._groupModule.canIUse(B.GRP_COUNTER))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".setGroupCounters\"),o=e.groupID,s=e.counters,a=this._convertObjectToList(s),i=this._getLocalGroupCounters(o).avChatRoomKey,r=\"groupID:\".concat(o,\" count:\").concat(a.length),u=new Aa(\"setGroupCounters\");return u.setMessage(\"\".concat(r)),Ve.l(\"\".concat(n,\". \").concat(r)),this._updateGroupCounters({groupID:o,counterList:a,avChatRoomKey:i,mode:Li}).then((function(e){return u.end(),Ve.l(\"\".concat(n,\" ok.\")),Ya({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"increaseGroupCounter\",value:function(e){var t=this;if(!this._groupModule.canIUse(B.GRP_COUNTER))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".increaseGroupCounters\"),o=e.groupID,s=e.key,a=e.value,i=this._getLocalGroupCounters(o).avChatRoomKey,r=\"groupID:\".concat(o,\" key:\").concat(s,\" value:\").concat(a),u=new Aa(\"increaseGroupCounter\");u.setMessage(\"\".concat(r)),Ve.l(\"\".concat(n,\". \").concat(r));var c=[{key:s,value:a}];return this._updateGroupCounters({groupID:o,counterList:c,avChatRoomKey:i,mode:Ai}).then((function(e){return u.end(),Ve.l(\"\".concat(n,\" ok.\")),Ya({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"decreaseGroupCounter\",value:function(e){var t=this;if(!this._groupModule.canIUse(B.GRP_COUNTER))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".decreaseGroupCounter\"),o=e.groupID,s=e.key,a=e.value,i=this._getLocalGroupCounters(o).avChatRoomKey,r=\"groupID:\".concat(o,\" key:\").concat(s,\" value:\").concat(a),u=new Aa(\"decreaseGroupCounter\");u.setMessage(\"\".concat(r)),Ve.l(\"\".concat(n,\". \").concat(r));var c=[{key:s,value:a}];return this._updateGroupCounters({groupID:o,counterList:c,avChatRoomKey:i,mode:Ri}).then((function(e){return u.end(),Ve.l(\"\".concat(n,\" ok.\")),Ya({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"getGroupCounters\",value:function(e){var t=this;if(!this._groupModule.canIUse(B.GRP_COUNTER))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".getGroupCounters\"),o=e.groupID,s=e.keyList,a=void 0===s?[]:s,i=this._getLocalGroupCounters(o),r=i.avChatRoomKey,u=i.lastUpdateTime,c=new Aa(\"getGroupCounters\");if(c.setMessage(\"groupID:\".concat(o)),Date.now()-u>=this.EXPIRE_TIME)return this._getRemoteGroupCounters({groupID:o,avChatRoomKey:r}).then((function(e){c.setMoreMessage(\"from remote. count:\".concat(e.length)).end(),Ve.l(\"\".concat(n,\" from remote. groupID:\").concat(o));var s=t._getLocalCounters(o,a);return Ya({counters:s})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];c.setError(e,o,s).end()})),Za(e)}));c.setMoreMessage(\"from cache\").end(),Ve.l(\"\".concat(n,\" from cache. groupID:\").concat(o));var l=this._getLocalCounters(o,a);return Xa({counters:l})}},{key:\"_getRemoteGroupCounters\",value:function(e){var n=this;return this._groupModule.request({protocolName:Rs,requestData:t({},e)}).then((function(t){var o=t.data,s=o.counterList,a=void 0===s?[]:s,i=o.groupCounterSeq;return n._updateLocalGroupCounters({groupID:e.groupID,counterList:a,groupCounterSeq:i}),Ve.l(\"\".concat(n._n,\"._getRemoteGroupCounters ok. groupID:\").concat(e.groupID)),a})).catch((function(e){return Za(e)}))}},{key:\"_convertObjectToList\",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:\"_updateGroupCounters\",value:function(e){var n=\"\".concat(this._n,\"._updateGroupCounters\"),o=e.groupID,s=e.avChatRoomKey,a=e.mode;return Ve.l(\"\".concat(n,\". groupID:\").concat(o,\" avChatRoomKey:\").concat(s,\" mode:\").concat(a)),this._groupModule.request({protocolName:As,requestData:t({},e)}).then((function(e){Ve.l(\"\".concat(n,\" ok.\"));var t=e.data.counterList,o={};return(void 0===t?[]:t).forEach((function(e){var t=e.key,n=e.value;o[t]=n})),o})).catch((function(e){return Za(e)}))}},{key:\"_hasLocalGroupCounters\",value:function(e){return this._groupCountersMap.has(e)}},{key:\"_getLocalGroupCounters\",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:\"_updateLocalGroupCounters\",value:function(e){var t=e.groupID,n=e.counterList,o=void 0===n?[]:n,s=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var a=this._getLocalGroupCounters(t),i=a.counters,r=a.avChatRoomKey,u=a.groupCounterSeq;if(s>0&&s<u)return;o.forEach((function(e){var t=e.key,n=e.value;i.set(t,n)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:s,counters:i,avChatRoomKey:r})}}},{key:\"_deleteLocalGroupCounters\",value:function(e){var t=e.groupID,n=e.counterList,o=void 0===n?[]:n,s=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var a=this._getLocalGroupCounters(t),i=a.counters,r=a.avChatRoomKey;o.forEach((function(e){i.delete(e.key)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:s,counters:i,avChatRoomKey:r})}}},{key:\"_getLocalCounters\",value:function(e,t){var n={};if(!this._hasLocalGroupCounters(e))return n;var o=this._getLocalGroupCounters(e).counters;if(t.length>0)t.forEach((function(e){o.has(e)&&(n[e]=o.get(e))}));else{var s,a=D(o.keys());try{for(a.s();!(s=a.n()).done;){var i=s.value;n[i]=o.get(i)}}catch(r){a.e(r)}finally{a.f()}}return n}},{key:\"reset\",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),e}(),Oi=function(){function e(t){o(this,e);var n=t.manager,s=t.groupID,a=t.onInit,i=t.onSuccess,r=t.onFail;this._n=\"Polling\",this._manager=n,this._groupModule=n._groupModule,this._onInit=a,this._onSuccess=i,this._onFail=r,this._groupID=s,this._timeoutID=-1,this._isRunning=!1,this._protocolName=fs}return a(e,[{key:\"start\",value:function(){var e=this._groupModule.isLoggedIn();e||(this._protocolName=vs),Ve.l(\"\".concat(this._n,\".start pollingInterval:\").concat(this._manager.getPollingInterval(),\" isLoggedIn:\").concat(e)),this._isRunning=!0,this._request()}},{key:\"isRunning\",value:function(){return this._isRunning}},{key:\"_request\",value:function(){var e=this,t=this._onInit(this._groupID);this._groupModule.request({protocolName:this._protocolName,requestData:t}).then((function(t){e._onSuccess(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))})).catch((function(t){e._onFail(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))}))}},{key:\"stop\",value:function(){Ve.l(\"\".concat(this._n,\".stop\")),this._timeoutID>0&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:\"getPollingTimerID\",value:function(){return this._timeoutID}}]),e}(),Gi={3:!0,4:!0,5:!0,6:!0,17:!0},Ui=function(){function e(t){o(this,e),this._groupModule=t,this._n=\"AVChatRoomHandler\",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this.sequencesLinkedList=new pi(200),this.messageIDLinkedList=new pi(100),this.receivedMessageCount=0,this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0}return a(e,[{key:\"hasJoinedAVChatRoom\",value:function(){return this._joinedGroupMap.size>0}},{key:\"checkJoinedAVChatRoomByID\",value:function(e){return this._joinedGroupMap.has(e)}},{key:\"getJoinedAVChatRoom\",value:function(){return this._joinedGroupMap.size>0?m(this._joinedGroupMap.keys()):null}},{key:\"_updateRequestData\",value:function(e){var n=this._pollingRequestInfoMap.get(e);return e===m(this._pollingInstanceMap.keys())[0]?t(t({},n),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):t(t({},n),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:\"_handleSuccess\",value:function(e,t){var n=t.data,o=n.key,s=n.nextSeq,a=n.rspMsgList,i=n.errorCode,r=n.nextBroadcastSeq,u=n.broadcastMessageList;if(0!==i){var c=this._pollingRequestInfoMap.get(e),l=new Aa(\"longPollingAVError\"),d=c?\"\".concat(c.key,\"-\").concat(c.startSeq):\"requestInfo is undefined\";l.setMessage(\"\".concat(e,\"-\").concat(d,\"-\").concat(t.errorInfo)).setCode(t.errorCode).setNetworkType(this._groupModule.getNetworkType()).end(!0)}else{if(!this.checkJoinedAVChatRoomByID(e))return;nt(o)&&et(s)&&this._pollingRequestInfoMap.set(e,{key:o,startSeq:s}),et(r)&&r>this._startBroadcastSeq&&(this._startBroadcastSeq=r),at(a)&&a.length>0?(a.forEach((function(e){e.to=e.groupID})),this.onMessage(a)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(u)}}},{key:\"_handleFailure\",value:function(e,t){}},{key:\"onMessage\",value:function(e){if(at(e)&&0!==e.length){0!==this._pollingNoMessageCount&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL);var t=null,n=[],o=this._getModule(qn),s=this._getModule(eo),a=e.length;a>1&&e.sort((function(e,t){return e.sequence-t.sequence}));for(var i=this._getModule(xn),r=0;r<a;r++){var u=this.restoreMessageFromSimplified(e[r]);if(Gi[u.event]){if(6===u.event){if(this._groupModule.isGroupAttributesUpdatedNotice(u))continue;if(this._groupModule.isGroupCountersNotice(u))continue}this.receivedMessageCount+=1,t=this.packMessage(u,u.event);var c=1===u.isModified,l=1===u.isHistoryMessage;if((i.isUnlimitedAVChatRoom()||!this.sequencesLinkedList.has(t.sequence))&&!this.messageIDLinkedList.has(t.ID)){var d=t.conversationID;if(this.receivedMessageCount%50==0?this._getModule(Xn).detectFirstRound(d,this.sequencesLinkedList.data()):this.receivedMessageCount%80==0&&this._getModule(Xn).detectSecondRound(d,this.sequencesLinkedList.data()),null!==this.sequencesLinkedList.tail()){var p=this.sequencesLinkedList.tail().value,g=t.sequence-p;g>1&&g<=20?this._getModule(Xn).onMessageMaybeLost(d,p+1,g-1):g<-1&&g>=-20&&this._getModule(Xn).onMessageMaybeLost(d,t.sequence+1,Math.abs(g)-1)}this.sequencesLinkedList.set(t.sequence),this.messageIDLinkedList.set(t.ID);var h=!1;if(this._isMessageSentByCurrentInstance(t)?c&&(h=!0,t.isModified=c,o.updateMessageIsModifiedProperty(t)):h=!0,h){if(t.conversationType===E.CONV_SYSTEM&&5===t.payload.operationType&&this._onGroupDismissed(t.payload.groupProfile.groupID),!l&&t.conversationType!==E.CONV_SYSTEM){var _=t.conversationID.replace(E.CONV_GROUP,\"\");this._pollingInstanceMap.has(_)?this._groupModule.isLoggedIn()&&s.addMessageSequence({key:Da,message:t}):(t.type!==E.MSG_GRP_TIP&&t.clientTime>0&&s.addMessageDelay(t.clientTime),s.addMessageSequence({key:Ta,message:t}))}n.push(t)}}}else Ve.w(\"\".concat(this._n,\".onMessage unknown event:\").concat(u.event))}if(0!==n.length){this._groupModule.filterModifiedMessage(n);var f=this.packConversationOption(n);if(f.length>0)this._getModule(qn).onNewMessage({conversationOptionsList:f,isInstantMessage:!0});Ve.d(\"\".concat(this._n,\".onMessage count:\").concat(n.length)),this._checkMessageStacked(n);var v=this._groupModule.filterUnmodifiedMessage(n);v.length>0&&this._groupModule.emitOuterEvent(k.MESSAGE_RECEIVED,v),n.length=0}}}},{key:\"isBroadcastOrNormal\",value:function(e){return 3===e||17===e}},{key:\"isGroupTip\",value:function(e){return 4===e||6===e}},{key:\"isGroupSystemNotice\",value:function(e){return 5===e}},{key:\"restoreGroupTipElements\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.groupJoinType||(e.groupJoinType=1);var t=e.operatorInfo,n=void 0===t?{}:t,o=e.operatorID,s=e.userIDList,a=void 0===s?[]:s,i=n.userID,r=void 0===i?o:i,u=n.avatar,c=void 0===u?\"\":u,l=n.nick,d=void 0===l?\"\":l;e.operatorInfo={userID:r,avatar:c,nick:d};var p=a.map((function(e){return{userID:e}}));return e.memberInfoList=e.memberInfoList||p,e}},{key:\"restoreMessageFromSimplified\",value:function(e){var n=e.event;if(this.isBroadcastOrNormal(n)&&(e.cloudCustomData=e.cloudCustomData||\"\",e.elements=e.elements.map((function(e){if(e.type===E.MSG_CUSTOM){var n=e.content,o=void 0===n?{}:n;e.content=t({data:\"\",description:\"\",extension:\"\"},o)}return e}))),(this.isGroupTip(n)||this.isGroupSystemNotice(n))&&(e.from=e.from||\"@TIM#SYSTEM\"),this.isGroupTip(n)){e.elements=this.restoreGroupTipElements(e.elements);var o=e.elements,s=void 0===o?{}:o,a=s.operationType,r=s.operatorInfo;if(1===a){var u=[{userID:(void 0===r?{}:r).userID}];s.memberInfoList=s.memberInfoList||u}}if(this.isGroupSystemNotice(n)){var c=e.elements,l=c.memberInfoList,d=c.operatorInfo;l||(l=void 0===d?{}:d),e.elements.memberInfoList=t({userID:e.elements.operatorID,avatar:\"\",nick:\"\"},l),e.elements=t({authentication:\"\",remarkInfo:\"\",messageKey:1e3*e.time},e.elements);var p=Object.keys(e.elements).filter((function(e){return\"operatorInfo\"!==e})).reduce((function(n,o){return t(t({},n),{},i({},o,e.elements[o]))}),{});e.elements=p}return e}},{key:\"_onGroupDismissed\",value:function(e){Ve.l(\"\".concat(this._n,\"._onGroupDismissed groupID:\").concat(e)),this._groupModule.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:\"_checkMessageStacked\",value:function(e){var t=\"MessageStacked\",n=e.length;n>=100&&(this._groupModule.outputWarning(t,n),this._reportMessageStackedCount<5&&(new Aa(t).setNetworkType(this._groupModule.getNetworkType()).setMessage(\"count:\".concat(n,\" groupID:\").concat(m(this._joinedGroupMap.keys()))).setLevel(\"warning\").end(),this._reportMessageStackedCount+=1))}},{key:\"_isMessageSentByCurrentInstance\",value:function(e){return!!this._getModule(qn).isMessageSentByCurrentInstance(e)}},{key:\"packMessage\",value:function(e,t){e.currentUser=this._groupModule.getMyUserID(),e.conversationType=5===t?E.CONV_SYSTEM:E.CONV_GROUP,e.isSystemMessage=!!e.isSystemMessage;var n=new Wa(e),o=this.packElements(e,t);return n.setElement(o,this._groupModule.getFileDownloadProxy()),n}},{key:\"packElements\",value:function(e,n){return 4===n||6===n?(this._updateMemberCountByGroupTips(e),{type:E.MSG_GRP_TIP,content:t(t({},e.elements),{},{groupProfile:e.groupProfile})}):5===n?{type:E.MSG_GRP_SYS_NOTICE,content:t(t({},e.elements),{},{groupProfile:t(t({},e.groupProfile),{},{groupID:e.groupID})})}:this._getModule(Kn).parseElements(e.elements,e.from)}},{key:\"packConversationOption\",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var o=e[n],s=o.conversationID;if(t.has(s)){var a=t.get(s);a.lastMessage=o,\"in\"===o.flow&&a.unreadCount++}else t.set(s,{conversationID:o.conversationID,unreadCount:\"out\"===o.flow?0:1,type:o.conversationType,subType:o.conversationSubType,lastMessage:o})}return m(t.values())}},{key:\"_updateMemberCountByGroupTips\",value:function(e){var t=e.groupProfile.groupID,n=e.elements.onlineMemberInfo,o=void 0===n?void 0:n;if(!zt(o)){var s=o.onlineMemberNum,a=void 0===s?0:s,i=o.expireTime,r=void 0===i?this.DEFAULT_EXPIRE_TIME:i,u=this._onlineMemberCountMap.get(t)||{},c=Date.now();zt(u)?Object.assign(u,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:c,memberCount:a,expireTime:r}):(u.latestUpdateTime=c,u.memberCount=a),Ve.d(\"\".concat(this._n,\"._updateMemberCountByGroupTips info:\"),u),this._onlineMemberCountMap.set(t,u)}}},{key:\"_onBroadcastMessage\",value:function(e){if(!zt(e)){for(var t=[],n=e.length,o=null,s=0;s<n;s++){var a=this.restoreMessageFromSimplified(e[s]);Gi[a.event]?((o=this.packMessage(a,a.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(o.ID)||(t.push(o),this._broadcastMessageIDMap.set(o.ID,1))):Ve.w(\"\".concat(this._n,\"._onBroadcastMessage unknown event:\").concat(a.event))}t.length>0&&this._groupModule.emitOuterEvent(k.MESSAGE_RECEIVED,t)}}},{key:\"start\",value:function(e){if(this._pollingInstanceMap.has(e)){var t=this._pollingInstanceMap.get(e);t.isRunning()||t.start()}else{var n=new Oi({manager:this,groupID:e,onInit:this._updateRequestData.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)});n.start(),this._pollingInstanceMap.set(e,n),Ve.l(\"\".concat(this._n,\".start groupID:\").concat(e))}}},{key:\"handleJoinResult\",value:function(e){var t=this;return this._preCheck().then((function(){var n=e.longPollingKey,o=e.group,s=o.groupID;return t._joinedGroupMap.set(s,o),t._groupModule.updateGroupMap([o]),t._groupModule.deleteUnjoinedAVChatRoom(s),t._groupModule.emitGroupListUpdate(!0,!1),it(n)?Xa({status:je,group:o}):Promise.resolve()}))}},{key:\"startRunLoop\",value:function(e){var t=this;return this.handleJoinResult(e).then((function(){var n=e.longPollingKey,o=e.group,s=e.startSeq,a=void 0===s?0:s,i=o.groupID;return t._pollingRequestInfoMap.set(i,{key:n,startSeq:a}),t.start(i),t._groupModule.isLoggedIn()?Xa({status:je,group:o}):Xa({status:je})}))}},{key:\"_preCheck\",value:function(){if(this._getModule(xn).isUnlimitedAVChatRoom())return Promise.resolve();if(!this.hasJoinedAVChatRoom())return Promise.resolve();var e=v(this._joinedGroupMap.entries().next().value,2),t=e[0],n=e[1];if(this._groupModule.isLoggedIn()){if(!(n.selfInfo.role===E.GRP_MBR_ROLE_OWNER||n.ownerID===this._groupModule.getMyUserID()))return this._groupModule.quitGroup(t);this._groupModule.deleteLocalGroupAndConversation(t)}else this._groupModule.deleteLocalGroupAndConversation(t);return this.reset(t),Promise.resolve()}},{key:\"joinWithoutAuth\",value:function(e){var t=this,n=e.groupID,o=\"\".concat(this._n,\".\").concat(\"joinWithoutAuth\"),s=new Aa(\"joinWithoutAuth\");return this._groupModule.request({protocolName:$o,requestData:e}).then((function(e){var a=e.data.longPollingKey;if(t._groupModule.probeNetwork().then((function(e){var t=v(e,2);t[0];var o=t[1];s.setNetworkType(o).setMessage(\"groupID:\".concat(n,\" longPollingKey:\").concat(a)).end(!0)})),it(a))return Za({code:ha.CANNOT_JOIN_NON_AVCHATROOM_WITHOUT_LOGIN});Ve.l(\"\".concat(o,\" ok. groupID:\").concat(n)),t._getModule(qn).setCompleted(\"\".concat(E.CONV_GROUP).concat(n));var i=new hi({groupID:n});return t.startRunLoop({group:i,longPollingKey:a}),Ya({status:je})})).catch((function(e){return Ve.e(\"\".concat(o,\" failed. groupID:\").concat(n,\" error:\"),e),t._groupModule.probeNetwork().then((function(t){var o=v(t,2),a=o[0],i=o[1];s.setError(e,a,i).setMessage(\"groupID:\".concat(n)).end(!0)})),Za(e)})).finally((function(){t._groupModule.getModule(Bn).reportAtOnce()}))}},{key:\"getGroupOnlineMemberCount\",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return zt(t)||n-t.lastSyncTime>1e3*t.expireTime&&n-t.latestUpdateTime>1e4&&n-t.lastReqTime>3e3?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then((function(e){return Ya({memberCount:e.memberCount})})).catch((function(e){return Za(e)}))):Xa({memberCount:t.memberCount})}},{key:\"_getGroupOnlineMemberCount\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"_getGroupOnlineMemberCount\");return this._groupModule.request({protocolName:ms,requestData:{groupID:e}}).then((function(o){var s=t._onlineMemberCountMap.get(e)||{},a=o.data,i=a.onlineMemberNum,r=void 0===i?0:i,u=a.expireTime,c=void 0===u?t.DEFAULT_EXPIRE_TIME:u;Ve.l(\"\".concat(n,\" ok. groupID:\").concat(e,\" memberCount:\").concat(r,\" expireTime:\").concat(c));var l=Date.now();return zt(s)&&(s.lastReqTime=l),t._onlineMemberCountMap.set(e,Object.assign(s,{lastSyncTime:l,latestUpdateTime:l,memberCount:r,expireTime:c})),{memberCount:r}})).catch((function(o){return Ve.w(\"\".concat(n,\" failed. error:\"),o),new Aa(\"_getGroupOnlineMemberCount\").setCode(o.code).setMessage(\"groupID:\".concat(e,\" error:\").concat(JSON.stringify(o))).setNetworkType(t._groupModule.getNetworkType()).end(),Promise.reject(o)}))}},{key:\"_getModule\",value:function(e){return this._groupModule.getModule(e)}},{key:\"setPollingInterval\",value:function(e){it(e)||(et(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:\"setPollingIntervalPlus\",value:function(e){it(e)||(et(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:\"setPollingNoMessageCount\",value:function(e){it(e)||(et(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:\"setPollingSimplifiedMessage\",value:function(e){it(e)||\"0\"!==e&&\"1\"!==e||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(e,10))}},{key:\"getPollingInterval\",value:function(){return this._pollingInterval}},{key:\"onAVChatRoomMemberBanned\",value:function(e){var t=e.payload.groupProfile.groupID;Ve.l(\"\".concat(this._n,\".onAVChatRoomMemberBanned groupID:\").concat(t)),this._groupModule.deleteLocalGroupAndConversation(t),this.reset(t)}},{key:\"restartPolling\",value:function(){Ve.l(\"\".concat(this._n,\".restartPolling count:\").concat(this._pollingInstanceMap.size));var e,t=D(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(o){t.e(o)}finally{t.f()}}},{key:\"getPollingTimerID\",value:function(e){if(!this._pollingInstanceMap.has(e))return-1;var t=this._pollingInstanceMap.get(e).getPollingTimerID();return Ve.l(\"\".concat(this._n,\".getPollingTimerID groupID:\").concat(e,\" timerID:\").concat(t)),t}},{key:\"reset\",value:function(e){if(e){Ve.l(\"\".concat(this._n,\".reset groupID:\").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{Ve.l(\"\".concat(this._n,\".reset all\"));var n,o=D(this._pollingInstanceMap.values());try{for(o.s();!(n=o.n()).done;){n.value.stop()}}catch(s){o.e(s)}finally{o.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this.sequencesLinkedList.reset(),this.messageIDLinkedList.reset(),this.receivedMessageCount=0,this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),e}(),Pi=1,bi=15,wi=function(){function e(t){o(this,e),this._groupModule=t,this._n=\"GroupSystemNoticeHandler\",this.pendencyMap=new Map}return a(e,[{key:\"onNewGroupSystemNotice\",value:function(e){var t=e.dataList,n=e.isSyncingEnded,o=e.isInstantMessage;Ve.d(\"\".concat(this._n,\".onReceiveSystemNotice count:\").concat(t.length));var s=this.newSystemNoticeStoredAndSummary({notifiesList:t,isInstantMessage:o}),a=s.eventDataList,i=s.result;a.length>0&&(this._groupModule.getModule(qn).onNewMessage({conversationOptionsList:a,isInstantMessage:o}),this._onReceivedGroupSystemNotice({result:i,isInstantMessage:o}));o?i.length>0&&this._groupModule.emitOuterEvent(k.MESSAGE_RECEIVED,i):!0===n&&this._clearGroupSystemNotice()}},{key:\"newSystemNoticeStoredAndSummary\",value:function(e){var n=e.notifiesList,o=e.isInstantMessage,s=null,a=n.length,i=0,r=[],u={conversationID:E.CONV_SYSTEM,unreadCount:0,type:E.CONV_SYSTEM,subType:null,lastMessage:null};for(i=0;i<a;i++){var c=n[i],l=c.groupProfile,d=l.communityType,p=void 0===d?0:d,g=l.topicID,h=void 0===g?void 0:g,_=c.elements,f=_.topicIDList,v=void 0===f?void 0:f,m=_.operationType;if(!(2!==p||zt(h)&&zt(v))){if([17,18,20].includes(m)){this._handleTopicSystemNotice(c);continue}zt(h)||(c.to=h)}if(c.elements.operationType!==bi)c.currentUser=this._groupModule.getMyUserID(),c.conversationType=E.CONV_SYSTEM,c.conversationID=E.CONV_SYSTEM,(s=new Wa(c)).setElement({type:E.MSG_GRP_SYS_NOTICE,content:t(t({},c.elements),{},{groupProfile:t({},c.groupProfile)})}),s.isSystemMessage=!0,(1===s.sequence&&1===s.random||2===s.sequence&&2===s.random)&&(s.sequence=_t(),s.random=_t(),s.generateMessageID(),Ve.l(\"\".concat(this._n,\".newSystemNoticeStoredAndSummary sequence and random maybe duplicated, regenerate. ID:\").concat(s.ID))),this._groupModule.getModule(qn).pushIntoNoticeResult(r,s)&&(o?u.unreadCount++:s.setIsRead(!0),u.subType=s.conversationSubType)}return u.lastMessage=r[r.length-1],{eventDataList:r.length>0?[u]:[],result:r}}},{key:\"_clearGroupSystemNotice\",value:function(){var e=this;this._getPendencyList().then((function(t){t.forEach((function(t){e.pendencyMap.set(\"\".concat(t.from,\"_\").concat(t.groupID,\"_\").concat(t.to),t)}));var n=e._groupModule.getModule(qn).getLocalMessageList(E.CONV_SYSTEM),o=[];n.forEach((function(t){var n=t.payload,s=n.operatorID,a=n.operationType,i=n.groupProfile;if(a===Pi){var r=\"\".concat(s,\"_\").concat(i.groupID,\"_\").concat(i.to),u=e.pendencyMap.get(r);u&&et(u.handled)&&0!==u.handled&&o.push(t)}})),e.deleteGroupSystemNotice({messageList:o})}))}},{key:\"deleteGroupSystemNotice\",value:function(e){var t=this,n=\"\".concat(this._n,\".deleteGroupSystemNotice\");return at(e.messageList)&&0!==e.messageList.length?(Ve.l(\"\".concat(n,\" \")+e.messageList.map((function(e){return e.ID}))),this._groupModule.request({protocolName:_s,requestData:{messageListToDelete:e.messageList.map((function(e){return{from:E.CONV_SYSTEM,messageSeq:e.clientSequence,messageRandom:e.random}}))}}).then((function(){Ve.l(\"\".concat(n,\" ok\"));var o=t._groupModule.getModule(qn);return e.messageList.forEach((function(e){o.deleteLocalMessage(e)})),Ya()})).catch((function(e){return Ve.e(\"\".concat(n,\" error:\"),e),Za(e)}))):Xa()}},{key:\"_getPendencyList\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,o=void 0===n?void 0:n,s=t.startTime,a=void 0===s?0:s,i=t.limit,r=void 0===i?20:i;return this._groupModule.request({protocolName:hs,requestData:{type:o,startTime:a,limit:r,handleAccount:this._groupModule.getMyUserID()}}).then((function(t){var n=t.data.pendencyList;return 0!==t.data.nextStartTime?e._getPendencyList({startTime:t.data.nextStartTime}).then((function(e){return[].concat(m(n),m(e))})):n}))}},{key:\"getGroupApplicationList\",value:function(){var e=this;return this._getPendencyList().then((function(t){return e._getPendencyList({type:E.GRP_COMMUNITY}).then((function(n){return t.push.apply(t,m(n)),e._handlePendencyResult(t)})).catch((function(n){return e._handlePendencyResult(t)}))}))}},{key:\"_handlePendencyResult\",value:function(e){var t=this,n=[];return e.forEach((function(e){t.pendencyMap.set(\"\".concat(e.from,\"_\").concat(e.groupID,\"_\").concat(e.to),e),0===e.handled&&n.push({applicant:e.from,applicantNick:e.fromUserNickName,groupName:e.groupName,groupID:e.groupID,authentication:e.authentication,messageKey:e.time,applicationType:e.applicationType,userID:e.userID})})),Xa({applicationList:n})}},{key:\"_onReceivedGroupSystemNotice\",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach((function(e){switch(e.payload.operationType){case 1:break;case 2:t._onApplyGroupRequestAgreed(e);break;case 3:break;case 4:t._onMemberKicked(e);break;case 5:t._onGroupDismissed(e);break;case 6:break;case 7:t._onInviteGroup(e);break;case 8:t._onQuitGroup(e);break;case 9:t._onSetManager(e);break;case 10:t._onDeleteManager(e);break;case 11:case 12:case 15:break;case 20:t._onMessageRemindTypeSynced(e);break;case 21:t._groupModule.onAVChatRoomMemberBanned(e)}}))}},{key:\"_onApplyGroupRequestAgreed\",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;if(n){t._groupModule.updateGroupMap([n]);var o=!n.isSupportTopic;t._groupModule.emitGroupListUpdate(!0,o)}}))}},{key:\"_onMemberKicked\",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:\"_onGroupDismissed\",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t);var n=this._groupModule._AVChatRoomHandler;n&&n.checkJoinedAVChatRoomByID(t)&&n.reset(t)}},{key:\"_onInviteGroup\",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;n&&(t._groupModule.updateGroupMap([n]),t._groupModule.emitGroupListUpdate())}))}},{key:\"_onQuitGroup\",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:\"_onSetManager\",value:function(e){var t=e.payload.groupProfile,n=t.to,o=t.groupID,s=this._groupModule.getModule(wn).getLocalGroupMemberInfo(o,n);s&&s.updateRole(E.GRP_MBR_ROLE_ADMIN)}},{key:\"_onDeleteManager\",value:function(e){var t=e.payload.groupProfile,n=t.to,o=t.groupID,s=this._groupModule.getModule(wn).getLocalGroupMemberInfo(o,n);s&&s.updateRole(E.GRP_MBR_ROLE_MEMBER)}},{key:\"_onMessageRemindTypeSynced\",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.messageRemindType;this._groupModule.getModule(qn).onGroupMessageRemindTypeSynced({groupID:t,messageRemindType:n})}},{key:\"_handleTopicSystemNotice\",value:function(e){var t=e.groupProfile,n=t.groupID,o=t.topicID,s=e.elements,a=s.operationType,i=s.topicIDList,r=s.messageRemindType,u=this._groupModule.getModule(Fn);17===a?u.onTopicCreated({groupID:n,topicID:o}):18===a?u.onTopicDeleted({groupID:n,topicIDList:i}):20===a&&u.onTopicMessageRemindTypeUpdated({groupID:n,topicID:o,messageRemindType:r})}},{key:\"reset\",value:function(){this.pendencyMap.clear()}}]),e}(),Fi=[\"relayFlag\"],qi=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"GroupModule\",t._commonGroupHandler=null,t._AVChatRoomHandler=null,t._groupSystemNoticeHandler=null,t._commonGroupHandler=new Ii(h(t)),t._groupAttributesHandler=new Si(h(t)),t._groupCountersHandler=new Ni(h(t)),t._AVChatRoomHandler=new Ui(h(t)),t._groupTipsHandler=new yi(h(t)),t._groupSystemNoticeHandler=new wi(h(t)),t.groupMap=new Map,t._unjoinedAVChatRoomList=new Map,t._receiptDetailCompleteMap=new Map,t.getInnerEmitterInstance().on(ti,t._onCloudConfigUpdated,h(t)),t}return a(s,[{key:\"_onCloudConfigUpdated\",value:function(){var e=this.getCloudConfig(\"polling_interval\"),t=this.getCloudConfig(\"polling_interval_plus\"),n=this.getCloudConfig(\"polling_no_msg_count\"),o=this.getCloudConfig(\"polling_simplified_msg\");this._AVChatRoomHandler&&(Ve.l(\"\".concat(this._n,\"._onCloudConfigUpdated pollingInterval:\").concat(e)+\" pollingIntervalPlus:\".concat(t,\" pollingNoMessageCount:\").concat(n)+\" pollingSimplifiedMessage:\".concat(o)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n),this._AVChatRoomHandler.setPollingSimplifiedMessage(o))}},{key:\"onCheckTimer\",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:\"guardForAVChatRoom\",value:function(e){var t=this;if(e.conversationType===E.CONV_GROUP){var n=kt(e.to)?xt(e.to):e.to;return this.hasLocalGroup(n)?Xa():this.getGroupProfile({groupID:n}).then((function(o){var s=o.data.group.type;if(Ve.l(\"\".concat(t._n,\".guardForAVChatRoom. groupID:\").concat(n,\" type:\").concat(s)),s===E.GRP_AVCHATROOM){var a=ha.MESSAGE_SEND_FAIL_NOT_IN_AVCHATROOM;return Za(new ja({code:a,message:t.getErrorMessage(a,e.from,n),data:{message:e}}))}return Xa()}))}return Xa()}},{key:\"checkJoinedAVChatRoomByID\",value:function(e){return!!this._AVChatRoomHandler&&this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:\"onNewGroupMessage\",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.onNewGroupMessage(e)}},{key:\"updateNextMessageSeq\",value:function(e){var t=this;if(at(e)){var n=this.getModule(Fn);e.forEach((function(e){var o=e.conversationID.replace(E.CONV_GROUP,\"\");kt(o)&&n.updateLastMessage(o,e.lastMessage),t.groupMap.has(o)&&(t.groupMap.get(o).nextMessageSeq=e.lastMessage.sequence+1)}))}}},{key:\"onNewGroupTips\",value:function(e){this._groupTipsHandler&&this._groupTipsHandler.onNewGroupTips(e)}},{key:\"onGroupMessageRevoked\",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.onGroupMessageRevoked(e)}},{key:\"onNewGroupSystemNotice\",value:function(e){this._groupSystemNoticeHandler&&this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:\"onGroupMessageReadNotice\",value:function(e){var t=this;e.dataList.forEach((function(e){var n=e.elements.groupMessageReadNotice;if(!it(n)){var o=t.getModule(qn);n.forEach((function(e){var n=e.groupID,s=e.topicID,a=void 0===s?void 0:s,i=e.lastMessageSeq;Ve.d(\"\".concat(t._n,\".onGroupMessageReadNotice groupID:\").concat(n,\" lastMessageSeq:\").concat(i));var r=\"\".concat(E.CONV_GROUP).concat(n),u=!0;zt(a)||(r=\"\".concat(E.CONV_GROUP).concat(a),u=!1),o.updateIsReadAfterReadReport({conversationID:r,lastMessageSeq:i}),o.updateUnreadCount(r,u),o.clearGroupAtInfoList(r,u)}))}}))}},{key:\"onReadReceiptList\",value:function(e){var t=this;Ve.d(\"\".concat(this._n,\".onReadReceiptList options:\"),JSON.stringify(e)),e.dataList.forEach((function(e){var n=e.groupProfile,o=e.elements,s=n.groupID,a=t.getModule(qn),i=o.readReceiptList;a.updateReadReceiptInfo({groupID:s,readReceiptList:i})}))}},{key:\"onGroupMessageModified\",value:function(e){Ve.d(\"\".concat(this._n,\".onGroupMessageModified options:\"),JSON.stringify(e));var n=this.getModule(qn);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:E.CONV_GROUP,to:e.topicID?e.topicID:e.groupID}))}))}},{key:\"deleteGroupSystemNotice\",value:function(e){this._groupSystemNoticeHandler&&this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:\"initGroupMap\",value:function(e){this.groupMap.set(e.groupID,new hi(e))}},{key:\"deleteGroup\",value:function(e){this.groupMap.delete(e)}},{key:\"updateGroupMap\",value:function(e){var t,n=this,o=this.getModule(qn);e.forEach((function(e){t=e.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(e):(n.groupMap.set(t,new hi(e)),o.deleteGroupRomaingMessageInfo(t))}));var s,a=this.getMyUserID(),i=D(this.groupMap);try{for(i.s();!(s=i.n()).done;){var r=v(s.value,2)[1];r.selfInfo.userID=a,\"Owner\"===r.selfInfo.role&&(r.ownerID=a)}}catch(u){i.e(u)}finally{i.f()}this._setStorageGroupList()}},{key:\"getStorageGroupList\",value:function(){return this.getModule(Vn).getItem(\"groupMap\")}},{key:\"_setStorageGroupList\",value:function(){var e=this.getLocalGroupList().filter((function(e){var t=e.type;return!Tt(t)})).filter((function(e){return!e.isSupportTopic})).slice(0,20).map((function(e){return{groupID:e.groupID,name:e.name,avatar:e.avatar,type:e.type}}));this.getModule(Vn).setItem(\"groupMap\",e)}},{key:\"getGroupMap\",value:function(){return this.groupMap}},{key:\"getLocalGroupList\",value:function(){return m(this.groupMap.values())}},{key:\"getLocalGroupProfile\",value:function(e){return this.groupMap.get(e)}},{key:\"sortLocalGroupList\",value:function(){var e=m(this.groupMap).filter((function(e){var t=v(e,2);return t[0],!zt(t[1].lastMessage)}));e.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})),this.groupMap=new Map(m(e))}},{key:\"updateGroupLastMessage\",value:function(e){this._commonGroupHandler&&this._commonGroupHandler.handleUpdateGroupLastMessage(e)}},{key:\"emitGroupListUpdate\",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalGroupList();if(e&&this.emitOuterEvent(k.GROUP_LIST_UPDATED),t){var o=JSON.parse(JSON.stringify(n)),s=this.getModule(qn);s.updateConversationGroupProfile(o)}}},{key:\"patchGroupMessageRemindType\",value:function(){var e=this.getLocalGroupList(),t=this.getModule(qn),n=0;e.forEach((function(e){!0===t.patchMessageRemindType({ID:e.groupID,isC2CConversation:!1,messageRemindType:e.selfInfo.messageRemindType})&&(n+=1)})),Ve.l(\"\".concat(this._n,\".patchGroupMessageRemindType count:\").concat(n))}},{key:\"recomputeUnreadCount\",value:function(){var e=this.getLocalGroupList(),t=this.getModule(qn);e.forEach((function(e){var n=e.groupID,o=e.selfInfo,s=o.excludedUnreadSequenceList,a=o.readedSequence;if(at(s)){var i=0;s.forEach((function(t){t>=a&&t<=e.nextMessageSeq-1&&(i+=1)})),i>=1&&t.recomputeGroupUnreadCount({conversationID:\"\".concat(E.CONV_GROUP).concat(n),count:i})}}))}},{key:\"getMyNameCardByGroupID\",value:function(e){var t=this.getLocalGroupProfile(e);return t?t.selfInfo.nameCard:\"\"}},{key:\"isPagingGetCompleted\",value:function(){return!!this._commonGroupHandler&&this._commonGroupHandler.isPagingGetCompleted()}},{key:\"getGroupList\",value:function(e){return this._commonGroupHandler?this._commonGroupHandler.getGroupList(e):Xa()}},{key:\"getGroupProfile\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"getGroupProfile\"),o=new Aa(\"getGroupProfile\"),s=e.groupID,a=e.groupCustomFieldFilter;Ve.l(\"\".concat(n,\" groupID:\").concat(s));var i={groupIDList:[s],responseFilter:{groupBaseInfoFilter:[\"Type\",\"Name\",\"Introduction\",\"Notification\",\"FaceUrl\",\"Owner_Account\",\"CreateTime\",\"InfoSeq\",\"LastInfoTime\",\"LastMsgTime\",\"MemberNum\",\"MaxMemberNum\",\"ApplyJoinOption\",\"NextMsgSeq\",\"ShutUpAllMember\",\"InviteJoinOption\"],groupCustomFieldFilter:a,memberInfoFilter:[\"Role\",\"JoinTime\",\"MsgSeq\",\"MsgFlag\",\"NameCard\"]}};return this.getGroupProfileAdvance(i).then((function(e){var a,i=e.data,r=i.successGroupList,u=i.failureGroupList;if(Ve.l(\"\".concat(n,\" ok\")),u.length>0)return Za(u[0]);(Tt(r[0].type)&&!t.hasLocalGroup(s)?a=new hi(r[0]):(t.updateGroupMap(r),a=t.getLocalGroupProfile(s)),a.isSupportTopic)||t.getModule(qn).updateConversationGroupProfile([a]);return o.setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(s,\" type:\").concat(a.type,\" muteAllMembers:\").concat(a.muteAllMembers,\" ownerID:\").concat(a.ownerID)).end(),Ya({group:a})})).catch((function(s){return t.probeNetwork().then((function(t){var n=v(t,2),a=n[0],i=n[1];o.setError(s,a,i).setMessage(\"groupID:\".concat(e.groupID)).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),s),Za(s)}))}},{key:\"getGroupProfileAdvance\",value:function(e){var n=\"\".concat(this._n,\".getGroupProfileAdvance\"),o=e.groupIDList;at(o)&&o.length>50&&(this.outputWarning(\"GetGroupProfileLimit\"),o.length=50);var s=[],a=[];o.forEach((function(e){Dt({groupID:e})?a.push(e):s.push(e)}));var i=[];if(s.length>0){var r=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:s}));i.push(r)}if(a.length>0){var u=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:a,relayFlag:s.length>0}));i.push(u)}return Promise.all(i).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push.apply(t,m(e.successGroupList)),n.push.apply(n,m(e.failureGroupList))})),Ya({successGroupList:t,failureGroupList:n})})).catch((function(e){return Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_getGroupProfileAdvance\",value:function(e){var t=this,n=e.relayFlag,o=void 0!==n&&n,s=g(e,Fi);return this.request({protocolName:zo,requestData:s}).then((function(e){Ve.l(\"\".concat(t._n,\"._getGroupProfileAdvance ok.\"));var n=e.data.groups;return{successGroupList:n.filter((function(e){return it(e.errorCode)||0===e.errorCode})),failureGroupList:n.filter((function(e){return e.errorCode&&0!==e.errorCode})).map((function(e){return new ja({code:e.errorCode,message:e.errorInfo,data:{groupID:e.groupID}})}))}})).catch((function(t){return o&&Dt({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:Za(t)}))}},{key:\"createGroup\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"createGroup\"),s=e.type,a=e.groupID;if(e.name&&!1===this._filterProfanity(\"name\",e))return Za({code:ha.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity(\"introduction\",e))return Za({code:ha.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity(\"notification\",e))return Za({code:ha.PROFANITY_FOUND});if(![\"Public\",\"Private\",\"ChatRoom\",\"AVChatRoom\",\"Community\"].includes(s))return Za({code:ha.ILLEGAL_GROUP_TYPE});if(!Dt({type:s})){if(!zt(a)&&Dt({groupID:a}))return Za({code:ha.ILLEGAL_GROUP_ID});e.isSupportTopic=void 0}if(Tt(s)&&!it(e.memberList)&&e.memberList.length>0&&(e.memberList=void 0),this._canIUseJoinOption(s)||it(e.joinOption)||(e.joinOption=void 0),Dt({type:s})){if(!zt(a)&&!Dt({groupID:a}))return Za({code:ha.ILLEGAL_GROUP_ID});e.isSupportTopic=!0===e.isSupportTopic?1:0}var i=new Aa(\"createGroup\");Ve.l(\"\".concat(o,\" options:\"),e);var r=null,u=[];return this.request({protocolName:Jo,requestData:t(t({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then((function(s){var a=s.data,c=a.groupID,l=a.overLimitUserIDList,d=void 0===l?[]:l;if(r=c,u=d,i.setNetworkType(n.getNetworkType()).setMessage(\"groupType:\".concat(e.type,\" groupID:\").concat(c,\" overLimitUserIDList=\").concat(d)).end(),Ve.l(\"\".concat(o,\" ok groupID:\").concat(c,\" overLimitUserIDList:\"),d),e.type===E.GRP_AVCHATROOM)return n.getGroupProfile({groupID:c});if(e.type===E.GRP_COMMUNITY&&1===e.isSupportTopic)return n.getGroupProfile({groupID:c});zt(e.memberList)||zt(d)||(e.memberList=e.memberList.filter((function(e){return-1===d.indexOf(e.userID)}))),n.updateGroupMap([t(t({},e),{},{groupID:c})]);var p=n.getModule(Nn),g=p.createCustomMessage({to:c,conversationType:E.CONV_GROUP,payload:{data:\"group_create\",extension:n.isIntl()?\"\".concat(n.getMyUserID(),\" created a group\"):\"\".concat(n.getMyUserID(),\"创建群组\")}});return p.sendMessageInstance(g),n.emitGroupListUpdate(),n.getGroupProfile({groupID:c})})).then((function(e){var t=e.data.group,n=t.selfInfo,o=n.nameCard,s=n.joinTime;return t.updateSelfInfo({nameCard:o,joinTime:s,messageRemindType:E.MSG_REMIND_ACPT_AND_NOTE,role:E.GRP_MBR_ROLE_OWNER}),Ya({group:t,overLimitUserIDList:u})})).catch((function(s){if(i.setMessage(\"groupType:\".concat(e.type)),n.probeNetwork().then((function(e){var t=v(e,2),n=t[0],o=t[1];i.setError(s,n,o).end()})),10010===s.code||10007===s.code){n.updateGroupMap([t(t({},e),{},{groupID:r})]);var a=n.getLocalGroupProfile(r);return Ve.l(\"\".concat(o,\" success, but failed to get group profile.\")),Ya({group:a,overLimitUserIDList:u})}return Ve.e(\"\".concat(o,\" failed. error:\"),s),Za(s)}))}},{key:\"dismissGroup\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"dismissGroup\");if(this.hasLocalGroup(e)&&this.getLocalGroupProfile(e).type===E.GRP_WORK)return Za(new ja({code:ha.CANNOT_DISMISS_WORK}));var o=new Aa(\"dismissGroup\");return o.setMessage(\"groupID:\".concat(e)),Ve.l(\"\".concat(n,\" groupID:\").concat(e)),this.request({protocolName:Xo,requestData:{groupID:e}}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),Ya({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"updateGroupProfile\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"updateGroupProfile\");if(this.hasLocalGroup(e.groupID)){var o=this.getLocalGroupProfile(e.groupID).type;this._canIUseJoinOption(o)||it(e.joinOption)||(Ve.w(\"\".concat(n,\" joinOption is unavailable for Work/Meeting/AVChatRoom\")),e.joinOption=void 0)}if(it(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers=\"On\":e.muteAllMembers=\"Off\"),e.name&&!1===this._filterProfanity(\"name\",e))return Za({code:ha.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity(\"introduction\",e))return Za({code:ha.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity(\"notification\",e))return Za({code:ha.PROFANITY_FOUND});var s=new Aa(\"updateGroupProfile\");return s.setMessage(JSON.stringify(e)),Ve.l(\"\".concat(n,\" groupID:\").concat(e.groupID)),this.request({protocolName:Zo,requestData:e}).then((function(){(s.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),t.hasLocalGroup(e.groupID))&&(t.groupMap.get(e.groupID).updateGroup(e),t._setStorageGroupList());return Ya({group:t.groupMap.get(e.groupID)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];s.setError(e,o,a).end()})),Ve.l(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_filterProfanity\",value:function(e,t){var n=this.getModule(oo);if(!n)return!0;var o=n.filterText(t[e],z),s=o.isAllowedToSend,a=o.modifiedText;return!0===s&&(t[e]=a,!0)}},{key:\"joinGroup\",value:function(e){var t=this,n=e.groupID,o=e.type,s=\"\".concat(this._n,\".joinGroup\");if(o===E.GRP_WORK)return Za({code:ha.CANNOT_JOIN_WORK});if(this.deleteUnjoinedAVChatRoom(n),this.hasLocalGroup(n)){if(!this.isLoggedIn())return Xa({status:E.JOIN_STATUS_ALREADY_IN_GROUP});var a=new Aa(\"applyJoinGroup\");return this.getGroupProfile({groupID:n}).then((function(){return a.setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(n,\" joinedStatus:\").concat(E.JOIN_STATUS_ALREADY_IN_GROUP)).end(),Xa({status:E.JOIN_STATUS_ALREADY_IN_GROUP})})).catch((function(o){return a.setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(n,\" unjoined\")).end(),Ve.w(\"\".concat(s,\" \").concat(n,\" was unjoined, now join!\")),t.groupMap.delete(n),t.applyJoinGroup(e)}))}return Ve.l(\"\".concat(s,\" groupID:\").concat(n)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e)}},{key:\"applyJoinGroup\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"applyJoinGroup\"),s=e.groupID;if(!zt(e.applyMessage)&&!1===this._filterProfanity(\"applyMessage\",e))return Za({code:ha.PROFANITY_FOUND});var a=new Aa(\"applyJoinGroup\"),i=t({},e),r=this.canIUse(B.AVCHATROOM_HISTORY_MSG);return r&&(i.historyMessageFlag=1),this.getModule(qn).deleteTopicRoamingMessageInfo(s),this.request({protocolName:Qo,requestData:i}).then((function(e){var t=e.data,i=t.joinedStatus,u=t.longPollingKey,c=t.startSeq,l=t.avChatRoomFlag,d=t.avChatRoomKey,p=t.messageList,g=\"groupID:\".concat(s,\" joinedStatus:\").concat(i,\" longPollingKey:\").concat(u,\" startSeq:\").concat(c)+\" avChatRoomFlag:\".concat(l,\" canGetAVChatRoomHistoryMessage:\").concat(r,\",\")+\" history message count:\".concat(zt(p)?0:p.length);switch(a.setNetworkType(n.getNetworkType()).setMessage(\"\".concat(g)).end(),Ve.l(\"\".concat(o,\" ok. \").concat(g)),i){case ze:return Ya({status:ze});case je:return n.getGroupProfile({groupID:s}).then((function(e){var t=e.data.group;return n._handleJoinResult({group:t,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:p})})).catch((function(){var e=new hi({groupID:s});return n._handleJoinResult({group:e,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:p})}));default:var h=new ja({code:ha.JOIN_GROUP_FAIL});return Ve.e(\"\".concat(o,\" failed. error:\"),h),Za(h)}})).catch((function(e){return a.setMessage(\"groupID:\".concat(s)),n.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"_handleJoinResult\",value:function(e){var t,n=this,o=e.group,s=e.avChatRoomFlag,a=e.longPollingKey,i=e.startSeq,r=e.avChatRoomKey,u=e.messageList,c=o.groupID;return 1===s?(this.getModule(qn).setCompleted(\"\".concat(E.CONV_GROUP).concat(c)),this._groupAttributesHandler.initGroupAttributesCache({groupID:c,avChatRoomKey:r}),this._groupCountersHandler.initGroupCountersCache({groupID:c,avChatRoomKey:r}),(t=it(a)?this._AVChatRoomHandler.handleJoinResult({group:o}):this._AVChatRoomHandler.startRunLoop({group:o,longPollingKey:a,startSeq:i})).then((function(){n._onAVChatRoomHistoryMessage(u)})),t):(this.emitGroupListUpdate(!0,!1),Ya({status:je,group:o}))}},{key:\"quitGroup\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"quitGroup\");Ve.l(\"\".concat(n,\" groupID:\").concat(e));var o=this.checkJoinedAVChatRoomByID(e);if(!o&&!this.hasLocalGroup(e))return Za({code:ha.MEMBER_NOT_IN_GROUP});if(o&&!this.isLoggedIn())return Ve.l(\"\".concat(n,\" anonymously ok. groupID:\").concat(e)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),Xa({groupID:e});var s=new Aa(\"quitGroup\");return s.setMessage(\"groupID:\".concat(e)),this.request({protocolName:es,requestData:{groupID:e}}).then((function(){return s.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),t.deleteLocalGroupAndConversation(e),o&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),Ya({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];s.setError(e,o,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"searchGroupByID\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"searchGroupByID\"),o={groupIDList:[e]},s=new Aa(\"searchGroupByID\");return s.setMessage(\"groupID:\".concat(e)),Ve.l(\"\".concat(n,\" groupID:\").concat(e)),this.request({protocolName:ts,requestData:o}).then((function(e){var o=e.data.groupProfile;if(0!==o[0].errorCode)throw new ja({code:o[0].errorCode,message:o[0].errorInfo});return s.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),Ya({group:new hi(o[0])})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];s.setError(e,o,a).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"changeGroupOwner\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"changeGroupOwner\");if(this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===E.GRP_AVCHATROOM)return Za({code:ha.CANNOT_CHANGE_OWNER_IN_AVCHATROOM});if(e.newOwnerID===this.getMyUserID())return Za({code:ha.CANNOT_CHANGE_OWNER_TO_SELF});var o=new Aa(\"changeGroupOwner\");return o.setMessage(\"groupID:\".concat(e.groupID,\" newOwnerID:\").concat(e.newOwnerID)),Ve.l(\"\".concat(n,\" groupID:\").concat(e.groupID)),this.request({protocolName:ns,requestData:e}).then((function(){o.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var s=e.groupID,a=e.newOwnerID;t.groupMap.get(s).ownerID=a;var i=t.getModule(wn).getLocalGroupMemberList(s);if(i instanceof Map){var r=i.get(t.getMyUserID());it(r)||(r.updateRole(\"Member\"),t.groupMap.get(s).selfInfo.role=\"Member\");var u=i.get(a);it(u)||u.updateRole(\"Owner\")}return t.emitGroupListUpdate(!0,!1),Ya({group:t.groupMap.get(s)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"getGroupApplicationList\",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:\"handleGroupApplication\",value:function(e){var t,n,o,s,a,i=this,r=\"\".concat(this._n,\".\").concat(\"handleGroupApplication\"),u=e.handleAction,c=e.handleMessage,l=e.message,d=e.application;l?(t=l.payload.operatorID,n=l.payload.groupProfile.groupID,o=l.payload.authentication,s=l.payload.messageKey):d&&(t=d.applicant,n=d.groupID,o=d.authentication,s=d.messageKey);var p=os;d&&2===d.applicationType&&(p=ss,a=d.userID);var g=new Aa(\"handleGroupApplication\");return g.setMessage(\"groupID:\".concat(n)),Ve.l(\"\".concat(r,\" groupID:\").concat(n)),this.request({protocolName:p,requestData:{handleAction:u,handleMessage:c,applicant:t,invitee:a,groupID:n,authentication:o,messageKey:s}}).then((function(){return g.setNetworkType(i.getNetworkType()).end(),Ve.l(\"\".concat(r,\" ok\")),l&&i._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),Ya({group:i.getLocalGroupProfile(n)})})).catch((function(e){return i.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];g.setError(e,o,s).end()})),Ve.e(\"\".concat(r,\" failed. error\"),e),Za(e)}))}},{key:\"handleGroupInvitation\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"handleGroupInvitation\"),s=e.message.payload,a=s.groupProfile.groupID,i=s.authentication,r=s.messageKey,u=s.operatorID,c=e.handleAction,l=new Aa(\"handleGroupInvitation\");return l.setMessage(\"groupID:\".concat(a,\" inviter:\").concat(u,\" handleAction:\").concat(c)),Ve.l(\"\".concat(o,\" groupID:\").concat(a,\" inviter:\").concat(u,\" handleAction:\").concat(c)),this.request({protocolName:as,requestData:t(t({},e),{},{inviter:u,groupID:a,authentication:i,messageKey:r})}).then((function(){return l.setNetworkType(n.getNetworkType()).end(),Ve.l(\"\".concat(o,\" ok\")),n._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),Ya({group:n.getLocalGroupProfile(a)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];l.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error\"),e),Za(e)}))}},{key:\"getGroupOnlineMemberCount\",value:function(e){return this._AVChatRoomHandler?this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)?this._AVChatRoomHandler.getGroupOnlineMemberCount(e):Xa({memberCount:0}):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"hasLocalGroup\",value:function(e){return this.groupMap.has(e)}},{key:\"deleteLocalGroupAndConversation\",value:function(e){var t=this.checkJoinedAVChatRoomByID(e);(Ve.l(\"\".concat(this._n,\".deleteLocalGroupAndConversation isJoinedAVChatRoom:\").concat(t)),t)&&this.getModule(qn).deleteLocalConversation(\"\".concat(E.CONV_GROUP).concat(e));if(Dt({groupID:e})){var n=this.getLocalGroupProfile(e);if(n&&!0===n.isSupportTopic)this.getModule(Fn).deleteTopicListInCommunity(e)}this._deleteLocalGroup(e),this.emitGroupListUpdate(!0,!1)}},{key:\"_deleteLocalGroup\",value:function(e){this.groupMap.delete(e),this.getModule(wn).deleteGroupMemberList(e),this._setStorageGroupList()}},{key:\"sendMessage\",value:function(e,t){if(at(e._receiverList)&&e._receiverList.length>0&&!this.canIUse(B.MSG_TO_SPECIFIED_GRP_MBR))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=this.createGroupMessagePack(e,t);return this.request(n)}},{key:\"createGroupMessagePack\",value:function(e,t){var n=null;t&&t.offlinePushInfo&&(n=t.offlinePushInfo);var o=\"\";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(o=e.cloudCustomData);var s=[];if(st(t)&&st(t.messageControlInfo)){var a=t.messageControlInfo,i=a.excludedFromUnreadCount,r=a.excludedFromLastMessage,u=a.excludedFromContentModeration;!0===i&&s.push(\"NoUnread\"),!0===r&&s.push(\"NoLastMsg\"),!0===u&&s.push(\"NoMsgCheck\")}var c=void 0;at(e._receiverList)&&e._receiverList.length>0&&(c=e._receiverList,e._receiverList.length>50&&(c=e._receiverList.slice(0,50),this.outputWarning(\"ReceiverListLimit\")));var l=this.isOnlineMessage(e,t)?1:0,d=e.getGroupAtInfoList(),p={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:e.getElements(),cloudCustomData:o,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==E.MSG_TEXT||zt(d)?void 0:d,onlineOnlyFlag:l,clientTime:e.clientTime,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||\"\",desc:n.description||\"\",ext:n.extension||\"\",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||\"\"}}:void 0,messageControlInfo:0===l?s:void 0,needReadReceipt:!0!==e.needReadReceipt||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:c,isSupportExtension:!0===e.isSupportExtension?1:0};return kt(e.to)&&(p.groupID=xt(e.to),p.topicID=e.to),{protocolName:vo,tjgID:this.generateTjgID(e),requestData:p}}},{key:\"_isVoipPush\",value:function(e){var t=void 0;return it(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:\"revokeMessage\",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return kt(e.to)&&(t.groupID=xt(e.to),t.topicID=e.to),this.request({protocolName:is,requestData:t})}},{key:\"deleteMessage\",value:function(e){var t=e.to,n=e.keyList;Ve.l(\"\".concat(this._n,\".deleteMessage groupID:\").concat(t,\" count:\").concat(n.length));var o={groupID:t,deleter:this.getMyUserID(),keyList:n};return kt(t)&&(o.groupID=xt(t),o.topicID=t),this.request({protocolName:Ms,requestData:o})}},{key:\"modifyRemoteMessage\",value:function(e){var t=e.to,n=e.sequence,o=e.payload,s=e.type,a=e.version,i=void 0===a?0:a,r=e.cloudCustomData,u=t,c=void 0;kt(t)&&(u=xt(t),c=t);var l=void 0;return Bt(s)&&(l=[]).push({type:s,content:o}),this.request({protocolName:ys,requestData:{groupID:u,topicID:c,sequence:n,version:i,elements:l,cloudCustomData:r}})}},{key:\"getRoamingMessage\",value:function(e){var t=this,n=\"\".concat(this._n,\".getRoamingMessage\"),o=e.conversationID,s=e.groupID,a=e.sequence,i=new Aa(\"getGroupRoamingMessages\"),r=0,u=void 0;return kt(s)&&(s=xt(u=s)),this._computeLastSequence({groupID:s,topicID:u,sequence:a}).then((function(e){return r=e,Ve.l(\"\".concat(n,\" groupID:\").concat(s,\" startSequence:\").concat(r)),t.request({protocolName:cs,requestData:{groupID:s,count:21,sequence:r,topicID:u}})})).then((function(e){var a=e.data,c=a.messageList,l=a.complete,d=a.invisibleSequenceList,p=void 0===d?[]:d;it(c)?Ve.l(\"\".concat(n,\" ok. complete:\").concat(l,\" but messageList is undefined!\")):Ve.l(\"\".concat(n,\" ok. complete:\").concat(l,\" count:\").concat(c.length));var g=t._getMinSequence(p,c)-1;i.setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(s,\" topicID:\").concat(u,\" startSequence:\").concat(r,\" complete:\").concat(l,\" nextSequence:\").concat(g)).end();var h=t.getModule(qn),_=[];return zt(c)||(h.updateRoamingMessageSequence(o,g),_=h.onRoamingMessage(c,o),h.updateIsRead(o),h.patchConversationLastMessage(o)),(2===l||g<=1)&&(h.setCompleted(o),g=\"\"),Ve.l(\"\".concat(n,\" nextReqID:\").concat(g,\", stored message count:\").concat(_.length,\", invisible sequence count:\").concat(p.length)),{nextReqID:g+\"\",storedMessageList:_}})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];i.setError(e,o,a).setMessage(\"groupID:\".concat(s,\" topicID:\").concat(u,\" startSequence:\").concat(r)).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_getGroupIDOfMessage\",value:function(e){return e.conversationID.replace(E.CONV_GROUP,\"\")}},{key:\"_getMinSequence\",value:function(e,t){var n=0;zt(t)||(n=t[t.length-1].sequence);var o=0;zt(e)||(o=e[e.length-1]);return Ve.l(\"\".concat(this._n,\"._getMinSequence minVisibleSequence:\").concat(n,\" minInvisibleSequence:\").concat(o)),o>0&&o<n?o:n}},{key:\"getReadReceiptList\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"getReadReceiptList\"),o=this._getGroupIDOfMessage(e[0]),s=this.getMyUserID(),a=e.filter((function(e){return e.from===s&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));if(Ve.l(\"\".concat(n,\" groupID:\").concat(o,\" sequenceList:\").concat(JSON.stringify(a))),0===a.length)return Xa({messageList:e});var i=new Aa(\"getReadReceiptList\");return i.setMessage(\"groupID:\".concat(o)),this.request({protocolName:ls,requestData:{groupID:o,sequenceList:a}}).then((function(t){i.end(),Ve.l(\"\".concat(n,\" ok\"));var o=t.data.readReceiptList;return at(o)&&o.forEach((function(t){e.forEach((function(e){0===t.code&&t.sequence===e.sequence&&(e.readReceiptInfo.readCount=t.readCount,e.readReceiptInfo.unreadCount=t.unreadCount)}))})),Ya({messageList:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"sendReadReceipt\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"sendReadReceipt\"),o=this._getGroupIDOfMessage(e[0]),s=new Aa(\"sendReadReceipt\");s.setMessage(\"groupID:\".concat(o));var a=this.getMyUserID(),i=e.filter((function(e){return e.from!==a&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));return 0===i.length?Za({code:ha.READ_RECEIPT_MESSAGE_LIST_EMPTY}):(Ve.l(\"\".concat(n,\". sequenceList:\").concat(JSON.stringify(i))),this.request({protocolName:ds,requestData:{groupID:o,sequenceList:i}}).then((function(e){return s.end(),Ve.l(\"\".concat(n,\" ok\")),Ya()})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];s.setError(e,o,a).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)})))}},{key:\"getReadReceiptDetail\",value:function(e){var t=this,n=e.message,o=e.filter,s=e.cursor,a=e.count,i=this._getGroupIDOfMessage(n),r=n.ID,u=n.sequence,c=\"\".concat(this._n,\".\").concat(\"getReadReceiptDetail\"),l=this._receiptDetailCompleteMap.get(r)||!1,d=0!==o&&1!==o?0:o,p=nt(s)?s:\"\",g=!et(a)||a<=0||a>=100?100:a,h=\"groupID:\".concat(i,\" sequence:\").concat(u,\" cursor:\").concat(p,\" filter:\").concat(d,\" completeFlag:\").concat(l);Ve.l(\"\".concat(c,\" \").concat(h));var _={cursor:\"\",isCompleted:!1,messageID:r,unreadUserIDList:[],readUserIDList:[]},f=new Aa(\"getReadReceiptDetail\");return f.setMessage(h),this.request({protocolName:gs,requestData:{groupID:i,sequence:u,flag:d,cursor:p,count:g}}).then((function(e){f.end();var n=e.data,o=n.cursor,s=n.isCompleted,a=n.unreadUserIDList,i=n.readUserIDList;return _.cursor=o,1===s&&(_.isCompleted=!0,t._receiptDetailCompleteMap.set(r,!0)),0===d?_.readUserIDList=i.map((function(e){return e.userID})):1===d&&(_.unreadUserIDList=a.map((function(e){return e.userID}))),Ve.l(\"\".concat(c,\" ok\")),Ya(_)})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];f.setError(e,o,s).end()})),Ve.w(\"\".concat(c,\" failed. error:\"),e),Za(e)}))}},{key:\"getRoamingMessagesHopping\",value:function(e){var t=this,n=\"\".concat(this._n,\".getRoamingMessagesHopping\"),o=new Aa(\"getGroupRoamingMessagesHopping\"),s=e.groupID,a=e.count,i=e.sequence,r=e.direction,u=i;1===r&&(u=i+a-1);var c=void 0;kt(s)&&(s=xt(c=s));var l=\"\".concat(c?\"topicID:\".concat(c):\"groupID:\".concat(s),\" sequence:\").concat(i,\" direction:\").concat(r);return Ve.l(\"\".concat(n,\" \").concat(l)),this.request({protocolName:cs,requestData:{groupID:s,topicID:c,count:a,sequence:u}}).then((function(s){var a=s.data,u=a.messageList,c=a.complete,d=\"complete:\".concat(c,\" count:\").concat(u?u.length:0);if(Ve.l(\"\".concat(n,\" ok. \").concat(d)),o.setNetworkType(t.getNetworkType()).setMessage(\"\".concat(l,\" \").concat(d)).end(),2===c||zt(u)){var p=t._computeResult();return Ya(p)}var g=\"\".concat(E.CONV_GROUP).concat(e.groupID),h=t.getModule(qn).onRoamingMessage(u,g,!1),_=t._computeResult({direction:r,sequence:i,remoteMessageList:u,processedMessageList:h});return Ya(_)})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),r=n[0],u=n[1];o.setError(e,r,u).setMessage(\"groupID:\".concat(s,\" sequence:\").concat(i,\" count:\").concat(a)).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_computeResult\",value:function(e){var t={messageList:[],isCompleted:!1,nextMessageSeq:\"\"};if(it(e))return t.isCompleted=!0,t;var n=e.direction,o=e.sequence,s=e.remoteMessageList,a=void 0===s?[]:s,i=e.processedMessageList,r=void 0===i?[]:i,u=a.length;return 1===n?(t.nextMessageSeq=a[0].sequence+1,r.forEach((function(e){e.sequence>=o&&t.messageList.push(e)})),0===t.messageList.length&&a[0].sequence<o&&(t.isCompleted=!0,t.nextMessageSeq=\"\"),t):(t.nextMessageSeq=a[u-1].sequence-1,t.messageList=m(r),0===t.nextMessageSeq&&(t.isCompleted=!0,t.nextMessageSeq=\"\"),t)}},{key:\"setMessageRead\",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageSeq,s=\"\".concat(this._n,\".setMessageRead\");Ve.l(\"\".concat(s,\" conversationID:\").concat(n,\" lastMessageSeq:\").concat(o)),et(o)||this.outputWarning(\"DoNotModifyLastSeq\");var a=new Aa(\"setGroupMessageRead\");a.setMessage(\"\".concat(n,\"-\").concat(o));var i=n.replace(E.CONV_GROUP,\"\"),r=void 0;return kt(i)&&(i=xt(r=i)),this.request({protocolName:rs,requestData:{groupID:i,topicID:r,messageReadSeq:o}}).then((function(){a.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(s,\" ok.\"));var e=t.getModule(qn);e.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:o});var u=!0;if(!it(r)){u=!1;var c=t.getModule(Fn).getLocalTopic(i,r);c&&c.updateSelfInfo({readedSequence:o})}return e.updateUnreadCount(n,u),Ya()})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.l(\"\".concat(s,\" failed. error:\"),e),Za(e)}))}},{key:\"_computeLastSequence\",value:function(e){var t=e.groupID,n=e.topicID,o=void 0===n?void 0:n,s=e.sequence;return s>0?Promise.resolve(s):it(o)||this.hasLocalGroup(t)?it(o)?this.getGroupLastSequence(t):this.getTopicLastSequence({groupID:t,topicID:o}):Promise.resolve(0)}},{key:\"getGroupLastSequence\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"getGroupLastSequence\"),o=new Aa(\"getGroupLastSequence\"),s=0,a=\"\";if(this.hasLocalGroup(e)){var i=this.getLocalGroupProfile(e),r=i.lastMessage;if(r.lastSequence>0&&!1===r.onlineOnlyFlag)return s=r.lastSequence,a=\"got lastSequence:\".concat(s,\" from local group profile[lastMessage.lastSequence]. groupID:\").concat(e),Ve.l(\"\".concat(n,\" \").concat(a)),o.setNetworkType(this.getNetworkType()).setMessage(\"\".concat(a)).end(),Promise.resolve(s);if(i.nextMessageSeq>1)return s=i.nextMessageSeq-1,a=\"got lastSequence:\".concat(s,\" from local group profile[nextMessageSeq]. groupID:\").concat(e),Ve.l(\"\".concat(n,\" \").concat(a)),o.setNetworkType(this.getNetworkType()).setMessage(\"\".concat(a)).end(),Promise.resolve(s)}var u=\"GROUP\".concat(e),c=this.getModule(qn).getLocalConversation(u);if(c&&c.lastMessage.lastSequence&&!1===c.lastMessage.onlineOnlyFlag)return s=c.lastMessage.lastSequence,a=\"got lastSequence:\".concat(s,\" from local conversation profile[lastMessage.lastSequence]. groupID:\").concat(e),Ve.l(\"\".concat(n,\" \").concat(a)),o.setNetworkType(this.getNetworkType()).setMessage(\"\".concat(a)).end(),Promise.resolve(s);var l={groupIDList:[e],responseFilter:{groupBaseInfoFilter:[\"NextMsgSeq\"]}};return this.getGroupProfileAdvance(l).then((function(i){var r=i.data.successGroupList;return zt(r)?Ve.l(\"\".concat(n,\" successGroupList is empty. groupID:\").concat(e)):(s=r[0].nextMessageSeq-1,a=\"got lastSequence:\".concat(s,\" from getGroupProfileAdvance. groupID:\").concat(e),Ve.l(\"\".concat(n,\" \").concat(a))),o.setNetworkType(t.getNetworkType()).setMessage(\"\".concat(a)).end(),s})).catch((function(s){return t.probeNetwork().then((function(t){var n=v(t,2),a=n[0],i=n[1];o.setError(s,a,i).setMessage(\"get lastSequence failed from getGroupProfileAdvance. groupID:\".concat(e)).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),s),Za(s)}))}},{key:\"getTopicLastSequence\",value:function(e){var t=this,n=e.groupID,o=e.topicID,s=\"\".concat(this._n,\".\").concat(\"getTopicLastSequence\"),a=new Aa(\"getTopicLastSequence\"),i=0,r=\"\",u=this.getModule(Fn);return u.hasLocalTopic(n,o)?(i=u.getLocalTopic(n,o).nextMessageSeq-1,r=\"get lastSequence:\".concat(i,\" from local topic info[nextMessageSeq]. topicID:\").concat(o),Ve.l(\"\".concat(s,\" \").concat(r)),a.setNetworkType(this.getNetworkType()).setMessage(\"\".concat(r)).end(),Promise.resolve(i)):u.getTopicList({groupID:n,topicIDList:[o]}).then((function(e){var n=e.data.successTopicList;return zt(n)?Ve.l(\"\".concat(s,\" successTopicList is empty. topicID:\").concat(o)):(i=n[0].nextMessageSeq-1,r=\"get lastSequence:\".concat(i,\" from getTopicList. topicID:\").concat(o),Ve.l(\"\".concat(s,\" \").concat(r))),a.setNetworkType(t.getNetworkType()).setMessage(\"\".concat(r)).end(),i})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),s=n[0],i=n[1];a.setError(e,s,i).setMessage(\"get lastSequence failed from getTopicList. topicID:\".concat(o)).end()})),Ve.w(\"\".concat(s,\" failed. error:\"),e),Za(e)}))}},{key:\"isMessageFromOrToAVChatroom\",value:function(e){return!!this._AVChatRoomHandler&&this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:\"hasJoinedAVChatRoom\",value:function(){return this._AVChatRoomHandler?this._AVChatRoomHandler.hasJoinedAVChatRoom():0}},{key:\"getJoinedAVChatRoom\",value:function(){return this._AVChatRoomHandler?this._AVChatRoomHandler.getJoinedAVChatRoom():[]}},{key:\"isOnlineMessage\",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||!0!==t.onlineUserOnly)}},{key:\"_canIUseOnlineOnlyFlag\",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==E.CONV_GROUP}},{key:\"_onAVChatRoomHistoryMessage\",value:function(e){if(!zt(e)){Ve.l(\"\".concat(this._n,\"._onAVChatRoomHistoryMessage count:\").concat(e.length));var n=[];e.forEach((function(e){n.push(t(t({},e),{},{isHistoryMessage:1}))})),this.onAVChatRoomMessage(n)}}},{key:\"onAVChatRoomMessage\",value:function(e){this._AVChatRoomHandler&&this._AVChatRoomHandler.onMessage(e)}},{key:\"onAVChatRoomMemberBanned\",value:function(e){this._AVChatRoomHandler&&this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:\"getGroupSimplifiedInfo\",value:function(e){var t=this,n=new Aa(\"getGroupSimplifiedInfo\"),o={groupIDList:[e],responseFilter:{groupBaseInfoFilter:[\"Type\",\"Name\"]}};return this.getGroupProfileAdvance(o).then((function(o){var s=o.data.successGroupList;return n.setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(e,\" type:\").concat(s[0].type)).end(),s[0]})).catch((function(o){t.probeNetwork().then((function(t){var s=v(t,2),a=s[0],i=s[1];n.setError(o,a,i).setMessage(\"groupID:\".concat(e)).end()}))}))}},{key:\"setUnjoinedAVChatRoom\",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:\"deleteUnjoinedAVChatRoom\",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:\"isUnjoinedAVChatRoom\",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:\"isGroupAttributesUpdatedNotice\",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:\"updateLocalMainSequenceOnReconnected\",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:\"initGroupAttributes\",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:\"setGroupAttributes\",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:\"deleteGroupAttributes\",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:\"getGroupAttributes\",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:\"isMessageFromTopic\",value:function(e,t){return 2===e&&!zt(t)}},{key:\"isMessageFromCommunityOfTopic\",value:function(e,t){return 2===e&&zt(t)}},{key:\"getMessageExtensions\",value:function(e,t){return Ve.l(\"\".concat(this._n,\".getMessageExtensions startSequence:\").concat(t)),this.request({protocolName:Ss,requestData:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:\"modifyMessageExtensions\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ve.l(\"\".concat(this._n,\".modifyMessageExtensions operateType:\").concat(n)),this.request({protocolName:Es,requestData:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:\"getGroupNotify\",value:function(e){var n=this;if(this.hasLocalGroup(e)){var o=this.getLocalGroupProfile(e),s=o.type,a=o.isSupportTopic;if(!Tt(s)&&!a){var i=\"\".concat(this._n,\".getGroupNotify\"),r=this._getGroupLastRevokedTime(e),u=1e3*Pe();Ve.l(\"\".concat(i,\" groupID:\").concat(e,\" type:\").concat(s,\" beginTime:\").concat(r,\" endTime:\").concat(u)),this.request({protocolName:Ls,requestData:{type:Dt({type:s,groupID:e})?E.GRP_COMMUNITY:void 0,groupID:e,beginTime:r,endTime:u}}).then((function(o){var s=o.data,a=s.nextRevokedTime,r=s.notifyList;Ve.l(\"\".concat(i,\" ok. groupID:\").concat(e,\" nextRevokedTime:\").concat(a));var u={dataList:[{elements:{revokedInfos:[]}}]};at(r)&&r.forEach((function(n){u.dataList[0].elements.revokedInfos.push({groupID:e,sequence:n.sequence,random:n.random,revokerInfo:t({},n.revokerInfo)})})),n.onGroupMessageRevoked(u),0!==a?(n._setGroupLastRevokedTime(e,a),n.getGroupNotify(e)):n._setGroupLastRevokedTime(e,1e3*Pe())})).catch((function(e){Ve.e(\"\".concat(i,\" failed. error:\"),e)}))}}}},{key:\"_getGroupLastRevokedTime\",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:\"_setGroupLastRevokedTime\",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:\"isGroupCountersNotice\",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:\"setGroupCounters\",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:\"increaseGroupCounter\",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:\"decreaseGroupCounter\",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:\"getGroupCounters\",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:\"restartPolling\",value:function(){this._AVChatRoomHandler&&this._AVChatRoomHandler.restartPolling()}},{key:\"getPollingTimerID\",value:function(e){if(!e)return-1;var t=this.getLocalGroupProfile(e);return t&&Tt(t.type)?this._AVChatRoomHandler.getPollingTimerID(e):-1}},{key:\"_canIUseJoinOption\",value:function(e){return function(e){return e===E.GRP_PUBLIC}(e)||Dt({type:e})}},{key:\"reset\",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler&&this._AVChatRoomHandler.reset()}}]),s}(uo),xi=function(){function e(t){o(this,e),this.userID=\"\",this.avatar=\"\",this.nick=\"\",this.role=\"\",this.joinTime=\"\",this.lastSendMsgTime=\"\",this.nameCard=\"\",this.muteUntil=0,this.memberCustomField=[],this._initMember(t)}return a(e,[{key:\"_initMember\",value:function(e){this.updateMember(e)}},{key:\"updateMember\",value:function(e){var t=[null,void 0,\"\",0,NaN];e.memberCustomField&&Ct(this.memberCustomField,e.memberCustomField),pt(this,e,[\"memberCustomField\",\"marks\"],t)}},{key:\"updateRole\",value:function(e){[\"Owner\",\"Admin\",\"Member\"].indexOf(e)<0||(this.role=e)}},{key:\"updateMuteUntil\",value:function(e){it(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:\"updateNameCard\",value:function(e){it(e)||(this.nameCard=e)}},{key:\"updateMemberCustomField\",value:function(e){e&&Ct(this.memberCustomField,e)}}]),e}(),Vi=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"GroupMemberModule\",t.groupMemberListMap=new Map,t.getInnerEmitterInstance().on(ni,t._onProfileUpdated,h(t)),t}return a(s,[{key:\"_onProfileUpdated\",value:function(e){for(var t=this,n=e.data,o=function(e){var o=n[e];t.groupMemberListMap.forEach((function(e){e.has(o.userID)&&e.get(o.userID).updateMember({nick:o.nick,avatar:o.avatar})}))},s=0;s<n.length;s++)o(s)}},{key:\"deleteGroupMemberList\",value:function(e){this.groupMemberListMap.delete(e)}},{key:\"getGroupMemberList\",value:function(e){var t=this,n=e.groupID,o=e.offset,s=void 0===o?0:o,a=e.count,i=void 0===a?15:a,r=e.filter,u=void 0===r?void 0:r,c=\"\".concat(this._n,\".\").concat(\"getGroupMemberList\"),l=this.getModule(Pn),d=l.hasLocalGroup(n);if(Ve.l(\"\".concat(c,\" groupID:\").concat(n,\" offset:\").concat(s,\" count:\").concat(i,\" hasLocalGroup:\").concat(d)),!d)return Xa({memberList:[],offset:0});if(l.getLocalGroupProfile(n).type===E.GRP_AVCHATROOM){if(this.canIUse(B.AVCHATROOM_MBR_LIST))return this._getAVChatRoomMemberList({groupID:n,offset:s,filter:u});this.outputWarning(\"LiveOnlineMember\")}var p=new Aa(\"getGroupMemberList\"),g=0,h={groupID:n,limit:i>100?100:i};Dt({groupID:n})?h.next=\"\".concat(s):(h.offset=s,g=s+i);var _=[];return this.request({protocolName:Ns,requestData:h}).then((function(e){var o=e.data,s=o.members,a=o.memberNum,i=o.next,r=void 0===i?void 0:i;if(it(r)||(g=zt(r)?0:r),!at(s)||0===s.length)return g=0,Promise.resolve([]);var u=t.getModule(Pn);return u.hasLocalGroup(n)&&(u.getLocalGroupProfile(n).memberNum=a),_=t._updateLocalGroupMemberMap(n,s),t.getModule(Gn).getUserProfile({userIDList:s.map((function(e){return e.userID})),tagList:[He.NICK,He.AVATAR]})})).then((function(e){var o=e.data;if(!at(o)||0===o.length)return Xa({memberList:[],offset:g});var a=o.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));return t._updateLocalGroupMemberMap(n,a),_.length<i&&(g=0),p.setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(n,\" offset:\").concat(s,\" count:\").concat(i)).end(),Ve.l(\"\".concat(c,\" ok.\")),Ya({memberList:_,offset:g})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];p.setError(e,o,s).end()})),Ve.e(\"\".concat(c,\" failed. error:\"),e),Za(e)}))}},{key:\"_getAVChatRoomMemberList\",value:function(e){var t=this,n=e.groupID,o=e.offset,s=e.filter,a=\"\".concat(this._n,\".\").concat(\"_getAVChatRoomMemberList\"),i=new Aa(\"_getAVChatRoomMemberList\");return i.setMessage(\"groupID:\".concat(n,\" offset:\").concat(o,\" filter:\").concat(s)),this.request({protocolName:Os,requestData:{groupID:n,offset:o,filter:s}}).then((function(e){var o=e.data,s=o.memberList,r=void 0===s?[]:s,u=o.offset,c=void 0===u?0:u;i.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(a,\" ok. member count:\").concat(r.length,\", next request timestamp:\").concat(c));var l=t._updateLocalGroupMemberMap(n,r);return Ya({memberList:l,offset:c})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(a,\" failed. error:\"),e),Za(e)}))}},{key:\"getGroupMemberProfile\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"getGroupMemberProfile\"),s=new Aa(\"getGroupMemberProfile\");s.setMessage(e.userIDList.length>5?\"userIDList.length:\".concat(e.userIDList.length):\"userIDList:\".concat(e.userIDList)),Ve.l(\"\".concat(o,\" groupID:\").concat(e.groupID,\" userIDList:\").concat(e.userIDList.join(\",\"))),e.userIDList.length>50&&(e.userIDList=e.userIDList.slice(0,50));var a=e.groupID,i=e.userIDList;return this._getGroupMemberProfileAdvance(t(t({},e),{},{userIDList:i})).then((function(e){var t=e.data.members;return at(t)&&0!==t.length?(n._updateLocalGroupMemberMap(a,t),n.getModule(Gn).getUserProfile({userIDList:t.map((function(e){return e.userID})),tagList:[He.NICK,He.AVATAR]})):Xa([])})).then((function(e){var t=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));n._updateLocalGroupMemberMap(a,t);var o=i.filter((function(e){return n.hasLocalGroupMember(a,e)})).map((function(e){return n.getLocalGroupMemberInfo(a,e)}));return s.setNetworkType(n.getNetworkType()).end(),Ya({memberList:o})}))}},{key:\"addGroupMember\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"addGroupMember\"),o=e.groupID,s=this.getModule(Pn).getLocalGroupProfile(o),a=s.type,i=new Aa(\"addGroupMember\");if(i.setMessage(\"groupID:\".concat(o,\" groupType:\").concat(a)),Tt(a)){var r=new ja({code:ha.CANNOT_ADD_MEMBER_IN_AVCHATROOM});return i.setError(r,!0,this.getNetworkType()).end(),Za(r)}return e.userIDList=e.userIDList.map((function(e){return{userID:e}})),Ve.l(\"\".concat(n,\" groupID:\").concat(o)),this.request({protocolName:Us,requestData:e}).then((function(o){var a=o.data.members;Ve.l(\"\".concat(n,\" ok\"));var r=a.filter((function(e){return 1===e.result})).map((function(e){return e.userID})),u=a.filter((function(e){return 0===e.result})).map((function(e){return e.userID})),c=a.filter((function(e){return 2===e.result})).map((function(e){return e.userID})),l=a.filter((function(e){return 4===e.result})).map((function(e){return e.userID})),d=\"groupID:\".concat(e.groupID,\", \")+\"successUserIDList:\".concat(r,\", \")+\"failureUserIDList:\".concat(u,\", \")+\"existedUserIDList:\".concat(c,\", \")+\"overLimitUserIDList:\".concat(l);return i.setNetworkType(t.getNetworkType()).setMoreMessage(d).end(),0===r.length?Ya({successUserIDList:r,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l}):(s.memberCount+=r.length,t._updateConversationGroupProfile(s),Ya({successUserIDList:r,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l,group:s}))})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"deleteGroupMember\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"deleteGroupMember\"),o=e.groupID,s=e.userIDList,a=this.getModule(Pn).getLocalGroupProfile(o);if(it(a))return Za({code:ha.CANNOT_FIND_GROUP});if(Tt(a.type))return this.canIUse(B.AVCHATROOM_BAN_MBR)?this._banAVChatRoomMember(e):Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var i=new Aa(\"deleteGroupMember\"),r=\"groupID:\".concat(o,\" \").concat(s.length>5?\"userIDList.length:\".concat(s.length):\"userIDList:\".concat(s));return i.setMessage(r),Ve.l(\"\".concat(n,\" groupID:\").concat(o,\" userIDList:\"),s),this.request({protocolName:Ps,requestData:e}).then((function(){return i.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),a.memberCount-=1,t._updateConversationGroupProfile(a),t.deleteLocalGroupMembers(o,s),Ya({group:a,userIDList:s})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_updateConversationGroupProfile\",value:function(e){this.getModule(qn).updateConversationGroupProfile([e])}},{key:\"_banAVChatRoomMember\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"deleteGroupMember\"),o=e.groupID,s=e.userIDList,a=\"groupID:\".concat(o,\" \").concat(s.length>5?\"userIDList.length:\".concat(s.length):\"userIDList:\".concat(s)),i=new Aa(\"deleteGroupMember\");i.setMessage(a),Ve.l(\"\".concat(n,\" groupID:\").concat(o,\" userIDList:\"),s);var r=this.getModule(Pn).getLocalGroupProfile(o);return it(e.duration)||0===e.duration?Za({code:ha.BAN_DURATION_INVALID}):this.request({protocolName:bs,requestData:e}).then((function(){return i.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),t.deleteLocalGroupMembers(o,s),Ya({group:r,userIDList:s})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"setGroupMemberMuteTime\",value:function(e){var t=this,n=e.groupID,o=e.userID,s=e.muteTime,a=\"\".concat(this._n,\".\").concat(\"setGroupMemberMuteTime\");if(o===this.getMyUserID())return Za(new ja({code:ha.CANNOT_MUTE_SELF}));Ve.l(\"\".concat(a,\" groupID:\").concat(n,\" userID:\").concat(o));var i=new Aa(\"setGroupMemberMuteTime\");return i.setMessage(\"groupID:\".concat(n,\" userID:\").concat(o,\" muteTime:\").concat(s)),this.modifyGroupMemberInfo({groupID:n,userID:o,muteTime:s}).then((function(e){i.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(a,\" ok\"));var o=t.getModule(Pn);return Ya({group:o.getLocalGroupProfile(n),member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(a,\" failed. error:\"),e),Za(e)}))}},{key:\"setGroupMemberRole\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"setGroupMemberRole\"),o=e.groupID,s=e.userID,a=e.role,i=this.getModule(Pn).getLocalGroupProfile(o);if(i.selfInfo.role!==E.GRP_MBR_ROLE_OWNER)return Za({code:ha.NOT_OWNER});if([E.GRP_WORK,E.GRP_AVCHATROOM].includes(i.type))return Za({code:ha.CANNOT_SET_MEMBER_ROLE_IN_WORK_AND_AVCHATROOM});var r=[E.GRP_MBR_ROLE_ADMIN,E.GRP_MBR_ROLE_MEMBER];if(Dt({groupID:o})&&r.push(E.GRP_MBR_ROLE_CUSTOM),r.indexOf(a)<0)return Za({code:ha.INVALID_MEMBER_ROLE});if(s===this.getMyUserID())return Za({code:ha.CANNOT_SET_SELF_MEMBER_ROLE});var u=new Aa(\"setGroupMemberRole\");return u.setMessage(\"groupID:\".concat(o,\" userID:\").concat(s,\" role:\").concat(a)),Ve.l(\"\".concat(n,\" groupID:\").concat(o,\" userID:\").concat(s)),this.modifyGroupMemberInfo({groupID:o,userID:s,role:a}).then((function(e){return u.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\")),Ya({group:i,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_filterProfanity\",value:function(e,t){var n=this.getModule(oo);if(!n)return!0;var o=n.filterText(t[e],J),s=o.isAllowedToSend,a=o.modifiedText;return!0===s&&(t[e]=a,!0)}},{key:\"setGroupMemberNameCard\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"setGroupMemberNameCard\");if(e.nameCard&&!1===this._filterProfanity(\"nameCard\",e))return Za({code:ha.PROFANITY_FOUND});var o=e.groupID,s=e.userID,a=void 0===s?this.getMyUserID():s,i=e.nameCard;Ve.l(\"\".concat(n,\" groupID:\").concat(o,\" userID:\").concat(a));var r=new Aa(\"setGroupMemberNameCard\");return r.setMessage(\"groupID:\".concat(o,\" userID:\").concat(a,\" nameCard:\").concat(i)),this.modifyGroupMemberInfo({groupID:o,userID:a,nameCard:i}).then((function(e){Ve.l(\"\".concat(n,\" ok\")),r.setNetworkType(t.getNetworkType()).end();var s=t.getModule(Pn).getLocalGroupProfile(o);return a===t.getMyUserID()&&s&&s.setSelfNameCard(i),Ya({group:s,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];r.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"setGroupMemberCustomField\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"setGroupMemberCustomField\"),o=e.groupID,s=e.userID,a=void 0===s?this.getMyUserID():s,i=e.memberCustomField;Ve.l(\"\".concat(n,\" groupID:\").concat(o,\" userID:\").concat(a));var r=new Aa(\"setGroupMemberCustomField\");return r.setMessage(\"groupID:\".concat(o,\" userID:\").concat(a,\" memberCustomField:\").concat(JSON.stringify(i))),this.modifyGroupMemberInfo({groupID:o,userID:a,memberCustomField:i}).then((function(e){r.setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" ok\"));var s=t.getModule(Pn).getLocalGroupProfile(o);return Ya({group:s,member:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];r.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"modifyGroupMemberInfo\",value:function(e){var n=this,o=e.groupID,s=e.userID,a=void 0;return kt(o)&&(o=xt(a=o)),this.request({protocolName:ws,requestData:t(t({},e),{},{groupID:o,topicID:a})}).then((function(){if(n.hasLocalGroupMember(o,s)){var t=n.getLocalGroupMemberInfo(o,s);return it(e.muteTime)||t.updateMuteUntil(e.muteTime),it(e.role)||t.updateRole(e.role),it(e.nameCard)||t.updateNameCard(e.nameCard),it(e.memberCustomField)||t.updateMemberCustomField(e.memberCustomField),t}return n.getGroupMemberProfile({groupID:o,userIDList:[s]}).then((function(e){return v(e.data.memberList,1)[0]}))}))}},{key:\"markGroupMemberList\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"markGroupMemberList\"),o=e.groupID,s=e.markType,a=e.enableMark,i=e.userIDList,r=void 0===i?[]:i,u=\"groupID:\".concat(o,\" markType:\").concat(s,\" enableMark:\").concat(a,\" userIDList count: \").concat(r.length);Ve.l(\"\".concat(n,\" \").concat(u));var c=2,l=[];!0===a&&(c=1);var d=m(r);r.length>500&&(d=r.slice(0,500),Ve.w(\"\".concat(n,\" \").concat(Wt(500)))),d.forEach((function(e){l.push({userID:e,markType:[s]})})),d=null;var p=new Aa(\"markGroupMemberList\");return p.setMessage(\"\".concat(u)),this.request({protocolName:Fs,requestData:{groupID:o,operationType:c,memberList:l}}).then((function(e){var o=e.data.memberList,s=void 0===o?[]:o,a=[],i=[];s.length===r.length?a.push.apply(a,m(r)):(s.forEach((function(e){a.push(e.userID)})),r.forEach((function(e){a.includes(e)||i.push(e)})));var u=\"success count:\".concat(a.length,\" fail count:\").concat(i.length);return p.setNetworkType(t.getNetworkType()).setMessage(u).end(),Ve.l(\"\".concat(n,\" ok. \").concat(u)),Ya({successUserIDList:a,failureUserIDList:i})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];p.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_getGroupMemberProfileAdvance\",value:function(e){return this.request({protocolName:Gs,requestData:t(t({},e),{},{memberInfoFilter:e.memberInfoFilter?e.memberInfoFilter:[\"Role\",\"JoinTime\",\"NameCard\",\"ShutUpUntil\"]})})}},{key:\"_updateLocalGroupMemberMap\",value:function(e,t){var n=this;return at(t)&&0!==t.length?t.map((function(t){return n.hasLocalGroupMember(e,t.userID)?n.getLocalGroupMemberInfo(e,t.userID).updateMember(t):n.setLocalGroupMember(e,new xi(t)),n.getLocalGroupMemberInfo(e,t.userID)})):[]}},{key:\"deleteLocalGroupMembers\",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach((function(e){n.delete(e)}))}},{key:\"getLocalGroupMemberInfo\",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:\"setLocalGroupMember\",value:function(e,t){if(this.groupMemberListMap.has(e))this.groupMemberListMap.get(e).set(t.userID,t);else{var n=(new Map).set(t.userID,t);this.groupMemberListMap.set(e,n)}}},{key:\"getLocalGroupMemberList\",value:function(e){return this.groupMemberListMap.get(e)}},{key:\"hasLocalGroupMember\",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:\"hasLocalGroupMemberMap\",value:function(e){return this.groupMemberListMap.has(e)}},{key:\"reset\",value:function(){this.groupMemberListMap.clear()}}]),s}(uo),Bi=[\"topicID\",\"topicName\",\"avatar\",\"introduction\",\"notification\",\"unreadCount\",\"muteAllMembers\",\"customData\",\"groupAtInfoList\",\"nextMessageSeq\",\"selfInfo\"],Hi=function(e,t){return zt(e)?{lastTime:0,lastSequence:0,fromAccount:\"\",payload:null,type:\"\",messageForShow:\"\",nick:\"\",version:0,cloudCustomData:\"\",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||\"\",payload:e.payload||null,type:e.type||\"\",messageForShow:Vt(e.type,e.payload,t),nick:e.nick||\"\",version:e.version||0,cloudCustomData:e.cloudCustomData||\"\",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}},Ki=function(){function e(t,n){o(this,e),this.topicID=\"\",this.topicName=\"\",this.avatar=\"\",this.introduction=\"\",this.notification=\"\",this.unreadCount=0,this.muteAllMembers=!1,this.customData=\"\",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=Hi(t.lastMessage,n),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:\"\",excludedUnreadSequenceList:void 0},this._initTopic(t)}return a(e,[{key:\"_initTopic\",value:function(e){for(var t in e)Bi.indexOf(t)<0||(\"selfInfo\"===t?this.updateSelfInfo(e[t]):this[t]=\"muteAllMembers\"===t?1===e[t]:e[t])}},{key:\"updateUnreadCount\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.unreadCount=e}},{key:\"updateNextMessageSeq\",value:function(e){this.nextMessageSeq=e}},{key:\"updateLastMessage\",value:function(e){this.lastMessage=Hi(e)}},{key:\"updateGroupAtInfoList\",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:\"updateTopic\",value:function(e){it(e.selfInfo)||this.updateSelfInfo(e.selfInfo),it(e.muteAllMembers)||(this.muteAllMembers=1===e.muteAllMembers),pt(this,e,[\"groupID\",\"lastMessageTime\",\"selfInfo\",\"muteAllMembers\",\"lastMsg\"])}},{key:\"updateSelfInfo\",value:function(e){return 0!==pt(this.selfInfo,e,[],[\"\"])}},{key:\"reduceUnreadCount\",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:\"isLastMessageRevoked\",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:\"setLastMessageRevoked\",value:function(e){this.lastMessage.isRevoked=e}},{key:\"setLastMessageRevoker\",value:function(e){this.lastMessage.revoker=e}}]),e}(),Wi=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"TopicModule\",t._topicMap=new Map,t._getTopicTimeMap=new Map,t.TOPIC_CACHE_TIME=300,t.TOPIC_LAST_ACTIVE_TIME=3600,t.getInnerEmitterInstance().on(ti,t._onCloudConfigUpdated,h(t)),t}return a(s,[{key:\"_onCloudConfigUpdated\",value:function(){var e=this.getCloudConfig(\"topic_cache_time\"),t=this.getCloudConfig(\"topic_last_active_time\");it(e)||(this.TOPIC_CACHE_TIME=Number(e)),it(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:\"onTopicCreated\",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOuterEvent(k.TOPIC_CREATED,e)}},{key:\"onTopicDeleted\",value:function(e){var t=this,n=e.groupID,o=e.topicIDList;(void 0===o?[]:o).forEach((function(e){t._deleteLocalTopic(n,e)})),this.emitOuterEvent(k.TOPIC_DELETED,e)}},{key:\"onTopicMessageRemindTypeUpdated\",value:function(e){var t=e.groupID,n=e.topicID,o=e.messageRemindType,s=this.getLocalTopic(t,n);if(s){var a=s.updateSelfInfo({messageRemindType:o});a&&this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:t,topic:s}),Ve.d(\"\".concat(this._n,\".onTopicMessageRemindTypeUpdated topicID:\").concat(n)+\" messageRemindType:\".concat(o,\" isTopicUpdated:\").concat(a))}}},{key:\"onTopicProfileUpdated\",value:function(e){var t=e.groupID,n=e.topicID,o=this.getLocalTopic(t,n);o&&(o.updateTopic(e),this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:t,topic:o}))}},{key:\"onConversationProxy\",value:function(e){var t=e.topicID,n=e.unreadCount,o=e.groupAtInfoList,s=xt(t),a=this.getLocalTopic(s,t),i=!1;a&&(it(n)||a.unreadCount===n||(a.updateUnreadCount(n),i=!0),it(o)||(a.updateGroupAtInfoList(o),i=!0)),i&&this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:s,topic:a})}},{key:\"onMessageSent\",value:function(e){var t=e.groupID,n=e.topicID,o=e.lastMessage,s=this.getLocalTopic(t,n);s&&(s.nextMessageSeq+=1,s.updateLastMessage(o),this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:t,topic:s}))}},{key:\"onMessageModified\",value:function(e){var t=e.to,n=e.time,o=e.sequence,s=e.elements,a=e.cloudCustomData,i=e.messageVersion,r=xt(t),u=this.getLocalTopic(r,t);if(u){var c=u.lastMessage;Ve.d(\"\".concat(this._n,\".onMessageModified topicID:\").concat(t,\" lastMessage:\"),JSON.stringify(c),\"options:\",JSON.stringify(e)),c&&(null===c.payload||c.lastTime===n&&c.lastSequence===o&&c.version!==i)&&(c.type=s[0].type,c.payload=s[0].content,c.messageForShow=Vt(c.type,c.payload,this.isIntl()),c.cloudCustomData=a,c.version=i,c.lastSequence=o,c.lastTime=n,this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:r,topic:u}))}}},{key:\"onMessageRevoked\",value:function(e){var t=this;if(0!==e.length){var n=null,o=null,s=!1;e.forEach((function(e){var a=e.to;o=xt(a),(n=t.getLocalTopic(o,a))&&(n.reduceUnreadCount()&&(s=!0),n.isLastMessageRevoked(e)&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),s=!0))})),s&&this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:o,topic:n})}}},{key:\"isLastMessageRevoked\",value:function(e){var t=e.topicID,n=e.sequence,o=xt(t),s=this.getLocalTopic(o,t),a=!1;return s&&(a=s.isLastMessageRevoked({sequence:n})),a}},{key:\"getJoinedCommunityList\",value:function(){return this.getModule(Pn).getGroupList({isGroupWithTopicOnly:!0}).then((function(e){var t=e.data.groupList;return Ya({groupList:void 0===t?[]:t})})).catch((function(e){return Za(e)}))}},{key:\"createTopicInCommunity\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"createTopicInCommunity\"),s=e.topicID;if(!it(s)&&!kt(s))return Za({code:ha.ILLEGAL_TOPIC_ID});if(e.topicName&&!1===this._filterProfanity(\"topicName\",e))return Za({code:ha.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity(\"introduction\",e))return Za({code:ha.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity(\"notification\",e))return Za({code:ha.PROFANITY_FOUND});var a=new Aa(\"createTopicInCommunity\");return this.request({protocolName:ta,requestData:t({},e)}).then((function(s){var i=s.data.topicID;return a.setMessage(\"topicID:\".concat(i)).setNetworkType(n.getNetworkType()).end(),Ve.l(\"\".concat(o,\" ok\")),n._updateTopicMap([t(t({},e),{},{topicID:i})]),Ya({topicID:i})})).catch((function(e){return n.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];a.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"deleteTopicFromCommunity\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"deleteTopicFromCommunity\"),o=e.groupID,s=e.topicIDList,a=void 0===s?[]:s,i=new Aa(\"deleteTopicFromCommunity\");return i.setMessage(\"groupID:\".concat(o,\" topicIDList:\").concat(a)),this.request({protocolName:na,requestData:{groupID:o,topicIDList:a}}).then((function(e){var n=e.data.resultList,s=[],a=[];(void 0===n?[]:n).forEach((function(e){var t=e.topicID,n=e.errorCode,o=e.errorInfo;0===n?s.push({topicID:t}):a.push({topicID:t,code:n,message:o})}));var r=\"success count:\".concat(s.length,\", fail count:\").concat(a.length);return i.setMoreMessage(\"\".concat(r)).setNetworkType(t.getNetworkType()).end(),Ve.l(\"\".concat(r)),s.forEach((function(e){t._deleteLocalTopic(o,e.topicID)})),Ya({successTopicList:s,failureTopicList:a})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"updateTopicProfile\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"updateTopicProfile\");if(Ve.l(\"\".concat(o,\" options:\"),e),e.topicName&&!1===this._filterProfanity(\"topicName\",e))return Za({code:ha.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity(\"introduction\",e))return Za({code:ha.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity(\"notification\",e))return Za({code:ha.PROFANITY_FOUND});var s=new Aa(\"updateTopicProfile\");return s.setMessage(\"groupID:\".concat(e.groupID,\" topicID:\").concat(e.topicID)),it(e.muteAllMembers)||(e.muteAllMembers=!0===e.muteAllMembers?\"On\":\"Off\"),this.request({protocolName:oa,requestData:t({},e)}).then((function(){return s.setNetworkType(n.getNetworkType()).end(),Ve.l(\"\".concat(o,\" ok\")),n._updateTopicMap([e]),Ya({topic:n.getLocalTopic(e.groupID,e.topicID)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];s.setError(e,o,a).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"getTopicList\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"getTopicList\"),s=e.groupID,a=e.topicIDList,i=void 0===a?[]:a,r=0===i.length,u=new Aa(\"getTopicList\");if(u.setMessage(\"groupID:\".concat(s)),this._getTopicTimeMap.has(s)){var c=this._getTopicTimeMap.get(s),l=c.isGetAll,d=c.time;if((l||!l&&!r)&&Date.now()-d<1e3*this.TOPIC_CACHE_TIME){var p=this._getLocalTopicList(s,i);if(r||p.length===i.length)return u.setNetworkType(this.getNetworkType()).setMoreMessage(\"from cache, topic count:\".concat(p.length)).end(),Ve.l(\"\".concat(o,\" groupID:\").concat(s,\" from cache, topic count:\").concat(p.length)),Xa({successTopicList:p,failureTopicList:[]})}}return this.request({protocolName:sa,requestData:{groupID:s,topicIDList:i}}).then((function(e){var a=e.data.topicInfoList,i=[],c=[],l=[];(void 0===a?[]:a).forEach((function(e){var n=e.topic,o=e.selfInfo,s=e.errorCode,a=e.errorInfo,r=n.topicID;0===s?(i.push(t(t({},n),{},{selfInfo:o})),c.push(r)):l.push({topicID:r,code:s,message:a})})),n._updateTopicMap(i),n._handleTopicAtInfo(i);var d=\"success count:\".concat(c.length,\", fail count:\").concat(l.length);u.setNetworkType(n.getNetworkType()).setMoreMessage(\"\".concat(d)).end(),Ve.l(\"\".concat(o,\" groupID:\").concat(s,\" from remote, \").concat(d));var p=[];return zt(c)||(n._getTopicTimeMap.set(s,{time:Date.now(),isGetAll:r}),p=n._getLocalTopicList(s,c)),Ya({successTopicList:p,failureTopicList:l})})).catch((function(e){return n.probeNetwork(e).then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"hasLocalTopic\",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:\"getLocalTopic\",value:function(e,t){var n=null;return this._topicMap.has(e)&&(n=this._topicMap.get(e).get(t)),n}},{key:\"_getLocalTopicList\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this._topicMap.get(e),o=[];return n&&(o=m(n.values())),0===t.length?o:o.filter((function(e){return t.includes(e.topicID)}))}},{key:\"_deleteLocalTopic\",value:function(e,t){this._topicMap.has(e)&&(this._topicMap.get(e).delete(t),Ve.l(\"\".concat(this._n,\"._deleteLocalTopic groupID:\").concat(e,\" topicID:\").concat(t)))}},{key:\"_updateTopicMap\",value:function(e){var t=this,n=[];(e.forEach((function(e){var o=e.groupID,s=e.topicID,a=null;t._topicMap.has(o)||t._topicMap.set(o,new Map),t._topicMap.get(o).has(s)?(a=t._topicMap.get(o).get(s)).updateTopic(e):(t._getTopicLastMessage(e),a=new Ki(e,t.isIntl()),t._topicMap.get(o).set(s,a));var i=t._computeUnreadCount(a);a.updateUnreadCount(i),n.push({conversationID:\"\".concat(E.CONV_GROUP).concat(s),type:E.CONV_TOPIC,unreadCount:i})})),n.length>0)&&this.getModule(qn).updateTopicConversation(n)}},{key:\"resetGetTopicTime\",value:function(e){var t=this;it(e)?m(this._getTopicTimeMap.keys()).forEach((function(e){t._getTopicTimeMap.set(e,0)})):this._getTopicTimeMap.set(e,0)}},{key:\"getTopicListOnReconnected\",value:function(){var e=this,t=m(this._topicMap.keys()),n=[];t.forEach((function(t){var o=[];e._getLocalTopicList(t).forEach((function(t){var n=t.lastMessage.lastTime,s=void 0===n?0:n;Date.now()-1e3*s<1e3*e.TOPIC_LAST_ACTIVE_TIME&&o.push(t.topicID)})),o.length>0&&n.push({groupID:t,topicIDList:o})})),Ve.l(\"\".concat(this._n,\".getTopicListOnReconnected. active community count:\").concat(n.length)),this._relayGetTopicList(n)}},{key:\"_relayGetTopicList\",value:function(e){var t=this;if(0!==e.length){var n=e.shift(),o=n.topicIDList.length>5?\"topicIDList.length:\".concat(n.topicIDList.length):\"topicIDList:\".concat(n.topicIDList),s=new Aa(\"relayGetTopicList\");s.setMessage(o),Ve.l(\"\".concat(this._n,\"._relayGetTopicList. \").concat(o)),this.getTopicList(n).then((function(){s.setNetworkType(t.getNetworkType()).end(),t._relayGetTopicList(e)})).catch((function(n){t.probeNetwork().then((function(e){var t=v(e,2),o=t[0],a=t[1];s.setError(n,o,a).end()})),t._relayGetTopicList(e)}))}}},{key:\"_handleTopicAtInfo\",value:function(e){var n=this;0!==e.length&&e.forEach((function(e){var o=e.groupID,s=e.topicID,a=e.groupAtInfoList,i=[];it(a)||(a.forEach((function(e){i.push(t(t({},e),{},{groupID:o,topicID:s}))})),n.getModule(qn).onNewGroupAtTips({dataList:i}))}))}},{key:\"_getTopicLastMessage\",value:function(e){if(!it(e.lastMsg)){var t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:\"\",nick:e.lastMsg.nick,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:2===e.lastMsg.isPlaceMessage,revoker:zt(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker};e.lastMessage=t}}},{key:\"deleteTopicListInCommunity\",value:function(e){var t=this,n=this._getLocalTopicList(e),o=this.getModule(qn);n.forEach((function(n){var s=n.topicID;t._deleteLocalTopic(e,s),t._getTopicTimeMap.delete(e),o.deleteLocalConversation(\"\".concat(E.CONV_GROUP).concat(s))}))}},{key:\"_computeUnreadCount\",value:function(e){var t=e.selfInfo,n=t.excludedUnreadSequenceList,o=t.readedSequence,s=e.nextMessageSeq-e.selfInfo.readedSequence-1;if(at(n)){var a=0;n.forEach((function(t){t>=o&&t<=e.nextMessageSeq-1&&(a+=1)})),a>=1&&(s-=a)}return s<0?0:s}},{key:\"_filterProfanity\",value:function(e,t){var n=this.getModule(oo);if(!n)return!0;var o=n.filterText(t[e],z),s=o.isAllowedToSend,a=o.modifiedText;return!0===s&&(t[e]=a,!0)}},{key:\"updateLastMessage\",value:function(e,t){var n=xt(e),o=this.getLocalTopic(n,e);if(o){var s=t.sequence+1;o.updateNextMessageSeq(s),o.updateLastMessage(t),this.emitOuterEvent(k.TOPIC_UPDATED,{groupID:n,topic:o})}}},{key:\"getMessageExtensions\",value:function(e,t){Ve.l(\"\".concat(this._n,\".getMessageExtensions startSequence:\").concat(t));var n=xt(e.to);return this.request({protocolName:Ss,requestData:{groupID:n,topicID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:\"modifyMessageExtensions\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Ve.l(\"\".concat(this._n,\".modifyMessageExtensions operateType:\").concat(n));var o=xt(e.to);return this.request({protocolName:Es,requestData:{groupID:o,topicID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),s}(uo),Yi=function(){function e(t){o(this,e),this._userModule=t,this._n=\"ProfileHandler\",this.TAG=\"profile\",this.accountProfileMap=new Map,this.expirationTime=864e5}return a(e,[{key:\"setExpirationTime\",value:function(e){this.expirationTime=e}},{key:\"getUserProfile\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"getUserProfile\"),o=e.userIDList;e.fromAccount=this._userModule.getMyAccount(),o.length>100&&(Ve.w(\"\".concat(n,\" \").concat(Wt(100))),o.length=100);for(var s,a=[],i=[],r=0,u=o.length;r<u;r++)s=o[r],this._userModule.isMyFriend(s)&&this._contains(s)?i.push(this._getProfileFromMap(s)):a.push(s);if(0===a.length)return Xa(i);e.toAccount=a;var c=e.bFromGetMyProfile||!1,l=[];e.toAccount.forEach((function(e){l.push({toAccount:e,standardSequence:0,customSequence:0})})),e.userItem=l;var d=new Aa(\"getUserProfile\");return d.setMessage(o.length>5?\"userIDList.length:\".concat(o.length):\"userIDList:\".concat(o)),this._userModule.request({protocolName:mo,requestData:e}).then((function(e){d.setNetworkType(t._userModule.getNetworkType()).end(),Ve.i(\"\".concat(n,\" ok\"));var o=t._handleResponse(e).concat(i);return Ya(c?o[0]:o)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];d.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"getMyProfile\",value:function(){var e=this._userModule.getMyAccount(),t=\"\".concat(this._n,\".getMyProfile\");if(Ve.l(\"\".concat(t,\" myAccount:\").concat(e)),this._fill(),this._contains(e)){var n=this._getProfileFromMap(e);return Ve.d(\"\".concat(t,\" from cache, myProfile:\").concat(JSON.stringify(n))),Xa(n)}return this.getUserProfile({fromAccount:e,userIDList:[e],bFromGetMyProfile:!0})}},{key:\"_handleResponse\",value:function(e){var t=e.data.userProfileItem;if(!at(t))return[];for(var n=[],o=Date.now(),s=0,a=t.length;s<a;s++){var i=t[s],r=i.to,u=i.profileItem;if(\"@TLS#NOT_FOUND\"!==r&&\"\"!==r){var c=this._update(r,this._getLatestProfileFromResponse(r,u)).latestProfile;n.push(c)}}return Ve.l(\"\".concat(this._n,\"._handleResponse cost \").concat(Date.now()-o,\" ms\")),n}},{key:\"_getLatestProfileFromResponse\",value:function(e,t){var n={userID:e,profileCustomField:[]};if(!zt(t))for(var o=0,s=t.length;o<s;o++)if(t[o].tag.indexOf(\"Tag_Profile_Custom\")>-1)n.profileCustomField.push({key:t[o].tag,value:t[o].value});else switch(t[o].tag){case He.NICK:n.nick=t[o].value;break;case He.GENDER:n.gender=t[o].value;break;case He.BIRTHDAY:n.birthday=t[o].value;break;case He.LOCATION:n.location=t[o].value;break;case He.SELFSIGNATURE:n.selfSignature=t[o].value;break;case He.ALLOWTYPE:n.allowType=t[o].value;break;case He.LANGUAGE:n.language=t[o].value;break;case He.AVATAR:n.avatar=t[o].value;break;case He.MESSAGESETTINGS:n.messageSettings=t[o].value;break;case He.ADMINFORBIDTYPE:n.adminForbidType=t[o].value;break;case He.LEVEL:n.level=t[o].value;break;case He.ROLE:n.role=t[o].value;break;default:Ve.w(\"\".concat(this._n,\"._getLatestProfileFromResponse unknown tag:\"),t[o].tag,t[o].value)}return n}},{key:\"updateMyProfile\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"updateMyProfile\");if(e.nick&&!1===this._userModule.filterProfanity(\"nick\",e))return Za({code:ha.PROFANITY_FOUND});if(e.selfSignature&&!1===this._userModule.filterProfanity(\"selfSignature\",e))return Za({code:ha.PROFANITY_FOUND});var o=new Aa(\"updateMyProfile\");o.setMessage(JSON.stringify(e));var s=(new li).validate(e);if(!s.valid)return o.setCode(ha.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage(\"info:\".concat(s.tips)).setNetworkType(this._userModule.getNetworkType()).end(),Ve.e(\"\".concat(n,\" info:\").concat(s.tips)),Za({code:ha.UPDATE_PROFILE_INVALID_PARAM});var a=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(\"profileCustomField\"===i?e.profileCustomField.forEach((function(e){a.push({tag:e.key,value:e.value})})):a.push({tag:He[i.toUpperCase()],value:e[i]}));if(0===a.length){var r=new ja({code:ha.UPDATE_PROFILE_NO_KEY});return o.setError(r,!0,this._userModule.getNetworkType()).end(),Ve.e(\"\".concat(n,\" failed. error:\"),r),Za(r)}var u=this._userModule.getMyAccount();return this._userModule.request({protocolName:Mo,requestData:{fromAccount:u,profileItem:a}}).then((function(s){o.setNetworkType(t._userModule.getNetworkType()).end(),Ve.i(\"\".concat(n,\" ok\"));var a=t._update(u,e),i=a.isProfileUpdated,r=a.latestProfile;return!0===i&&t._userModule.emitOuterEvent(k.PROFILE_UPDATED,[r]),Xa(r)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"onProfileModified\",value:function(e){var t=e.dataList;if(!zt(t)){var n,o=t.length;Ve.d(\"\".concat(this._n,\".onProfileModified count:\").concat(o,\" dataList:\"),e.dataList);for(var s=[],a=0;a<o;a++){n=t[a].userID;var i=this._update(n,this._getLatestProfileFromResponse(n,t[a].profileList)),r=i.isProfileUpdated,u=i.latestProfile;!0===r&&s.push(u)}s.length>0&&(this._userModule.emitInnerEvent(ni,s),this._userModule.emitOuterEvent(k.PROFILE_UPDATED,s))}}},{key:\"_fill\",value:function(){if(0===this.accountProfileMap.size){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,o=e.length;n<o;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);Ve.l(\"\".concat(this._n,\"._fill from cache, size:\").concat(this.accountProfileMap.size))}}},{key:\"_update\",value:function(e,t){var n,o=!1,s=Date.now();this._contains(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&!0===Ct(n.profileCustomField,t.profileCustomField)&&(n.lastUpdatedTime=s,o=!0),pt(n,t,[\"profileCustomField\"])>0&&(n.lastUpdatedTime=s,o=!0)):(n=new li(t),(this._userModule.isMyFriend(e)||e===this._userModule.getMyAccount())&&(n.lastUpdatedTime=s,o=!0,this.accountProfileMap.set(e,n)));return this._flush(e===this._userModule.getMyAccount()),Ve.l(\"\".concat(this._n,\"._update account:\").concat(e,\" isProfileUpdated:\").concat(o)),{isProfileUpdated:o,latestProfile:n}}},{key:\"_flush\",value:function(e){var t=m(this.accountProfileMap.values()),n=this._userModule.getStorageModule();Ve.d(\"\".concat(this._n,\"._flush length:\").concat(t.length,\" flushAtOnce:\").concat(e)),n.setItem(this.TAG,t,e)}},{key:\"_contains\",value:function(e){return this.accountProfileMap.has(e)}},{key:\"_getProfileFromMap\",value:function(e){return this.accountProfileMap.get(e)}},{key:\"_getCachedProfiles\",value:function(){var e=this._userModule.getStorageModule().getItem(this.TAG);return zt(e)?[]:e}},{key:\"onConversationsProfileUpdated\",value:function(e){for(var t,n,o,s=[],a=0,i=e.length;a<i;a++)n=(t=e[a]).userID,this._userModule.isMyFriend(n)&&(this._contains(n)?(o=this._getProfileFromMap(n),pt(o,t)>0&&s.push(n)):s.push(t.userID));0!==s.length&&(Ve.i(\"\".concat(this._n,\".onConversationsProfileUpdated toAccountList:\").concat(s)),this.getUserProfile({userIDList:s}))}},{key:\"getNickAndAvatarByUserID\",value:function(e){if(this._contains(e)){var t=this._getProfileFromMap(e);return{nick:t.nick,avatar:t.avatar}}return{nick:\"\",avatar:\"\"}}},{key:\"reset\",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),e}(),ji=a((function e(t){o(this,e),zt||(this.userID=t.userID||\"\",this.timeStamp=t.timeStamp||0)})),zi=function(){function e(t){o(this,e),this._userModule=t,this._n=\"BlacklistHandler\",this._blacklistMap=new Map,this.startIndex=0,this.maxLimited=100,this.currentSequence=0}return a(e,[{key:\"getLocalBlacklist\",value:function(){return m(this._blacklistMap.keys())}},{key:\"getBlacklist\",value:function(){var e=this,t=\"\".concat(this._n,\".getBlacklist\"),n={fromAccount:this._userModule.getMyAccount(),maxLimited:this.maxLimited,startIndex:0,lastSequence:this.currentSequence},o=new Aa(\"getBlacklist\");return this._userModule.request({protocolName:yo,requestData:n}).then((function(n){var s=n.data,a=s.blackListItem,i=s.currentSequence,r=zt(a)?0:a.length;o.setNetworkType(e._userModule.getNetworkType()).setMessage(\"count:\".concat(r)).end(),Ve.i(\"\".concat(t,\" ok\")),e.currentSequence=i,e._handleResponse(a,!0),e._userModule.emitOuterEvent(k.BLACKLIST_UPDATED,m(e._blacklistMap.keys()))})).catch((function(n){return e._userModule.probeNetwork().then((function(e){var t=v(e,2),s=t[0],a=t[1];o.setError(n,s,a).end()})),Ve.e(\"\".concat(t,\" failed. error:\"),n),Za(n)}))}},{key:\"addBlacklist\",value:function(e){var t=this,n=new Aa(\"addToBlacklist\"),o=\"\".concat(this._n,\".addBlacklist\"),s=this._userModule.getMyAccount();if(1===e.userIDList.length&&e.userIDList[0]===s){var a=ha.CANNOT_ADD_SELF_TO_BLACKLIST,i=this._userModule.getErrorMessage(a);n.setCode(a).setMessage(i).setNetworkType(this._userModule.getNetworkType()).end();var r=new ja({code:a});return Ve.e(\"\".concat(o,\" failed. error:\"),r),Za(r)}return e.userIDList.includes(s)&&(e.userIDList=e.userIDList.filter((function(e){return e!==s}))),e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Io,requestData:e}).then((function(s){return n.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?\"userIDList.length:\".concat(e.userIDList.length):\"userIDList:\".concat(e.userIDList)).end(),Ve.i(\"\".concat(o,\" ok\")),t._handleResponse(s.resultItem,!0),Ya(m(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var o=v(t,2),s=o[0],a=o[1];n.setError(e,s,a).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"_handleResponse\",value:function(e,t){if(!zt(e))for(var n,o,s,a=0,i=e.length;a<i;a++)o=e[a].to,s=e[a].resultCode,(it(s)||0===s)&&(t?((n=this._blacklistMap.has(o)?this._blacklistMap.get(o):new ji).userID=o,!zt(e[a].addBlackTimeStamp)&&(n.timeStamp=e[a].addBlackTimeStamp),this._blacklistMap.set(o,n)):this._blacklistMap.has(o)&&(n=this._blacklistMap.get(o),this._blacklistMap.delete(o)));Ve.l(\"\".concat(this._n,\"._handleResponse total:\").concat(this._blacklistMap.size,\" bAdd:\").concat(t))}},{key:\"deleteBlacklist\",value:function(e){var t=this,n=\"\".concat(this._n,\".deleteBlacklist\"),o=new Aa(\"removeFromBlacklist\");return e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Co,requestData:e}).then((function(s){return o.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?\"userIDList.length:\".concat(e.userIDList.length):\"userIDList:\".concat(e.userIDList)).end(),Ve.i(\"\".concat(n,\" ok\")),t._handleResponse(s.data.resultItem,!1),Ya(m(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"onAccountDeleted\",value:function(e){for(var t,n=[],o=0,s=e.length;o<s;o++)t=e[o],this._blacklistMap.has(t)&&(this._blacklistMap.delete(t),n.push(t));n.length>0&&(Ve.l(\"\".concat(this._n,\".onAccountDeleted count:\").concat(n.length,\" userIDList:\"),n),this._userModule.emitOuterEvent(k.BLACKLIST_UPDATED,m(this._blacklistMap.keys())))}},{key:\"onAccountAdded\",value:function(e){for(var t,n=[],o=0,s=e.length;o<s;o++)t=e[o],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new ji({userID:t})),n.push(t));n.length>0&&(Ve.l(\"\".concat(this._n,\".onAccountAdded count:\").concat(n.length,\" userIDList:\"),n),this._userModule.emitOuterEvent(k.BLACKLIST_UPDATED,m(this._blacklistMap.keys())))}},{key:\"reset\",value:function(){this._blacklistMap.clear(),this.startIndex=0,this.maxLimited=100,this.currentSequence=0}}]),e}(),Ji=function(e){var t=String(e).replace(/[=]+$/,\"\"),n=\"\";if(t.length%4==1)return\"\";for(var o,s,a=0,i=0;s=t.charAt(i++);~s&&(o=a%4?64*o+s:s,a++%4)?n+=String.fromCharCode(255&o>>(-2*a&6)):0)s=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\".indexOf(s);try{return decodeURIComponent(escape(n))}catch(r){return\"\"}},Xi=function(){function e(t){o(this,e),this._userModule=t,this._n=\"UserStatusHandler\",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userModule.getInnerEmitterInstance().on(ti,this._onCloudConfigUpdated,this)}return a(e,[{key:\"_onCloudConfigUpdated\",value:function(){var e=this._userModule.getCloudConfig(\"status_query_count\"),t=this._userModule.getCloudConfig(\"status_sub_count\"),n=this._userModule.getCloudConfig(\"status_unsub_count\");Ve.l(\"\".concat(this._n,\"._onCloudConfigUpdated statusQueryCount:\").concat(e,\" statusSubscribeCount:\").concat(t)+\" statusUnsubscribeCount:\".concat(n)),it(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),it(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),it(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:\"onUserStatusUpdated\",value:function(e){var t=e.dataList,n=this._userModule.getMyUserID(),o=this._userModule.getModule(xn),s=t.map((function(e){var t=e.to,s=e.statusType,a=e.customStatus,i=Ji(a);return t===n&&o.setCustomStatus(i),{userID:t,statusType:s,customStatus:i}}));this._userModule.emitOuterEvent(k.USER_STATUS_UPDATED,s)}},{key:\"setSelfStatus\",value:function(e){var t=this,n=\"\".concat(this._n,\".setSelfStatus\");if(!1===this._userModule.filterProfanity(\"customStatus\",e))return Za({code:ha.PROFANITY_FOUND});var o=new Aa(\"setSelfStatus\"),s=e.customStatus;return this._userModule.request({protocolName:aa,requestData:{customStatus:s}}).then((function(e){return o.setNetworkType(t._userModule.getNetworkType()).setMessage(\"customStatus:\".concat(s)).end(),Ve.l(\"\".concat(n,\" ok. customStatus:\").concat(s)),t._userModule.getModule(xn).setCustomStatus(s),Ya({userID:t._userModule.getMyUserID(),statusType:1,customStatus:s})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),s=n[0],a=n[1];o.setError(e,s,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"getUserStatus\",value:function(e){var t=this,n=\"\".concat(this._n,\".getUserStatus\"),o=e.userIDList,s=void 0===o?[]:o,a=this._userModule.getMyUserID(),i=m(s),r=void 0,u=i.indexOf(a);if(u>-1){i.splice(u,1);var c=this._userModule.getModule(xn).getCustomStatus();r={userID:a,statusType:1,customStatus:c}}if(0===i.length)return Xa({successUserList:[r],failureUserList:[]});if(!this._userModule.canIUse(B.USER_STATUS))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});i.length>this.MAX_QUERY_USER_COUNT&&(Ve.w(\"\".concat(n,\" \").concat(Wt(this.MAX_QUERY_USER_COUNT))),i=s.slice(0,this.MAX_QUERY_USER_COUNT));var l=new Aa(\"getUserStatus\");return this._userModule.request({protocolName:ia,requestData:{userIDList:i}}).then((function(e){var o=e.data,a=o.successUserList,i=void 0===a?[]:a,u=o.failureUserList,c=void 0===u?[]:u,d=i.map((function(e){var t=e.userID,n=e.statusType,o=e.customStatus;return{userID:t,statusType:n,customStatus:Ji(o)}})),p=c.map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,s=e.errorInfo;return{userID:zt(n)?t:n,code:o,message:s}}));it(r)||d.unshift(r);var g=\"userID count:\".concat(s.length,\", success count:\").concat(d.length,\", fail count:\").concat(p.length);return l.setNetworkType(t._userModule.getNetworkType()).setMessage(\"\".concat(g)).end(),Ve.l(\"\".concat(n,\" ok. \").concat(g,\".\")),Ya({successUserList:d,failureUserList:p})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],a=n[1];l.setMessage(\"userID count:\".concat(s.length)).setError(e,o,a).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"subscribeUserStatus\",value:function(e){var t=this;if(!this._userModule.canIUse(B.USER_STATUS))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".subscribeUserStatus\"),o=e.userIDList,s=void 0===o?[]:o,a=m(s);a.length>this.MAX_SUBSCRIBE_USER_COUNT&&(Ve.w(\"\".concat(n,\" \").concat(Wt(this.MAX_SUBSCRIBE_USER_COUNT))),a=s.slice(0,this.MAX_SUBSCRIBE_USER_COUNT));var i=new Aa(\"subscribeUserStatus\"),r=\"userID count:\".concat(s.length);return Ve.l(\"\".concat(n,\" \").concat(r)),this._userModule.request({protocolName:ra,requestData:{userIDList:a}}).then((function(e){var o=e.data.failureUserList,s=(void 0===o?[]:o).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,s=e.errorInfo;return{userID:zt(n)?t:n,code:o,message:s}}));return i.setNetworkType(t._userModule.getNetworkType()).setMessage(\"\".concat(r,\" fail count:\").concat(s.length)).end(),Ve.l(\"\".concat(n,\" ok. fail count:\").concat(s.length,\".\")),Ya({failureUserList:s})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setMessage(\"\".concat(r)).setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"unsubscribeUserStatus\",value:function(e){var t=this;if(!this._userModule.canIUse(B.USER_STATUS))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".unsubscribeUserStatus\"),o=(e||{}).userIDList,s=void 0===o?[]:o,a=m(s);s.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(Ve.w(\"\".concat(n,\" \").concat(Wt(this.MAX_UNSUBSCRIBE_USER_COUNT))),a=s.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT));var i=new Aa(\"unsubscribeUserStatus\"),r=\"userID count:\".concat(s.length);Ve.l(\"\".concat(n,\" \").concat(r));var u={userIDList:a};return 0===a.length&&(u.userIDList=void 0,u.unsubscribeAll=1),this._userModule.request({protocolName:ua,requestData:u}).then((function(e){var o=e.data.failureUserList,s=(void 0===o?[]:o).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode,s=e.errorInfo;return{userID:zt(n)?t:n,code:o,message:s}}));return i.setNetworkType(t._userModule.getNetworkType()).setMessage(\"\".concat(r,\" fail count:\").concat(s.length)).end(),Ve.l(\"\".concat(n,\" ok. fail count:\").concat(s.length,\".\")),Ya({failureUserList:s})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setMessage(\"\".concat(r)).setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"reset\",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),e}(),Zi=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"UserModule\",s._profileHandler=new Yi(h(s)),s._blacklistHandler=new zi(h(s)),s._userStatusHandler=new Xi(h(s)),s.getInnerEmitterInstance().on(ei,s.onContextUpdated,h(s)),s}return a(n,[{key:\"onContextUpdated\",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:\"onProfileModified\",value:function(e){this._profileHandler.onProfileModified(e)}},{key:\"onRelationChainModified\",value:function(e){var t=e.dataList;if(!zt(t)){var n=[];t.forEach((function(e){e.blackListDelAccount&&n.push.apply(n,m(e.blackListDelAccount))})),n.length>0&&this._blacklistHandler.onAccountDeleted(n);var o=[];t.forEach((function(e){e.blackListAddAccount&&o.push.apply(o,m(e.blackListAddAccount))})),o.length>0&&this._blacklistHandler.onAccountAdded(o)}}},{key:\"onConversationsProfileUpdated\",value:function(e){this._profileHandler.onConversationsProfileUpdated(e)}},{key:\"getMyAccount\",value:function(){return this.getMyUserID()}},{key:\"getMyProfile\",value:function(){return this._profileHandler.getMyProfile()}},{key:\"getStorageModule\",value:function(){return this.getModule(Vn)}},{key:\"filterProfanity\",value:function(e,t){var n=this.getModule(oo);if(!n)return!0;var o=n.filterText(t[e],j),s=o.isAllowedToSend,a=o.modifiedText;return!0===s&&(t[e]=a,!0)}},{key:\"isMyFriend\",value:function(e){var t=this.getModule(bn);return!!t&&t.isMyFriend(e)}},{key:\"getUserProfile\",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:\"updateMyProfile\",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:\"getNickAndAvatarByUserID\",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:\"getLocalBlacklist\",value:function(){var e=this._blacklistHandler.getLocalBlacklist();return Xa(e)}},{key:\"addBlacklist\",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:\"deleteBlacklist\",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:\"onUserStatusUpdated\",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:\"setSelfStatus\",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:\"getUserStatus\",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:\"subscribeUserStatus\",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:\"unsubscribeUserStatus\",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),n}(uo),Qi=function(){function e(t,n){o(this,e),this._m=t,this._isLoggedIn=!1,this._SDKAppID=n.SDKAppID,this._userID=n.userID||\"\",this._userSig=n.userSig||\"\",this._version=\"2.27.6\",this._a2Key=\"\",this._tinyID=\"\",this._customStatus=\"\",this._contentType=\"json\",this._unlimitedAVChatRoom=n.unlimitedAVChatRoom,this._scene=n.scene||\"\",this._oversea=n.oversea,this._instanceID=n.instanceID,this._statusInstanceID=0,this._isDevMode=n.devMode,this._proxyServer=n.proxyServer,this._fileUploadProxy=n.fileUploadProxy,this._fileDownloadProxy=n.fileDownloadProxy}return a(e,[{key:\"isLoggedIn\",value:function(){return this._isLoggedIn}},{key:\"isOversea\",value:function(){return this._oversea}},{key:\"isPrivateNetWork\",value:function(){return this._proxyServer}},{key:\"isDevMode\",value:function(){return this._isDevMode}},{key:\"isSingaporeSite\",value:function(){return this._SDKAppID>=2e7&&this._SDKAppID<3e7||this._SDKAppID>=172e7&&this._SDKAppID<173e7}},{key:\"isKoreaSite\",value:function(){return this._SDKAppID>=3e7&&this._SDKAppID<4e7||this._SDKAppID>=173e7&&this._SDKAppID<174e7}},{key:\"isGermanySite\",value:function(){return this._SDKAppID>=4e7&&this._SDKAppID<5e7||this._SDKAppID>=174e7&&this._SDKAppID<175e7}},{key:\"isIndiaSite\",value:function(){return this._SDKAppID>=5e7&&this._SDKAppID<6e7||this._SDKAppID>=175e7&&this._SDKAppID<176e7}},{key:\"isJapanSite\",value:function(){return this._SDKAppID>=6e7&&this._SDKAppID<7e7||this._SDKAppID>=176e7&&this._SDKAppID<177e7}},{key:\"isUSASite\",value:function(){return this._SDKAppID>=7e7&&this._SDKAppID<8e7||this._SDKAppID>=177e7&&this._SDKAppID<178e7}},{key:\"isIntl\",value:function(){return 0===(e=this._SDKAppID)||e>=2e7&&e<8e7||e>=172e7&&e<178e7;var e}},{key:\"isUnlimitedAVChatRoom\",value:function(){return this._unlimitedAVChatRoom}},{key:\"setUserID\",value:function(e){this._userID=e}},{key:\"getUserID\",value:function(){return this._userID}},{key:\"setUserSig\",value:function(e){this._userSig=e}},{key:\"getUserSig\",value:function(){return this._userSig}},{key:\"getSDKAppID\",value:function(){return this._SDKAppID}},{key:\"setTinyID\",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:\"getTinyID\",value:function(){return this._tinyID}},{key:\"setCustomStatus\",value:function(e){this._customStatus=e}},{key:\"getCustomStatus\",value:function(){return this._customStatus}},{key:\"getScene\",value:function(){return Ae?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?\"tuikit\":this._scene}},{key:\"getInstanceID\",value:function(){return this._instanceID}},{key:\"getStatusInstanceID\",value:function(){return this._statusInstanceID}},{key:\"setStatusInstanceID\",value:function(e){this._statusInstanceID=e}},{key:\"getVersion\",value:function(){return this._version}},{key:\"getA2Key\",value:function(){return this._a2Key}},{key:\"setA2Key\",value:function(e){this._a2Key=e}},{key:\"getContentType\",value:function(){return this._contentType}},{key:\"getProxyServer\",value:function(){return this._proxyServer}},{key:\"getFileUploadProxy\",value:function(){return this._fileUploadProxy}},{key:\"getFileDownloadProxy\",value:function(){return this._fileDownloadProxy}},{key:\"_isTUIKit\",value:function(){var e=!1,t=!1,n=!1,o=!1,s=[];ae&&(s=Object.keys(re)),ie&&(s=se?Object.keys(uni):Object.keys(window));for(var a=0,i=s.length;a<i;a++)if(s[a].toLowerCase().includes(\"uikit\")){e=!0;break}if(s=null,ae&&!ut(re.createGamePortal)&&ut(getApp)&&!it(getApp())){var r=getApp().globalData;st(r)&&!0===r.isTUIKit&&(t=!0)}!0===this._m.getModule(Vn).getStorageSync(\"TIM_\".concat(this._SDKAppID,\"_isTUIKit\"))&&(n=!0);var u=null;if(X&&!$&&\"undefined\"==typeof uni&&__wxConfig&&(u=__wxConfig.pages),Q&&\"undefined\"==typeof uni&&__qqConfig&&(u=__qqConfig.pages),at(u)&&u.length>0){for(var c=0,l=u.length;c<l;c++)if(u[c].toLowerCase().includes(\"tui\")){o=!0;break}u=null}return e||t||n||o}},{key:\"reset\",value:function(){this._isLoggedIn=!1,this._userSig=\"\",this._a2Key=\"\",this._tinyID=\"\",this._customStatus=\"\",this._statusInstanceID=0}}]),e}(),$i=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"SignModule\",s._helloInterval=120,s._lastLoginTs=0,s._lastWsHelloTs=0,s._isWebUniapp=0,oi.mixin(h(s)),s}return a(n,[{key:\"onCheckTimer\",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:\"login\",value:function(e){var t=\"\";if(this.isLoggedIn()){var n=this.getMyUserID();return(t=this.getErrorMessage(\"RepeatLogin\",n))&&Ve.w(t),Xa({actionStatus:\"OK\",errorCode:0,errorInfo:t,repeatLogin:!0})}if(Date.now()-this._lastLoginTs<=15e3)return this.outputWarning(\"LoggingIn\",e.userID),Za({code:ha.REPEAT_LOGIN});Ve.l(\"\".concat(this._n,\".login userID:\").concat(e.userID));var o=this._checkLoginInfo(e);if(0!==o.code)return Za(o);var s=this.getModule(xn),a=e.userID,i=e.userSig;return s.setUserID(a),s.setUserSig(i),this.getModule(zn).updateProtocolConfig(),this._login()}},{key:\"_login\",value:function(){var e=this,t=this.getModule(xn),n=t.getScene(),o=0,s=new Aa(\"login\");s.setMessage(\"\".concat(n)).setMoreMessage(\"identifier:\".concat(this.getMyUserID())),se?\"tuikit\"===n?s.setUIPlatform(4):s.setUIPlatform(3):ae?\"tuikit\"===n?s.setUIPlatform(12):s.setUIPlatform(11):ie&&(Ae?\"flutter_web_uikit\"===n?s.setUIPlatform(21):s.setUIPlatform(20):this._isReactUIKit()?Le?s.setUIPlatform(25):s.setUIPlatform(24):Le?\"tuikit\"===n?s.setUIPlatform(17):s.setUIPlatform(16):\"tuikit\"===n?s.setUIPlatform(14):s.setUIPlatform(13));var a=this.getModule(no);if(a.canIUseOfflinePush()){this._isWebUniapp=a.getUniAppPlatform();var i=this._getStatusInstanceID();t.setStatusInstanceID(i),this.getModule(zn).updateProtocolConfig(),o=a.getDeviceBrand()}var r=\"\".concat(this._n,\"._login\");return this._lastLoginTs=Date.now(),this.request({protocolName:co,requestData:{deviceBrand:o,isWebUniapp:this._isWebUniapp}}).then((function(o){e._lastLoginTs=0;var a=Date.now(),i=null,u=o.data,c=u.a2Key,l=u.tinyID,d=u.helloInterval,p=u.instanceID,g=u.timeStamp,h=u.customStatus,_=void 0===h?\"\":h,f=u.purchaseBits;Ve.l(\"\".concat(r,\" ok. scene:\").concat(n,\" helloInterval:\").concat(d,\" instanceID:\").concat(p,\" timeStamp:\").concat(g));var v=1e3*g,m=a-s.getStartTs(),M=v+parseInt(m/2)-a,y=s.getStartTs()+M;if(s.start(y),function(e,t){Ue=t;var n=new Date;n.setTime(e),Ve.i(\"baseTime from server:\".concat(n,\" offset:\").concat(Ue))}(v,M),!l)throw i=new ja({code:ha.NO_TINYID}),s.setError(i,!0,e.getNetworkType()).end(),i;if(!c)throw i=new ja({code:ha.NO_A2KEY}),s.setError(i,!0,e.getNetworkType()).end(),i;var I=Ji(_);(s.setNetworkType(e.getNetworkType()).setMoreMessage(\"helloInterval:\".concat(d,\" instanceID:\").concat(p,\" offset:\").concat(M,\" customStatus:\").concat(I)).end(),t.setA2Key(c),t.setTinyID(l),t.setStatusInstanceID(p),t.setCustomStatus(I),f)&&e.getModule(to).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:f});e.getModule(zn).updateProtocolConfig(),e.emitInnerEvent(ei),e._helloInterval=d,e.triggerReady();var C=e.getModule(no);return C.canIUseOfflinePush()&&(uni.setStorageSync(\"timUniAppInstanceID\",p),C.init()),e._fetchCloudControlConfig(),e.getModule(oo).init(),o})).catch((function(t){return e.probeNetwork().then((function(e){var n=v(e,2),o=n[0],a=n[1];s.setError(t,o,a).end(!0)})),e._m.setNotReadyReason(ha.LOGIN_FAILED),Ve.e(\"\".concat(r,\" failed. error:\"),t),e._lastLoginTs=0,e._m.onLoginFailed(),Za(t)}))}},{key:\"logout\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.isLoggedIn())return Za({code:ha.USER_NOT_LOGGED_IN});var n=new Aa(\"logout\");n.setNetworkType(this.getNetworkType()).setMessage(\"identifier:\".concat(this.getMyUserID())).end(!0);var o=\"\".concat(this._n,\".logout\");return Ve.i(\"\".concat(o,\" type:\").concat(t)),0===t&&this._m.setNotReadyReason(ha.LOGGED_OUT),this.request({protocolName:lo,requestData:{type:t}}).then((function(){return e.resetReady(),Xa({})})).catch((function(t){return Ve.e(\"\".concat(o,\" error:\"),t),e.resetReady(),Xa({})}))}},{key:\"_fetchCloudControlConfig\",value:function(){this.getModule(Zn).fetchConfig()}},{key:\"_getStatusInstanceID\",value:function(){return uni.getStorageSync(\"timUniAppInstanceID\")}},{key:\"_hello\",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.request({protocolName:po,requestData:{isWebUniapp:this._isWebUniapp}}).catch((function(t){Ve.w(\"\".concat(e._n,\"._hello error:\"),t)}))}},{key:\"getLastWsHelloTs\",value:function(){return this._lastWsHelloTs}},{key:\"_checkLoginInfo\",value:function(e){var t=0;return zt(this.getModule(xn).getSDKAppID())?t=ha.NO_SDKAPPID:zt(e.userID)?t=ha.NO_IDENTIFIER:zt(e.userSig)&&(t=ha.NO_USERSIG),{code:t}}},{key:\"_isReactUIKit\",value:function(){return ie&&void 0!==window.tencent_cloud_im_csig_react_uikit_23F_xa}},{key:\"onMultipleAccountKickedOut\",value:function(e){var t=this;new Aa(\"kickedOut\").setNetworkType(this.getNetworkType()).setMessage(\"type:\".concat(E.KICKED_OUT_MULT_ACCOUNT,\" newInstanceInfo:\").concat(JSON.stringify(e))).end(!0),Ve.w(\"\".concat(this._n,\".onMultipleAccountKickedOut userID:\").concat(this.getMyUserID(),\" newInstanceInfo:\"),e),this.logout(1).then((function(){t.emitOuterEvent(k.KICKED_OUT,{type:E.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(ha.KICKED_OUT_MULT_ACCOUNT),t._m.reset()}))}},{key:\"onMultipleDeviceKickedOut\",value:function(e){var t=this;new Aa(\"kickedOut\").setNetworkType(this.getNetworkType()).setMessage(\"type:\".concat(E.KICKED_OUT_MULT_DEVICE,\" newInstanceInfo:\").concat(JSON.stringify(e))).end(!0),Ve.w(\"\".concat(this._n,\".onMultipleDeviceKickedOut userID:\").concat(this.getMyUserID(),\" newInstanceInfo:\"),e),this.logout(1).then((function(){t.emitOuterEvent(k.KICKED_OUT,{type:E.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(ha.KICKED_OUT_MULT_DEVICE),t._m.reset()}))}},{key:\"onUserSigExpired\",value:function(){new Aa(\"kickedOut\").setNetworkType(this.getNetworkType()).setMessage(E.KICKED_OUT_USERSIG_EXPIRED).end(!0),Ve.w(\"\".concat(this._n,\".onUserSigExpired: userSig expired\")),0!==this.getModule(xn).getStatusInstanceID()&&(this.emitOuterEvent(k.KICKED_OUT,{type:E.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(ha.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:\"onRestApiKickedOut\",value:function(e){(new Aa(\"kickedOut\").setNetworkType(this.getNetworkType()).setMessage(\"type:\".concat(E.KICKED_OUT_REST_API,\" newInstanceInfo:\").concat(JSON.stringify(e))).end(!0),Ve.w(\"\".concat(this._n,\".onRestApiKickedOut userID:\").concat(this.getMyUserID(),\" newInstanceInfo:\"),e),0!==this.getModule(xn).getStatusInstanceID())&&(this.emitOuterEvent(k.KICKED_OUT,{type:E.KICKED_OUT_REST_API}),this._m.setNotReadyReason(ha.KICKED_OUT_REST_API),this._m.reset(),this.getModule(Jn).onRestApiKickedOut())}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),n}(uo);function er(){return null}var tr=function(){function e(t){o(this,e),this._m=t,this._n=\"StorageModule\",this._storageQueue=new Map,this._errorTolerantHandle()}return a(e,[{key:\"_errorTolerantHandle\",value:function(){ae||!it(window)&&this._canIUseCookies()||(this.getItem=er,this.setItem=er,this.removeItem=er,this.clear=er)}},{key:\"onCheckTimer\",value:function(e){if(e%20==0){if(0===this._storageQueue.size)return;this._doFlush()}}},{key:\"_doFlush\",value:function(){try{var e,t=D(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2),o=n[0],s=n[1];this._setStorageSync(this._getKey(o),s)}}catch(a){t.e(a)}finally{t.f()}this._storageQueue.clear()}catch(i){Ve.w(\"\".concat(this._n,\"._doFlush error:\"),i)}}},{key:\"_getPrefix\",value:function(){var e=this._m.getModule(xn);return\"TIM_\".concat(e.getSDKAppID(),\"_\").concat(e.getUserID(),\"_\")}},{key:\"_getKey\",value:function(e){return\"\".concat(this._getPrefix()).concat(e)}},{key:\"getItem\",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(o){return Ve.w(\"\".concat(this._n,\".getItem error:\"),o),{}}}},{key:\"setItem\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(n){var s=o?this._getKey(e):e;this._setStorageSync(s,t)}else this._storageQueue.set(e,t)}},{key:\"clear\",value:function(){try{ae?re.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(e){Ve.w(\"\".concat(this._n,\".clear error:\"),e)}}},{key:\"removeItem\",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(o){Ve.w(\"\".concat(this._n,\".removeItem error:\"),o)}}},{key:\"getSize\",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"b\";try{var o={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(o,\"leftSize\",{enumerable:!0,get:function(){return o.limitSize-o.size}}),ae&&(o.limitSize=1024*re.getStorageInfoSync().limitSize),e)o.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if(ae){var s=re.getStorageInfoSync(),a=s.keys;a.forEach((function(e){o.size+=JSON.stringify(t.getStorageSync(e)).length+t._getKey(e).length}))}else if(this._canIUseCookies())for(var i in localStorage)localStorage.hasOwnProperty(i)&&(o.size+=localStorage.getItem(i).length+i.length);return this._convertUnit(o)}catch(r){Ve.w(\"\".concat(this._n,\" error:\"),r)}}},{key:\"_convertUnit\",value:function(e){var t={},n=e.unit;for(var o in t.unit=n,e)\"number\"==typeof e[o]&&(\"kb\"===n.toLowerCase()?t[o]=Math.round(e[o]/1024):\"mb\"===n.toLowerCase()?t[o]=Math.round(e[o]/1024/1024):t[o]=e[o]);return t}},{key:\"_setStorageSync\",value:function(e,t){ae?te?my.setStorageSync({key:e,data:t}):re.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:\"getStorageSync\",value:function(e){return ae?te?my.getStorageSync({key:e}).data:re.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:\"_removeStorageSync\",value:function(e){ae?te?my.removeStorageSync({key:e}):re.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:\"_canIUseCookies\",value:function(){return navigator&&navigator.cookieEnabled&&localStorage}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._doFlush()}}]),e}(),nr=function(){function e(t){o(this,e),this._n=\"SSOLogBody\",this._report=[]}return a(e,[{key:\"pushIn\",value:function(e){Ve.d(\"\".concat(this._n,\".pushIn\"),this._report.length,e),this._report.push(e)}},{key:\"backfill\",value:function(e){var t;at(e)&&0!==e.length&&(Ve.d(\"\".concat(this._n,\".backfill\"),this._report.length,e.length),(t=this._report).unshift.apply(t,m(e)))}},{key:\"getLogsNumInMemory\",value:function(){return this._report.length}},{key:\"isEmpty\",value:function(){return 0===this._report.length}},{key:\"_reset\",value:function(){this._report.length=0,this._report=[]}},{key:\"getLogsInMemory\",value:function(){var e=this._report.slice();return this._reset(),e}}]),e}(),or=function(e){var t=e.getModule(xn);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:Pe()}},sr=function(e){r(s,e);var n=f(s);function s(e){var t;o(this,s),(t=n.call(this,e))._n=\"EventStatModule\",t.TAG=\"im-ssolog-event\",t._reportBody=new nr,t.MIN_THRESHOLD=20,t.MAX_THRESHOLD=100,t.WAITING_TIME=6e4,t.REPORT_LEVEL=[4,5,6],t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._lastReportTime=Date.now();var a=t.getInnerEmitterInstance();return a.on(ei,t._onLoginSuccess,h(t)),a.on(ti,t._onCloudConfigUpdated,h(t)),t}return a(s,[{key:\"reportAtOnce\",value:function(){Ve.d(\"\".concat(this._n,\".reportAtOnce\")),this._report()}},{key:\"_onLoginSuccess\",value:function(){var e=this,t=this.getModule(Vn),n=t.getItem(this.TAG,!1);!zt(n)&&ut(n.forEach)&&(Ve.l(\"\".concat(this._n,\"._onLoginSuccess get ssolog in storage, count:\").concat(n.length)),n.forEach((function(t){e._reportBody.pushIn(t)})),t.removeItem(this.TAG,!1))}},{key:\"_onCloudConfigUpdated\",value:function(){var e=this.getCloudConfig(\"evt_rpt_threshold\"),t=this.getCloudConfig(\"evt_rpt_waiting\"),n=this.getCloudConfig(\"evt_rpt_level\"),o=this.getCloudConfig(\"evt_rpt_sdkappid_bl\"),s=this.getCloudConfig(\"evt_rpt_tinyid_wl\");it(e)||(this.MIN_THRESHOLD=Number(e)),it(t)||(this.WAITING_TIME=Number(t)),it(n)||(this.REPORT_LEVEL=n.split(\",\").map((function(e){return Number(e)}))),it(o)||(this.REPORT_SDKAPPID_BLACKLIST=o.split(\",\").map((function(e){return Number(e)}))),it(s)||(this.REPORT_TINYID_WHITELIST=s.split(\",\"))}},{key:\"pushIn\",value:function(e){e instanceof Aa&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:\"onCheckTimer\",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:\"_filterLogs\",value:function(e){var t=this,n=this.getModule(xn),o=n.getSDKAppID(),s=n.getTinyID();return Ft(this.REPORT_SDKAPPID_BLACKLIST,o)&&!qt(this.REPORT_TINYID_WHITELIST,s)?[]:e.filter((function(e){return t.REPORT_LEVEL.includes(e.level)}))}},{key:\"_report\",value:function(){var e=this;if(!this._reportBody.isEmpty()){var n=this._reportBody.getLogsInMemory(),o=this._filterLogs(n);if(0!==o.length){var s={header:or(this),event:o};this.request({protocolName:Bs,requestData:t({},s)}).then((function(){e._lastReportTime=Date.now()})).catch((function(t){Ve.w(\"\".concat(e._n,\".report failed. networkType:\").concat(e.getNetworkType(),\" error:\"),t),e._reportBody.backfill(n),e._reportBody.getLogsNumInMemory()>e.MAX_THRESHOLD&&e._flushAtOnce()}))}else this._lastReportTime=Date.now()}}},{key:\"_flushAtOnce\",value:function(){var e=this.getModule(Vn),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),o=\"\".concat(this._n,\"._flushAtOnce\");if(zt(t))Ve.l(\"\".concat(o,\" count:\").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var s=n.concat(t);s.length>this.MAX_THRESHOLD&&(s=s.slice(0,this.MAX_THRESHOLD)),Ve.l(\"\".concat(o,\" count:\").concat(s.length)),e.setItem(this.TAG,s,!0,!1)}}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),s}(uo),ar=\"none\",ir=\"online\",rr=[ha.OVER_FREQUENCY_LIMIT,ha.OPEN_SERVICE_OVERLOAD_ERROR],ur=function(){function e(t){o(this,e),this._m=t,this._networkType=\"\",this._n=\"NetMonitorModule\",this.MAX_WAIT_TIME=3e3,this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null}return a(e,[{key:\"start\",value:function(){var e=this;ae?(re.getNetworkType({success:function(t){e._networkType=t.networkType||t.subtype||\"\",t.networkType===ar?Ve.w(\"\".concat(e._n,\".start no network, please check!\")):Ve.i(\"\".concat(e._n,\".start networkType:\").concat(t.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),re.onNetworkStatusChange(this._mpNetworkStatusCallback)):(this._networkType=ir,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window&&(window.addEventListener(\"online\",this._webOnlineCallback),window.addEventListener(\"offline\",this._webOfflineCallback)))}},{key:\"_onWebOnline\",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:ir})}},{key:\"_onWebOffline\",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:ar})}},{key:\"_onNetworkStatusChange\",value:function(e){var t=e.isConnected,n=e.networkType,o=\"\".concat(this._n,\"._onNetworkStatusChange\"),s=!1;t?(Ve.i(\"\".concat(o,\" previous:\").concat(this._networkType,\" current:\").concat(n)),this._networkType!==n&&(s=!0,this._m.getModule(Jn).reConnect(!0))):this._networkType!==n&&(s=!0,Ve.w(\"\".concat(o,\" no network, please check!\")),this._m.getModule(Jn).offline());s&&(new Aa(\"networkChange\").setMessage(\"isConnected:\".concat(t,\" previousNetworkType:\").concat(this._networkType,\" networkType:\").concat(n)).end(),this._networkType=n)}},{key:\"probe\",value:function(e){var t=this;if(!it(e)&&rr.includes(e.code))return Promise.resolve([!0,this._networkType]);var n=\"\".concat(this._n,\".probe\");return new Promise((function(e,o){ae?re.getNetworkType({success:function(o){t._networkType=o.networkType,o.networkType===ar?(Ve.w(\"\".concat(n,\" no network, please check!\")),e([!1,o.networkType])):(Ve.i(\"\".concat(n,\" networkType:\").concat(o.networkType)),e([!0,o.networkType]))}}):t._networkType===ar?e([!1,ar]):e([!0,ir])}))}},{key:\"getNetworkType\",value:function(){return this._networkType}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),ae?null!==this._mpNetworkStatusCallback&&(re.offNetworkStatusChange&&(oe||$?re.offNetworkStatusChange(this._mpNetworkStatusCallback):re.offNetworkStatusChange()),this._mpNetworkStatusCallback=null):window&&(null!==this._webOnlineCallback&&(window.removeEventListener(\"online\",this._webOnlineCallback),this._webOnlineCallback=null),null!==this._onWebOffline&&(window.removeEventListener(\"offline\",this._webOfflineCallback),this._webOfflineCallback=null))}}]),e}();function cr(e,t){return e(t={exports:{}},t.exports),t.exports}var lr=cr((function(e){var t=Object.prototype.hasOwnProperty,n=\"~\";function o(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,o,a,i){if(\"function\"!=typeof o)throw new TypeError(\"The listener must be a function\");var r=new s(o,a||e,i),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],r]:e._events[u].push(r):(e._events[u]=r,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function r(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),r.prototype.eventNames=function(){var e,o,s=[];if(0===this._eventsCount)return s;for(o in e=this._events)t.call(e,o)&&s.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},r.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var s=0,a=o.length,i=new Array(a);s<a;s++)i[s]=o[s].fn;return i},r.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},r.prototype.emit=function(e,t,o,s,a,i){var r=n?n+e:e;if(!this._events[r])return!1;var u,c,l=this._events[r],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,o),!0;case 4:return l.fn.call(l.context,t,o,s),!0;case 5:return l.fn.call(l.context,t,o,s,a),!0;case 6:return l.fn.call(l.context,t,o,s,a,i),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var p,g=l.length;for(c=0;c<g;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,o);break;case 4:l[c].fn.call(l[c].context,t,o,s);break;default:if(!u)for(p=1,u=new Array(d-1);p<d;p++)u[p-1]=arguments[p];l[c].fn.apply(l[c].context,u)}}return!0},r.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},r.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},r.prototype.removeListener=function(e,t,o,s){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return i(this,a),this;var r=this._events[a];if(r.fn)r.fn!==t||s&&!r.once||o&&r.context!==o||i(this,a);else{for(var u=0,c=[],l=r.length;u<l;u++)(r[u].fn!==t||s&&!r[u].once||o&&r[u].context!==o)&&c.push(r[u]);c.length?this._events[a]=1===c.length?c[0]:c:i(this,a)}return this},r.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new o,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=n,r.EventEmitter=r,e.exports=r})),dr=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"BigDataChannelModule\",s.FILETYPE={SOUND:2106,FILE:2107,VIDEO:2113},s._bdh_download_server=\"grouptalk.c2c.qq.com\",s._BDHBizID=10001,s._authKey=\"\",s._expireTime=0,s.getInnerEmitterInstance().on(ei,s._getAuthKey,h(s)),s}return a(n,[{key:\"_getAuthKey\",value:function(){var e=this;this.isIntl()||this.request({protocolName:_o}).then((function(t){t.data.authKey&&(e._authKey=t.data.authKey,e._expireTime=parseInt(t.data.expireTime))}))}},{key:\"_isFromOlderVersion\",value:function(e){return!(!e.content||2===e.content.downloadFlag)}},{key:\"parseElements\",value:function(e,t){if(!at(e)||!t)return[];for(var n=[],o=null,s=0;s<e.length;s++)o=e[s],this._needParse(o)?n.push(this._parseElement(o,t)):n.push(e[s]);return n}},{key:\"_needParse\",value:function(e){return!e.cloudCustomData&&!(!this._isFromOlderVersion(e)||e.type!==E.MSG_AUDIO&&e.type!==E.MSG_FILE&&e.type!==E.MSG_VIDEO)}},{key:\"_parseElement\",value:function(e,t){switch(e.type){case E.MSG_AUDIO:return this._parseAudioElement(e,t);case E.MSG_FILE:return this._parseFileElement(e,t);case E.MSG_VIDEO:return this._parseVideoElement(e,t)}}},{key:\"_parseAudioElement\",value:function(e,t){return e.content.url=this._genAudioUrl(e.content.uuid,t),e}},{key:\"_parseFileElement\",value:function(e,t){return e.content.url=this._genFileUrl(e.content.uuid,t,e.content.fileName),e}},{key:\"_parseVideoElement\",value:function(e,t){return e.content.url=this._genVideoUrl(e.content.uuid,t),e}},{key:\"_genAudioUrl\",value:function(e,t){if(\"\"===this._authKey)return\"\";var n=this.getModule(xn).getSDKAppID();return\"https://\".concat(this._bdh_download_server,\"/asn.com/stddownload_common_file?authkey=\").concat(this._authKey,\"&bid=\").concat(this._BDHBizID,\"&subbid=\").concat(n,\"&fileid=\").concat(e,\"&filetype=\").concat(this.FILETYPE.SOUND,\"&openid=\").concat(t,\"&ver=0\")}},{key:\"_genFileUrl\",value:function(e,t,n){if(\"\"===this._authKey)return\"\";n||(n=\"\".concat(Math.floor(1e5*Math.random()),\"-\").concat(Date.now()));var o=this.getModule(xn).getSDKAppID();return\"https://\".concat(this._bdh_download_server,\"/asn.com/stddownload_common_file?authkey=\").concat(this._authKey,\"&bid=\").concat(this._BDHBizID,\"&subbid=\").concat(o,\"&fileid=\").concat(e,\"&filetype=\").concat(this.FILETYPE.FILE,\"&openid=\").concat(t,\"&ver=0&filename=\").concat(encodeURIComponent(n))}},{key:\"_genVideoUrl\",value:function(e,t){if(\"\"===this._authKey)return\"\";var n=this.getModule(xn).getSDKAppID();return\"https://\".concat(this._bdh_download_server,\"/asn.com/stddownload_common_file?authkey=\").concat(this._authKey,\"&bid=\").concat(this._BDHBizID,\"&subbid=\").concat(n,\"&fileid=\").concat(e,\"&filetype=\").concat(this.FILETYPE.VIDEO,\"&openid=\").concat(t,\"&ver=0\")}},{key:\"reset\",value:function(){this._authKey=\"\",this.expireTime=0}}]),n}(uo),pr=[\"requestSnapshotUrl\"],gr=function(e){r(s,e);var n=f(s);function s(e){var t;o(this,s),(t=n.call(this,e))._n=\"UploadModule\",t.TIMUploadPlugin=null,t.timUploadPlugin=null,t.COSSDK=null,t._cosUploadMethod=null,t.expiredTimeLimit=600,t.appid=0,t.bucketName=\"\",t.ciUrl=\"\",t.directory=\"\",t.downloadUrl=\"\",t.uploadUrl=\"\",t.region=\"ap-shanghai\",t.cos=null,t.cosOptions={secretId:\"\",secretKey:\"\",sessionToken:\"\",expiredTime:0},t.uploadFileType=\"\",t.duration=900,t.tryCount=0,t.UPLOAD_SIZE_LIMIT={AUDIO:20971520,FILE:104857600,IMAGE:20971520,VIDEO:104857600};var a=t.getInnerEmitterInstance();return a.on(ei,t._init,h(t)),a.on(ti,t._onCloudConfigUpdated,h(t)),t}return a(s,[{key:\"_init\",value:function(){var e=this.getModule(Yn);if(this.TIMUploadPlugin=e.getPlugin(\"tim-upload-plugin\"),this.TIMUploadPlugin)this._initUploaderMethod();else{var t=ae?\"cos-wx-sdk\":\"cos-js-sdk\";this.COSSDK=e.getPlugin(t),this.COSSDK?(this._getAuthorizationKey(),this.outputWarning(\"CosReplacement\",t)):this.outputWarning(\"PluginUndetected\")}}},{key:\"_onCloudConfigUpdated\",value:function(){var e=\"\".concat(this._n,\"._onCloudConfigUpdated\"),t=this.getCloudConfig(\"upload_size_limit\");if(Ve.l(\"\".concat(e,\" uploadSizeLimit:\").concat(t)),!it(t))try{var n=JSON.parse(t);this.UPLOAD_SIZE_LIMIT={AUDIO:n.a?1048576*parseInt(n.a):this.UPLOAD_SIZE_LIMIT.AUDIO,FILE:n.f?1048576*parseInt(n.f):this.UPLOAD_SIZE_LIMIT.FILE,IMAGE:n.i?1048576*parseInt(n.i):this.UPLOAD_SIZE_LIMIT.IMAGE,VIDEO:n.v?1048576*parseInt(n.v):this.UPLOAD_SIZE_LIMIT.VIDEO}}catch(o){Ve.e(\"\".concat(e,\" JSON parse error. uploadSizeLimit:\"),t)}}},{key:\"_getAuthorizationKey\",value:function(){var e=this,t=\"\".concat(this._n,\".\").concat(\"_getAuthorizationKey\"),n=new Aa(\"_getAuthorizationKey\"),o=Math.ceil(Date.now()/1e3);this.request({protocolName:qs,requestData:{duration:this.expiredTimeLimit}}).then((function(s){var a=s.data;Ve.l(\"\".concat(t,\" ok. data:\"),a);var i=a.expiredTime-o;n.setMessage(\"requestId:\".concat(a.requestId,\" requestTime:\").concat(o,\" expiredTime:\").concat(a.expiredTime,\" diff:\").concat(i,\"s\")).setNetworkType(e.getNetworkType()).end(),!ae&&a.region&&(e.region=a.region),e.appid=a.appid,e.bucketName=a.bucketName,e.ciUrl=a.ciUrl,e.directory=a.directory,e.downloadUrl=a.downloadUrl,e.uploadUrl=a.uploadUrl,e.cosOptions={secretId:a.secretId,secretKey:a.secretKey,sessionToken:a.sessionToken,expiredTime:a.expiredTime},Ve.l(\"\".concat(t,\" ok. region:\").concat(e.region,\" bucketName:\").concat(e.bucketName)),e._initUploaderMethod()})).catch((function(o){e.probeNetwork().then((function(e){var t=v(e,2),s=t[0],a=t[1];n.setError(o,s,a).end()})),Ve.w(\"\".concat(t,\" failed. error:\"),o)}))}},{key:\"_getCosPreSigUrl\",value:function(e){var t=this,n=\"\".concat(this._n,\".\").concat(\"_getCosPreSigUrl\"),o=Math.ceil(Date.now()/1e3),s=new Aa(\"_getCosPreSigUrl\");return this.request({protocolName:xs,requestData:{fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration}}).then((function(e){t.tryCount=0;var a=e.data||{},i=a.expiredTime-o;return Ve.l(\"\".concat(n,\" ok. data:\"),a),s.setMessage(\"requestId:\".concat(a.requestId,\" expiredTime:\").concat(a.expiredTime,\" diff:\").concat(i,\"s\")).setNetworkType(t.getNetworkType()).end(),a})).catch((function(o){return-1===o.code&&(o.code=ha.COS_GET_SIG_FAIL),t.probeNetwork().then((function(e){var t=v(e,2),n=t[0],a=t[1];s.setError(o,n,a).end()})),Ve.w(\"\".concat(n,\" failed. error:\"),o),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,Za({code:ha.COS_GET_SIG_FAIL}))}))}},{key:\"_initUploaderMethod\",value:function(){var e=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)});this.appid&&(this.cos=ae?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=ae?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:\"onCheckTimer\",value:function(e){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:\"_getAuthorization\",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:\"upload\",value:function(e){if(!0===e.getRelayFlag())return Promise.resolve();var t=this.getModule(eo);switch(e.type){case E.MSG_IMAGE:return t.addTotalCount(Ia),this._uploadImage(e);case E.MSG_FILE:return t.addTotalCount(Ia),this._uploadFile(e);case E.MSG_AUDIO:return t.addTotalCount(Ia),this._uploadAudio(e);case E.MSG_VIDEO:return t.addTotalCount(Ia),this._uploadVideo(e);default:return Promise.resolve()}}},{key:\"_uploadImage\",value:function(e){var n=this,o=this.getModule(Nn),s=e.getElements()[0],a=o.getMessageOption(e.clientSequence);return this.doUploadImage({file:a.payload.file,to:a.to,onProgress:function(e){if(s.updatePercent(e),ut(a.onProgress))try{a.onProgress(e)}catch(t){return Za({code:ha.MESSAGE_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(o){var a,i,r=o.location,u=o.fileType,c=o.fileSize,l=o.width,d=o.height,p=o.smallImageUrl,g=o.smallImageWidth,h=o.smallImageHeight,_=o.largeImageUrl,f=o.largeImageWidth,v=o.largeImageHeight,m=n.isPrivateNetWork()?r:yt(r);return s.updateImageFormat(u),p&&_?(a={url:p,width:g,height:h},i={url:_,width:f,height:v}):(a=Ut({originUrl:m,originWidth:l,originHeight:d,min:198}),i=Ut({originUrl:m,originWidth:l,originHeight:d,min:720})),s.updateImageInfoArray([{size:c,url:m,width:l,height:d},t({},i),t({},a)]),e}))}},{key:\"_uploadFile\",value:function(e){var t=this,n=this.getModule(Nn),o=e.getElements()[0],s=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:s.payload.file,to:s.to,onProgress:function(e){if(o.updatePercent(e),ut(s.onProgress))try{s.onProgress(e)}catch(t){return Za({code:ha.MESSAGE_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(n){var s=n.location,a=t.isPrivateNetWork()?s:yt(s);return o.updateFileUrl(a),e}))}},{key:\"_uploadAudio\",value:function(e){var t=this,n=this.getModule(Nn),o=e.getElements()[0],s=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:s.payload.file,to:s.to,onProgress:function(e){if(o.updatePercent(e),ut(s.onProgress))try{s.onProgress(e)}catch(t){return Za({code:ha.MESSAGE_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(n){var s=n.location,a=t.isPrivateNetWork()?s:yt(s);return o.updateAudioUrl(a),e}))}},{key:\"_uploadVideo\",value:function(e){var t=this,n=this.getModule(Nn),o=e.getElements()[0],s=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:s.payload.file,to:s.to,onProgress:function(e){if(o.updatePercent(e),ut(s.onProgress))try{s.onProgress(e)}catch(t){return Za({code:ha.MESSAGE_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(n){var s=n.location,a=n.snapshotInfo,i=t.isPrivateNetWork()?s:yt(s);return o.updateVideoUrl(i),zt(a)||o.updateSnapshotInfo(a),e}))}},{key:\"_checkSizeError\",value:function(e){return Za({code:ha[\"MESSAGE_\".concat(e,\"_SIZE_LIMIT\")],message:this.getErrorMessage(\"UploadSizeLimit\",e.toLowerCase(),\"\".concat(this.UPLOAD_SIZE_LIMIT[e]/1048576,\" MB\"))})}},{key:\"doUploadImage\",value:function(e){var t=this;if(!e.file)return Za({code:ha.MESSAGE_IMAGE_SELECT_FILE_FIRST});var n=this._checkImageType(e.file);if(!0!==n)return n;var o=this._checkImageSize(e.file);if(!0!==o)return o;var s=null;return this._setUploadFileType(ii),this.uploadByCOS(e).then((function(e){return s=e,t.isPrivateNetWork()?Rt(e.location):Rt(\"https://\".concat(e.location))})).then((function(e){return s.width=e.width,s.height=e.height,Promise.resolve(s)}))}},{key:\"_checkImageType\",value:function(e){var t=\"\";return t=ae?e.url.slice(e.url.lastIndexOf(\".\")+1):e.files[0].name.slice(e.files[0].name.lastIndexOf(\".\")+1),si.indexOf(t.toLowerCase())>=0||Za({code:ha.MESSAGE_IMAGE_TYPES_LIMIT})}},{key:\"_checkImageSize\",value:function(e){var t=0;return 0===(t=ae?e.size:e.files[0].size)?Za({code:ha.MESSAGE_FILE_IS_EMPTY}):t<this.UPLOAD_SIZE_LIMIT.IMAGE||this._checkSizeError(\"IMAGE\")}},{key:\"doUploadFile\",value:function(e){return e.file?e.file.files[0].size>this.UPLOAD_SIZE_LIMIT.FILE?this._checkSizeError(\"FILE\"):0===e.file.files[0].size?Za({code:ha.MESSAGE_FILE_IS_EMPTY}):(this._setUploadFileType(ci),this.uploadByCOS(e)):Za({code:ha.MESSAGE_FILE_SELECT_FILE_FIRST})}},{key:\"doUploadVideo\",value:function(e){return e.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.VIDEO?this._checkSizeError(\"VIDEO\"):0===e.file.videoFile.size?Za({code:ha.MESSAGE_FILE_IS_EMPTY}):-1===ai.indexOf(e.file.videoFile.type)?Za({code:ha.MESSAGE_VIDEO_TYPES_LIMIT}):(this._setUploadFileType(ri),ae?this.handleVideoUpload({file:e.file.videoFile,onProgress:e.onProgress}):ie?this.handleVideoUpload(e):void 0)}},{key:\"handleVideoUpload\",value:function(e){var t=this;return new Promise((function(n,o){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){o(new ja({code:ha.MESSAGE_VIDEO_UPLOAD_FAIL}))}))}))}))}},{key:\"doUploadAudio\",value:function(e){return e.file?e.file.size>this.UPLOAD_SIZE_LIMIT.AUDIO?this._checkSizeError(\"AUDIO\"):0===e.file.size?Za({code:ha.MESSAGE_FILE_IS_EMPTY}):(this._setUploadFileType(ui),this.uploadByCOS(e)):Za({code:ha.MESSAGE_AUDIO_UPLOAD_FAIL})}},{key:\"uploadByCOS\",value:function(e){var t=this;if(!ut(this._cosUploadMethod))return this.outputWarning(\"PluginUndetected\"),Za({code:ha.COS_UNDETECTED});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(e);var n=new Aa(\"upload\"),o=\"\".concat(this._n,\".uploadByCOS\"),s=Date.now(),a=this._getFile(e);return new Promise((function(i,r){var u=ae?t._createCosOptionsWXMiniApp(e):t._createCosOptionsWeb(e),c=t;t._cosUploadMethod(u,(function(e,u){var l=Object.create(null);if(u){if(e||at(u.files)&&u.files[0].error){var d=new ja({code:ha.MESSAGE_FILE_UPLOAD_FAIL});return n.setError(d,!0,t.getNetworkType()).end(),Ve.l(\"\".concat(o,\" failed. error:\"),u.files[0].error),403===u.files[0].error.statusCode&&(Ve.w(\"\".concat(o,\" failed. cos AccessKeyId was invalid, regain auth key!\")),t._getAuthorizationKey()),void r(d)}l.fileName=a.name,l.fileSize=a.size,l.fileType=a.type.slice(a.type.indexOf(\"/\")+1).toLowerCase(),l.location=ae?u.Location:u.files[0].data.Location;var p=Date.now()-s,g=c._formatFileSize(a.size),h=c._formatSpeed(1e3*a.size/p),_=\"size:\".concat(g,\" time:\").concat(p,\"ms speed:\").concat(h);Ve.l(\"\".concat(o,\" success. name:\").concat(a.name,\" \").concat(_)),i(l);var f=t.getModule(eo);return f.addCost(Ia,p),f.addFileSize(Ia,a.size),void n.setNetworkType(t.getNetworkType()).setMessage(_).end()}var v=new ja({code:ha.MESSAGE_FILE_UPLOAD_FAIL});n.setError(v,!0,c.getNetworkType()).end(),Ve.w(\"\".concat(o,\" failed. error:\"),e),403===e.statusCode&&(Ve.w(\"\".concat(o,\" failed. cos AccessKeyId was invalid, regain auth key!\")),t._getAuthorizationKey()),r(v)}))}))}},{key:\"_uploadWithPreSigUrl\",value:function(e){var t=this,n=\"\".concat(this._n,\"._uploadWithPreSigUrl\"),o=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then((function(e){return new Promise((function(s,a){var i=new Aa(\"upload\"),r=e.requestSnapshotUrl,u=void 0===r?void 0:r,c=g(e,pr),l=Date.now();t._cosUploadMethod(c,(function(e,r){if(e||403===r.statusCode)return i.setError(new ja(e),!0,t.getNetworkType()).end(),Ve.l(\"\".concat(n,\" failed, error:\"),e),void a(new ja({code:ha.MESSAGE_FILE_UPLOAD_FAIL}));var d=Object.create(null),p=r.data.location||\"\";t.isPrivateNetWork()||0!==p.indexOf(\"https://\")&&0!==p.indexOf(\"http://\")||(p=p.split(\"//\")[1]),d.fileName=o.name,d.fileSize=o.size,d.fileType=o.type.slice(o.type.indexOf(\"/\")+1).toLowerCase(),d.location=p;var g=Date.now()-l,h=t._formatFileSize(o.size),_=t._formatSpeed(1e3*o.size/g),f=\"size:\".concat(h,\",time:\").concat(g,\"ms,speed:\").concat(_,\" res:\").concat(JSON.stringify(r.data));Ve.l(\"\".concat(n,\" success name:\").concat(o.name,\",\").concat(f)),i.setNetworkType(t.getNetworkType()).setMessage(f).end();var v=t.getModule(eo);v.addCost(Ia,g),v.addFileSize(Ia,o.size);var m=[];if(c.thumbUrl&&c.largeUrl&&(m=[t._getSmallImageInfoByUrl(c.thumbUrl,d),t._getLargeImageInfoByUrl(c.largeUrl,d)]),u&&m.push(t._getSnapshotInfoByUrl(u,d)),m.length>0)return Promise.all(m).then((function(){s(d)}));s(d)}))}))}))}},{key:\"_getRawOrUploadProxyUrl\",value:function(e){var t=this.getModule(xn).getFileUploadProxy(),n=e;return t&&(n=e.replace(/^https:\\/\\/[^/]+/,t)),n}},{key:\"_getFile\",value:function(e){var t;return at(e.file.files)||(t=e.file.files,\"filelist\"===lt(t))?e.file.files[0]:e.file}},{key:\"_formatFileSize\",value:function(e){return e<1024?e+\"B\":e<1048576?Math.floor(e/1024)+\"KB\":Math.floor(e/1048576)+\"MB\"}},{key:\"_formatSpeed\",value:function(e){return e<=1048576?wt(e/1024,1)+\"KB/s\":wt(e/1048576,1)+\"MB/s\"}},{key:\"_createCosOptionsWeb\",value:function(e){var t=this._getFile(e),n=t.name,o=n.slice(n.lastIndexOf(\".\")),s=this._genFileName(\"\".concat(_t(999999)).concat(o));return{files:[{Bucket:\"\".concat(this.bucketName,\"-\").concat(this.appid),Region:this.region,Key:\"\".concat(this.directory,\"/\").concat(s),Body:t}],SliceSize:1048576,onProgress:function(t){if(\"function\"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Ve.w(\"onProgress callback error:\",n)}},onFileFinish:function(e,t,n){}}}},{key:\"_createCosOptionsWXMiniApp\",value:function(e){var t=this._getFile(e),n=this._genFileName(t.name),o=t.url;return{Bucket:\"\".concat(this.bucketName,\"-\").concat(this.appid),Region:this.region,Key:\"\".concat(this.directory,\"/\").concat(n),FilePath:o,onProgress:function(t){if(Ve.l(JSON.stringify(t)),\"function\"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Ve.w(\"onProgress callback error:\",n)}}}}},{key:\"_createCosOptionsPreSigUrl\",value:function(e){var t=this,n=\"\",o=\"\",s=0,a=this._getFile(e);if(ae)n=this._genFileName(a.name),o=a.url,s=1;else{var i=a.name,r=i.slice(i.lastIndexOf(\".\"));n=this._genFileName(\"\".concat(_t(999999)).concat(r)),o=a,s=0}return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:n,uploadMethod:s,duration:this.duration}).then((function(s){var a=s.uploadUrl,i=s.downloadUrl,r=s.requestSnapshotUrl,u=void 0===r?void 0:r,c=s.thumbUrl,l=s.largeUrl;return{url:t._getRawOrUploadProxyUrl(a),fileType:t.uploadFileType,fileName:n,resources:o,downloadUrl:i,requestSnapshotUrl:u,thumbUrl:c,largeUrl:l,onProgress:function(t){if(\"function\"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Ve.w(\"onProgress callback error:\",n),Ve.e(n)}}}}))}},{key:\"_genFileName\",value:function(e){return\"\".concat(Nt(),\"-\").concat(e)}},{key:\"_setUploadFileType\",value:function(e){this.uploadFileType=e}},{key:\"_getSnapshotInfoByUrl\",value:function(e,t){var n=this,o=new Aa(\"getSnapshotInfo\");return this.request({protocolName:Vs,requestData:{platform:this.getPlatform(),coverName:this._genFileName(_t(99999)),requestSnapshotUrl:e}}).then((function(e){var n=(e.data||{}).snapshotUrl;return o.setMessage(\"snapshotUrl:\".concat(n)).end(),zt(n)?{}:Rt(n).then((function(e){t.snapshotInfo={snapshotUrl:n,snapshotWidth:e.width,snapshotHeight:e.height}}))})).catch((function(e){return Ve.w(\"\".concat(n._n,\"._getSnapshotInfoByUrl failed. error:\"),e),o.setCode(e.errorCode).setMessage(e.errorInfo).end(),{}}))}},{key:\"_getSmallImageInfoByUrl\",value:function(e,t){return Rt(e).then((function(n){t.smallImageUrl=e,t.smallImageWidth=n.width,t.smallImageHeight=n.height}))}},{key:\"_getLargeImageInfoByUrl\",value:function(e,t){return Rt(e).then((function(n){t.largeImageUrl=e,t.largeImageWidth=n.width,t.largeImageHeight=n.height}))}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\"))}}]),s}(uo),hr=[\"downloadKey\",\"pbDownloadKey\",\"messageList\"],_r=function(){function e(t){o(this,e),this._n=\"MergerMessageHandler\",this._messageModule=t}return a(e,[{key:\"uploadMergerMessage\",value:function(e,t){var n=this,o=\"\".concat(this._n,\".\").concat(\"uploadMergerMessage\");Ve.d(\"\".concat(o,\" message:\"),e,\"messageBytes:\".concat(t));var s=e.payload.messageList,a=s.length,i=new Aa(\"uploadMergerMessage\");return this._messageModule.request({protocolName:zs,requestData:{messageList:s}}).then((function(e){Ve.d(\"\".concat(o,\" ok. response:\"),e.data);var s=e.data,r=s.pbDownloadKey,u=s.downloadKey,c={pbDownloadKey:r,downloadKey:u,messageNumber:a};return i.setNetworkType(n._messageModule.getNetworkType()).setMessage(\"\".concat(a,\"-\").concat(t,\"-\").concat(u)).end(),c})).catch((function(e){throw Ve.w(\"\".concat(o,\" failed. error:\"),e),n._messageModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),e}))}},{key:\"downloadMergerMessage\",value:function(e){var n=this,o=\"\".concat(this._n,\".\").concat(\"downloadMergerMessage\");Ve.d(\"\".concat(o,\" message:\"),e);var s=e.payload.downloadKey,a=this._messageModule.getFileDownloadProxy(),i=new Aa(\"downloadMergerMessage\");return i.setMessage(\"downloadKey:\".concat(s)),this._messageModule.request({protocolName:Js,requestData:{downloadKey:s}}).then((function(s){if(Ve.d(\"\".concat(o,\" ok. response:\"),s.data),ut(e.clearElement)){var r=e.payload;r.downloadKey,r.pbDownloadKey,r.messageList;var u=g(r,hr);e.clearElement(),e.setElement({type:e.type,content:t({messageList:s.data.messageList},u)},a)}else{var c=[];s.data.messageList.forEach((function(e){if(!zt(e)){var t=new Ba(e,a);c.push(t)}})),e.payload.messageList=c,e.payload.downloadKey=\"\",e.payload.pbDownloadKey=\"\"}return i.setNetworkType(n._messageModule.getNetworkType()).end(),e})).catch((function(e){throw Ve.w(\"\".concat(o,\" failed. key:\").concat(s,\" error:\"),e),n._messageModule.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];i.setError(e,o,s).end()})),e}))}},{key:\"createMergerMessagePack\",value:function(e,t,n){return e.conversationType===E.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:\"_createC2CMergerMessagePack\",value:function(e,t,n){var o=null;t&&(t.offlinePushInfo&&(o=t.offlinePushInfo),!0===t.onlineUserOnly&&(o?o.disablePush=!0:o={disablePush:!0}));var s=[];if(st(t)&&st(t.messageControlInfo)){var a=t.messageControlInfo,i=a.excludedFromUnreadCount,r=a.excludedFromLastMessage,u=a.excludedFromContentModeration;!0===i&&s.push(\"NoUnread\"),!0===r&&s.push(\"NoLastMsg\"),!0===u&&s.push(\"NoMsgCheck\")}var c=\"\";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,p=n.messageNumber,g=e.payload,h=g.title,_=g.abstractList,f=g.compatibleText,v=this._messageModule.getModule(Un),m=v&&v.isOnlineMessage(e,t)?0:void 0;return{protocolName:fo,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:_,compatibleText:f,messageNumber:p}}],cloudCustomData:c,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:m,offlinePushInfo:o?{pushFlag:!0===o.disablePush?1:0,title:o.title||\"\",desc:o.description||\"\",ext:o.extension||\"\",apnsInfo:{badgeMode:!0===o.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:o.androidOPPOChannelID||\"\"}}:void 0,messageControlInfo:0!==m?s:void 0,isSupportExtension:!0===e.isSupportExtension?1:0}}}},{key:\"_createGroupMergerMessagePack\",value:function(e,t,n){var o=null;t&&t.offlinePushInfo&&(o=t.offlinePushInfo);var s=[];if(st(t)&&st(t.messageControlInfo)){var a=t.messageControlInfo,i=a.excludedFromUnreadCount,r=a.excludedFromLastMessage,u=a.excludedFromContentModeration;!0===i&&s.push(\"NoUnread\"),!0===r&&s.push(\"NoLastMsg\"),!0===u&&s.push(\"NoMsgCheck\")}var c=\"\";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,p=n.messageNumber,g=e.payload,h=g.title,_=g.abstractList,f=g.compatibleText,v=this._messageModule.getModule(Pn),m=v&&v.isOnlineMessage(e,t)?1:0;return{protocolName:vo,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:_,compatibleText:f,messageNumber:p}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:c,onlineOnlyFlag:m,offlinePushInfo:o?{pushFlag:!0===o.disablePush?1:0,title:o.title||\"\",desc:o.description||\"\",ext:o.extension||\"\",apnsInfo:{badgeMode:!0===o.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:o.androidOPPOChannelID||\"\"}}:void 0,clientTime:e.clientTime,needReadReceipt:!0!==e.needReadReceipt||v.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:0===m?s:void 0,isSupportExtension:!0===e.isSupportExtension?1:0}}}}]),e}(),fr={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MESSAGE_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},vr=[ha.MESSAGE_ONPROGRESS_FUNCTION_ERROR,ha.MESSAGE_IMAGE_SELECT_FILE_FIRST,ha.MESSAGE_IMAGE_TYPES_LIMIT,ha.MESSAGE_FILE_IS_EMPTY,ha.MESSAGE_IMAGE_SIZE_LIMIT,ha.MESSAGE_FILE_SELECT_FILE_FIRST,ha.MESSAGE_FILE_SIZE_LIMIT,ha.MESSAGE_VIDEO_SIZE_LIMIT,ha.MESSAGE_VIDEO_TYPES_LIMIT,ha.MESSAGE_AUDIO_UPLOAD_FAIL,ha.MESSAGE_AUDIO_SIZE_LIMIT,ha.COS_UNDETECTED];function mr(e){var t=!1;return Object.values(fr).includes(e)&&(t=!0),(e>=120001&&e<=13e4||e>=10100&&e<=10200)&&(t=!0),t}var Mr=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"MessageModule\",t._messageOptionsMap=new Map,t._mergerMessageHandler=new _r(h(t)),t}return a(s,[{key:\"createTextMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Wa(e),o=\"string\"==typeof e.payload?e.payload:e.payload.text,s=new Ra({text:o}),a=this._getNickAndAvatarByUserID(t);return n.setElement(s),n.setNickAndAvatar(a),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:\"createImageMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Wa(e);if(ae){var o=e.payload.file;if($e(o))return void this.outputWarning(\"FileUnsupportedInMP\",\"createImageMessage\");var s=o.tempFiles[0].path||o.tempFiles[0].tempFilePath,a={url:s,name:s.slice(s.lastIndexOf(\"/\")+1),size:o.tempFiles&&o.tempFiles[0].size||1,type:s.slice(s.lastIndexOf(\".\")+1).toLowerCase()};e.payload.file=a}else if(ie)if($e(e.payload.file)){var i=e.payload.file;e.payload.file={files:[i]}}else if(st(e.payload.file)&&\"undefined\"!=typeof uni){var r=e.payload.file.tempFiles[0];e.payload.file={files:[r]}}var u=new Na({imageFormat:Be.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file}),c=this._getNickAndAvatarByUserID(t);return n.setElement(u),n.setNickAndAvatar(c),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:\"createAudioMessage\",value:function(e){var t=e.payload.file;if(ae){var n={url:t.tempFilePath,name:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(\"/\")+1),size:t.fileSize,second:parseInt(t.duration)/1e3,type:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(\".\")+1).toLowerCase()};e.payload.file=n}var o=this.getMyUserID();e.currentUser=o,e.senderTinyID=this.getMyTinyID();var s=new Wa(e),a=new Ga({second:Math.floor(t.duration/1e3),size:t.fileSize||t.size,url:t.tempFilePath,uuid:this._generateUUID(e.payload.file)}),i=this._getNickAndAvatarByUserID(o);return s.setElement(a),s.setNickAndAvatar(i),s.setNameCard(this._getNameCardByGroupID(s)),this._messageOptionsMap.set(s.clientSequence,e),s}},{key:\"createVideoMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl=\"\",e.payload.file.thumbSize=0;var n={};if(ae){if(te)return void this.outputWarning(\"VideoUnsupportedInAlipay\");if($e(e.payload.file))return void this.outputWarning(\"FileUnsupportedInMP\",\"createVideoMessage\");var o=e.payload.file;at(o.tempFiles)&&(o=o.tempFiles[0]),n.url=o.tempFilePath,n.name=o.tempFilePath.slice(o.tempFilePath.lastIndexOf(\"/\")+1),n.size=o.size||1,n.second=o.duration||0,n.type=o.tempFilePath.slice(o.tempFilePath.lastIndexOf(\".\")+1).toLowerCase()}else if(ie){if($e(e.payload.file)){var s=e.payload.file;e.payload.file.files=[s]}else if(st(e.payload.file)&&\"undefined\"!=typeof uni){var a=e.payload.file.tempFile;e.payload.file.files=[a]}var i=e.payload.file;n.url=window.URL.createObjectURL(i.files[0]),n.name=i.files[0].name,n.size=i.files[0].size||1,n.second=i.files[0].duration||0,n.type=i.files[0].type.split(\"/\")[1]}e.payload.file.videoFile=n;var r=new Wa(e),u=new xa({videoFormat:n.type,videoSecond:wt(n.second,0),videoSize:n.size,remoteVideoUrl:\"\",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:e.payload.file.thumbUrl.slice(e.payload.file.thumbUrl.lastIndexOf(\".\")+1).toLowerCase()}),c=this._getNickAndAvatarByUserID(t);return r.setElement(u),r.setNickAndAvatar(c),r.setNameCard(this._getNameCardByGroupID(r)),this._messageOptionsMap.set(r.clientSequence,e),r}},{key:\"createCustomMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Wa(e),o=new qa({data:e.payload.data,description:e.payload.description,extension:e.payload.extension}),s=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(s),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:\"createFaceMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Wa(e),o=new Oa(e.payload),s=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(s),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:\"createMergerMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=this._getNickAndAvatarByUserID(t),o=new Wa(e),s=new Ha(e.payload);return o.setElement(s),o.setNickAndAvatar(n),o.setNameCard(this._getNameCardByGroupID(o)),o.setRelayFlag(!0),o}},{key:\"createForwardMessage\",value:function(e){var t=e.to,n=e.conversationType,o=e.priority,s=e.payload,a=e.needReadReceipt,i=e.receiverList,r=this.getMyUserID(),u=this._getNickAndAvatarByUserID(r);if(s.type===E.MSG_GRP_TIP)return Za({code:ha.MESSAGE_FORWARD_TYPE_INVALID});var c={to:t,conversationType:n,conversationID:\"\".concat(n).concat(t),priority:o,isPlaceMessage:0,status:Qt.UNSEND,currentUser:r,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||s.cloudCustomData||\"\",needReadReceipt:a,receiverList:i,isSupportExtension:e.isSupportExtension||!1},l=new Wa(c);return l.setElement(s.getElements()[0]),l.setNickAndAvatar(u),l.setNameCard(this._getNameCardByGroupID(s)),l.setRelayFlag(!0),l}},{key:\"downloadMergerMessage\",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:\"createFileMessage\",value:function(e){if(ae){if(!X&&!Q&&!oe)return;var n=re.getSystemInfoSync().SDKVersion;if(X&&Gt(n,\"2.5.0\")<0)return void this.outputWarning(\"WXChooseMessageFile\");if(Q&&Gt(n,\"1.18.0\")<0)return void this.outputWarning(\"QQChooseMessageFile\")}if(ie||oe){if($e(e.payload.file)){var o=e.payload.file;e.payload.file={files:[o]}}else if(st(e.payload.file)&&\"undefined\"!=typeof uni){var s=e.payload.file,a=s.tempFiles,i=s.files,r=null;at(a)?r=a[0]:at(i)&&(r=i[0]),e.payload.file={files:[r]}}}else if(X||Q){var u=e.payload.file.tempFiles,c=t(t({},u[0]),{},{url:u[0].path});e.payload.file={files:[c]}}var l=this.getMyUserID();e.currentUser=l,e.senderTinyID=this.getMyTinyID();var d=new Wa(e),p=new Fa({uuid:this._generateUUID(e.payload.file),file:e.payload.file}),g=this._getNickAndAvatarByUserID(l);return d.setElement(p),d.setNickAndAvatar(g),d.setNameCard(this._getNameCardByGroupID(d)),this._messageOptionsMap.set(d.clientSequence,e),d}},{key:\"createLocationMessage\",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Wa(e),o=new Va(e.payload),s=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(s),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:\"_onCannotFindModule\",value:function(){return Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"sendMessageInstance\",value:function(e,t){var n=this;if(!1===this.getModule(oo).filterMessage(e,t))return this._onSendMessageFailed(e,new ja({code:ha.PROFANITY_FOUND}));var o,s=null;switch(e.conversationType){case E.CONV_C2C:if(!(s=this.getModule(Un)))return this._onCannotFindModule();break;case E.CONV_GROUP:if(!(s=this.getModule(Pn)))return this._onCannotFindModule();if(Dt({groupID:e.to})){var a=s.getLocalGroupProfile(e.to);if(a&&a.isSupportTopic)return Za({code:ha.MESSAGE_SEND_GROUP_WITH_TOPIC_FAIL})}break;default:return Za({code:ha.MESSAGE_SEND_INVALID_CONVERSATION_TYPE})}var i=this.getModule(Wn),r=this.getModule(Pn);return i.upload(e).then((function(){n._getSendMessageSpecifiedKey(e)===ya&&n.getModule(eo).addSuccessCount(Ia);return r.guardForAVChatRoom(e).then((function(){if(!e.isSendable())return Za({code:ha.MESSAGE_FILE_URL_IS_EMPTY});n._addSendMessageTotalCount(e),o=Date.now();var a=function(e){var t=\"utf-8\";ie&&document&&(t=document.charset.toLowerCase());var n,o,s=0;if(o=e.length,\"utf-8\"===t||\"utf8\"===t)for(var a=0;a<o;a++)(n=e.codePointAt(a))<=127?s+=1:n<=2047?s+=2:n<=65535?s+=3:(s+=4,a++);else if(\"utf-16\"===t||\"utf16\"===t)for(var i=0;i<o;i++)(n=e.codePointAt(i))<=65535?s+=2:(s+=4,i++);else s=e.replace(/[^\\x00-\\xff]/g,\"aa\").length;return s}(JSON.stringify(e));return e.type===E.MSG_MERGER&&a>11264?n._mergerMessageHandler.uploadMergerMessage(e,a).then((function(o){var s=n._mergerMessageHandler.createMergerMessagePack(e,t,o);return n.request(s)})):(n.getModule(qn).setMessageRandom(e),e.conversationType===E.CONV_C2C||e.conversationType===E.CONV_GROUP?s.sendMessage(e,t):void 0)})).then((function(a){var i=a.data,r=i.time,u=i.sequence,c=i.readReceiptCode;et(c)&&0!==c&&(new Aa(\"sendMessageWithReceipt\").setMessage(\"from:\".concat(e.from,\" to:\").concat(e.to,\" sequence:\").concat(u,\" readReceiptCode:\").concat(c)).end(),Ve.w(\"\".concat(n._n,\".sendMessageInstance readReceiptCode:\").concat(c,\" message:\").concat(n.getErrorMessage(c))));n._addSendMessageSuccessCount(e,o),n._messageOptionsMap.delete(e.clientSequence);var l=n.getModule(qn);e.status=Qt.SUCCESS,e.time=r;var d=!1;if(e.conversationType===E.CONV_GROUP)e.sequence=u;else if(e.conversationType===E.CONV_C2C){var p=l.getLatestMessageSentByMe(e.conversationID);if(p){var g=p.nick,h=p.avatar;g===e.nick&&h===e.avatar||(d=!0)}}if(d&&l.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),s.isOnlineMessage(e,t))e._onlineOnlyFlag=!0;else{l.appendToMessageList(e);var _=e;st(t)&&st(t.messageControlInfo)&&(!0===t.messageControlInfo.excludedFromLastMessage&&(e._isExcludedFromLastMessage=!0,_=\"\"),!0===t.messageControlInfo.excludedFromUnreadCount&&(e._isExcludedFromUnreadCount=!0));var f=e.conversationType;if(kt(e.to))f=E.CONV_TOPIC,n.getModule(Fn).onMessageSent({groupID:xt(e.to),topicID:e.to,lastMessage:_});l.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:f,subType:e.conversationSubType,lastMessage:_}]})}return e.getRelayFlag()||\"TIMImageElem\"!==e.type||Pt(e.payload.imageInfoArray),Ya({message:e})}))})).catch((function(t){return n._onSendMessageFailed(e,t)}))}},{key:\"_onSendMessageFailed\",value:function(e,t){e.status=Qt.FAIL,this.getModule(qn).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new Aa(\"sendMessage\");return n.setMessage(\"tjg_id:\".concat(this.generateTjgID(e),\" type:\").concat(e.type,\" from:\").concat(e.from,\" to:\").concat(e.to)),this.probeNetwork().then((function(e){var o=v(e,2),s=o[0],a=o[1];n.setError(t,s,a).end()})),Ve.e(\"\".concat(this._n,\"._onSendMessageFailed error:\"),t),Za(new ja({code:t&&t.code?t.code:ha.MESSAGE_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:\"_getSendMessageSpecifiedKey\",value:function(e){if([E.MSG_IMAGE,E.MSG_AUDIO,E.MSG_VIDEO,E.MSG_FILE].includes(e.type))return ya;if(e.conversationType===E.CONV_C2C)return va;if(e.conversationType===E.CONV_GROUP){var t=this.getModule(Pn).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return Tt(n)?Ma:ma}}},{key:\"_addSendMessageTotalCount\",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(eo).addTotalCount(t)}},{key:\"_addSendMessageSuccessCount\",value:function(e,t){var n=Math.abs(Date.now()-t),o=this._getSendMessageSpecifiedKey(e);if(o){var s=this.getModule(eo);s.addSuccessCount(o),s.addCost(o,n)}}},{key:\"_addSendMessageFailCountOnUser\",value:function(e,t){var n,o,s=t.code,a=void 0===s?-1:s,i=this.getModule(eo),r=this._getSendMessageSpecifiedKey(e);r===ya&&(n=a,o=!1,vr.includes(n)&&(o=!0),o)?i.addFailedCountOfUserSide(Ia):mr(a)&&r&&i.addFailedCountOfUserSide(r)}},{key:\"resendMessage\",value:function(e){return e.isResend=!0,e.status=Qt.UNSEND,this.sendMessageInstance(e)}},{key:\"revokeMessage\",value:function(e){var t=this,n=null;if(e.conversationType===E.CONV_C2C?n=this.getModule(Un):e.conversationType===E.CONV_GROUP&&(n=this.getModule(Pn)),!n)return this._onCannotFindModule();var o=new Aa(\"revokeMessage\");o.setMessage(\"tjg_id:\".concat(this.generateTjgID(e),\" type:\").concat(e.type,\" from:\").concat(e.from,\" to:\").concat(e.to));var s=\"\".concat(this._n,\".\").concat(\"revokeMessage\");return n.revokeMessage(e).then((function(n){var a=n.data.recallRetList;if(!zt(a)&&0!==a[0].retCode){var i=new ja({code:a[0].retCode,data:{message:e}});return o.setCode(i.code).setMoreMessage(i.message).end(),Za(i)}return Ve.i(\"\".concat(s,\" ok. ID:\").concat(e.ID)),e.isRevoked=!0,o.end(),t.getModule(qn).onMessageRevoked([e]),Ya({message:e})})).catch((function(n){t.probeNetwork().then((function(e){var t=v(e,2),s=t[0],a=t[1];o.setError(n,s,a).end()}));var a=new ja({code:n&&n.code?n.code:ha.MESSAGE_REVOKE_FAIL,message:n&&n.message?n.message:void 0,data:{message:e}});return Ve.w(\"\".concat(s,\" failed. error:\"),n),Za(a)}))}},{key:\"deleteMessage\",value:function(e){var t=this,n=null,o=e[0],s=o.conversationID,a=\"\",i=[],r=[];if(o.conversationType===E.CONV_C2C)n=this.getModule(Un),a=s.replace(E.CONV_C2C,\"\"),e.forEach((function(e){e&&e.status===Qt.SUCCESS&&e.conversationID===s&&(e._onlineOnlyFlag||i.push(\"\".concat(e.sequence,\"_\").concat(e.random,\"_\").concat(e.time)),r.push(e))}));else if(o.conversationType===E.CONV_GROUP)n=this.getModule(Pn),a=s.replace(E.CONV_GROUP,\"\"),e.forEach((function(e){e&&e.status===Qt.SUCCESS&&e.conversationID===s&&(e._onlineOnlyFlag||i.push(\"\".concat(e.sequence)),r.push(e))}));else if(o.conversationType===E.CONV_SYSTEM)return Za({code:ha.CANNOT_DELETE_GROUP_SYSTEM_NOTICE});if(!n)return this._onCannotFindModule();if(0===i.length)return this._onMessageDeleted(r);i.length>30&&(i=i.slice(0,30),r=r.slice(0,30));var u=new Aa(\"deleteMessage\");u.setMessage(\"to:\".concat(a,\" count:\").concat(i.length));var c=\"\".concat(this._n,\".\").concat(\"deleteMessage\");return n.deleteMessage({to:a,keyList:i}).then((function(e){return u.end(),Ve.i(\"\".concat(c,\" ok\")),t._onMessageDeleted(r)})).catch((function(e){t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.w(\"\".concat(c,\" failed. error:\"),e);var n=new ja({code:e&&e.code?e.code:ha.MESSAGE_DELETE_FAIL,message:e&&e.message?e.message:void 0});return Za(n)}))}},{key:\"_onMessageDeleted\",value:function(e){return this.getModule(qn).onMessageDeleted(e),Xa({messageList:e})}},{key:\"translateText\",value:function(e){var n=\"\".concat(this._n,\".\").concat(\"translateText\"),o=e.sourceTextList,s=e.sourceLanguage,a=e.targetLanguage,i=new Aa(\"translateText\");return i.setMessage(\"sourceLanguage:\".concat(s,\" targetLanguage:\").concat(a)),this.request({protocolName:ga,requestData:{sourceTextList:o,source:s||\"auto\",target:a,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then((function(e){var o=e.data,s=o.error,a=o.requestID,r=o.translatedTextList;if(0===s.code)return i.end(),Ve.i(\"\".concat(n,\" ok. requestID:\").concat(a)),Ya({translatedTextList:r});throw t(t({},s),{},{requestID:a})})).catch((function(e){return i.setCode(e.code).setMoreMessage(e.requestID).end(),Ve.w(\"\".concat(n,\" failed. error:\"),e),Za({code:ha.TRANSLATE_TEXT_FAIL})}))}},{key:\"modifyRemoteMessage\",value:function(e){var t=this,n=null,o=e.conversationType,s=e.to;if(this.getModule(Pn).isMessageFromOrToAVChatroom(s))return Za({code:ha.MESSAGE_MODIFY_DISABLED_IN_AVCHATROOM,data:{message:e}});if(!1===this.getModule(oo).filterMessage(e))return Za({code:ha.PROFANITY_FOUND,data:{message:e}});o===E.CONV_C2C?n=this.getModule(Un):o===E.CONV_GROUP&&(n=this.getModule(Pn));var a=new Aa(\"modifyMessage\");a.setMessage(\"to:\".concat(s));var i=\"\".concat(this._n,\".modifyRemoteMessage\");return n.modifyRemoteMessage(e).then((function(n){a.end(),Ve.i(\"\".concat(i,\" ok\"));var o=t._onModifyRemoteMessageResp(e,n.data);return Ya({message:o})})).catch((function(n){if(a.setCode(n.code).setMoreMessage(n.message).end(),Ve.w(\"\".concat(i,\" failed. error:\"),n),20027===n.code){var o=t._onModifyRemoteMessageResp(e,n.data);return Za({code:ha.MESSAGE_MODIFY_CONFLICT,data:{message:o}})}return Za({code:n.code,message:n.message,data:{message:e}})}))}},{key:\"_onModifyRemoteMessageResp\",value:function(e,t){Ve.d(\"\".concat(this._n,\"._onModifyRemoteMessageResp options:\"),t);var n=e.conversationType,o=e.from,s=e.to,a=e.random,i=e.sequence,r=e.time,u=t.elements,c=t.messageVersion,l=t.cloudCustomData,d=void 0===l?\"\":l;return this.getModule(qn).onMessageModified({conversationType:n,from:o,to:s,time:r,random:a,sequence:i,elements:u,cloudCustomData:d,messageVersion:c})}},{key:\"_generateUUID\",value:function(e){var t=this.getModule(xn),n=\"\".concat(t.getSDKAppID(),\"-\").concat(t.getUserID(),\"-\").concat(function(){for(var e=\"\",t=32;t>0;--t)e+=ft[Math.floor(Math.random()*vt)];return e}()),o=e.name||e.value||e.url||e.tempFilePath,s=o&&o.slice(o.lastIndexOf(\".\")+1);return s&&(n=\"\".concat(n,\".\").concat(s)),n}},{key:\"getMessageOption\",value:function(e){return this._messageOptionsMap.get(e)}},{key:\"_getNickAndAvatarByUserID\",value:function(e){return this.getModule(Gn).getNickAndAvatarByUserID(e)}},{key:\"_getNameCardByGroupID\",value:function(e){if(e.conversationType===E.CONV_GROUP){var t=this.getModule(Pn);if(t)return t.getMyNameCardByGroupID(e.to)}return\"\"}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._messageOptionsMap.clear()}}]),s}(uo),yr=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"MessageExtensionModule\",s.messageExtensionMap=new Map,s.globalSeqMap=new Map,s.getMessageExtensionsMap=new Map,s}return a(n,[{key:\"onMessageExtensionNotify\",value:function(e){var t=this,n=e.dataList,o=n.messageInfo,s=n.operateType,a=n.operateResultList,i=n.tinyID,r=n.globalSequence,u=o.clientTime,c=o.random,l=\"\".concat(i,\"-\").concat(u,\"-\").concat(c),d=[],p=[];Ve.l(\"\".concat(this._n,\".onMessageExtensionNotify messageID:\").concat(l,\" operateType:\").concat(s,\" globalSequence:\").concat(r)),this._updateGlobalSequence(l,r);var g=!1,h=!1;a.forEach((function(e){var n=e.extensions,o=void 0===n?[]:n,a=e.clearSequence;if(1===s)g=!0,o.forEach((function(e){d.push({key:e.key,value:e.value})})),t._updateLocalExtension(l,o);else if(2===s)h=!0,o.forEach((function(e){p.push(e.key)})),t._updateLocalExtension(l,o);else if(3===s){if(h=!0,t._hasLocalExtension(l))t._getLocalExtension(l).forEach((function(e,t){e.seq<=a&&!zt(e.value)&&p.push(t)}));t._clearLocalExtension(l,a)}})),g&&this.emitOuterEvent(k.MESSAGE_EXTENSIONS_UPDATED,{messageID:l,extensions:d}),h&&this.emitOuterEvent(k.MESSAGE_EXTENSIONS_DELETED,{messageID:l,keyList:p})}},{key:\"setMessageExtensions\",value:function(e,t){var n=this;if(!this.canIUse(B.MSG_EXT))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var o=\"\".concat(this._n,\".\").concat(\"setMessageExtensions\"),s=e.ID,a=e.conversationID,i=e.sequence,r=e.time,u=m(t);t.length>20&&(u=t.slice(0,20),Ve.w(\"\".concat(o,\". the length of extensions cannot exceed 20.\")));var c=\"conversationID:\".concat(a,\" messageID:\").concat(s,\" sequence:\").concat(i,\" time:\").concat(r,\" count:\").concat(u.length),l=new Aa(\"setMessageExtensions\");return l.setMessage(c),Ve.l(\"\".concat(o,\" \").concat(c)),this._modifyMessageExtensions(e,u).then((function(e){var t=e.resultList,n=e.successCount,s=e.failureCount,a=\"success count:\".concat(n,\" fail count:\").concat(s);return l.setMoreMessage(a).end(),Ve.l(\"\".concat(o,\" ok. \").concat(a)),Ya({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];l.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"getMessageExtensions\",value:function(e){var t=this;if(!this.canIUse(B.MSG_EXT))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var n=\"\".concat(this._n,\".\").concat(\"getMessageExtensions\"),o=e.ID,s=e.conversationID,a=e.sequence,i=e.time,r=\"conversationID:\".concat(s,\" messageID:\").concat(o,\" sequence:\").concat(a,\" time:\").concat(i),u=new Aa(\"getMessageExtensions\");u.setMessage(r),Ve.l(\"\".concat(n,\" \").concat(r));var c=void 0;return this.getMessageExtensionsMap.has(o)&&(c=this._getGlobalSequence(o)),this._getMessageExtensions(e,c).then((function(e){return u.end(),Ve.l(\"\".concat(n,\" ok. total count:\").concat(e.length)),it(c)&&e.length>0&&t.getMessageExtensionsMap.set(o,1),Ya({extensions:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];u.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"deleteMessageExtensions\",value:function(e,t){var n=this;if(!this.canIUse(B.MSG_EXT))return Za({code:ha.CANNOT_USE_COMMERCIAL_ABILITY});var o=\"\".concat(this._n,\".\").concat(\"deleteMessageExtensions\"),s=[],a=3;zt(t)||(a=2,t.forEach((function(e){s.push({key:e,value:\"\",seq:0})})));var i=e.ID,r=e.conversationID,u=e.sequence,c=e.time,l=\"conversationID:\".concat(r,\" messageID:\").concat(i,\" sequence:\").concat(u,\" time:\").concat(c,\" operateType:\").concat(a),d=new Aa(\"deleteMessageExtensions\");return d.setMessage(l),Ve.l(\"\".concat(o,\" \").concat(l)),this._modifyMessageExtensions(e,s,a).then((function(e){var t=e.resultList,n=e.successCount,s=e.failureCount,i=\"\";return 2===a&&(i=\"success count:\".concat(n,\" fail count:\").concat(s)),d.setMoreMessage(\"\".concat(i)).end(),Ve.l(\"\".concat(o,\" ok. \").concat(i)),Ya({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];d.setError(e,o,s).end()})),Ve.e(\"\".concat(o,\" failed. error:\"),e),Za(e)}))}},{key:\"_modifyMessageExtensions\",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=kt(e.to)?E.CONV_TOPIC:e.conversationType,a=void 0;3!==o&&(a=this._getRequestExtensions(e,t));var i=null;switch(s){case E.CONV_C2C:i=this.getModule(Un);break;case E.CONV_GROUP:i=this.getModule(Pn);break;case E.CONV_TOPIC:i=this.getModule(Fn);break;default:return Za({code:ha.CANNOT_FIND_MODULE})}return i.modifyMessageExtensions(e,a,o).then((function(t){var o=t.data,s=o.extensions,a=o.seq,i=[],r=0,u=0,c=[];return(s=zt(s)?[]:s).forEach((function(e){var t=e.errorCode,n=e.extension,o=n.key,s=n.value,a=n.seq;i.push({code:t,key:o,value:s}),0===t?r++:u++,c.push({key:o,value:s,seq:a})})),n._updateGlobalSequence(e.ID,a),c.length>0&&(n._updateLocalExtension(e.ID,c),c=null),{resultList:i,successCount:r,failureCount:u}})).catch((function(e){return Za(e)}))}},{key:\"_getRequestExtensions\",value:function(e,t){var n=[];if(this._hasLocalExtension(e.ID)){var o=this._getLocalExtension(e.ID);return t.forEach((function(e){var t=e.key,s=e.value,a=0;o.has(t)&&(a=o.get(t).seq),n.push({key:t,value:s,seq:a})})),n}return t.forEach((function(e){var t=e.key,o=e.value;n.push({key:t,value:o,seq:0})})),n}},{key:\"_getMessageExtensions\",value:function(e,t){var n=this,o=\"\".concat(this._n,\"._getMessageExtensions\"),s=e.ID,a=e.to,i=null;switch(kt(a)?E.CONV_TOPIC:e.conversationType){case E.CONV_C2C:i=this.getModule(Un);break;case E.CONV_GROUP:i=this.getModule(Pn);break;case E.CONV_TOPIC:i=this.getModule(Fn);break;default:return Za({code:ha.CANNOT_FIND_MODULE})}return i.getMessageExtensions(e,t).then((function(t){var a=t.data,i=a.extensions,r=a.completeFlag,u=a.globalSequence,c=a.clearSequence;if(i=zt(i)?[]:i,Ve.l(\"\".concat(o,\" ok. completeFlag:\").concat(r,\" globalSequence:\").concat(u,\" clearSequence:\").concat(c,\" count:\").concat(i.length)),n._updateLocalExtension(s,i),n._clearLocalExtension(s,c),n._updateGlobalSequence(s,u),1!==r){var l=i.slice(-1)[0].seq+1;return n._getMessageExtensions(e,l)}return n._getLocalExtensions(s)})).catch((function(e){return Za(e)}))}},{key:\"_hasLocalExtension\",value:function(e){return this.messageExtensionMap.has(e)}},{key:\"_getLocalExtension\",value:function(e){return this.messageExtensionMap.get(e)}},{key:\"_updateLocalExtension\",value:function(e,t){this._hasLocalExtension(e)||this.messageExtensionMap.set(e,new Map);var n=this._getLocalExtension(e);t.forEach((function(e){var t=e.key,o=e.value,s=void 0===o?\"\":o,a=e.seq;n.set(t,{value:s,seq:a})}))}},{key:\"_clearLocalExtension\",value:function(e,t){if(!(t<=0)&&this._hasLocalExtension(e)){var n=this._getLocalExtension(e);n.forEach((function(e,o){e.seq<=t&&n.delete(o)}))}}},{key:\"_getLocalExtensions\",value:function(e){var t=[];this._hasLocalExtension(e)&&this._getLocalExtension(e).forEach((function(e,n){var o=e.value;zt(o)||t.push({key:n,value:o})}));return t}},{key:\"_getGlobalSequence\",value:function(e){return this.globalSeqMap.get(e)}},{key:\"_updateGlobalSequence\",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this.messageExtensionMap.clear(),this.globalSeqMap.clear(),this.getMessageExtensionsMap.clear()}}]),n}(uo),Ir=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"ComboMessageModule\",s}return a(n,[{key:\"sendMessage\",value:function(e){var t=this,n=this._constructMessageInstance(e);if(null===n)return Za({code:ha.MESSAGE_SEND_FAIL});this._addSendMessageTotalCount(n);var o=Date.now();return this.getModule(qn).setMessageRandom(n),this._sendComboMessage(n,e).then((function(e){var s=e.data,a=s.time,i=s.sequence,r=s.readReceiptCode;et(r)&&0!==r&&(new Aa(\"sendMessageWithReceipt\").setMessage(\"from:\".concat(n.from,\" to:\").concat(n.to,\" sequence:\").concat(i,\" readReceiptCode:\").concat(r)).end(),Ve.w(\"\".concat(t._n,\".sendMessage readReceiptCode:\").concat(r,\" message:\").concat(t.getErrorMessage(r))));t._addSendMessageSuccessCount(n,o);var u=t.getModule(qn);n.status=Qt.SUCCESS,n.time=a,n.conversationType===E.CONV_GROUP&&(n.sequence=i),u.appendToMessageList(n);var c=n;return!0===n._isExcludedFromLastMessage&&(c=\"\"),u.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:c}]}),Ya({message:n})})).catch((function(e){return t._onSendMessageFailed(n,e)}))}},{key:\"_sendComboMessage\",value:function(e,t){var n=this._m.getModule(zn),o=\"\";return e.conversationType===E.CONV_C2C&&(o=\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.SEND_MESSAGE)),e.conversationType===E.CONV_GROUP&&(o=\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.SEND_GROUP_MESSAGE)),n.sendComboMessage({servcmd:o,data:t})}},{key:\"_constructMessageInstance\",value:function(e){var t=\"\".concat(this._n,\"._constructMessageInstance\"),n=null;try{var o=this.getMyUserID(),s={};if(s.senderTinyID=this.getMyTinyID(),s.currentUser=o,s.from=e.From_Account||o,e.GroupId?(s.conversationID=\"\".concat(E.CONV_GROUP).concat(e.GroupId),s.conversationType=E.CONV_GROUP,s.to=e.GroupId):e.To_Account&&(s.conversationID=\"\".concat(E.CONV_C2C).concat(e.To_Account),s.conversationType=E.CONV_C2C,s.to=e.To_Account),s.time=e.MsgTimeStamp||0,s.random=e.Random||e.MsgRandom||0,s.priority=e.MsgPriority,nt(e.CloudCustomData)&&e.CloudCustomData.length>0&&(s.cloudCustomData=e.CloudCustomData),at(e.SendMsgControl)&&(s.messageControlInfo={},e.SendMsgControl.includes(\"NoUnread\")&&(s.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes(\"NoLastMsg\")&&(s.messageControlInfo.excludedFromLastMessage=1)),s.conversationType===E.CONV_GROUP&&at(e.To_Account)&&e.To_Account.length>0){var a=e.To_Account;e.To_Account.length>50&&(a=e.To_Account.slice(0,50),Ve.w(\"\".concat(t,\" To_Account must be less than or equal to 50.\"))),s.receiverList=m(a),e.To_Account=m(a)}1!==e.IsNeedReadReceipt&&1!==e.NeedReadReceipt||(s.needReadReceipt=!0),1===e.SupportMessageExtension&&(s.isSupportExtension=!0),(n=new Wa(s)).status=Qt.UNSEND,e.MsgClientTime=n.clientTime,n.conversationType===E.CONV_C2C&&(e.MsgSeq=n.sequence);for(var i,r=e.MsgBody.length,u=0;u<r;u++)\"TIMTextElem\"===(i=e.MsgBody[u]).MsgType?n.setTextElement(i.MsgContent.Text):\"TIMCustomElem\"===i.MsgType?n.setCustomElement({data:i.MsgContent.Data||\"\",description:i.MsgContent.Desc||\"\",extension:i.MsgContent.Ext||\"\"}):\"TIMFaceElem\"===i.MsgType&&n.setFaceElement({index:i.MsgContent.Index,data:i.MsgContent.Data});var c=n.getElements();n.payload=c[0].content,n.type=c[0].type}catch(l){n=null,Ve.e(\"\".concat(t,\" failed. error:\"),l)}return n}},{key:\"_onSendMessageFailed\",value:function(e,t){e.status=Qt.FAIL,this.getModule(qn).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new Aa(\"sendMessage\");return n.setMessage(\"tjg_id:\".concat(this.generateTjgID(e),\" type:\").concat(e.type,\" from:\").concat(e.from,\" to:\").concat(e.to)),this.probeNetwork().then((function(e){var o=v(e,2),s=o[0],a=o[1];n.setError(t,s,a).end()})),Ve.e(\"\".concat(this._n,\"._onSendMessageFailed error:\"),t),Za(new ja({code:t&&t.code?t.code:ha.MESSAGE_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:\"_getSendMessageSpecifiedKey\",value:function(e){if(e.conversationType===E.CONV_C2C)return va;if(e.conversationType===E.CONV_GROUP){var t=this.getModule(Pn).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return Tt(n)?Ma:ma}}},{key:\"_addSendMessageTotalCount\",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(eo).addTotalCount(t)}},{key:\"_addSendMessageSuccessCount\",value:function(e,t){var n=Math.abs(Date.now()-t),o=this._getSendMessageSpecifiedKey(e);if(o){var s=this.getModule(eo);s.addSuccessCount(o),s.addCost(o,n)}}},{key:\"_addSendMessageFailCountOnUser\",value:function(e,t){var n=t.code,o=void 0===n?-1:n,s=this.getModule(eo),a=this._getSendMessageSpecifiedKey(e);mr(o)&&a&&s.addFailedCountOfUserSide(a)}}]),n}(uo),Cr=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"PluginModule\",s.plugins={},s}return a(n,[{key:\"registerPlugin\",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.plugins[n]=e[n]})),new Aa(\"registerPlugin\").setMessage(\"\".concat(Object.keys(e))).end()}},{key:\"getPlugin\",value:function(e){return this.plugins[e]}},{key:\"reset\",value:function(){}}]),n}(uo),Tr=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"SyncUnreadMessageModule\",t._cookie=\"\",t._onlineSyncFlag=!1,t.getInnerEmitterInstance().on(ei,t._onLoginSuccess,h(t)),t}return a(s,[{key:\"_onLoginSuccess\",value:function(e){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:\"_startSync\",value:function(e){var n=this,o=e.cookie,s=e.syncFlag,a=e.isOnlineSync,i=\"\".concat(this._n,\"._startSync\");Ve.l(\"\".concat(i,\" cookie:\").concat(o,\" syncFlag:\").concat(s,\" isOnlineSync:\").concat(a)),this.request({protocolName:ho,requestData:{cookie:o,syncFlag:s,isOnlineSync:a}}).then((function(e){var o=e.data,s=o.cookie,a=o.syncFlag;n._cookie=s,zt(s)||(0===a||1===a?(n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!1})),n._startSync({cookie:s,syncFlag:a,isOnlineSync:0})):2===a&&n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!0})))})).catch((function(e){Ve.e(\"\".concat(i,\" failed. error:\"),e)}))}},{key:\"_dispatchUnreadMessage\",value:function(e){e.eventArray&&this.getModule(zn).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}});this.getModule(Un).onNewC2CMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList})}},{key:\"startOnlineSync\",value:function(){Ve.l(\"\".concat(this._n,\".startOnlineSync\")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:\"startSyncOnReconnected\",value:function(){Ve.l(\"\".concat(this._n,\".startSyncOnReconnected.\")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._onlineSyncFlag=!1,this._cookie=\"\"}}]),s}(uo),Dr={request:{toAccount:\"To_Account\",fromAccount:\"From_Account\",to:\"To_Account\",from:\"From_Account\",groupID:\"GroupId\",groupAtUserID:\"GroupAt_Account\",extension:\"Ext\",data:\"Data\",description:\"Desc\",elements:\"MsgBody\",sizeType:\"Type\",downloadFlag:\"Download_Flag\",thumbUUID:\"ThumbUUID\",videoUUID:\"VideoUUID\",remoteAudioUrl:\"Url\",remoteVideoUrl:\"VideoUrl\",videoUrl:\"\",imageUrl:\"URL\",fileUrl:\"Url\",uuid:\"UUID\",priority:\"MsgPriority\",receiverUserID:\"To_Account\",receiverGroupID:\"GroupId\",messageSender:\"SenderId\",messageReceiver:\"ReceiverId\",nick:\"From_AccountNick\",avatar:\"From_AccountHeadurl\",messageNumber:\"MsgNum\",pbDownloadKey:\"PbMsgKey\",downloadKey:\"JsonMsgKey\",applicationType:\"PendencyType\",userIDList:\"To_Account\",groupNameList:\"GroupName\",userID:\"To_Account\",groupAttributeList:\"GroupAttr\",mainSequence:\"AttrMainSeq\",avChatRoomKey:\"BytesKey\",attributeControl:\"AttrControl\",sequence:\"seq\",messageControlInfo:\"SendMsgControl\",updateSequence:\"UpdateSeq\",clientTime:\"MsgClientTime\",sequenceList:\"MsgSeqList\",topicID:\"TopicId\",customData:\"CustomString\",isSupportTopic:\"SupportTopic\",isWebUniapp:\"is_web_uniapp\",isSupportExtension:\"SupportMessageExtension\",messageSequence:\"MsgSeq\",messageKey:\"MsgKey\",startSequence:\"startSeq\",simplifiedMessage:\"DownsizeFlag\"},response:{MsgPriority:\"priority\",ThumbUUID:\"thumbUUID\",VideoUUID:\"videoUUID\",Download_Flag:\"downloadFlag\",GroupId:\"groupID\",Member_Account:\"userID\",MsgList:\"messageList\",SyncFlag:\"syncFlag\",To_Account:\"to\",From_Account:\"from\",MsgSeq:\"sequence\",MsgRandom:\"random\",MsgTime:\"time\",MsgTimeStamp:\"time\",MsgContent:\"content\",MsgBody:\"elements\",From_AccountNick:\"nick\",From_AccountHeadurl:\"avatar\",GroupWithdrawInfoArray:\"revokedInfos\",GroupReadInfoArray:\"groupMessageReadNotice\",LastReadMsgSeq:\"lastMessageSeq\",WithdrawC2cMsgNotify:\"c2cMessageRevokedNotify\",C2cWithdrawInfoArray:\"revokedInfos\",C2cReadedReceipt:\"c2cMessageReadReceipt\",ReadC2cMsgNotify:\"c2cMessageReadNotice\",LastReadTime:\"peerReadTime\",MsgRand:\"random\",MsgType:\"type\",MsgShow:\"messageShow\",NextMsgSeq:\"nextMessageSeq\",FaceUrl:\"avatar\",ProfileDataMod:\"profileModify\",Profile_Account:\"userID\",ValueBytes:\"value\",ValueNum:\"value\",NoticeSeq:\"noticeSequence\",NotifySeq:\"notifySequence\",MsgFrom_AccountExtraInfo:\"messageFromAccountExtraInformation\",Operator_Account:\"operatorID\",OpType:\"operationType\",ReportType:\"operationType\",UserId:\"userID\",User_Account:\"userID\",List_Account:\"userIDList\",MsgOperatorMemberExtraInfo:\"operatorInfo\",MsgMemberExtraInfo:\"memberInfoList\",ImageUrl:\"avatar\",NickName:\"nick\",MsgGroupNewInfo:\"newGroupProfile\",MsgAppDefinedData:\"groupCustomField\",Owner_Account:\"ownerID\",GroupFaceUrl:\"avatar\",GroupIntroduction:\"introduction\",GroupNotification:\"notification\",GroupApplyJoinOption:\"joinOption\",MsgKey:\"messageKey\",GroupInfo:\"groupProfile\",ShutupTime:\"muteTime\",Desc:\"description\",Ext:\"extension\",GroupAt_Account:\"groupAtUserID\",MsgNum:\"messageNumber\",PbMsgKey:\"pbDownloadKey\",JsonMsgKey:\"downloadKey\",MsgModifiedFlag:\"isModified\",PendencyItem:\"applicationItem\",PendencyType:\"applicationType\",AddTime:\"time\",AddSource:\"source\",AddWording:\"wording\",ProfileImImage:\"avatar\",PendencyAdd:\"friendApplicationAdded\",FrienPencydDel_Account:\"friendApplicationDeletedUserIDList\",Peer_Account:\"userID\",GroupAttr:\"groupAttributeList\",GroupAttrAry:\"groupAttributeList\",AttrMainSeq:\"mainSequence\",seq:\"sequence\",GroupAttrOption:\"groupAttributeOption\",BytesChangedKeys:\"changedKeyList\",GroupAttrInfo:\"groupAttributeList\",GroupAttrSeq:\"mainSequence\",PushChangedAttrValFlag:\"isWithChangedAttributeInfo\",SubKeySeq:\"sequence\",Val:\"value\",MsgGroupFromCardName:\"senderNameCard\",MsgGroupFromNickName:\"senderNick\",C2cNick:\"peerNick\",C2cImage:\"peerAvatar\",SendMsgControl:\"messageControlInfo\",NoLastMsg:\"excludedFromLastMessage\",NoUnread:\"excludedFromUnreadCount\",UpdateSeq:\"updateSequence\",MuteNotifications:\"muteFlag\",MsgClientTime:\"clientTime\",TinyId:\"tinyID\",GroupMsgReceiptList:\"readReceiptList\",ReadNum:\"readCount\",UnreadNum:\"unreadCount\",TopicId:\"topicID\",MillionGroupFlag:\"communityType\",SupportTopic:\"isSupportTopic\",MsgTopicNewInfo:\"newTopicInfo\",ShutupAll:\"muteAllMembers\",CustomString:\"customData\",TopicFaceUrl:\"avatar\",TopicIntroduction:\"introduction\",TopicNotification:\"notification\",TopicIdArray:\"topicIDList\",MsgVersion:\"messageVersion\",C2cMsgModNotifys:\"c2cMessageModified\",GroupMsgModNotifys:\"groupMessageModified\",ApplyJoinOption:\"joinOption\",MsgFlag:\"messageRemindType\",AtInfoList:\"groupAtInfoList\",AtFlagList:\"groupAtType\",AtMsgSeq:\"sequence\",BanDuration:\"duration\",BanDescription:\"reason\",NotVisible:\"invisible\",BytesTag:\"tag\",BytesValue:\"value\",RptBytesValue:\"value\",LatestSeq:\"globalSequence\",ClearSeq:\"clearSequence\",SupportMessageExtension:\"isSupportExtension\",ExtensionList:\"extensions\",GroupCounter:\"counterList\",Revoker_Account:\"revoker\",MsgExtensionNotify:\"messageExtensionNotify\",ExtensionC2cMsgInfo:\"messageInfo\",ExtensionGroupMsgInfo:\"messageInfo\",MsgOptType:\"operateType\",SetKVInfo:\"operateResultList\",DeleteKVInfo:\"operateResultList\",ClearKVInfo:\"operateResultList\",MsgKeyValue:\"extensions\",ClearMsgSeq:\"clearSequence\",MsgLastSeq:\"globalSequence\",InviteJoinOption:\"inviteOption\",MemberList_Account:\"inviteeList\",MsgMemberExtraInfoList:\"inviteeInfoList\",E:\"event\",GInf:\"groupProfile\",MCT:\"clientTime\",MR:\"random\",MP:\"priority\",MTS:\"time\",GId:\"groupID\",MS:\"sequence\",CCD:\"cloudCustomData\",F_Account:\"from\",F_Hd:\"avatar\",F_NN:\"nick\",GN:\"groupName\",GT:\"groupType\",IsSys:\"isSystemMessage\",OpInf:\"operatorInfo\",Img:\"avatar\",NN:\"nick\",OnlineInf:\"onlineMemberInfo\",ET:\"expireTime\",Num:\"onlineMemberNum\",Opt:\"operationType\",O_Account:\"operatorID\",RT:\"operationType\",UDF:\"userDefinedField\",L_Account:\"userIDList\"},ignoreKeyWord:[\"C2C\",\"ID\",\"USP\"]};function kr(e,t){if(\"string\"!=typeof e&&!Array.isArray(e))throw new TypeError(\"Expected the input to be `string | string[]`\");t=Object.assign({pascalCase:!1},t);var n;return 0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join(\"-\"):e.trim()).length?\"\":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=Er(e)),e=e.replace(/^[_.\\- ]+/,\"\").toLowerCase().replace(/[_.\\- ]+(\\w|$)/g,(function(e,t){return t.toUpperCase()})).replace(/\\d+(\\w|$)/g,(function(e){return e.toUpperCase()})),n=e,t.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n)}var Er=function(e){for(var t=!1,n=!1,o=!1,s=0;s<e.length;s++){var a=e[s];t&&/[a-zA-Z]/.test(a)&&a.toUpperCase()===a?(e=e.slice(0,s)+\"-\"+e.slice(s),t=!1,o=n,n=!0,s++):n&&o&&/[a-zA-Z]/.test(a)&&a.toLowerCase()===a?(e=e.slice(0,s-1)+\"-\"+e.slice(s-1),o=n,n=!1,t=!0):(t=a.toLowerCase()===a&&a.toUpperCase()!==a,o=n,n=a.toUpperCase()===a&&a.toLowerCase()!==a)}return e};function Sr(e,t){var n=0;return function e(t,o){if(++n>100)return n--,t;if(at(t)){var s=t.map((function(t){return ot(t)?e(t,o):t}));return n--,s}if(ot(t)){var a=(i=t,r=function(e,t){if(!dt(t))return!1;if((s=t)!==kr(s))for(var n=0;n<Dr.ignoreKeyWord.length&&!t.includes(Dr.ignoreKeyWord[n]);n++);var s;return it(o[t])?function(e){return\"OPPOChannelID\"===e?e:e[0].toUpperCase()+kr(e).slice(1)}(t):o[t]},u=Object.create(null),Object.keys(i).forEach((function(e){var t=r(i[e],e);t&&(u[t]=i[e])})),u);return a=At(a,(function(t,n){return at(t)||ot(t)?e(t,o):t})),n--,a}var i,r,u}(e,t)}function Lr(e,t){if(at(e))return e.map((function(e){return ot(e)?Lr(e,t):e}));if(ot(e)){var n=(o=e,s=function(e,n){return it(t[n])?kr(n):t[n]},a={},Object.keys(o).forEach((function(e){a[s(o[e],e)]=o[e]})),a);return n=At(n,(function(e){return at(e)||ot(e)?Lr(e,t):e}))}var o,s,a}var Ar=String.fromCharCode,Rr=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320){var n=0|e.charCodeAt(1);if(56320<=n&&n<=57343){if((t=(t<<10)+n-56613888|0)>65535)return Ar(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533}else t<=57343&&(t=65533);return t<=2047?Ar(192|t>>>6,128|63&t):Ar(224|t>>>12,128|t>>>6&63,128|63&t)},Nr=function(e){for(var t=void 0===e?\"\":(\"\"+e).replace(/[\\x80-\\uD7ff\\uDC00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]?/g,Rr),n=0|t.length,o=new Uint8Array(n),s=0;s<n;s=s+1|0)o[s]=0|t.charCodeAt(s);return o},Or=function(){function e(t){o(this,e),this._handler=t;var n=t.getURL();if(this._socket=null,this._workerSocket=null,this._id=_t(),this._handler.getIsWorkerEnabled()){var s=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === \"start\") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = \"arraybuffer\";    _socket.onopen = function() {      postMessage({ callback: \"onOpen\", extensions: _socket.extensions });    };    _socket.onclose = function(e) {      postMessage({ callback: \"onOpen\", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: \"onMessage\", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: \"onError\", e: { isTrusted: \"true\" } });    };  } else if (event.data.cmd === \"sendMessage\") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === \"stop\") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:\"application/javascript; charset=utf-8\"}));this._workerSocket=new Worker(s);var a=this;this._workerSocket.onmessage=function(e){var t=e.data,n=t.callback,o=t.e,s=t.extensions;\"onOpen\"===n?a._onOpen(s):\"onClose\"===n?a._onClose(o):\"onError\"===n?a._onError(o):\"onMessage\"===n&&a._onMessage(e.data)},this._workerSocket.postMessage({cmd:\"start\",id:this._id,url:n})}else ae?te?(re.connectSocket({url:n,header:{\"content-type\":\"application/json\"}}),re.onSocketClose(this._onClose.bind(this)),re.onSocketOpen(this._onOpen.bind(this)),re.onSocketMessage(this._onMessage.bind(this)),re.onSocketError(this._onError.bind(this))):(this._socket=re.connectSocket({url:n,header:{\"content-type\":\"application/json\"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):ie&&(this._socket=new WebSocket(n),this._socket.binaryType=\"arraybuffer\",this._socket.onopen=this._onOpen.bind(this,this._socket.extensions),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this));this._canIUseBinaryFrame=t.canIUseBinaryFrame()}return a(e,[{key:\"getID\",value:function(){return this._id}},{key:\"_onOpen\",value:function(e){this._handler.onOpen({id:this._id,res:JSON.stringify(e)})}},{key:\"_onClose\",value:function(e){this._handler.onClose({id:this._id,e:e})}},{key:\"_onMessage\",value:function(e){var t;t=this._canIUseBinaryFrame?this._isAppCompressedData(e.data)?this._handler.inflate(e.data):function(e){for(var t=new Uint8Array(e),n=\"\",o=0,s=t.length;o<s;){var a=t[o],i=0,r=0;if(a<=127?(i=0,r=255&a):a<=223?(i=1,r=31&a):a<=239?(i=2,r=15&a):a<=244&&(i=3,r=7&a),s-o-i>0)for(var u=0;u<i;)r=r<<6|63&(a=t[o+u+1]),u+=1;else r=65533,i=s-o;n+=String.fromCodePoint(r),o+=i+1}return n}(e.data):e.data,this._handler.onMessage({data:t})}},{key:\"_isAppCompressedData\",value:function(e){var t=new Uint8Array(e);return 67===t[0]&&79===t[1]&&77===t[2]&&80===t[3]}},{key:\"_onError\",value:function(e){this._handler.onError({id:this._id,e:e})}},{key:\"setIsWorkerEnabled\",value:function(e){this._isWorkerEnabled=!0}},{key:\"close\",value:function(e){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:\"stop\",code:e}),this._workerSocket.terminate(),this._workerSocket=null),te)return re.offSocketClose(),re.offSocketMessage(),re.offSocketOpen(),re.offSocketError(),void re.closeSocket();this._socket&&(ae?(this._socket.onClose((function(){})),this._socket.onOpen((function(){})),this._socket.onMessage((function(){})),this._socket.onError((function(){}))):ie&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),ee?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:\"send\",value:function(e){if(this._workerSocket)this._workerSocket.postMessage({cmd:\"sendMessage\",data:this._canIUseBinaryFrame?Nr(e.data).buffer:e.data});else{if(te)return void re.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}});this._socket&&(ae?this._socket.send({data:this._canIUseBinaryFrame?Nr(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):ie&&this._socket.send(this._canIUseBinaryFrame?Nr(e.data):e.data))}}}]),e}(),Gr=4e3,Ur=4001,Pr=[\"keyMap\"],br=[\"keyMap\"],wr=\"connected\",Fr=\"connecting\",qr=\"disconnected\",xr=function(){function e(t){o(this,e),this._channelModule=t,this._n=\"SocketHandler\",this._promiseMap=new Map,this._readyState=qr,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=_t(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url=\"\",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._setWebsocketHost(),this._initConnection()}return a(e,[{key:\"_setWebsocketHost\",value:function(){var e=this._channelModule.getModule(xn),t=G;this._channelModule.isOversea()&&(t=U),e.isSingaporeSite()?t=P:e.isKoreaSite()?t=b:e.isGermanySite()?t=w:e.isIndiaSite()?t=F:e.isJapanSite()?t=q:e.isUSASite()&&(t=x),V.HOST.setCurrent(t)}},{key:\"_initConnection\",value:function(){it(V.HOST.CURRENT.BACKUP)||\"\"===this._url?this._url=V.HOST.CURRENT.DEFAULT:this._url===V.HOST.CURRENT.DEFAULT?this._url=V.HOST.CURRENT.BACKUP:this._url===V.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?V.HOST.CURRENT.ANYCAST:V.HOST.CURRENT.DEFAULT:this._url===V.HOST.CURRENT.ANYCAST&&(V.HOST.CURRENT.ANYCAST=\"\",this._url=V.HOST.CURRENT.DEFAULT);var e=this._channelModule.getModule(xn).getProxyServer();zt(e)||(this._url=e),this._connect(),this._nextPingTs=0}},{key:\"_canIUseAnyCast\",value:function(){return ie&&V.HOST.CURRENT.ANYCAST}},{key:\"onCheckTimer\",value:function(e){e%1==0&&this._checkPromiseMap()}},{key:\"_checkPromiseMap\",value:function(){var e=this;0!==this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var o=t.reject,s=t.timestamp,a=15e3;-1!==n.indexOf(co)?a=9e4:-1!==n.indexOf(Hs)&&(a=3e3),Date.now()-s>=a&&(Ve.l(\"\".concat(e._n,\"._checkPromiseMap request timeout, delete requestID:\").concat(n)),e._promiseMap.delete(n),o(new ja({code:ha.NETWORK_TIMEOUT})),e._channelModule.onRequestTimeout(n))}))}},{key:\"onOpen\",value:function(e){if(\"\"!==this._readyState){this._onOpenTs=Date.now();var t=e.id,n=e.res;this._socketID=t;var o=Date.now()-this._startTs,s=\"socketID:\".concat(t,\" res:\").concat(n);Ve.l(\"\".concat(this._n,\"._onOpen cost:\").concat(o,\" ms. \").concat(s)),new Aa(\"wsOnOpen\").setMessage(o).setCostTime(o).setMoreMessage(s).end(),e.id===this._socketID&&(this._readyState=wr,this._reConnectCount=0,this._resend(),!0===this._reConnectFlag&&(this._channelModule.onReconnected(),this._reConnectFlag=!1),this._channelModule.onOpen())}}},{key:\"onClose\",value:function(e){var t=new Aa(\"wsOnClose\"),n=e.id,o=e.e,s=\"sourceSocketID:\".concat(n,\" currentSocketID:\").concat(this._socketID,\" code:\").concat(o.code,\" reason:\").concat(o.reason),a=0;0!==this._onOpenTs&&(a=Date.now()-this._onOpenTs),t.setMessage(a).setCostTime(a).setMoreMessage(s).setCode(o.code).end(),Ve.l(\"\".concat(this._n,\"._onClose \").concat(s,\" onlineTime:\").concat(a)),n===this._socketID&&(this._readyState=qr,a<1e3?this._channelModule.onReconnectFailed():this._channelModule.onClose())}},{key:\"onError\",value:function(e){var t=e.id,n=e.e,o=\"sourceSocketID:\".concat(t,\" currentSocketID:\").concat(this._socketID);new Aa(\"wsOnError\").setMessage(n.errMsg||gt(n)).setMoreMessage(o).setLevel(\"error\").end(),Ve.w(\"\".concat(this._n,\"._onError\"),n,o),t===this._socketID&&(this._readyState=\"\",this._channelModule.onError())}},{key:\"onMessage\",value:function(e){var t;try{t=JSON.parse(e.data)}catch(c){new Aa(\"jsonParseError\").setMessage(e.data).end()}if(t&&t.head){var n=this._getRequestIDFromHead(t.head),o=t.body;if(!this._isTRTCCommand(n)){var s=bt(t.head);o=Lr(t.body,this._getResponseKeyMap(s))}if(Ve.d(\"\".concat(this._n,\".onMessage ret:\").concat(JSON.stringify(o),\" requestID:\").concat(n,\" has:\").concat(this._promiseMap.has(n))),this._setNextPingTs(),this._promiseMap.has(n)){var a=this._promiseMap.get(n),i=a.resolve,r=a.reject,u=a.timestamp;return this._promiseMap.delete(n),this._calcRTT(u),void(o.errorCode&&0!==o.errorCode?(this._channelModule.onErrorCodeNotZero(o),r(new ja({code:o.errorCode,message:o.errorInfo||\"\",data:n.includes(Ro)||n.includes(ys)?{elements:o.elements,messageVersion:o.messageVersion,cloudCustomData:o.cloudCustomData}:void 0}))):i(Ya(o)))}this._channelModule.onMessage({head:t.head,body:o})}}},{key:\"_isTRTCCommand\",value:function(e){for(var t=this._channelModule.getModule(so).getCommandList(),n=!1,o=0;o<t.length;o++)if(e.startsWith(t[o])){n=!0;break}return n}},{key:\"_calcRTT\",value:function(e){var t=Date.now()-e;this._channelModule.getModule(eo).addRTT(t)}},{key:\"_connect\",value:function(){this._startTs=Date.now(),this._onOpenTs=0,this._socket=new Or(this),this._socketID=this._socket.getID(),this._readyState=Fr,Ve.l(\"\".concat(this._n,\"._connect isWorkerEnabled:\").concat(this.getIsWorkerEnabled(),\" socketID:\").concat(this._socketID,\" url:\").concat(this.getURL())),new Aa(\"wsConnect\").setMessage(\"socketID:\".concat(this._socketID,\" url:\").concat(this.getURL())).end()}},{key:\"getURL\",value:function(){this._channelModule.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=Ot();(te||X&&\"windows\"===e||oe)&&(this._canIUseBinaryFrame=!1);var t=-1;\"ios\"===e?t=me||-1:\"android\"===e&&(t=ye||-1);var n=this._channelModule.getModule(xn),o=this._channelModule.getPlatform(),s=n.getSDKAppID(),a=n.getInstanceID(),i=\"sdkappid=\".concat(s,\"&instanceid=\").concat(a,\"&random=\").concat(this._getRandom(),\"&platform=\").concat(o,\"&host=\").concat(e)+\"&version=\".concat(t,\"&sdkversion=\").concat(\"2.27.6\");return Z&&(i+=\"&isminigame=1\"),this._channelModule.canIUseInflate()&&(i+=\"&compress=gzip\"),this._canIUseBinaryFrame?\"\".concat(this._url,\"/binfo?\").concat(i):\"\".concat(this._url,\"/info?\").concat(i)}},{key:\"_closeConnection\",value:function(e){Ve.l(\"\".concat(this._n,\"._closeConnection socketID:\").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=qr)}},{key:\"_resend\",value:function(){var e=this;if(Ve.l(\"\".concat(this._n,\"._resend reConnectFlag:\").concat(this._reConnectFlag),\"promiseMap.size:\".concat(this._promiseMap.size,\" simpleRequestMap.size:\").concat(this._simpleRequestMap.size)),this._promiseMap.size>0&&this._promiseMap.forEach((function(t,n){var o=t.uplinkData,s=t.resolve,a=t.reject;e._promiseMap.set(n,{resolve:s,reject:a,timestamp:Date.now(),uplinkData:o}),e._execute(n,o)})),this._simpleRequestMap.size>0){var t,n=D(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var o=v(t.value,2),s=o[0],a=o[1];this._execute(s,a)}}catch(i){n.e(i)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:\"send\",value:function(e){var t=this;e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var n=g(e,Pr),o=this._getRequestIDFromHead(e.head),s=JSON.stringify(n);return new Promise((function(e,a){(t._promiseMap.set(o,{resolve:e,reject:a,timestamp:Date.now(),uplinkData:s}),Ve.d(\"\".concat(t._n,\".send uplinkData:\").concat(JSON.stringify(n),\" requestID:\").concat(o,\" readyState:\").concat(t._readyState)),t._readyState!==wr)?t._reConnect():(t._execute(o,s),t._channelModule.getModule(eo).addRequestCount())}))}},{key:\"simplySend\",value:function(e){e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var t=g(e,br),n=this._getRequestIDFromHead(e.head),o=JSON.stringify(t);this._readyState!==wr?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(n,o):Ve.l(\"\".concat(this._n,\".simplySend. simpleRequestMap is full, drop request!\")),this._reConnect()):this._execute(n,o)}},{key:\"_execute\",value:function(e,t){this._socket.send({data:t,fail:ae?this._onSendFail.bind(this):void 0,requestID:e})}},{key:\"_onSendFail\",value:function(e){Ve.l(\"\".concat(this._n,\"._onSendFail requestID:\").concat(e))}},{key:\"_getSequence\",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,2415919103===this._startSequence&&(this._startSequence=_t()),e}},{key:\"_getRequestIDFromHead\",value:function(e){return e.servcmd+e.seq}},{key:\"_getResponseKeyMap\",value:function(e){var n=this._channelModule.getKeyMap(e);return t(t({},Dr.response),n.response)}},{key:\"_reConnect\",value:function(){this._readyState!==wr&&this._readyState!==Fr&&this.forcedReconnect()}},{key:\"forcedReconnect\",value:function(){var e=this,t=\"\".concat(this._n,\".forcedReconnect\");Ve.l(\"\".concat(t,\" count:\").concat(this._reConnectCount,\" readyState:\").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(Ur),this._initConnection()):(this._reConnectCount=0,this._channelModule.probeNetwork().then((function(n){var o=v(n,2),s=o[0];o[1],s?(Ve.w(\"\".concat(t,\" disconnected from wsserver but network is ok, continue...\")),e._closeConnection(Ur),e._initConnection()):e._channelModule.onReconnectFailed()})))}},{key:\"getReconnectFlag\",value:function(){return this._reConnectFlag}},{key:\"_setNextPingTs\",value:function(){this._nextPingTs=Date.now()+1e4}},{key:\"getNextPingTs\",value:function(){return this._nextPingTs}},{key:\"isConnected\",value:function(){return this._readyState===wr}},{key:\"canIUseBinaryFrame\",value:function(){return this._canIUseBinaryFrame}},{key:\"inflate\",value:function(e){if(this._channelModule.canIUseInflate())return this._channelModule.getModule(ro).inflate(e)}},{key:\"setIsWorkerEnabled\",value:function(e){Ve.l(\"\".concat(this._n,\".setIsWorkerEnabled flag:\").concat(e)),this._isWorkerEnabled=e}},{key:\"getIsWorkerEnabled\",value:function(){return this._isWorkerEnabled&&Se}},{key:\"_getRandom\",value:function(){return 0===this._random&&(this._random=Math.random()),this._random}},{key:\"_resetRandom\",value:function(){this._random=0}},{key:\"close\",value:function(){Ve.l(\"\".concat(this._n,\".close\")),this._closeConnection(Gr),this._promiseMap.clear(),this._startSequence=_t(),this._readyState=qr,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url=\"\",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),e}(),Vr=function(e){r(n,e);var t=f(n);function n(e){var s;if(o(this,n),(s=t.call(this,e))._n=\"ChannelModule\",s._socketHandler=new xr(h(s)),s._probing=!1,s._isAppShowing=!0,s._previousState=E.NET_STATE_CONNECTED,ae&&\"function\"==typeof re.onAppShow&&\"function\"==typeof re.onAppHide){var a=s._onAppHide.bind(h(s)),i=s._onAppShow.bind(h(s));\"function\"==typeof re.offAppHide&&re.offAppHide(a),\"function\"==typeof re.offAppShow&&re.offAppShow(i),re.onAppHide(a),re.onAppShow(i)}return s._timerForNotLoggedIn=-1,s._timerForNotLoggedIn=setInterval(s.onCheckTimer.bind(h(s)),1e3),s._fatalErrorFlag=!1,s}return a(n,[{key:\"onCheckTimer\",value:function(e){this._socketHandler&&(this.isLoggedIn()?(this._timerForNotLoggedIn>0&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:\"onErrorCodeNotZero\",value:function(e){this.getModule(zn).onErrorCodeNotZero(e)}},{key:\"onMessage\",value:function(e){this.getModule(zn).onMessage(e)}},{key:\"send\",value:function(e){return this._socketHandler?this._previousState!==E.NET_STATE_CONNECTED&&e.head.servcmd.includes(Bs)?(this.reConnect(),this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:\"_sendLogViaHTTP\",value:function(e){var t=V.HOST.CURRENT.STAT;return new Promise((function(n,o){var s=\"\".concat(t,\"/v4/imopenstat/tim_web_report_v2?sdkappid=\").concat(e.head.sdkappid,\"&reqtime=\").concat(Date.now()),a=JSON.stringify(e.body),i=\"application/x-www-form-urlencoded;charset=UTF-8\";if(ae)re.request({url:s,data:a,method:\"POST\",timeout:3e3,header:{\"content-type\":i},success:function(){n()},fail:function(){o(new ja({code:ha.NETWORK_ERROR}))}});else{var r=new XMLHttpRequest,u=setTimeout((function(){r.abort(),o(new ja({code:ha.NETWORK_TIMEOUT}))}),3e3);r.onreadystatechange=function(){4===r.readyState&&(clearTimeout(u),200===r.status||304===r.status?n():o(new ja({code:ha.NETWORK_ERROR})))},r.open(\"POST\",s,!0),r.setRequestHeader(\"Content-type\",i),r.send(a)}}))}},{key:\"simplySend\",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:\"onOpen\",value:function(){this._ping()}},{key:\"onClose\",value:function(){this._socketHandler&&(this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(E.NET_STATE_DISCONNECTED));this.reConnect()}},{key:\"onError\",value:function(){ae&&!oe&&this.outputWarning(\"DomainNameInMP\"),this._emitNetStateChangeEvent(E.NET_STATE_DISCONNECTED)}},{key:\"getKeyMap\",value:function(e){return this.getModule(zn).getKeyMap(e)}},{key:\"_onAppHide\",value:function(){this._isAppShowing=!1}},{key:\"_onAppShow\",value:function(){this._isAppShowing=!0}},{key:\"onRequestTimeout\",value:function(e){}},{key:\"onReconnected\",value:function(){Ve.l(\"\".concat(this._n,\".onReconnected\")),this._m.restartTimer(),this.getModule(zn).onReconnected(),this._emitNetStateChangeEvent(E.NET_STATE_CONNECTED)}},{key:\"onReconnectFailed\",value:function(){Ve.l(\"\".concat(this._n,\".onReconnectFailed\")),this._emitNetStateChangeEvent(E.NET_STATE_DISCONNECTED)}},{key:\"setIsWorkerEnabled\",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:\"offline\",value:function(){this._emitNetStateChangeEvent(E.NET_STATE_DISCONNECTED)}},{key:\"reConnect\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!1;this._socketHandler&&(t=this._socketHandler.getReconnectFlag());var n=\"forcedFlag:\".concat(e,\" fatalErrorFlag:\").concat(this._fatalErrorFlag,\" previousState:\").concat(this._previousState,\" reconnectFlag:\").concat(t);if(Ve.l(\"\".concat(this._n,\".reConnect \").concat(n)),!this._fatalErrorFlag&&this._socketHandler){if(!0===e)this._socketHandler.forcedReconnect();else{if(this._previousState===E.NET_STATE_CONNECTING&&t)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(E.NET_STATE_CONNECTING)}}},{key:\"_emitNetStateChangeEvent\",value:function(e){this._previousState!==e&&(Ve.l(\"\".concat(this._n,\"._emitNetStateChangeEvent from \").concat(this._previousState,\" to \").concat(e)),this._previousState=e,this.emitOuterEvent(k.NET_STATE_CHANGE,{state:e}))}},{key:\"_ping\",value:function(){var e=this;if(!0!==this._probing){this._probing=!0;var t=this.getModule(zn).getProtocolData({protocolName:Hs});this.send(t).then((function(){e._probing=!1})).catch((function(t){if(Ve.w(\"\".concat(e._n,\"._ping failed. error:\"),t),e._probing=!1,t&&60002===t.code)return new Aa(\"error\").setMessage(\"code:\".concat(t.code,\" message:\").concat(t.message)).setNetworkType(e.getModule(Hn).getNetworkType()).end(),e._fatalErrorFlag=!0,void e._emitNetStateChangeEvent(E.NET_STATE_DISCONNECTED);e.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];Ve.l(\"\".concat(e._n,\"._ping failed. probe network, isAppShowing:\").concat(e._isAppShowing,\" online:\").concat(o,\" networkType:\").concat(s)),o?e.reConnect():e._emitNetStateChangeEvent(E.NET_STATE_DISCONNECTED)}))}))}}},{key:\"_checkNextPing\",value:function(){this._socketHandler&&(this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping())}},{key:\"canIUseInflate\",value:function(){return this._m.canIUseInflate()}},{key:\"dealloc\",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),this._timerForNotLoggedIn>-1&&clearInterval(this._timerForNotLoggedIn)}},{key:\"onRestApiKickedOut\",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._previousState=E.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3)}}]),n}(uo),Br=[\"a2\",\"tinyid\"],Hr=[\"a2\",\"tinyid\"],Kr=function(){function e(t){o(this,e),this._n=\"ProtocolHandler\",this._sessionModule=t,this._configMap=new Map,this._fillConfigMap()}return a(e,[{key:\"_fillConfigMap\",value:function(){this._configMap.clear();var e=this._sessionModule.genCommonHead(),n=this._sessionModule.genCosSpecifiedHead(),o=this._sessionModule.genSSOReportHead(),s=this._sessionModule.isIntl();this._configMap.set(co,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.LOGIN)}),body:{state:\"Online\",isWebUniapp:0,deviceBrand:0},keyMap:{request:{deviceBrand:\"InstType\"},response:{InstId:\"instanceID\",HelloInterval:\"helloInterval\"}}}}(e)),this._configMap.set(lo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.LOGOUT)}),body:{type:0},keyMap:{request:{type:\"wslogout_type\"}}}}(e)),this._configMap.set(po,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.HELLO)}),body:{isWebUniapp:0},keyMap:{response:{NewInstInfo:\"newInstanceInfo\"}}}}(e)),this._configMap.set(go,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.STAT_SERVICE,\".\").concat(V.CMD.KICK_OTHER)}),body:{}}}(e)),this._configMap.set(qs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_COS_SIGN,\".\").concat(V.CMD.COS_SIGN)}),body:{cmd:\"open_im_cos_svc\",subCmd:\"get_cos_token\",duration:300,version:2},keyMap:{request:{userSig:\"usersig\",subCmd:\"sub_cmd\",cmd:\"cmd\",duration:\"duration\",version:\"version\"},response:{expired_time:\"expiredTime\",bucket_name:\"bucketName\",session_token:\"sessionToken\",tmp_secret_id:\"secretId\",tmp_secret_key:\"secretKey\"}}}}(n)),this._configMap.set(xs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.CUSTOM_UPLOAD,\".\").concat(V.CMD.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{request:{userSig:\"usersig\",fileType:\"file_type\",fileName:\"file_name\",uploadMethod:\"upload_method\"},response:{expired_time:\"expiredTime\",request_id:\"requestId\",head_url:\"headUrl\",upload_url:\"uploadUrl\",download_url:\"downloadUrl\",ci_url:\"ciUrl\",snapshot_url:\"requestSnapshotUrl\"}}}}(n)),this._configMap.set(Vs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.CUSTOM_UPLOAD,\".\").concat(V.CMD.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{request:{version:\"version\",platform:\"platform\",coverName:\"cover_name\",requestSnapshotUrl:\"snapshot_url\"},response:{error_code:\"errorCode\",error_msg:\"errorInfo\",download_url:\"snapshotUrl\"}}}}(n)),this._configMap.set(Qs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_CONFIG_MANAGER,\".\").concat(V.CMD.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{request:{SDKAppID:\"uint32_sdkappid\"},response:{int32_error_code:\"errorCode\",str_error_message:\"errorMessage\",str_purchase_bits:\"purchaseBits\",uint32_expired_time:\"expiredTime\"}}}}(e)),this._configMap.set($s,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_CONFIG_MANAGER,\".\").concat(V.CMD.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:\"errorCode\",str_error_message:\"errorMessage\",str_purchase_bits:\"purchaseBits\",uint32_expired_time:\"expiredTime\"}}}}(e)),this._configMap.set(Xs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_CONFIG_MANAGER,\".\").concat(V.CMD.FETCH_CLOUD_CONTROL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{request:{SDKAppID:\"uint32_sdkappid\",version:\"uint64_version\"},response:{int32_error_code:\"errorCode\",str_error_message:\"errorMessage\",str_json_config:\"cloudControlConfig\",uint32_expired_time:\"expiredTime\",uint32_sdkappid:\"SDKAppID\",uint64_version:\"version\"}}}}(e)),this._configMap.set(Zs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_CONFIG_MANAGER,\".\").concat(V.CMD.PUSHED_CLOUD_CONTROL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:\"errorCode\",str_error_message:\"errorMessage\",str_json_config:\"cloudControlConfig\",uint32_expired_time:\"expiredTime\",uint32_sdkappid:\"SDKAppID\",uint64_version:\"version\"}}}}(e)),this._configMap.set(ea,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OVERLOAD_PUSH,\".\").concat(V.CMD.OVERLOAD_NOTIFY)}),body:{},keyMap:{response:{OverLoadServCmd:\"overloadCommand\",DelaySecs:\"waitingTime\"}}}}(e)),this._configMap.set(ho,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.GET_MESSAGES)}),body:{cookie:\"\",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1},keyMap:{request:{fromAccount:\"From_Account\",toAccount:\"To_Account\",from:\"From_Account\",to:\"To_Account\",time:\"MsgTimeStamp\",sequence:\"MsgSeq\",random:\"MsgRandom\",elements:\"MsgBody\"},response:{MsgList:\"messageList\",SyncFlag:\"syncFlag\",To_Account:\"to\",From_Account:\"from\",ClientSeq:\"clientSequence\",MsgSeq:\"sequence\",NoticeSeq:\"noticeSequence\",NotifySeq:\"notifySequence\",MsgRandom:\"random\",MsgTimeStamp:\"time\",MsgContent:\"content\",ToGroupId:\"to\",MsgKey:\"messageKey\",GroupTips:\"groupTips\",MsgBody:\"elements\",MsgType:\"type\",C2CRemainingUnreadCount:\"C2CRemainingUnreadList\",C2CPairUnreadCount:\"C2CPairUnreadList\"}}}}(e)),s||(this._configMap.set(_o,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.BIG_DATA_HALLWAY_AUTH_KEY)}),body:{}}}(e)),this._configMap.set(pa,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_MSG_AUDIT_MGR,\".\").concat(V.CMD.GET_RPOFANITY_LIST)}),body:{version:0,deviceID:\"\",startIndex:void 0},keyMap:{request:{version:\"uint64_version\",deviceID:\"str_device_id\",startIndex:\"uint64_start_index\"},response:{msg_cmd_error_code:\"errorInfo\",str_err_msg:\"errorMessage\",uint32_code:\"errorCode\",msg_scene_ctl_config:\"filterConfig\",uint64_c2c_custom_msg_flag:\"c2c_custom_message\",uint64_c2c_text_msg_flag:\"c2c_text_message\",uint64_group_custom_msg_flag:\"group_custom_message\",uint64_group_text_msg_flag:\"group_text_message\",uint64_group_info_flag:\"group_profile\",uint64_group_member_info_flag:\"group_member_profile\",uint64_relation_chain_flag:\"sns\",uint64_user_info_flag:\"user_profile\",rpt_msg_dirty_word:\"lexicon\",str_dirty_word:\"profanity\",str_replaced_content:\"replacement\",uint64_filter_type:\"filterType\",uint64_id:\"id\",uint64_word_type:\"profanityType\",uint64_complete_flag:\"completeFlag\",uint64_next_start_index:\"nextStartIndex\",uint64_version:\"version\",uint64_expired_time:\"expiredTime\"}}}}(e))),this._configMap.set(fo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.SEND_MESSAGE)}),body:{fromAccount:\"\",toAccount:\"\",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:\"\",avatar:\"\",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:\"\",desc:\"\",ext:\"\",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:\"\"}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0},keyMap:{request:{fromAccount:\"From_Account\",toAccount:\"To_Account\",msgTimeStamp:\"MsgTimeStamp\",msgSeq:\"MsgSeq\",msgRandom:\"MsgRandom\",msgBody:\"MsgBody\",count:\"MaxCnt\",lastMessageTime:\"LastMsgTime\",messageKey:\"MsgKey\",peerAccount:\"Peer_Account\",data:\"Data\",description:\"Desc\",extension:\"Ext\",type:\"MsgType\",content:\"MsgContent\",sizeType:\"Type\",uuid:\"UUID\",url:\"\",imageUrl:\"URL\",fileUrl:\"Url\",remoteAudioUrl:\"Url\",remoteVideoUrl:\"VideoUrl\",thumbUUID:\"ThumbUUID\",videoUUID:\"VideoUUID\",videoUrl:\"\",downloadFlag:\"Download_Flag\",nick:\"From_AccountNick\",avatar:\"From_AccountHeadurl\",from:\"From_Account\",time:\"MsgTimeStamp\",messageRandom:\"MsgRandom\",messageSequence:\"MsgSeq\",elements:\"MsgBody\",clientSequence:\"ClientSeq\",payload:\"MsgContent\",messageList:\"MsgList\",messageNumber:\"MsgNum\",abstractList:\"AbstractList\",messageBody:\"MsgBody\",needReadReceipt:\"IsNeedReadReceipt\"}}}}(e)),this._configMap.set(vo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.SEND_GROUP_MESSAGE)}),body:{fromAccount:\"\",groupID:\"\",random:0,clientSequence:0,priority:\"\",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:\"\",desc:\"\",ext:\"\",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:\"\"}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0},keyMap:{request:{to:\"GroupId\",extension:\"Ext\",data:\"Data\",description:\"Desc\",random:\"Random\",sequence:\"ReqMsgSeq\",count:\"ReqMsgNumber\",type:\"MsgType\",priority:\"MsgPriority\",content:\"MsgContent\",elements:\"MsgBody\",sizeType:\"Type\",uuid:\"UUID\",url:\"\",imageUrl:\"URL\",fileUrl:\"Url\",remoteAudioUrl:\"Url\",remoteVideoUrl:\"VideoUrl\",thumbUUID:\"ThumbUUID\",videoUUID:\"VideoUUID\",videoUrl:\"\",downloadFlag:\"Download_Flag\",clientSequence:\"ClientSeq\",from:\"From_Account\",time:\"MsgTimeStamp\",messageRandom:\"MsgRandom\",messageSequence:\"MsgSeq\",payload:\"MsgContent\",messageList:\"MsgList\",messageNumber:\"MsgNum\",abstractList:\"AbstractList\",messageBody:\"MsgBody\",needReadReceipt:\"NeedReadReceipt\",receiverList:\"To_Account\"},response:{MsgTime:\"time\",MsgSeq:\"sequence\"}}}}(e)),this._configMap.set(To,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.REVOKE_C2C_MESSAGE)}),body:{msgInfo:{fromAccount:\"\",toAccount:\"\",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{request:{msgInfo:\"MsgInfo\",msgTimeStamp:\"MsgTimeStamp\",msgSeq:\"MsgSeq\",msgRandom:\"MsgRandom\"}}}}(e)),this._configMap.set(is,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.REVOKE_GROUP_MESSAGE)}),body:{groupID:\"\",msgSeqList:void 0,topicID:\"\"},keyMap:{request:{msgSeqList:\"MsgSeqList\",msgSeq:\"MsgSeq\"}}}}(e)),this._configMap.set(So,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.GET_C2C_ROAM_MESSAGES)}),body:{peerAccount:\"\",count:15,lastMessageTime:0,messageKey:\"\",withRecalledMessage:1,direction:0},keyMap:{request:{messageKey:\"MsgKey\",peerAccount:\"Peer_Account\",count:\"MaxCnt\",lastMessageTime:\"LastMsgTime\",withRecalledMessage:\"WithRecalledMsg\",direction:\"GetDirection\"},response:{LastMsgTime:\"lastMessageTime\",IsNeedReadReceipt:\"needReadReceipt\",IsPeerRead:\"readReceiptSentByPeer\"}}}}(e)),this._configMap.set(Ro,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.MODIFY_C2C_MESSAGE)}),body:{from:\"\",to:\"\",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:\"MsgSeq\",random:\"MsgRandom\",time:\"MsgTime\",version:\"MsgVersion\",type:\"MsgType\",content:\"MsgContent\"}}}}(e)),this._configMap.set(cs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_ROAM_MESSAGES)}),body:{withRecalledMsg:1,groupID:\"\",count:15,sequence:\"\",topicID:void 0},keyMap:{request:{sequence:\"ReqMsgSeq\",count:\"ReqMsgNumber\",withRecalledMessage:\"WithRecalledMsg\"},response:{Random:\"random\",MsgTime:\"time\",MsgSeq:\"sequence\",ReqMsgSeq:\"sequence\",RspMsgList:\"messageList\",IsPlaceMsg:\"isPlaceMessage\",IsSystemMsg:\"isSystemMessage\",ToGroupId:\"to\",EnumFrom_AccountType:\"fromAccountType\",EnumTo_AccountType:\"toAccountType\",GroupCode:\"groupCode\",MsgPriority:\"priority\",MsgBody:\"elements\",MsgType:\"type\",MsgContent:\"content\",IsFinished:\"complete\",Download_Flag:\"downloadFlag\",ClientSeq:\"clientSequence\",ThumbUUID:\"thumbUUID\",VideoUUID:\"videoUUID\",ToTopicId:\"topicID\",InvisibleMsgSeq:\"invisibleSequenceList\"}}}}(e)),this._configMap.set(Do,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.SET_C2C_MESSAGE_READ)}),body:{C2CMsgReaded:void 0},keyMap:{request:{lastMessageTime:\"LastedMsgTime\"}}}}(e)),this._configMap.set(ko,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{request:{userIDList:\"Peer_Account\",muteFlag:\"Mute_Notifications\"}}}}(e)),this._configMap.set(Eo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{updateSequence:0},keyMap:{response:{MuteNotificationsList:\"muteFlagList\"}}}}(e)),this._configMap.set(rs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.SET_GROUP_MESSAGE_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{request:{messageReadSeq:\"MsgReadedSeq\"}}}}(e)),this._configMap.set(us,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.SET_ALL_MESSAGE_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{request:{readAllC2CMessage:\"C2CReadAllMsg\",groupMessageReadInfoList:\"GroupReadInfo\",messageSequence:\"MsgSeq\"},response:{C2CReadAllMsg:\"readAllC2CMessage\",GroupReadInfoArray:\"groupMessageReadInfoList\"}}}}(e)),this._configMap.set(Ao,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.DELETE_C2C_MESSAGE)}),body:{fromAccount:\"\",to:\"\",keyList:void 0},keyMap:{request:{keyList:\"MsgKeyList\"}}}}(e)),this._configMap.set(Ms,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.DELETE_GROUP_MESSAGE)}),body:{groupID:\"\",deleter:\"\",keyList:void 0,topicID:void 0},keyMap:{request:{deleter:\"Deleter_Account\",keyList:\"Seqs\"}}}}(e)),this._configMap.set(ga,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_TRANSLATE,\".\").concat(V.CMD.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:\"\",target:\"\"},keyMap:{request:{sourceTextList:\"SourceText\",SDKAppID:\"SdkAppId\",from:\"FromAccount\"},response:{TargetText:\"translatedTextList\",RequestId:\"requestID\",CmdErrorCode:\"error\",ErrorCode:\"code\",ErrorInfo:\"message\"}}}}(e)),this._configMap.set(ys,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.MODIFY_GROUP_MESSAGE)}),body:{groupID:\"\",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:\"MsgSeq\",version:\"MsgVersion\",type:\"MsgType\",content:\"MsgContent\"}}}}(e)),this._configMap.set(ls,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_READ_RECEIPT)}),body:{groupID:\"\",sequenceList:void 0},keyMap:{request:{sequence:\"MsgSeq\"}}}}(e)),this._configMap.set(ps,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:\"\",messageInfoList:void 0},keyMap:{request:{peerAccount:\"Peer_Account\",messageInfoList:\"C2CMsgInfo\",fromAccount:\"From_Account\",toAccount:\"To_Account\",sequence:\"MsgSeq\",random:\"MsgRandom\",time:\"MsgTime\",clientTime:\"MsgClientTime\"}}}}(e)),this._configMap.set(ds,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.SEND_READ_RECEIPT)}),body:{groupID:\"\",sequenceList:void 0},keyMap:{request:{sequenceList:\"MsgSeqList\",sequence:\"MsgSeq\"}}}}(e)),this._configMap.set(gs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_READ_RECEIPT_DETAIL)}),body:{groupID:\"\",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{request:{sequence:\"MsgSeq\",count:\"Num\"},response:{ReadList:\"readUserIDList\",Read_Account:\"userID\",UnreadList:\"unreadUserIDList\",Unread_Account:\"userID\",IsFinish:\"isCompleted\"}}}}(e)),this._configMap.set(No,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM_MSG_EXT,\".\").concat(V.CMD.MODIFY_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Oo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM_MSG_EXT,\".\").concat(V.CMD.GET_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}}(e)),this._configMap.set(Es,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM_MSG_EXT,\".\").concat(V.CMD.MODIFY_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Ss,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM_MSG_EXT,\".\").concat(V.CMD.GET_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}}(e)),this._configMap.set(Lo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.GET_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{request:{userIDList:\"To_Account\"},response:{ReadTime:\"peerReadTimeList\"}}}}(e)),this._configMap.set(Uo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,count:0},keyMap:{request:{},response:{SessionItem:\"conversations\",ToAccount:\"groupID\",To_Account:\"userID\",UnreadMsgCount:\"unreadCount\",MsgGroupReadedSeq:\"messageReadSeq\",C2cPeerReadTime:\"c2cPeerReadTime\"}}}}(e)),this._configMap.set(Go,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.PAGING_GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:4,assistFlag:15},keyMap:{request:{messageAssistFlag:\"MsgAssistFlags\",assistFlag:\"AssistFlags\",pinnedTimeStamp:\"TopTimeStamp\",pinnedStartIndex:\"TopStartIndex\"},response:{SessionItem:\"conversations\",ToAccount:\"groupID\",To_Account:\"userID\",UnreadMsgCount:\"unreadCount\",MsgGroupReadedSeq:\"messageReadSeq\",C2cPeerReadTime:\"c2cPeerReadTime\",LastMsgFlags:\"lastMessageFlag\",TopFlags:\"isPinned\",TopTimeStamp:\"pinnedTimeStamp\",TopStartIndex:\"pinnedStartIndex\",GroupId:\"convGroupID\"}}}}(e)),this._configMap.set(Po,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.DELETE_CONVERSATION)}),body:{fromAccount:\"\",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{request:{toGroupID:\"ToGroupid\",clearHistoryMessage:\"ClearRamble\",conversationList:\"ContactItem\"},response:{ResultItem:\"resultList\",ToGroupid:\"groupID\",ResultCode:\"code\",ResultInfo:\"info\"}}}}(e)),this._configMap.set(bo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.CLEAR_HISTORY_MESSAGE)}),body:{fromAccount:\"\",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{request:{toGroupID:\"ToGroupid\"}}}}(e)),this._configMap.set(wo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.PIN_CONVERSATION)}),body:{fromAccount:\"\",operationType:1,itemList:void 0},keyMap:{request:{itemList:\"RecentContactItem\"}}}}(e)),this._configMap.set(Fo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.DELETE_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:\"DelMsgList\",messageSeq:\"MsgSeq\",messageRandom:\"MsgRandom\"}}}}(e)),this._configMap.set(qo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.MARK_CONVERSATION)}),body:{fromAccount:\"\",itemList:void 0},keyMap:{request:{itemList:\"MarkItem\",operationType:\"OptType\",groupID:\"ToGroupId\"},response:{ToGroupId:\"groupID\",OptType:\"operationType\"}}}}(e)),this._configMap.set(xo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.MARK_CONVERSATION)}),body:{fromAccount:\"\",itemList:void 0},keyMap:{request:{itemList:\"MarkItem\",operationType:\"OptType\",groupID:\"ToGroupId\"},response:{ToGroupId:\"groupID\",OptType:\"operationType\"}}}}(e)),this._configMap.set(Vo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.CREATE_CONVERSATION_GROUP)}),body:{fromAccount:\"\",itemList:void 0},keyMap:{request:{itemList:\"GroupContactItem\",groupID:\"ToGroupId\"},response:{GroupId:\"convGroupID\",ToGroupId:\"groupID\",OptType:\"operationType\"}}}}(e)),this._configMap.set(Bo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.DELETE_CONVERSATION_GROUP)}),body:{fromAccount:\"\",groupName:void 0},keyMap:{request:{},response:{GroupId:\"convGroupID\"}}}}(e)),this._configMap.set(Ho,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:\"\",updateType:void 0,updateGroup:void 0},keyMap:{request:{oldName:\"OldGroupName\",newName:\"NewGroupName\",groupID:\"ToGroupId\",operationType:\"ContactOptType\",groupName:\"OldGroupName\",updateItem:\"ContactUpdateItem\"},response:{ContactOptType:\"operationType\",ToGroupId:\"groupID\",GroupId:\"convGroupID\"}}}}(e)),this._configMap.set(Ko,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:\"\",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(Wo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.UPDATE_CONVERSATION_GROUP)}),body:{fromAccount:\"\",updateType:void 0,updateGroup:void 0},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(Yo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.RECENT_CONTACT,\".\").concat(V.CMD.GET_CONVERSATION_GROUP_LIST)}),body:{fromAccount:\"\",startTime:void 0,startIndex:void 0},keyMap:{request:{},response:{GroupId:\"convGroupID\",ToGroupId:\"groupID\",OptType:\"operationType\",CustomMark:\"customData\",ContactGroupId:\"convGroupIDList\"}}}}(e)),this._configMap.set(mo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.PROFILE,\".\").concat(V.CMD.PORTRAIT_GET)}),body:{fromAccount:\"\",userItem:[]},keyMap:{request:{toAccount:\"To_Account\",standardSequence:\"StandardSequence\",customSequence:\"CustomSequence\"}}}}(e)),this._configMap.set(Mo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.PROFILE,\".\").concat(V.CMD.PORTRAIT_SET)}),body:{fromAccount:\"\",profileItem:[{tag:He.NICK,value:\"\"},{tag:He.GENDER,value:\"\"},{tag:He.ALLOWTYPE,value:\"\"},{tag:He.AVATAR,value:\"\"}]},keyMap:{request:{toAccount:\"To_Account\",standardSequence:\"StandardSequence\",customSequence:\"CustomSequence\"}}}}(e)),this._configMap.set(yo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.FRIEND,\".\").concat(V.CMD.GET_BLACKLIST)}),body:{fromAccount:\"\",startIndex:0,maxLimited:30,lastSequence:0},keyMap:{response:{CurruentSequence:\"currentSequence\"}}}}(e)),this._configMap.set(Io,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.FRIEND,\".\").concat(V.CMD.ADD_BLACKLIST)}),body:{fromAccount:\"\",toAccount:[]}}}(e)),this._configMap.set(Co,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.FRIEND,\".\").concat(V.CMD.DELETE_BLACKLIST)}),body:{fromAccount:\"\",toAccount:[]}}}(e)),this._configMap.set(aa,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.SET_SELF_STATUS)}),body:{customStatus:\"\"},keyMap:{}}}(e)),this._configMap.set(ia,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{UserStatusList:\"successUserList\",ErrorList:\"failureUserList\",To_Account:\"userID\",Invalid_Account:\"invalidUserID\",Status:\"statusType\"}}}}(e)),this._configMap.set(ra,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.SUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{ErrorList:\"failureUserList\",To_Account:\"userID\",Invalid_Account:\"invalidUserID\"}}}}(e)),this._configMap.set(ua,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.UNSUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{response:{ErrorList:\"failureUserList\",To_Account:\"userID\",Invalid_Account:\"invalidUserID\"}}}}(e)),this._configMap.set(jo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_JOINED_GROUPS)}),body:{memberAccount:\"\",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0},keyMap:{request:{memberAccount:\"Member_Account\"},response:{GroupIdList:\"groups\",NoUnreadSeqList:\"excludedUnreadSequenceList\",MsgSeq:\"readedSequence\",LastRecallTime:\"_lastRevokedTime\"}}}}(e)),this._configMap.set(zo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_INFO)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:[\"Type\",\"Name\",\"Introduction\",\"Notification\",\"FaceUrl\",\"Owner_Account\",\"CreateTime\",\"InfoSeq\",\"LastInfoTime\",\"LastMsgTime\",\"MemberNum\",\"MaxMemberNum\",\"ApplyJoinOption\",\"NextMsgSeq\",\"ShutUpAllMember\"],groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{request:{groupIDList:\"GroupIdList\",groupCustomField:\"AppDefinedData\",memberCustomField:\"AppMemberDefinedData\",groupCustomFieldFilter:\"AppDefinedDataFilter_Group\",memberCustomFieldFilter:\"AppDefinedDataFilter_GroupMember\"},response:{GroupIdList:\"groups\",AppDefinedData:\"groupCustomField\",AppMemberDefinedData:\"memberCustomField\",AppDefinedDataFilter_Group:\"groupCustomFieldFilter\",AppDefinedDataFilter_GroupMember:\"memberCustomFieldFilter\",InfoSeq:\"infoSequence\",MemberList:\"members\",GroupInfo:\"groups\",ShutUpUntil:\"muteUntil\",ShutUpAllMember:\"muteAllMembers\"}}}}(e)),this._configMap.set(Jo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.CREATE_GROUP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:\"\",isSupportTopic:void 0,inviteOption:void 0},keyMap:{request:{ownerID:\"Owner_Account\",userID:\"Member_Account\",avatar:\"FaceUrl\",maxMemberNum:\"MaxMemberCount\",joinOption:\"ApplyJoinOption\",groupCustomField:\"AppDefinedData\",memberCustomField:\"AppMemberDefinedData\",inviteOption:\"InviteJoinOption\"},response:{HugeGroupFlag:\"avChatRoomFlag\",OverJoinedGroupLimit_Account:\"overLimitUserIDList\"}}}}(e)),this._configMap.set(Xo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.DESTROY_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(Zo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.MODIFY_GROUP_INFO)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{request:{groupCustomField:\"AppDefinedData\",muteAllMembers:\"ShutUpAllMember\",joinOption:\"ApplyJoinOption\",avatar:\"FaceUrl\",inviteOption:\"InviteJoinOption\"},response:{AppDefinedData:\"groupCustomField\",ShutUpAllMember:\"muteAllMembers\"}}}}(e)),this._configMap.set(Qo,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{request:{applyMessage:\"ApplyMsg\",historyMessageFlag:\"HugeGroupHistoryMsgFlag\"},response:{HugeGroupFlag:\"avChatRoomFlag\",AVChatRoomKey:\"avChatRoomKey\",RspMsgList:\"messageList\",ToGroupId:\"to\"}}}}(e)),this._configMap.set($o,function(e){return e.a2,e.tinyid,{head:t(t({},g(e,Br)),{},{servcmd:\"\".concat(V.NAME.BIG_GROUP_NO_AUTH,\".\").concat(V.CMD.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{request:{applyMessage:\"ApplyMsg\"},response:{HugeGroupFlag:\"avChatRoomFlag\"}}}}(e)),this._configMap.set(es,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.QUIT_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(ts,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.SEARCH_GROUP_BY_ID)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:[\"Type\",\"Name\",\"Introduction\",\"Notification\",\"FaceUrl\",\"CreateTime\",\"Owner_Account\",\"LastInfoTime\",\"LastMsgTime\",\"NextMsgSeq\",\"MemberNum\",\"MaxMemberNum\",\"ApplyJoinOption\",\"InviteJoinOption\"]}},keyMap:{response:{}}}}(e)),this._configMap.set(ns,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.CHANGE_GROUP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{request:{newOwnerID:\"NewOwner_Account\"}}}}(e)),this._configMap.set(os,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.HANDLE_APPLY_JOIN_GROUP)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{applicant:\"Applicant_Account\",handleAction:\"HandleMsg\",handleMessage:\"ApprovalMsg\",messageKey:\"MsgKey\"}}}}(e)),this._configMap.set(ss,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.HANDLE_INVITE_JOIN_GROUP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{request:{applicant:\"Applicant_Account\",invitee:\"Invited_Account\",handleAction:\"HandleMsg\",handleMessage:\"ApprovalMsg\"}}}}(e)),this._configMap.set(as,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.HANDLE_GROUP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{inviter:\"Inviter_Account\",handleAction:\"HandleMsg\",handleMessage:\"ApprovalMsg\",messageKey:\"MsgKey\"}}}}(e)),this._configMap.set(hs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_APPLICATION)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{request:{handleAccount:\"Handle_Account\"},response:{To_Account:\"userID\"}}}}(e)),this._configMap.set(_s,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.DELETE_GROUP_SYSTEM_MESSAGE)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:\"DelMsgList\",messageSeq:\"MsgSeq\",messageRandom:\"MsgRandom\"}}}}(e)),this._configMap.set(fs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.BIG_GROUP_LONG_POLLING,\".\").concat(V.CMD.AVCHATROOM_LONG_POLL)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{request:{USP:\"USP\"},response:{ToGroupId:\"groupID\",RspBroadcastMsgList:\"broadcastMessageList\",IsSystemMsg:\"isSystemMessage\"}}}}(e)),this._configMap.set(vs,function(e){return e.a2,e.tinyid,{head:t(t({},g(e,Hr)),{},{servcmd:\"\".concat(V.NAME.BIG_GROUP_LONG_POLLING_NO_AUTH,\".\").concat(V.CMD.AVCHATROOM_LONG_POLL)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{request:{USP:\"USP\"},response:{ToGroupId:\"groupID\",RspBroadcastMsgList:\"broadcastMessageList\",IsSystemMsg:\"isSystemMessage\"}}}}(e)),this._configMap.set(ms,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_ONLINE_MEMBER_NUM)}),body:{groupID:void 0}}}(e)),this._configMap.set(Is,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.SET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:[\"RaceConflict\"]},keyMap:{request:{key:\"key\",value:\"value\"}}}}(e)),this._configMap.set(Cs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.MODIFY_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:[\"RaceConflict\"]},keyMap:{request:{key:\"key\",value:\"value\"}}}}(e)),this._configMap.set(Ts,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.DELETE_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:[\"RaceConflict\"]},keyMap:{request:{key:\"key\"}}}}(e)),this._configMap.set(Ds,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.CLEAR_GROUP_ATTRIBUTES)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:[\"RaceConflict\"]}}}(e)),this._configMap.set(ks,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_ATTR,\".\").concat(V.CMD.GET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{request:{avChatRoomKey:\"Key\",groupType:\"GroupType\"}}}}(e)),this._configMap.set(Ls,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_NOTIFY)}),body:{notifyType:1,groupID:\"\",beginTime:0,endTime:0,limit:20},keyMap:{request:{},response:{NextMsgTime:\"nextRevokedTime\",NotifyMsgList:\"notifyList\"}}}}(e)),this._configMap.set(As,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.UPDATE_GROUP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{request:{counterList:\"GroupCounter\"}}}}(e)),this._configMap.set(Rs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{request:{keyList:\"GroupCounterKeys\"}}}}(e)),this._configMap.set(ta,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_COMMUNITY,\".\").concat(V.CMD.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{request:{avatar:\"FaceUrl\"}}}}(e)),this._configMap.set(na,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_COMMUNITY,\".\").concat(V.CMD.DELETE_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{request:{topicIDList:\"TopicIdList\"},response:{DestroyResultItem:\"resultList\"}}}}(e)),this._configMap.set(oa,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_COMMUNITY,\".\").concat(V.CMD.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{request:{avatar:\"FaceUrl\",muteAllMembers:\"ShutUpAllMember\"}}}}(e)),this._configMap.set(sa,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_COMMUNITY,\".\").concat(V.CMD.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:[\"NoUnreadSeqList\"]},keyMap:{request:{topicIDList:\"TopicIdList\"},response:{TopicAndSelfInfo:\"topicInfoList\",TopicInfo:\"topic\",GroupID:\"groupID\",ShutUpTime:\"muteTime\",ShutUpAllFlag:\"muteAllMembers\",LastMsgTime:\"lastMessageTime\",MsgSeq:\"readedSequence\",LastMsgSeq:\"sequence\",NoUnreadSeqList:\"excludedUnreadSequenceList\"}}}}(e)),this._configMap.set(Ns,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_MEMBER_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:[\"Role\",\"NameCard\",\"ShutUpUntil\",\"JoinTime\"],memberCustomFieldFilter:void 0},keyMap:{request:{memberCustomFieldFilter:\"AppDefinedDataFilter_GroupMember\"},response:{AppMemberDefinedData:\"memberCustomField\",AppDefinedDataFilter_GroupMember:\"memberCustomFieldFilter\",MemberList:\"members\",ShutUpUntil:\"muteUntil\"}}}}(e)),this._configMap.set(Os,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_AVCHATROOM,\".\").concat(V.CMD.GET_AVCHATROOM_MEMBER_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{request:{offset:\"Timestamp\",filter:\"Mark\"},response:{NextTimestamp:\"offset\"}}}}(e)),this._configMap.set(Gs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.GET_GROUP_MEMBER_INFO)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{userIDList:\"Member_List_Account\",memberCustomFieldFilter:\"AppDefinedDataFilter_GroupMember\"},response:{MemberList:\"members\",ShutUpUntil:\"muteUntil\",AppDefinedDataFilter_GroupMember:\"memberCustomFieldFilter\",AppMemberDefinedData:\"memberCustomField\"}}}}(e)),this._configMap.set(Us,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.ADD_GROUP_MEMBER)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{request:{userID:\"Member_Account\",userIDList:\"MemberList\"},response:{MemberList:\"members\"}}}}(e)),this._configMap.set(Ps,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.DELETE_GROUP_MEMBER)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{request:{userIDList:\"MemberToDel_Account\"}}}}(e)),this._configMap.set(bs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.BAN_AVCHATROOM_MEMBER)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:\"\"},keyMap:{request:{userIDList:\"Members_Account\",duration:\"Duration\",reason:\"Description\"}}}}(e)),this._configMap.set(ws,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP,\".\").concat(V.CMD.MODIFY_GROUP_MEMBER_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{request:{userID:\"Member_Account\",memberCustomField:\"AppMemberDefinedData\",muteTime:\"ShutUpTime\",messageRemindType:\"MsgFlag\"}}}}(e)),this._configMap.set(Fs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.GROUP_AVCHATROOM,\".\").concat(V.CMD.MARK_AVCHATROOM_MEMBER_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{request:{operationType:\"CommandType\",memberList:\"MemberList\",markType:\"Marks\",userID:\"Member_Account\"},response:{CommandType:\"operationType\",Marks:\"markType\",Member_Account:\"userID\"}}}}(e)),this._configMap.set(Bs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STAT,\".\").concat(V.CMD.TIM_WEB_REPORT_V2)}),body:{header:{},event:[],quality:[]},keyMap:{request:{SDKType:\"sdk_type\",SDKVersion:\"sdk_version\",deviceType:\"device_type\",platform:\"platform\",instanceID:\"instance_id\",traceID:\"trace_id\",SDKAppID:\"sdk_app_id\",userID:\"user_id\",tinyID:\"tiny_id\",extension:\"extension\",timestamp:\"timestamp\",networkType:\"network_type\",eventType:\"event_type\",code:\"error_code\",message:\"error_message\",moreMessage:\"more_message\",duplicate:\"duplicate\",costTime:\"cost_time\",level:\"level\",qualityType:\"quality_type\",reportIndex:\"report_index\",wholePeriod:\"whole_period\",totalCount:\"total_count\",rttCount:\"success_count_business\",successRateOfRequest:\"percent_business\",countLessThan1Second:\"success_count_business\",percentOfCountLessThan1Second:\"percent_business\",countLessThan3Second:\"success_count_platform\",percentOfCountLessThan3Second:\"percent_platform\",successCountOfBusiness:\"success_count_business\",successRateOfBusiness:\"percent_business\",successCountOfPlatform:\"success_count_platform\",successRateOfPlatform:\"percent_platform\",successCountOfMessageReceived:\"success_count_business\",successRateOfMessageReceived:\"percent_business\",avgRTT:\"average_value\",avgDelay:\"average_value\",avgValue:\"average_value\",uiPlatform:\"ui_platform\"}}}}(o)),this._configMap.set(Hs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.HEARTBEAT,\".\").concat(V.CMD.ALIVE)}),body:{}}}(e)),this._configMap.set(Ks,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_PUSH,\".\").concat(V.CMD.MESSAGE_PUSH)}),body:{},keyMap:{response:{C2cMsgArray:\"C2CMessageArray\",GroupMsgArray:\"groupMessageArray\",GroupTips:\"groupTips\",C2cNotifyMsgArray:\"C2CNotifyMessageArray\",C2cMsgInfo:\"C2CReadReceiptArray\",ClientSeq:\"clientSequence\",MsgPriority:\"priority\",NoticeSeq:\"noticeSequence\",MsgContent:\"content\",MsgType:\"type\",MsgBody:\"elements\",ToGroupId:\"to\",Desc:\"description\",Ext:\"extension\",IsSyncMsg:\"isSyncMessage\",Flag:\"needSync\",NeedAck:\"needAck\",PendencyAdd_Account:\"userID\",ProfileImNick:\"nick\",PendencyType:\"applicationType\",C2CReadAllMsg:\"readAllC2CMessage\",IsNeedReadReceipt:\"needReadReceipt\",Status:\"statusType\"}}}}(e)),this._configMap.set(Ws,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_PUSH,\".\").concat(V.CMD.MULTI_MESSAGE_PUSH)}),body:{},keyMap:{response:{GroupMsgArray:\"groupMessageArray\",GroupTips:\"groupTips\",ClientSeq:\"clientSequence\",MsgPriority:\"priority\",NoticeSeq:\"noticeSequence\",MsgContent:\"content\",MsgType:\"type\",MsgBody:\"elements\",ToGroupId:\"to\",Desc:\"description\",Ext:\"extension\",IsSyncMsg:\"isSyncMessage\",Flag:\"needSync\",NeedAck:\"needAck\",PendencyType:\"applicationType\"}}}}(e)),this._configMap.set(Ys,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.OPEN_IM,\".\").concat(V.CMD.MESSAGE_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{request:{sessionData:\"SessionData\"}}}}(e)),this._configMap.set(js,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{response:{C2cNotifyMsgArray:\"C2CNotifyMessageArray\",NoticeSeq:\"noticeSequence\",KickoutMsgNotify:\"kickoutMsgNotify\",NewInstInfo:\"newInstanceInfo\"}}}}(e)),this._configMap.set(Js,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_LONG_MESSAGE,\".\").concat(V.CMD.DOWNLOAD_MERGER_MESSAGE)}),body:{downloadKey:\"\"},keyMap:{response:{Data:\"data\",Desc:\"description\",Ext:\"extension\",Download_Flag:\"downloadFlag\",ThumbUUID:\"thumbUUID\",VideoUUID:\"videoUUID\"}}}}(e)),this._configMap.set(zs,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_LONG_MESSAGE,\".\").concat(V.CMD.UPLOAD_MERGER_MESSAGE)}),body:{messageList:[]},keyMap:{request:{fromAccount:\"From_Account\",toAccount:\"To_Account\",msgTimeStamp:\"MsgTimeStamp\",msgSeq:\"MsgSeq\",msgRandom:\"MsgRandom\",msgBody:\"MsgBody\",type:\"MsgType\",content:\"MsgContent\",data:\"Data\",description:\"Desc\",extension:\"Ext\",sizeType:\"Type\",uuid:\"UUID\",url:\"\",imageUrl:\"URL\",fileUrl:\"Url\",remoteAudioUrl:\"Url\",remoteVideoUrl:\"VideoUrl\",thumbUUID:\"ThumbUUID\",videoUUID:\"VideoUUID\",videoUrl:\"\",downloadFlag:\"Download_Flag\",from:\"From_Account\",time:\"MsgTimeStamp\",messageRandom:\"MsgRandom\",messageSequence:\"MsgSeq\",elements:\"MsgBody\",clientSequence:\"ClientSeq\",payload:\"MsgContent\",messageList:\"MsgList\",messageNumber:\"MsgNum\",abstractList:\"AbstractList\",messageBody:\"MsgBody\"}}}}(e)),this._configMap.set(da,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.SET_TOKEN)}),body:{tokenID:\"\",pushMsg:0,sdkAppID:0,businessID:\"\",deviceBrand:\"\",deviceToken:\"\",isTpns:0,isWebUniapp:0},keyMap:{request:{tokenID:\"TokenID\",pushMsg:\"PushMsg\",sdkAppID:\"EnterVersion\",businessID:\"BusiID\",deviceBrand:\"InstType\",deviceToken:\"VarToken\",isTpns:\"IsTpns\"}}}}(e)),this._configMap.set(la,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.STAT_FOREGROUND)}),body:{isWebUniapp:0}}}(e)),this._configMap.set(ca,function(e){return{head:t(t({},e),{},{servcmd:\"\".concat(V.NAME.IM_OPEN_STATUS,\".\").concat(V.CMD.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{request:{c2cUnreadCount:\"C2cUnread\",groupUnreadCount:\"GrpUnread\"}}}}(e))}},{key:\"has\",value:function(e){return this._configMap.has(e)}},{key:\"get\",value:function(e){return this._configMap.get(e)}},{key:\"update\",value:function(){this._fillConfigMap()}},{key:\"getKeyMap\",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(Ve.w(\"\".concat(this._n,\".getKeyMap unknown protocolName:\").concat(e)),{})}},{key:\"getProtocolData\",value:function(e){var t=e.protocolName,n=e.requestData,o=this.get(t),s=null;if(n){var a=this._simpleDeepCopy(o),i=this._updateService(n,a),r=i.body,u=Object.create(null);for(var c in r)if(Object.prototype.hasOwnProperty.call(r,c)){if(u[c]=r[c],void 0===n[c])continue;u[c]=n[c]}i.body=u,s=this._getUplinkData(i)}else s=this._getUplinkData(o);return s}},{key:\"_getUplinkData\",value:function(e){var t=this._requestDataCleaner(e),n=bt(t.head),o=Sr(t.body,this._getRequestKeyMap(n));return t.body=o,t}},{key:\"_updateService\",value:function(e,t){var n=bt(t.head);if(this._isFromGroupRequest(t)){var o=e.type,s=e.groupID,a=void 0===s?void 0:s,i=e.groupIDList,r=void 0===i?[]:i;it(a)&&(a=r[0]||\"\"),Dt({type:o,groupID:a})&&(t.head.servcmd=\"\".concat(V.NAME.GROUP_COMMUNITY,\".\").concat(n))}return t}},{key:\"_isFromGroupRequest\",value:function(e){return e.head.servcmd.includes(V.NAME.GROUP)||e.head.servcmd.includes(V.NAME.GROUP_ATTR)}},{key:\"_getRequestKeyMap\",value:function(e){var n=this.getKeyMap(e);return t(t({},Dr.request),n.request)}},{key:\"_requestDataCleaner\",value:function(e){var t=Array.isArray(e)?[]:Object.create(null);for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&dt(o)&&null!==e[o]&&void 0!==e[o]&&(\"object\"!==n(e[o])?t[o]=e[o]:t[o]=this._requestDataCleaner.bind(this)(e[o]));return t}},{key:\"_simpleDeepCopy\",value:function(e){for(var t,n=Object.keys(e),o={},s=0,a=n.length;s<a;s++)t=n[s],at(e[t])?o[t]=Array.from(e[t]):ot(e[t])?o[t]=this._simpleDeepCopy(e[t]):o[t]=e[t];return o}}]),e}(),Wr=[Ys],Yr=function(){function e(t){o(this,e),this._sessionModule=t,this._n=\"DownlinkHandler\",this._eventHandlerMap=new Map,this._eventHandlerMap.set(\"C2CMessageArray\",this._c2cMessageArrayHandler.bind(this)),this._eventHandlerMap.set(\"groupMessageArray\",this._groupMessageArrayHandler.bind(this)),this._eventHandlerMap.set(\"groupTips\",this._groupTipsHandler.bind(this)),this._eventHandlerMap.set(\"C2CNotifyMessageArray\",this._C2CNotifyMessageArrayHandler.bind(this)),this._eventHandlerMap.set(\"C2CReadReceiptArray\",this._C2CReadReceiptArrayHandler.bind(this)),this._eventHandlerMap.set(\"profileModify\",this._profileHandler.bind(this)),this._eventHandlerMap.set(\"friendListMod\",this._relationChainHandler.bind(this)),this._eventHandlerMap.set(\"recentContactMod\",this._recentContactHandler.bind(this)),this._eventHandlerMap.set(\"readAllC2CMessage\",this._allMessageReadHandler.bind(this)),this._eventHandlerMap.set(\"c2cMessageModified\",this._c2cMessageModifiedHandler.bind(this)),this._eventHandlerMap.set(\"groupMessageModified\",this._groupMessageModifiedHandler.bind(this)),this._eventHandlerMap.set(\"userStatusList\",this._userStatusListHandler.bind(this)),this._eventHandlerMap.set(\"messageExtensionNotify\",this._messageExtensionNotifyHandler.bind(this)),this._keys=m(this._eventHandlerMap.keys())}return a(e,[{key:\"_c2cMessageArrayHandler\",value:function(e){var t=this._sessionModule.getModule(Un);if(t){if(e.dataList.forEach((function(e){if(1===e.isSyncMessage){var t=e.from;e.from=e.to,e.to=t}})),1===e.needSync)this._sessionModule.getModule(jn).startOnlineSync();t.onNewC2CMessage({dataList:e.dataList,isInstantMessage:!0})}}},{key:\"_c2cMessageModifiedHandler\",value:function(e){var t=this._sessionModule.getModule(Un);t&&t.onC2CMessageModified(e)}},{key:\"_groupMessageArrayHandler\",value:function(e){var t=this._sessionModule.getModule(Pn);t&&t.onNewGroupMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:\"_groupMessageModifiedHandler\",value:function(e){var t=this._sessionModule.getModule(Pn);t&&t.onGroupMessageModified(e)}},{key:\"_groupTipsHandler\",value:function(e){var t=this._sessionModule.getModule(Pn);if(t){var n=e.event,o=e.dataList,s=e.isInstantMessage,a=void 0===s||s,i=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:o});break;case 5:for(var r=0;r<o.length;r++)if(at(o[r].elements.revokedInfos))t.onGroupMessageRevoked({dataList:o});else if(at(o[r].elements.groupMessageReadNotice))t.onGroupMessageReadNotice({dataList:o});else{if(!at(o[r].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:o,isInstantMessage:a,isSyncingEnded:i});break}t.onReadReceiptList({dataList:o})}break;case 12:this._sessionModule.getModule(qn).onNewGroupAtTips({dataList:o});break;default:Ve.l(\"\".concat(this._n,\"._groupTipsHandler unknown event:\").concat(n,\" dataList:\"),o)}}}},{key:\"_C2CNotifyMessageArrayHandler\",value:function(e){var t=this,n=e.dataList;if(at(n)){var o=this._sessionModule.getModule(Un);n.forEach((function(e){if(st(e))if(e.hasOwnProperty(\"kickoutMsgNotify\")){var s=e.kickoutMsgNotify,a=s.kickType,i=s.newInstanceInfo,r=void 0===i?{}:i;1===a?t._sessionModule.onMultipleAccountKickedOut(r):2===a?t._sessionModule.onMultipleDeviceKickedOut(r):3===a&&t._sessionModule.onRestApiKickedOut(r)}else if(e.hasOwnProperty(\"c2cMessageRevokedNotify\"))o&&o.onC2CMessageRevoked({dataList:n});else if(e.hasOwnProperty(\"c2cMessageReadReceipt\"))o&&o.onC2CMessageReadReceipt({dataList:n});else if(e.hasOwnProperty(\"c2cMessageReadNotice\"))o&&o.onC2CMessageReadNotice({dataList:n});else if(e.hasOwnProperty(\"muteNotificationsSync\")){t._sessionModule.getModule(qn).onC2CMessageRemindTypeSynced({dataList:n})}}))}}},{key:\"_C2CReadReceiptArrayHandler\",value:function(e){this._sessionModule.getModule(Un).onReadReceiptList(e)}},{key:\"_profileHandler\",value:function(e){this._sessionModule.getModule(Gn).onProfileModified({dataList:e.dataList});var t=this._sessionModule.getModule(bn);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:\"_relationChainHandler\",value:function(e){this._sessionModule.getModule(Gn).onRelationChainModified({dataList:e.dataList});var t=this._sessionModule.getModule(bn);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:\"_recentContactHandler\",value:function(e){var t=e.dataList;if(at(t)){var n=this._sessionModule.getModule(qn);n&&t.forEach((function(e){var t=e.pushType;if(1===t){var o=e.recentContactDeleteItem;n.onConversationDeleted(o.recentContactList)}else if(2===t){var s=e.recentContactTopItem;n.onConversationPinned(s.recentContactList)}else if(3===t){var a=e.recentContactTopItem;n.onConversationUnpinned(a.recentContactList)}else if(4===t){var i=e.recentContactMarkContact;n.onConversationMarkUpdated(i.recentContactMarkContactItem)}else if(5===t){var r=e.recentContactCreateContactGroup;n.onConversationGroupCreated(r.msgContactGroupContactItem)}else if(6===t){var u=e.recentContactDelContactGroup;n.onConversationGroupDeleted(u.msgGroupItem)}else if(7===t){var c=e.recentContactUpdateContactGroup,l=c.updateType,d=c.msgUpdateGroup,p=c.msgUpdateContact;if(1===l){var g=d.updateGroupType;1===g?n.onConversationGroupNameUpdated(d):2===g&&n.onConversationInGroupUpdated(d)}else 2===l&&n.onConversationAddedToOrDeletedFromGroup(p)}}))}}},{key:\"_allMessageReadHandler\",value:function(e){var t=e.dataList,n=this._sessionModule.getModule(qn);n&&n.onPushedAllMessageRead(t)}},{key:\"_userStatusListHandler\",value:function(e){this._sessionModule.getModule(Gn).onUserStatusUpdated(e)}},{key:\"_messageExtensionNotifyHandler\",value:function(e){this._sessionModule.getModule(On).onMessageExtensionNotify(e)}},{key:\"onMessage\",value:function(e){var t=this,n=e.body;if(this._filterMessageFromIMOpenPush(e)){var o=n.eventArray,s=n.isInstantMessage,a=n.isSyncingEnded,i=n.needSync;if(at(o))for(var r=null,u=null,c=0,l=0,d=o.length;l<d;l++){c=(r=o[l]).event;var p=Object.keys(r).find((function(e){return-1!==t._keys.indexOf(e)}));p?(u=14===c?{readAllC2CMessage:r[p],groupMessageReadInfoList:r.groupMessageReadNotice||[]}:16===c?{userID:r.userID,readReceiptList:r[p]}:r[p],this._eventHandlerMap.get(p)({event:c,dataList:u,isInstantMessage:s,isSyncingEnded:a,needSync:i})):Ve.l(\"\".concat(this._n,\".onMessage unknown eventItem:\").concat(r))}}}},{key:\"_filterMessageFromIMOpenPush\",value:function(e){var t=e.head,n=e.body,o=t.servcmd,s=!1;if(it(o)||(s=o.includes(V.NAME.IM_CONFIG_MANAGER)||o.includes(V.NAME.OVERLOAD_PUSH)||o.includes(V.NAME.STAT_SERVICE)),!s)return!0;if(o.includes(V.CMD.PUSHED_CLOUD_CONTROL_CONFIG))this._sessionModule.getModule(Zn).onPushedCloudControlConfig(n);else if(o.includes(V.CMD.PUSHED_COMMERCIAL_CONFIG)){this._sessionModule.getModule(to).onPushedConfig(n)}else if(o.includes(V.CMD.OVERLOAD_NOTIFY))this._sessionModule.onPushedServerOverload(n);else if(o.includes(V.CMD.KICK_OTHER)){var a=Date.now();this._sessionModule.reLoginOnKickOther();var i=new Aa(\"kickOther\"),r=this._sessionModule.getModule(Rn).getLastWsHelloTs(),u=a-r;i.setMessage(\"last wshello time:\".concat(r,\" diff:\").concat(u,\"ms\")).setNetworkType(this._sessionModule.getNetworkType()).end()}return!1}}]),e}(),jr=[{cmd:V.CMD.GET_GROUP_INFO,interval:1,count:20},{cmd:V.CMD.GET_AVCHATROOM_MEMBER_LIST,interval:3,count:1},{cmd:V.CMD.GET_GROUP_APPLICATION,interval:1,count:15},{cmd:V.CMD.GET_TOPIC_LIST,interval:1,count:10},{cmd:V.CMD.SET_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:V.CMD.MODIFY_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:V.CMD.DELETE_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:V.CMD.CLEAR_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:V.CMD.GET_GROUP_ATTRIBUTES,interval:5,count:20},{cmd:V.CMD.UPDATE_GROUP_COUNTER,interval:5,count:20},{cmd:V.CMD.GET_GROUP_COUNTER,interval:5,count:20},{cmd:V.CMD.SET_ALL_MESSAGE_READ,interval:1,count:1},{cmd:V.CMD.GET_USER_STATUS,interval:5,count:20},{cmd:V.CMD.SUBSCRIBE_USER_STATUS,interval:5,count:20},{cmd:V.CMD.UNSUBSCRIBE_USER_STATUS,interval:5,count:20}],zr=function(e){r(s,e);var n=f(s);function s(e){var t;return o(this,s),(t=n.call(this,e))._n=\"SessionModule\",t._platform=t.getPlatform(),t._protocolHandler=new Kr(h(t)),t._messageDispatcher=new Yr(h(t)),t._commandFrequencyLimitMap=new Map,t._commandRequestInfoMap=new Map,t._serverOverloadInfoMap=new Map,t._init(),t.getInnerEmitterInstance().on(ti,t._onCloudConfigUpdated,h(t)),t}return a(s,[{key:\"_init\",value:function(){this._updateCommandFrequencyLimitMap(jr)}},{key:\"_onCloudConfigUpdated\",value:function(){var e=this.getCloudConfig(\"cmd_frequency_limit\");it(e)||(e=JSON.parse(e),this._updateCommandFrequencyLimitMap(e))}},{key:\"_updateCommandFrequencyLimitMap\",value:function(e){var t=this;e.forEach((function(e){t._commandFrequencyLimitMap.set(e.cmd,{interval:e.interval,count:e.count})}))}},{key:\"updateProtocolConfig\",value:function(){this._protocolHandler.update()}},{key:\"request\",value:function(e){Ve.d(\"\".concat(this._n,\".request options:\"),e);var t=e.protocolName,n=e.tjgID;if(!this._protocolHandler.has(t))return Ve.w(\"\".concat(this._n,\".request unknown protocol:\").concat(t)),Za({code:ha.CANNOT_FIND_PROTOCOL});var o=this.getProtocolData(e),s=o.head.servcmd;if(this._isFrequencyOverLimit(s))return Za({code:ha.OVER_FREQUENCY_LIMIT});if(this._isServerOverload(s))return Za({code:ha.OPEN_SERVICE_OVERLOAD_ERROR});zt(n)||(o.head.tjgID=n);var a=this.getModule(Jn);return Wr.includes(t)?a.simplySend(o):a.send(o)}},{key:\"getKeyMap\",value:function(e){return this._protocolHandler.getKeyMap(e)}},{key:\"genCommonHead\",value:function(){var e=this.getModule(xn);return{ver:\"v4\",platform:this._platform,websdkappid:O,websdkversion:N,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:192371,tjgID:\"\"}}},{key:\"genCosSpecifiedHead\",value:function(){var e=this.getModule(xn);return{ver:\"v4\",platform:this._platform,websdkappid:O,websdkversion:N,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:192371}}},{key:\"genSSOReportHead\",value:function(){var e=this.getModule(xn);return{ver:\"v4\",platform:this._platform,websdkappid:O,websdkversion:N,sdkappid:e.getSDKAppID(),contenttype:\"\",reqtime:0,identifier:\"\",usersig:\"\",status_instid:e.getStatusInstanceID(),sdkability:192371}}},{key:\"getProtocolData\",value:function(e){return this._protocolHandler.getProtocolData(e)}},{key:\"trans\",value:function(e){var n=e.servcmd,o=e.data,s={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:o};return this.getModule(Jn).send(s)}},{key:\"sendComboMessage\",value:function(e){var n=e.servcmd,o=e.data,s={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:o};return this.getModule(Jn).send(s)}},{key:\"onErrorCodeNotZero\",value:function(e){var t=e.errorCode;if(t===ha.HELLO_ANSWER_KICKED_OUT){var n=e.kickType,o=e.newInstanceInfo,s=void 0===o?{}:o;1===n?this.onMultipleAccountKickedOut(s):2===n?this.onMultipleDeviceKickedOut(s):3===n&&this.onRestApiKickedOut(s)}t!==ha.MESSAGE_A2KEY_EXPIRED&&t!==ha.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.getModule(Jn).reConnect())}},{key:\"onMessage\",value:function(e){var t=e.body,n=t.needAck,o=void 0===n?0:n,s=t.sessionData;1===o&&this._sendACK(s),this._messageDispatcher.onMessage(e)}},{key:\"onReconnected\",value:function(){this._reLoginOnReconnected()}},{key:\"reLoginOnKickOther\",value:function(){Ve.l(\"\".concat(this._n,\".reLoginOnKickOther\")),this._reLogin()}},{key:\"_reLoginOnReconnected\",value:function(){Ve.l(\"\".concat(this._n,\"._reLoginOnReconnected\")),this._reLogin()}},{key:\"_reLogin\",value:function(){var e=this;if(this.isLoggedIn()){var t=0,n=this.getModule(no);n.canIUseOfflinePush()&&(t=n.getUniAppPlatform()),this.request({protocolName:co,requestData:{isWebUniapp:t}}).then((function(t){var n=t.data.instanceID;e.getModule(xn).setStatusInstanceID(n),Ve.l(\"\".concat(e._n,\"._reLogin ok.\")),e.getModule(qn).syncConversationList().then((function(){Ve.l(\"\".concat(e._n,\"._reLogin, sync conversation list ok.\")),e.getModule($n).start()})),e.getModule(Pn).updateLocalMainSequenceOnReconnected();var o=e.getModule(Fn);o.resetGetTopicTime(),o.getTopicListOnReconnected()}))}}},{key:\"onMultipleAccountKickedOut\",value:function(e){this.getModule(Rn).onMultipleAccountKickedOut(e)}},{key:\"onMultipleDeviceKickedOut\",value:function(e){this.getModule(Rn).onMultipleDeviceKickedOut(e)}},{key:\"_onUserSigExpired\",value:function(){this.getModule(Rn).onUserSigExpired()}},{key:\"onRestApiKickedOut\",value:function(e){this.getModule(Rn).onRestApiKickedOut(e)}},{key:\"_sendACK\",value:function(e){this.request({protocolName:Ys,requestData:{sessionData:e}})}},{key:\"_isFrequencyOverLimit\",value:function(e){var t=e.split(\".\")[1];if(!this._commandFrequencyLimitMap.has(t))return!1;if(!this._commandRequestInfoMap.has(t))return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;var n=this._commandFrequencyLimitMap.get(t),o=n.count,s=n.interval,a=this._commandRequestInfoMap.get(t),i=a.startTime,r=a.requestCount;if(Date.now()-i>1e3*s)return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;r+=1,this._commandRequestInfoMap.set(t,{startTime:i,requestCount:r});var u=!1;return r>o&&(u=!0),u}},{key:\"_isServerOverload\",value:function(e){if(!this._serverOverloadInfoMap.has(e))return!1;var t=this._serverOverloadInfoMap.get(e),n=t.overloadTime,o=t.waitingTime,s=!1;return Date.now()-n<=1e3*o?s=!0:(this._serverOverloadInfoMap.delete(e),s=!1),s}},{key:\"onPushedServerOverload\",value:function(e){var t=e.overloadCommand,n=e.waitingTime;this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:n}),Ve.w(\"\".concat(this._n,\".onPushedServerOverload waitingTime:\").concat(n,\"s\"))}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._updateCommandFrequencyLimitMap(jr),this._commandRequestInfoMap.clear(),this._serverOverloadInfoMap.clear()}}]),s}(uo),Jr=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"MessageLossDetectionModule\",s._maybeLostSequencesMap=new Map,s._firstRoundRet=[],s}return a(n,[{key:\"onMessageMaybeLost\",value:function(e,t,n){this._maybeLostSequencesMap.has(e)||this._maybeLostSequencesMap.set(e,[]);for(var o=this._maybeLostSequencesMap.get(e),s=0;s<n;s++)-1===o.indexOf(t+s)&&o.push(t+s)}},{key:\"detectFirstRound\",value:function(e,t){var n=this._maybeLostSequencesMap.get(e);if(!zt(n)&&!zt(t)){var o=n.filter((function(e){return-1===t.indexOf(e)}));0===o.length?Ve.i(\"\".concat(this._n,\".detectFirstRound no message loss. conversationID:\").concat(e)):this._firstRoundRet=this._firstRoundRet.concat(o),n.length=0}}},{key:\"detectSecondRound\",value:function(e,t){if(!zt(this._firstRoundRet)&&!zt(t)){var n=this._firstRoundRet.filter((function(e){return-1===t.indexOf(e)}));this._firstRoundRet.length=0;var o,s=n.length;if(0!==s)s<=5?o=e+\"-\"+n.join(\"-\"):(n.sort((function(e,t){return e-t})),o=e+\" start:\"+n[0]+\" end:\"+n[s-1]+\" count:\"+s),new Aa(\"messageLoss\").setMessage(o).setNetworkType(this.getNetworkType()).setLevel(\"warning\").end(),Ve.i(\"\".concat(this._n,\".detectSecondRound message loss detected. conversationID:\").concat(e,\" lostSequences:\").concat(n))}}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._maybeLostSequencesMap.clear(),this._firstRoundRet.length=0}}]),n}(uo),Xr=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"CloudControlModule\",s._cloudConfig=new Map,s._expiredTime=0,s._version=0,s._isFetching=!1,s}return a(n,[{key:\"getCloudConfig\",value:function(e){return it(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:\"_canFetchConfig\",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:\"fetchConfig\",value:function(){var e=this,t=this._canFetchConfig();if(Ve.l(\"\".concat(this._n,\".fetchConfig canFetchConfig:\").concat(t)),t){var n=new Aa(\"fetchCloudControlConfig\"),o=this.getModule(xn).getSDKAppID();this._isFetching=!0,this.request({protocolName:Xs,requestData:{SDKAppID:o,version:this._version}}).then((function(t){e._isFetching=!1,n.setMessage(\"version:\".concat(e._version,\" newVersion:\").concat(t.data.version,\" config:\").concat(t.data.cloudControlConfig)).setNetworkType(e.getNetworkType()).end(),Ve.l(\"\".concat(e._n,\".fetchConfig ok\")),e._parseCloudControlConfig(t.data)})).catch((function(t){e._isFetching=!1,e.probeNetwork().then((function(e){var o=v(e,2),s=o[0],a=o[1];n.setError(t,s,a).end()})),Ve.l(\"\".concat(e._n,\".fetchConfig failed. error:\"),t),e._setExpiredTimeOnResponseError(12e4)}))}}},{key:\"onPushedCloudControlConfig\",value:function(e){Ve.l(\"\".concat(this._n,\".onPushedCloudControlConfig\")),new Aa(\"pushedCloudControlConfig\").setNetworkType(this.getNetworkType()).setMessage(\"newVersion:\".concat(e.version,\" config:\").concat(e.cloudControlConfig)).end(),this._parseCloudControlConfig(e)}},{key:\"onCheckTimer\",value:function(e){this._canFetchConfig()&&this.fetchConfig()}},{key:\"_parseCloudControlConfig\",value:function(e){var t=this,n=\"\".concat(this._n,\"._parseCloudControlConfig\"),o=e.errorCode,s=e.errorMessage,a=e.cloudControlConfig,i=e.version,r=e.expiredTime;if(0===o){if(this._version!==i){var u=null;try{u=JSON.parse(a)}catch(c){this.isPrivateNetWork()||Ve.e(\"\".concat(n,\" JSON parse error. cloudControlConfig:\"),a)}u&&(this._cloudConfig.clear(),Object.keys(u).forEach((function(e){t._cloudConfig.set(e,u[e])})),this._version=i,this.emitInnerEvent(ti))}this._expiredTime=Date.now()+1e3*r}else it(o)?(Ve.l(\"\".concat(n,\" failed. Invalid message format:\"),e),this._setExpiredTimeOnResponseError(36e5)):(Ve.e(\"\".concat(n,\" errorCode:\").concat(o,\" errorMessage:\").concat(s)),this._setExpiredTimeOnResponseError(12e4))}},{key:\"_setExpiredTimeOnResponseError\",value:function(e){this._expiredTime=Date.now()+e}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),n}(uo),Zr=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"RecoverMessageModule\",s.PULL_LIMIT_COUNT=15,s}return a(n,[{key:\"start\",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:\"_recoverGroupChat\",value:function(){var e,t,n=this,o=this._getLocalConversationList().filter((function(e){return e.type===E.CONV_GROUP&&e.groupProfile.type!==E.GRP_AVCHATROOM})),s=this.getModule(qn),a=0,i=0,r=0;o.forEach((function(o){var u=o.conversationID,c=o.lastMessage;t=u.replace(E.CONV_GROUP,\"\"),e=s.getLocalLastMessage(u),c&&0!==c.lastSequence&&e?(i=c.lastSequence,a=e.sequence,r=i-a,a>0&&r>=1&&r<300?n._recoverGroupMessage({groupID:t,localLastMessageSequence:a,remoteLastMessageSequence:i}):n._getGroupNotify(t)):n._getGroupNotify(t)}))}},{key:\"_recoverC2CChat\",value:function(){var e,t=this,n=this._getLocalConversationList().filter((function(e){return e.type===E.CONV_C2C})),o=this.getModule(qn),s=0,a=0,i=0,r=[Promise.resolve()];n.forEach((function(n){var u=n.conversationID,c=n.lastMessage;e=o.getLocalLastMessage(u),c&&0!==c.lastTime&&e&&(a=c.lastTime,s=e.time,i=a-s,s>0&&i>=1&&i<=600&&r.push(t._recoverC2CMessage({conversationID:u,localLastMessageTime:s,remoteLastMessageTime:a})))})),Promise.all(r).then((function(){Ve.l(\"\".concat(t._n,\"._recoverC2CChat all promise fulfilled, start to sync unread messages\")),t.getModule(jn).startSyncOnReconnected()}))}},{key:\"_getLocalConversationList\",value:function(){return this.getModule(qn).getLocalConversationList()}},{key:\"_recoverGroupMessage\",value:function(e){var t=this,n=\"\".concat(this._n,\"._recoverGroupMessage\");Ve.l(\"\".concat(n,\" options:\"),e);var o=e.groupID,s=e.localLastMessageSequence,a=e.remoteLastMessageSequence;this._getGroupRomaingMessage({groupID:o,sequence:s}).then((function(e){var s=e.data,i=s.complete,r=s.messageList;if(!it(r)){var u=r[0].sequence;Ve.l(\"\".concat(n,\" pkgLastMessageSequence:\").concat(u,\" complete:\").concat(i)),u<a&&2!==i&&t._recoverGroupMessage({groupID:o,localLastMessageSequence:u,remoteLastMessageSequence:a}),new Aa(\"recoverMessage\").setNetworkType(t.getNetworkType()).setMessage(\"groupID:\".concat(o,\" complete:\").concat(i,\" messageList length:\").concat(r.length)).end();var c=t.getModule(Pn);r.length>1&&r.sort((function(e,t){return e.sequence-t.sequence}));for(var l=0;l<r.length;l++){var d=r[l];d.from!==E.CONV_SYSTEM?c.onNewGroupMessage({dataList:[d],isInstantMessage:!1,updateUnreadCount:!1}):c.onNewGroupTips({event:d.event,dataList:[d]})}t._getGroupNotify(o)}}))}},{key:\"_getGroupNotify\",value:function(e){this.getModule(Pn).getGroupNotify(e)}},{key:\"_getGroupRomaingMessage\",value:function(e){var t=e.groupID,n=e.sequence;return this.request({protocolName:cs,requestData:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:n+this.PULL_LIMIT_COUNT-1}})}},{key:\"_recoverC2CMessage\",value:function(e){var t=this,n=\"\".concat(this._n,\"._recoverC2CMessage\");Ve.l(\"\".concat(this._n,\"._recoverC2CMessage options:\"),e);var o=e.conversationID,s=e.localLastMessageTime,a=e.remoteLastMessageTime;return this._getC2CRoamingMessage({conversationID:o,time:s}).then((function(e){var s=e.data,i=s.complete,r=s.messageList;if(!it(r)){var u=r.length;new Aa(\"recoverMessage\").setNetworkType(t.getNetworkType()).setMessage(\"\".concat(o,\" complete:\").concat(i,\" messageList length:\").concat(u)).end(),t.getModule(Un).onNewC2CMessage({dataList:r,isInstantMessage:!0});var c=r[u-1].time;if(Ve.l(\"\".concat(n,\" pkgLastMessageTime:\").concat(c,\" complete:\").concat(i)),c<a&&1!==i)return t._recoverC2CMessage({conversationID:o,localLastMessageTime:c,remoteLastMessageTime:a})}}))}},{key:\"_getC2CRoamingMessage\",value:function(e){var t=e.conversationID,n=e.time;return this.request({protocolName:So,requestData:{peerAccount:t.replace(E.CONV_C2C,\"\"),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:n,direction:1}})}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\"))}}]),n}(uo),Qr=function(){function e(){o(this,e),this._n=\"AvgE2EDelay\",this._e2eDelayArray=[]}return a(e,[{key:\"addMessageDelay\",value:function(e){var t=we()-e;t>=0&&this._e2eDelayArray.push(t)}},{key:\"_calcAvg\",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),wt(n/t,1)}},{key:\"_calcCountWithLimit\",value:function(e){var t=e.e2eDelayArray,n=e.min,o=e.max;return t.filter((function(e){return n<=e&&e<o})).length}},{key:\"_calcPercent\",value:function(e,t){var n=wt(e/t*100,2);return n>100&&(n=100),n}},{key:\"_checkE2EDelayException\",value:function(e,t){var n=e.filter((function(e){return e>t}));if(n.length>0){var o=n.length,s=Math.min.apply(Math,m(n)),a=Math.max.apply(Math,m(n)),i=this._calcAvg(n,o),r=wt(o/e.length*100,2);if(r>50)new Aa(\"messageE2EDelayException\").setMessage(\"count:\".concat(o,\" min:\").concat(s,\" max:\").concat(a,\" avg:\").concat(i,\" percent:\").concat(r)).setLevel(\"warning\").end()}}},{key:\"getStatResult\",value:function(){var e=this._e2eDelayArray.length;if(0===e)return null;var t=m(this._e2eDelayArray),n=this._calcCountWithLimit({e2eDelayArray:t,min:0,max:1}),o=this._calcCountWithLimit({e2eDelayArray:t,min:1,max:3}),s=this._calcPercent(n,e),a=this._calcPercent(o,e),i=this._calcAvg(t,e);return this._checkE2EDelayException(t,3),t.length=0,this.reset(),{totalCount:e,countLessThan1Second:n,percentOfCountLessThan1Second:s,countLessThan3Second:o,percentOfCountLessThan3Second:a,avgDelay:i}}},{key:\"reset\",value:function(){this._e2eDelayArray.length=0}}]),e}(),$r=function(){function e(){o(this,e),this._n=\"AvgRTT\",this._requestCount=0,this._rttArray=[]}return a(e,[{key:\"addRequestCount\",value:function(){this._requestCount+=1}},{key:\"addRTT\",value:function(e){this._rttArray.push(e)}},{key:\"_calcTotalCount\",value:function(){return this._requestCount}},{key:\"_calcRTTCount\",value:function(e){return e.length}},{key:\"_calcSuccessRateOfRequest\",value:function(e,t){if(0===t)return 0;var n=wt(e/t*100,2);return n>100&&(n=100),n}},{key:\"_calcAvg\",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),parseInt(n/t)}},{key:\"_calcMax\",value:function(){return Math.max.apply(Math,m(this._rttArray))}},{key:\"_calcMin\",value:function(){return Math.min.apply(Math,m(this._rttArray))}},{key:\"getStatResult\",value:function(){var e=this._calcTotalCount(),t=m(this._rttArray);if(0===e)return null;var n=this._calcRTTCount(t),o=this._calcSuccessRateOfRequest(n,e),s=this._calcAvg(t,n);return Ve.l(\"\".concat(this._n,\".getStatResult max:\").concat(this._calcMax(),\" min:\").concat(this._calcMin(),\" avg:\").concat(s)),this.reset(),{totalCount:e,rttCount:n,successRateOfRequest:o,avgRTT:s}}},{key:\"reset\",value:function(){this._requestCount=0,this._rttArray.length=0}}]),e}(),eu=function(){function e(){o(this,e),this._map=new Map}return a(e,[{key:\"initMap\",value:function(e){var t=this;e.forEach((function(e){t._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}))}},{key:\"addTotalCount\",value:function(e){return!(it(e)||!this._map.has(e))&&(this._map.get(e).totalCount+=1,!0)}},{key:\"addSuccessCount\",value:function(e){return!(it(e)||!this._map.has(e))&&(this._map.get(e).successCount+=1,!0)}},{key:\"addFailedCountOfUserSide\",value:function(e){return!(it(e)||!this._map.has(e))&&(this._map.get(e).failedCountOfUserSide+=1,!0)}},{key:\"addCost\",value:function(e,t){return!(it(e)||!this._map.has(e))&&(this._map.get(e).costArray.push(t),!0)}},{key:\"addFileSize\",value:function(e,t){return!(it(e)||!this._map.has(e))&&(this._map.get(e).fileSizeArray.push(t),!0)}},{key:\"_calcSuccessRateOfBusiness\",value:function(e){if(it(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=wt(t.successCount/t.totalCount*100,2);return n>100&&(n=100),n}},{key:\"_calcSuccessRateOfPlatform\",value:function(e){if(it(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=this._calcSuccessCountOfPlatform(e)/t.totalCount*100;return(n=wt(n,2))>100&&(n=100),n}},{key:\"_calcTotalCount\",value:function(e){return it(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:\"_calcSuccessCountOfBusiness\",value:function(e){return it(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:\"_calcSuccessCountOfPlatform\",value:function(e){if(it(e)||!this._map.has(e))return-1;var t=this._map.get(e);return t.successCount+t.failedCountOfUserSide}},{key:\"_calcAvg\",value:function(e){return it(e)||!this._map.has(e)?-1:e===Ia?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:\"_calcAvgCost\",value:function(e){var t=this._map.get(e).costArray.length;if(0===t)return 0;var n=0;return this._map.get(e).costArray.forEach((function(e){n+=e})),parseInt(n/t)}},{key:\"_calcAvgSpeed\",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach((function(e){t+=e})),this._map.get(e).fileSizeArray.forEach((function(e){n+=e})),parseInt(1e3*n/t)}},{key:\"getStatResult\",value:function(e){var t=this._calcTotalCount(e);if(0===t)return null;var n=this._calcSuccessCountOfBusiness(e),o=this._calcSuccessRateOfBusiness(e),s=this._calcSuccessCountOfPlatform(e),a=this._calcSuccessRateOfPlatform(e),i=this._calcAvg(e);return this.reset(e),{totalCount:t,successCountOfBusiness:n,successRateOfBusiness:o,successCountOfPlatform:s,successRateOfPlatform:a,avgValue:i}}},{key:\"reset\",value:function(e){it(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),e}(),tu=function(){function e(){o(this,e),this._lastMap=new Map,this._currentMap=new Map}return a(e,[{key:\"initMap\",value:function(e){var t=this;e.forEach((function(e){t._lastMap.set(e,new Map),t._currentMap.set(e,new Map)}))}},{key:\"addMessageSequence\",value:function(e){var t=e.key,n=e.message;if(it(t)||!this._lastMap.has(t)||!this._currentMap.has(t))return!1;var o=n.conversationID,s=n.sequence,a=o.replace(E.CONV_GROUP,\"\");if(0===this._lastMap.get(t).size)this._addCurrentMap(e);else if(this._lastMap.get(t).has(a)){var i=this._lastMap.get(t).get(a),r=i.length-1;s>i[0]&&s<i[r]?(i.push(s),i.sort(),this._lastMap.get(t).set(a,i)):this._addCurrentMap(e)}else this._addCurrentMap(e);return!0}},{key:\"_addCurrentMap\",value:function(e){var t=e.key,n=e.message,o=n.conversationID,s=n.sequence,a=o.replace(E.CONV_GROUP,\"\");this._currentMap.get(t).has(a)||this._currentMap.get(t).set(a,[]),this._currentMap.get(t).get(a).push(s)}},{key:\"_copyData\",value:function(e){if(!it(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),o=D(this._currentMap.get(e));try{for(o.s();!(t=o.n()).done;){var s=v(t.value,2),a=s[0],i=s[1];n.set(a,i)}}catch(r){o.e(r)}finally{o.f()}n=null,this._currentMap.set(e,new Map)}}},{key:\"getStatResult\",value:function(e){if(it(this._currentMap.get(e))||it(this._lastMap.get(e)))return null;if(0===this._lastMap.get(e).size)return this._copyData(e),null;var t=0,n=0;if(this._lastMap.get(e).forEach((function(e,o){var s=m(e.values()),a=s.length,i=s[a-1]-s[0]+1;t+=i,n+=a})),0===t)return null;var o=wt(n/t*100,2);return o>100&&(o=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:o}}},{key:\"reset\",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),e}(),nu=function(e){r(s,e);var n=f(s);function s(e){var t;o(this,s),(t=n.call(this,e))._n=\"QualityStatModule\",t.TAG=\"im-ssolog-quality-stat\",t.reportIndex=0,t.wholePeriod=!1,t._qualityItems=[_a,fa,va,ma,Ma,ya,Ia,Ca,Ta,Da],t._messageSentItems=[va,ma,Ma,ya,Ia],t._messageReceivedItems=[Ca,Ta,Da],t.REPORT_INTERVAL=120,t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._statInfoArr=[],t._avgRTT=new $r,t._avgE2EDelay=new Qr,t._rateMessageSent=new eu,t._rateMessageReceived=new tu;var a=t.getInnerEmitterInstance();return a.on(ei,t._onLoginSuccess,h(t)),a.on(ti,t._onCloudConfigUpdated,h(t)),t}return a(s,[{key:\"_onLoginSuccess\",value:function(){var e=this;this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems);var t=this.getModule(Vn),n=t.getItem(this.TAG,!1);!zt(n)&&ut(n.forEach)&&(Ve.l(\"\".concat(this._n,\"._onLoginSuccess get quality stat logs from local storage, count:\").concat(n.length)),n.forEach((function(t){e._statInfoArr.push(t)})),t.removeItem(this.TAG,!1))}},{key:\"_onCloudConfigUpdated\",value:function(){var e=this.getCloudConfig(\"q_rpt_interval\"),t=this.getCloudConfig(\"q_rpt_sdkappid_bl\"),n=this.getCloudConfig(\"q_rpt_tinyid_wl\");it(e)||(this.REPORT_INTERVAL=Number(e)),it(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(\",\").map((function(e){return Number(e)}))),it(n)||(this.REPORT_TINYID_WHITELIST=n.split(\",\"))}},{key:\"onCheckTimer\",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:\"addRequestCount\",value:function(){this._avgRTT.addRequestCount()}},{key:\"addRTT\",value:function(e){this._avgRTT.addRTT(e)}},{key:\"addMessageDelay\",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:\"addTotalCount\",value:function(e){this._rateMessageSent.addTotalCount(e)||Ve.w(\"\".concat(this._n,\".addTotalCount invalid key:\"),e)}},{key:\"addSuccessCount\",value:function(e){this._rateMessageSent.addSuccessCount(e)||Ve.w(\"\".concat(this._n,\".addSuccessCount invalid key:\"),e)}},{key:\"addFailedCountOfUserSide\",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||Ve.w(\"\".concat(this._n,\".addFailedCountOfUserSide invalid key:\"),e)}},{key:\"addCost\",value:function(e,t){this._rateMessageSent.addCost(e,t)||Ve.w(\"\".concat(this._n,\".addCost invalid key or cost:\"),e,t)}},{key:\"addFileSize\",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||Ve.w(\"\".concat(this._n,\".addFileSize invalid key or size:\"),e,t)}},{key:\"addMessageSequence\",value:function(e){this._rateMessageReceived.addMessageSequence(e)||Ve.w(\"\".concat(this._n,\".addMessageSequence invalid key:\"),e.key)}},{key:\"_getQualityItem\",value:function(e){var n={},o=Sa[this.getNetworkType()];it(o)&&(o=8);var s={qualityType:ka[e],timestamp:Pe(),networkType:o,extension:\"\"};switch(e){case _a:n=this._avgRTT.getStatResult();break;case fa:n=this._avgE2EDelay.getStatResult();break;case va:case ma:case Ma:case ya:case Ia:n=this._rateMessageSent.getStatResult(e);break;case Ca:case Ta:case Da:n=this._rateMessageReceived.getStatResult(e)}return null===n?null:t(t({},s),n)}},{key:\"_report\",value:function(e){var t=this,n=[],o=null;it(e)?this._qualityItems.forEach((function(e){null!==(o=t._getQualityItem(e))&&(o.reportIndex=t.reportIndex,o.wholePeriod=t.wholePeriod,n.push(o))})):null!==(o=this._getQualityItem(e))&&(o.reportIndex=this.reportIndex,o.wholePeriod=this.wholePeriod,n.push(o)),Ve.d(\"\".concat(this._n,\"._report\"),n),this._statInfoArr.length>0&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]);var s=this.getModule(xn),a=s.getSDKAppID(),i=s.getTinyID();Ft(this.REPORT_SDKAPPID_BLACKLIST,a)&&!qt(this.REPORT_TINYID_WHITELIST,i)&&(n=[]),n.length>0&&this._doReport(n)}},{key:\"_doReport\",value:function(e){var n=this,o={header:or(this),quality:e};this.request({protocolName:Bs,requestData:t({},o)}).then((function(){n.reportIndex++,n.wholePeriod=!1})).catch((function(t){Ve.w(\"\".concat(n._n,\"._doReport, online:\").concat(n.getNetworkType(),\" error:\"),t),n._statInfoArr=n._statInfoArr.concat(e),n._flushAtOnce()}))}},{key:\"_flushAtOnce\",value:function(){var e=this.getModule(Vn),t=e.getItem(this.TAG,!1),n=this._statInfoArr,o=\"\".concat(this._n,\"._flushAtOnce\");if(zt(t))Ve.l(\"\".concat(o,\" count:\").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var s=n.concat(t);s.length>10&&(s=s.slice(0,10)),Ve.l(\"\".concat(o,\" count:\").concat(s.length)),e.setItem(this.TAG,s,!0,!1)}this._statInfoArr=[]}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),s}(uo),ou=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"WorkerTimerModule\",s._isWorkerEnabled=!0,s._workerTimer=null,s._timerID=-1,s._init(),s.getInnerEmitterInstance().on(ti,s._onCloudConfigUpdated,h(s)),s}return a(n,[{key:\"isWorkerEnabled\",value:function(){return this._isWorkerEnabled&&Se}},{key:\"startWorkerTimer\",value:function(){Ve.l(\"\".concat(this._n,\".startWorkerTimer\")),this._workerTimer&&this._workerTimer.postMessage(\"start\")}},{key:\"stopWorkerTimer\",value:function(){Ve.l(\"\".concat(this._n,\".stopWorkerTimer\")),this._workerTimer&&this._workerTimer.postMessage(\"stop\")}},{key:\"_init\",value:function(){if(Se){var e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === \"start\") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage(\"\");    }, 1000);    postMessage(interval);  } else if (event.data === \"stop\") {    clearInterval(interval);    interval = -1;  }};'],{type:\"application/javascript; charset=utf-8\"}));this._workerTimer=new Worker(e);var t=this;this._workerTimer.onmessage=function(e){e.data?(t._timerID=e.data,Ve.l(\"\".concat(t._n,\"._init seed:\").concat(t._timerID))):t._m.onCheckTimer()}}}},{key:\"_onCloudConfigUpdated\",value:function(){var e=this.getCloudConfig(\"enable_worker\");Ve.l(\"\".concat(this._n,\"._onCloudConfigUpdated enableWorker:\").concat(e)),it(e)||\"1\"===e?!this._isWorkerEnabled&&Se&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&Se&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:\"terminate\",value:function(){Ve.l(\"\".concat(this._n,\".terminate\")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:\"getTimerID\",value:function(){return this._timerID}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\"))}}]),n}(uo),su=function(){function e(){o(this,e),this._n=\"PurchasedFeatureHandler\",this._purchasedFeatureMap=new Map}return a(e,[{key:\"isValidPurchaseBits\",value:function(e){return e&&\"string\"==typeof e&&e.length>=1&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:\"parsePurchaseBits\",value:function(e){if(this.isValidPurchaseBits(e)){this._purchasedFeatureMap.clear();for(var t=null,n=e.length-1,o=0;n>=0;n--,o++)t=o<32?new L(0,Math.pow(2,o)).toString():new L(Math.pow(2,o-32),0).toString(),\"1\"===e[n]?this._purchasedFeatureMap.set(t,!0):this._purchasedFeatureMap.set(t,!1)}else Ve.w(\"\".concat(this._n,\".parsePurchaseBits invalid purchasebits:\").concat(e))}},{key:\"hasPurchasedFeature\",value:function(e){return!!this._purchasedFeatureMap.get(e)}},{key:\"isFeatureEnabled\",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,o=!0,s=t.length-1,a=0;s>=0;s--,a++)if(\"1\"===t.charAt(s)&&(n=a<32?new L(0,Math.pow(2,a)).toString():new L(Math.pow(2,a-32),0).toString(),!this._purchasedFeatureMap.get(n))){o=!1;break}return Ve.l(\"\".concat(this._n,\".isFeatureEnabled decimalNumber:\").concat(e,\" binaryString:\").concat(t,\" ret:\").concat(o)),Xa({enabled:o})}},{key:\"clear\",value:function(){this._purchasedFeatureMap.clear()}}]),e}(),au=function(){function e(t){o(this,e),this._m=t,this._n=\"CommercialConfigModule\",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new su}return a(e,[{key:\"_canFetch\",value:function(){return this._getModule(xn).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:\"onCheckTimer\",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:\"fetchConfig\",value:function(){var e=this,t=this._canFetch(),n=\"\".concat(this._n,\".fetchConfig\");if(Ve.l(\"\".concat(n,\" canFetch:\").concat(t)),t){var o=this._getModule(Hn),s=new Aa(\"fetchCommercialConfig\");s.setNetworkType(o.getNetworkType());var a=this._getModule(xn).getSDKAppID(),i=this._getModule(zn);this._isFetching=!0,i.request({protocolName:Qs,requestData:{SDKAppID:a}}).then((function(t){s.setMessage(\"purchaseBits:\".concat(t.data.purchaseBits)).end(),Ve.l(\"\".concat(n,\" ok.\")),e._parseConfig(t.data),e._isFetching=!1})).catch((function(t){o.probe().then((function(e){var n=v(e,2),o=n[0],a=n[1];s.setError(t,o,a).end()})),e._isFetching=!1}))}}},{key:\"onPushedConfig\",value:function(e){var t=\"\".concat(this._n,\".onPushedConfig data:\").concat(JSON.stringify(e));Ve.l(\"\".concat(t)),new Aa(\"pushedCommercialConfig\").setNetworkType(this._getModule(Hn).getNetworkType()).setMessage(\"purchaseBits:\".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:\"_parseConfig\",value:function(e){var t=\"\".concat(this._n,\"._parseConfig\"),n=e.errorCode,o=e.errorMessage,s=e.purchaseBits,a=e.expiredTime;0===n?(this._purchasedFeatureHandler.parsePurchaseBits(s),this._expiredTime=Date.now()+1e3*a):it(n)?(Ve.l(\"\".concat(t,\" failed. Invalid message format:\"),e),this._setExpiredTimeOnResponseError(36e5)):(Ve.e(\"\".concat(t,\" errorCode:\").concat(n,\" errorMessage:\").concat(o)),this._setExpiredTimeOnResponseError(12e4))}},{key:\"_setExpiredTimeOnResponseError\",value:function(e){this._expiredTime=Date.now()+e}},{key:\"canIUse\",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:\"isFeatureEnabled\",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:\"_getModule\",value:function(e){return this._m.getModule(e)}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),e}(),iu=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._m=e,s._n=\"OfflinePushModule\",s._offlinePushPlugin=void 0,s._androidPushConfig={huaweiPushBussinessId:\"\",xiaomiPushBussinessId:\"\",xiaomiPushAppId:\"\",xiaomiPushAppKey:\"\",meizuPushBussinessId:\"\",meizuPushAppId:\"\",meizuPushAppKey:\"\",vivoPushBussinessId:\"\",fcmPushBussinessId:\"\",oppoPushBussinessId:\"\",oppoPushAppKey:\"\",oppoPushAppSecret:\"\",honorPushBussinessId:\"\"},s._deviceToken=\"\",s._businessID=0,s._iosBusinessID=0,s._c2cUnreadCount=0,s._groupUnreadCount=0,s._isWebUniapp=0,s}return a(n,[{key:\"registerPlugin\",value:function(e){if(oe){this._offlinePushPlugin=e[\"tim-offline-push-plugin\"];var t=e.offlinePushConfig||{},n=t.huaweiBusinessID,o=t.xiaomiBusinessID,s=t.xiaomiAppID,a=t.xiaomiAppKey,i=t.meizuBusinessID,r=t.meizuAppID,u=t.meizuAppKey,c=t.vivoBusinessID,l=t.oppoBusinessID,d=t.oppoAppKey,p=t.oppoAppSecret,g=t.honorBusinessID,h=t.iosBusinessID;this._androidPushConfig.huaweiPushBussinessId=n,this._androidPushConfig.xiaomiPushBussinessId=o,this._androidPushConfig.xiaomiPushAppId=s,this._androidPushConfig.xiaomiPushAppKey=a,this._androidPushConfig.meizuPushBussinessId=i,this._androidPushConfig.meizuPushAppId=r,this._androidPushConfig.meizuPushAppKey=u,this._androidPushConfig.vivoPushBussinessId=c,this._androidPushConfig.oppoPushBussinessId=l,this._androidPushConfig.oppoPushAppKey=d,this._androidPushConfig.oppoPushAppSecret=p,this._androidPushConfig.honorPushBussinessId=g,new Aa(\"registerPlugin\").setMessage(\"tim-offline-push-plugin\").setMoreMessage(\"isExist:\".concat(!it(this._offlinePushPlugin))).end(!0),Ve.l(\"\".concat(this._n,\".\").concat(\"registerPlugin\",\" ok. offlinePushConfig:\").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=h,this._setAppShowListener()}else this.outputWarning(\"OfflinePushInUniapp\")}},{key:\"init\",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:\"_getDeviceToken\",value:function(){var e=this,t=\"\".concat(this._n,\".\").concat(\"_getDeviceToken\");if(ut(this._offlinePushPlugin.getDeviceToken)){var n=\"androidPushConfig:\".concat(JSON.stringify(this._androidPushConfig),\", iosBusinessID:\").concat(this._iosBusinessID);Ve.l(\"\".concat(t,\" start. \").concat(n)),new Aa(\"_getDeviceToken\").setMessage(\"\".concat(n)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,(function(o){var s=new Aa(\"getDeviceTokenRes\"),a=o.code,i=o.msg;if(0===a){var r=o.data,u=r.deviceToken,c=r.deviceBrand,l=r.deviceType,d=r.bussinessId;e._deviceToken=u,e._businessID=d||e._iosBusinessID,n=\"deviceToken:\".concat(u,\", deviceBrand:\").concat(c||l,\", businessID:\").concat(e._businessID),Ve.l(\"\".concat(t,\" ok. \").concat(n)),s.setMessage(n).end(!0),e._setToken()}else s.setMessage(\"code:\".concat(a,\", msg:\").concat(i)).end(!0),Ve.e(\"\".concat(t,\" failed. error:\"),o)}))}else Ve.e(\"\".concat(t,\" getDeviceToken is not a function\"))}},{key:\"canIUseOfflinePush\",value:function(){return oe&&!it(this._offlinePushPlugin)}},{key:\"_setAppShowListener\",value:function(){var e=this,t=\"\".concat(this._n,\".\").concat(\"_setAppShowListener\");it(this._offlinePushPlugin)?Ve.e(\"\".concat(t,\" offlinePushPlugin is undefined\")):ut(this._offlinePushPlugin.setAppShowListener)?(new Aa(\"_setAppShowListener\").end(!0),Ve.l(\"\".concat(t,\" start\")),this._offlinePushPlugin.setAppShowListener((function(n){var o=(n||{}).appShow;new Aa(\"setAppShowListenerRes\").setMessage(\"appShow:\".concat(o)).end(!0),Ve.l(\"\".concat(t,\" ok. appShow:\").concat(o)),e._m.isReady()&&(0===o?(e._getConvUnreadCount(),e._onBackground()):1===o&&e._onForeground())}))):Ve.e(\"\".concat(t,\" setAppShowListener is not a function\"))}},{key:\"getDeviceBrand\",value:function(){if(!it(this._offlinePushPlugin)&&ut(this._offlinePushPlugin.getDeviceType)){var e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType;return Ve.l(\"\".concat(this._n,\".getDeviceBrand ok. deviceType:\").concat(e)),e}}},{key:\"_setToken\",value:function(){var e,t=this,n=\"\".concat(this._n,\"._setToken\"),o=this.getModule(xn),s=1,a=\"\",i=\"\";zt(this._deviceToken)&&(s=0);var r=this.getUniAppPlatform(),u=this.getDeviceBrand();r===R.IOS||r===R.IPAD||r===R.MAC?i=this._deviceToken:r===R.ANDROID&&(a=this._deviceToken);var c=new Aa(\"offlinePushSetToken\");return e=\"deviceToken:\".concat(i||a,\", businessID:\").concat(this._businessID,\", \")+\"deviceBrand:\".concat(u,\", isWebUniapp:\").concat(this._isWebUniapp,\", pushMsg:\").concat(s,\", platform:\").concat(r),c.setMessage(\"\".concat(e)),Ve.l(\"\".concat(n,\" \").concat(e)),this.request({protocolName:da,requestData:{tokenID:a,pushMsg:s,sdkAppID:o.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:u,deviceToken:i,isWebUniapp:this._isWebUniapp}}).then((function(e){return c.end(),Ve.l(\"\".concat(n,\" ok\")),e})).catch((function(e){return t.probeNetwork().then((function(t){var n=v(t,2),o=n[0],s=n[1];c.setError(e,o,s).end()})),Ve.e(\"\".concat(n,\" failed. error:\"),e),Za(e)}))}},{key:\"_getConvUnreadCount\",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.getModule(qn).getLocalConversationList().forEach((function(t){t.type===E.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===E.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:\"_onBackground\",value:function(){var e=this,t=\"\".concat(this._n,\".\").concat(\"_onBackground\"),n=new Aa(\"_onBackground\");this.request({protocolName:ca,requestData:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(o){return n.setMessage(\"c2cUnreadCount: \".concat(e._c2cUnreadCount,\", groupUnreadCount: \").concat(e._groupUnreadCount)).end(),Ve.l(\"\".concat(t,\" ok\")),o})).catch((function(o){e.probeNetwork().then((function(e){var t=v(e,2),s=t[0],a=t[1];n.setError(o,s,a).end()})),Ve.e(\"\".concat(t,\" failed. error:\"),o)}))}},{key:\"_onForeground\",value:function(){var e=this,t=\"\".concat(this._n,\".\").concat(\"_onForeground\"),n=new Aa(\"_onForeground\");this.request({protocolName:la,requestData:{isWebUniapp:this._isWebUniapp}}).then((function(e){return n.end(),Ve.l(\"\".concat(t,\" ok\")),e})).catch((function(o){e.probeNetwork().then((function(e){var t=v(e,2),s=t[0],a=t[1];n.setError(o,s,a).end()})),Ve.e(\"\".concat(t,\" failed. error:\"),o)}))}},{key:\"getUniAppPlatform\",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return\"ios\"===e?R.IOS:\"android\"===e?R.ANDROID:1002===t?R.IPAD:1001===t?R.MAC:void 0}},{key:\"reset\",value:function(){this._deviceToken=\"\",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Ve.l(\"\".concat(this._n,\".reset\"))}}]),n}(uo),ru=function(e){r(n,e);var t=f(n);function n(e){var s;return o(this,n),(s=t.call(this,e))._n=\"ProfanityFilterModule\",s._plugin=null,s._filterConfigMap=new Map,s._startIndex=0,s._version=0,s._canIUseLexicon=!1,s._isFetching=!1,s._expiredTime=0,s}return a(n,[{key:\"init\",value:function(){var e=this.getModule(Yn).getPlugin(\"tim-profanity-filter-plugin\");e?(this._plugin=new e({logger:Ve,isArray:at,isMap:Qe,isDevMode:this.isDevMode()}),this._getLexicon()):this.outputWarning(\"ProfanityPluginNotFound\")}},{key:\"onCheckTimer\",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:\"filterMessage\",value:function(e,t){var n=!0;if(!this._plugin||!this._canIUseLexicon)return n;if(t&&t.messageControlInfo&&!0===t.messageControlInfo.excludedFromContentModeration)return n;var o=e.type,s=e.conversationType;if(o!==E.MSG_TEXT&&o!==E.MSG_CUSTOM)return n;var a,i=\"\".concat(this._n,\".filterMessage\");if(Ve.l(\"\".concat(i)),o===E.MSG_TEXT){if(s===E.CONV_C2C?a=H:s===E.CONV_GROUP&&(a=W),!this._isConfigOn(a))return n;var r=this._plugin.filter(e.payload.text),u=r.type,c=r.modifiedText;1===u?n=!1:2===u&&(e.payload.text=c)}else if(o===E.MSG_CUSTOM){if(s===E.CONV_C2C?a=K:s===E.CONV_GROUP&&(a=Y),!this._isConfigOn(a))return n;var l=this._plugin.filter(e.payload.data),d=this._plugin.filter(e.payload.description),p=this._plugin.filter(e.payload.extension);1===l.type||1===d.type||1===p.type?n=!1:(2===l.type&&(e.payload.data=l.modifiedText),2===d.type&&(e.payload.description=d.modifiedText),2===p.type&&(e.payload.extension=p.modifiedText))}return Ve.l(\"\".concat(i,\" done. isAllowedToSend:\").concat(n)),n}},{key:\"filterText\",value:function(e,t){var n=\"\".concat(this._n,\".filterText\"),o={isAllowedToSend:!0,modifiedText:e};if(!this._plugin||!this._canIUseLexicon)return o;if(!this._isConfigOn(t))return o;Ve.l(\"\".concat(n));var s=this._plugin.filter(e),a=s.type,i=s.modifiedText;return 1===a?o.isAllowedToSend=!1:2===a&&(o.modifiedText=i),Ve.l(\"\".concat(n,\" done. ret:\"),o),o}},{key:\"_getLexicon\",value:function(){var e=this,t=new Aa(\"profanityFilter\"),n=\"\".concat(this._n,\"._getLexicon\");this._isFetching=!0,this.request({protocolName:pa,requestData:{startIndex:this._startIndex,version:this._version}}).then((function(o){var s=o.data,a=s.errorInfo,i=s.filterConfig,r=s.lexicon,u=s.strToken,c=s.completeFlag,l=s.nextStartIndex,d=s.version,p=s.expiredTime,g=a.errorCode,h=a.errorMessage;return 0!==g?(e._isFetching=!1,Ve.w(\"\".concat(n,\" failed. error:\"),a),void t.setCode(g).setMessage(h).end()):(e._onFilterConfig(i),e._getToken(u),1===c?(Ve.l(\"\".concat(n,\" done. version:\").concat(d,\" expiredTime:\").concat(p)),e._version=d,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*p,void e._plugin.onLexiconCompleted(r)):(e._startIndex=l,e._plugin.onLexiconSliced(r),void e._getLexicon()))})).catch((function(o){e.probeNetwork().then((function(e){var n=v(e,2),s=n[0],a=n[1];t.setError(o,s,a).end()})),e._isFetching=!1,Ve.l(\"\".concat(n,\" failed. error:\"),o)}))}},{key:\"_onFilterConfig\",value:function(e){var t=this;zt(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach((function(n){t._filterConfigMap.set(n,e[n])})),Ve.l(\"\".concat(this._n,\"._onFilterConfig. keys:\").concat(Array.from(this._filterConfigMap.keys()),\" values:\").concat(Array.from(this._filterConfigMap.values()))))}},{key:\"_isConfigOn\",value:function(e){return 1===this._filterConfigMap.get(e)}},{key:\"_getToken\",value:function(e){if(nt(e)){var t=e.length,n=\"\";if(t%2==0)for(var o=0;o<=t-1;o+=2)n+=e[o+1],n+=e[o];else{for(var s=0;s<t-1;s+=2)n+=e[s+1],n+=e[s];n+=e[t-1]}this._plugin.onToken(n)}}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),n}(uo),uu=function(){function e(t){o(this,e),this._m=t,this._n=\"TransCmdModule\",this._TRTCCommandList=[\"tui_room_svr.*\"],this._m.getInnerEmitterInstance().on(ti,this._onCloudConfigUpdated,this)}return a(e,[{key:\"_onCloudConfigUpdated\",value:function(){var e=this,t=this._m.getModule(Zn).getCloudConfig(\"rtc_cmd\");it(t)||(t=JSON.parse(t)).forEach((function(t){e._TRTCCommandList.includes(t)||e._TRTCCommandList.push(t)}))}},{key:\"sendTRTCCustomData\",value:function(e){var t=e.serviceCommand,n=e.data,o=\"\".concat(V.NAME.TUIROOM_SVR,\".*\");return it(t)||(o=t),this._TRTCCommandList.includes(o)?this._trans({servcmd:o,data:n}):Za({code:ha.INVALID_TRTC_CMD})}},{key:\"_trans\",value:function(e){Ve.d(\"\".concat(this._n,\"._trans. options:\").concat(JSON.stringify(e)));var t=e.servcmd,n=e.data;return this._m.getModule(zn).trans({servcmd:t,data:nt(n)?JSON.parse(n):n})}},{key:\"getCommandList\",value:function(){return this._TRTCCommandList}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\"))}}]),e}(),cu=function(){function e(t){o(this,e),this._m=t,this._n=\"ErrorMessageModule\",this.TIM_ERROR_ASSISTANCE=\"tim_error_assistance\",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}return a(e,[{key:\"_init\",value:function(){var e=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(e){var t;try{t=JSON.parse(e)}catch(n){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),Ve.w(\"\".concat(this._n,\"._init error:\"),n)}t&&(this._needToUpdate(t)?this._fetch():this._fillMap(t.message))}else this._fetch()}},{key:\"_needToUpdate\",value:function(e){var t=e.localSavedTime,n=e.localSavedVersion,o=t&&(new Date).getTime()-t>=this.STORAGE_EXPIRES_TIME,s=!n||\"2.27.6\"!==n;return Ve.l(\"\".concat(this._n,\"._needToUpdate isTimeout:\").concat(o,\" isDifferentVersion:\").concat(s)),o||s}},{key:\"_fetch\",value:function(){if(!this._m.getModule(xn).isPrivateNetWork()){var e=\"https://web.sdk.qcloud.com/im/download/error-message/0.0.1/tim-error-message.txt\",t=\"application/x-www-form-urlencoded;charset=UTF-8\",n=\"\".concat(this._n,\"._fetch ok in\"),o=this;if(ae)re.request({url:e,method:\"GET\",timeout:3e3,header:{\"content-type\":t},dataType:\"text\",success:function(e){o._fillAndSave(e.data),Ve.l(\"\".concat(n,\" mini program\"))},fail:function(){}});else{var s=new XMLHttpRequest,a=setTimeout((function(){s.abort()}),3e3);s.onreadystatechange=function(){4===s.readyState&&(clearTimeout(a),200!==s.status&&304!==s.status||(Ve.l(\"\".concat(n,\" browser\")),o._fillAndSave(s.responseText)))},s.open(\"GET\",e,!0),s.setRequestHeader(\"Content-type\",t),s.send()}}}},{key:\"_fillAndSave\",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:(new Date).getTime(),localSavedVersion:\"2.27.6\"}),!0,!1)}},{key:\"_getStorageModule\",value:function(){return this._m.getModule(Vn)}},{key:\"_fillMap\",value:function(e){this._map.clear();for(var t,n,o,s=e.split(\";\\n\"),a=s.length,i=new RegExp(/'/g),r=0;r<a;r++)if(t=s[r].indexOf(\":\"),n=s[r].slice(0,t),o=s[r].slice(t+1,s[r].length),!n.startsWith(\"//\")){if(it(o))continue;this._map.set(n,o.replace(i,\"\"))}}},{key:\"get\",value:function(e){var t=e.isIntl,n=e.key,o=e.replacement1,s=e.replacement2,a=\"\".concat(n,t?\"_en\":\"_cn\");!this._map.has(a)&&this._map.has(n)&&(a=n);var i=\"\";return this._map.has(a)?(i=this._map.get(a),it(o)||(i=i.replace(\"$replacement1\",o)),it(s)||(i=i.replace(\"$replacement2\",s)),i):i}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\"))}}]),e}(),lu=cr((function(e,t){var o=\"undefined\"!=typeof Uint8Array&&\"undefined\"!=typeof Uint16Array&&\"undefined\"!=typeof Int32Array;function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var o=t.shift();if(o){if(\"object\"!==n(o))throw new TypeError(o+\"must be non-object\");for(var a in o)s(o,a)&&(e[a]=o[a])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,n,o,s){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+o),s);else for(var a=0;a<o;a++)e[s+a]=t[n+a]},flattenChunks:function(e){var t,n,o,s,a,i;for(o=0,t=0,n=e.length;t<n;t++)o+=e[t].length;for(i=new Uint8Array(o),s=0,t=0,n=e.length;t<n;t++)a=e[t],i.set(a,s),s+=a.length;return i}},i={arraySet:function(e,t,n,o,s){for(var a=0;a<o;a++)e[s+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(o)}));lu.assign,lu.shrinkBuf,lu.setTyped,lu.Buf8,lu.Buf16,lu.Buf32;var du=function(e,t,n,o){for(var s=65535&e|0,a=e>>>16&65535|0,i=0;0!==n;){n-=i=n>2e3?2e3:n;do{a=a+(s=s+t[o++]|0)|0}while(--i);s%=65521,a%=65521}return s|a<<16|0};var pu=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();var gu=function(e,t,n,o){var s=pu,a=o+n;e^=-1;for(var i=o;i<a;i++)e=e>>>8^s[255&(e^t[i])];return-1^e},hu=function(e,t){var n,o,s,a,i,r,u,c,l,d,p,g,h,_,f,v,m,M,y,I,C,T,D,k,E;n=e.state,o=e.next_in,k=e.input,s=o+(e.avail_in-5),a=e.next_out,E=e.output,i=a-(t-e.avail_out),r=a+(e.avail_out-257),u=n.dmax,c=n.wsize,l=n.whave,d=n.wnext,p=n.window,g=n.hold,h=n.bits,_=n.lencode,f=n.distcode,v=(1<<n.lenbits)-1,m=(1<<n.distbits)-1;e:do{h<15&&(g+=k[o++]<<h,h+=8,g+=k[o++]<<h,h+=8),M=_[g&v];t:for(;;){if(g>>>=y=M>>>24,h-=y,0===(y=M>>>16&255))E[a++]=65535&M;else{if(!(16&y)){if(0==(64&y)){M=_[(65535&M)+(g&(1<<y)-1)];continue t}if(32&y){n.mode=12;break e}e.msg=\"invalid literal/length code\",n.mode=30;break e}I=65535&M,(y&=15)&&(h<y&&(g+=k[o++]<<h,h+=8),I+=g&(1<<y)-1,g>>>=y,h-=y),h<15&&(g+=k[o++]<<h,h+=8,g+=k[o++]<<h,h+=8),M=f[g&m];n:for(;;){if(g>>>=y=M>>>24,h-=y,!(16&(y=M>>>16&255))){if(0==(64&y)){M=f[(65535&M)+(g&(1<<y)-1)];continue n}e.msg=\"invalid distance code\",n.mode=30;break e}if(C=65535&M,h<(y&=15)&&(g+=k[o++]<<h,(h+=8)<y&&(g+=k[o++]<<h,h+=8)),(C+=g&(1<<y)-1)>u){e.msg=\"invalid distance too far back\",n.mode=30;break e}if(g>>>=y,h-=y,C>(y=a-i)){if((y=C-y)>l&&n.sane){e.msg=\"invalid distance too far back\",n.mode=30;break e}if(T=0,D=p,0===d){if(T+=c-y,y<I){I-=y;do{E[a++]=p[T++]}while(--y);T=a-C,D=E}}else if(d<y){if(T+=c+d-y,(y-=d)<I){I-=y;do{E[a++]=p[T++]}while(--y);if(T=0,d<I){I-=y=d;do{E[a++]=p[T++]}while(--y);T=a-C,D=E}}}else if(T+=d-y,y<I){I-=y;do{E[a++]=p[T++]}while(--y);T=a-C,D=E}for(;I>2;)E[a++]=D[T++],E[a++]=D[T++],E[a++]=D[T++],I-=3;I&&(E[a++]=D[T++],I>1&&(E[a++]=D[T++]))}else{T=a-C;do{E[a++]=E[T++],E[a++]=E[T++],E[a++]=E[T++],I-=3}while(I>2);I&&(E[a++]=E[T++],I>1&&(E[a++]=E[T++]))}break}}break}}while(o<s&&a<r);o-=I=h>>3,g&=(1<<(h-=I<<3))-1,e.next_in=o,e.next_out=a,e.avail_in=o<s?s-o+5:5-(o-s),e.avail_out=a<r?r-a+257:257-(a-r),n.hold=g,n.bits=h},_u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],fu=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],vu=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],mu=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Mu=function(e,t,n,o,s,a,i,r){var u,c,l,d,p,g,h,_,f,v=r.bits,m=0,M=0,y=0,I=0,C=0,T=0,D=0,k=0,E=0,S=0,L=null,A=0,R=new lu.Buf16(16),N=new lu.Buf16(16),O=null,G=0;for(m=0;m<=15;m++)R[m]=0;for(M=0;M<o;M++)R[t[n+M]]++;for(C=v,I=15;I>=1&&0===R[I];I--);if(C>I&&(C=I),0===I)return s[a++]=20971520,s[a++]=20971520,r.bits=1,0;for(y=1;y<I&&0===R[y];y++);for(C<y&&(C=y),k=1,m=1;m<=15;m++)if(k<<=1,(k-=R[m])<0)return-1;if(k>0&&(0===e||1!==I))return-1;for(N[1]=0,m=1;m<15;m++)N[m+1]=N[m]+R[m];for(M=0;M<o;M++)0!==t[n+M]&&(i[N[t[n+M]]++]=M);if(0===e?(L=O=i,g=19):1===e?(L=_u,A-=257,O=fu,G-=257,g=256):(L=vu,O=mu,g=-1),S=0,M=0,m=y,p=a,T=C,D=0,l=-1,d=(E=1<<C)-1,1===e&&E>852||2===e&&E>592)return 1;for(;;){h=m-D,i[M]<g?(_=0,f=i[M]):i[M]>g?(_=O[G+i[M]],f=L[A+i[M]]):(_=96,f=0),u=1<<m-D,y=c=1<<T;do{s[p+(S>>D)+(c-=u)]=h<<24|_<<16|f|0}while(0!==c);for(u=1<<m-1;S&u;)u>>=1;if(0!==u?(S&=u-1,S+=u):S=0,M++,0==--R[m]){if(m===I)break;m=t[n+i[M]]}if(m>C&&(S&d)!==l){for(0===D&&(D=C),p+=y,k=1<<(T=m-D);T+D<I&&!((k-=R[T+D])<=0);)T++,k<<=1;if(E+=1<<T,1===e&&E>852||2===e&&E>592)return 1;s[l=S&d]=C<<24|T<<16|p-a|0}}return 0!==S&&(s[p+S]=m-D<<24|64<<16|0),r.bits=C,0};function yu(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Iu(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new lu.Buf16(320),this.work=new lu.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Cu(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=\"\",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new lu.Buf32(852),t.distcode=t.distdyn=new lu.Buf32(592),t.sane=1,t.back=-1,0):-2}function Tu(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,Cu(e)):-2}function Du(e,t){var n,o;return e&&e.state?(o=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==o.window&&o.wbits!==t&&(o.window=null),o.wrap=n,o.wbits=t,Tu(e))):-2}function ku(e,t){var n,o;return e?(o=new Iu,e.state=o,o.window=null,0!==(n=Du(e,t))&&(e.state=null),n):-2}var Eu,Su,Lu=!0;function Au(e){if(Lu){var t;for(Eu=new lu.Buf32(512),Su=new lu.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Mu(1,e.lens,0,288,Eu,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Mu(2,e.lens,0,32,Su,0,e.work,{bits:5}),Lu=!1}e.lencode=Eu,e.lenbits=9,e.distcode=Su,e.distbits=5}function Ru(e,t,n,o){var s,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new lu.Buf8(a.wsize)),o>=a.wsize?(lu.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((s=a.wsize-a.wnext)>o&&(s=o),lu.arraySet(a.window,t,n-o,s,a.wnext),(o-=s)?(lu.arraySet(a.window,t,n-o,o,0),a.wnext=o,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}var Nu={inflateReset:Tu,inflateReset2:Du,inflateResetKeep:Cu,inflateInit:function(e){return ku(e,15)},inflateInit2:ku,inflate:function(e,t){var n,o,s,a,i,r,u,c,l,d,p,g,h,_,f,v,m,M,y,I,C,T,D,k,E=0,S=new lu.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),i=e.next_out,s=e.output,u=e.avail_out,a=e.next_in,o=e.input,r=e.avail_in,c=n.hold,l=n.bits,d=r,p=u,T=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;l<16;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(2&n.wrap&&35615===c){n.check=0,S[0]=255&c,S[1]=c>>>8&255,n.check=gu(n.check,S,2,0),c=0,l=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg=\"incorrect header check\",n.mode=30;break}if(8!=(15&c)){e.msg=\"unknown compression method\",n.mode=30;break}if(l-=4,C=8+(15&(c>>>=4)),0===n.wbits)n.wbits=C;else if(C>n.wbits){e.msg=\"invalid window size\",n.mode=30;break}n.dmax=1<<C,e.adler=n.check=1,n.mode=512&c?10:12,c=0,l=0;break;case 2:for(;l<16;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(n.flags=c,8!=(255&n.flags)){e.msg=\"unknown compression method\",n.mode=30;break}if(57344&n.flags){e.msg=\"unknown header flags set\",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(S[0]=255&c,S[1]=c>>>8&255,n.check=gu(n.check,S,2,0)),c=0,l=0,n.mode=3;case 3:for(;l<32;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&(S[0]=255&c,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,n.check=gu(n.check,S,4,0)),c=0,l=0,n.mode=4;case 4:for(;l<16;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(S[0]=255&c,S[1]=c>>>8&255,n.check=gu(n.check,S,2,0)),c=0,l=0,n.mode=5;case 5:if(1024&n.flags){for(;l<16;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(S[0]=255&c,S[1]=c>>>8&255,n.check=gu(n.check,S,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((g=n.length)>r&&(g=r),g&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),lu.arraySet(n.head.extra,o,a,g,C)),512&n.flags&&(n.check=gu(n.check,o,g,a)),r-=g,a+=g,n.length-=g),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===r)break e;g=0;do{C=o[a+g++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&g<r);if(512&n.flags&&(n.check=gu(n.check,o,g,a)),r-=g,a+=g,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===r)break e;g=0;do{C=o[a+g++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&g<r);if(512&n.flags&&(n.check=gu(n.check,o,g,a)),r-=g,a+=g,C)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;l<16;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(c!==(65535&n.check)){e.msg=\"header crc mismatch\",n.mode=30;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;l<32;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}e.adler=n.check=yu(c),c=0,l=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=i,e.avail_out=u,e.next_in=a,e.avail_in=r,n.hold=c,n.bits=l,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){c>>>=7&l,l-=7&l,n.mode=27;break}for(;l<3;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}switch(n.last=1&c,l-=1,3&(c>>>=1)){case 0:n.mode=14;break;case 1:if(Au(n),n.mode=20,6===t){c>>>=2,l-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg=\"invalid block type\",n.mode=30}c>>>=2,l-=2;break;case 14:for(c>>>=7&l,l-=7&l;l<32;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg=\"invalid stored block lengths\",n.mode=30;break}if(n.length=65535&c,c=0,l=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(g=n.length){if(g>r&&(g=r),g>u&&(g=u),0===g)break e;lu.arraySet(s,o,a,g,i),r-=g,a+=g,u-=g,i+=g,n.length-=g;break}n.mode=12;break;case 17:for(;l<14;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg=\"too many length or distance symbols\",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;l<3;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}n.lens[L[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[L[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},T=Mu(0,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,T){e.msg=\"invalid code lengths set\",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(E=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,m=65535&E,!((f=E>>>24)<=l);){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(m<16)c>>>=f,l-=f,n.lens[n.have++]=m;else{if(16===m){for(k=f+2;l<k;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(c>>>=f,l-=f,0===n.have){e.msg=\"invalid bit length repeat\",n.mode=30;break}C=n.lens[n.have-1],g=3+(3&c),c>>>=2,l-=2}else if(17===m){for(k=f+3;l<k;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}l-=f,C=0,g=3+(7&(c>>>=f)),c>>>=3,l-=3}else{for(k=f+7;l<k;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}l-=f,C=0,g=11+(127&(c>>>=f)),c>>>=7,l-=7}if(n.have+g>n.nlen+n.ndist){e.msg=\"invalid bit length repeat\",n.mode=30;break}for(;g--;)n.lens[n.have++]=C}}if(30===n.mode)break;if(0===n.lens[256]){e.msg=\"invalid code -- missing end-of-block\",n.mode=30;break}if(n.lenbits=9,D={bits:n.lenbits},T=Mu(1,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,T){e.msg=\"invalid literal/lengths set\",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},T=Mu(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,T){e.msg=\"invalid distances set\",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(r>=6&&u>=258){e.next_out=i,e.avail_out=u,e.next_in=a,e.avail_in=r,n.hold=c,n.bits=l,hu(e,p),i=e.next_out,s=e.output,u=e.avail_out,a=e.next_in,o=e.input,r=e.avail_in,c=n.hold,l=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;v=(E=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,m=65535&E,!((f=E>>>24)<=l);){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(v&&0==(240&v)){for(M=f,y=v,I=m;v=(E=n.lencode[I+((c&(1<<M+y)-1)>>M)])>>>16&255,m=65535&E,!(M+(f=E>>>24)<=l);){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}c>>>=M,l-=M,n.back+=M}if(c>>>=f,l-=f,n.back+=f,n.length=m,0===v){n.mode=26;break}if(32&v){n.back=-1,n.mode=12;break}if(64&v){e.msg=\"invalid literal/length code\",n.mode=30;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(k=n.extra;l<k;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(E=n.distcode[c&(1<<n.distbits)-1])>>>16&255,m=65535&E,!((f=E>>>24)<=l);){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(0==(240&v)){for(M=f,y=v,I=m;v=(E=n.distcode[I+((c&(1<<M+y)-1)>>M)])>>>16&255,m=65535&E,!(M+(f=E>>>24)<=l);){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}c>>>=M,l-=M,n.back+=M}if(c>>>=f,l-=f,n.back+=f,64&v){e.msg=\"invalid distance code\",n.mode=30;break}n.offset=m,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(k=n.extra;l<k;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg=\"invalid distance too far back\",n.mode=30;break}n.mode=25;case 25:if(0===u)break e;if(g=p-u,n.offset>g){if((g=n.offset-g)>n.whave&&n.sane){e.msg=\"invalid distance too far back\",n.mode=30;break}g>n.wnext?(g-=n.wnext,h=n.wsize-g):h=n.wnext-g,g>n.length&&(g=n.length),_=n.window}else _=s,h=i-n.offset,g=n.length;g>u&&(g=u),u-=g,n.length-=g;do{s[i++]=_[h++]}while(--g);0===n.length&&(n.mode=21);break;case 26:if(0===u)break e;s[i++]=n.length,u--,n.mode=21;break;case 27:if(n.wrap){for(;l<32;){if(0===r)break e;r--,c|=o[a++]<<l,l+=8}if(p-=u,e.total_out+=p,n.total+=p,p&&(e.adler=n.check=n.flags?gu(n.check,s,p,i-p):du(n.check,s,p,i-p)),p=u,(n.flags?c:yu(c))!==n.check){e.msg=\"incorrect data check\",n.mode=30;break}c=0,l=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;l<32;){if(0===r)break e;r--,c+=o[a++]<<l,l+=8}if(c!==(4294967295&n.total)){e.msg=\"incorrect length check\",n.mode=30;break}c=0,l=0}n.mode=29;case 29:T=1;break e;case 30:T=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=i,e.avail_out=u,e.next_in=a,e.avail_in=r,n.hold=c,n.bits=l,(n.wsize||p!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&Ru(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&&p&&(e.adler=n.check=n.flags?gu(n.check,s,p,e.next_out-p):du(n.check,s,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===p||4===t)&&0===T&&(T=-5),T},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var n,o=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&du(1,t,o,0)!==n.check?-3:Ru(e,t,o,o)?(n.mode=31,-4):(n.havedict=1,0):-2},inflateInfo:\"pako inflate (from Nodeca project)\"},Ou=!0,Gu=!0;try{String.fromCharCode.apply(null,[0])}catch(ac){Ou=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(ac){Gu=!1}for(var Uu=new lu.Buf8(256),Pu=0;Pu<256;Pu++)Uu[Pu]=Pu>=252?6:Pu>=248?5:Pu>=240?4:Pu>=224?3:Pu>=192?2:1;Uu[254]=Uu[254]=1;function bu(e,t){if(t<65534&&(e.subarray&&Gu||!e.subarray&&Ou))return String.fromCharCode.apply(null,lu.shrinkBuf(e,t));for(var n=\"\",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}var wu=function(e){var t,n,o,s,a,i=e.length,r=0;for(s=0;s<i;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<i&&56320==(64512&(o=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(o-56320),s++),r+=n<128?1:n<2048?2:n<65536?3:4;for(t=new lu.Buf8(r),a=0,s=0;a<r;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<i&&56320==(64512&(o=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(o-56320),s++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},Fu=function(e){for(var t=new lu.Buf8(e.length),n=0,o=t.length;n<o;n++)t[n]=e.charCodeAt(n);return t},qu=function(e,t){var n,o,s,a,i=t||e.length,r=new Array(2*i);for(o=0,n=0;n<i;)if((s=e[n++])<128)r[o++]=s;else if((a=Uu[s])>4)r[o++]=65533,n+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&n<i;)s=s<<6|63&e[n++],a--;a>1?r[o++]=65533:s<65536?r[o++]=s:(s-=65536,r[o++]=55296|s>>10&1023,r[o++]=56320|1023&s)}return bu(r,o)},xu=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Uu[e[n]]>t?n:t},Vu={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Bu={2:\"need dictionary\",1:\"stream end\",0:\"\",\"-1\":\"file error\",\"-2\":\"stream error\",\"-3\":\"data error\",\"-4\":\"insufficient memory\",\"-5\":\"buffer error\",\"-6\":\"incompatible version\"};var Hu=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=\"\",this.state=null,this.data_type=2,this.adler=0};var Ku=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=\"\",this.comment=\"\",this.hcrc=0,this.done=!1},Wu=Object.prototype.toString;function Yu(e){if(!(this instanceof Yu))return new Yu(e);this.options=lu.assign({chunkSize:16384,windowBits:0,to:\"\"},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg=\"\",this.ended=!1,this.chunks=[],this.strm=new Hu,this.strm.avail_out=0;var n=Nu.inflateInit2(this.strm,t.windowBits);if(n!==Vu.Z_OK)throw new Error(Bu[n]);if(this.header=new Ku,Nu.inflateGetHeader(this.strm,this.header),t.dictionary&&(\"string\"==typeof t.dictionary?t.dictionary=wu(t.dictionary):\"[object ArrayBuffer]\"===Wu.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Nu.inflateSetDictionary(this.strm,t.dictionary))!==Vu.Z_OK))throw new Error(Bu[n])}function ju(e,t){var n=new Yu(t);if(n.push(e,!0),n.err)throw n.msg||Bu[n.err];return n.result}Yu.prototype.push=function(e,t){var n,o,s,a,i,r=this.strm,u=this.options.chunkSize,c=this.options.dictionary,l=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?Vu.Z_FINISH:Vu.Z_NO_FLUSH,\"string\"==typeof e?r.input=Fu(e):\"[object ArrayBuffer]\"===Wu.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new lu.Buf8(u),r.next_out=0,r.avail_out=u),(n=Nu.inflate(r,Vu.Z_NO_FLUSH))===Vu.Z_NEED_DICT&&c&&(n=Nu.inflateSetDictionary(this.strm,c)),n===Vu.Z_BUF_ERROR&&!0===l&&(n=Vu.Z_OK,l=!1),n!==Vu.Z_STREAM_END&&n!==Vu.Z_OK)return this.onEnd(n),this.ended=!0,!1;r.next_out&&(0!==r.avail_out&&n!==Vu.Z_STREAM_END&&(0!==r.avail_in||o!==Vu.Z_FINISH&&o!==Vu.Z_SYNC_FLUSH)||(\"string\"===this.options.to?(s=xu(r.output,r.next_out),a=r.next_out-s,i=qu(r.output,s),r.next_out=a,r.avail_out=u-a,a&&lu.arraySet(r.output,r.output,s,a,0),this.onData(i)):this.onData(lu.shrinkBuf(r.output,r.next_out)))),0===r.avail_in&&0===r.avail_out&&(l=!0)}while((r.avail_in>0||0===r.avail_out)&&n!==Vu.Z_STREAM_END);return n===Vu.Z_STREAM_END&&(o=Vu.Z_FINISH),o===Vu.Z_FINISH?(n=Nu.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Vu.Z_OK):o!==Vu.Z_SYNC_FLUSH||(this.onEnd(Vu.Z_OK),r.avail_out=0,!0)},Yu.prototype.onData=function(e){this.chunks.push(e)},Yu.prototype.onEnd=function(e){e===Vu.Z_OK&&(\"string\"===this.options.to?this.result=this.chunks.join(\"\"):this.result=lu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var zu={Inflate:Yu,inflate:ju,inflateRaw:function(e,t){return(t=t||{}).raw=!0,ju(e,t)},ungzip:ju},Ju={};(0,lu.assign)(Ju,zu,Vu);var Xu=Ju,Zu=function(){function e(t){o(this,e),this._m=t,this._n=\"InflateModule\",this._bLogForInflateOK=!1,this._bLogForInflateError=!1}return a(e,[{key:\"inflate\",value:function(e){var t,n=new Uint8Array(e).slice(4),o=Date.now();try{t=Xu.inflate(n,{to:\"string\"}),this._bLogForInflateOK||(this._bLogForInflateOK=!0,new Aa(\"inflateOK\").end())}catch(i){if(this._bLogForInflateError)return;return this._bLogForInflateError=!0,void new Aa(\"inflateError\").setMessage(i).end()}var s=n.length+4,a=t.length;return Ve.d(\"inflate ok. zipped:\".concat(s,\" unzipped:\").concat(a)+\" compression ratio:\".concat(Math.round(100*(a-s)/a),\"% cost:\").concat(Date.now()-o)),t}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),this._bLogForInflateOK=!1,this._bLogForInflateError=!1}}]),e}(),Qu=function(){function e(t){o(this,e);var n=new Aa(\"sdkConstruct\");this._n=\"ModuleManager\",this._isReady=!1,this._reason=ha.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._moduleMap=new Map,this._innerEmitter=null,this._outerEmitter=null,this._checkCount=0,this._checkTimer=-1,this._moduleMap.set(xn,new Qi(this,t)),this._moduleMap.set(ro,new Zu(this)),this._moduleMap.set(to,new au(this)),this._moduleMap.set(Zn,new Xr(this)),this._moduleMap.set(Qn,new ou(this)),this._moduleMap.set(eo,new nu(this)),this._moduleMap.set(Jn,new Vr(this)),this._moduleMap.set(zn,new zr(this)),this._moduleMap.set(Rn,new $i(this)),this._moduleMap.set(Nn,new Mr(this)),this._moduleMap.set(On,new yr(this)),this._moduleMap.set(ao,new Ir(this)),this._moduleMap.set(Gn,new Zi(this)),this._moduleMap.set(Un,new Qa(this)),this._moduleMap.set(qn,new Mi(this)),this._moduleMap.set(Pn,new qi(this)),this._moduleMap.set(wn,new Vi(this)),this._moduleMap.set(Fn,new Wi(this)),this._moduleMap.set(Vn,new tr(this)),this._moduleMap.set(io,new cu(this)),this._moduleMap.set(Bn,new sr(this)),this._moduleMap.set(Hn,new ur(this)),this._moduleMap.set(Kn,new dr(this)),this._moduleMap.set(Wn,new gr(this)),this._moduleMap.set(Yn,new Cr(this)),this._moduleMap.set(jn,new Tr(this)),this._moduleMap.set(Xn,new Jr(this)),this._moduleMap.set($n,new Zr(this)),this._moduleMap.set(no,new iu(this)),this._moduleMap.set(oo,new ru(this)),this._moduleMap.set(so,new uu(this)),this._eventThrottleMap=new Map;var s=t.instanceID,a=t.oversea,i=t.SDKAppID,r=\"instanceID:\".concat(s,\" SDKAppID:\").concat(i,\" host:\").concat(Ot(),\" oversea:\").concat(a,\" inBrowser:\").concat(ie,\" inMiniApp:\").concat(ae)+\" canIUseInflate:\".concat(this.canIUseInflate())+\" workerAvailable:\".concat(Se,\" UserAgent:\").concat(ue);Aa.bindEventStatModule(this._moduleMap.get(Bn)),n.setMessage(\"\".concat(r,\" \").concat(function(){var e=\"\";if(ae)try{var t=re.getSystemInfoSync(),n=t.model,o=t.version,s=t.system,a=t.platform,i=t.SDKVersion;e=\"model:\".concat(n,\" version:\").concat(o,\" system:\").concat(s,\" platform:\").concat(a,\" SDKVersion:\").concat(i)}catch(r){e=\"\"}return e}())).end(),Ve.i(\"SDK \".concat(r)),ja.prototype._getErrorMessage=this.getErrorMessage.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}return a(e,[{key:\"_startTimer\",value:function(){var e=this._moduleMap.get(Qn),t=e.isWorkerEnabled();Ve.l(\"\".concat(this._n,\".startTimer isWorkerEnabled:\").concat(t,\" seed:\").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:\"_startMainThreadTimer\",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),Ve.l(\"\".concat(this._n,\"._startMainThreadTimer seed:\").concat(this._checkTimer))}},{key:\"stopTimer\",value:function(){var e=this._moduleMap.get(Qn),t=e.isWorkerEnabled();Ve.l(\"\".concat(this._n,\".stopTimer isWorkerEnabled:\").concat(t,\" seed:\").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:\"_stopMainThreadTimer\",value:function(){Ve.l(\"\".concat(this._n,\"._stopMainThreadTimer\")),this._checkTimer>0&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:\"_stopMainThreadSocket\",value:function(){Ve.l(\"\".concat(this._n,\"._stopMainThreadSocket\"));var e=this._moduleMap.get(Jn);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:\"_startMainThreadSocket\",value:function(){Ve.l(\"\".concat(this._n,\"._startMainThreadSocket\"));var e=this._moduleMap.get(Jn);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:\"onWorkerTimerEnabled\",value:function(){Ve.l(\"\".concat(this._n,\".onWorkerTimerEnabled, disable main thread timer and socket\")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:\"onWorkerTimerDisabled\",value:function(){Ve.l(\"\".concat(this._n,\".onWorkerTimerDisabled, enable main thread timer and socket\")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:\"onCheckTimer\",value:function(){this._checkCount+=1;var e,t=D(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(o){t.e(o)}finally{t.f()}}},{key:\"_initReadyList\",value:function(){var e=this;this._readyList=[this._moduleMap.get(Rn),this._moduleMap.get(qn)],this._readyList.forEach((function(t){t.ready((function(){return e._onModuleReady()}))}))}},{key:\"_onModuleReady\",value:function(){var e=!0;if(this._readyList.forEach((function(t){t.isReady()||(e=!1)})),e&&!this._isReady){this._isReady=!0,this._outerEmitter.emit(k.SDK_READY);var t=Date.now()-this._startLoginTs;Ve.w(\"SDK is ready. cost \".concat(t,\" ms\")),this._startLoginTs=Date.now();var n=this._moduleMap.get(Hn).getNetworkType(),o=this._ssoLogForReady.getStartTs()+Ue;this._ssoLogForReady.setNetworkType(n).setMessage(t).start(o).end()}}},{key:\"login\",value:function(){0===this._startLoginTs&&(be(),this._startLoginTs=Date.now(),this._startTimer(),this._moduleMap.get(Hn).start(),this._ssoLogForReady=new Aa(\"sdkReady\"),this._reason=ha.LOGGING_IN)}},{key:\"onLoginFailed\",value:function(){this._startLoginTs=0}},{key:\"getOuterEmitterInstance\",value:function(){return null===this._outerEmitter&&(this._outerEmitter=new lr,Ja(this._outerEmitter),this._outerEmitter._emit=this._outerEmitter.emit,this._outerEmitter.emit=function(e,t){var n=this;if(e===k.CONVERSATION_LIST_UPDATED||e===k.FRIEND_LIST_UPDATED||e===k.GROUP_LIST_UPDATED||e===k.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED)if(this._eventThrottleMap.has(e)){var o=Date.now(),s=this._eventThrottleMap.get(e);o-s.last<=1e3?(s.timeoutID&&clearTimeout(s.timeoutID),s.timeoutID=setTimeout((function(){s.last=Date.now(),n._outerEmitter._emit.apply(n._outerEmitter,[e,{name:e,data:n._getEventData(e)}])}),1e3)):(s.last=o,this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]))}else this._eventThrottleMap.set(e,{last:Date.now(),timeoutID:-1}),this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]);else this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:arguments[1]}])}.bind(this)),this._outerEmitter}},{key:\"_getEventData\",value:function(e){return e===k.CONVERSATION_LIST_UPDATED?this._moduleMap.get(qn).getLocalConversationList():e===k.FRIEND_LIST_UPDATED?this._moduleMap.get(bn).getLocalFriendList(!1):e===k.GROUP_LIST_UPDATED?this._moduleMap.get(Pn).getLocalGroupList():e===k.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._moduleMap.get(qn).getTotalUnreadMessageCount():void 0}},{key:\"getInnerEmitterInstance\",value:function(){return null===this._innerEmitter&&(this._innerEmitter=new lr,this._innerEmitter._emit=this._innerEmitter.emit,this._innerEmitter.emit=function(e,t){var n;n=st(arguments[1])&&arguments[1].data?[e,{name:arguments[0],data:arguments[1].data}]:[e,{name:arguments[0],data:arguments[1]}],this._innerEmitter._emit.apply(this._innerEmitter,n)}.bind(this)),this._innerEmitter}},{key:\"hasModule\",value:function(e){return this._moduleMap.has(e)}},{key:\"getModule\",value:function(e){return this._moduleMap.get(e)}},{key:\"canIUseInflate\",value:function(){return!!this._moduleMap.get(ro)}},{key:\"isReady\",value:function(){return this._isReady}},{key:\"isIntl\",value:function(){return this.getModule(xn).isIntl()}},{key:\"getNotReadyReason\",value:function(){return this._reason}},{key:\"setNotReadyReason\",value:function(e){this._reason=e}},{key:\"getErrorMessage\",value:function(e,t,n){return this._moduleMap.get(io).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:\"outputWarning\",value:function(e,t,n){var o=this.getErrorMessage(e,t,n);o&&Ve.w(o)}},{key:\"onError\",value:function(e){var t=\"code:\".concat(e.code,\" message:\").concat(e.message);Ve.w(\"Oops! \".concat(t)),new Aa(\"error\").setMessage(t).setNetworkType(this.getModule(Hn).getNetworkType()).setLevel(\"error\").end(),this.getOuterEmitterInstance().emit(k.ERROR,e)}},{key:\"restartTimer\",value:function(){Ve.l(\"\".concat(this._n,\".restartTimer\")),this.stopTimer(),this._startTimer(),this.getModule(Pn).restartPolling()}},{key:\"getTimerID\",value:function(){var e=this._moduleMap.get(Qn);return e.isWorkerEnabled()?e.getTimerID():this._checkTimer}},{key:\"getPollingTimerID\",value:function(e){return this._moduleMap.get(Pn).getPollingTimerID(e)}},{key:\"reset\",value:function(){Ve.l(\"\".concat(this._n,\".reset\")),be();var e,t=D(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=v(e.value,2)[1];n.reset&&n.reset()}}catch(i){t.e(i)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._outerEmitter.emit(k.SDK_NOT_READY);var o,s=D(this._eventThrottleMap);try{for(s.s();!(o=s.n()).done;){var a=v(o.value,2)[1];a.timeoutID&&clearTimeout(a.timeoutID)}}catch(i){s.e(i)}finally{s.f()}this._eventThrottleMap.clear()}}]),e}(),$u=function(){function e(t){o(this,e),this._funcMap=new Map,this._m=t}return a(e,[{key:\"defense\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(\"string\"!=typeof e)return null;if(0===e.length)return null;if(\"function\"!=typeof t)return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var o=null;return this._funcMap.get(e).has(t)?o=this._funcMap.get(e).get(t):(o=this._pack(e,t,n),this._funcMap.get(e).set(t,o)),o}},{key:\"defenseOnce\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return\"function\"!=typeof t?null:this._pack(e,t,n)}},{key:\"find\",value:function(e,t){return\"string\"!=typeof e||0===e.length||\"function\"!=typeof t?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.outputWarning(\"ListenerFnNotFound\",e),null)}},{key:\"delete\",value:function(e,t){return\"function\"==typeof t&&(!!this._funcMap.has(e)&&(!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),0===this._funcMap.get(e).size&&this._funcMap.delete(e),!0)))}},{key:\"_pack\",value:function(e,t,n){var o=this;return function(){try{t.apply(n,Array.from(arguments))}catch(u){var s=Object.values(k).indexOf(e),a=\"CallbackError\";if(-1!==s){var i=Object.keys(k)[s];o._m.outputWarning(a,i,u)}var r=new Aa(a);r.setMessage(\"eventName:\".concat(e)).setMoreMessage(u.message).end()}}}}]),e}(),ec=function(){function e(t){o(this,e);var n={SDKAppID:t.SDKAppID,unlimitedAVChatRoom:t.unlimitedAVChatRoom||!1,scene:t.scene||\"\",oversea:t.oversea||!1,instanceID:Nt(),devMode:t.devMode||!1,proxyServer:t.proxyServer||void 0,fileUploadProxy:t.fileUploadProxy||void 0,fileDownloadProxy:t.fileDownloadProxy||t.fileUploadProxy||void 0};this._m=new Qu(n),this._safetyCallbackFactory=new $u(this._m)}return a(e,[{key:\"onError\",value:function(e){this._m.onError(e)}},{key:\"login\",value:function(e){return this._m.login(),this._getModule(Rn).login(e)}},{key:\"logout\",value:function(){var e=this;return this._getModule(Rn).logout().then((function(t){return e._m.reset(),t}))}},{key:\"isReady\",value:function(){return this._m.isReady()}},{key:\"isIntl\",value:function(){return this._m.isIntl()}},{key:\"getNotReadyReason\",value:function(){return this._m.getNotReadyReason()}},{key:\"getErrorMessage\",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:\"_getModule\",value:function(e){return this._m.getModule(e)}},{key:\"destroy\",value:function(){var e=this;return this.logout().finally((function(){e._m.stopTimer(),e._getModule(Qn).terminate(),e._getModule(Jn).dealloc();var t=e._m.getOuterEmitterInstance(),n=e._getModule(xn);t.emit(k.SDK_DESTROY,{SDKAppID:n.getSDKAppID()})}))}},{key:\"on\",value:function(e,t,n){Ve.d(\"on\",\"eventName:\".concat(e)),this._m.getOuterEmitterInstance().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:\"once\",value:function(e,t,n){Ve.d(\"once\",\"eventName:\".concat(e)),this._m.getOuterEmitterInstance().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:\"off\",value:function(e,t,n,o){Ve.d(\"off\",\"eventName:\".concat(e));var s=this._safetyCallbackFactory.find(e,t);null!==s&&(this._m.getOuterEmitterInstance().off(e,s,n,o),this._safetyCallbackFactory.delete(e,t))}},{key:\"registerPlugin\",value:function(e){it(e[\"tim-offline-push-plugin\"])?this._getModule(Yn).registerPlugin(e):this._getModule(no).registerPlugin(e)}},{key:\"setLogLevel\",value:function(e){if(e<=0){var t=this.getErrorMessage(\"TIM_ASCII_ART\");t&&console.log(t);var n=this.getErrorMessage(\"API_REFER\");if(n){Kt()?console.log(\"%c \".concat(\"IM SDK API ->\",\" %c\"),\"background:#ff9d00; padding:1px; border-radius:3px; color: #fff\",\"background:transparent\",n):console.log(\"IM SDK API ->\",n)}var o=this.getErrorMessage(\"DOCS_GUIDE\");o&&console.log(o)}Ve.setLevel(e)}},{key:\"createTextMessage\",value:function(e){return this._getModule(Nn).createTextMessage(e)}},{key:\"createTextAtMessage\",value:function(e){return this._getModule(Nn).createTextMessage(e)}},{key:\"createImageMessage\",value:function(e){return this._getModule(Nn).createImageMessage(e)}},{key:\"createAudioMessage\",value:function(e){return this._getModule(Nn).createAudioMessage(e)}},{key:\"createVideoMessage\",value:function(e){return this._getModule(Nn).createVideoMessage(e)}},{key:\"createCustomMessage\",value:function(e){return this._getModule(Nn).createCustomMessage(e)}},{key:\"createFaceMessage\",value:function(e){return this._getModule(Nn).createFaceMessage(e)}},{key:\"createFileMessage\",value:function(e){return this._getModule(Nn).createFileMessage(e)}},{key:\"createLocationMessage\",value:function(e){return this._getModule(Nn).createLocationMessage(e)}},{key:\"createMergerMessage\",value:function(e){return this._getModule(Nn).createMergerMessage(e)}},{key:\"downloadMergerMessage\",value:function(e){return e.type!==E.MSG_MERGER?Za({code:ha.MESSAGE_MERGER_TYPE_INVALID}):zt(e.payload.downloadKey)?Za({code:ha.MESSAGE_MERGER_KEY_INVALID}):this._getModule(Nn).downloadMergerMessage(e).catch((function(e){return Za({code:ha.MESSAGE_MERGER_DOWNLOAD_FAIL})}))}},{key:\"createForwardMessage\",value:function(e){return this._getModule(Nn).createForwardMessage(e)}},{key:\"sendMessage\",value:function(e,t){return e instanceof Wa?this._getModule(Nn).sendMessageInstance(e,t):Za({code:ha.MESSAGE_SEND_NEED_MESSAGE_INSTANCE})}},{key:\"callExperimentalAPI\",value:function(e,t){return\"sendComboMessage\"===e?this._getModule(ao).sendMessage(t):\"handleGroupInvitation\"===e?this._getModule(Pn).handleGroupInvitation(t):\"isCommercialAbilityEnabled\"===e?this._getModule(to).isFeatureEnabled(t):\"isIntl\"===e?this.isIntl():\"sendTRTCCustomData\"===e?this._getModule(so).sendTRTCCustomData(t):\"getTimerID\"===e?this._m.getTimerID():\"getPollingTimerID\"===e?this._m.getPollingTimerID(t):Za({code:ha.INVALID_OPERATION})}},{key:\"revokeMessage\",value:function(e){return this._getModule(Nn).revokeMessage(e)}},{key:\"resendMessage\",value:function(e){return this._getModule(Nn).resendMessage(e)}},{key:\"deleteMessage\",value:function(e){return this._getModule(Nn).deleteMessage(e)}},{key:\"translateText\",value:function(e){return this._getModule(Nn).translateText(e)}},{key:\"setMessageExtensions\",value:function(e,t){return this._getModule(On).setMessageExtensions(e,t)}},{key:\"getMessageExtensions\",value:function(e){return this._getModule(On).getMessageExtensions(e)}},{key:\"deleteMessageExtensions\",value:function(e,t){return this._getModule(On).deleteMessageExtensions(e,t)}},{key:\"modifyMessage\",value:function(e){return this._getModule(Nn).modifyRemoteMessage(e)}},{key:\"getMessageList\",value:function(e){return this._getModule(qn).getMessageList(e)}},{key:\"getMessageListHopping\",value:function(e){return this._getModule(qn).getMessageListHopping(e)}},{key:\"sendMessageReadReceipt\",value:function(e){return this._getModule(qn).sendReadReceipt(e)}},{key:\"getMessageReadReceiptList\",value:function(e){return this._getModule(qn).getReadReceiptList(e)}},{key:\"getGroupMessageReadMemberList\",value:function(e){return this._getModule(Pn).getReadReceiptDetail(e)}},{key:\"findMessage\",value:function(e){return this._getModule(qn).findMessage(e)}},{key:\"setMessageRead\",value:function(e){return this._getModule(qn).setMessageRead(e)}},{key:\"getConversationList\",value:function(e){return this._getModule(qn).getConversationList(e)}},{key:\"getConversationProfile\",value:function(e){return this._getModule(qn).getConversationProfile(e)}},{key:\"deleteConversation\",value:function(e){return this._getModule(qn).deleteConversation(e)}},{key:\"clearHistoryMessage\",value:function(e){return this._getModule(qn).clearHistoryMessage(e)}},{key:\"pinConversation\",value:function(e){return this._getModule(qn).pinConversation(e)}},{key:\"setAllMessageRead\",value:function(e){return this._getModule(qn).setAllMessageRead(e)}},{key:\"setMessageRemindType\",value:function(e){return this._getModule(qn).setMessageRemindType(e)}},{key:\"getTotalUnreadMessageCount\",value:function(){return this._getModule(qn).getTotalUnreadMessageCount()}},{key:\"setConversationCustomData\",value:function(e){return this._getModule(qn).setConversationCustomData(e)}},{key:\"markConversation\",value:function(e){return this._getModule(qn).markConversation(e)}},{key:\"getConversationGroupList\",value:function(){return this._getModule(qn).getConversationGroupList()}},{key:\"createConversationGroup\",value:function(e){return this._getModule(qn).createConversationGroup(e)}},{key:\"deleteConversationGroup\",value:function(e){return this._getModule(qn).deleteConversationGroup(e)}},{key:\"renameConversationGroup\",value:function(e){return this._getModule(qn).renameConversationGroup(e)}},{key:\"addConversationsToGroup\",value:function(e){return this._getModule(qn).addConversationsToGroup(e)}},{key:\"deleteConversationsFromGroup\",value:function(e){return this._getModule(qn).deleteConversationsFromGroup(e)}},{key:\"getMyProfile\",value:function(){return this._getModule(Gn).getMyProfile()}},{key:\"getUserProfile\",value:function(e){return this._getModule(Gn).getUserProfile(e)}},{key:\"updateMyProfile\",value:function(e){return this._getModule(Gn).updateMyProfile(e)}},{key:\"getBlacklist\",value:function(){return this._getModule(Gn).getLocalBlacklist()}},{key:\"addToBlacklist\",value:function(e){return this._getModule(Gn).addBlacklist(e)}},{key:\"removeFromBlacklist\",value:function(e){return this._getModule(Gn).deleteBlacklist(e)}},{key:\"setSelfStatus\",value:function(e){return this._getModule(Gn).setSelfStatus(e)}},{key:\"getUserStatus\",value:function(e){return this._getModule(Gn).getUserStatus(e)}},{key:\"subscribeUserStatus\",value:function(e){return this._getModule(Gn).subscribeUserStatus(e)}},{key:\"unsubscribeUserStatus\",value:function(e){return this._getModule(Gn).unsubscribeUserStatus(e)}},{key:\"getFriendList\",value:function(){var e=this._getModule(bn);return e?e.getLocalFriendList():Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"addFriend\",value:function(e){var t=this._getModule(bn);return t?t.addFriend(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"deleteFriend\",value:function(e){var t=this._getModule(bn);return t?t.deleteFriend(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"checkFriend\",value:function(e){var t=this._getModule(bn);return t?t.checkFriend(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"getFriendProfile\",value:function(e){var t=this._getModule(bn);return t?t.getFriendProfile(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"updateFriend\",value:function(e){var t=this._getModule(bn);return t?t.updateFriend(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"getFriendApplicationList\",value:function(){var e=this._getModule(bn);return e?e.getLocalFriendApplicationList():Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"acceptFriendApplication\",value:function(e){var t=this._getModule(bn);return t?t.acceptFriendApplication(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"refuseFriendApplication\",value:function(e){var t=this._getModule(bn);return t?t.refuseFriendApplication(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"deleteFriendApplication\",value:function(e){var t=this._getModule(bn);return t?t.deleteFriendApplication(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"setFriendApplicationRead\",value:function(){var e=this._getModule(bn);return e?e.setFriendApplicationRead():Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"getFriendGroupList\",value:function(){var e=this._getModule(bn);return e?e.getLocalFriendGroupList():Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"createFriendGroup\",value:function(e){var t=this._getModule(bn);return t?t.createFriendGroup(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"deleteFriendGroup\",value:function(e){var t=this._getModule(bn);return t?t.deleteFriendGroup(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"addToFriendGroup\",value:function(e){var t=this._getModule(bn);return t?t.addToFriendGroup(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"removeFromFriendGroup\",value:function(e){var t=this._getModule(bn);return t?t.removeFromFriendGroup(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"renameFriendGroup\",value:function(e){var t=this._getModule(bn);return t?t.renameFriendGroup(e):Za({code:ha.CANNOT_FIND_MODULE})}},{key:\"getGroupList\",value:function(e){return this._getModule(Pn).getGroupList(e)}},{key:\"getGroupProfile\",value:function(e){return this._getModule(Pn).getGroupProfile(e)}},{key:\"createGroup\",value:function(e){return this._getModule(Pn).createGroup(e)}},{key:\"dismissGroup\",value:function(e){return this._getModule(Pn).dismissGroup(e)}},{key:\"updateGroupProfile\",value:function(e){return this._getModule(Pn).updateGroupProfile(e)}},{key:\"joinGroup\",value:function(e){return this._getModule(Pn).joinGroup(e)}},{key:\"quitGroup\",value:function(e){return this._getModule(Pn).quitGroup(e)}},{key:\"searchGroupByID\",value:function(e){return this._getModule(Pn).searchGroupByID(e)}},{key:\"getGroupOnlineMemberCount\",value:function(e){return this._getModule(Pn).getGroupOnlineMemberCount(e)}},{key:\"changeGroupOwner\",value:function(e){return this._getModule(Pn).changeGroupOwner(e)}},{key:\"getGroupApplicationList\",value:function(){return this._getModule(Pn).getGroupApplicationList()}},{key:\"handleGroupApplication\",value:function(e){return this._getModule(Pn).handleGroupApplication(e)}},{key:\"initGroupAttributes\",value:function(e){return this._getModule(Pn).initGroupAttributes(e)}},{key:\"setGroupAttributes\",value:function(e){return this._getModule(Pn).setGroupAttributes(e)}},{key:\"deleteGroupAttributes\",value:function(e){return this._getModule(Pn).deleteGroupAttributes(e)}},{key:\"getGroupAttributes\",value:function(e){return this._getModule(Pn).getGroupAttributes(e)}},{key:\"setGroupCounters\",value:function(e){return this._getModule(Pn).setGroupCounters(e)}},{key:\"increaseGroupCounter\",value:function(e){return this._getModule(Pn).increaseGroupCounter(e)}},{key:\"decreaseGroupCounter\",value:function(e){return this._getModule(Pn).decreaseGroupCounter(e)}},{key:\"getGroupCounters\",value:function(e){return this._getModule(Pn).getGroupCounters(e)}},{key:\"getGroupMemberList\",value:function(e){return this._getModule(wn).getGroupMemberList(e)}},{key:\"getGroupMemberProfile\",value:function(e){return this._getModule(wn).getGroupMemberProfile(e)}},{key:\"addGroupMember\",value:function(e){return this._getModule(wn).addGroupMember(e)}},{key:\"deleteGroupMember\",value:function(e){return this._getModule(wn).deleteGroupMember(e)}},{key:\"setGroupMemberMuteTime\",value:function(e){return this._getModule(wn).setGroupMemberMuteTime(e)}},{key:\"setGroupMemberRole\",value:function(e){return this._getModule(wn).setGroupMemberRole(e)}},{key:\"setGroupMemberNameCard\",value:function(e){return this._getModule(wn).setGroupMemberNameCard(e)}},{key:\"setGroupMemberCustomField\",value:function(e){return this._getModule(wn).setGroupMemberCustomField(e)}},{key:\"markGroupMemberList\",value:function(e){return this._getModule(wn).markGroupMemberList(e)}},{key:\"getJoinedCommunityList\",value:function(){return this._getModule(Fn).getJoinedCommunityList()}},{key:\"createTopicInCommunity\",value:function(e){return this._getModule(Fn).createTopicInCommunity(e)}},{key:\"deleteTopicFromCommunity\",value:function(e){return this._getModule(Fn).deleteTopicFromCommunity(e)}},{key:\"updateTopicProfile\",value:function(e){return this._getModule(Fn).updateTopicProfile(e)}},{key:\"getTopicList\",value:function(e){return this._getModule(Fn).getTopicList(e)}}]),e}(),tc={login:1,logout:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1};function nc(e,t){if(e.isReady()||1===tc[t])return!0;var n=e.getNotReadyReason(),o={code:n,message:\"\".concat(e.getErrorMessage(n),\" | \").concat(t,\" | \").concat(e.getErrorMessage(ha.SDK_IS_NOT_READY))};return e.onError(o),o}var oc={},sc={};return sc.create=function(e){var n=0,o=e.SDKAppID;if(et(o))n=o;else if(n=parseInt(o),isNaN(o))return Ve.e(\"\".concat(\"TIM.create\",\" failed. Failed to parse the SDKAppID, please check the arguments\")),null;if(n&&oc[n])return oc[n];Ve.l(\"\".concat(\"TIM.create\"));var s=new ec(t(t({},e),{},{SDKAppID:n}));s.on(k.SDK_DESTROY,(function(e){oc[e.data.SDKAppID]=null,delete oc[e.data.SDKAppID]}));var a=function(e){var t=Object.create(null);return Object.keys(An).forEach((function(n){if(e[n]){var o=new S;t[n]=function(){var t=Array.from(arguments);return o.use((function(t,o){var s=nc(e,n);return!0===s?o():Za(s)})).use((function(e,t){if(!0===Jt(e,Ln[n],n))return t()})).use((function(t,o){return e[n].apply(e,t)})),o.run(t)}}})),t}(s);return oc[n]=a,Ln.hookGetAPITips(s.getErrorMessage.bind(s)),Ve.l(\"\".concat(\"TIM.create\",\" ok\")),a},sc.TYPES=E,sc.EVENT=k,sc.VERSION=\"2.27.6\",Ve.l(\"TIM.VERSION:\".concat(sc.VERSION)),sc}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdGltLWpzLXNkay90aW0tanMuanMiLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdGltLWpzLXNkay90aW0tanMuanM/ZTIzZSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7IWZ1bmN0aW9uKGUsdCl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9dCgpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUodCk6KGU9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbFRoaXM/Z2xvYmFsVGhpczplfHxzZWxmKS5USU09dCgpfSh0aGlzLChmdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXt2YXIgbj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihvPW8uZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLG4ucHVzaC5hcHBseShuLG8pfXJldHVybiBufWZ1bmN0aW9uIHQodCl7Zm9yKHZhciBuPTE7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl7dmFyIG89bnVsbCE9YXJndW1lbnRzW25dP2FyZ3VtZW50c1tuXTp7fTtuJTI/ZShPYmplY3QobyksITApLmZvckVhY2goKGZ1bmN0aW9uKGUpe2kodCxlLG9bZV0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobykpOmUoT2JqZWN0KG8pKS5mb3JFYWNoKChmdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobyxlKSl9KSl9cmV0dXJuIHR9ZnVuY3Rpb24gbihlKXtyZXR1cm4obj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlwic3ltYm9sXCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24oZSl7cmV0dXJuIHR5cGVvZiBlfTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZlLmNvbnN0cnVjdG9yPT09U3ltYm9sJiZlIT09U3ltYm9sLnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiBlfSkoZSl9ZnVuY3Rpb24gbyhlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9ZnVuY3Rpb24gcyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgbz10W25dO28uZW51bWVyYWJsZT1vLmVudW1lcmFibGV8fCExLG8uY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIG8mJihvLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxvLmtleSxvKX19ZnVuY3Rpb24gYShlLHQsbil7cmV0dXJuIHQmJnMoZS5wcm90b3R5cGUsdCksbiYmcyhlLG4pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFwicHJvdG90eXBlXCIse3dyaXRhYmxlOiExfSksZX1mdW5jdGlvbiBpKGUsdCxuKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOm4sZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPW4sZX1mdW5jdGlvbiByKGUsdCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodCYmdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTplLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcInByb3RvdHlwZVwiLHt3cml0YWJsZTohMX0pLHQmJmMoZSx0KX1mdW5jdGlvbiB1KGUpe3JldHVybih1PU9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3QuZ2V0UHJvdG90eXBlT2Y6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSl9KShlKX1mdW5jdGlvbiBjKGUsdCl7cmV0dXJuKGM9T2JqZWN0LnNldFByb3RvdHlwZU9mfHxmdW5jdGlvbihlLHQpe3JldHVybiBlLl9fcHJvdG9fXz10LGV9KShlLHQpfWZ1bmN0aW9uIGwoKXtpZihcInVuZGVmaW5lZFwiPT10eXBlb2YgUmVmbGVjdHx8IVJlZmxlY3QuY29uc3RydWN0KXJldHVybiExO2lmKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pcmV0dXJuITE7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgUHJveHkpcmV0dXJuITA7dHJ5e3JldHVybiBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbixbXSwoZnVuY3Rpb24oKXt9KSkpLCEwfWNhdGNoKGUpe3JldHVybiExfX1mdW5jdGlvbiBkKGUsdCxuKXtyZXR1cm4oZD1sKCk/UmVmbGVjdC5jb25zdHJ1Y3Q6ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPVtudWxsXTtvLnB1c2guYXBwbHkobyx0KTt2YXIgcz1uZXcoRnVuY3Rpb24uYmluZC5hcHBseShlLG8pKTtyZXR1cm4gbiYmYyhzLG4ucHJvdG90eXBlKSxzfSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfWZ1bmN0aW9uIHAoZSl7dmFyIHQ9XCJmdW5jdGlvblwiPT10eXBlb2YgTWFwP25ldyBNYXA6dm9pZCAwO3JldHVybihwPWZ1bmN0aW9uKGUpe2lmKG51bGw9PT1lfHwobj1lLC0xPT09RnVuY3Rpb24udG9TdHJpbmcuY2FsbChuKS5pbmRleE9mKFwiW25hdGl2ZSBjb2RlXVwiKSkpcmV0dXJuIGU7dmFyIG47aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7aWYodm9pZCAwIT09dCl7aWYodC5oYXMoZSkpcmV0dXJuIHQuZ2V0KGUpO3Quc2V0KGUsbyl9ZnVuY3Rpb24gbygpe3JldHVybiBkKGUsYXJndW1lbnRzLHUodGhpcykuY29uc3RydWN0b3IpfXJldHVybiBvLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6byxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSxjKG8sZSl9KShlKX1mdW5jdGlvbiBnKGUsdCl7aWYobnVsbD09ZSlyZXR1cm57fTt2YXIgbixvLHM9ZnVuY3Rpb24oZSx0KXtpZihudWxsPT1lKXJldHVybnt9O3ZhciBuLG8scz17fSxhPU9iamVjdC5rZXlzKGUpO2ZvcihvPTA7bzxhLmxlbmd0aDtvKyspbj1hW29dLHQuaW5kZXhPZihuKT49MHx8KHNbbl09ZVtuXSk7cmV0dXJuIHN9KGUsdCk7aWYoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIGE9T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtmb3Iobz0wO288YS5sZW5ndGg7bysrKW49YVtvXSx0LmluZGV4T2Yobik+PTB8fE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG4pJiYoc1tuXT1lW25dKX1yZXR1cm4gc31mdW5jdGlvbiBoKGUpe2lmKHZvaWQgMD09PWUpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO3JldHVybiBlfWZ1bmN0aW9uIF8oZSx0KXtpZih0JiYoXCJvYmplY3RcIj09dHlwZW9mIHR8fFwiZnVuY3Rpb25cIj09dHlwZW9mIHQpKXJldHVybiB0O2lmKHZvaWQgMCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkRlcml2ZWQgY29uc3RydWN0b3JzIG1heSBvbmx5IHJldHVybiBvYmplY3Qgb3IgdW5kZWZpbmVkXCIpO3JldHVybiBoKGUpfWZ1bmN0aW9uIGYoZSl7dmFyIHQ9bCgpO3JldHVybiBmdW5jdGlvbigpe3ZhciBuLG89dShlKTtpZih0KXt2YXIgcz11KHRoaXMpLmNvbnN0cnVjdG9yO249UmVmbGVjdC5jb25zdHJ1Y3Qobyxhcmd1bWVudHMscyl9ZWxzZSBuPW8uYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBfKHRoaXMsbil9fWZ1bmN0aW9uIHYoZSx0KXtyZXR1cm4gTShlKXx8ZnVuY3Rpb24oZSx0KXt2YXIgbj1udWxsPT1lP251bGw6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmZVtTeW1ib2wuaXRlcmF0b3JdfHxlW1wiQEBpdGVyYXRvclwiXTtpZihudWxsPT1uKXJldHVybjt2YXIgbyxzLGE9W10saT0hMCxyPSExO3RyeXtmb3Iobj1uLmNhbGwoZSk7IShpPShvPW4ubmV4dCgpKS5kb25lKSYmKGEucHVzaChvLnZhbHVlKSwhdHx8YS5sZW5ndGghPT10KTtpPSEwKTt9Y2F0Y2godSl7cj0hMCxzPXV9ZmluYWxseXt0cnl7aXx8bnVsbD09bi5yZXR1cm58fG4ucmV0dXJuKCl9ZmluYWxseXtpZihyKXRocm93IHN9fXJldHVybiBhfShlLHQpfHxJKGUsdCl8fFQoKX1mdW5jdGlvbiBtKGUpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBDKGUpfShlKXx8eShlKXx8SShlKXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKX0oKX1mdW5jdGlvbiBNKGUpe2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGV9ZnVuY3Rpb24geShlKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgU3ltYm9sJiZudWxsIT1lW1N5bWJvbC5pdGVyYXRvcl18fG51bGwhPWVbXCJAQGl0ZXJhdG9yXCJdKXJldHVybiBBcnJheS5mcm9tKGUpfWZ1bmN0aW9uIEkoZSx0KXtpZihlKXtpZihcInN0cmluZ1wiPT10eXBlb2YgZSlyZXR1cm4gQyhlLHQpO3ZhciBuPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKS5zbGljZSg4LC0xKTtyZXR1cm5cIk9iamVjdFwiPT09biYmZS5jb25zdHJ1Y3RvciYmKG49ZS5jb25zdHJ1Y3Rvci5uYW1lKSxcIk1hcFwiPT09bnx8XCJTZXRcIj09PW4/QXJyYXkuZnJvbShlKTpcIkFyZ3VtZW50c1wiPT09bnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qobik/QyhlLHQpOnZvaWQgMH19ZnVuY3Rpb24gQyhlLHQpeyhudWxsPT10fHx0PmUubGVuZ3RoKSYmKHQ9ZS5sZW5ndGgpO2Zvcih2YXIgbj0wLG89bmV3IEFycmF5KHQpO248dDtuKyspb1tuXT1lW25dO3JldHVybiBvfWZ1bmN0aW9uIFQoKXt0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpfWZ1bmN0aW9uIEQoZSx0KXt2YXIgbj1cInVuZGVmaW5lZFwiIT10eXBlb2YgU3ltYm9sJiZlW1N5bWJvbC5pdGVyYXRvcl18fGVbXCJAQGl0ZXJhdG9yXCJdO2lmKCFuKXtpZihBcnJheS5pc0FycmF5KGUpfHwobj1JKGUpKXx8dCYmZSYmXCJudW1iZXJcIj09dHlwZW9mIGUubGVuZ3RoKXtuJiYoZT1uKTt2YXIgbz0wLHM9ZnVuY3Rpb24oKXt9O3JldHVybntzOnMsbjpmdW5jdGlvbigpe3JldHVybiBvPj1lLmxlbmd0aD97ZG9uZTohMH06e2RvbmU6ITEsdmFsdWU6ZVtvKytdfX0sZTpmdW5jdGlvbihlKXt0aHJvdyBlfSxmOnN9fXRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKX12YXIgYSxpPSEwLHI9ITE7cmV0dXJue3M6ZnVuY3Rpb24oKXtuPW4uY2FsbChlKX0sbjpmdW5jdGlvbigpe3ZhciBlPW4ubmV4dCgpO3JldHVybiBpPWUuZG9uZSxlfSxlOmZ1bmN0aW9uKGUpe3I9ITAsYT1lfSxmOmZ1bmN0aW9uKCl7dHJ5e2l8fG51bGw9PW4ucmV0dXJufHxuLnJldHVybigpfWZpbmFsbHl7aWYocil0aHJvdyBhfX19fXZhciBrPXtTREtfUkVBRFk6XCJzZGtTdGF0ZVJlYWR5XCIsU0RLX05PVF9SRUFEWTpcInNka1N0YXRlTm90UmVhZHlcIixTREtfREVTVFJPWTpcInNka0Rlc3Ryb3lcIixNRVNTQUdFX1JFQ0VJVkVEOlwib25NZXNzYWdlUmVjZWl2ZWRcIixNRVNTQUdFX01PRElGSUVEOlwib25NZXNzYWdlTW9kaWZpZWRcIixNRVNTQUdFX1JFVk9LRUQ6XCJvbk1lc3NhZ2VSZXZva2VkXCIsTUVTU0FHRV9SRUFEX0JZX1BFRVI6XCJvbk1lc3NhZ2VSZWFkQnlQZWVyXCIsTUVTU0FHRV9SRUFEX1JFQ0VJUFRfUkVDRUlWRUQ6XCJvbk1lc3NhZ2VSZWFkUmVjZWlwdFJlY2VpdmVkXCIsTUVTU0FHRV9FWFRFTlNJT05TX1VQREFURUQ6XCJvbk1lc3NhZ2VFeHRlbnNpb25zVXBkYXRlZFwiLE1FU1NBR0VfRVhURU5TSU9OU19ERUxFVEVEOlwib25NZXNzYWdlRXh0ZW5zaW9uc0RlbGV0ZWRcIixDT05WRVJTQVRJT05fTElTVF9VUERBVEVEOlwib25Db252ZXJzYXRpb25MaXN0VXBkYXRlZFwiLFRPVEFMX1VOUkVBRF9NRVNTQUdFX0NPVU5UX1VQREFURUQ6XCJvblRvdGFsVW5yZWFkTWVzc2FnZUNvdW50VXBkYXRlZFwiLENPTlZFUlNBVElPTl9HUk9VUF9MSVNUX1VQREFURUQ6XCJvbkNvbnZlcnNhdGlvbkdyb3VwTGlzdFVwZGF0ZWRcIixDT05WRVJTQVRJT05fSU5fR1JPVVBfVVBEQVRFRDpcIm9uQ29udmVyc2F0aW9uSW5Hcm91cFVwZGF0ZWRcIixHUk9VUF9MSVNUX1VQREFURUQ6XCJvbkdyb3VwTGlzdFVwZGF0ZWRcIixHUk9VUF9TWVNURU1fTk9USUNFX1JFQ0VJVkVEOlwicmVjZWl2ZUdyb3VwU3lzdGVtTm90aWNlXCIsR1JPVVBfQVRUUklCVVRFU19VUERBVEVEOlwiZ3JvdXBBdHRyaWJ1dGVzVXBkYXRlZFwiLEdST1VQX0NPVU5URVJfVVBEQVRFRDpcIm9uR3JvdXBDb3VudGVyVXBkYXRlZFwiLFRPUElDX0NSRUFURUQ6XCJvblRvcGljQ3JlYXRlZFwiLFRPUElDX0RFTEVURUQ6XCJvblRvcGljRGVsZXRlZFwiLFRPUElDX1VQREFURUQ6XCJvblRvcGljVXBkYXRlZFwiLFBST0ZJTEVfVVBEQVRFRDpcIm9uUHJvZmlsZVVwZGF0ZWRcIixVU0VSX1NUQVRVU19VUERBVEVEOlwib25Vc2VyU3RhdHVzVXBkYXRlZFwiLEJMQUNLTElTVF9VUERBVEVEOlwiYmxhY2tsaXN0VXBkYXRlZFwiLEZSSUVORF9MSVNUX1VQREFURUQ6XCJvbkZyaWVuZExpc3RVcGRhdGVkXCIsRlJJRU5EX0dST1VQX0xJU1RfVVBEQVRFRDpcIm9uRnJpZW5kR3JvdXBMaXN0VXBkYXRlZFwiLEZSSUVORF9BUFBMSUNBVElPTl9MSVNUX1VQREFURUQ6XCJvbkZyaWVuZEFwcGxpY2F0aW9uTGlzdFVwZGF0ZWRcIixLSUNLRURfT1VUOlwia2lja2VkT3V0XCIsRVJST1I6XCJlcnJvclwiLE5FVF9TVEFURV9DSEFOR0U6XCJuZXRTdGF0ZUNoYW5nZVwiLFNES19SRUxPQUQ6XCJzZGtSZWxvYWRcIn0sRT17TVNHX1RFWFQ6XCJUSU1UZXh0RWxlbVwiLE1TR19JTUFHRTpcIlRJTUltYWdlRWxlbVwiLE1TR19TT1VORDpcIlRJTVNvdW5kRWxlbVwiLE1TR19BVURJTzpcIlRJTVNvdW5kRWxlbVwiLE1TR19GSUxFOlwiVElNRmlsZUVsZW1cIixNU0dfRkFDRTpcIlRJTUZhY2VFbGVtXCIsTVNHX1ZJREVPOlwiVElNVmlkZW9GaWxlRWxlbVwiLE1TR19HRU86XCJUSU1Mb2NhdGlvbkVsZW1cIixNU0dfTE9DQVRJT046XCJUSU1Mb2NhdGlvbkVsZW1cIixNU0dfR1JQX1RJUDpcIlRJTUdyb3VwVGlwRWxlbVwiLE1TR19HUlBfU1lTX05PVElDRTpcIlRJTUdyb3VwU3lzdGVtTm90aWNlRWxlbVwiLE1TR19DVVNUT006XCJUSU1DdXN0b21FbGVtXCIsTVNHX01FUkdFUjpcIlRJTVJlbGF5RWxlbVwiLE1TR19QUklPUklUWV9ISUdIOlwiSGlnaFwiLE1TR19QUklPUklUWV9OT1JNQUw6XCJOb3JtYWxcIixNU0dfUFJJT1JJVFlfTE9XOlwiTG93XCIsTVNHX1BSSU9SSVRZX0xPV0VTVDpcIkxvd2VzdFwiLENPTlZfQzJDOlwiQzJDXCIsQ09OVl9HUk9VUDpcIkdST1VQXCIsQ09OVl9UT1BJQzpcIlRPUElDXCIsQ09OVl9TWVNURU06XCJAVElNI1NZU1RFTVwiLENPTlZfQVRfTUU6MSxDT05WX0FUX0FMTDoyLENPTlZfQVRfQUxMX0FUX01FOjMsQ09OVl9NQVJLX1RZUEVfU1RBUjoxLENPTlZfTUFSS19UWVBFX1VOUkVBRDoyLENPTlZfTUFSS19UWVBFX0ZPTEQ6NCxDT05WX01BUktfVFlQRV9ISURFOjgsR1JQX1BSSVZBVEU6XCJQcml2YXRlXCIsR1JQX1dPUks6XCJQcml2YXRlXCIsR1JQX1BVQkxJQzpcIlB1YmxpY1wiLEdSUF9DSEFUUk9PTTpcIkNoYXRSb29tXCIsR1JQX01FRVRJTkc6XCJDaGF0Um9vbVwiLEdSUF9BVkNIQVRST09NOlwiQVZDaGF0Um9vbVwiLEdSUF9DT01NVU5JVFk6XCJDb21tdW5pdHlcIixHUlBfTUJSX1JPTEVfT1dORVI6XCJPd25lclwiLEdSUF9NQlJfUk9MRV9BRE1JTjpcIkFkbWluXCIsR1JQX01CUl9ST0xFX01FTUJFUjpcIk1lbWJlclwiLEdSUF9NQlJfUk9MRV9DVVNUT006XCJDdXN0b21cIixHUlBfVElQX01CUl9KT0lOOjEsR1JQX1RJUF9NQlJfUVVJVDoyLEdSUF9USVBfTUJSX0tJQ0tFRF9PVVQ6MyxHUlBfVElQX01CUl9TRVRfQURNSU46NCxHUlBfVElQX01CUl9DQU5DRUxFRF9BRE1JTjo1LEdSUF9USVBfR1JQX1BST0ZJTEVfVVBEQVRFRDo2LEdSUF9USVBfTUJSX1BST0ZJTEVfVVBEQVRFRDo3LEdSUF9USVBfQkFOX0FWQ0hBVFJPT01fTUVNQkVSOjEwLEdSUF9USVBfVU5CQU5fQVZDSEFUUk9PTV9NRU1CRVI6MTEsTVNHX1JFTUlORF9BQ1BUX0FORF9OT1RFOlwiQWNjZXB0QW5kTm90aWZ5XCIsTVNHX1JFTUlORF9BQ1BUX05PVF9OT1RFOlwiQWNjZXB0Tm90Tm90aWZ5XCIsTVNHX1JFTUlORF9ESVNDQVJEOlwiRGlzY2FyZFwiLEdFTkRFUl9VTktOT1dOOlwiR2VuZGVyX1R5cGVfVW5rbm93blwiLEdFTkRFUl9GRU1BTEU6XCJHZW5kZXJfVHlwZV9GZW1hbGVcIixHRU5ERVJfTUFMRTpcIkdlbmRlcl9UeXBlX01hbGVcIixLSUNLRURfT1VUX01VTFRfQUNDT1VOVDpcIm11bHRpcGxlQWNjb3VudFwiLEtJQ0tFRF9PVVRfTVVMVF9ERVZJQ0U6XCJtdWx0aXBsZURldmljZVwiLEtJQ0tFRF9PVVRfVVNFUlNJR19FWFBJUkVEOlwidXNlclNpZ0V4cGlyZWRcIixLSUNLRURfT1VUX1JFU1RfQVBJOlwiUkVTVF9BUElfS2lja1wiLEFMTE9XX1RZUEVfQUxMT1dfQU5ZOlwiQWxsb3dUeXBlX1R5cGVfQWxsb3dBbnlcIixBTExPV19UWVBFX05FRURfQ09ORklSTTpcIkFsbG93VHlwZV9UeXBlX05lZWRDb25maXJtXCIsQUxMT1dfVFlQRV9ERU5ZX0FOWTpcIkFsbG93VHlwZV9UeXBlX0RlbnlBbnlcIixGT1JCSURfVFlQRV9OT05FOlwiQWRtaW5Gb3JiaWRfVHlwZV9Ob25lXCIsRk9SQklEX1RZUEVfU0VORF9PVVQ6XCJBZG1pbkZvcmJpZF9UeXBlX1NlbmRPdXRcIixKT0lOX09QVElPTlNfRlJFRV9BQ0NFU1M6XCJGcmVlQWNjZXNzXCIsSk9JTl9PUFRJT05TX05FRURfUEVSTUlTU0lPTjpcIk5lZWRQZXJtaXNzaW9uXCIsSk9JTl9PUFRJT05TX0RJU0FCTEVfQVBQTFk6XCJEaXNhYmxlQXBwbHlcIixKT0lOX1NUQVRVU19TVUNDRVNTOlwiSm9pbmVkU3VjY2Vzc1wiLEpPSU5fU1RBVFVTX0FMUkVBRFlfSU5fR1JPVVA6XCJBbHJlYWR5SW5Hcm91cFwiLEpPSU5fU1RBVFVTX1dBSVRfQVBQUk9WQUw6XCJXYWl0QWRtaW5BcHByb3ZhbFwiLElOVklURV9PUFRJT05TX0RJU0FCTEVfSU5WSVRFOlwiRGlzYWJsZUludml0ZVwiLElOVklURV9PUFRJT05TX05FRURfUEVSTUlTU0lPTjpcIk5lZWRQZXJtaXNzaW9uXCIsSU5WSVRFX09QVElPTlNfRlJFRV9BQ0NFU1M6XCJGcmVlQWNjZXNzXCIsR1JQX1BST0ZJTEVfT1dORVJfSUQ6XCJvd25lcklEXCIsR1JQX1BST0ZJTEVfQ1JFQVRFX1RJTUU6XCJjcmVhdGVUaW1lXCIsR1JQX1BST0ZJTEVfTEFTVF9JTkZPX1RJTUU6XCJsYXN0SW5mb1RpbWVcIixHUlBfUFJPRklMRV9NRU1CRVJfTlVNOlwibWVtYmVyTnVtXCIsR1JQX1BST0ZJTEVfTUFYX01FTUJFUl9OVU06XCJtYXhNZW1iZXJOdW1cIixHUlBfUFJPRklMRV9KT0lOX09QVElPTjpcImpvaW5PcHRpb25cIixHUlBfUFJPRklMRV9JTlZJVEVfT1BUSU9OOlwiaW52aXRlT3B0aW9uXCIsR1JQX1BST0ZJTEVfSU5UUk9EVUNUSU9OOlwiaW50cm9kdWN0aW9uXCIsR1JQX1BST0ZJTEVfTk9USUZJQ0FUSU9OOlwibm90aWZpY2F0aW9uXCIsR1JQX1BST0ZJTEVfTVVURV9BTExfTUJSUzpcIm11dGVBbGxNZW1iZXJzXCIsU05TX0FERF9UWVBFX1NJTkdMRTpcIkFkZF9UeXBlX1NpbmdsZVwiLFNOU19BRERfVFlQRV9CT1RIOlwiQWRkX1R5cGVfQm90aFwiLFNOU19ERUxFVEVfVFlQRV9TSU5HTEU6XCJEZWxldGVfVHlwZV9TaW5nbGVcIixTTlNfREVMRVRFX1RZUEVfQk9USDpcIkRlbGV0ZV9UeXBlX0JvdGhcIixTTlNfQVBQTElDQVRJT05fVFlQRV9CT1RIOlwiUGVuZGVuY3lfVHlwZV9Cb3RoXCIsU05TX0FQUExJQ0FUSU9OX1NFTlRfVE9fTUU6XCJQZW5kZW5jeV9UeXBlX0NvbWVJblwiLFNOU19BUFBMSUNBVElPTl9TRU5UX0JZX01FOlwiUGVuZGVuY3lfVHlwZV9TZW5kT3V0XCIsU05TX0FQUExJQ0FUSU9OX0FHUkVFOlwiUmVzcG9uc2VfQWN0aW9uX0FncmVlXCIsU05TX0FQUExJQ0FUSU9OX0FHUkVFX0FORF9BREQ6XCJSZXNwb25zZV9BY3Rpb25fQWdyZWVBbmRBZGRcIixTTlNfQ0hFQ0tfVFlQRV9CT1RIOlwiQ2hlY2tSZXN1bHRfVHlwZV9Cb3RoXCIsU05TX0NIRUNLX1RZUEVfU0lOR0xFOlwiQ2hlY2tSZXN1bHRfVHlwZV9TaW5nbGVcIixTTlNfVFlQRV9OT19SRUxBVElPTjpcIkNoZWNrUmVzdWx0X1R5cGVfTm9SZWxhdGlvblwiLFNOU19UWVBFX0FfV0lUSF9COlwiQ2hlY2tSZXN1bHRfVHlwZV9BV2l0aEJcIixTTlNfVFlQRV9CX1dJVEhfQTpcIkNoZWNrUmVzdWx0X1R5cGVfQldpdGhBXCIsU05TX1RZUEVfQk9USF9XQVk6XCJDaGVja1Jlc3VsdF9UeXBlX0JvdGhXYXlcIixORVRfU1RBVEVfQ09OTkVDVEVEOlwiY29ubmVjdGVkXCIsTkVUX1NUQVRFX0NPTk5FQ1RJTkc6XCJjb25uZWN0aW5nXCIsTkVUX1NUQVRFX0RJU0NPTk5FQ1RFRDpcImRpc2Nvbm5lY3RlZFwiLE1TR19BVF9BTEw6XCJfX2tJbVNES19NZXNzc2FnZUF0QUxMX19cIixSRUFEX0FMTF9DMkNfTVNHOlwicmVhZEFsbEMyQ01lc3NhZ2VcIixSRUFEX0FMTF9HUk9VUF9NU0c6XCJyZWFkQWxsR3JvdXBNZXNzYWdlXCIsUkVBRF9BTExfTVNHOlwicmVhZEFsbE1lc3NhZ2VcIixVU0VSX1NUQVRVU19VTktOT1dOOjAsVVNFUl9TVEFUVVNfT05MSU5FOjEsVVNFUl9TVEFUVVNfT0ZGTElORToyLFVTRVJfU1RBVFVTX1VOTE9HSU5FRDozfSxTPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe28odGhpcyxlKSx0aGlzLmNhY2hlPVtdLHRoaXMub3B0aW9ucz1udWxsfXJldHVybiBhKGUsW3trZXk6XCJ1c2VcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBlKXRocm93XCJtaWRkbGV3YXJlIG11c3QgYmUgYSBmdW5jdGlvblwiO3JldHVybiB0aGlzLmNhY2hlLnB1c2goZSksdGhpc319LHtrZXk6XCJuZXh0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYodGhpcy5taWRkbGV3YXJlcyYmdGhpcy5taWRkbGV3YXJlcy5sZW5ndGg+MClyZXR1cm4gdGhpcy5taWRkbGV3YXJlcy5zaGlmdCgpLmNhbGwodGhpcyx0aGlzLm9wdGlvbnMsdGhpcy5uZXh0LmJpbmQodGhpcykpfX0se2tleTpcInJ1blwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLm1pZGRsZXdhcmVzPXRoaXMuY2FjaGUubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZX0pKSx0aGlzLm9wdGlvbnM9ZSx0aGlzLm5leHQoKX19XSksZX0oKSxMPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTowLG49YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjA7byh0aGlzLGUpLHRoaXMuaGlnaD10LHRoaXMubG93PW59cmV0dXJuIGEoZSxbe2tleTpcImVxdWFsXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPT1lJiYodGhpcy5sb3c9PT1lLmxvdyYmdGhpcy5oaWdoPT09ZS5oaWdoKX19LHtrZXk6XCJ0b1N0cmluZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9TnVtYmVyKHRoaXMuaGlnaCkudG9TdHJpbmcoMTYpLHQ9TnVtYmVyKHRoaXMubG93KS50b1N0cmluZygxNik7aWYodC5sZW5ndGg8OClmb3IodmFyIG49OC10Lmxlbmd0aDtuOyl0PVwiMFwiK3Qsbi0tO3JldHVybiBlK3R9fV0pLGV9KCksQT17VEVTVDp7Q0hJTkE6e0RFRkFVTFQ6XCJ3c3M6Ly93c3MtZGV2LnRpbS5xcS5jb21cIn0sT1ZFUlNFQTp7REVGQVVMVDpcIndzczovL3dzcy1kZXYudGltLnFxLmNvbVwifSxTSU5HQVBPUkU6e0RFRkFVTFQ6XCJ3c3M6Ly93c3NzZ3AtZGV2LmltLnFjbG91ZC5jb21cIn0sS09SRUE6e0RFRkFVTFQ6XCJ3c3M6Ly93c3Nrci1kZXYuaW0ucWNsb3VkLmNvbVwifSxHRVJNQU5ZOntERUZBVUxUOlwid3NzOi8vd3NzZ2VyLWRldi5pbS5xY2xvdWQuY29tXCJ9LElORDp7REVGQVVMVDpcIndzczovL3dzc2luZC1kZXYuaW0ucWNsb3VkLmNvbVwifSxKUE46e0RFRkFVTFQ6XCJ3c3M6Ly93c3NqcG4tZGV2LmltLnFjbG91ZC5jb21cIn0sVVNBOntERUZBVUxUOlwid3NzOi8vd3NzdXNhLWRldi5pbS5xY2xvdWQuY29tXCJ9fSxQUk9EVUNUSU9OOntDSElOQTp7REVGQVVMVDpcIndzczovL3dzcy5pbS5xY2xvdWQuY29tXCIsQkFDS1VQOlwid3NzOi8vd3NzLnRpbS5xcS5jb21cIixTVEFUOlwiaHR0cHM6Ly9ldmVudHMuaW0ucWNsb3VkLmNvbVwiLEFOWUNBU1Q6XCJ3c3M6Ly8xNjIuMTQuMTMuMjAzXCJ9LE9WRVJTRUE6e0RFRkFVTFQ6XCJ3c3M6Ly93c3MuaW0ucWNsb3VkLmNvbVwiLEJBQ0tVUDpcIndzczovL3dzcy5teS1pbWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaS5teS1pbWNsb3VkLmNvbVwifSxTSU5HQVBPUkU6e0RFRkFVTFQ6XCJ3c3M6Ly93c3NzZ3AuaW0ucWNsb3VkLmNvbVwiLEJBQ0tVUDpcIndzczovL3dzc3NncC5teS1pbWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaXNncC5teS1pbWNsb3VkLmNvbVwifSxLT1JFQTp7REVGQVVMVDpcIndzczovL3dzc2tyLmltLnFjbG91ZC5jb21cIixCQUNLVVA6XCJ3c3M6Ly93c3Nrci5teS1pbWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaWtyLm15LWltY2xvdWQuY29tXCJ9LEdFUk1BTlk6e0RFRkFVTFQ6XCJ3c3M6Ly93c3NnZXIuaW0ucWNsb3VkLmNvbVwiLEJBQ0tVUDpcIndzczovL3dzc2dlci5teS1pbWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaWdlci5teS1pbWNsb3VkLmNvbVwifSxJTkQ6e0RFRkFVTFQ6XCJ3c3M6Ly93c3NpbmQubXktaW1jbG91ZC5jb21cIixCQUNLVVA6XCJ3c3M6Ly93c3NpbmQuaW0ucWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaWluZC5teS1pbWNsb3VkLmNvbVwifSxKUE46e0RFRkFVTFQ6XCJ3c3M6Ly93c3NqcG4uaW0ucWNsb3VkLmNvbVwiLEJBQ0tVUDpcIndzczovL3dzc2pwbi5teS1pbWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaWpwbi5teS1pbWNsb3VkLmNvbVwifSxVU0E6e0RFRkFVTFQ6XCJ3c3M6Ly93c3N1c2EuaW0ucWNsb3VkLmNvbVwiLEJBQ0tVUDpcIndzczovL3dzc3VzYS5teS1pbWNsb3VkLmNvbVwiLFNUQVQ6XCJodHRwczovL2FwaXVzYS5teS1pbWNsb3VkLmNvbVwifX19LFI9e0FORFJPSUQ6MixJT1M6MyxNQUM6NCxXRUI6NyxXWF9NUDo4LFFRX01QOjksVFRfTVA6MTAsQkFJRFVfTVA6MTEsQUxJX01QOjEyLElQQUQ6MTMsVU5JX05BVElWRV9BUFA6MTV9LE49XCIxLjcuM1wiLE89NTM3MDQ4MTY4LEc9XCJDSElOQVwiLFU9XCJPVkVSU0VBXCIsUD1cIlNJTkdBUE9SRVwiLGI9XCJLT1JFQVwiLHc9XCJHRVJNQU5ZXCIsRj1cIklORFwiLHE9XCJKUE5cIix4PVwiVVNBXCIsVj17SE9TVDp7Q1VSUkVOVDp7REVGQVVMVDpcIndzczovL3dzcy5pbS5xY2xvdWQuY29tXCIsU1RBVDpcImh0dHBzOi8vZXZlbnRzLmltLnFjbG91ZC5jb21cIn0sc2V0Q3VycmVudDpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpHO3RoaXMuQ1VSUkVOVD1BLlBST0RVQ1RJT05bZV19fSxOQU1FOntPUEVOX0lNOlwib3BlbmltXCIsT1BFTl9JTV9NU0dfRVhUOlwib3BlbmltX21zZ19leHRfaHR0cF9zdmNcIixHUk9VUDpcImdyb3VwX29wZW5faHR0cF9zdmNcIixHUk9VUF9BVkNIQVRST09NOlwiZ3JvdXBfb3Blbl9hdmNoYXRyb29tX2h0dHBfc3ZjXCIsR1JPVVBfQ09NTVVOSVRZOlwibWlsbGlvbl9ncm91cF9vcGVuX2h0dHBfc3ZjXCIsR1JPVVBfQVRUUjpcImdyb3VwX29wZW5fYXR0cl9odHRwX3N2Y1wiLEZSSUVORDpcInNuc1wiLFBST0ZJTEU6XCJwcm9maWxlXCIsUkVDRU5UX0NPTlRBQ1Q6XCJyZWNlbnRjb250YWN0XCIsUElDOlwib3BlbnBpY1wiLEJJR19HUk9VUF9OT19BVVRIOlwiZ3JvdXBfb3Blbl9odHRwX25vYXV0aF9zdmNcIixCSUdfR1JPVVBfTE9OR19QT0xMSU5HOlwiZ3JvdXBfb3Blbl9sb25nX3BvbGxpbmdfaHR0cF9zdmNcIixCSUdfR1JPVVBfTE9OR19QT0xMSU5HX05PX0FVVEg6XCJncm91cF9vcGVuX2xvbmdfcG9sbGluZ19odHRwX25vYXV0aF9zdmNcIixJTV9PUEVOX1NUQVQ6XCJpbW9wZW5zdGF0XCIsV0VCX0lNOlwid2ViaW1cIixJTV9DT1NfU0lHTjpcImltX2Nvc19zaWduX3N2clwiLENVU1RPTV9VUExPQUQ6XCJpbV9jb3NfbXNnXCIsSEVBUlRCRUFUOlwiaGVhcnRiZWF0XCIsSU1fT1BFTl9QVVNIOlwiaW1fb3Blbl9wdXNoXCIsSU1fT1BFTl9TVEFUVVM6XCJpbV9vcGVuX3N0YXR1c1wiLElNX0xPTkdfTUVTU0FHRTpcImltX2xvbmdfbXNnXCIsSU1fQ09ORklHX01BTkFHRVI6XCJpbV9zZGtfY29uZmlnX21nclwiLFNUQVRfU0VSVklDRTpcIlN0YXRTdmNcIixPVkVSTE9BRF9QVVNIOlwiT3ZlckxvYWRQdXNoXCIsSU1fTVNHX0FVRElUX01HUjpcImltX21zZ19hdWRpdF9tZ3JcIixUVUlST09NX1NWUjpcInR1aV9yb29tX3N2clwiLElNX09QRU5fVFJBTlNMQVRFOlwiaW1fb3Blbl90cmFuc2xhdGVcIn0sQ01EOntMT0dJTjpcIndzbG9naW5cIixMT0dPVVRfTE9OR19QT0xMOlwibG9uZ3BvbGxpbmdsb2dvdXRcIixMT0dPVVQ6XCJ3c2xvZ291dFwiLEhFTExPOlwid3NoZWxsb1wiLFNUQVRfQkFDS0dST1VORDpcIndzX3N0YXRfYmFja2dyb3VuZFwiLFNUQVRfRk9SRUdST1VORDpcIndzX3N0YXRfZm9yZWdyb3VuZFwiLFNFVF9UT0tFTjpcIndzX3N0YXRfc2V0dG9rZW5cIixQT1JUUkFJVF9HRVQ6XCJwb3J0cmFpdF9nZXRfYWxsXCIsUE9SVFJBSVRfU0VUOlwicG9ydHJhaXRfc2V0XCIsR0VUX0xPTkdfUE9MTF9JRDpcImdldGxvbmdwb2xsaW5naWRcIixMT05HX1BPTEw6XCJsb25ncG9sbGluZ1wiLEFWQ0hBVFJPT01fTE9OR19QT0xMOlwiZ2V0X21zZ1wiLEFERF9GUklFTkQ6XCJmcmllbmRfYWRkXCIsVVBEQVRFX0ZSSUVORDpcImZyaWVuZF91cGRhdGVcIixHRVRfRlJJRU5EX0xJU1Q6XCJmcmllbmRfZ2V0XCIsR0VUX0ZSSUVORF9QUk9GSUxFOlwiZnJpZW5kX2dldF9zcGVjaWZpZWRcIixERUxFVEVfRlJJRU5EOlwiZnJpZW5kX2RlbGV0ZVwiLENIRUNLX0ZSSUVORDpcImZyaWVuZF9jaGVja1wiLEdFVF9GUklFTkRfR1JPVVBfTElTVDpcImdyb3VwX2dldFwiLFJFU1BPTkRfRlJJRU5EX0FQUExJQ0FUSU9OOlwiZnJpZW5kX3Jlc3BvbnNlXCIsR0VUX0ZSSUVORF9BUFBMSUNBVElPTl9MSVNUOlwicGVuZGVuY3lfZ2V0XCIsREVMRVRFX0ZSSUVORF9BUFBMSUNBVElPTjpcInBlbmRlbmN5X2RlbGV0ZVwiLFJFUE9SVF9GUklFTkRfQVBQTElDQVRJT046XCJwZW5kZW5jeV9yZXBvcnRcIixHRVRfR1JPVVBfQVBQTElDQVRJT046XCJnZXRfcGVuZGVuY3lcIixDUkVBVEVfRlJJRU5EX0dST1VQOlwiZ3JvdXBfYWRkXCIsREVMRVRFX0ZSSUVORF9HUk9VUDpcImdyb3VwX2RlbGV0ZVwiLFVQREFURV9GUklFTkRfR1JPVVA6XCJncm91cF91cGRhdGVcIixHRVRfQkxBQ0tMSVNUOlwiYmxhY2tfbGlzdF9nZXRcIixBRERfQkxBQ0tMSVNUOlwiYmxhY2tfbGlzdF9hZGRcIixERUxFVEVfQkxBQ0tMSVNUOlwiYmxhY2tfbGlzdF9kZWxldGVcIixDUkVBVEVfR1JPVVA6XCJjcmVhdGVfZ3JvdXBcIixHRVRfSk9JTkVEX0dST1VQUzpcImdldF9qb2luZWRfZ3JvdXBfbGlzdFwiLFNFVF9HUk9VUF9BVFRSSUJVVEVTOlwic2V0X2dyb3VwX2F0dHJcIixNT0RJRllfR1JPVVBfQVRUUklCVVRFUzpcIm1vZGlmeV9ncm91cF9hdHRyXCIsREVMRVRFX0dST1VQX0FUVFJJQlVURVM6XCJkZWxldGVfZ3JvdXBfYXR0clwiLENMRUFSX0dST1VQX0FUVFJJQlVURVM6XCJjbGVhcl9ncm91cF9hdHRyXCIsR0VUX0dST1VQX0FUVFJJQlVURVM6XCJnZXRfZ3JvdXBfYXR0clwiLFNFTkRfTUVTU0FHRTpcInNlbmRtc2dcIixSRVZPS0VfQzJDX01FU1NBR0U6XCJtc2d3aXRoZHJhd1wiLERFTEVURV9DMkNfTUVTU0FHRTpcImRlbGV0ZV9jMmNfbXNnX3JhbWJsZVwiLE1PRElGWV9DMkNfTUVTU0FHRTpcIm1vZGlmeV9jMmNfbXNnXCIsTU9ESUZZX0MyQ19NRVNTQUdFX0VYVEVOU0lPTlM6XCJzZXRfa2V5X3ZhbHVlc1wiLEdFVF9DMkNfTUVTU0FHRV9FWFRFTlNJT05TOlwiZ2V0X2tleV92YWx1ZXNcIixTRU5EX0dST1VQX01FU1NBR0U6XCJzZW5kX2dyb3VwX21zZ1wiLFJFVk9LRV9HUk9VUF9NRVNTQUdFOlwiZ3JvdXBfbXNnX3JlY2FsbFwiLERFTEVURV9HUk9VUF9NRVNTQUdFOlwiZGVsZXRlX2dyb3VwX3JhbWJsZV9tc2dfYnlfc2VxXCIsTU9ESUZZX0dST1VQX01FU1NBR0U6XCJtb2RpZnlfZ3JvdXBfbXNnXCIsTU9ESUZZX0dST1VQX01FU1NBR0VfRVhURU5TSU9OUzpcImdyb3VwX3NldF9rZXlfdmFsdWVzXCIsR0VUX0dST1VQX01FU1NBR0VfRVhURU5TSU9OUzpcImdyb3VwX2dldF9rZXlfdmFsdWVzXCIsR0VUX0dST1VQX0lORk86XCJnZXRfZ3JvdXBfc2VsZl9tZW1iZXJfaW5mb1wiLEdFVF9HUk9VUF9NRU1CRVJfSU5GTzpcImdldF9zcGVjaWZpZWRfZ3JvdXBfbWVtYmVyX2luZm9cIixHRVRfR1JPVVBfTUVNQkVSX0xJU1Q6XCJnZXRfZ3JvdXBfbWVtYmVyX2luZm9cIixHRVRfQVZDSEFUUk9PTV9NRU1CRVJfTElTVDpcImdldF9tZW1iZXJzXCIsTUFSS19BVkNIQVRST09NX01FTUJFUl9JTkZPOlwibW9kaWZ5X3VzZXJfaW5mb1wiLFFVSVRfR1JPVVA6XCJxdWl0X2dyb3VwXCIsQ0hBTkdFX0dST1VQX09XTkVSOlwiY2hhbmdlX2dyb3VwX293bmVyXCIsREVTVFJPWV9HUk9VUDpcImRlc3Ryb3lfZ3JvdXBcIixBRERfR1JPVVBfTUVNQkVSOlwiYWRkX2dyb3VwX21lbWJlclwiLERFTEVURV9HUk9VUF9NRU1CRVI6XCJkZWxldGVfZ3JvdXBfbWVtYmVyXCIsQkFOX0FWQ0hBVFJPT01fTUVNQkVSOlwiYmFuX2dyb3VwX21lbWJlclwiLFNFQVJDSF9HUk9VUF9CWV9JRDpcImdldF9ncm91cF9wdWJsaWNfaW5mb1wiLEFQUExZX0pPSU5fR1JPVVA6XCJhcHBseV9qb2luX2dyb3VwXCIsSEFORExFX0FQUExZX0pPSU5fR1JPVVA6XCJoYW5kbGVfYXBwbHlfam9pbl9ncm91cFwiLEhBTkRMRV9JTlZJVEVfSk9JTl9HUk9VUDpcImhhbmRsZV9pbnZpdGVfam9pbl9wZXJtaXNzaW9uX2dyb3VwXCIsSEFORExFX0dST1VQX0lOVklUQVRJT046XCJoYW5kbGVfaW52aXRlX2pvaW5fZ3JvdXBcIixNT0RJRllfR1JPVVBfSU5GTzpcIm1vZGlmeV9ncm91cF9iYXNlX2luZm9cIixNT0RJRllfR1JPVVBfTUVNQkVSX0lORk86XCJtb2RpZnlfZ3JvdXBfbWVtYmVyX2luZm9cIixERUxFVEVfR1JPVVBfU1lTVEVNX01FU1NBR0U6XCJkZWxldGVtc2dcIixERUxFVEVfR1JPVVBfQVRfVElQUzpcImRlbGV0ZW1zZ1wiLEdFVF9HUk9VUF9OT1RJRlk6XCJnZXRfZ3JvdXBfbm90aWZ5XCIsR0VUX0NPTlZFUlNBVElPTl9MSVNUOlwiZ2V0XCIsUEFHSU5HX0dFVF9DT05WRVJTQVRJT05fTElTVDpcInBhZ2VfZ2V0XCIsREVMRVRFX0NPTlZFUlNBVElPTjpcImJhdGNoX2RlbGV0ZVwiLENMRUFSX0hJU1RPUllfTUVTU0FHRTpcImNsZWFyX21zZ1wiLFBJTl9DT05WRVJTQVRJT046XCJ0b3BcIixTRVRfQ09OVkVSU0FUSU9OX0NVU1RPTV9EQVRBOlwibWFya19jb250YWN0XCIsTUFSS19DT05WRVJTQVRJT046XCJtYXJrX2NvbnRhY3RcIixDUkVBVEVfQ09OVkVSU0FUSU9OX0dST1VQOlwiY3JlYXRlX2NvbnRhY3RfZ3JvdXBcIixERUxFVEVfQ09OVkVSU0FUSU9OX0dST1VQOlwiZGVsX2NvbnRhY3RfZ3JvdXBcIixVUERBVEVfQ09OVkVSU0FUSU9OX0dST1VQOlwidXBkYXRlX2NvbnRhY3RfZ3JvdXBcIixHRVRfQ09OVkVSU0FUSU9OX0dST1VQX0xJU1Q6XCJnZXRfY29udGFjdF9ncm91cFwiLEdFVF9NRVNTQUdFUzpcImdldG1zZ1wiLEdFVF9DMkNfUk9BTV9NRVNTQUdFUzpcImdldHJvYW1tc2dcIixTRVRfQzJDX1BFRVJfTVVURV9OT1RJRklDQVRJT05TOlwic2V0X2MyY19wZWVyX211dGVfbm90aWZpY2F0aW9uc1wiLEdFVF9DMkNfUEVFUl9NVVRFX05PVElGSUNBVElPTlM6XCJnZXRfYzJjX3BlZXJfbXV0ZV9ub3RpZmljYXRpb25zXCIsR0VUX0dST1VQX1JPQU1fTUVTU0FHRVM6XCJncm91cF9tc2dfZ2V0XCIsR0VUX1JFQURfUkVDRUlQVDpcImdldF9ncm91cF9tc2dfcmVjZWlwdFwiLEdFVF9SRUFEX1JFQ0VJUFRfREVUQUlMOlwiZ2V0X2dyb3VwX21zZ19yZWNlaXB0X2RldGFpbFwiLFNFTkRfUkVBRF9SRUNFSVBUOlwiZ3JvdXBfbXNnX3JlY2VpcHRcIixTRU5EX0MyQ19SRUFEX1JFQ0VJUFQ6XCJjMmNfbXNnX3JlYWRfcmVjZWlwdFwiLFNFVF9DMkNfTUVTU0FHRV9SRUFEOlwibXNncmVhZGVkXCIsR0VUX1BFRVJfUkVBRF9USU1FOlwiZ2V0X3BlZXJfcmVhZF90aW1lXCIsU0VUX0dST1VQX01FU1NBR0VfUkVBRDpcIm1zZ19yZWFkX3JlcG9ydFwiLEZJTEVfUkVBRF9BTkRfV1JJVEVfQVVUSEtFWTpcImF1dGhrZXlcIixGSUxFX1VQTE9BRDpcInBpY191cFwiLENPU19TSUdOOlwiY29zXCIsQ09TX1BSRV9TSUc6XCJwcmVfc2lnXCIsVklERU9fQ09WRVI6XCJ2aWRlb19jb3ZlclwiLFRJTV9XRUJfUkVQT1JUX1YyOlwidGltX3dlYl9yZXBvcnRfdjJcIixCSUdfREFUQV9IQUxMV0FZX0FVVEhfS0VZOlwiYXV0aGtleVwiLEdFVF9PTkxJTkVfTUVNQkVSX05VTTpcImdldF9vbmxpbmVfbWVtYmVyX251bVwiLEFMSVZFOlwiYWxpdmVcIixNRVNTQUdFX1BVU0g6XCJtc2dfcHVzaFwiLE1VTFRJX01FU1NBR0VfUFVTSDpcIm11bHRpX21zZ19wdXNoX3dzXCIsTUVTU0FHRV9QVVNIX0FDSzpcIndzX21zZ19wdXNoX2Fja1wiLFNUQVRVU19GT1JDRV9PRkZMSU5FOlwic3RhdF9mb3JjZW9mZmxpbmVcIixET1dOTE9BRF9NRVJHRVJfTUVTU0FHRTpcImdldF9yZWxheV9qc29uX21zZ1wiLFVQTE9BRF9NRVJHRVJfTUVTU0FHRTpcInNhdmVfcmVsYXlfanNvbl9tc2dcIixGRVRDSF9DTE9VRF9DT05UUk9MX0NPTkZJRzpcImZldGNoX2NvbmZpZ1wiLFBVU0hFRF9DTE9VRF9DT05UUk9MX0NPTkZJRzpcInB1c2hfY29uZmlndjJcIixGRVRDSF9DT01NRVJDSUFMX0NPTkZJRzpcImZldGNoX2ltc2RrX3B1cmNoYXNlX2JpdHN2MlwiLFBVU0hFRF9DT01NRVJDSUFMX0NPTkZJRzpcInB1c2hfaW1zZGtfcHVyY2hhc2VfYml0c3YyXCIsS0lDS19PVEhFUjpcIktpY2tPdGhlclwiLE9WRVJMT0FEX05PVElGWTpcIm5vdGlmeTJcIixTRVRfQUxMX01FU1NBR0VfUkVBRDpcInJlYWRfYWxsX3VucmVhZF9tc2dcIixDUkVBVEVfVE9QSUM6XCJjcmVhdGVfdG9waWNcIixERUxFVEVfVE9QSUM6XCJkZXN0cm95X3RvcGljXCIsVVBEQVRFX1RPUElDX1BST0ZJTEU6XCJtb2RpZnlfdG9waWNcIixHRVRfVE9QSUNfTElTVDpcImdldF90b3BpY1wiLFNFVF9TRUxGX1NUQVRVUzpcIndzX3NldF9jdXN0b21fc3RhdHVzXCIsR0VUX1VTRVJfU1RBVFVTOlwid3NfZ2V0X3VzZXJfc3RhdHVzXCIsU1VCU0NSSUJFX1VTRVJfU1RBVFVTOlwid3Nfc3RhdHVzX3N1YnNjcmliZVwiLFVOU1VCU0NSSUJFX1VTRVJfU1RBVFVTOlwid3Nfc3RhdHVzX3Vuc3Vic2NyaWJlXCIsR0VUX1JQT0ZBTklUWV9MSVNUOlwiZ2V0X2xvY2FsX3dvcmRzXCIsVFJBTlNMQVRFX1RFWFQ6XCJ3c19iYXRjaF90cmFuc190ZXh0XCIsVVBEQVRFX0dST1VQX0NPVU5URVI6XCJ1cGRhdGVfZ3JvdXBfY291bnRlclwiLEdFVF9HUk9VUF9DT1VOVEVSOlwiZ2V0X2dyb3VwX2NvdW50ZXJcIn0sQ0hBTk5FTDp7U09DS0VUOjEsWEhSOjIsQVVUTzowfSxOQU1FX1ZFUlNJT046e29wZW5pbTpcInY0XCIsZ3JvdXBfb3Blbl9odHRwX3N2YzpcInY0XCIsc25zOlwidjRcIixwcm9maWxlOlwidjRcIixyZWNlbnRjb250YWN0OlwidjRcIixvcGVucGljOlwidjRcIixncm91cF9vcGVuX2h0dHBfbm9hdXRoX3N2YzpcInY0XCIsZ3JvdXBfb3Blbl9sb25nX3BvbGxpbmdfaHR0cF9zdmM6XCJ2NFwiLGdyb3VwX29wZW5fbG9uZ19wb2xsaW5nX2h0dHBfbm9hdXRoX3N2YzpcInY0XCIsaW1vcGVuc3RhdDpcInY0XCIsaW1fY29zX3NpZ25fc3ZyOlwidjRcIixpbV9jb3NfbXNnOlwidjRcIix3ZWJpbTpcInY0XCIsaW1fb3Blbl9wdXNoOlwidjRcIixpbV9vcGVuX3N0YXR1czpcInY0XCJ9fSxCPXtTRUFSQ0hfTVNHOm5ldyBMKDAsTWF0aC5wb3coMiwwKSkudG9TdHJpbmcoKSxTRUFSQ0hfR1JQX1NOUzpuZXcgTCgwLE1hdGgucG93KDIsMSkpLnRvU3RyaW5nKCksQVZDSEFUUk9PTV9ISVNUT1JZX01TRzpuZXcgTCgwLE1hdGgucG93KDIsMikpLnRvU3RyaW5nKCksR1JQX0NPTU1VTklUWTpuZXcgTCgwLE1hdGgucG93KDIsMykpLnRvU3RyaW5nKCksTVNHX1RPX1NQRUNJRklFRF9HUlBfTUJSOm5ldyBMKDAsTWF0aC5wb3coMiw0KSkudG9TdHJpbmcoKSxBVkNIQVRST09NX01CUl9MSVNUOm5ldyBMKDAsTWF0aC5wb3coMiw2KSkudG9TdHJpbmcoKSxVU0VSX1NUQVRVUzpuZXcgTCgwLE1hdGgucG93KDIsNykpLnRvU3RyaW5nKCksQ09OVl9NQVJLOm5ldyBMKDAsTWF0aC5wb3coMiw5KSkudG9TdHJpbmcoKSxDT05WX0dST1VQOm5ldyBMKDAsTWF0aC5wb3coMiwxMCkpLnRvU3RyaW5nKCksQVZDSEFUUk9PTV9CQU5fTUJSOm5ldyBMKDAsTWF0aC5wb3coMiwxMSkpLnRvU3RyaW5nKCksTVNHX0VYVDpuZXcgTCgwLE1hdGgucG93KDIsMTMpKS50b1N0cmluZygpLEdSUF9DT1VOVEVSOm5ldyBMKDAsTWF0aC5wb3coMiwxNSkpLnRvU3RyaW5nKCl9LEg9XCJjMmNfdGV4dF9tZXNzYWdlXCIsSz1cImMyY19jdXN0b21fbWVzc2FnZVwiLFc9XCJncm91cF90ZXh0X21lc3NhZ2VcIixZPVwiZ3JvdXBfY3VzdG9tX21lc3NhZ2VcIixqPVwidXNlcl9wcm9maWxlXCIsej1cImdyb3VwX3Byb2ZpbGVcIixKPVwiZ3JvdXBfbWVtYmVyX3Byb2ZpbGVcIjtWLkhPU1Quc2V0Q3VycmVudChHKTt2YXIgWD1cInVuZGVmaW5lZFwiIT10eXBlb2Ygd3gmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHd4LmdldFN5c3RlbUluZm9TeW5jJiZCb29sZWFuKHd4LmdldFN5c3RlbUluZm9TeW5jKCkuZm9udFNpemVTZXR0aW5nKSxaPVgmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHd4LmNyZWF0ZUdhbWVQb3J0YWwsUT1cInVuZGVmaW5lZFwiIT10eXBlb2YgcXEmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHFxLmdldFN5c3RlbUluZm9TeW5jJiZCb29sZWFuKHFxLmdldFN5c3RlbUluZm9TeW5jKCkuZm9udFNpemVTZXR0aW5nKSwkPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB0dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdHQuZ2V0U3lzdGVtSW5mb1N5bmMmJkJvb2xlYW4odHQuZ2V0U3lzdGVtSW5mb1N5bmMoKS5mb250U2l6ZVNldHRpbmcpLGVlPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBzd2FuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBzd2FuLmdldFN5c3RlbUluZm9TeW5jJiZCb29sZWFuKHN3YW4uZ2V0U3lzdGVtSW5mb1N5bmMoKS5mb250U2l6ZVNldHRpbmcpLHRlPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBteSYmXCJmdW5jdGlvblwiPT10eXBlb2YgbXkuZ2V0U3lzdGVtSW5mb1N5bmMmJkJvb2xlYW4obXkuZ2V0U3lzdGVtSW5mb1N5bmMoKS5mb250U2l6ZVNldHRpbmcpLG5lPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBqZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgamQuZ2V0U3lzdGVtSW5mb1N5bmMsb2U9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHVuaSYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIHdpbmRvdyYmXCJmdW5jdGlvblwiPT10eXBlb2YgdW5pLnJlcXVpcmVOYXRpdmVQbHVnaW4sc2U9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHVuaSxhZT1YfHxRfHwkfHxlZXx8dGV8fG9lfHxuZSxpZT0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHVuaXx8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdykmJiFhZSxyZT1RP3FxOiQ/dHQ6ZWU/c3dhbjp0ZT9teTpYP3d4Om9lP3VuaTpuZT9qZDp7fSx1ZT1pZSYmd2luZG93JiZ3aW5kb3cubmF2aWdhdG9yJiZ3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudHx8XCJcIixjZT0vKG1pY3JvbWVzc2VuZ2VyfHdlYmJyb3dzZXIpL2kudGVzdCh1ZSksbGU9L0FwcGxlV2ViS2l0XFwvKFtcXGQuXSspL2kuZXhlYyh1ZSk7bGUmJnBhcnNlRmxvYXQobGUucG9wKCkpO3ZhciBkZSxwZSxnZT0oZGU9XCJXRUJcIixjZT9kZT1cIldFQlwiOlE/ZGU9XCJRUV9NUFwiOiQ/ZGU9XCJUVF9NUFwiOmVlP2RlPVwiQkFJRFVfTVBcIjp0ZT9kZT1cIkFMSV9NUFwiOlg/ZGU9XCJXWF9NUFwiOm9lJiYoZGU9XCJVTklfTkFUSVZFX0FQUFwiKSxSW2RlXSksaGU9L2lQYWQvaS50ZXN0KHVlKSxfZT0vaVBob25lL2kudGVzdCh1ZSkmJiFoZSxmZT0vaVBvZC9pLnRlc3QodWUpLHZlPV9lfHxoZXx8ZmUsbWU9KHBlPXVlLm1hdGNoKC9PUyAoXFxkKylfL2kpKSYmcGVbMV0/cGVbMV06bnVsbCxNZT0vQW5kcm9pZC9pLnRlc3QodWUpLHllPWZ1bmN0aW9uKCl7dmFyIGU9dWUubWF0Y2goL0FuZHJvaWQgKFxcZCspKD86XFwuKFxcZCspKT8oPzpcXC4oXFxkKykpKi9pKTtpZighZSlyZXR1cm4gbnVsbDt2YXIgdD1lWzFdJiZwYXJzZUZsb2F0KGVbMV0pLG49ZVsyXSYmcGFyc2VGbG9hdChlWzJdKTtyZXR1cm4gdCYmbj9wYXJzZUZsb2F0KGVbMV0rXCIuXCIrZVsyXSk6dHx8bnVsbH0oKTshZnVuY3Rpb24oKXt2YXIgZT11ZS5tYXRjaCgvQ2hyb21lXFwvKFxcZCspLyk7ZSYmZVsxXSYmcGFyc2VGbG9hdChlWzFdKX0oKTt2YXIgSWU9L01TSUUvLnRlc3QodWUpfHx1ZS5pbmRleE9mKFwiVHJpZGVudFwiKT4tMSYmdWUuaW5kZXhPZihcInJ2OjExLjBcIik+LTEsQ2U9ZnVuY3Rpb24oKXt2YXIgZT0vTVNJRVxccyhcXGQrKVxcLlxcZC8uZXhlYyh1ZSksdD1lJiZwYXJzZUZsb2F0KGVbMV0pO3JldHVybiF0JiYvVHJpZGVudFxcLzcuMC9pLnRlc3QodWUpJiYvcnY6MTEuMC8udGVzdCh1ZSkmJih0PTExKSx0fSgpOyFmdW5jdGlvbigpe3ZhciBlPXVlLm1hdGNoKC9UQlNcXC8oXFxkKykvaSk7aWYoZSYmZVsxXSllWzFdfSgpO3ZhciBUZSxEZSxrZT0vV2luZG93cy9pLnRlc3QodWUpLEVlPS9NQUMgT1MgWC9pLnRlc3QodWUpLFNlPWllJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgV29ya2VyJiYhSWUsTGU9TWV8fHZlLEFlPWllJiZ2b2lkIDAhPT13aW5kb3cudGVuY2VudF9jbG91ZF9pbV9jc2lnX2ZsdXR0ZXJfZm9yX3dlYl8yNUZfY3k7VGU9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGNvbnNvbGU/Y29uc29sZTpcInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsJiZnbG9iYWwuY29uc29sZT9nbG9iYWwuY29uc29sZTpcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuY29uc29sZT93aW5kb3cuY29uc29sZTp7fTtmb3IodmFyIFJlPWZ1bmN0aW9uKCl7fSxOZT1bXCJhc3NlcnRcIixcImNsZWFyXCIsXCJjb3VudFwiLFwiZGVidWdcIixcImRpclwiLFwiZGlyeG1sXCIsXCJlcnJvclwiLFwiZ3JvdXBcIixcImdyb3VwQ29sbGFwc2VkXCIsXCJncm91cEVuZFwiLFwiaW5mb1wiLFwibG9nXCIsXCJwcm9maWxlXCIsXCJwcm9maWxlRW5kXCIsXCJ0YWJsZVwiLFwidGltZVwiLFwidGltZUVuZFwiLFwidGltZVN0YW1wXCIsXCJ0cmFjZVwiLFwid2FyblwiXSxPZT1OZS5sZW5ndGg7T2UtLTspRGU9TmVbT2VdLGNvbnNvbGVbRGVdfHwoVGVbRGVdPVJlKTt2YXIgR2U9VGUsVWU9MCxQZT1mdW5jdGlvbigpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpK1VlfSxiZT1mdW5jdGlvbigpe1VlPTB9LHdlPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguZmxvb3IoUGUoKS8xZTMpfSxGZT0wO2Z1bmN0aW9uIHFlKCl7cmV0dXJuIEt0KCk/XCIlYyBUSU0gJWNcIjpcIlRJTVwifWZ1bmN0aW9uIHhlKCl7dmFyIGUsdD0oKGU9bmV3IERhdGUpLnNldFRpbWUoUGUoKSksZSk7cmV0dXJuIHQudG9Mb2NhbGVUaW1lU3RyaW5nKFwiZW4tVVNcIix7aG91cjEyOiExfSkrXCIuXCIrZnVuY3Rpb24oZSl7dmFyIHQ7c3dpdGNoKGUudG9TdHJpbmcoKS5sZW5ndGgpe2Nhc2UgMTp0PVwiMDBcIitlO2JyZWFrO2Nhc2UgMjp0PVwiMFwiK2U7YnJlYWs7ZGVmYXVsdDp0PWV9cmV0dXJuIHR9KHQuZ2V0TWlsbGlzZWNvbmRzKCkpfXZhciBWZT17YXJndW1lbnRzMlN0cmluZzpmdW5jdGlvbihlKXt2YXIgdD1cIlwiO2lmKDE9PT1lLmxlbmd0aCl0PWVbMF07ZWxzZSBmb3IodmFyIG49MCxvPWUubGVuZ3RoO248bztuKyspcnQoZVtuXSk/Y3QoZVtuXSk/dCs9Z3QoZVtuXSk6dCs9SlNPTi5zdHJpbmdpZnkoZVtuXSk6dCs9ZVtuXSx0Kz1cIiBcIjtyZXR1cm4gdH0sX2V4ZWM6ZnVuY3Rpb24oZSx0KXtLdCgpP0dlW2VdKHFlKCksXCJiYWNrZ3JvdW5kOiMwYWJmNWI7IHBhZGRpbmc6MXB4OyBib3JkZXItcmFkaXVzOjNweDsgY29sb3I6ICNmZmZcIixcImJhY2tncm91bmQ6dHJhbnNwYXJlbnRcIix4ZSgpLHQpOkdlW2VdKFwiXCIuY29uY2F0KHFlKCksXCIgXCIpLmNvbmNhdCh4ZSgpLFwiIFwiKS5jb25jYXQodCkpfSxkOmZ1bmN0aW9uKCl7aWYoRmU8PS0xKXt2YXIgZT10aGlzLmFyZ3VtZW50czJTdHJpbmcoYXJndW1lbnRzKTt0aGlzLl9leGVjKFwiZGVidWdcIixlKX19LGw6ZnVuY3Rpb24oKXtpZihGZTw9MCl7dmFyIGU9dGhpcy5hcmd1bWVudHMyU3RyaW5nKGFyZ3VtZW50cyk7dGhpcy5fZXhlYyhcImxvZ1wiLGUpfX0sbG9nOmZ1bmN0aW9uKCl7aWYoRmU8PTApe3ZhciBlPXRoaXMuYXJndW1lbnRzMlN0cmluZyhhcmd1bWVudHMpO3RoaXMuX2V4ZWMoXCJsb2dcIixlKX19LGk6ZnVuY3Rpb24oKXtpZihGZTw9MSl7dmFyIGU9dGhpcy5hcmd1bWVudHMyU3RyaW5nKGFyZ3VtZW50cyk7dGhpcy5fZXhlYyhcImluZm9cIixlKX19LHc6ZnVuY3Rpb24oKXtpZihGZTw9Mil7dmFyIGU9dGhpcy5hcmd1bWVudHMyU3RyaW5nKGFyZ3VtZW50cyk7dGhpcy5fZXhlYyhcIndhcm5cIixlKX19LGU6ZnVuY3Rpb24oKXtpZihGZTw9Myl7dmFyIGU9dGhpcy5hcmd1bWVudHMyU3RyaW5nKGFyZ3VtZW50cyk7dGhpcy5fZXhlYyhcImVycm9yXCIsZSl9fSxzZXRMZXZlbDpmdW5jdGlvbihlKXtlPDQmJnRoaXMuX2V4ZWMoXCJsb2dcIixcInNldCBsZXZlbCBmcm9tIFwiK0ZlK1wiIHRvIFwiK2UpLEZlPWV9LGdldExldmVsOmZ1bmN0aW9uKCl7cmV0dXJuIEZlfX0sQmU9e0pQRzoxLEpQRUc6MSxHSUY6MixQTkc6MyxCTVA6NCxVTktOT1dOOjI1NX0sSGU9e05JQ0s6XCJUYWdfUHJvZmlsZV9JTV9OaWNrXCIsR0VOREVSOlwiVGFnX1Byb2ZpbGVfSU1fR2VuZGVyXCIsQklSVEhEQVk6XCJUYWdfUHJvZmlsZV9JTV9CaXJ0aERheVwiLExPQ0FUSU9OOlwiVGFnX1Byb2ZpbGVfSU1fTG9jYXRpb25cIixTRUxGU0lHTkFUVVJFOlwiVGFnX1Byb2ZpbGVfSU1fU2VsZlNpZ25hdHVyZVwiLEFMTE9XVFlQRTpcIlRhZ19Qcm9maWxlX0lNX0FsbG93VHlwZVwiLExBTkdVQUdFOlwiVGFnX1Byb2ZpbGVfSU1fTGFuZ3VhZ2VcIixBVkFUQVI6XCJUYWdfUHJvZmlsZV9JTV9JbWFnZVwiLE1FU1NBR0VTRVRUSU5HUzpcIlRhZ19Qcm9maWxlX0lNX01zZ1NldHRpbmdzXCIsQURNSU5GT1JCSURUWVBFOlwiVGFnX1Byb2ZpbGVfSU1fQWRtaW5Gb3JiaWRUeXBlXCIsTEVWRUw6XCJUYWdfUHJvZmlsZV9JTV9MZXZlbFwiLFJPTEU6XCJUYWdfUHJvZmlsZV9JTV9Sb2xlXCJ9LEtlPXtVTktOT1dOOlwiR2VuZGVyX1R5cGVfVW5rbm93blwiLEZFTUFMRTpcIkdlbmRlcl9UeXBlX0ZlbWFsZVwiLE1BTEU6XCJHZW5kZXJfVHlwZV9NYWxlXCJ9LFdlPXtOT05FOlwiQWRtaW5Gb3JiaWRfVHlwZV9Ob25lXCIsU0VORF9PVVQ6XCJBZG1pbkZvcmJpZF9UeXBlX1NlbmRPdXRcIn0sWWU9e05FRURfQ09ORklSTTpcIkFsbG93VHlwZV9UeXBlX05lZWRDb25maXJtXCIsQUxMT1dfQU5ZOlwiQWxsb3dUeXBlX1R5cGVfQWxsb3dBbnlcIixERU5ZX0FOWTpcIkFsbG93VHlwZV9UeXBlX0RlbnlBbnlcIn0samU9XCJKb2luZWRTdWNjZXNzXCIsemU9XCJXYWl0QWRtaW5BcHByb3ZhbFwiLEplPVwiQFRHUyNfXCIsWGU9XCJAVE9QSUMjX1wiLFplPVtcInVybFwiXSxRZT1mdW5jdGlvbihlKXtyZXR1cm5cIm1hcFwiPT09bHQoZSl9LCRlPWZ1bmN0aW9uKGUpe3JldHVyblwiZmlsZVwiPT09bHQoZSl9LGV0PWZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT09ZSYmKFwibnVtYmVyXCI9PXR5cGVvZiBlJiYhaXNOYU4oZS0wKXx8XCJvYmplY3RcIj09PW4oZSkmJmUuY29uc3RydWN0b3I9PT1OdW1iZXIpfSxudD1mdW5jdGlvbihlKXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgZX0sb3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPT1lJiZcIm9iamVjdFwiPT09bihlKX0sc3Q9ZnVuY3Rpb24oZSl7aWYoXCJvYmplY3RcIiE9PW4oZSl8fG51bGw9PT1lKXJldHVybiExO3ZhciB0PU9iamVjdC5nZXRQcm90b3R5cGVPZihlKTtpZihudWxsPT09dClyZXR1cm4hMDtmb3IodmFyIG89dDtudWxsIT09T2JqZWN0LmdldFByb3RvdHlwZU9mKG8pOylvPU9iamVjdC5nZXRQcm90b3R5cGVPZihvKTtyZXR1cm4gdD09PW99LGF0PWZ1bmN0aW9uKGUpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIEFycmF5LmlzQXJyYXk/QXJyYXkuaXNBcnJheShlKTpcImFycmF5XCI9PT1sdChlKX0saXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWV9LHJ0PWZ1bmN0aW9uKGUpe3JldHVybiBhdChlKXx8b3QoZSl9LHV0PWZ1bmN0aW9uKGUpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIGV9LGN0PWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgRXJyb3J9LGx0PWZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSkubWF0Y2goL15cXFtvYmplY3QgKC4qKVxcXSQvKVsxXS50b0xvd2VyQ2FzZSgpfSxkdD1mdW5jdGlvbihlKXtpZihcInN0cmluZ1wiIT10eXBlb2YgZSlyZXR1cm4hMTt2YXIgdD1lWzBdO3JldHVybiEvW15hLXpBLVowLTldLy50ZXN0KHQpfTtEYXRlLm5vd3x8KERhdGUubm93PWZ1bmN0aW9uKCl7cmV0dXJuKG5ldyBEYXRlKS5nZXRUaW1lKCl9KTt2YXIgcHQ9ZnVuY3Rpb24gZSh0LG4sbyxzKXtpZighcnQodCl8fCFydChuKSlyZXR1cm4gMDtmb3IodmFyIGEsaT0wLHI9T2JqZWN0LmtleXMobiksdT0wLGM9ci5sZW5ndGg7dTxjO3UrKylpZihhPXJbdV0sIShpdChuW2FdKXx8byYmby5pbmNsdWRlcyhhKSkpaWYocnQodFthXSkmJnJ0KG5bYV0pKWkrPWUodFthXSxuW2FdLG8scyk7ZWxzZXtpZihzJiZzLmluY2x1ZGVzKG5bYV0pKWNvbnRpbnVlO3RbYV0hPT1uW2FdJiYodFthXT1uW2FdLGkrPTEpfXJldHVybiBpfSxndD1mdW5jdGlvbihlKXtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSxbXCJtZXNzYWdlXCIsXCJjb2RlXCJdKX0saHQ9ZnVuY3Rpb24oZSl7aWYoMD09PWUubGVuZ3RoKXJldHVybiAwO2Zvcih2YXIgdD0wLG49MCxvPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBkb2N1bWVudCYmdm9pZCAwIT09ZG9jdW1lbnQuY2hhcmFjdGVyU2V0P2RvY3VtZW50LmNoYXJhY3RlclNldDpcIlVURi04XCI7dm9pZCAwIT09ZVt0XTspbis9ZVt0KytdLmNoYXJDb2RlQXRbdF08PTI1NT8xOiExPT09bz8zOjI7cmV0dXJuIG59LF90PWZ1bmN0aW9uKGUpe3ZhciB0PWV8fDk5OTk5OTk5O3JldHVybiBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkqdCl9LGZ0PVwiMDEyMzQ1Njc4OWFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpcIix2dD1mdC5sZW5ndGgsbXQ9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG4gaW4gZSlpZihlW25dPT09dClyZXR1cm4hMDtyZXR1cm4hMX0sTXQ9e30seXQ9ZnVuY3Rpb24oZSl7cmV0dXJuLTE9PT1lLmluZGV4T2YoXCJodHRwOi8vXCIpfHwtMT09PWUuaW5kZXhPZihcImh0dHBzOi8vXCIpP1wiaHR0cHM6Ly9cIitlOmUucmVwbGFjZSgvaHR0cHN8aHR0cC8sXCJodHRwc1wiKX0sSXQ9ZnVuY3Rpb24gZSh0KXtpZigwPT09T2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModCkubGVuZ3RoKXJldHVybiBPYmplY3QuY3JlYXRlKG51bGwpO3ZhciBvPUFycmF5LmlzQXJyYXkodCk/W106T2JqZWN0LmNyZWF0ZShudWxsKSxzPVwiXCI7Zm9yKHZhciBhIGluIHQpbnVsbCE9PXRbYV0/dm9pZCAwIT09dFthXT8ocz1uKHRbYV0pLFtcInN0cmluZ1wiLFwibnVtYmVyXCIsXCJmdW5jdGlvblwiLFwiYm9vbGVhblwiXS5pbmRleE9mKHMpPj0wP29bYV09dFthXTpvW2FdPWUodFthXSkpOm9bYV09dm9pZCAwOm9bYV09bnVsbDtyZXR1cm4gb307ZnVuY3Rpb24gQ3QoZSx0KXtpZighYXQoZSl8fCFhdCh0KSlyZXR1cm4hMTt2YXIgbj0hMTtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgbz10LmtleSxzPXQudmFsdWUsYT1lLmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiBlLmtleT09PW99KSk7YT9hLnZhbHVlIT09cyYmKGEudmFsdWU9cyxuPSEwKTooZS5wdXNoKHtrZXk6byx2YWx1ZTpzfSksbj0hMCl9KSksbn12YXIgVHQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1FLkdSUF9BVkNIQVRST09NfSxEdD1mdW5jdGlvbihlKXt2YXIgdD1lLnR5cGUsbj1lLmdyb3VwSUQ7cmV0dXJuIHQ9PT1FLkdSUF9DT01NVU5JVFl8fFwiXCIuY29uY2F0KG4pLnN0YXJ0c1dpdGgoSmUpJiYhXCJcIi5jb25jYXQobikuaW5jbHVkZXMoWGUpfSxrdD1mdW5jdGlvbihlKXtyZXR1cm5cIlwiLmNvbmNhdChlKS5zdGFydHNXaXRoKEplKSYmXCJcIi5jb25jYXQoZSkuaW5jbHVkZXMoWGUpfSxFdD1mdW5jdGlvbihlKXtyZXR1cm4gbnQoZSkmJmUuc2xpY2UoMCwzKT09PUUuQ09OVl9DMkN9LFN0PWZ1bmN0aW9uKGUpe3JldHVybiBudChlKSYmZS5zbGljZSgwLDUpPT09RS5DT05WX0dST1VQfSxMdD1mdW5jdGlvbihlKXtyZXR1cm4gbnQoZSkmJmU9PT1FLkNPTlZfU1lTVEVNfTtmdW5jdGlvbiBBdChlLHQpe3ZhciBuPXt9O3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihvKXtuW29dPXQoZVtvXSxvKX0pKSxufWZ1bmN0aW9uIFJ0KGUpe3JldHVybiBhZT9uZXcgUHJvbWlzZSgoZnVuY3Rpb24odCxuKXtyZS5nZXRJbWFnZUluZm8oe3NyYzplLHN1Y2Nlc3M6ZnVuY3Rpb24oZSl7dCh7d2lkdGg6ZS53aWR0aCxoZWlnaHQ6ZS5oZWlnaHR9KX0sZmFpbDpmdW5jdGlvbigpe3Qoe3dpZHRoOjAsaGVpZ2h0OjB9KX19KX0pKTpJZSYmOT09PUNlP1Byb21pc2UucmVzb2x2ZSh7d2lkdGg6MCxoZWlnaHQ6MH0pOm5ldyBQcm9taXNlKChmdW5jdGlvbih0LG4pe3ZhciBvPW5ldyBJbWFnZTtvLm9ubG9hZD1mdW5jdGlvbigpe3Qoe3dpZHRoOnRoaXMud2lkdGgsaGVpZ2h0OnRoaXMuaGVpZ2h0fSksbz1udWxsfSxvLm9uZXJyb3I9ZnVuY3Rpb24oKXt0KHt3aWR0aDowLGhlaWdodDowfSksbz1udWxsfSxvLnNyYz1lfSkpfWZ1bmN0aW9uIE50KCl7ZnVuY3Rpb24gZSgpe3JldHVybig2NTUzNiooMStNYXRoLnJhbmRvbSgpKXwwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpfXJldHVyblwiXCIuY29uY2F0KGUoKStlKCkpLmNvbmNhdChlKCkpLmNvbmNhdChlKCkpLmNvbmNhdChlKCkpLmNvbmNhdChlKCkpLmNvbmNhdChlKCkpLmNvbmNhdChlKCkpfWZ1bmN0aW9uIE90KCl7dmFyIGU9XCJ1bmtub3duXCI7aWYoRWUmJihlPVwibWFjXCIpLGtlJiYoZT1cIndpbmRvd3NcIiksdmUmJihlPVwiaW9zXCIpLE1lJiYoZT1cImFuZHJvaWRcIiksYWUpdHJ5e3ZhciB0PXJlLmdldFN5c3RlbUluZm9TeW5jKCkucGxhdGZvcm07dm9pZCAwIT09dCYmKGU9dCl9Y2F0Y2gobil7fXJldHVybiBlfWZ1bmN0aW9uIEd0KGUsdCl7ZT1lLnNwbGl0KFwiLlwiKSx0PXQuc3BsaXQoXCIuXCIpO2Zvcih2YXIgbj1NYXRoLm1heChlLmxlbmd0aCx0Lmxlbmd0aCk7ZS5sZW5ndGg8bjspZS5wdXNoKFwiMFwiKTtmb3IoO3QubGVuZ3RoPG47KXQucHVzaChcIjBcIik7Zm9yKHZhciBvPTA7bzxuO28rKyl7dmFyIHM9cGFyc2VJbnQoZVtvXSksYT1wYXJzZUludCh0W29dKTtpZihzPmEpcmV0dXJuIDE7aWYoczxhKXJldHVybi0xfXJldHVybiAwfWZ1bmN0aW9uIFV0KGUpe3ZhciB0PWUub3JpZ2luVXJsLG49dm9pZCAwPT09dD92b2lkIDA6dCxvPWUub3JpZ2luV2lkdGgscz1lLm9yaWdpbkhlaWdodCxhPWUubWluLGk9dm9pZCAwPT09YT8xOTg6YSxyPXBhcnNlSW50KG8pLHU9cGFyc2VJbnQocyksYz17dXJsOnZvaWQgMCx3aWR0aDowLGhlaWdodDowfTtpZigocjw9dT9yOnUpPD1pKWMudXJsPW4sYy53aWR0aD1yLGMuaGVpZ2h0PXU7ZWxzZXt1PD1yPyhjLndpZHRoPU1hdGguY2VpbChyKmkvdSksYy5oZWlnaHQ9aSk6KGMud2lkdGg9aSxjLmhlaWdodD1NYXRoLmNlaWwodSppL3IpKTt2YXIgbD1uJiZuLmluZGV4T2YoXCI/XCIpPi0xP1wiXCIuY29uY2F0KG4sXCImXCIpOlwiXCIuY29uY2F0KG4sXCI/XCIpO2MudXJsPVwiXCIuY29uY2F0KGwsMTk4PT09aT9cImltYWdlVmlldzIvMy93LzE5OC9oLzE5OFwiOlwiaW1hZ2VWaWV3Mi8zL3cvNzIwL2gvNzIwXCIpfXJldHVybiBpdChuKT8oYy51cmwsZyhjLFplKSk6Y31mdW5jdGlvbiBQdChlKXt2YXIgdD1lWzJdO2VbMl09ZVsxXSxlWzFdPXQ7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKyspZVtuXS5zZXRUeXBlKG4pfWZ1bmN0aW9uIGJ0KGUpe3ZhciB0PWUuc2VydmNtZDtyZXR1cm4gdC5zbGljZSh0LmluZGV4T2YoXCIuXCIpKzEpfWZ1bmN0aW9uIHd0KGUsdCl7cmV0dXJuIE1hdGgucm91bmQoTnVtYmVyKGUpKk1hdGgucG93KDEwLHQpKS9NYXRoLnBvdygxMCx0KX1mdW5jdGlvbiBGdChlLHQpe3JldHVybiBlLmluY2x1ZGVzKHQpfWZ1bmN0aW9uIHF0KGUsdCl7cmV0dXJuIGUuaW5jbHVkZXModCl9ZnVuY3Rpb24geHQoZSl7cmV0dXJuIGUuc3BsaXQoWGUpWzBdfXZhciBWdD1mdW5jdGlvbihlLHQsbil7aWYoaXQodCkpcmV0dXJuXCJcIjtzd2l0Y2goZSl7Y2FzZSBFLk1TR19URVhUOnJldHVybiB0LnRleHQ7Y2FzZSBFLk1TR19JTUFHRTpyZXR1cm4gbj9cIltJbWFnZV1cIjpcIlvlm77niYddXCI7Y2FzZSBFLk1TR19MT0NBVElPTjpyZXR1cm4gbj9cIltMb2NhdGlvbl1cIjpcIlvkvY3nva5dXCI7Y2FzZSBFLk1TR19BVURJTzpyZXR1cm4gbj9cIltWb2ljZV1cIjpcIlvor63pn7NdXCI7Y2FzZSBFLk1TR19WSURFTzpyZXR1cm4gbj9cIltWaWRlb11cIjpcIlvop4bpopFdXCI7Y2FzZSBFLk1TR19GSUxFOnJldHVybiBuP1wiW0ZpbGVdXCI6XCJb5paH5Lu2XVwiO2Nhc2UgRS5NU0dfQ1VTVE9NOnJldHVybiBuP1wiW0N1c3RvbSBNZXNzYWdlc11cIjpcIlvoh6rlrprkuYnmtojmga9dXCI7Y2FzZSBFLk1TR19HUlBfVElQOnJldHVybiBuP1wiW0dyb3VwIE5vdGlmaWNhdGlvbl1cIjpcIlvnvqTmj5DnpLrmtojmga9dXCI7Y2FzZSBFLk1TR19HUlBfU1lTX05PVElDRTpyZXR1cm4gbj9cIltHcm91cCBTeXN0ZW0gTWVzc2FnZV1cIjpcIlvnvqTns7vnu5/pgJrnn6VdXCI7Y2FzZSBFLk1TR19GQUNFOnJldHVybiBuP1wiW0FuaW1hdGVkIFN0aWNrZXJdXCI6XCJb5Yqo55S76KGo5oOFXVwiO2Nhc2UgRS5NU0dfTUVSR0VSOnJldHVybiBuP1wiW0NoYXQgUmVjb3JkXVwiOlwiW+iBiuWkqeiusOW9lV1cIjtkZWZhdWx0OnJldHVyblwiXCJ9fTtmdW5jdGlvbiBCdChlKXtyZXR1cm4gZT09PUUuTVNHX1RFWFR8fGU9PT1FLk1TR19DVVNUT018fGU9PT1FLk1TR19MT0NBVElPTnx8ZT09PUUuTVNHX0ZBQ0V9ZnVuY3Rpb24gSHQoZSl7dmFyIHQ9W107aWYoIW50KGUpKXJldHVybiB0O3ZhciBuPWUubGVuZ3RoO2lmKDA9PT1uKXJldHVybiB0O2Zvcih2YXIgbz1uLTE7bz49MDtvLS0pXCIxXCI9PT1lW29dJiZ0LnB1c2goTWF0aC5wb3coMixuLW8tMSkpO3JldHVybiB0fWZ1bmN0aW9uIEt0KCl7cmV0dXJuIUllJiYhYWV9ZnVuY3Rpb24gV3QoZSl7cmV0dXJuXCJ0aGUgbGVuZ3RoIG9mIHVzZXJJRExpc3QgY2Fubm90IGV4Y2VlZCBcIi5jb25jYXQoZSl9ZnVuY3Rpb24gWXQoZSx0KXtpZihlKXt2YXIgbj1lO3JldHVybiB0JiYoZS5zdGFydHNXaXRoKFwiaHR0cDovL1wiKT9uPWUucmVwbGFjZSgvXmh0dHA6XFwvXFwvW14vXSsvLHQpOmUuc3RhcnRzV2l0aChcImh0dHBzOi8vXCIpJiYobj1lLnJlcGxhY2UoL15odHRwczpcXC9cXC9bXi9dKy8sdCkpKSxufX12YXIganQ9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtmdW5jdGlvbiB6dChlKXtpZihudWxsPT1lKXJldHVybiEwO2lmKFwiYm9vbGVhblwiPT10eXBlb2YgZSlyZXR1cm4hMTtpZihcIm51bWJlclwiPT10eXBlb2YgZSlyZXR1cm4gMD09PWU7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpcmV0dXJuIDA9PT1lLmxlbmd0aDtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBlKXJldHVybiAwPT09ZS5sZW5ndGg7aWYoQXJyYXkuaXNBcnJheShlKSlyZXR1cm4gMD09PWUubGVuZ3RoO2lmKGUgaW5zdGFuY2VvZiBFcnJvcilyZXR1cm5cIlwiPT09ZS5tZXNzYWdlO2lmKHN0KGUpKXtmb3IodmFyIHQgaW4gZSlpZihqdC5jYWxsKGUsdCkpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuISghUWUoZSkmJihuPWUsXCJzZXRcIiE9PWx0KG4pKSYmISRlKGUpKSYmMD09PWUuc2l6ZTt2YXIgbn1mdW5jdGlvbiBKdChlLHQsbil7aWYodm9pZCAwPT09dClyZXR1cm4hMDt2YXIgbz0hMDtpZihzdCh0KSlPYmplY3Qua2V5cyh0KS5mb3JFYWNoKChmdW5jdGlvbihzKXt2YXIgYT0xPT09ZS5sZW5ndGg/ZVswXVtzXTp2b2lkIDA7bz0hIVh0KGEsdFtzXSxuLHMpJiZvfSkpO2Vsc2UgaWYoYXQodCkpZm9yKHZhciBzPTA7czx0Lmxlbmd0aDtzKyspbz0hIVh0KGVbc10sdFtzXSxuLHRbc10ubmFtZSkmJm87aWYobylyZXR1cm4gbzt0aHJvdyBuZXcgRXJyb3IoXCJQYXJhbXMgdmFsaWRhdGUgZmFpbGVkLlwiKX1mdW5jdGlvbiBYdChlLHQsbixvKXtpZih2b2lkIDA9PT10KXJldHVybiEwO3ZhciBzPSEwO2lmKHQucmVxdWlyZWQmJnp0KGUpJiYoVmUuZShcIltcIi5jb25jYXQobiwnXSBNaXNzaW5nIHJlcXVpcmVkIHBhcmFtczogXCInKS5jb25jYXQobywnXCIuJykpLHM9ITEpLCF6dChlKSl7dmFyIGE9bHQoZSksaT10LnR5cGUudG9Mb3dlckNhc2UoKTthIT09aSYmKFwiYXN5bmNmdW5jdGlvblwiPT09YSYmXCJmdW5jdGlvblwiPT09aXx8KFZlLmUoXCJbXCIuY29uY2F0KG4sJ10gSW52YWxpZCBwYXJhbXM6IHR5cGUgY2hlY2sgZmFpbGVkIGZvciBcIicpLmNvbmNhdChvLCdcIi5FeHBlY3RlZCAnKS5jb25jYXQodC50eXBlLFwiLlwiKSkscz0hMSkpfXJldHVybiB0LnZhbGlkYXRvciYmIXQudmFsaWRhdG9yKGUpJiYoVmUuZShcIltcIi5jb25jYXQobixcIl0gSW52YWxpZCBwYXJhbXM6IGN1c3RvbSB2YWxpZGF0b3IgY2hlY2sgZmFpbGVkIGZvciBwYXJhbXMuXCIpKSxzPSExKSxzfXZhciBadCxRdD17VU5TRU5EOlwidW5TZW5kXCIsU1VDQ0VTUzpcInN1Y2Nlc3NcIixGQUlMOlwiZmFpbFwifSwkdD17Tk9UX1NUQVJUOlwibm90U3RhcnRcIixQRU5ESU5HOlwicGVuZGluZ1wiLFJFU09MVkVEOlwicmVzb2x2ZWRcIixSRUpFQ1RFRDpcInJlamVjdGVkXCJ9LGVuPWZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybiExO2lmKEV0KGUpfHxTdChlKXx8THQoZSkpcmV0dXJuITA7dmFyIHQ9U24oXCJJbnZhbGlkQ29udmVyc2F0aW9uSURcIixlKTtyZXR1cm4gdCYmVmUudyh0KSwhMX0sdG49ZnVuY3Rpb24oZSl7XCJcIiE9PWUuZGVzYyYmXCJcIiE9PVNuKFwiQVBJX1JFRkVSXCIpJiZWZS53KFwiW1wiLmNvbmNhdChlLmFwaSxcIl0gfCBcIikuY29uY2F0KGUucGFyYW0sXCIgfCBcIikuY29uY2F0KGUuZGVzYyxcIiwgXCIpLmNvbmNhdChTbihcIkFQSV9SRUZFUlwiKSkuY29uY2F0KGUuYXBpKSl9LG5uPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiU3RyaW5nUmVxdWlyZWRMb2dcIil9LG9uPWZ1bmN0aW9uKGUpe3JldHVybiBTbihcIk5vbkVtcHR5U3RyaW5nUmVxdWlyZWRMb2dcIixlKX0sc249ZnVuY3Rpb24oKXtyZXR1cm4gU24oXCJOdW1iZXJSZXF1aXJlZExvZ1wiKX0sYW49ZnVuY3Rpb24oKXtyZXR1cm4gU24oXCJVbmRlZmluZWROb3RBbGxvd2VkTG9nXCIpfSxybj1mdW5jdGlvbigpe3JldHVybiBTbihcIkZpbGVSZXF1aXJlZExvZ1wiKX0sdW49ZnVuY3Rpb24oKXtyZXR1cm4gU24oXCJGdW5jdGlvblJlcXVpcmVkTG9nXCIpfSxjbj1mdW5jdGlvbigpe3JldHVybiBTbihcIkFycmF5UmVxdWlyZWRMb2dcIil9LGxuPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiTm9uRW1wdHlBcnJheUxvZ1wiKX0sZG49ZnVuY3Rpb24oKXtyZXR1cm4gU24oXCJDYWxsYmFja01pc3NpbmdMb2dcIil9LHBuPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiUG9zaXRpdmVJbnRlZ2VyUmVxdWlyZWRMb2dcIil9LGduPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIFNuKFwiU3RyaW5nTm90TG9uZ2VyVGhhbkxvZ1wiLGUsdCl9LGhuPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIFNuKFwiTnVtYmVyTGVzc1RoYW5Mb2dcIixlLHQpfSxfbj1mdW5jdGlvbihlKXtyZXR1cm4gU24oXCJLZXlWYWx1ZVN0cmluZ1JlcXVpcmVkTG9nXCIsZSl9LGZuPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiUGxhaW5PYmplY3RSZXF1aXJlZExvZ1wiKX0sdm49ZnVuY3Rpb24oKXtyZXR1cm4gU24oXCJOb25FbXB0eUNvbnRlbnRSZXF1aXJlZExvZ1wiKX0sbW49ZnVuY3Rpb24oKXtyZXR1cm4gU24oXCJGaWxlTm90U2VsZWN0ZWRMb2dcIil9LE1uPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiTWVzc2FnZUluc3RhbmNlUmVxdWlyZWRMb2dcIil9LHluPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiTm9uQW5vbnltb3VzRnVuY3Rpb25Mb2dcIil9LEluPWZ1bmN0aW9uKCl7cmV0dXJuIFNuKFwiTWVzc2FnZUV4dGVuc2lvbk5vdEF2YWlsYWJsZUxvZ1wiKX0sQ249e3R5cGU6XCJTdHJpbmdcIixyZXF1aXJlZDohMH0sVG49e3R5cGU6XCJBcnJheVwiLHJlcXVpcmVkOiEwfSxEbj17dHlwZTpcIk9iamVjdFwiLHJlcXVpcmVkOiEwfSxrbj17dHlwZTpcIkJvb2xlYW5cIixyZXF1aXJlZDohMH0sRW49e3R5cGU6XCJudW1iZXJcIixyZXF1aXJlZDohMH0sU249bnVsbCxMbj17aG9va0dldEFQSVRpcHM6ZnVuY3Rpb24oZSl7U249ZX0sbG9naW46e3VzZXJJRDpDbix1c2VyU2lnOkNufSxhZGRUb0JsYWNrbGlzdDp7dXNlcklETGlzdDpUbn0scmVtb3ZlRnJvbUJsYWNrbGlzdDp7dXNlcklETGlzdDpUbn0sb246W3tuYW1lOlwiZXZlbnROYW1lXCIsdHlwZTpcIlN0cmluZ1wiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgZSYmMCE9PWUubGVuZ3RofHwodG4oe2FwaTpcIm9uXCIscGFyYW06XCJldmVudE5hbWVcIixkZXNjOm9uKFwiZXZlbnROYW1lXCIpfSksITEpfX0se25hbWU6XCJoYW5kbGVyXCIsdHlwZTpcIkZ1bmN0aW9uXCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVyblwiZnVuY3Rpb25cIiE9dHlwZW9mIGU/KHRuKHthcGk6XCJvblwiLHBhcmFtOlwiaGFuZGxlclwiLGRlc2M6dW4oKX0pLCExKTooXCJcIj09PWUubmFtZSYmdG4oe2FwaTpcIm9uXCIscGFyYW06XCJoYW5kbGVyXCIsZGVzYzp5bigpfSksITApfX1dLG9uY2U6W3tuYW1lOlwiZXZlbnROYW1lXCIsdHlwZTpcIlN0cmluZ1wiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgZSYmMCE9PWUubGVuZ3RofHwodG4oe2FwaTpcIm9uY2VcIixwYXJhbTpcImV2ZW50TmFtZVwiLGRlc2M6b24oXCJldmVudE5hbWVcIil9KSwhMSl9fSx7bmFtZTpcImhhbmRsZXJcIix0eXBlOlwiRnVuY3Rpb25cIix2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuXCJmdW5jdGlvblwiIT10eXBlb2YgZT8odG4oe2FwaTpcIm9uY2VcIixwYXJhbTpcImhhbmRsZXJcIixkZXNjOnVuKCl9KSwhMSk6KFwiXCI9PT1lLm5hbWUmJnRuKHthcGk6XCJvbmNlXCIscGFyYW06XCJoYW5kbGVyXCIsZGVzYzp5bigpfSksITApfX1dLG9mZjpbe25hbWU6XCJldmVudE5hbWVcIix0eXBlOlwiU3RyaW5nXCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBlJiYwIT09ZS5sZW5ndGh8fCh0bih7YXBpOlwib2ZmXCIscGFyYW06XCJldmVudE5hbWVcIixkZXNjOm9uKFwiZXZlbnROYW1lXCIpfSksITEpfX0se25hbWU6XCJoYW5kbGVyXCIsdHlwZTpcIkZ1bmN0aW9uXCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVyblwiZnVuY3Rpb25cIiE9dHlwZW9mIGU/KHRuKHthcGk6XCJvZmZcIixwYXJhbTpcImhhbmRsZXJcIixkZXNjOnVuKCl9KSwhMSk6KFwiXCI9PT1lLm5hbWUmJnRuKHthcGk6XCJvZmZcIixwYXJhbTpcImhhbmRsZXJcIixkZXNjOnluKCl9KSwhMCl9fV0sc2VuZE1lc3NhZ2U6W3Qoe25hbWU6XCJtZXNzYWdlXCJ9LERuKV0sc2V0TWVzc2FnZUV4dGVuc2lvbnM6W3QodCh7bmFtZTpcIm1lc3NhZ2VcIn0sRG4pLHt9LHt2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc3RhdHVzPT09UXQuU1VDQ0VTUyYmITA9PT1lLmlzU3VwcG9ydEV4dGVuc2lvbnx8KHRuKHthcGk6XCJzZXRNZXNzYWdlRXh0ZW5zaW9uc1wiLHBhcmFtOlwibWVzc2FnZVwiLGRlc2M6SW4oKX0pLCExKX19KSx0KHtuYW1lOlwiZXh0ZW5zaW9uc1wifSxUbildLGdldE1lc3NhZ2VFeHRlbnNpb25zOlt0KHQoe25hbWU6XCJtZXNzYWdlXCJ9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBlLnN0YXR1cz09PVF0LlNVQ0NFU1MmJiEwPT09ZS5pc1N1cHBvcnRFeHRlbnNpb258fCh0bih7YXBpOlwiZ2V0TWVzc2FnZUV4dGVuc2lvbnNcIixwYXJhbTpcIm1lc3NhZ2VcIixkZXNjOkluKCl9KSwhMSl9fSldLGRlbGV0ZU1lc3NhZ2VFeHRlbnNpb25zOlt0KHQoe25hbWU6XCJtZXNzYWdlXCJ9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBlLnN0YXR1cz09PVF0LlNVQ0NFU1MmJiEwPT09ZS5pc1N1cHBvcnRFeHRlbnNpb258fCh0bih7YXBpOlwiZGVsZXRlTWVzc2FnZUV4dGVuc2lvbnNcIixwYXJhbTpcIm1lc3NhZ2VcIixkZXNjOkluKCl9KSwhMSl9fSldLGdldE1lc3NhZ2VMaXN0Ontjb252ZXJzYXRpb25JRDp0KHQoe30sQ24pLHt9LHt2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIGVuKGUpfX0pLG5leHRSZXFNZXNzYWdlSUQ6e3R5cGU6XCJTdHJpbmdcIn0sY291bnQ6e3R5cGU6XCJOdW1iZXJcIix2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuISghaXQoZSkmJiEvXlsxLTldWzAtOV0qJC8udGVzdChlKSl8fCh0bih7YXBpOlwiZ2V0TWVzc2FnZUxpc3RcIixwYXJhbTpcImNvdW50XCIsZGVzYzpwbigpfSksITEpfX19LGdldE1lc3NhZ2VMaXN0SG9wcGluZzp7Y29udmVyc2F0aW9uSUQ6dCh0KHt9LENuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBlbihlKX19KSxzZXF1ZW5jZTp7dHlwZTpcIk51bWJlclwifSx0aW1lOnt0eXBlOlwiTnVtYmVyXCJ9LGRpcmVjdGlvbjp7dHlwZTpcIk51bWJlclwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hKCFpdChlKSYmMCE9PWUmJjEhPT1lKXx8KHRuKHthcGk6XCJnZXRNZXNzYWdlTGlzdEhvcHBpbmdcIixwYXJhbTpcImRpcmVjdGlvblwiLGRlc2M6U24oXCIwT3IxUmVxdWlyZWRMb2dcIil9KSwhMSl9fSxjb3VudDp7dHlwZTpcIk51bWJlclwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hKCFpdChlKSYmIS9eWzEtOV1bMC05XSokLy50ZXN0KGUpKXx8KHRuKHthcGk6XCJnZXRNZXNzYWdlTGlzdEhvcHBpbmdcIixwYXJhbTpcImNvdW50XCIsZGVzYzpwbn0pLCExKX19fSxzZXRNZXNzYWdlUmVhZDp7Y29udmVyc2F0aW9uSUQ6dCh0KHt9LENuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBlbihlKX19KX0sc2V0QWxsTWVzc2FnZVJlYWQ6e3Njb3BlOnt0eXBlOlwiU3RyaW5nXCIscmVxdWlyZWQ6ITEsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiFlfHwtMSE9PVtFLlJFQURfQUxMX0MyQ19NU0csRS5SRUFEX0FMTF9HUk9VUF9NU0csRS5SRUFEX0FMTF9NU0ddLmluZGV4T2YoZSl8fCh0bih7YXBpOlwic2V0QWxsTWVzc2FnZVJlYWRcIixwYXJhbTpcInNjb3BlXCIsZGVzYzpcIlRJTS5UWVBFUy5SRUFEX0FMTF9DMkNfTVNHIG9yIFRJTS5UWVBFUy5SRUFEX0FMTF9HUk9VUF9NU0cgb3IgVElNLlRZUEVTLlJFQURfQUxMX01TRyByZXF1aXJlZFwifSksITEpfX19LGdldENvbnZlcnNhdGlvblByb2ZpbGU6W3QodCh7bmFtZTpcImNvbnZlcnNhdGlvbklEXCJ9LENuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBlbihlKX19KV0sY2xlYXJIaXN0b3J5TWVzc2FnZTpbdCh0KHtuYW1lOlwiY29udmVyc2F0aW9uSURcIn0sQ24pLHt9LHt2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIGVuKGUpfX0pXSxwaW5Db252ZXJzYXRpb246e2NvbnZlcnNhdGlvbklEOnQodCh7fSxDbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gZW4oZSl9fSksaXNQaW5uZWQ6dCh7fSxrbil9LHNldENvbnZlcnNhdGlvbkN1c3RvbURhdGE6e2NvbnZlcnNhdGlvbklETGlzdDp0KHt9LFRuKSxjdXN0b21EYXRhOnt0eXBlOlwiU3RyaW5nXCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBudChlKT8hKGUubGVuZ3RoPjI1Nil8fCh0bih7YXBpOlwic2V0Q29udmVyc2F0aW9uQ3VzdG9tRGF0YVwiLHBhcmFtOlwiY3VzdG9tRGF0YVwiLGRlc2M6Z24oXCJjdXN0b21EYXRhXCIsMjU2KX0pLCExKToodG4oe2FwaTpcInNldENvbnZlcnNhdGlvbkN1c3RvbURhdGFcIixwYXJhbTpcImN1c3RvbURhdGFcIixkZXNjOm5uKCl9KSwhMSl9fX0sbWFya0NvbnZlcnNhdGlvbjp7Y29udmVyc2F0aW9uSURMaXN0OnQoe30sVG4pLG1hcmtUeXBlOnt0eXBlOlwibnVtYmVyXCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBldChlKT9lPD0wPyh0bih7YXBpOlwibWFya0NvbnZlcnNhdGlvblwiLHBhcmFtOlwibWFya1R5cGVcIixkZXNjOih0PVwibWFya1R5cGVcIixuPTAsU24oXCJOdW1iZXJHcmVhdGVyVGhhbkxvZ1wiLHQsbikpfSksITEpOiEoZT49TWF0aC5wb3coMiw2NCkpfHwodG4oe2FwaTpcIm1hcmtDb252ZXJzYXRpb25cIixwYXJhbTpcIm1hcmtUeXBlXCIsZGVzYzpobihcIm1hcmtUeXBlXCIsXCJNYXRoLnBvdygyLDY0KVwiKX0pLCExKToodG4oe2FwaTpcIm1hcmtDb252ZXJzYXRpb25cIixwYXJhbTpcIm1hcmtUeXBlXCIsZGVzYzpzbigpfSksITEpO3ZhciB0LG59fSxlbmFibGVNYXJrOnQoe30sa24pfSxjcmVhdGVDb252ZXJzYXRpb25Hcm91cDp7Y29udmVyc2F0aW9uSURMaXN0OnQoe30sVG4pLGdyb3VwTmFtZTp0KHQoe30sQ24pLHt9LHt2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuISFlJiYoIShlLmxlbmd0aD4zMil8fCh0bih7YXBpOlwiY3JlYXRlQ29udmVyc2F0aW9uR3JvdXBcIixwYXJhbTpcImdyb3VwTmFtZVwiLGRlc2M6Z24oXCJncm91cE5hbWVcIiwzMil9KSwhMSkpfX0pfSxkZWxldGVDb252ZXJzYXRpb25Hcm91cDpbdCh7bmFtZTpcImdyb3VwTmFtZVwifSxDbildLHJlbmFtZUNvbnZlcnNhdGlvbkdyb3VwOntvbGROYW1lOnQoe30sQ24pLG5ld05hbWU6dCh0KHt9LENuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiEhZSYmKCEoZS5sZW5ndGg+MzIpfHwodG4oe2FwaTpcInJlbmFtZUNvbnZlcnNhdGlvbkdyb3VwXCIscGFyYW06XCJuZXdOYW1lXCIsZGVzYzpnbihcIm5ld05hbWVcIiwzMil9KSwhMSkpfX0pfSxhZGRDb252ZXJzYXRpb25zVG9Hcm91cDp7Y29udmVyc2F0aW9uSURMaXN0OnQoe30sVG4pLGdyb3VwTmFtZTp0KHt9LENuKX0sZGVsZXRlQ29udmVyc2F0aW9uc0Zyb21Hcm91cDp7Y29udmVyc2F0aW9uSURMaXN0OnQoe30sVG4pLGdyb3VwTmFtZTp0KHt9LENuKX0sZ2V0R3JvdXBMaXN0Ontncm91cFByb2ZpbGVGaWx0ZXI6e3R5cGU6XCJBcnJheVwifX0sZ2V0R3JvdXBQcm9maWxlOntncm91cElEOkNuLGdyb3VwQ3VzdG9tRmllbGRGaWx0ZXI6e3R5cGU6XCJBcnJheVwifSxtZW1iZXJDdXN0b21GaWVsZEZpbHRlcjp7dHlwZTpcIkFycmF5XCJ9fSxnZXRHcm91cFByb2ZpbGVBZHZhbmNlOntncm91cElETGlzdDpUbn0sY3JlYXRlR3JvdXA6e25hbWU6Q259LGpvaW5Hcm91cDp7Z3JvdXBJRDpDbix0eXBlOnt0eXBlOlwiU3RyaW5nXCJ9LGFwcGx5TWVzc2FnZTp7dHlwZTpcIlN0cmluZ1wifX0scXVpdEdyb3VwOlt0KHtuYW1lOlwiZ3JvdXBJRFwifSxDbildLGhhbmRsZUFwcGxpY2F0aW9uOnttZXNzYWdlOkRuLGhhbmRsZUFjdGlvbjpDbixoYW5kbGVNZXNzYWdlOnt0eXBlOlwiU3RyaW5nXCJ9fSxjaGFuZ2VHcm91cE93bmVyOntncm91cElEOkNuLG5ld093bmVySUQ6Q259LHVwZGF0ZUdyb3VwUHJvZmlsZTp7Z3JvdXBJRDpDbixtdXRlQWxsTWVtYmVyczp7dHlwZTpcIkJvb2xlYW5cIn19LGRpc21pc3NHcm91cDpbdCh7bmFtZTpcImdyb3VwSURcIn0sQ24pXSxzZWFyY2hHcm91cEJ5SUQ6W3Qoe25hbWU6XCJncm91cElEXCJ9LENuKV0saW5pdEdyb3VwQXR0cmlidXRlczp7Z3JvdXBJRDpDbixncm91cEF0dHJpYnV0ZXM6dCh0KHt9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3ZhciB0PSEwO3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihuKXtpZighbnQoZVtuXSkpcmV0dXJuIHRuKHthcGk6XCJpbml0R3JvdXBBdHRyaWJ1dGVzXCIscGFyYW06XCJncm91cEF0dHJpYnV0ZXNcIixkZXNjOl9uKFwidmFsdWVcIil9KSx0PSExfSkpLHR9fSl9LHNldEdyb3VwQXR0cmlidXRlczp7Z3JvdXBJRDpDbixncm91cEF0dHJpYnV0ZXM6dCh0KHt9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3ZhciB0PSEwO3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihuKXtpZighbnQoZVtuXSkpcmV0dXJuIHRuKHthcGk6XCJzZXRHcm91cEF0dHJpYnV0ZXNcIixwYXJhbTpcImdyb3VwQXR0cmlidXRlc1wiLGRlc2M6X24oXCJ2YWx1ZVwiKX0pLHQ9ITF9KSksdH19KX0sZGVsZXRlR3JvdXBBdHRyaWJ1dGVzOntncm91cElEOkNuLGtleUxpc3Q6e3R5cGU6XCJBcnJheVwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtpZihpdChlKXx8IWF0KGUpKXJldHVybiB0bih7YXBpOlwiZGVsZXRlR3JvdXBBdHRyaWJ1dGVzXCIscGFyYW06XCJrZXlMaXN0XCIsZGVzYzpjbigpfSksITE7aWYoIXp0KGUpKXt2YXIgdD0hMDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXtpZighbnQoZSkpcmV0dXJuIHRuKHthcGk6XCJkZWxldGVHcm91cEF0dHJpYnV0ZXNcIixwYXJhbTpcImtleUxpc3RcIixkZXNjOlNuKFwiU3RyaW5nQXJyYXlSZXF1aXJlZExvZ1wiKX0pLHQ9ITF9KSksdH1yZXR1cm4hMH19fSxnZXRHcm91cEF0dHJpYnV0ZXM6e2dyb3VwSUQ6Q24sa2V5TGlzdDp7dHlwZTpcIkFycmF5XCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe2lmKGl0KGUpfHwhYXQoZSkpcmV0dXJuIHRuKHthcGk6XCJnZXRHcm91cEF0dHJpYnV0ZXNcIixwYXJhbTpcImtleUxpc3RcIixkZXNjOmNuKCl9KSwhMTtpZighenQoZSkpe3ZhciB0PSEwO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKCFudChlKSlyZXR1cm4gdG4oe2FwaTpcImdldEdyb3VwQXR0cmlidXRlc1wiLHBhcmFtOlwia2V5TGlzdFwiLGRlc2M6X24oXCJrZXlcIil9KSx0PSExfSkpLHR9cmV0dXJuITB9fX0sc2V0R3JvdXBDb3VudGVyczp7Z3JvdXBJRDpDbixjb3VudGVyczpEbn0saW5jcmVhc2VHcm91cENvdW50ZXI6e2dyb3VwSUQ6Q24sa2V5OkNuLHZhbHVlOkVufSxkZWNyZWFzZUdyb3VwQ291bnRlcjp7Z3JvdXBJRDpDbixrZXk6Q24sdmFsdWU6RW59LGdldEdyb3VwQ291bnRlcnM6e2dyb3VwSUQ6Q259LGdldEdyb3VwTWVtYmVyTGlzdDp7Z3JvdXBJRDpDbixjb3VudDp7dHlwZTpcIk51bWJlclwifX0sZ2V0R3JvdXBNZW1iZXJQcm9maWxlOntncm91cElEOkNuLHVzZXJJRExpc3Q6VG4sbWVtYmVyQ3VzdG9tRmllbGRGaWx0ZXI6e3R5cGU6XCJBcnJheVwifX0sYWRkR3JvdXBNZW1iZXI6e2dyb3VwSUQ6Q24sdXNlcklETGlzdDpUbn0sc2V0R3JvdXBNZW1iZXJSb2xlOntncm91cElEOkNuLHVzZXJJRDpDbixyb2xlOkNufSxzZXRHcm91cE1lbWJlck11dGVUaW1lOntncm91cElEOkNuLHVzZXJJRDpDbixtdXRlVGltZTp7dHlwZTpcIk51bWJlclwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gZT49MH19fSxzZXRHcm91cE1lbWJlck5hbWVDYXJkOntncm91cElEOkNuLHVzZXJJRDp7dHlwZTpcIlN0cmluZ1wifSxuYW1lQ2FyZDp7dHlwZTpcIlN0cmluZ1wiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gbnQoZSk/KGUubGVuZ3RoLCEwKToodG4oe2FwaTpcInNldEdyb3VwTWVtYmVyTmFtZUNhcmRcIixwYXJhbTpcIm5hbWVDYXJkXCIsZGVzYzpubigpfSksITEpfX19LHNldEdyb3VwTWVtYmVyQ3VzdG9tRmllbGQ6e2dyb3VwSUQ6Q24sdXNlcklEOnt0eXBlOlwiU3RyaW5nXCJ9LG1lbWJlckN1c3RvbUZpZWxkOlRufSxkZWxldGVHcm91cE1lbWJlcjp7Z3JvdXBJRDpDbn0sbWFya0dyb3VwTWVtYmVyTGlzdDp7Z3JvdXBJRDpDbixtYXJrVHlwZTp7dHlwZTpcIm51bWJlclwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gZXQoZSk/IShlPDFlMyl8fCh0bih7YXBpOlwibWFya0dyb3VwTWVtYmVyTGlzdFwiLHBhcmFtOlwibWFya1R5cGVcIixkZXNjOih0PVwibWFya1R5cGVcIixuPTFlMyxTbihcIk51bWJlckdyZWF0ZXJPckVxdWFsTG9nXCIsdCxuKSl9KSwhMSk6KHRuKHthcGk6XCJtYXJrR3JvdXBNZW1iZXJMaXN0XCIscGFyYW06XCJtYXJrVHlwZVwiLGRlc2M6c24oKX0pLCExKTt2YXIgdCxufX0sdXNlcklETGlzdDp0KHt9LFRuKSxlbmFibGVNYXJrOnQoe30sa24pfSxjcmVhdGVUZXh0TWVzc2FnZTp7dG86Q24sY29udmVyc2F0aW9uVHlwZTpDbixwYXlsb2FkOnQodCh7fSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gc3QoZSk/bnQoZS50ZXh0KT8wIT09ZS50ZXh0Lmxlbmd0aHx8KHRuKHthcGk6XCJjcmVhdGVUZXh0TWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC50ZXh0XCIsZGVzYzp2bigpfSksITEpOih0bih7YXBpOlwiY3JlYXRlVGV4dE1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQudGV4dFwiLGRlc2M6bm4oKX0pLCExKToodG4oe2FwaTpcImNyZWF0ZVRleHRNZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkXCIsZGVzYzpmbigpfSksITEpfX0pfSxjcmVhdGVUZXh0QXRNZXNzYWdlOnt0bzpDbixjb252ZXJzYXRpb25UeXBlOkNuLHBheWxvYWQ6dCh0KHt9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBzdChlKT9udChlLnRleHQpPzA9PT1lLnRleHQubGVuZ3RoPyh0bih7YXBpOlwiY3JlYXRlVGV4dEF0TWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC50ZXh0XCIsZGVzYzp2bigpfSksITEpOiEoZS5hdFVzZXJMaXN0JiYhYXQoZS5hdFVzZXJMaXN0KSl8fCh0bih7YXBpOlwiY3JlYXRlVGV4dEF0TWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5hdFVzZXJMaXN0XCIsZGVzYzpjbigpfSksITEpOih0bih7YXBpOlwiY3JlYXRlVGV4dEF0TWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC50ZXh0XCIsZGVzYzpubigpfSksITEpOih0bih7YXBpOlwiY3JlYXRlVGV4dEF0TWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZFwiLGRlc2M6Zm4oKX0pLCExKX19KX0sY3JlYXRlQ3VzdG9tTWVzc2FnZTp7dG86Q24sY29udmVyc2F0aW9uVHlwZTpDbixwYXlsb2FkOnQodCh7fSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gc3QoZSk/ZS5kYXRhJiYhbnQoZS5kYXRhKT8odG4oe2FwaTpcImNyZWF0ZUN1c3RvbU1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuZGF0YVwiLGRlc2M6bm4oKX0pLCExKTplLmRlc2NyaXB0aW9uJiYhbnQoZS5kZXNjcmlwdGlvbik/KHRuKHthcGk6XCJjcmVhdGVDdXN0b21NZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmRlc2NyaXB0aW9uXCIsZGVzYzpubigpfSksITEpOiEoZS5leHRlbnNpb24mJiFudChlLmV4dGVuc2lvbikpfHwodG4oe2FwaTpcImNyZWF0ZUN1c3RvbU1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuZXh0ZW5zaW9uXCIsZGVzYzpubigpfSksITEpOih0bih7YXBpOlwiY3JlYXRlQ3VzdG9tTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZFwiLGRlc2M6Zm4oKX0pLCExKX19KX0sY3JlYXRlSW1hZ2VNZXNzYWdlOnt0bzpDbixjb252ZXJzYXRpb25UeXBlOkNuLHBheWxvYWQ6dCh0KHt9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe2lmKCFzdChlKSlyZXR1cm4gdG4oe2FwaTpcImNyZWF0ZUltYWdlTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZFwiLGRlc2M6Zm4oKX0pLCExO2lmKGl0KGUuZmlsZSkpcmV0dXJuIHRuKHthcGk6XCJjcmVhdGVJbWFnZU1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuZmlsZVwiLGRlc2M6YW4oKX0pLCExO2lmKGllKXtpZighKGUuZmlsZSBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnR8fCRlKGUuZmlsZSkpKXJldHVybiBzdChlLmZpbGUpJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgdW5pPzAhPT1lLmZpbGUudGVtcEZpbGVQYXRocy5sZW5ndGgmJjAhPT1lLmZpbGUudGVtcEZpbGVzLmxlbmd0aHx8KHRuKHthcGk6XCJjcmVhdGVJbWFnZU1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuZmlsZVwiLGRlc2M6bW4oKX0pLCExKToodG4oe2FwaTpcImNyZWF0ZUltYWdlTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5maWxlXCIsZGVzYzpybigpfSksITEpO2lmKGUuZmlsZSBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQmJjA9PT1lLmZpbGUuZmlsZXMubGVuZ3RoKXJldHVybiB0bih7YXBpOlwiY3JlYXRlSW1hZ2VNZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmZpbGVcIixkZXNjOm1uKCl9KSwhMX1yZXR1cm4hMH0sb25Qcm9ncmVzczp7dHlwZTpcIkZ1bmN0aW9uXCIscmVxdWlyZWQ6ITEsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiBpdChlKSYmdG4oe2FwaTpcImNyZWF0ZUltYWdlTWVzc2FnZVwiLHBhcmFtOlwib25Qcm9ncmVzc1wiLGRlc2M6ZG4oKX0pLCEwfX19KX0sY3JlYXRlQXVkaW9NZXNzYWdlOnt0bzpDbixjb252ZXJzYXRpb25UeXBlOkNuLHBheWxvYWQ6dCh0KHt9LERuKSx7fSx7dmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiEhc3QoZSl8fCh0bih7YXBpOlwiY3JlYXRlQXVkaW9NZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkXCIsZGVzYzpmbigpfSksITEpfX0pLG9uUHJvZ3Jlc3M6e3R5cGU6XCJGdW5jdGlvblwiLHJlcXVpcmVkOiExLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSkmJnRuKHthcGk6XCJjcmVhdGVBdWRpb01lc3NhZ2VcIixwYXJhbTpcIm9uUHJvZ3Jlc3NcIixkZXNjOmRuKCl9KSwhMH19fSxjcmVhdGVWaWRlb01lc3NhZ2U6e3RvOkNuLGNvbnZlcnNhdGlvblR5cGU6Q24scGF5bG9hZDp0KHQoe30sRG4pLHt9LHt2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7aWYoIXN0KGUpKXJldHVybiB0bih7YXBpOlwiY3JlYXRlVmlkZW9NZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkXCIsZGVzYzpmbigpfSksITE7aWYoaXQoZS5maWxlKSlyZXR1cm4gdG4oe2FwaTpcImNyZWF0ZVZpZGVvTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5maWxlXCIsZGVzYzphbigpfSksITE7aWYoaWUpe2lmKCEoZS5maWxlIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudHx8JGUoZS5maWxlKSkpcmV0dXJuIHN0KGUuZmlsZSkmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB1bmk/ISEkZShlLmZpbGUudGVtcEZpbGUpfHwodG4oe2FwaTpcImNyZWF0ZVZpZGVvTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5maWxlXCIsZGVzYzptbigpfSksITEpOih0bih7YXBpOlwiY3JlYXRlVmlkZW9NZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmZpbGVcIixkZXNjOnJuKCl9KSwhMSk7aWYoZS5maWxlIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCYmMD09PWUuZmlsZS5maWxlcy5sZW5ndGgpcmV0dXJuIHRuKHthcGk6XCJjcmVhdGVWaWRlb01lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuZmlsZVwiLGRlc2M6bW4oKX0pLCExfXJldHVybiEwfX0pLG9uUHJvZ3Jlc3M6e3R5cGU6XCJGdW5jdGlvblwiLHJlcXVpcmVkOiExLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSkmJnRuKHthcGk6XCJjcmVhdGVWaWRlb01lc3NhZ2VcIixwYXJhbTpcIm9uUHJvZ3Jlc3NcIixkZXNjOmRuKCl9KSwhMH19fSxjcmVhdGVGYWNlTWVzc2FnZTp7dG86Q24sY29udmVyc2F0aW9uVHlwZTpDbixwYXlsb2FkOnQodCh7fSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gc3QoZSk/ZXQoZS5pbmRleCk/ISFudChlLmRhdGEpfHwodG4oe2FwaTpcImNyZWF0ZUZhY2VNZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmRhdGFcIixkZXNjOm5uKCl9KSwhMSk6KHRuKHthcGk6XCJjcmVhdGVGYWNlTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5pbmRleFwiLGRlc2M6c24oKX0pLCExKToodG4oe2FwaTpcImNyZWF0ZUZhY2VNZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkXCIsZGVzYzpmbigpfSksITEpfX0pfSxjcmVhdGVGaWxlTWVzc2FnZTp7dG86Q24sY29udmVyc2F0aW9uVHlwZTpDbixwYXlsb2FkOnQodCh7fSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtpZighc3QoZSkpcmV0dXJuIHRuKHthcGk6XCJjcmVhdGVGaWxlTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZFwiLGRlc2M6Zm4oKX0pLCExO2lmKGl0KGUuZmlsZSkpcmV0dXJuIHRuKHthcGk6XCJjcmVhdGVGaWxlTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5maWxlXCIsZGVzYzphbigpfSksITE7aWYoaWUpe2lmKCEoZS5maWxlIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudHx8JGUoZS5maWxlKSkpcmV0dXJuIHN0KGUuZmlsZSkmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiB1bmk/MCE9PWUuZmlsZS50ZW1wRmlsZVBhdGhzLmxlbmd0aCYmMCE9PWUuZmlsZS50ZW1wRmlsZXMubGVuZ3RofHwodG4oe2FwaTpcImNyZWF0ZUZpbGVNZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmZpbGVcIixkZXNjOm1uKCl9KSwhMSk6KHRuKHthcGk6XCJjcmVhdGVGaWxlTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5maWxlXCIsZGVzYzpybigpfSksITEpO2lmKGUuZmlsZSBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQmJjA9PT1lLmZpbGUuZmlsZXMubGVuZ3RoKXJldHVybiB0bih7YXBpOlwiY3JlYXRlRmlsZU1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuZmlsZVwiLGRlc2M6bW4oKX0pLCExfXJldHVybiEwfX0pLG9uUHJvZ3Jlc3M6e3R5cGU6XCJGdW5jdGlvblwiLHJlcXVpcmVkOiExLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSkmJnRuKHthcGk6XCJjcmVhdGVGaWxlTWVzc2FnZVwiLHBhcmFtOlwib25Qcm9ncmVzc1wiLGRlc2M6ZG4oKX0pLCEwfX19LGNyZWF0ZUxvY2F0aW9uTWVzc2FnZTp7dG86Q24sY29udmVyc2F0aW9uVHlwZTpDbixwYXlsb2FkOnQodCh7fSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gc3QoZSk/bnQoZS5kZXNjcmlwdGlvbik/ZXQoZS5sb25naXR1ZGUpPyEhZXQoZS5sYXRpdHVkZSl8fCh0bih7YXBpOlwiY3JlYXRlTG9jYXRpb25NZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmxhdGl0dWRlXCIsZGVzYzpzbigpfSksITEpOih0bih7YXBpOlwiY3JlYXRlTG9jYXRpb25NZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLmxvbmdpdHVkZVwiLGRlc2M6c24oKX0pLCExKToodG4oe2FwaTpcImNyZWF0ZUxvY2F0aW9uTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZC5kZXNjcmlwdGlvblwiLGRlc2M6bm4oKX0pLCExKToodG4oe2FwaTpcImNyZWF0ZUxvY2F0aW9uTWVzc2FnZVwiLHBhcmFtOlwicGF5bG9hZFwiLGRlc2M6Zm4oKX0pLCExKX19KX0sY3JlYXRlTWVyZ2VyTWVzc2FnZTp7dG86Q24sY29udmVyc2F0aW9uVHlwZTpDbixwYXlsb2FkOnQodCh7fSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtpZih6dChlLm1lc3NhZ2VMaXN0KSlyZXR1cm4gdG4oe2FwaTpcImNyZWF0ZU1lcmdlck1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQubWVzc2FnZUxpc3RcIixkZXNjOmxuKCl9KSwhMTtpZih6dChlLmNvbXBhdGlibGVUZXh0KSlyZXR1cm4gdG4oe2FwaTpcImNyZWF0ZU1lcmdlck1lc3NhZ2VcIixwYXJhbTpcInBheWxvYWQuY29tcGF0aWJsZVRleHRcIixkZXNjOm9uKFwiY29tcGF0aWJsZVRleHRcIil9KSwhMTt2YXIgdD0hMTtyZXR1cm4gZS5tZXNzYWdlTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtlLnN0YXR1cz09PVF0LkZBSUwmJih0PSEwKX0pKSwhdHx8KHRuKHthcGk6XCJjcmVhdGVNZXJnZXJNZXNzYWdlXCIscGFyYW06XCJwYXlsb2FkLm1lc3NhZ2VMaXN0XCIsZGVzYzpTbihcIk1lcmdlRmFpbGVkTWVzc2FnZUxvZ1wiKX0pLCExKX19KX0scmV2b2tlTWVzc2FnZTpbdCh0KHtuYW1lOlwibWVzc2FnZVwifSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4genQoZSk/KHRuKHthcGk6XCJyZXZva2VNZXNzYWdlXCIscGFyYW06XCJtZXNzYWdlXCIsZGVzYzpNbigpfSksITEpOmUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9TWVNURU0/KHRuKHthcGk6XCJyZXZva2VNZXNzYWdlXCIscGFyYW06XCJtZXNzYWdlXCIsZGVzYzpTbihcIk1lc3NhZ2VDYW5CZVJldm9rZWREZXNjXCIpfSksITEpOiEwIT09ZS5pc1Jldm9rZWR8fCh0bih7YXBpOlwicmV2b2tlTWVzc2FnZVwiLHBhcmFtOlwibWVzc2FnZVwiLGRlc2M6U24oXCJNZXNzYWdlUmV2b2tlZExvZ1wiKX0pLCExKX19KV0sZGVsZXRlTWVzc2FnZTpbdCh0KHtuYW1lOlwibWVzc2FnZUxpc3RcIn0sVG4pLHt9LHt2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIXp0KGUpfHwodG4oe2FwaTpcImRlbGV0ZU1lc3NhZ2VcIixwYXJhbTpcIm1lc3NhZ2VMaXN0XCIsZGVzYzpsbigpfSksITEpfX0pXSx0cmFuc2xhdGVUZXh0Ontzb3VyY2VUZXh0TGlzdDpUbixzb3VyY2VMYW5ndWFnZTpDbix0YXJnZXRMYW5ndWFnZTpDbn0sbW9kaWZ5TWVzc2FnZTpbdCh0KHtuYW1lOlwibWVzc2FnZVwifSxEbikse30se3ZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4genQoZSk/KHRuKHthcGk6XCJtb2RpZnlNZXNzYWdlXCIscGFyYW06XCJtZXNzYWdlXCIsZGVzYzpNbigpfSksITEpOmUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9TWVNURU0/KHRuKHthcGk6XCJtb2RpZnlNZXNzYWdlXCIscGFyYW06XCJtZXNzYWdlXCIsZGVzYzpTbihcIk1lc3NhZ2VDYW5CZU1vZGlmaWVkTG9nXCIpfSksITEpOiEwIT09ZS5fb25saW5lT25seUZsYWd8fCh0bih7YXBpOlwibW9kaWZ5TWVzc2FnZVwiLHBhcmFtOlwibWVzc2FnZVwiLGRlc2M6U24oXCJPbmxpbmVNZXNzYWdlTm90U3VwcG9ydExvZ1wiKX0pLCExKX19KV0sZ2V0VXNlclByb2ZpbGU6e3VzZXJJRExpc3Q6e3R5cGU6XCJBcnJheVwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gYXQoZSk/KDA9PT1lLmxlbmd0aCYmdG4oe2FwaTpcImdldFVzZXJQcm9maWxlXCIscGFyYW06XCJ1c2VySURMaXN0XCIsZGVzYzpsbigpfSksITApOih0bih7YXBpOlwiZ2V0VXNlclByb2ZpbGVcIixwYXJhbTpcInVzZXJJRExpc3RcIixkZXNjOmNuKCl9KSwhMSl9fX0sdXBkYXRlTXlQcm9maWxlOntwcm9maWxlQ3VzdG9tRmllbGQ6e3R5cGU6XCJBcnJheVwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hIWl0KGUpfHwoISFhdChlKXx8KHRuKHthcGk6XCJ1cGRhdGVNeVByb2ZpbGVcIixwYXJhbTpcInByb2ZpbGVDdXN0b21GaWVsZFwiLGRlc2M6Y24oKX0pLCExKSl9fX0sc2V0U2VsZlN0YXR1czp7Y3VzdG9tU3RhdHVzOnt0eXBlOlwiU3RyaW5nXCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiEhbnQoZSl8fCh0bih7YXBpOlwic2V0U2VsZlN0YXR1c1wiLHBhcmFtOlwiY3VzdG9tU3RhdHVzXCIsZGVzYzpubigpfSksITEpfX19LGdldFVzZXJTdGF0dXM6e3VzZXJJRExpc3Q6e3R5cGU6XCJBcnJheVwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gYXQoZSk/MCE9PWUubGVuZ3RofHwodG4oe2FwaTpcImdldFVzZXJTdGF0dXNcIixwYXJhbTpcInVzZXJJRExpc3RcIixkZXNjOmxuKCl9KSwhMSk6KHRuKHthcGk6XCJnZXRVc2VyU3RhdHVzXCIscGFyYW06XCJ1c2VySURMaXN0XCIsZGVzYzpjbigpfSksITEpfX19LHN1YnNjcmliZVVzZXJTdGF0dXM6e3VzZXJJRExpc3Q6e3R5cGU6XCJBcnJheVwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4gYXQoZSk/MCE9PWUubGVuZ3RofHwodG4oe2FwaTpcInN1YnNjcmliZVVzZXJTdGF0dXNcIixwYXJhbTpcInVzZXJJRExpc3RcIixkZXNjOmxuKCl9KSwhMSk6KHRuKHthcGk6XCJzdWJzY3JpYmVVc2VyU3RhdHVzXCIscGFyYW06XCJ1c2VySURMaXN0XCIsZGVzYzpjbigpfSksITEpfX19LHVuc3Vic2NyaWJlVXNlclN0YXR1czp7dXNlcklETGlzdDp7dHlwZTpcIkFycmF5XCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiFlfHwoISFhdChlKXx8KHRuKHthcGk6XCJzdWJzY3JpYmVVc2VyU3RhdHVzXCIscGFyYW06XCJ1c2VySURMaXN0XCIsZGVzYzpjbigpfSksITEpKX19fSxhZGRGcmllbmQ6e3RvOkNuLHNvdXJjZTp7dHlwZTpcIlN0cmluZ1wiLHJlcXVpcmVkOiEwLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hIWUmJihlLnN0YXJ0c1dpdGgoXCJBZGRTb3VyY2VfVHlwZV9cIik/IShlLnJlcGxhY2UoXCJBZGRTb3VyY2VfVHlwZV9cIixcIlwiKS5sZW5ndGg+OCl8fCh0bih7YXBpOlwiYWRkRnJpZW5kXCIscGFyYW06XCJzb3VyY2VcIixkZXNjOmduKFwia2V5d29yZFwiLDgpfSksITEpOih0bih7YXBpOlwiYWRkRnJpZW5kXCIscGFyYW06XCJzb3VyY2VcIixkZXNjOlNuKFwiU291cmNlUHJlZml4TG9nXCIpfSksITEpKX19LHJlbWFyazp7dHlwZTpcIlN0cmluZ1wiLHJlcXVpcmVkOiExLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hKG50KGUpJiZlLmxlbmd0aD45Nil8fCh0bih7YXBpOlwiYWRkRnJpZW5kXCIscGFyYW06XCJyZW1hcmtcIixkZXNjOmduKFwicmVtYXJrXCIsOTYpfSksITEpfX19LGRlbGV0ZUZyaWVuZDp7dXNlcklETGlzdDpUbn0sY2hlY2tGcmllbmQ6e3VzZXJJRExpc3Q6VG59LGdldEZyaWVuZFByb2ZpbGU6e3VzZXJJRExpc3Q6VG59LHVwZGF0ZUZyaWVuZDp7dXNlcklEOkNuLHJlbWFyazp7dHlwZTpcIlN0cmluZ1wiLHJlcXVpcmVkOiExLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hKG50KGUpJiZlLmxlbmd0aD45Nil8fCh0bih7YXBpOlwidXBkYXRlRnJpZW5kXCIscGFyYW06XCJyZW1hcmtcIixkZXNjOmduKFwicmVtYXJrXCIsOTYpfSksITEpfX0sZnJpZW5kQ3VzdG9tRmllbGQ6e3R5cGU6XCJBcnJheVwiLHJlcXVpcmVkOiExLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtpZihlKXtpZighYXQoZSkpcmV0dXJuIHRuKHthcGk6XCJ1cGRhdGVGcmllbmRcIixwYXJhbTpcImZyaWVuZEN1c3RvbUZpZWxkXCIsZGVzYzpjbigpfSksITE7dmFyIHQ9ITA7cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIG50KGUua2V5KSYmLTEhPT1lLmtleS5pbmRleE9mKFwiVGFnX1NOU19DdXN0b21cIik/bnQoZS52YWx1ZSk/ZS5rZXkucmVwbGFjZShcIlRhZ19TTlNfQ3VzdG9tX1wiLFwiXCIpLmxlbmd0aD44Pyh0bih7YXBpOlwidXBkYXRlRnJpZW5kXCIscGFyYW06XCJmcmllbmRDdXN0b21GaWVsZFwiLGRlc2M6Z24oXCJrZXl3b3JkXCIsOCl9KSx0PSExKTp2b2lkIDA6KHRuKHthcGk6XCJ1cGRhdGVGcmllbmRcIixwYXJhbTpcImZyaWVuZEN1c3RvbUZpZWxkXCIsZGVzYzpfbihcInZhbHVlXCIpfSksdD0hMSk6KHRuKHthcGk6XCJ1cGRhdGVGcmllbmRcIixwYXJhbTpcImZyaWVuZEN1c3RvbUZpZWxkXCIsZGVzYzpTbihcIkZyaWVuZEN1c3RvbUZpZWxkUHJlZml4TG9nXCIpfSksdD0hMSl9KSksdH1yZXR1cm4hMH19fSxhY2NlcHRGcmllbmRBcHBsaWNhdGlvbjp7dXNlcklEOkNufSxyZWZ1c2VGcmllbmRBcHBsaWNhdGlvbjp7dXNlcklEOkNufSxkZWxldGVGcmllbmRBcHBsaWNhdGlvbjp7dXNlcklEOkNufSxjcmVhdGVGcmllbmRHcm91cDp7bmFtZTpDbn0sZGVsZXRlRnJpZW5kR3JvdXA6e25hbWU6Q259LGFkZFRvRnJpZW5kR3JvdXA6e25hbWU6Q24sdXNlcklETGlzdDpUbn0scmVtb3ZlRnJvbUZyaWVuZEdyb3VwOntuYW1lOkNuLHVzZXJJRExpc3Q6VG59LHJlbmFtZUZyaWVuZEdyb3VwOntvbGROYW1lOkNuLG5ld05hbWU6Q259LHNlbmRNZXNzYWdlUmVhZFJlY2VpcHQ6W3tuYW1lOlwibWVzc2FnZUxpc3RcIix0eXBlOlwiQXJyYXlcIix2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIGF0KGUpPzAhPT1lLmxlbmd0aHx8KHRuKHthcGk6XCJzZW5kTWVzc2FnZVJlYWRSZWNlaXB0XCIscGFyYW06XCJtZXNzYWdlTGlzdFwiLGRlc2M6bG4oKX0pLCExKToodG4oe2FwaTpcInNlbmRNZXNzYWdlUmVhZFJlY2VpcHRcIixwYXJhbTpcIm1lc3NhZ2VMaXN0XCIsZGVzYzpjbigpfSksITEpfX1dLGdldE1lc3NhZ2VSZWFkUmVjZWlwdExpc3Q6W3tuYW1lOlwibWVzc2FnZUxpc3RcIix0eXBlOlwiQXJyYXlcIix2YWxpZGF0b3I6ZnVuY3Rpb24oZSl7cmV0dXJuIGF0KGUpPzAhPT1lLmxlbmd0aHx8KHRuKHthcGk6XCJnZXRNZXNzYWdlUmVhZFJlY2VpcHRMaXN0XCIscGFyYW06XCJtZXNzYWdlTGlzdFwiLGRlc2M6bG4oKX0pLCExKToodG4oe2FwaTpcImdldE1lc3NhZ2VSZWFkUmVjZWlwdExpc3RcIixwYXJhbTpcIm1lc3NhZ2VMaXN0XCIsZGVzYzpjbigpfSksITEpfX1dLGNyZWF0ZVRvcGljSW5Db21tdW5pdHk6e2dyb3VwSUQ6Q24sdG9waWNOYW1lOkNufSxkZWxldGVUb3BpY0Zyb21Db21tdW5pdHk6e2dyb3VwSUQ6Q24sdG9waWNJRExpc3Q6e3R5cGU6XCJBcnJheVwiLHZhbGlkYXRvcjpmdW5jdGlvbihlKXtyZXR1cm4hZXx8KCEhYXQoZSl8fCh0bih7YXBpOlwiZGVsZXRlVG9waWNGcm9tQ29tbXVuaXR5XCIscGFyYW06XCJ0b3BpY0lETGlzdFwiLGRlc2M6Y24oKX0pLCExKSl9fX0sdXBkYXRlVG9waWNQcm9maWxlOntncm91cElEOkNuLHRvcGljSUQ6Q259LGdldFRvcGljTGlzdDp7Z3JvdXBJRDpDbix0b3BpY0lETGlzdDp7dHlwZTpcIkFycmF5XCIsdmFsaWRhdG9yOmZ1bmN0aW9uKGUpe3JldHVybiFlfHwoISFhdChlKXx8KHRuKHthcGk6XCJnZXRUb3BpY0xpc3RcIixwYXJhbTpcInRvcGljSURMaXN0XCIsZGVzYzpjbigpfSksITEpKX19fX0sQW49e2xvZ2luOjEsbG9nb3V0OjEsb246MSxvbmNlOjEsb2ZmOjEsc2V0TG9nTGV2ZWw6MSxyZWdpc3RlclBsdWdpbjoxLGRlc3Ryb3k6MSxjcmVhdGVUZXh0TWVzc2FnZToxLGNyZWF0ZVRleHRBdE1lc3NhZ2U6MSxjcmVhdGVJbWFnZU1lc3NhZ2U6MSxjcmVhdGVBdWRpb01lc3NhZ2U6MSxjcmVhdGVWaWRlb01lc3NhZ2U6MSxjcmVhdGVDdXN0b21NZXNzYWdlOjEsY3JlYXRlRmFjZU1lc3NhZ2U6MSxjcmVhdGVGaWxlTWVzc2FnZToxLGNyZWF0ZUxvY2F0aW9uTWVzc2FnZToxLGNyZWF0ZU1lcmdlck1lc3NhZ2U6MSxkb3dubG9hZE1lcmdlck1lc3NhZ2U6MSxjcmVhdGVGb3J3YXJkTWVzc2FnZToxLHNlbmRNZXNzYWdlOjEscmVzZW5kTWVzc2FnZToxLHJldm9rZU1lc3NhZ2U6MSxkZWxldGVNZXNzYWdlOjEsdHJhbnNsYXRlVGV4dDoxLG1vZGlmeU1lc3NhZ2U6MSxzZW5kTWVzc2FnZVJlYWRSZWNlaXB0OjEsZ2V0R3JvdXBNZXNzYWdlUmVhZE1lbWJlckxpc3Q6MSxnZXRNZXNzYWdlUmVhZFJlY2VpcHRMaXN0OjEsc2V0TWVzc2FnZUV4dGVuc2lvbnM6MSxnZXRNZXNzYWdlRXh0ZW5zaW9uczoxLGRlbGV0ZU1lc3NhZ2VFeHRlbnNpb25zOjEsZ2V0TWVzc2FnZUxpc3Q6MSxmaW5kTWVzc2FnZToxLGdldE1lc3NhZ2VMaXN0SG9wcGluZzoxLHNldE1lc3NhZ2VSZWFkOjEsc2V0QWxsTWVzc2FnZVJlYWQ6MSxnZXRDb252ZXJzYXRpb25MaXN0OjEsZ2V0Q29udmVyc2F0aW9uUHJvZmlsZToxLGRlbGV0ZUNvbnZlcnNhdGlvbjoxLHBpbkNvbnZlcnNhdGlvbjoxLGdldFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50OjEsc2V0Q29udmVyc2F0aW9uQ3VzdG9tRGF0YToxLG1hcmtDb252ZXJzYXRpb246MSxjcmVhdGVDb252ZXJzYXRpb25Hcm91cDoxLGdldENvbnZlcnNhdGlvbkdyb3VwTGlzdDoxLGRlbGV0ZUNvbnZlcnNhdGlvbkdyb3VwOjEscmVuYW1lQ29udmVyc2F0aW9uR3JvdXA6MSxhZGRDb252ZXJzYXRpb25zVG9Hcm91cDoxLGRlbGV0ZUNvbnZlcnNhdGlvbnNGcm9tR3JvdXA6MSxjbGVhckhpc3RvcnlNZXNzYWdlOjEsZ2V0R3JvdXBMaXN0OjEsZ2V0R3JvdXBQcm9maWxlOjEsY3JlYXRlR3JvdXA6MSxqb2luR3JvdXA6MSx1cGRhdGVHcm91cFByb2ZpbGU6MSxxdWl0R3JvdXA6MSxkaXNtaXNzR3JvdXA6MSxjaGFuZ2VHcm91cE93bmVyOjEsc2VhcmNoR3JvdXBCeUlEOjEsc2V0TWVzc2FnZVJlbWluZFR5cGU6MSxnZXRHcm91cEFwcGxpY2F0aW9uTGlzdDoxLGhhbmRsZUdyb3VwQXBwbGljYXRpb246MSxpbml0R3JvdXBBdHRyaWJ1dGVzOjEsc2V0R3JvdXBBdHRyaWJ1dGVzOjEsZGVsZXRlR3JvdXBBdHRyaWJ1dGVzOjEsZ2V0R3JvdXBBdHRyaWJ1dGVzOjEsc2V0R3JvdXBDb3VudGVyczoxLGluY3JlYXNlR3JvdXBDb3VudGVyOjEsZGVjcmVhc2VHcm91cENvdW50ZXI6MSxnZXRHcm91cENvdW50ZXJzOjEsZ2V0Sm9pbmVkQ29tbXVuaXR5TGlzdDoxLGNyZWF0ZVRvcGljSW5Db21tdW5pdHk6MSxkZWxldGVUb3BpY0Zyb21Db21tdW5pdHk6MSx1cGRhdGVUb3BpY1Byb2ZpbGU6MSxnZXRUb3BpY0xpc3Q6MSxnZXRHcm91cE1lbWJlclByb2ZpbGU6MSxnZXRHcm91cE1lbWJlckxpc3Q6MSxhZGRHcm91cE1lbWJlcjoxLGRlbGV0ZUdyb3VwTWVtYmVyOjEsc2V0R3JvdXBNZW1iZXJOYW1lQ2FyZDoxLHNldEdyb3VwTWVtYmVyTXV0ZVRpbWU6MSxzZXRHcm91cE1lbWJlclJvbGU6MSxzZXRHcm91cE1lbWJlckN1c3RvbUZpZWxkOjEsZ2V0R3JvdXBPbmxpbmVNZW1iZXJDb3VudDoxLG1hcmtHcm91cE1lbWJlckxpc3Q6MSxnZXRNeVByb2ZpbGU6MSxnZXRVc2VyUHJvZmlsZToxLHVwZGF0ZU15UHJvZmlsZToxLHNldFNlbGZTdGF0dXM6MSxnZXRVc2VyU3RhdHVzOjEsc3Vic2NyaWJlVXNlclN0YXR1czoxLHVuc3Vic2NyaWJlVXNlclN0YXR1czoxLGdldEJsYWNrbGlzdDoxLGFkZFRvQmxhY2tsaXN0OjEscmVtb3ZlRnJvbUJsYWNrbGlzdDoxLGdldEZyaWVuZExpc3Q6MSxhZGRGcmllbmQ6MSxkZWxldGVGcmllbmQ6MSxjaGVja0ZyaWVuZDoxLHVwZGF0ZUZyaWVuZDoxLGdldEZyaWVuZFByb2ZpbGU6MSxnZXRGcmllbmRBcHBsaWNhdGlvbkxpc3Q6MSxyZWZ1c2VGcmllbmRBcHBsaWNhdGlvbjoxLGRlbGV0ZUZyaWVuZEFwcGxpY2F0aW9uOjEsYWNjZXB0RnJpZW5kQXBwbGljYXRpb246MSxzZXRGcmllbmRBcHBsaWNhdGlvblJlYWQ6MSxnZXRGcmllbmRHcm91cExpc3Q6MSxjcmVhdGVGcmllbmRHcm91cDoxLHJlbmFtZUZyaWVuZEdyb3VwOjEsZGVsZXRlRnJpZW5kR3JvdXA6MSxhZGRUb0ZyaWVuZEdyb3VwOjEscmVtb3ZlRnJvbUZyaWVuZEdyb3VwOjEsY2FsbEV4cGVyaW1lbnRhbEFQSToxfSxSbj0xLE5uPTIsT249MyxHbj00LFVuPTYsUG49Nyxibj04LHduPTksRm49MTAscW49MTEseG49MTIsVm49MTMsQm49MTQsSG49MTUsS249MTYsV249MTcsWW49MTgsam49MTksem49MjAsSm49MjEsWG49MjIsWm49MjMsUW49MjQsJG49MjUsZW89MjYsdG89Mjcsbm89Mjgsb289Mjksc289MzAsYW89MzEsaW89MzIscm89MzcsdW89ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9tPXQsdGhpcy5fbj1cIlwifXJldHVybiBhKGUsW3trZXk6XCJpc0xvZ2dlZEluXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbS5nZXRNb2R1bGUoeG4pLmlzTG9nZ2VkSW4oKX19LHtrZXk6XCJpc092ZXJzZWFcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZSh4bikuaXNPdmVyc2VhKCl9fSx7a2V5OlwiaXNQcml2YXRlTmV0V29ya1wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKHhuKS5pc1ByaXZhdGVOZXRXb3JrKCl9fSx7a2V5OlwiZ2V0RmlsZURvd25sb2FkUHJveHlcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZSh4bikuZ2V0RmlsZURvd25sb2FkUHJveHkoKX19LHtrZXk6XCJnZXRNeVVzZXJJRFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKHhuKS5nZXRVc2VySUQoKX19LHtrZXk6XCJnZXRNeVRpbnlJRFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKHhuKS5nZXRUaW55SUQoKX19LHtrZXk6XCJnZXRTREtBcHBJRFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKHhuKS5nZXRTREtBcHBJRCgpfX0se2tleTpcImlzSW50bFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKHhuKS5pc0ludGwoKX19LHtrZXk6XCJpc0Rldk1vZGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZSh4bikuaXNEZXZNb2RlKCl9fSx7a2V5OlwiZ2V0TW9kdWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKGUpfX0se2tleTpcImdldFBsYXRmb3JtXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZ2V9fSx7a2V5OlwiZ2V0TmV0d29ya1R5cGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZShIbikuZ2V0TmV0d29ya1R5cGUoKX19LHtrZXk6XCJwcm9iZU5ldHdvcmtcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbS5nZXRNb2R1bGUoSG4pLnByb2JlKGUpfX0se2tleTpcImdldENsb3VkQ29uZmlnXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKFpuKS5nZXRDbG91ZENvbmZpZyhlKX19LHtrZXk6XCJlbWl0T3V0ZXJFdmVudFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fbS5nZXRPdXRlckVtaXR0ZXJJbnN0YW5jZSgpLmVtaXQoZSx0KX19LHtrZXk6XCJlbWl0SW5uZXJFdmVudFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fbS5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpLmVtaXQoZSx0KX19LHtrZXk6XCJnZXRJbm5lckVtaXR0ZXJJbnN0YW5jZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0SW5uZXJFbWl0dGVySW5zdGFuY2UoKX19LHtrZXk6XCJnZW5lcmF0ZVRqZ0lEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKHhuKS5nZXRUaW55SUQoKStcIi1cIitlLnJhbmRvbX19LHtrZXk6XCJmaWx0ZXJNb2RpZmllZE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtpZighenQoZSkpe3ZhciB0PWUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hMD09PWUuaXNNb2RpZmllZH0pKTt0Lmxlbmd0aD4wJiZ0aGlzLmVtaXRPdXRlckV2ZW50KGsuTUVTU0FHRV9NT0RJRklFRCx0KX19fSx7a2V5OlwiZmlsdGVyVW5tb2RpZmllZE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4genQoZSk/W106ZS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiExPT09ZS5pc01vZGlmaWVkfSkpfX0se2tleTpcInJlcXVlc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbS5nZXRNb2R1bGUoem4pLnJlcXVlc3QoZSl9fSx7a2V5OlwiY2FuSVVzZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZSh0bykuY2FuSVVzZShlKX19LHtrZXk6XCJnZXRFcnJvck1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMuX20uZ2V0RXJyb3JNZXNzYWdlKGUsdCxuKX19LHtrZXk6XCJvdXRwdXRXYXJuaW5nXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPXRoaXMuZ2V0RXJyb3JNZXNzYWdlKGUsdCxuKTtvJiZWZS53KG8pfX1dKSxlfSgpLGNvPVwid3Nsb2dpblwiLGxvPVwid3Nsb2dvdXRcIixwbz1cIndzaGVsbG9cIixnbz1cIktpY2tPdGhlclwiLGhvPVwiZ2V0bXNnXCIsX289XCJhdXRoa2V5XCIsZm89XCJzZW5kbXNnXCIsdm89XCJzZW5kX2dyb3VwX21zZ1wiLG1vPVwicG9ydHJhaXRfZ2V0X2FsbFwiLE1vPVwicG9ydHJhaXRfc2V0XCIseW89XCJibGFja19saXN0X2dldFwiLElvPVwiYmxhY2tfbGlzdF9hZGRcIixDbz1cImJsYWNrX2xpc3RfZGVsZXRlXCIsVG89XCJtc2d3aXRoZHJhd1wiLERvPVwibXNncmVhZGVkXCIsa289XCJzZXRfYzJjX3BlZXJfbXV0ZV9ub3RpZmljYXRpb25zXCIsRW89XCJnZXRfYzJjX3BlZXJfbXV0ZV9ub3RpZmljYXRpb25zXCIsU289XCJnZXRyb2FtbXNnXCIsTG89XCJnZXRfcGVlcl9yZWFkX3RpbWVcIixBbz1cImRlbGV0ZV9jMmNfbXNnX3JhbWJsZVwiLFJvPVwibW9kaWZ5X2MyY19tc2dcIixObz1cInNldF9rZXlfdmFsdWVzXCIsT289XCJnZXRfa2V5X3ZhbHVlc1wiLEdvPVwicGFnZV9nZXRcIixVbz1cImdldFwiLFBvPVwiYmF0Y2hfZGVsZXRlXCIsYm89XCJjbGVhcl9tc2dcIix3bz1cInRvcFwiLEZvPVwiZGVsZXRlbXNnXCIscW89XCJzZXRfY29udl9jdXN0b21fZGF0YVwiLHhvPVwibWFya19jb250YWN0XCIsVm89XCJjcmVhdGVfY29udGFjdF9ncm91cFwiLEJvPVwiZGVsX2NvbnRhY3RfZ3JvdXBcIixIbz1cInVwZGF0ZV9jb250YWN0X2dyb3VwXCIsS289XCJhZGRfY29udl90b19ncm91cFwiLFdvPVwiZGVsX2NvbnZfZnJvbV9ncm91cFwiLFlvPVwiZ2V0X2NvbnRhY3RfZ3JvdXBcIixqbz1cImdldF9qb2luZWRfZ3JvdXBfbGlzdFwiLHpvPVwiZ2V0X2dyb3VwX3NlbGZfbWVtYmVyX2luZm9cIixKbz1cImNyZWF0ZV9ncm91cFwiLFhvPVwiZGVzdHJveV9ncm91cFwiLFpvPVwibW9kaWZ5X2dyb3VwX2Jhc2VfaW5mb1wiLFFvPVwiYXBwbHlfam9pbl9ncm91cFwiLCRvPVwiYXBwbHlfam9pbl9ncm91cF9ub2F1dGhcIixlcz1cInF1aXRfZ3JvdXBcIix0cz1cImdldF9ncm91cF9wdWJsaWNfaW5mb1wiLG5zPVwiY2hhbmdlX2dyb3VwX293bmVyXCIsb3M9XCJoYW5kbGVfYXBwbHlfam9pbl9ncm91cFwiLHNzPVwiaGFuZGxlX2ludml0ZV9qb2luX3Blcm1pc3Npb25fZ3JvdXBcIixhcz1cImhhbmRsZV9pbnZpdGVfam9pbl9ncm91cFwiLGlzPVwiZ3JvdXBfbXNnX3JlY2FsbFwiLHJzPVwibXNnX3JlYWRfcmVwb3J0XCIsdXM9XCJyZWFkX2FsbF91bnJlYWRfbXNnXCIsY3M9XCJncm91cF9tc2dfZ2V0XCIsbHM9XCJnZXRfZ3JvdXBfbXNnX3JlY2VpcHRcIixkcz1cImdyb3VwX21zZ19yZWNlaXB0XCIscHM9XCJjMmNfbXNnX3JlYWRfcmVjZWlwdFwiLGdzPVwiZ2V0X2dyb3VwX21zZ19yZWNlaXB0X2RldGFpbFwiLGhzPVwiZ2V0X3BlbmRlbmN5XCIsX3M9XCJkZWxldGVtc2dcIixmcz1cImdldF9tc2dcIix2cz1cImdldF9tc2dfbm9hdXRoXCIsbXM9XCJnZXRfb25saW5lX21lbWJlcl9udW1cIixNcz1cImRlbGV0ZV9ncm91cF9yYW1ibGVfbXNnX2J5X3NlcVwiLHlzPVwibW9kaWZ5X2dyb3VwX21zZ1wiLElzPVwic2V0X2dyb3VwX2F0dHJcIixDcz1cIm1vZGlmeV9ncm91cF9hdHRyXCIsVHM9XCJkZWxldGVfZ3JvdXBfYXR0clwiLERzPVwiY2xlYXJfZ3JvdXBfYXR0clwiLGtzPVwiZ2V0X2dyb3VwX2F0dHJcIixFcz1cImdyb3VwX3NldF9rZXlfdmFsdWVzXCIsU3M9XCJncm91cF9nZXRfa2V5X3ZhbHVlc1wiLExzPVwiZ2V0X2dyb3VwX25vdGlmeVwiLEFzPVwidXBkYXRlX2dyb3VwX2NvdW50ZXJcIixScz1cImdldF9ncm91cF9jb3VudGVyXCIsTnM9XCJnZXRfZ3JvdXBfbWVtYmVyX2luZm9cIixPcz1cImdldF9tZW1iZXJzXCIsR3M9XCJnZXRfc3BlY2lmaWVkX2dyb3VwX21lbWJlcl9pbmZvXCIsVXM9XCJhZGRfZ3JvdXBfbWVtYmVyXCIsUHM9XCJkZWxldGVfZ3JvdXBfbWVtYmVyXCIsYnM9XCJiYW5fZ3JvdXBfbWVtYmVyXCIsd3M9XCJtb2RpZnlfZ3JvdXBfbWVtYmVyX2luZm9cIixGcz1cIm1vZGlmeV91c2VyX2luZm9cIixxcz1cImNvc1wiLHhzPVwicHJlX3NpZ1wiLFZzPVwidmlkZW9fY292ZXJcIixCcz1cInRpbV93ZWJfcmVwb3J0X3YyXCIsSHM9XCJhbGl2ZVwiLEtzPVwibXNnX3B1c2hcIixXcz1cIm11bHRpX21zZ19wdXNoX3dzXCIsWXM9XCJ3c19tc2dfcHVzaF9hY2tcIixqcz1cInN0YXRfZm9yY2VvZmZsaW5lXCIsenM9XCJzYXZlX3JlbGF5X2pzb25fbXNnXCIsSnM9XCJnZXRfcmVsYXlfanNvbl9tc2dcIixYcz1cImZldGNoX2NvbmZpZ1wiLFpzPVwicHVzaF9jb25maWd2MlwiLFFzPVwiZmV0Y2hfaW1zZGtfcHVyY2hhc2VfYml0c3YyXCIsJHM9XCJwdXNoX2ltc2RrX3B1cmNoYXNlX2JpdHN2MlwiLGVhPVwibm90aWZ5MlwiLHRhPVwiY3JlYXRlX3RvcGljXCIsbmE9XCJkZXN0cm95X3RvcGljXCIsb2E9XCJtb2RpZnlfdG9waWNcIixzYT1cImdldF90b3BpY1wiLGFhPVwid3Nfc2V0X2N1c3RvbV9zdGF0dXNcIixpYT1cIndzX2dldF91c2VyX3N0YXR1c1wiLHJhPVwid3Nfc3RhdHVzX3N1YnNjcmliZVwiLHVhPVwid3Nfc3RhdHVzX3Vuc3Vic2NyaWJlXCIsY2E9XCJ3c19zdGF0X2JhY2tncm91bmRcIixsYT1cIndzX3N0YXRfZm9yZWdyb3VuZFwiLGRhPVwid3Nfc3RhdF9zZXR0b2tlblwiLHBhPVwiZ2V0X2xvY2FsX3dvcmRzXCIsZ2E9XCJ3c19iYXRjaF90cmFuc190ZXh0XCIsaGE9e05PX1NES0FQUElEOjJlMyxOT19BQ0NPVU5UX1RZUEU6MjAwMSxOT19JREVOVElGSUVSOjIwMDIsTk9fVVNFUlNJRzoyMDAzLE5PX1RJTllJRDoyMDIyLE5PX0EyS0VZOjIwMjMsVVNFUl9OT1RfTE9HR0VEX0lOOjIwMjQsUkVQRUFUX0xPR0lOOjIwMjUsQ09TX1VOREVURUNURUQ6MjA0MCxDT1NfR0VUX1NJR19GQUlMOjIwNDEsTUVTU0FHRV9TRU5EX0ZBSUw6MjEwMCxNRVNTQUdFX1NFTkRfRkFJTF9OT1RfSU5fQVZDSEFUUk9PTToyMTAxLE1FU1NBR0VfU0VORF9ORUVEX01FU1NBR0VfSU5TVEFOQ0U6MjEwNSxNRVNTQUdFX1NFTkRfSU5WQUxJRF9DT05WRVJTQVRJT05fVFlQRToyMTA2LE1FU1NBR0VfRklMRV9JU19FTVBUWToyMTA4LE1FU1NBR0VfT05QUk9HUkVTU19GVU5DVElPTl9FUlJPUjoyMTA5LE1FU1NBR0VfUkVWT0tFX0ZBSUw6MjExMCxNRVNTQUdFX0RFTEVURV9GQUlMOjIxMTEsTUVTU0FHRV9VTlJFQURfQUxMX0ZBSUw6MjExMixSRUFEX1JFQ0VJUFRfTUVTU0FHRV9MSVNUX0VNUFRZOjIxMTQsTUVTU0FHRV9TRU5EX0dST1VQX1dJVEhfVE9QSUNfRkFJTDoyMTE1LENBTk5PVF9ERUxFVEVfR1JPVVBfU1lTVEVNX05PVElDRToyMTE2LFRSQU5TTEFURV9URVhUX0ZBSUw6MjExNyxNRVNTQUdFX0lNQUdFX1NFTEVDVF9GSUxFX0ZJUlNUOjIyNTEsTUVTU0FHRV9JTUFHRV9UWVBFU19MSU1JVDoyMjUyLE1FU1NBR0VfSU1BR0VfU0laRV9MSU1JVDoyMjUzLE1FU1NBR0VfQVVESU9fVVBMT0FEX0ZBSUw6MjMwMCxNRVNTQUdFX0FVRElPX1NJWkVfTElNSVQ6MjMwMSxNRVNTQUdFX1ZJREVPX1VQTE9BRF9GQUlMOjIzNTAsTUVTU0FHRV9WSURFT19TSVpFX0xJTUlUOjIzNTEsTUVTU0FHRV9WSURFT19UWVBFU19MSU1JVDoyMzUyLE1FU1NBR0VfRklMRV9VUExPQURfRkFJTDoyNDAwLE1FU1NBR0VfRklMRV9TRUxFQ1RfRklMRV9GSVJTVDoyNDAxLE1FU1NBR0VfRklMRV9TSVpFX0xJTUlUOjI0MDIsTUVTU0FHRV9GSUxFX1VSTF9JU19FTVBUWToyNDAzLE1FU1NBR0VfTUVSR0VSX1RZUEVfSU5WQUxJRDoyNDUwLE1FU1NBR0VfTUVSR0VSX0tFWV9JTlZBTElEOjI0NTEsTUVTU0FHRV9NRVJHRVJfRE9XTkxPQURfRkFJTDoyNDUyLE1FU1NBR0VfRk9SV0FSRF9UWVBFX0lOVkFMSUQ6MjQ1MyxNRVNTQUdFX01PRElGWV9DT05GTElDVDoyNDgwLE1FU1NBR0VfTU9ESUZZX0RJU0FCTEVEX0lOX0FWQ0hBVFJPT006MjQ4MSxDT05WRVJTQVRJT05fTk9UX0ZPVU5EOjI1MDAsVVNFUl9PUl9HUk9VUF9OT1RfRk9VTkQ6MjUwMSxDT05WRVJTQVRJT05fVU5fUkVDT1JERURfVFlQRToyNTAyLElOVkFMSURfQ09OVkVSU0FUSU9OX0lEOjI1MDMsSUxMRUdBTF9HUk9VUF9UWVBFOjI2MDAsQ0FOTk9UX0pPSU5fV09SSzoyNjAxLElMTEVHQUxfR1JPVVBfSUQ6MjYwMixDQU5OT1RfRklORF9HUk9VUDoyNjAzLENBTk5PVF9DSEFOR0VfT1dORVJfSU5fQVZDSEFUUk9PTToyNjIwLENBTk5PVF9DSEFOR0VfT1dORVJfVE9fU0VMRjoyNjIxLENBTk5PVF9ESVNNSVNTX1dPUks6MjYyMixNRU1CRVJfTk9UX0lOX0dST1VQOjI2MjMsSk9JTl9HUk9VUF9GQUlMOjI2NjAsQ0FOTk9UX0FERF9NRU1CRVJfSU5fQVZDSEFUUk9PTToyNjYxLENBTk5PVF9KT0lOX05PTl9BVkNIQVRST09NX1dJVEhPVVRfTE9HSU46MjY2MixOT1RfT1dORVI6MjY4MSxDQU5OT1RfU0VUX01FTUJFUl9ST0xFX0lOX1dPUktfQU5EX0FWQ0hBVFJPT006MjY4MixJTlZBTElEX01FTUJFUl9ST0xFOjI2ODMsQ0FOTk9UX1NFVF9TRUxGX01FTUJFUl9ST0xFOjI2ODQsQ0FOTk9UX01VVEVfU0VMRjoyNjg1LEJBTl9EVVJBVElPTl9JTlZBTElEOjI2ODYsTk9UX01ZX0ZSSUVORDoyNzAwLEFMUkVBRFlfTVlfRlJJRU5EOjI3MDEsRlJJRU5EX0dST1VQX0VYSVNURUQ6MjcxMCxGUklFTkRfR1JPVVBfTk9UX0VYSVNUOjI3MTEsRlJJRU5EX0FQUExJQ0FUSU9OX05PVF9FWElTVDoyNzE2LFVQREFURV9QUk9GSUxFX0lOVkFMSURfUEFSQU06MjcyMSxVUERBVEVfUFJPRklMRV9OT19LRVk6MjcyMixDQU5OT1RfQUREX1NFTEZfVE9fQkxBQ0tMSVNUOjI3NDIsTkVUV09SS19FUlJPUjoyODAwLE5FVFdPUktfVElNRU9VVDoyODAxLE5PX05FVFdPUks6MjgwNSxVTkNBVUdIVF9FUlJPUjoyOTAzLElOVkFMSURfT1BFUkFUSU9OOjI5MDUsSU5WQUxJRF9UUlRDX0NNRDoyOTk1LE9WRVJfRlJFUVVFTkNZX0xJTUlUOjI5OTYsQ0FOTk9UX0ZJTkRfUFJPVE9DT0w6Mjk5NyxDQU5OT1RfRklORF9NT0RVTEU6Mjk5OCxTREtfSVNfTk9UX1JFQURZOjI5OTksTE9HR0lOR19JTjozZTMsTE9HSU5fRkFJTEVEOjMwMDEsS0lDS0VEX09VVF9NVUxUX0RFVklDRTozMDAyLEtJQ0tFRF9PVVRfTVVMVF9BQ0NPVU5UOjMwMDMsS0lDS0VEX09VVF9VU0VSU0lHX0VYUElSRUQ6MzAwNCxMT0dHRURfT1VUOjMwMDUsS0lDS0VEX09VVF9SRVNUX0FQSTozMDA2LElMTEVHQUxfVE9QSUNfSUQ6MzAyMSxDQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWTozMTIyLFBST0ZBTklUWV9GT1VORDozMTIzLE1FU1NBR0VfQTJLRVlfRVhQSVJFRDoyMDAwMixBQ0NPVU5UX0EyS0VZX0VYUElSRUQ6NzAwMDEsSEVMTE9fQU5TV0VSX0tJQ0tFRF9PVVQ6MTAwMixPUEVOX1NFUlZJQ0VfT1ZFUkxPQURfRVJST1I6NjAwMjJ9LF9hPVwibmV0d29ya1JUVFwiLGZhPVwibWVzc2FnZUUyRURlbGF5XCIsdmE9XCJzZW5kTWVzc2FnZUMyQ1wiLG1hPVwic2VuZE1lc3NhZ2VHcm91cFwiLE1hPVwic2VuZE1lc3NhZ2VHcm91cEFWXCIseWE9XCJzZW5kTWVzc2FnZVJpY2hNZWRpYVwiLElhPVwiY29zVXBsb2FkXCIsQ2E9XCJtZXNzYWdlUmVjZWl2ZWRHcm91cFwiLFRhPVwibWVzc2FnZVJlY2VpdmVkR3JvdXBBVlB1c2hcIixEYT1cIm1lc3NhZ2VSZWNlaXZlZEdyb3VwQVZQdWxsXCIsa2E9KGkoWnQ9e30sX2EsMiksaShadCxmYSwzKSxpKFp0LHZhLDQpLGkoWnQsbWEsNSksaShadCxNYSw2KSxpKFp0LHlhLDcpLGkoWnQsQ2EsOCksaShadCxUYSw5KSxpKFp0LERhLDEwKSxpKFp0LElhLDExKSxadCksRWE9e2luZm86NCx3YXJuaW5nOjUsZXJyb3I6Nn0sU2E9e3dpZmk6MSxcIjJnXCI6MixcIjNnXCI6MyxcIjRnXCI6NCxcIjVnXCI6NSx1bmtub3duOjYsbm9uZTo3LG9ubGluZTo4fSxMYT17bG9naW46NH0sQWE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9uPVwiU1NPTG9nRGF0YVwiLHRoaXMuZXZlbnRUeXBlPUxhW3RdfHwwLHRoaXMudGltZXN0YW1wPTAsdGhpcy5uZXR3b3JrVHlwZT04LHRoaXMuY29kZT0wLHRoaXMubWVzc2FnZT1cIlwiLHRoaXMubW9yZU1lc3NhZ2U9XCJcIix0aGlzLmV4dGVuc2lvbj10LHRoaXMuY29zdFRpbWU9MCx0aGlzLmR1cGxpY2F0ZT0hMSx0aGlzLmxldmVsPTQsdGhpcy51aVBsYXRmb3JtPXZvaWQgMCx0aGlzLl9zZW50RmxhZz0hMSx0aGlzLl9zdGFydHRzPVBlKCl9cmV0dXJuIGEoZSxbe2tleTpcInVwZGF0ZVRpbWVTdGFtcFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy50aW1lc3RhbXA9UGUoKX19LHtrZXk6XCJzdGFydFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9zdGFydHRzPWUsdGhpc319LHtrZXk6XCJlbmRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXSYmYXJndW1lbnRzWzBdO2lmKCF0aGlzLl9zZW50RmxhZyl7dmFyIG49UGUoKTswPT09dGhpcy5jb3N0VGltZSYmKHRoaXMuY29zdFRpbWU9bi10aGlzLl9zdGFydHRzKSx0aGlzLnNldE1vcmVNZXNzYWdlKFwic3RhcnR0czpcIi5jb25jYXQodGhpcy5fc3RhcnR0cyxcIiBlbmR0czpcIikuY29uY2F0KG4pKSx0Pyh0aGlzLl9zZW50RmxhZz0hMCx0aGlzLl9ldmVudFN0YXRNb2R1bGUmJnRoaXMuX2V2ZW50U3RhdE1vZHVsZS5wdXNoSW4odGhpcykpOnNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ZS5fc2VudEZsYWc9ITAsZS5fZXZlbnRTdGF0TW9kdWxlJiZlLl9ldmVudFN0YXRNb2R1bGUucHVzaEluKGUpfSksMCl9fX0se2tleTpcInNldEVycm9yXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe2lmKCEoZSBpbnN0YW5jZW9mIEVycm9yKSlyZXR1cm4gVmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnNldEVycm9yIHZhbHVlIG5vdCBpbnN0YW5jZW9mIEVycm9yLCBwbGVhc2UgY2hlY2shXCIpKSx0aGlzO2lmKHRoaXMuX3NlbnRGbGFnKXJldHVybiB0aGlzO2lmKHRoaXMuc2V0TmV0d29ya1R5cGUobiksdCllLmNvZGUmJnRoaXMuc2V0Q29kZShlLmNvZGUpLGUubWVzc2FnZSYmdGhpcy5zZXRNb3JlTWVzc2FnZShlLm1lc3NhZ2UpO2Vsc2V7dmFyIG89aGEuTk9fTkVUV09SSzt0aGlzLnNldENvZGUobyl9cmV0dXJuIHRoaXMuc2V0TGV2ZWwoXCJlcnJvclwiKSx0aGlzfX0se2tleTpcInNldENvZGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSl8fHRoaXMuX3NlbnRGbGFnfHwoXCJFQ09OTkFCT1JURURcIj09PWUmJih0aGlzLmNvZGU9MTAzKSxldChlKT90aGlzLmNvZGU9ZTpWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIuc2V0Q29kZSB2YWx1ZSBub3QgYSBudW1iZXIsIHBsZWFzZSBjaGVjayFcIiksZSxuKGUpKSksdGhpc319LHtrZXk6XCJzZXRNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGl0KGUpfHx0aGlzLl9zZW50RmxhZ3x8KGV0KGUpJiYodGhpcy5tZXNzYWdlPWUudG9TdHJpbmcoKSksbnQoZSkmJih0aGlzLm1lc3NhZ2U9ZSkpLHRoaXN9fSx7a2V5Olwic2V0Q29zdFRpbWVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jb3N0VGltZT1lLHRoaXN9fSx7a2V5Olwic2V0TGV2ZWxcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSl8fHRoaXMuX3NlbnRGbGFnfHwodGhpcy5sZXZlbD1FYVtlXSksdGhpc319LHtrZXk6XCJzZXRNb3JlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB6dCh0aGlzLm1vcmVNZXNzYWdlKT90aGlzLm1vcmVNZXNzYWdlPVwiXCIuY29uY2F0KGUpOnRoaXMubW9yZU1lc3NhZ2UrPVwiIFwiLmNvbmNhdChlKSx0aGlzfX0se2tleTpcInNldE5ldHdvcmtUeXBlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoaXQoZSkpVmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnNldE5ldHdvcmtUeXBlIHZhbHVlIGlzIHVuZGVmaW5lZCwgcGxlYXNlIGNoZWNrIVwiKSk7ZWxzZXt2YXIgdD1TYVtlLnRvTG93ZXJDYXNlKCldO2l0KHQpfHwodGhpcy5uZXR3b3JrVHlwZT10KX1yZXR1cm4gdGhpc319LHtrZXk6XCJnZXRTdGFydFRzXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhcnR0c319LHtrZXk6XCJzZXRVSVBsYXRmb3JtXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy51aVBsYXRmb3JtPWV9fV0sW3trZXk6XCJiaW5kRXZlbnRTdGF0TW9kdWxlXCIsdmFsdWU6ZnVuY3Rpb24odCl7ZS5wcm90b3R5cGUuX2V2ZW50U3RhdE1vZHVsZT10fX1dKSxlfSgpLFJhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX1RFWFQsdGhpcy5jb250ZW50PXt0ZXh0OnQudGV4dHx8XCJcIn19cmV0dXJuIGEoZSxbe2tleTpcInNldFRleHRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmNvbnRlbnQudGV4dD1lfX0se2tleTpcInNlbmRhYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gMCE9PXRoaXMuY29udGVudC50ZXh0Lmxlbmd0aH19XSksZX0oKSxOYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXtvKHRoaXMsZSksdGhpcy5faW1hZ2VNZW1vcnlVUkw9XCJcIix0aGlzLl9maWxlRG93bmxvYWRQcm94eT1uLGFlP3RoaXMuY3JlYXRlSW1hZ2VEYXRhQVNVUkxJbldYTWluaUFwcCh0LmZpbGUpOnRoaXMuY3JlYXRlSW1hZ2VEYXRhQVNVUkxJbldlYih0LmZpbGUpLHRoaXMuX2luaXRJbWFnZUluZm9Nb2RlbCgpLHRoaXMudHlwZT1FLk1TR19JTUFHRSx0aGlzLl9wZXJjZW50PTAsdGhpcy5jb250ZW50PXtpbWFnZUZvcm1hdDp0LmltYWdlRm9ybWF0fHxCZS5VTktOT1dOLHV1aWQ6dC51dWlkLGltYWdlSW5mb0FycmF5OltdfSx0aGlzLmluaXRJbWFnZUluZm9BcnJheSh0LmltYWdlSW5mb0FycmF5KSx0aGlzLl9hdXRvRml4VXJsKCl9cmV0dXJuIGEoZSxbe2tleTpcIl9pbml0SW1hZ2VJbmZvTW9kZWxcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5fSW1hZ2VJbmZvTW9kZWw9ZnVuY3Rpb24odCl7dGhpcy5pbnN0YW5jZUlEPV90KDk5OTk5OTkpLHRoaXMuc2l6ZVR5cGU9dC50eXBlfHwwLHRoaXMudHlwZT0wLHRoaXMuc2l6ZT10LnNpemV8fDAsdGhpcy53aWR0aD10LndpZHRofHwwLHRoaXMuaGVpZ2h0PXQuaGVpZ2h0fHwwLHRoaXMuaW1hZ2VVcmw9dC51cmx8fFwiXCIsdGhpcy51cmw9WXQodC51cmx8fGUuX2ltYWdlTWVtb3J5VVJMLGUuX2ZpbGVEb3dubG9hZFByb3h5KX0sdGhpcy5fSW1hZ2VJbmZvTW9kZWwucHJvdG90eXBlPXtzZXRTaXplVHlwZTpmdW5jdGlvbihlKXt0aGlzLnNpemVUeXBlPWV9LHNldFR5cGU6ZnVuY3Rpb24oZSl7dGhpcy50eXBlPWV9LHNldEltYWdlVXJsOmZ1bmN0aW9uKGUpe2UmJih0aGlzLmltYWdlVXJsPWUpfSxnZXRJbWFnZVVybDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmltYWdlVXJsfX19fSx7a2V5OlwiaW5pdEltYWdlSW5mb0FycmF5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTAsbj1udWxsLG89bnVsbDt0PD0yOylvPWl0KGUpfHxpdChlW3RdKT97dHlwZTowLHNpemU6MCx3aWR0aDowLGhlaWdodDowLHVybDpcIlwifTplW3RdLChuPW5ldyB0aGlzLl9JbWFnZUluZm9Nb2RlbChvKSkuc2V0U2l6ZVR5cGUodCsxKSxuLnNldFR5cGUodCksdGhpcy5hZGRJbWFnZUluZm8obiksdCsrO3RoaXMudXBkYXRlQWNjZXNzU2lkZUltYWdlSW5mb0FycmF5KCl9fSx7a2V5OlwidXBkYXRlSW1hZ2VJbmZvQXJyYXlcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQsbj10aGlzLmNvbnRlbnQuaW1hZ2VJbmZvQXJyYXkubGVuZ3RoLG89MDtvPG47bysrKXQ9dGhpcy5jb250ZW50LmltYWdlSW5mb0FycmF5W29dLGVbb10uc2l6ZSYmKHQuc2l6ZT1lW29dLnNpemUpLGVbb10udXJsJiZ0LnNldEltYWdlVXJsKGVbb10udXJsKSxlW29dLndpZHRoJiYodC53aWR0aD1lW29dLndpZHRoKSxlW29dLmhlaWdodCYmKHQuaGVpZ2h0PWVbb10uaGVpZ2h0KX19LHtrZXk6XCJfYXV0b0ZpeFVybFwiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMuY29udGVudC5pbWFnZUluZm9BcnJheS5sZW5ndGgsdD1cIlwiLG49XCJcIixvPVtcImh0dHBcIixcImh0dHBzXCJdLHM9bnVsbCxhPTA7YTxlO2ErKyl0aGlzLmNvbnRlbnQuaW1hZ2VJbmZvQXJyYXlbYV0udXJsJiZcIlwiIT09KHM9dGhpcy5jb250ZW50LmltYWdlSW5mb0FycmF5W2FdKS5pbWFnZVVybCYmKG49cy5pbWFnZVVybC5zbGljZSgwLHMuaW1hZ2VVcmwuaW5kZXhPZihcIjovL1wiKSsxKSx0PXMuaW1hZ2VVcmwuc2xpY2Uocy5pbWFnZVVybC5pbmRleE9mKFwiOi8vXCIpKzEpLG8uaW5kZXhPZihuKTwwJiYobj1cImh0dHBzOlwiKSx0aGlzLmNvbnRlbnQuaW1hZ2VJbmZvQXJyYXlbYV0uc2V0SW1hZ2VVcmwoW24sdF0uam9pbihcIlwiKSkpfX0se2tleTpcInVwZGF0ZVBlcmNlbnRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9wZXJjZW50PWUsdGhpcy5fcGVyY2VudD4xJiYodGhpcy5fcGVyY2VudD0xKX19LHtrZXk6XCJ1cGRhdGVJbWFnZUZvcm1hdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuY29udGVudC5pbWFnZUZvcm1hdD1CZVtlLnRvVXBwZXJDYXNlKCldfHxCZS5VTktOT1dOfX0se2tleTpcImNyZWF0ZUltYWdlRGF0YUFTVVJMSW5XZWJcIix2YWx1ZTpmdW5jdGlvbihlKXt2b2lkIDAhPT1lJiZlLmZpbGVzLmxlbmd0aD4wJiYodGhpcy5faW1hZ2VNZW1vcnlVUkw9d2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoZS5maWxlc1swXSkpfX0se2tleTpcImNyZWF0ZUltYWdlRGF0YUFTVVJMSW5XWE1pbmlBcHBcIix2YWx1ZTpmdW5jdGlvbihlKXtlJiZlLnVybCYmKHRoaXMuX2ltYWdlTWVtb3J5VVJMPWUudXJsKX19LHtrZXk6XCJyZXBsYWNlSW1hZ2VJbmZvXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLmNvbnRlbnQuaW1hZ2VJbmZvQXJyYXlbdF1pbnN0YW5jZW9mIHRoaXMuX0ltYWdlSW5mb01vZGVsfHwodGhpcy5jb250ZW50LmltYWdlSW5mb0FycmF5W3RdPWUpfX0se2tleTpcImFkZEltYWdlSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuY29udGVudC5pbWFnZUluZm9BcnJheS5sZW5ndGg+PTN8fHRoaXMuY29udGVudC5pbWFnZUluZm9BcnJheS5wdXNoKGUpfX0se2tleTpcInVwZGF0ZUFjY2Vzc1NpZGVJbWFnZUluZm9BcnJheVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5jb250ZW50LmltYWdlSW5mb0FycmF5LHQ9ZVswXSxuPXQud2lkdGgsbz12b2lkIDA9PT1uPzA6bixzPXQuaGVpZ2h0LGE9dm9pZCAwPT09cz8wOnM7MCE9PW8mJjAhPT1hJiYoUHQoZSksT2JqZWN0LmFzc2lnbihlWzJdLFV0KHtvcmlnaW5XaWR0aDpvLG9yaWdpbkhlaWdodDphLG1pbjo3MjB9KSkpfX0se2tleTpcInNlbmRhYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gMCE9PXRoaXMuY29udGVudC5pbWFnZUluZm9BcnJheS5sZW5ndGgmJihcIlwiIT09dGhpcy5jb250ZW50LmltYWdlSW5mb0FycmF5WzBdLmltYWdlVXJsJiYwIT09dGhpcy5jb250ZW50LmltYWdlSW5mb0FycmF5WzBdLnNpemUpfX1dKSxlfSgpLE9hPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX0ZBQ0UsdGhpcy5jb250ZW50PXR8fG51bGx9cmV0dXJuIGEoZSxbe2tleTpcInNlbmRhYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbCE9PXRoaXMuY29udGVudH19XSksZX0oKSxHYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXtvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX0FVRElPLHRoaXMuX3BlcmNlbnQ9MCx0aGlzLmNvbnRlbnQ9e2Rvd25sb2FkRmxhZzoyLHNlY29uZDp0LnNlY29uZCxzaXplOnQuc2l6ZSx1cmw6WXQodC51cmwsbikscmVtb3RlQXVkaW9Vcmw6dC51cmx8fFwiXCIsdXVpZDp0LnV1aWR9fXJldHVybiBhKGUsW3trZXk6XCJ1cGRhdGVQZXJjZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcGVyY2VudD1lLHRoaXMuX3BlcmNlbnQ+MSYmKHRoaXMuX3BlcmNlbnQ9MSl9fSx7a2V5OlwidXBkYXRlQXVkaW9VcmxcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmNvbnRlbnQucmVtb3RlQXVkaW9Vcmw9ZX19LHtrZXk6XCJzZW5kYWJsZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuXCJcIiE9PXRoaXMuY29udGVudC5yZW1vdGVBdWRpb1VybH19XSksZX0oKSxVYT17ZnJvbTohMCxncm91cElEOiEwLGdyb3VwTmFtZTohMCx0bzohMH0sUGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLnR5cGU9RS5NU0dfR1JQX1RJUCx0aGlzLmNvbnRlbnQ9e30sdGhpcy5faW5pdENvbnRlbnQodCl9cmV0dXJuIGEoZSxbe2tleTpcIl9pbml0Q29udGVudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7T2JqZWN0LmtleXMoZSkuZm9yRWFjaCgoZnVuY3Rpb24obil7c3dpdGNoKG4pe2Nhc2VcInJlbWFya0luZm9cIjpicmVhaztjYXNlXCJncm91cFByb2ZpbGVcIjp0LmNvbnRlbnQuZ3JvdXBQcm9maWxlPXt9LHQuX2luaXRHcm91cFByb2ZpbGUoZVtuXSk7YnJlYWs7Y2FzZVwib3BlcmF0b3JJbmZvXCI6YnJlYWs7Y2FzZVwibWVtYmVySW5mb0xpc3RcIjpjYXNlXCJtc2dNZW1iZXJJbmZvXCI6dC5fdXBkYXRlTWVtYmVyTGlzdChlW25dKTticmVhaztjYXNlXCJtZW1iZXJFeHRyYUluZm9cIjpjYXNlXCJvbmxpbmVNZW1iZXJJbmZvXCI6YnJlYWs7Y2FzZVwibWVtYmVyTnVtXCI6dC5jb250ZW50W25dPWVbbl0sdC5jb250ZW50Lm1lbWJlckNvdW50PWVbbl07YnJlYWs7Y2FzZVwibmV3R3JvdXBQcm9maWxlXCI6dC5jb250ZW50Lm5ld0dyb3VwUHJvZmlsZT17fSx0Ll9pbml0TmV3R3JvdXBQcm9maWxlKGVbbl0pO2JyZWFrO2RlZmF1bHQ6dC5jb250ZW50W25dPWVbbl19fSkpLHRoaXMuY29udGVudC51c2VySURMaXN0fHwodGhpcy5jb250ZW50LnVzZXJJRExpc3Q9W3RoaXMuY29udGVudC5vcGVyYXRvcklEXSl9fSx7a2V5OlwiX2luaXRHcm91cFByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7bisrKXt2YXIgbz10W25dO1VhW29dJiYodGhpcy5jb250ZW50Lmdyb3VwUHJvZmlsZVtvXT1lW29dKX19fSx7a2V5OlwiX3VwZGF0ZU1lbWJlckxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt6dCh0aGlzLmNvbnRlbnQubWVtYmVyTGlzdCk/dGhpcy5jb250ZW50Lm1lbWJlckxpc3Q9ZTp0aGlzLmNvbnRlbnQubWVtYmVyTGlzdC5mb3JFYWNoKChmdW5jdGlvbih0KXtlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QudXNlcklEPT09ZS51c2VySUQmJk9iamVjdC5hc3NpZ24odCxlKX0pKX0pKX19LHtrZXk6XCJfaW5pdE5ld0dyb3VwUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1PYmplY3Qua2V5cyhlKSxuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBvPXRbbl07XCJtdXRlQWxsTWVtYmVyc1wiIT09bz90aGlzLmNvbnRlbnQubmV3R3JvdXBQcm9maWxlW29dPWVbb106dGhpcy5jb250ZW50Lm5ld0dyb3VwUHJvZmlsZVtvXT0xPT09ZVtvXX19fV0pLGV9KCksYmE9e2Zyb206ITAsZ3JvdXBJRDohMCxncm91cE5hbWU6ITAsdG86ITB9LHdhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX0dSUF9TWVNfTk9USUNFLHRoaXMuY29udGVudD17fSx0aGlzLl9pbml0Q29udGVudCh0KX1yZXR1cm4gYShlLFt7a2V5OlwiX2luaXRDb250ZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihuKXtzd2l0Y2gobil7Y2FzZVwibWVtYmVySW5mb0xpc3RcIjpicmVhaztjYXNlXCJyZW1hcmtJbmZvXCI6dC5jb250ZW50LmhhbmRsZU1lc3NhZ2U9ZVtuXTticmVhaztjYXNlXCJncm91cFByb2ZpbGVcIjp0LmNvbnRlbnQuZ3JvdXBQcm9maWxlPXt9LHQuX2luaXRHcm91cFByb2ZpbGUoZVtuXSk7YnJlYWs7ZGVmYXVsdDp0LmNvbnRlbnRbbl09ZVtuXX19KSl9fSx7a2V5OlwiX2luaXRHcm91cFByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9T2JqZWN0LmtleXMoZSksbj0wO248dC5sZW5ndGg7bisrKXt2YXIgbz10W25dO2JhW29dJiYoXCJncm91cE5hbWVcIj09PW8/dGhpcy5jb250ZW50Lmdyb3VwUHJvZmlsZS5uYW1lPWVbb106dGhpcy5jb250ZW50Lmdyb3VwUHJvZmlsZVtvXT1lW29dKX19fV0pLGV9KCksRmE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsbil7byh0aGlzLGUpLHRoaXMudHlwZT1FLk1TR19GSUxFLHRoaXMuX3BlcmNlbnQ9MDt2YXIgcz10aGlzLl9nZXRGaWxlSW5mbyh0KTt0aGlzLmNvbnRlbnQ9e2Rvd25sb2FkRmxhZzoyLGZpbGVVcmw6WXQodC51cmwsbil8fFwiXCIsdXVpZDp0LnV1aWQsZmlsZU5hbWU6cy5uYW1lfHxcIlwiLGZpbGVTaXplOnMuc2l6ZXx8MH19cmV0dXJuIGEoZSxbe2tleTpcIl9nZXRGaWxlSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFpdChlLmZpbGVOYW1lKSYmIWl0KGUuZmlsZVNpemUpKXJldHVybntzaXplOmUuZmlsZVNpemUsbmFtZTplLmZpbGVOYW1lfTt2YXIgdD1lLmZpbGUuZmlsZXNbMF07aWYob2Upe2lmKHQucGF0aCYmLTEhPT10LnBhdGguaW5kZXhPZihcIi5cIikpe3ZhciBuPXQucGF0aC5zbGljZSh0LnBhdGgubGFzdEluZGV4T2YoXCIuXCIpKzEpLnRvTG93ZXJDYXNlKCk7dC50eXBlPW4sdC5uYW1lfHwodC5uYW1lPVwiXCIuY29uY2F0KF90KDk5OTk5OSksXCIuXCIpLmNvbmNhdChuKSl9dC5uYW1lfHwodC50eXBlPVwiXCIsdC5uYW1lPXQucGF0aC5zbGljZSh0LnBhdGgubGFzdEluZGV4T2YoXCIvXCIpKzEpLnRvTG93ZXJDYXNlKCkpLHQuc3VmZml4JiYodC50eXBlPXQuc3VmZml4KSx0LnVybHx8KHQudXJsPXQucGF0aCl9cmV0dXJue3NpemU6dC5zaXplLG5hbWU6dC5uYW1lfX19LHtrZXk6XCJ1cGRhdGVQZXJjZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcGVyY2VudD1lLHRoaXMuX3BlcmNlbnQ+MSYmKHRoaXMuX3BlcmNlbnQ9MSl9fSx7a2V5OlwidXBkYXRlRmlsZVVybFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuY29udGVudC5maWxlVXJsPWV9fSx7a2V5Olwic2VuZGFibGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVyblwiXCIhPT10aGlzLmNvbnRlbnQuZmlsZVVybCYmKFwiXCIhPT10aGlzLmNvbnRlbnQuZmlsZU5hbWUmJjAhPT10aGlzLmNvbnRlbnQuZmlsZVNpemUpfX1dKSxlfSgpLHFhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX0NVU1RPTSx0aGlzLmNvbnRlbnQ9e2RhdGE6dC5kYXRhfHxcIlwiLGRlc2NyaXB0aW9uOnQuZGVzY3JpcHRpb258fFwiXCIsZXh0ZW5zaW9uOnQuZXh0ZW5zaW9ufHxcIlwifX1yZXR1cm4gYShlLFt7a2V5Olwic2V0RGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNvbnRlbnQuZGF0YT1lLHRoaXN9fSx7a2V5Olwic2V0RGVzY3JpcHRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jb250ZW50LmRlc2NyaXB0aW9uPWUsdGhpc319LHtrZXk6XCJzZXRFeHRlbnNpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5jb250ZW50LmV4dGVuc2lvbj1lLHRoaXN9fSx7a2V5Olwic2VuZGFibGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiAwIT09dGhpcy5jb250ZW50LmRhdGEubGVuZ3RofHwwIT09dGhpcy5jb250ZW50LmRlc2NyaXB0aW9uLmxlbmd0aHx8MCE9PXRoaXMuY29udGVudC5leHRlbnNpb24ubGVuZ3RofX1dKSxlfSgpLHhhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4pe28odGhpcyxlKSx0aGlzLnR5cGU9RS5NU0dfVklERU8sdGhpcy5fcGVyY2VudD0wLHRoaXMuY29udGVudD17cmVtb3RlVmlkZW9Vcmw6dC5yZW1vdGVWaWRlb1VybHx8dC52aWRlb1VybHx8XCJcIix2aWRlb0Zvcm1hdDp0LnZpZGVvRm9ybWF0LHZpZGVvU2Vjb25kOnBhcnNlSW50KHQudmlkZW9TZWNvbmQsMTApLHZpZGVvU2l6ZTp0LnZpZGVvU2l6ZSx2aWRlb1VybDpZdCh0LnZpZGVvVXJsLG4pLHZpZGVvRG93bmxvYWRGbGFnOjIsdmlkZW9VVUlEOnQudmlkZW9VVUlELHRodW1iVVVJRDp0LnRodW1iVVVJRCx0aHVtYkZvcm1hdDp0LnRodW1iRm9ybWF0LHRodW1iV2lkdGg6dC50aHVtYldpZHRoLHNuYXBzaG90V2lkdGg6dC50aHVtYldpZHRoLHRodW1iSGVpZ2h0OnQudGh1bWJIZWlnaHQsc25hcHNob3RIZWlnaHQ6dC50aHVtYkhlaWdodCx0aHVtYlNpemU6dC50aHVtYlNpemUsc25hcHNob3RTaXplOnQudGh1bWJTaXplLHRodW1iRG93bmxvYWRGbGFnOjIsdGh1bWJVcmw6WXQodC50aHVtYlVybCxuKSxzbmFwc2hvdFVybDpZdCh0LnRodW1iVXJsLG4pfX1yZXR1cm4gYShlLFt7a2V5OlwidXBkYXRlUGVyY2VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX3BlcmNlbnQ9ZSx0aGlzLl9wZXJjZW50PjEmJih0aGlzLl9wZXJjZW50PTEpfX0se2tleTpcInVwZGF0ZVZpZGVvVXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSl7ZSYmKHRoaXMuY29udGVudC5yZW1vdGVWaWRlb1VybD1lKX19LHtrZXk6XCJ1cGRhdGVTbmFwc2hvdEluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnNuYXBzaG90VXJsLG49ZS5zbmFwc2hvdFdpZHRoLG89ZS5zbmFwc2hvdEhlaWdodDt6dCh0KXx8KHRoaXMuY29udGVudC50aHVtYlVybD10aGlzLmNvbnRlbnQuc25hcHNob3RVcmw9dCksenQobil8fCh0aGlzLmNvbnRlbnQudGh1bWJXaWR0aD10aGlzLmNvbnRlbnQuc25hcHNob3RXaWR0aD1OdW1iZXIobikpLHp0KG8pfHwodGhpcy5jb250ZW50LnRodW1iSGVpZ2h0PXRoaXMuY29udGVudC5zbmFwc2hvdEhlaWdodD1OdW1iZXIobykpfX0se2tleTpcInNlbmRhYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm5cIlwiIT09dGhpcy5jb250ZW50LnJlbW90ZVZpZGVvVXJsfX1dKSxlfSgpLFZhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX0xPQ0FUSU9OO3ZhciBuPXQuZGVzY3JpcHRpb24scz10LmxvbmdpdHVkZSxhPXQubGF0aXR1ZGU7dGhpcy5jb250ZW50PXtkZXNjcmlwdGlvbjpuLGxvbmdpdHVkZTpzLGxhdGl0dWRlOmF9fXJldHVybiBhKGUsW3trZXk6XCJzZW5kYWJsZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuITB9fV0pLGV9KCksQmE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsbil7aWYobyh0aGlzLGUpLHRoaXMuZnJvbT10LmZyb20sdGhpcy5tZXNzYWdlU2VuZGVyPXQuZnJvbSx0aGlzLnRpbWU9dC50aW1lLHRoaXMubWVzc2FnZVNlcXVlbmNlPXQuc2VxdWVuY2UsdGhpcy5jbGllbnRTZXF1ZW5jZT10LmNsaWVudFNlcXVlbmNlfHx0LnNlcXVlbmNlLHRoaXMubWVzc2FnZVJhbmRvbT10LnJhbmRvbSx0aGlzLmNsb3VkQ3VzdG9tRGF0YT10LmNsb3VkQ3VzdG9tRGF0YXx8XCJcIix0aGlzLmNsaWVudFRpbWU9dC5jbGllbnRUaW1lfHx2b2lkIDAsdC5JRCl0aGlzLklEPXQuSUR8fFwiXCIsdGhpcy5uaWNrPXQubmlja3x8XCJcIix0aGlzLmF2YXRhcj10LmF2YXRhcnx8XCJcIix0aGlzLm1lc3NhZ2VCb2R5PVt7dHlwZTp0LnR5cGUscGF5bG9hZDp0LnBheWxvYWR9XSx0LmNvbnZlcnNhdGlvblR5cGUuc3RhcnRzV2l0aChFLkNPTlZfQzJDKT90aGlzLnJlY2VpdmVyVXNlcklEPXQudG86dC5jb252ZXJzYXRpb25UeXBlLnN0YXJ0c1dpdGgoRS5DT05WX0dST1VQKSYmKHRoaXMucmVjZWl2ZXJHcm91cElEPXQudG8pLHRoaXMubWVzc2FnZVJlY2VpdmVyPXQudG87ZWxzZXt0aGlzLm5pY2s9dC5uaWNrfHxcIlwiLHRoaXMuYXZhdGFyPXQuYXZhdGFyfHxcIlwiLHRoaXMubWVzc2FnZUJvZHk9W107dmFyIHM9dC5lbGVtZW50c1swXS50eXBlLGE9dC5lbGVtZW50c1swXS5jb250ZW50O3RoaXMuX3BhdGNoUmljaE1lZGlhUGF5bG9hZChzLGEpLHRoaXMuX3VwZGF0ZVJpY2hNZWRpYURvd25sb2FkVXJsKHMsYSxuKSxzPT09RS5NU0dfTUVSR0VSP3RoaXMubWVzc2FnZUJvZHkucHVzaCh7dHlwZTpzLHBheWxvYWQ6bmV3IEhhKGEpLmNvbnRlbnR9KTp0aGlzLm1lc3NhZ2VCb2R5LnB1c2goe3R5cGU6cyxwYXlsb2FkOmF9KSx0Lmdyb3VwSUQmJih0aGlzLnJlY2VpdmVyR3JvdXBJRD10Lmdyb3VwSUQsdGhpcy5tZXNzYWdlUmVjZWl2ZXI9dC5ncm91cElEKSx0LnRvJiYodGhpcy5yZWNlaXZlclVzZXJJRD10LnRvLHRoaXMubWVzc2FnZVJlY2VpdmVyPXQudG8pLHRoaXMuSUQ9XCJcIi5jb25jYXQodC50aW55SUQsXCItXCIpLmNvbmNhdCh0LmNsaWVudFRpbWUsXCItXCIpLmNvbmNhdCh0LnJhbmRvbSl9fXJldHVybiBhKGUsW3trZXk6XCJfcGF0Y2hSaWNoTWVkaWFQYXlsb2FkXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtlPT09RS5NU0dfSU1BR0U/dC5pbWFnZUluZm9BcnJheS5mb3JFYWNoKChmdW5jdGlvbihlKXshZS5pbWFnZVVybCYmZS51cmwmJihlLmltYWdlVXJsPWUudXJsLGUuc2l6ZVR5cGU9ZS50eXBlLDE9PT1lLnR5cGU/ZS50eXBlPTA6Mz09PWUudHlwZSYmKGUudHlwZT0xKSl9KSk6ZT09PUUuTVNHX1ZJREVPPyF0LnJlbW90ZVZpZGVvVXJsJiZ0LnZpZGVvVXJsJiYodC5yZW1vdGVWaWRlb1VybD10LnZpZGVvVXJsKTplPT09RS5NU0dfQVVESU8/IXQucmVtb3RlQXVkaW9VcmwmJnQudXJsJiYodC5yZW1vdGVBdWRpb1VybD10LnVybCk6ZT09PUUuTVNHX0ZJTEUmJiF0LmZpbGVVcmwmJnQudXJsJiYodC5maWxlVXJsPXQudXJsLHQudXJsPXZvaWQgMCl9fSx7a2V5OlwiX3VwZGF0ZVJpY2hNZWRpYURvd25sb2FkVXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe24mJihlPT09RS5NU0dfSU1BR0U/dC5pbWFnZUluZm9BcnJheS5mb3JFYWNoKChmdW5jdGlvbihlKXtlLnVybD1ZdChlLnVybCxuKX0pKTplPT09RS5NU0dfVklERU8/KHQudmlkZW9Vcmw9WXQodC52aWRlb1VybCxuKSx0LnNuYXBzaG90VXJsPVl0KHQudGh1bWJVcmwsbiksdC5zbmFwc2hvdEhlaWdodD10LnRodW1iSGVpZ2h0LHQuc25hcHNob3RXaWR0aD10LnRodW1iV2lkdGgpOmU9PT1FLk1TR19BVURJTz90LnVybD1ZdCh0LnVybCxuKTplPT09RS5NU0dfRklMRSYmKHQuZmlsZVVybD1ZdCh0LmZpbGVVcmwsbikpKX19XSksZX0oKSxIYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXtpZihvKHRoaXMsZSksdGhpcy50eXBlPUUuTVNHX01FUkdFUix0aGlzLmNvbnRlbnQ9e2Rvd25sb2FkS2V5OlwiXCIscGJEb3dubG9hZEtleTpcIlwiLG1lc3NhZ2VMaXN0OltdLHRpdGxlOlwiXCIsYWJzdHJhY3RMaXN0OltdLGNvbXBhdGlibGVUZXh0OlwiXCIsdmVyc2lvbjowLGxheWVyc092ZXJMaW1pdDohMX0sdC5kb3dubG9hZEtleSl7dmFyIHM9dC5kb3dubG9hZEtleSxhPXQucGJEb3dubG9hZEtleSxpPXQudGl0bGUscj10LmFic3RyYWN0TGlzdCx1PXQuY29tcGF0aWJsZVRleHQsYz10LnZlcnNpb247dGhpcy5jb250ZW50LmRvd25sb2FkS2V5PXMsdGhpcy5jb250ZW50LnBiRG93bmxvYWRLZXk9YSx0aGlzLmNvbnRlbnQudGl0bGU9aSx0aGlzLmNvbnRlbnQuYWJzdHJhY3RMaXN0PXIsdGhpcy5jb250ZW50LmNvbXBhdGlibGVUZXh0PXUsdGhpcy5jb250ZW50LnZlcnNpb249Y3x8MH1lbHNlIGlmKHp0KHQubWVzc2FnZUxpc3QpKTE9PT10LmxheWVyc092ZXJMaW1pdCYmKHRoaXMuY29udGVudC5sYXllcnNPdmVyTGltaXQ9ITApO2Vsc2V7dmFyIGw9dC5tZXNzYWdlTGlzdCxkPXQudGl0bGUscD10LmFic3RyYWN0TGlzdCxnPXQuY29tcGF0aWJsZVRleHQsaD10LnZlcnNpb24sXz1bXTtsLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKCF6dChlKSl7dmFyIHQ9bmV3IEJhKGUsbik7Xy5wdXNoKHQpfX0pKSx0aGlzLmNvbnRlbnQubWVzc2FnZUxpc3Q9Xyx0aGlzLmNvbnRlbnQudGl0bGU9ZCx0aGlzLmNvbnRlbnQuYWJzdHJhY3RMaXN0PXAsdGhpcy5jb250ZW50LmNvbXBhdGlibGVUZXh0PWcsdGhpcy5jb250ZW50LnZlcnNpb249aHx8MH19cmV0dXJuIGEoZSxbe2tleTpcInNlbmRhYmxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4henQodGhpcy5jb250ZW50Lm1lc3NhZ2VMaXN0KXx8IXp0KHRoaXMuY29udGVudC5kb3dubG9hZEtleSl9fV0pLGV9KCksS2E9ezE6RS5NU0dfUFJJT1JJVFlfSElHSCwyOkUuTVNHX1BSSU9SSVRZX05PUk1BTCwzOkUuTVNHX1BSSU9SSVRZX0xPVyw0OkUuTVNHX1BSSU9SSVRZX0xPV0VTVH0sV2E9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLklEPVwiXCIsdGhpcy5jb252ZXJzYXRpb25JRD10LmNvbnZlcnNhdGlvbklEfHxudWxsLHRoaXMuY29udmVyc2F0aW9uVHlwZT10LmNvbnZlcnNhdGlvblR5cGV8fEUuQ09OVl9DMkMsdGhpcy5jb252ZXJzYXRpb25TdWJUeXBlPXQuY29udmVyc2F0aW9uU3ViVHlwZSx0aGlzLnRpbWU9dC50aW1lfHxNYXRoLmNlaWwoRGF0ZS5ub3coKS8xZTMpLHRoaXMuc2VxdWVuY2U9dC5zZXF1ZW5jZXx8MCx0aGlzLmNsaWVudFNlcXVlbmNlPXQuY2xpZW50U2VxdWVuY2V8fHQuc2VxdWVuY2V8fDAsdGhpcy5yYW5kb209dC5yYW5kb218fDA9PT10LnJhbmRvbT90LnJhbmRvbTpfdCgpLHRoaXMucHJpb3JpdHk9dGhpcy5fY29tcHV0ZVByaW9yaXR5KHQucHJpb3JpdHkpLHRoaXMubmljaz10Lm5pY2t8fFwiXCIsdGhpcy5hdmF0YXI9dC5hdmF0YXJ8fFwiXCIsdGhpcy5pc1BlZXJSZWFkPSExLHRoaXMubmFtZUNhcmQ9XCJcIix0aGlzLl9lbGVtZW50cz1bXSx0aGlzLmlzUGxhY2VNZXNzYWdlPXQuaXNQbGFjZU1lc3NhZ2V8fDAsdGhpcy5pc1Jldm9rZWQ9Mj09PXQuaXNQbGFjZU1lc3NhZ2V8fDg9PT10Lm1zZ0ZsYWdCaXRzLHRoaXMuZnJvbT10LmZyb218fG51bGwsdGhpcy50bz10LnRvfHxudWxsLHRoaXMuZmxvdz1cIlwiLHRoaXMuaXNTeXN0ZW1NZXNzYWdlPXQuaXNTeXN0ZW1NZXNzYWdlfHwhMSx0aGlzLnByb3RvY29sPXQucHJvdG9jb2x8fFwiSlNPTlwiLHRoaXMuaXNSZXNlbmQ9ITEsdGhpcy5pc1JlYWQ9ITEsdGhpcy5zdGF0dXM9dC5zdGF0dXN8fFF0LlNVQ0NFU1MsdGhpcy5fb25saW5lT25seUZsYWc9ITEsdGhpcy5fZ3JvdXBBdEluZm9MaXN0PVtdLHRoaXMuX3JlbGF5RmxhZz0hMSx0aGlzLmF0VXNlckxpc3Q9W10sdGhpcy5jbG91ZEN1c3RvbURhdGE9dC5jbG91ZEN1c3RvbURhdGF8fFwiXCIsdGhpcy5pc0RlbGV0ZWQ9ITEsdGhpcy5pc01vZGlmaWVkPSExLHRoaXMuX2lzRXhjbHVkZWRGcm9tVW5yZWFkQ291bnQ9ISghdC5tZXNzYWdlQ29udHJvbEluZm98fDEhPT10Lm1lc3NhZ2VDb250cm9sSW5mby5leGNsdWRlZEZyb21VbnJlYWRDb3VudCksdGhpcy5faXNFeGNsdWRlZEZyb21MYXN0TWVzc2FnZT0hKCF0Lm1lc3NhZ2VDb250cm9sSW5mb3x8MSE9PXQubWVzc2FnZUNvbnRyb2xJbmZvLmV4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlKSx0aGlzLmNsaWVudFRpbWU9dC5jbGllbnRUaW1lfHx3ZSgpfHwwLHRoaXMuc2VuZGVyVGlueUlEPXQuc2VuZGVyVGlueUlEfHx0LnRpbnlJRHx8XCJcIix0aGlzLnJlYWRSZWNlaXB0SW5mbz10LnJlYWRSZWNlaXB0SW5mb3x8e3JlYWRDb3VudDp2b2lkIDAsdW5yZWFkQ291bnQ6dm9pZCAwLGlzUGVlclJlYWQ6dm9pZCAwfSx0aGlzLm5lZWRSZWFkUmVjZWlwdD0hMD09PXQubmVlZFJlYWRSZWNlaXB0fHwxPT09dC5uZWVkUmVhZFJlY2VpcHQsdGhpcy52ZXJzaW9uPXQubWVzc2FnZVZlcnNpb258fDAsdGhpcy5pc0Jyb2FkY2FzdE1lc3NhZ2U9dC5pc0Jyb2FkY2FzdE1lc3NhZ2V8fCExLHRoaXMuX3JlY2VpdmVyTGlzdD10LnJlY2VpdmVyTGlzdHx8dm9pZCAwLHRoaXMuaXNTdXBwb3J0RXh0ZW5zaW9uPSEwPT09dC5pc1N1cHBvcnRFeHRlbnNpb258fDE9PT10LmlzU3VwcG9ydEV4dGVuc2lvbix0aGlzLnJldm9rZXI9dC5yZXZva2VySW5mbyYmdC5yZXZva2VySW5mby5yZXZva2VyfHxudWxsLHRoaXMucmVJbml0aWFsaXplKHQuY3VycmVudFVzZXIpLHRoaXMuZXh0cmFjdEdyb3VwSW5mbyh0Lmdyb3VwUHJvZmlsZXx8bnVsbCksdGhpcy5oYW5kbGVHcm91cEF0SW5mbyh0KSx0aGlzLmluaXRDMkNSZWFkUmVjZWlwdEluZm8odC5yZWFkUmVjZWlwdFNlbnRCeVBlZXIpfXJldHVybiBhKGUsW3trZXk6XCJlbGVtZW50c1wiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9lbGVtZW50c319LHtrZXk6XCJnZXRFbGVtZW50c1wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2VsZW1lbnRzfX0se2tleTpcImV4dHJhY3RHcm91cEluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXtpZihudWxsIT09ZSl7bnQoZS5uaWNrKSYmKHRoaXMubmljaz1lLm5pY2spLG50KGUuYXZhdGFyKSYmKHRoaXMuYXZhdGFyPWUuYXZhdGFyKTt2YXIgdD1lLm1lc3NhZ2VGcm9tQWNjb3VudEV4dHJhSW5mb3JtYXRpb247c3QodCkmJm50KHQubmFtZUNhcmQpJiYodGhpcy5uYW1lQ2FyZD10Lm5hbWVDYXJkKX19fSx7a2V5OlwiaGFuZGxlR3JvdXBBdEluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2UucGF5bG9hZCYmZS5wYXlsb2FkLmF0VXNlckxpc3QmJmUucGF5bG9hZC5hdFVzZXJMaXN0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2UhPT1FLk1TR19BVF9BTEw/KHQuX2dyb3VwQXRJbmZvTGlzdC5wdXNoKHtncm91cEF0QWxsRmxhZzowLGdyb3VwQXRVc2VySUQ6ZX0pLHQuYXRVc2VyTGlzdC5wdXNoKGUpKToodC5fZ3JvdXBBdEluZm9MaXN0LnB1c2goe2dyb3VwQXRBbGxGbGFnOjF9KSx0LmF0VXNlckxpc3QucHVzaChFLk1TR19BVF9BTEwpKX0pKSxhdChlLmdyb3VwQXRJbmZvKSYmZS5ncm91cEF0SW5mby5mb3JFYWNoKChmdW5jdGlvbihlKXswPT09ZS5ncm91cEF0QWxsRmxhZz90LmF0VXNlckxpc3QucHVzaChlLmdyb3VwQXRVc2VySUQpOjE9PT1lLmdyb3VwQXRBbGxGbGFnJiZ0LmF0VXNlckxpc3QucHVzaChFLk1TR19BVF9BTEwpfSkpfX0se2tleTpcImdldEdyb3VwQXRJbmZvTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dyb3VwQXRJbmZvTGlzdH19LHtrZXk6XCJfaW5pdFByb3h5XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9lbGVtZW50c1swXSYmKHRoaXMucGF5bG9hZD10aGlzLl9lbGVtZW50c1swXS5jb250ZW50LHRoaXMudHlwZT10aGlzLl9lbGVtZW50c1swXS50eXBlKX19LHtrZXk6XCJyZUluaXRpYWxpemVcIix2YWx1ZTpmdW5jdGlvbihlKXtlJiYodGhpcy5zdGF0dXM9dGhpcy5mcm9tP1F0LlNVQ0NFU1M6UXQuVU5TRU5ELCF0aGlzLmZyb20mJih0aGlzLmZyb209ZSkpLHRoaXMuX2luaXRGbG93KGUpLHRoaXMuX2luaXRTZXF1ZW5jZShlKSx0aGlzLl9jb25jYXRDb252ZXJzYXRpb25JRChlKSx0aGlzLmdlbmVyYXRlTWVzc2FnZUlEKCl9fSx7a2V5OlwiaXNTZW5kYWJsZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIDAhPT10aGlzLl9lbGVtZW50cy5sZW5ndGgmJihcImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLl9lbGVtZW50c1swXS5zZW5kYWJsZSYmdGhpcy5fZWxlbWVudHNbMF0uc2VuZGFibGUoKSl9fSx7a2V5OlwiX2luaXRUb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9HUk9VUCYmKHRoaXMudG89ZS5ncm91cElEKX19LHtrZXk6XCJfaW5pdFNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7MD09PXRoaXMuY2xpZW50U2VxdWVuY2UmJmUmJih0aGlzLmNsaWVudFNlcXVlbmNlPWZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybiExO2lmKHZvaWQgMD09PU10W2VdKXt2YXIgdD1uZXcgRGF0ZSxuPVwiM1wiLmNvbmNhdCh0LmdldEhvdXJzKCkpLnNsaWNlKC0yKSxvPVwiMFwiLmNvbmNhdCh0LmdldE1pbnV0ZXMoKSkuc2xpY2UoLTIpLHM9XCIwXCIuY29uY2F0KHQuZ2V0U2Vjb25kcygpKS5zbGljZSgtMik7TXRbZV09cGFyc2VJbnQoW24sbyxzLFwiMDAwMVwiXS5qb2luKFwiXCIpKSxuPW51bGwsbz1udWxsLHM9bnVsbCxWZS5sKFwiYXV0b0luY3JlbWVudEluZGV4IHN0YXJ0IGluZGV4OlwiLmNvbmNhdChNdFtlXSkpfXJldHVybiBNdFtlXSsrfShlKSksMD09PXRoaXMuc2VxdWVuY2UmJnRoaXMuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9DMkMmJih0aGlzLnNlcXVlbmNlPXRoaXMuY2xpZW50U2VxdWVuY2UpfX0se2tleTpcImdlbmVyYXRlTWVzc2FnZUlEXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLmZyb209PT1FLkNPTlZfU1lTVEVNJiYodGhpcy5zZW5kZXJUaW55SUQ9XCIxNDQxMTUxOTgyNDQ0NzE3MDNcIiksdGhpcy5JRD1cIlwiLmNvbmNhdCh0aGlzLnNlbmRlclRpbnlJRCxcIi1cIikuY29uY2F0KHRoaXMuY2xpZW50VGltZSxcIi1cIikuY29uY2F0KHRoaXMucmFuZG9tKX19LHtrZXk6XCJfaW5pdEZsb3dcIix2YWx1ZTpmdW5jdGlvbihlKXtcIlwiIT09ZSYmKGU9PT10aGlzLmZyb20/KHRoaXMuZmxvdz1cIm91dFwiLHRoaXMuaXNSZWFkPSEwKTp0aGlzLmZsb3c9XCJpblwiKX19LHtrZXk6XCJfY29uY2F0Q29udmVyc2F0aW9uSURcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLnRvLG49XCJcIixvPXRoaXMuY29udmVyc2F0aW9uVHlwZTtvIT09RS5DT05WX1NZU1RFTT8obj1vPT09RS5DT05WX0MyQz9lPT09dGhpcy5mcm9tP3Q6dGhpcy5mcm9tOnRoaXMudG8sdGhpcy5jb252ZXJzYXRpb25JRD1uP1wiXCIuY29uY2F0KG8pLmNvbmNhdChuKTpudWxsKTp0aGlzLmNvbnZlcnNhdGlvbklEPUUuQ09OVl9TWVNURU19fSx7a2V5OlwiaXNFbGVtZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBSYXx8ZSBpbnN0YW5jZW9mIE5hfHxlIGluc3RhbmNlb2YgT2F8fGUgaW5zdGFuY2VvZiBHYXx8ZSBpbnN0YW5jZW9mIEZhfHxlIGluc3RhbmNlb2YgeGF8fGUgaW5zdGFuY2VvZiBQYXx8ZSBpbnN0YW5jZW9mIHdhfHxlIGluc3RhbmNlb2YgcWF8fGUgaW5zdGFuY2VvZiBWYXx8ZSBpbnN0YW5jZW9mIEhhfX0se2tleTpcInNldEVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7aWYodGhpcy5pc0VsZW1lbnQoZSkpcmV0dXJuIHRoaXMuX2VsZW1lbnRzPVtlXSx2b2lkIHRoaXMuX2luaXRQcm94eSgpO3ZhciBvPWZ1bmN0aW9uKGUpe2lmKGUudHlwZSYmZS5jb250ZW50KXN3aXRjaChlLnR5cGUpe2Nhc2UgRS5NU0dfVEVYVDpuLnNldFRleHRFbGVtZW50KGUuY29udGVudCk7YnJlYWs7Y2FzZSBFLk1TR19JTUFHRTpuLnNldEltYWdlRWxlbWVudChlLmNvbnRlbnQsdCk7YnJlYWs7Y2FzZSBFLk1TR19BVURJTzpuLnNldEF1ZGlvRWxlbWVudChlLmNvbnRlbnQsdCk7YnJlYWs7Y2FzZSBFLk1TR19GSUxFOm4uc2V0RmlsZUVsZW1lbnQoZS5jb250ZW50LHQpO2JyZWFrO2Nhc2UgRS5NU0dfVklERU86bi5zZXRWaWRlb0VsZW1lbnQoZS5jb250ZW50LHQpO2JyZWFrO2Nhc2UgRS5NU0dfQ1VTVE9NOm4uc2V0Q3VzdG9tRWxlbWVudChlLmNvbnRlbnQpO2JyZWFrO2Nhc2UgRS5NU0dfTE9DQVRJT046bi5zZXRMb2NhdGlvbkVsZW1lbnQoZS5jb250ZW50KTticmVhaztjYXNlIEUuTVNHX0dSUF9USVA6bi5zZXRHcm91cFRpcEVsZW1lbnQoZS5jb250ZW50KTticmVhaztjYXNlIEUuTVNHX0dSUF9TWVNfTk9USUNFOm4uc2V0R3JvdXBTeXN0ZW1Ob3RpY2VFbGVtZW50KGUuY29udGVudCk7YnJlYWs7Y2FzZSBFLk1TR19GQUNFOm4uc2V0RmFjZUVsZW1lbnQoZS5jb250ZW50KTticmVhaztjYXNlIEUuTVNHX01FUkdFUjpuLnNldE1lcmdlckVsZW1lbnQoZS5jb250ZW50LHQpfX07aWYoYXQoZSkpZm9yKHZhciBzPTA7czxlLmxlbmd0aDtzKyspbyhlW3NdKTtlbHNlIG8oZSk7dGhpcy5faW5pdFByb3h5KCl9fSx7a2V5OlwiY2xlYXJFbGVtZW50XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9lbGVtZW50cy5sZW5ndGg9MH19LHtrZXk6XCJzZXRUZXh0RWxlbWVudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVwic3RyaW5nXCI9PXR5cGVvZiBlP2U6ZS50ZXh0LG49bmV3IFJhKHt0ZXh0OnR9KTt0aGlzLl9lbGVtZW50cy5wdXNoKG4pfX0se2tleTpcInNldEltYWdlRWxlbWVudFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49bmV3IE5hKGUsdCk7dGhpcy5fZWxlbWVudHMucHVzaChuKX19LHtrZXk6XCJzZXRBdWRpb0VsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPW5ldyBHYShlLHQpO3RoaXMuX2VsZW1lbnRzLnB1c2gobil9fSx7a2V5Olwic2V0RmlsZUVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPW5ldyBGYShlLHQpO3RoaXMuX2VsZW1lbnRzLnB1c2gobil9fSx7a2V5Olwic2V0VmlkZW9FbGVtZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1uZXcgeGEoZSx0KTt0aGlzLl9lbGVtZW50cy5wdXNoKG4pfX0se2tleTpcInNldExvY2F0aW9uRWxlbWVudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBWYShlKTt0aGlzLl9lbGVtZW50cy5wdXNoKHQpfX0se2tleTpcInNldEN1c3RvbUVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1uZXcgcWEoZSk7dGhpcy5fZWxlbWVudHMucHVzaCh0KX19LHtrZXk6XCJzZXRHcm91cFRpcEVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD17fSxuPWUub3BlcmF0aW9uVHlwZTtpZih6dChlLm1lbWJlckluZm9MaXN0KT9lLm9wZXJhdG9ySW5mbyYmKHQ9ZS5vcGVyYXRvckluZm8pOm4hPT1FLkdSUF9USVBfTUJSX0pPSU4mJm4hPT1FLkdSUF9USVBfTUJSX0tJQ0tFRF9PVVQmJm4hPT1FLkdSUF9USVBfTUJSX1NFVF9BRE1JTiYmbiE9PUUuR1JQX1RJUF9NQlJfQ0FOQ0VMRURfQURNSU58fCh0PWUubWVtYmVySW5mb0xpc3RbMF0pLCF6dChlLm1lbWJlckV4dHJhSW5mbykpe3ZhciBvPWUubWVtYmVyRXh0cmFJbmZvLnJlYXNvbjtlLm1zZ01lbWJlckluZm8uZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5yZWFzb249b30pKX12YXIgcz10LGE9cy5uaWNrLGk9cy5hdmF0YXI7bnQoYSkmJih0aGlzLm5pY2s9YSksbnQoaSkmJih0aGlzLmF2YXRhcj1pKTt2YXIgcj1uZXcgUGEoZSk7dGhpcy5fZWxlbWVudHMucHVzaChyKX19LHtrZXk6XCJzZXRHcm91cFN5c3RlbU5vdGljZUVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1uZXcgd2EoZSk7dGhpcy5fZWxlbWVudHMucHVzaCh0KX19LHtrZXk6XCJzZXRGYWNlRWxlbWVudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBPYShlKTt0aGlzLl9lbGVtZW50cy5wdXNoKHQpfX0se2tleTpcInNldE1lcmdlckVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPW5ldyBIYShlLHQpO3RoaXMuX2VsZW1lbnRzLnB1c2gobil9fSx7a2V5Olwic2V0SXNSZWFkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5pc1JlYWQ9ZX19LHtrZXk6XCJzZXRSZWxheUZsYWdcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9yZWxheUZsYWc9ZX19LHtrZXk6XCJnZXRSZWxheUZsYWdcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWxheUZsYWd9fSx7a2V5OlwiX2NvbXB1dGVQcmlvcml0eVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGl0KGUpKXJldHVybiBFLk1TR19QUklPUklUWV9OT1JNQUw7aWYobnQoZSkmJi0xIT09T2JqZWN0LnZhbHVlcyhLYSkuaW5kZXhPZihlKSlyZXR1cm4gZTtpZihldChlKSl7dmFyIHQ9XCJcIitlO2lmKC0xIT09T2JqZWN0LmtleXMoS2EpLmluZGV4T2YodCkpcmV0dXJuIEthW3RdfXJldHVybiBFLk1TR19QUklPUklUWV9OT1JNQUx9fSx7a2V5Olwic2V0Tmlja0FuZEF2YXRhclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUubmljayxuPWUuYXZhdGFyO250KHQpJiYodGhpcy5uaWNrPXQpLG50KG4pJiYodGhpcy5hdmF0YXI9bil9fSx7a2V5Olwic2V0TmFtZUNhcmRcIix2YWx1ZTpmdW5jdGlvbihlKXtudChlKSYmKHRoaXMubmFtZUNhcmQ9ZSl9fSx7a2V5OlwiaW5pdEMyQ1JlYWRSZWNlaXB0SW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9DMkMmJiEwPT09dGhpcy5uZWVkUmVhZFJlY2VpcHQmJih0aGlzLnJlYWRSZWNlaXB0SW5mby5pc1BlZXJSZWFkPTE9PT1lKX19XSksZX0oKSxZYT1mdW5jdGlvbihlKXtyZXR1cm57Y29kZTowLGRhdGE6ZXx8e319fSxqYT1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO28odGhpcyxuKSxzPXQuY2FsbCh0aGlzKTt2YXIgYT1lLmNvZGUsaT1lLm1lc3NhZ2Uscj1lLmRhdGE7cmV0dXJuIHMuY29kZT1hLHMubWVzc2FnZT1pfHxzLl9nZXRFcnJvck1lc3NhZ2Uocy5jb2RlKSxzLmRhdGE9cnx8e30sc31yZXR1cm4gYShuKX0ocChFcnJvcikpLHphPW51bGwsSmE9ZnVuY3Rpb24oZSl7emE9ZX0sWGE9ZnVuY3Rpb24oZSl7cmV0dXJuIFByb21pc2UucmVzb2x2ZShZYShlKSl9LFphPWZ1bmN0aW9uKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdJiZhcmd1bWVudHNbMV07aWYoZSBpbnN0YW5jZW9mIGphKXJldHVybiB0JiZudWxsIT09emEmJnphLmVtaXQoay5FUlJPUixlKSxQcm9taXNlLnJlamVjdChlKTtpZihlIGluc3RhbmNlb2YgRXJyb3Ipe3ZhciBuPW5ldyBqYSh7Y29kZTpoYS5VTkNBVUdIVF9FUlJPUn0pO3JldHVybiB0JiZudWxsIT09emEmJnphLmVtaXQoay5FUlJPUixuKSxQcm9taXNlLnJlamVjdChuKX1pZighaXQoZSkmJiFpdChlLmNvZGUpKXt2YXIgbz1uZXcgamEoZSk7cmV0dXJuIHQmJm51bGwhPT16YSYmemEuZW1pdChrLkVSUk9SLG8pLFByb21pc2UucmVqZWN0KG8pfX0sUWE9ZnVuY3Rpb24oZSl7cihzLGUpO3ZhciBuPWYocyk7ZnVuY3Rpb24gcyhlKXt2YXIgdDtyZXR1cm4gbyh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIkMyQ01vZHVsZVwiLHQuX21lc3NhZ2VGcm9tVW5yZWFkREJNYXA9bmV3IE1hcCx0Ll9zaWduYWxpbmdGcm9tVW5yZWFkREJMaXN0PVtdLHR9cmV0dXJuIGEocyxbe2tleTpcIm9uTmV3QzJDTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZGF0YUxpc3Qsbj1lLmlzSW5zdGFudE1lc3NhZ2Usbz1lLkMyQ1JlbWFpbmluZ1VucmVhZExpc3Qscz1lLkMyQ1BhaXJVbnJlYWRMaXN0O1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbk5ld0MyQ01lc3NhZ2UgY291bnQ6XCIpLmNvbmNhdCh0Lmxlbmd0aCxcIiBpc0luc3RhbnRNZXNzYWdlOlwiKS5jb25jYXQobikpO3ZhciBhPXRoaXMuX25ld0MyQ01lc3NhZ2VTdG9yZWRBbmRTdW1tYXJ5KHtkYXRhTGlzdDp0LEMyQ1JlbWFpbmluZ1VucmVhZExpc3Q6byxDMkNQYWlyVW5yZWFkTGlzdDpzLGlzSW5zdGFudE1lc3NhZ2U6bn0pLGk9YS5jb252ZXJzYXRpb25PcHRpb25zTGlzdCxyPWEubWVzc2FnZUxpc3QsdT1hLmlzVW5yZWFkQzJDTWVzc2FnZTsodGhpcy5maWx0ZXJNb2RpZmllZE1lc3NhZ2UociksaS5sZW5ndGg+MCkmJnRoaXMuZ2V0TW9kdWxlKHFuKS5vbk5ld01lc3NhZ2Uoe2NvbnZlcnNhdGlvbk9wdGlvbnNMaXN0OmksaXNJbnN0YW50TWVzc2FnZTpuLGlzVW5yZWFkQzJDTWVzc2FnZTp1fSk7dmFyIGM9dGhpcy5maWx0ZXJVbm1vZGlmaWVkTWVzc2FnZShyKTtuJiZjLmxlbmd0aD4wJiZ0aGlzLmVtaXRPdXRlckV2ZW50KGsuTUVTU0FHRV9SRUNFSVZFRCxjKSxyLmxlbmd0aD0wfX0se2tleTpcIl9uZXdDMkNNZXNzYWdlU3RvcmVkQW5kU3VtbWFyeVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmRhdGFMaXN0LG49ZS5DMkNSZW1haW5pbmdVbnJlYWRMaXN0LG89ZS5DMkNQYWlyVW5yZWFkTGlzdCxzPWUuaXNJbnN0YW50TWVzc2FnZSxhPW51bGwsaT1bXSxyPVtdLHU9e30sYz10aGlzLmdldE1vZHVsZShLbiksbD10aGlzLmdldE1vZHVsZShlbyksZD0hMSxwPXRoaXMuZ2V0TW9kdWxlKHFuKSxnPXRoaXMuZ2V0RmlsZURvd25sb2FkUHJveHkoKSxoPTAsXz10Lmxlbmd0aDtoPF87aCsrKWlmKHRoaXMuX2lzU2lnbmFsaW5nKHRbaF0pKXRoaXMuX3NpZ25hbGluZ0Zyb21VbnJlYWREQkxpc3QucHVzaCh0W2hdLmV2ZW50QXJyYXlbMF0uYzJDTm90aWZ5TXNnQXJyYXlbMF0pO2Vsc2V7dmFyIGY9dFtoXTtmLmN1cnJlbnRVc2VyPXRoaXMuZ2V0TXlVc2VySUQoKSxmLmNvbnZlcnNhdGlvblR5cGU9RS5DT05WX0MyQyxmLmlzU3lzdGVtTWVzc2FnZT0hIWYuaXNTeXN0ZW1NZXNzYWdlLChpdChmLm5pY2spfHxpdChmLmF2YXRhcikpJiYoZD0hMCxWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX25ld0MyQ01lc3NhZ2VTdG9yZWRBbmRTdW1tYXJ5IG5pY2sgb3IgYXZhdGFyIG1pc3NpbmchXCIpKSksYT1uZXcgV2EoZiksZi5lbGVtZW50cz1jLnBhcnNlRWxlbWVudHMoZi5lbGVtZW50cyxmLmZyb20pLGEuc2V0RWxlbWVudChmLmVsZW1lbnRzLGcpLGEuc2V0Tmlja0FuZEF2YXRhcih7bmljazpmLm5pY2ssYXZhdGFyOmYuYXZhdGFyfSk7dmFyIHY9YS5jb252ZXJzYXRpb25JRDtpZihzKXtpZigxPT09dGhpcy5fbWVzc2FnZUZyb21VbnJlYWREQk1hcC5nZXQoYS5JRCkpY29udGludWU7dmFyIG09ITE7aWYoYS5mcm9tIT09dGhpcy5nZXRNeVVzZXJJRCgpKXt2YXIgTT1wLmdldExhdGVzdE1lc3NhZ2VTZW50QnlQZWVyKHYpO2lmKE0pe3ZhciB5PU0ubmljayxJPU0uYXZhdGFyO2Q/YS5zZXROaWNrQW5kQXZhdGFyKHtuaWNrOnksYXZhdGFyOkl9KTp5PT09YS5uaWNrJiZJPT09YS5hdmF0YXJ8fChtPSEwKX19ZWxzZXt2YXIgQz1wLmdldExhdGVzdE1lc3NhZ2VTZW50QnlNZSh2KTtpZihDKXt2YXIgVD1DLm5pY2ssRD1DLmF2YXRhcjtUPT09YS5uaWNrJiZEPT09YS5hdmF0YXJ8fHAubW9kaWZ5TWVzc2FnZVNlbnRCeU1lKHtjb252ZXJzYXRpb25JRDp2LGxhdGVzdE5pY2s6YS5uaWNrLGxhdGVzdEF2YXRhcjphLmF2YXRhcn0pfX12YXIgaz0xPT09dFtoXS5pc01vZGlmaWVkO2lmKHAuaXNNZXNzYWdlU2VudEJ5Q3VycmVudEluc3RhbmNlKGEpP2EuaXNNb2RpZmllZD1rOms9ITEsMD09PWYubXNnTGlmZVRpbWUpYS5fb25saW5lT25seUZsYWc9ITAscC5pc01lc3NhZ2VTZW50QnlDdXJyZW50SW5zdGFuY2UoYSl8fHIucHVzaChhKTtlbHNle2lmKCFwLnB1c2hJbnRvTWVzc2FnZUxpc3QocixhLGspKWNvbnRpbnVlO20mJihwLm1vZGlmeU1lc3NhZ2VTZW50QnlQZWVyKHtjb252ZXJzYXRpb25JRDp2LGxhdGVzdE5pY2s6YS5uaWNrLGxhdGVzdEF2YXRhcjphLmF2YXRhcn0pLHAudXBkYXRlVXNlclByb2ZpbGVTcGVjaWZpZWRLZXkoe2NvbnZlcnNhdGlvbklEOnYsbmljazphLm5pY2ssYXZhdGFyOmEuYXZhdGFyfSkpfXMmJmEuY2xpZW50VGltZT4wJiZsLmFkZE1lc3NhZ2VEZWxheShhLmNsaWVudFRpbWUpfWVsc2UgdGhpcy5fbWVzc2FnZUZyb21VbnJlYWREQk1hcC5zZXQoYS5JRCwxKTtpZigwIT09Zi5tc2dMaWZlVGltZSl7aWYoITE9PT1hLl9vbmxpbmVPbmx5RmxhZyl7dmFyIFM9cC5nZXRMYXN0TWVzc2FnZVRpbWUodik7aWYoZXQoUykmJmEudGltZTxTKWNvbnRpbnVlO2lmKGl0KHVbdl0pKXt2YXIgTD0wO1wiaW5cIj09PWEuZmxvdyYmKGEuX2lzRXhjbHVkZWRGcm9tVW5yZWFkQ291bnR8fChMPTEpKSx1W3ZdPWkucHVzaCh7Y29udmVyc2F0aW9uSUQ6dix1bnJlYWRDb3VudDpMLHR5cGU6YS5jb252ZXJzYXRpb25UeXBlLHN1YlR5cGU6YS5jb252ZXJzYXRpb25TdWJUeXBlLGxhc3RNZXNzYWdlOmEuX2lzRXhjbHVkZWRGcm9tTGFzdE1lc3NhZ2U/XCJcIjphfSktMX1lbHNle3ZhciBBPXVbdl07aVtBXS50eXBlPWEuY29udmVyc2F0aW9uVHlwZSxpW0FdLnN1YlR5cGU9YS5jb252ZXJzYXRpb25TdWJUeXBlLGlbQV0ubGFzdE1lc3NhZ2U9YS5faXNFeGNsdWRlZEZyb21MYXN0TWVzc2FnZT9cIlwiOmEsXCJpblwiPT09YS5mbG93JiYoYS5faXNFeGNsdWRlZEZyb21VbnJlYWRDb3VudHx8aVtBXS51bnJlYWRDb3VudCsrKX19fWVsc2UgYS5fb25saW5lT25seUZsYWc9ITB9dGhpcy5faGFuZGxlU2lnbmFsaW5nRnJvbVVucmVhZERCKCk7dmFyIFI9ITE7aWYoYXQobykpZm9yKHZhciBOPWZ1bmN0aW9uKGUsdCl7aWYob1tlXS51bnJlYWRDb3VudD4wKXtSPSEwO3ZhciBuPWkuZmluZCgoZnVuY3Rpb24odCl7cmV0dXJuIHQuY29udmVyc2F0aW9uSUQ9PT1cIkMyQ1wiLmNvbmNhdChvW2VdLmZyb20pfSkpO24/bi51bnJlYWRDb3VudD1vW2VdLnVucmVhZENvdW50OmkucHVzaCh7Y29udmVyc2F0aW9uSUQ6XCJDMkNcIi5jb25jYXQob1tlXS5mcm9tKSx1bnJlYWRDb3VudDpvW2VdLnVucmVhZENvdW50LHR5cGU6RS5DT05WX0MyQ30pfX0sTz0wLEc9by5sZW5ndGg7TzxHO08rKylOKE8pO2lmKGF0KG4pKWZvcih2YXIgVT1mdW5jdGlvbihlLHQpe2kuZmluZCgoZnVuY3Rpb24odCl7cmV0dXJuIHQuY29udmVyc2F0aW9uSUQ9PT1cIkMyQ1wiLmNvbmNhdChuW2VdLmZyb20pfSkpfHxpLnB1c2goe2NvbnZlcnNhdGlvbklEOlwiQzJDXCIuY29uY2F0KG5bZV0uZnJvbSksdHlwZTpFLkNPTlZfQzJDLGxhc3RNc2dUaW1lOm5bZV0ubGFzdE1zZ1RpbWV9KX0sUD0wLGI9bi5sZW5ndGg7UDxiO1ArKylVKFApO3JldHVybntjb252ZXJzYXRpb25PcHRpb25zTGlzdDppLG1lc3NhZ2VMaXN0OnIsaXNVbnJlYWRDMkNNZXNzYWdlOlJ9fX0se2tleTpcIl9pc1NpZ25hbGluZ1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZXZlbnRBcnJheTtyZXR1cm4hKCFhdCh0KXx8MTAhPT10WzBdLmV2ZW50KX19LHtrZXk6XCJfaGFuZGxlU2lnbmFsaW5nRnJvbVVucmVhZERCXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9zaWduYWxpbmdGcm9tVW5yZWFkREJMaXN0Lmxlbmd0aDtpZihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2hhbmRsZVNpZ25hbGluZ0Zyb21VbnJlYWREQiBzaWduYWxpbmdDb3VudDpcIikuY29uY2F0KGUpKSwwIT09ZSl7dmFyIHQ9W107dGhpcy5fc2lnbmFsaW5nRnJvbVVucmVhZERCTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmhhc093blByb3BlcnR5KFwiYzJjTWVzc2FnZVJldm9rZWROb3RpZnlcIikmJnQucHVzaChlKX0pKSx0aGlzLm9uQzJDTWVzc2FnZVJldm9rZWQoe2RhdGFMaXN0OnR9KSx0aGlzLl9zaWduYWxpbmdGcm9tVW5yZWFkREJMaXN0Lmxlbmd0aD0wLHQubGVuZ3RoPTB9fX0se2tleTpcIm9uQzJDTWVzc2FnZVJldm9rZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49dGhpcy5nZXRNb2R1bGUocW4pLG89W10scz1udWxsLGE9ITA7ZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtpZihlLmMyY01lc3NhZ2VSZXZva2VkTm90aWZ5KXt2YXIgaT1lLmMyY01lc3NhZ2VSZXZva2VkTm90aWZ5LnJldm9rZWRJbmZvcztpdChpKXx8aS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgaT10LmdldE15VXNlcklEKCk9PT1lLmZyb20/XCJcIi5jb25jYXQoRS5DT05WX0MyQykuY29uY2F0KGUudG8pOlwiXCIuY29uY2F0KEUuQ09OVl9DMkMpLmNvbmNhdChlLmZyb20pO3M9bi5yZXZva2UoaSxlLnNlcXVlbmNlLGUucmFuZG9tKTt2YXIgcj1lLnJldm9rZXJJbmZvJiZlLnJldm9rZXJJbmZvLnJldm9rZXI7aWYocylzLnJldm9rZXJ8fChzLnJldm9rZXI9cixvLnB1c2gocykpO2Vsc2V7dmFyIHU9e2NvbnZlcnNhdGlvbklEOmksc2VxdWVuY2U6ZS5zZXF1ZW5jZSx0aW1lOmUudGltZSxyZXZva2VyOnJ9O24uaXNMYXN0TWVzc2FnZVJldm9rZWQodSkmJihvLnB1c2godSksYT0hMSl9fSkpfX0pKSwwIT09by5sZW5ndGgmJihuLm9uTWVzc2FnZVJldm9rZWQobyksITA9PT1hJiYoVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQzJDTWVzc2FnZVJldm9rZWQgY291bnQ6XCIpLmNvbmNhdChvLmxlbmd0aCkpLHRoaXMuZW1pdE91dGVyRXZlbnQoay5NRVNTQUdFX1JFVk9LRUQsbykpKX19LHtrZXk6XCJvbkMyQ01lc3NhZ2VSZWFkUmVjZWlwdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7ZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtpZighenQoZS5jMmNNZXNzYWdlUmVhZFJlY2VpcHQpKXt2YXIgbj1lLmMyY01lc3NhZ2VSZWFkUmVjZWlwdC50bztlLmMyY01lc3NhZ2VSZWFkUmVjZWlwdC51aW5QYWlyUmVhZEFycmF5LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBvPWUucGVlclJlYWRUaW1lO1ZlLmQoXCJcIi5jb25jYXQodC5fbixcIi5fb25DMkNNZXNzYWdlUmVhZFJlY2VpcHQgdG86XCIpLmNvbmNhdChuLFwiIHBlZXJSZWFkVGltZTpcIikuY29uY2F0KG8pKTt2YXIgcz1cIlwiLmNvbmNhdChFLkNPTlZfQzJDKS5jb25jYXQobiksYT10LmdldE1vZHVsZShxbik7YS5yZWNvcmRQZWVyUmVhZFRpbWUocyxvKSxhLnVwZGF0ZU1lc3NhZ2VJc1BlZXJSZWFkUHJvcGVydHkocyxvKX0pKX19KSl9fSx7a2V5Olwib25DMkNNZXNzYWdlUmVhZE5vdGljZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7ZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtpZighenQoZS5jMmNNZXNzYWdlUmVhZE5vdGljZSkpe3ZhciBuPXQuZ2V0TW9kdWxlKHFuKTtlLmMyY01lc3NhZ2VSZWFkTm90aWNlLnVpblBhaXJSZWFkQXJyYXkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG89ZS5mcm9tLHM9ZS5wZWVyUmVhZFRpbWU7VmUuZChcIlwiLmNvbmNhdCh0Ll9uLFwiLm9uQzJDTWVzc2FnZVJlYWROb3RpY2UgZnJvbTpcIikuY29uY2F0KG8sXCIgbGFzdFJlYWRUaW1lOlwiKS5jb25jYXQocykpO3ZhciBhPVwiXCIuY29uY2F0KEUuQ09OVl9DMkMpLmNvbmNhdChvKTtuLnVwZGF0ZUlzUmVhZEFmdGVyUmVhZFJlcG9ydCh7Y29udmVyc2F0aW9uSUQ6YSxsYXN0TWVzc2FnZVRpbWU6c30pLG4udXBkYXRlVW5yZWFkQ291bnQoYSl9KSl9fSkpfX0se2tleTpcIm9uQzJDTWVzc2FnZU1vZGlmaWVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQzJDTWVzc2FnZU1vZGlmaWVkIG9wdGlvbnM6XCIpLEpTT04uc3RyaW5naWZ5KGUpKTt2YXIgbj10aGlzLmdldE1vZHVsZShxbik7ZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtuLm9uTWVzc2FnZU1vZGlmaWVkKHQodCh7fSxlKSx7fSx7Y29udmVyc2F0aW9uVHlwZTpFLkNPTlZfQzJDfSkpfSkpfX0se2tleTpcIm9uUmVhZFJlY2VpcHRMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uUmVhZFJlY2VpcHRMaXN0IG9wdGlvbnM6XCIpLEpTT04uc3RyaW5naWZ5KGUpKTt2YXIgdD1lLmRhdGFMaXN0LG49dC51c2VySUQsbz10LnJlYWRSZWNlaXB0TGlzdDt0aGlzLmdldE1vZHVsZShxbikudXBkYXRlUmVhZFJlY2VpcHRJbmZvKHt1c2VySUQ6bixyZWFkUmVjZWlwdExpc3Q6b30pfX0se2tleTpcInNlbmRNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLl9jcmVhdGVDMkNNZXNzYWdlUGFjayhlLHQpO3JldHVybiB0aGlzLnJlcXVlc3Qobil9fSx7a2V5OlwiX2NyZWF0ZUMyQ01lc3NhZ2VQYWNrXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1udWxsO3QmJih0Lm9mZmxpbmVQdXNoSW5mbyYmKG49dC5vZmZsaW5lUHVzaEluZm8pLCEwPT09dC5vbmxpbmVVc2VyT25seSYmKG4/bi5kaXNhYmxlUHVzaD0hMDpuPXtkaXNhYmxlUHVzaDohMH0pKTt2YXIgbz1cIlwiO250KGUuY2xvdWRDdXN0b21EYXRhKSYmZS5jbG91ZEN1c3RvbURhdGEubGVuZ3RoPjAmJihvPWUuY2xvdWRDdXN0b21EYXRhKTt2YXIgcz1bXTtpZihzdCh0KSYmc3QodC5tZXNzYWdlQ29udHJvbEluZm8pKXt2YXIgYT10Lm1lc3NhZ2VDb250cm9sSW5mbyxpPWEuZXhjbHVkZWRGcm9tVW5yZWFkQ291bnQscj1hLmV4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlLHU9YS5leGNsdWRlZEZyb21Db250ZW50TW9kZXJhdGlvbjshMD09PWkmJnMucHVzaChcIk5vVW5yZWFkXCIpLCEwPT09ciYmcy5wdXNoKFwiTm9MYXN0TXNnXCIpLCEwPT09dSYmcy5wdXNoKFwiTm9Nc2dDaGVja1wiKX12YXIgYz10aGlzLmlzT25saW5lTWVzc2FnZShlLHQpPzA6dm9pZCAwO3JldHVybntwcm90b2NvbE5hbWU6Zm8sdGpnSUQ6dGhpcy5nZW5lcmF0ZVRqZ0lEKGUpLHJlcXVlc3REYXRhOntmcm9tQWNjb3VudDp0aGlzLmdldE15VXNlcklEKCksdG9BY2NvdW50OmUudG8sbXNnQm9keTplLmdldEVsZW1lbnRzKCksY2xvdWRDdXN0b21EYXRhOm8sbXNnU2VxOmUuc2VxdWVuY2UsbXNnUmFuZG9tOmUucmFuZG9tLG1zZ0xpZmVUaW1lOmMsbmljazplLm5pY2ssYXZhdGFyOmUuYXZhdGFyLG9mZmxpbmVQdXNoSW5mbzpuP3twdXNoRmxhZzohMD09PW4uZGlzYWJsZVB1c2g/MTowLHRpdGxlOm4udGl0bGV8fFwiXCIsZGVzYzpuLmRlc2NyaXB0aW9ufHxcIlwiLGV4dDpuLmV4dGVuc2lvbnx8XCJcIixhcG5zSW5mbzp7YmFkZ2VNb2RlOiEwPT09bi5pZ25vcmVJT1NCYWRnZT8xOjAsaXNWb2lwUHVzaDp0aGlzLl9pc1ZvaXBQdXNoKG4pfSxhbmRyb2lkSW5mbzp7T1BQT0NoYW5uZWxJRDpuLmFuZHJvaWRPUFBPQ2hhbm5lbElEfHxcIlwifX06dm9pZCAwLG1lc3NhZ2VDb250cm9sSW5mbzowIT09Yz9zOnZvaWQgMCxjbGllbnRUaW1lOmUuY2xpZW50VGltZSxuZWVkUmVhZFJlY2VpcHQ6ITA9PT1lLm5lZWRSZWFkUmVjZWlwdD8xOjAsaXNTdXBwb3J0RXh0ZW5zaW9uOiEwPT09ZS5pc1N1cHBvcnRFeHRlbnNpb24/MTowfX19fSx7a2V5OlwiX2lzVm9pcFB1c2hcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD12b2lkIDA7cmV0dXJuIGl0KGUuZGlzYWJsZVZvaXBQdXNoKXx8KHQ9ITE9PT1lLmRpc2FibGVWb2lwUHVzaD8xOjApLHR9fSx7a2V5OlwiaXNPbmxpbmVNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4hKCF0fHwhMCE9PXQub25saW5lVXNlck9ubHkpfX0se2tleTpcInJldm9rZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6VG8scmVxdWVzdERhdGE6e21zZ0luZm86e2Zyb21BY2NvdW50OmUuZnJvbSx0b0FjY291bnQ6ZS50byxtc2dTZXE6ZS5zZXF1ZW5jZSxtc2dSYW5kb206ZS5yYW5kb20sbXNnVGltZVN0YW1wOmUudGltZX19fSl9fSx7a2V5OlwiZGVsZXRlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUudG8sbj1lLmtleUxpc3Q7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5kZWxldGVNZXNzYWdlIHRvQWNjb3VudDpcIikuY29uY2F0KHQsXCIgY291bnQ6XCIpLmNvbmNhdChuLmxlbmd0aCkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkFvLHJlcXVlc3REYXRhOntmcm9tQWNjb3VudDp0aGlzLmdldE15VXNlcklEKCksdG86dCxrZXlMaXN0Om59fSl9fSx7a2V5OlwibW9kaWZ5UmVtb3RlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZnJvbSxuPWUudG8sbz1lLnZlcnNpb24scz12b2lkIDA9PT1vPzA6byxhPWUuc2VxdWVuY2UsaT1lLnJhbmRvbSxyPWUudGltZSx1PWUucGF5bG9hZCxjPWUudHlwZSxsPWUuY2xvdWRDdXN0b21EYXRhLGQ9dm9pZCAwO3JldHVybiBCdChjKSYmKGQ9W10pLnB1c2goe3R5cGU6Yyxjb250ZW50OnV9KSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpSbyxyZXF1ZXN0RGF0YTp7ZnJvbTp0LHRvOm4sdmVyc2lvbjpzLHNlcXVlbmNlOmEscmFuZG9tOmksdGltZTpyLGVsZW1lbnRzOmQsY2xvdWRDdXN0b21EYXRhOmx9fSl9fSx7a2V5Olwic2V0TWVzc2FnZVJlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5jb252ZXJzYXRpb25JRCxvPWUubGFzdE1lc3NhZ2VUaW1lLHM9XCJcIi5jb25jYXQodGhpcy5fbixcIi5zZXRNZXNzYWdlUmVhZFwiKTtWZS5sKFwiXCIuY29uY2F0KHMsXCIgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChuLFwiIGxhc3RNZXNzYWdlVGltZTpcIikuY29uY2F0KG8pKSxldChvKXx8dGhpcy5vdXRwdXRXYXJuaW5nKFwiRG9Ob3RNb2RpZnlMYXN0VGltZVwiKTt2YXIgYT1uZXcgQWEoXCJzZXRDMkNNZXNzYWdlUmVhZFwiKTtyZXR1cm4gYS5zZXRNZXNzYWdlKFwiY29udmVyc2F0aW9uSUQ6XCIuY29uY2F0KG4sXCIgbGFzdE1lc3NhZ2VUaW1lOlwiKS5jb25jYXQobykpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkRvLHJlcXVlc3REYXRhOntDMkNNc2dSZWFkZWQ6e2Nvb2tpZTpcIlwiLEMyQ01zZ1JlYWRlZEl0ZW06W3t0b0FjY291bnQ6bi5yZXBsYWNlKFwiQzJDXCIsXCJcIiksbGFzdE1lc3NhZ2VUaW1lOm8scmVjZWlwdDoxfV19fX0pLnRoZW4oKGZ1bmN0aW9uKCl7YS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQocyxcIiBva1wiKSk7dmFyIGU9dC5nZXRNb2R1bGUocW4pO3JldHVybiBlLnVwZGF0ZUlzUmVhZEFmdGVyUmVhZFJlcG9ydCh7Y29udmVyc2F0aW9uSUQ6bixsYXN0TWVzc2FnZVRpbWU6b30pLGUudXBkYXRlVW5yZWFkQ291bnQobiksWWEoKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07YS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUubChcIlwiLmNvbmNhdChzLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImdldFJvYW1pbmdNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZ2V0Um9hbWluZ01lc3NhZ2VcIiksbz1lLnBlZXJBY2NvdW50LHM9ZS5jb252ZXJzYXRpb25JRCxhPWUuY291bnQsaT1lLmxhc3RNZXNzYWdlVGltZSxyPWUubWVzc2FnZUtleSx1PVwicGVlckFjY291bnQ6XCIuY29uY2F0KG8sXCIgY291bnQ6XCIpLmNvbmNhdChhfHwxNSxcIiBsYXN0TWVzc2FnZVRpbWU6XCIpLmNvbmNhdChpfHwwLFwiIG1lc3NhZ2VLZXk6XCIpLmNvbmNhdChyKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgXCIpLmNvbmNhdCh1KSk7dmFyIGM9bmV3IEFhKFwiZ2V0QzJDUm9hbWluZ01lc3NhZ2VzXCIpO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpTbyxyZXF1ZXN0RGF0YTp7cGVlckFjY291bnQ6byxjb3VudDphfHwxNSxsYXN0TWVzc2FnZVRpbWU6aXx8MCxtZXNzYWdlS2V5OnJ9fSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89ZS5kYXRhLGE9by5jb21wbGV0ZSxpPW8ubWVzc2FnZUxpc3Qscj1vLm1lc3NhZ2VLZXksbD1vLmxhc3RNZXNzYWdlVGltZTtpdChpKT9WZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIGNvbXBsZXRlOlwiKS5jb25jYXQoYSxcIiBidXQgbWVzc2FnZUxpc3QgaXMgdW5kZWZpbmVkIVwiKSk6VmUubChcIlwiLmNvbmNhdChuLFwiIG9rLiBjb21wbGV0ZTpcIikuY29uY2F0KGEsXCIgY291bnQ6XCIpLmNvbmNhdChpLmxlbmd0aCkpLGMuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KHUsXCIgY29tcGxldGU6XCIpLmNvbmNhdChhLFwiIGxlbmd0aDpcIikuY29uY2F0KGkubGVuZ3RoKSkuZW5kKCk7dmFyIGQ9dC5nZXRNb2R1bGUocW4pOzE9PT1hJiZkLnNldENvbXBsZXRlZChzKTt2YXIgcD1kLm9uUm9hbWluZ01lc3NhZ2UoaSxzKTtkLm1vZGlmeU1lc3NhZ2VMaXN0KHMpLGQudXBkYXRlSXNSZWFkKHMpLGQudXBkYXRlUm9hbWluZ01lc3NhZ2VLZXlBbmRUaW1lKHMscixsKTt2YXIgZz1kLmdldFBlZXJSZWFkVGltZShzKTtpZihWZS5sKFwiXCIuY29uY2F0KG4sXCIgdXBkYXRlIGlzUGVlclJlYWQgcHJvcGVydHkuIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQocyxcIiBwZWVyUmVhZFRpbWU6XCIpLmNvbmNhdChnKSksZylkLnVwZGF0ZU1lc3NhZ2VJc1BlZXJSZWFkUHJvcGVydHkocyxnKTtlbHNle3ZhciBoPXMucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpO3QuZ2V0UmVtb3RlUGVlclJlYWRUaW1lKFtoXSkudGhlbigoZnVuY3Rpb24oKXtkLnVwZGF0ZU1lc3NhZ2VJc1BlZXJSZWFkUHJvcGVydHkocyxkLmdldFBlZXJSZWFkVGltZShzKSl9KSl9dmFyIF89XCJcIjtpZihwLmxlbmd0aD4wKV89cFswXS5JRDtlbHNle3ZhciBmPWQuZ2V0TG9jYWxPbGRlc3RNZXNzYWdlKHMpO2YmJihfPWYuSUQpfXJldHVybiBWZS5sKFwiXCIuY29uY2F0KG4sXCIgbmV4dFJlcUlEOlwiKS5jb25jYXQoXyxcIiBzdG9yZWQgbWVzc2FnZSBjb3VudDpcIikuY29uY2F0KHAubGVuZ3RoKSkse25leHRSZXFJRDpfLHN0b3JlZE1lc3NhZ2VMaXN0OnB9fSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtjLnNldE1lc3NhZ2UodSkuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJnZXRSb2FtaW5nTWVzc2FnZXNIb3BwaW5nXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZ2V0Um9hbWluZ01lc3NhZ2VzSG9wcGluZ1wiKSxvPWUucGVlckFjY291bnQscz1lLnRpbWUsYT12b2lkIDA9PT1zPzA6cyxpPWUuY291bnQscj1lLmRpcmVjdGlvbix1PVwiXCIuY29uY2F0KEUuQ09OVl9DMkMpLmNvbmNhdChvKSxjPVwicGVlckFjY291bnQ6XCIuY29uY2F0KG8sXCIgY291bnQ6XCIpLmNvbmNhdChpLFwiIHRpbWU6XCIpLmNvbmNhdChhLFwiIGRpcmVjdGlvbjpcIikuY29uY2F0KHIpO1ZlLmwoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KGMpKTt2YXIgbD1uZXcgQWEoXCJnZXRDMkNSb2FtaW5nTWVzc2FnZXNIb3BwaW5nXCIpO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpTbyxyZXF1ZXN0RGF0YTp7cGVlckFjY291bnQ6byxjb3VudDppKzEsbGFzdE1lc3NhZ2VUaW1lOmEsZGlyZWN0aW9uOnJ9fSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89ZS5kYXRhLHM9by5jb21wbGV0ZSxhPW8ubWVzc2FnZUxpc3QsaT12b2lkIDA9PT1hP1tdOmEsZD1vLmxhc3RNZXNzYWdlVGltZTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIGNvbXBsZXRlOlwiKS5jb25jYXQocyxcIiBjb3VudDpcIikuY29uY2F0KGkubGVuZ3RoKSksbC5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQoYyxcIiBjb21wbGV0ZTpcIikuY29uY2F0KHMsXCIgbGVuZ3RoOlwiKS5jb25jYXQoaS5sZW5ndGgpKS5lbmQoKSwxIT09cyYmKDE9PT1yP2kucG9wKCk6aS5zaGlmdCgpKTt2YXIgcD10LmdldE1vZHVsZShxbikub25Sb2FtaW5nTWVzc2FnZShpLHUsITEpO3QuX21vZGlmeU1lc3NhZ2VMaXN0KHUscCk7dmFyIGc9dC5fY29tcHV0ZVJlc3VsdCh7Y29tcGxldGU6cyxsYXN0TWVzc2FnZVRpbWU6ZCxyZXN1bHRMaXN0OnB9KTtyZXR1cm4gWWEoZyl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2wuc2V0TWVzc2FnZShjKS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcIl9jb21wdXRlUmVzdWx0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb21wbGV0ZSxuPXZvaWQgMD09PXQ/MDp0LG89ZS5sYXN0TWVzc2FnZVRpbWUscz1lLnJlc3VsdExpc3QsYT17bWVzc2FnZUxpc3Q6bSh2b2lkIDA9PT1zP1tdOnMpLGlzQ29tcGxldGVkOiExLG5leHRNZXNzYWdlVGltZTpcIlwifTtyZXR1cm4gMT09PW4/KGEuaXNDb21wbGV0ZWQ9ITAsYSk6KGEubmV4dE1lc3NhZ2VUaW1lPW8sYSl9fSx7a2V5OlwiX21vZGlmeU1lc3NhZ2VMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdldE1vZHVsZShxbikuZ2V0TG9jYWxDb252ZXJzYXRpb24oZSk7aWYobilmb3IodmFyIG89bi51c2VyUHJvZmlsZS5uaWNrLHM9bi51c2VyUHJvZmlsZS5hdmF0YXIsYT10aGlzLmdldE1vZHVsZShHbikuZ2V0Tmlja0FuZEF2YXRhckJ5VXNlcklEKHRoaXMuZ2V0TXlVc2VySUQoKSksaT1hLm5pY2sscj1hLmF2YXRhcix1PXQubGVuZ3RoLTE7dT49MDt1LS0pe3ZhciBjPXRbdV07XCJpblwiPT09Yy5mbG93JiYoYy5uaWNrIT09byYmYy5zZXROaWNrQW5kQXZhdGFyKHtuaWNrOm99KSxjLmF2YXRhciE9PXMmJmMuc2V0Tmlja0FuZEF2YXRhcih7YXZhdGFyOnN9KSksXCJvdXRcIj09PWMuZmxvdyYmKGMubmljayE9PWkmJmMuc2V0Tmlja0FuZEF2YXRhcih7bmljazppfSksYy5hdmF0YXIhPT1yJiZjLnNldE5pY2tBbmRBdmF0YXIoe2F2YXRhcjpyfSkpfX19LHtrZXk6XCJnZXRSZW1vdGVQZWVyUmVhZFRpbWVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRSZW1vdGVQZWVyUmVhZFRpbWVcIik7aWYoenQoZSkpcmV0dXJuIFZlLncoXCJcIi5jb25jYXQobixcIiB1c2VySURMaXN0IGlzIGVtcHR5IVwiKSksUHJvbWlzZS5yZXNvbHZlKCk7dmFyIG89bmV3IEFhKFwiZ2V0UGVlclJlYWRUaW1lXCIpO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KG4sXCIgdXNlcklETGlzdDpcIikuY29uY2F0KGUpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpMbyxyZXF1ZXN0RGF0YTp7dXNlcklETGlzdDplfX0pLnRoZW4oKGZ1bmN0aW9uKHMpe3ZhciBhPXMuZGF0YS5wZWVyUmVhZFRpbWVMaXN0O1ZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gcGVlclJlYWRUaW1lTGlzdDpcIikuY29uY2F0KGEpKTtmb3IodmFyIGk9XCJcIixyPXQuZ2V0TW9kdWxlKHFuKSx1PTA7dTxlLmxlbmd0aDt1KyspaSs9XCJcIi5jb25jYXQoZVt1XSxcIi1cIikuY29uY2F0KGFbdV0sXCIgXCIpLGFbdV0+MCYmci5yZWNvcmRQZWVyUmVhZFRpbWUoXCJDMkNcIi5jb25jYXQoZVt1XSksYVt1XSk7by5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoaSkuZW5kKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3QucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLHM9blswXSxhPW5bMV07by5zZXRFcnJvcihlLHMsYSkuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpfSkpfX0se2tleTpcInNlbmRSZWFkUmVjZWlwdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lWzBdLmNvbnZlcnNhdGlvbklELnJlcGxhY2UoRS5DT05WX0MyQyxcIlwiKSxvPW5ldyBBYShcInNlbmRDMkNSZWFkUmVjZWlwdFwiKTtvLnNldE1lc3NhZ2UoXCJwZWVyQWNjb3VudDpcIi5jb25jYXQobikpO3ZhciBzPXRoaXMuZ2V0TXlVc2VySUQoKSxhPWUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZS5mcm9tIT09cyYmITA9PT1lLm5lZWRSZWFkUmVjZWlwdH0pKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybntmcm9tQWNjb3VudDplLmZyb20sdG9BY2NvdW50OmUudG8sc2VxdWVuY2U6ZS5zZXF1ZW5jZSxyYW5kb206ZS5yYW5kb20sdGltZTplLnRpbWUsY2xpZW50VGltZTplLmNsaWVudFRpbWV9fSkpO2lmKDA9PT1hLmxlbmd0aClyZXR1cm4gWmEoe2NvZGU6aGEuUkVBRF9SRUNFSVBUX01FU1NBR0VfTElTVF9FTVBUWX0pO3ZhciBpPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuc2VuZFJlYWRSZWNlaXB0XCIpO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KGksXCIuIHBlZXJBY2NvdW50OlwiKS5jb25jYXQobixcIiBtZXNzYWdlSW5mb0xpc3QgbGVuZ3RoOlwiKS5jb25jYXQoYS5sZW5ndGgpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpwcyxyZXF1ZXN0RGF0YTp7cGVlckFjY291bnQ6bixtZXNzYWdlSW5mb0xpc3Q6YX19KS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gby5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KGksXCIgb2tcIikpLFlhKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0sYT1uWzFdO28uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQoaSxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJnZXRSZWFkUmVjZWlwdExpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldFJlYWRSZWNlaXB0TGlzdFwiKSxuPXRoaXMuZ2V0TXlVc2VySUQoKSxvPWUuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZS5mcm9tPT09biYmITA9PT1lLm5lZWRSZWFkUmVjZWlwdH0pKTtyZXR1cm4gVmUubChcIlwiLmNvbmNhdCh0LFwiIHVzZXJJRDpcIikuY29uY2F0KG4sXCIgbWVzc2FnZUxpc3QgbGVuZ3RoOlwiKS5jb25jYXQoby5sZW5ndGgpKSxYYSh7bWVzc2FnZUxpc3Q6b30pfX0se2tleTpcImdldE1lc3NhZ2VFeHRlbnNpb25zXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldE1lc3NhZ2VFeHRlbnNpb25zIHN0YXJ0U2VxdWVuY2U6XCIpLmNvbmNhdCh0KSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6T28scmVxdWVzdERhdGE6e2Zyb206ZS5mcm9tLHRvOmUudG8sbWVzc2FnZUtleTp0aGlzLl9nZXRNZXNzYWdlS2V5KGUpLHN0YXJ0U2VxdWVuY2U6dH19KX19LHtrZXk6XCJtb2RpZnlNZXNzYWdlRXh0ZW5zaW9uc1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49YXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0/YXJndW1lbnRzWzJdOjE7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5tb2RpZnlNZXNzYWdlRXh0ZW5zaW9ucyBvcGVyYXRlVHlwZTpcIikuY29uY2F0KG4pKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpObyxyZXF1ZXN0RGF0YTp7ZnJvbTplLmZyb20sdG86ZS50byxtZXNzYWdlS2V5OnRoaXMuX2dldE1lc3NhZ2VLZXkoZSksZXh0ZW5zaW9uTGlzdDp0LG9wZXJhdGVUeXBlOm59fSl9fSx7a2V5OlwiX2dldE1lc3NhZ2VLZXlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmNsaWVudFNlcXVlbmNlLG49ZS5yYW5kb20sbz1lLnRpbWU7cmV0dXJuXCJcIi5jb25jYXQodCxcIl9cIikuY29uY2F0KG4sXCJfXCIpLmNvbmNhdChvKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKSx0aGlzLl9tZXNzYWdlRnJvbVVucmVhZERCTWFwLmNsZWFyKCksdGhpcy5fc2lnbmFsaW5nRnJvbVVucmVhZERCTGlzdC5sZW5ndGg9MH19XSksc30odW8pLCRhPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe28odGhpcyxlKSx0aGlzLmxpc3Q9bmV3IE1hcCx0aGlzLl9uPVwiTWVzc2FnZUxpc3RIYW5kbGVyXCIsdGhpcy5fbGF0ZXN0TWVzc2FnZVNlbnRCeVBlZXJNYXA9bmV3IE1hcCx0aGlzLl9sYXRlc3RNZXNzYWdlU2VudEJ5TWVNYXA9bmV3IE1hcH1yZXR1cm4gYShlLFt7a2V5OlwiZ2V0TG9jYWxPbGRlc3RNZXNzYWdlQnlDb252ZXJzYXRpb25JRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybiBudWxsO2lmKCF0aGlzLmxpc3QuaGFzKGUpKXJldHVybiBudWxsO3ZhciB0PXRoaXMubGlzdC5nZXQoZSkudmFsdWVzKCk7cmV0dXJuIHQ/dC5uZXh0KCkudmFsdWU6bnVsbH19LHtrZXk6XCJwdXNoSW5cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSYmYXJndW1lbnRzWzFdLG49ZS5jb252ZXJzYXRpb25JRCxvPSEwO3RoaXMubGlzdC5oYXMobil8fHRoaXMubGlzdC5zZXQobixuZXcgTWFwKTt2YXIgcz10aGlzLl9nZXRVbmlxdWVJRE9mTWVzc2FnZShlKSxhPXRoaXMubGlzdC5nZXQobikuaGFzKHMpO2lmKGEpe3ZhciBpPXRoaXMubGlzdC5nZXQobikuZ2V0KHMpO2lmKCF0fHwhMD09PWkuaXNNb2RpZmllZClyZXR1cm4gbz0hMX1yZXR1cm4gdGhpcy5saXN0LmdldChuKS5zZXQocyxlKSx0aGlzLl9zZXRMYXRlc3RNZXNzYWdlU2VudEJ5UGVlcihuLGUpLHRoaXMuX3NldExhdGVzdE1lc3NhZ2VTZW50QnlNZShuLGUpLG99fSx7a2V5OlwidW5zaGlmdFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG47aWYoYXQoZSk/ZS5sZW5ndGg+MCYmKG49ZVswXS5jb252ZXJzYXRpb25JRCx0aGlzLl91bnNoaWZ0TXVsdGlwbGVNZXNzYWdlcyhlLHQpKToobj1lLmNvbnZlcnNhdGlvbklELHRoaXMuX3Vuc2hpZnRTaW5nbGVNZXNzYWdlKGUsdCkpLG4mJm4uc3RhcnRzV2l0aChFLkNPTlZfQzJDKSl7dmFyIG89QXJyYXkuZnJvbSh0aGlzLmxpc3QuZ2V0KG4pLnZhbHVlcygpKSxzPW8ubGVuZ3RoO2lmKDA9PT1zKXJldHVybjtmb3IodmFyIGE9cy0xO2E+PTA7YS0tKWlmKFwib3V0XCI9PT1vW2FdLmZsb3cpe3RoaXMuX3NldExhdGVzdE1lc3NhZ2VTZW50QnlNZShuLG9bYV0pO2JyZWFrfWZvcih2YXIgaT1zLTE7aT49MDtpLS0paWYoXCJpblwiPT09b1tpXS5mbG93KXt0aGlzLl9zZXRMYXRlc3RNZXNzYWdlU2VudEJ5UGVlcihuLG9baV0pO2JyZWFrfX19fSx7a2V5OlwiX3Vuc2hpZnRTaW5nbGVNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmNvbnZlcnNhdGlvbklELG89dGhpcy5fZ2V0VW5pcXVlSURPZk1lc3NhZ2UoZSk7aWYoIXRoaXMubGlzdC5oYXMobikpcmV0dXJuIHRoaXMubGlzdC5zZXQobixuZXcgTWFwKSx0aGlzLmxpc3QuZ2V0KG4pLnNldChvLGUpLHZvaWQgdC5wdXNoKGUpO3ZhciBzPXRoaXMubGlzdC5nZXQobiksYT1BcnJheS5mcm9tKHMpO3MuaGFzKG8pfHwoYS51bnNoaWZ0KFtvLGVdKSx0aGlzLmxpc3Quc2V0KG4sbmV3IE1hcChhKSksdC5wdXNoKGUpKX19LHtrZXk6XCJfdW5zaGlmdE11bHRpcGxlTWVzc2FnZXNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1lLmxlbmd0aCxvPVtdLHM9ZVswXS5jb252ZXJzYXRpb25JRCxhPXRoaXMubGlzdC5nZXQocyksaT10aGlzLmxpc3QuaGFzKHMpP0FycmF5LmZyb20oYSk6W10scj0wO3I8bjtyKyspe3ZhciB1PXRoaXMuX2dldFVuaXF1ZUlET2ZNZXNzYWdlKGVbcl0pO2EmJmEuaGFzKHUpfHwoby5wdXNoKFt1LGVbcl1dKSx0LnB1c2goZVtyXSkpfXRoaXMubGlzdC5zZXQocyxuZXcgTWFwKG8uY29uY2F0KGkpKSl9fSx7a2V5OlwicmVtb3ZlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPXRoaXMuX2dldFVuaXF1ZUlET2ZNZXNzYWdlKGUpO3RoaXMubGlzdC5oYXModCkmJnRoaXMubGlzdC5nZXQodCkuZGVsZXRlKG4pfX0se2tleTpcInJldm9rZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtpZihWZS5kKFwicmV2b2tlIG1lc3NhZ2VcIixlLHQsbiksdGhpcy5saXN0LmhhcyhlKSl7dmFyIG8scz1EKHRoaXMubGlzdC5nZXQoZSkpO3RyeXtmb3Iocy5zKCk7IShvPXMubigpKS5kb25lOyl7dmFyIGE9dihvLnZhbHVlLDIpWzFdO2lmKGEuc2VxdWVuY2U9PT10JiYoaXQobil8fGEucmFuZG9tPT09bikpcmV0dXJuIGEuaXNSZXZva2VkfHwoYS5pc1Jldm9rZWQ9ITApLGF9fWNhdGNoKGkpe3MuZShpKX1maW5hbGx5e3MuZigpfX1yZXR1cm4gbnVsbH19LHtrZXk6XCJyZW1vdmVCeUNvbnZlcnNhdGlvbklEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5saXN0LmhhcyhlKSYmKHRoaXMubGlzdC5kZWxldGUoZSksdGhpcy5fbGF0ZXN0TWVzc2FnZVNlbnRCeVBlZXJNYXAuZGVsZXRlKGUpLHRoaXMuX2xhdGVzdE1lc3NhZ2VTZW50QnlNZU1hcC5kZWxldGUoZSkpfX0se2tleTpcImZpbmRNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQsbj1udWxsLG89RCh0aGlzLmxpc3QpO3RyeXtmb3Ioby5zKCk7ISh0PW8ubigpKS5kb25lOylmb3IodmFyIHM9bSh2KHQudmFsdWUsMilbMV0udmFsdWVzKCkpLGE9cy5sZW5ndGgsaT0wO2k8YTtpKyspaWYoc1tpXS5JRD09PWUpe249c1tpXTticmVha319Y2F0Y2gocil7by5lKHIpfWZpbmFsbHl7by5mKCl9cmV0dXJuIG59fSx7a2V5OlwidXBkYXRlTWVzc2FnZUlzUGVlclJlYWRQcm9wZXJ0eVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49W107aWYodGhpcy5saXN0LmhhcyhlKSl7dmFyIG8scz1EKHRoaXMubGlzdC5nZXQoZSkpO3RyeXtmb3Iocy5zKCk7IShvPXMubigpKS5kb25lOyl7dmFyIGE9dihvLnZhbHVlLDIpWzFdO2EudGltZTw9dCYmIWEuaXNQZWVyUmVhZCYmXCJvdXRcIj09PWEuZmxvdyYmKGEuaXNQZWVyUmVhZD0hMCxuLnB1c2goYSkpfX1jYXRjaChpKXtzLmUoaSl9ZmluYWxseXtzLmYoKX1WZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIudXBkYXRlTWVzc2FnZUlzUGVlclJlYWRQcm9wZXJ0eSBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KGUsXCIgcGVlclJlYWRUaW1lOlwiKS5jb25jYXQodCxcIiBjb3VudDpcIikuY29uY2F0KG4ubGVuZ3RoKSl9cmV0dXJuIG59fSx7a2V5OlwidXBkYXRlTWVzc2FnZUlzTW9kaWZpZWRQcm9wZXJ0eVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuY29udmVyc2F0aW9uSUQ7aWYodGhpcy5saXN0Lmhhcyh0KSl7dmFyIG49dGhpcy5fZ2V0VW5pcXVlSURPZk1lc3NhZ2UoZSksbz10aGlzLmxpc3QuZ2V0KHQpLmdldChuKTtvJiYoby5pc01vZGlmaWVkPSEwKX19fSx7a2V5OlwiaGFzTG9jYWxNZXNzYWdlTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmxpc3QuaGFzKGUpfX0se2tleTpcImdldExvY2FsTWVzc2FnZUxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5oYXNMb2NhbE1lc3NhZ2VMaXN0KGUpP20odGhpcy5saXN0LmdldChlKS52YWx1ZXMoKSk6W119fSx7a2V5OlwiaGFzTG9jYWxNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49ITEsbz10aGlzLmdldExvY2FsTWVzc2FnZUxpc3QoZSkscz1vLmxlbmd0aCxhPTA7YTxzO2ErKylvW2FdLklEPT09dCYmKG49ITApO3JldHVybiBufX0se2tleTpcImdldExvY2FsTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPW51bGwsbz10aGlzLmdldExvY2FsTWVzc2FnZUxpc3QoZSkscz1vLmxlbmd0aCxhPTA7YTxzO2ErKylpZihvW2FdLklEPT09dCl7bj1vW2FdO2JyZWFrfXJldHVybiBufX0se2tleTpcImdldExvY2FsTGFzdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldExvY2FsTWVzc2FnZUxpc3QoZSk7cmV0dXJuIHRbdC5sZW5ndGgtMV19fSx7a2V5OlwiZ2V0TG9jYWxPbGRlc3RNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2V0TG9jYWxNZXNzYWdlTGlzdChlKVswXX19LHtrZXk6XCJfc2V0TGF0ZXN0TWVzc2FnZVNlbnRCeVBlZXJcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Uuc3RhcnRzV2l0aChFLkNPTlZfQzJDKSYmXCJpblwiPT09dC5mbG93JiZ0aGlzLl9sYXRlc3RNZXNzYWdlU2VudEJ5UGVlck1hcC5zZXQoZSx0KX19LHtrZXk6XCJfc2V0TGF0ZXN0TWVzc2FnZVNlbnRCeU1lXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtlLnN0YXJ0c1dpdGgoRS5DT05WX0MyQykmJlwib3V0XCI9PT10LmZsb3cmJnRoaXMuX2xhdGVzdE1lc3NhZ2VTZW50QnlNZU1hcC5zZXQoZSx0KX19LHtrZXk6XCJnZXRMYXRlc3RNZXNzYWdlU2VudEJ5UGVlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9sYXRlc3RNZXNzYWdlU2VudEJ5UGVlck1hcC5nZXQoZSl9fSx7a2V5OlwiZ2V0TGF0ZXN0TWVzc2FnZVNlbnRCeU1lXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2xhdGVzdE1lc3NhZ2VTZW50QnlNZU1hcC5nZXQoZSl9fSx7a2V5OlwibW9kaWZ5TWVzc2FnZVNlbnRCeVBlZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmNvbnZlcnNhdGlvbklELG49ZS5sYXRlc3ROaWNrLG89ZS5sYXRlc3RBdmF0YXIscz10aGlzLmxpc3QuZ2V0KHQpO2lmKCF6dChzKSl7dmFyIGE9QXJyYXkuZnJvbShzLnZhbHVlcygpKSxpPWEubGVuZ3RoO2lmKDAhPT1pKXtmb3IodmFyIHI9bnVsbCx1PTAsYz0hMSxsPWktMTtsPj0wO2wtLSlcImluXCI9PT1hW2xdLmZsb3cmJigocj1hW2xdKS5uaWNrIT09biYmKHIuc2V0Tmlja0FuZEF2YXRhcih7bmljazpufSksYz0hMCksci5hdmF0YXIhPT1vJiYoci5zZXROaWNrQW5kQXZhdGFyKHthdmF0YXI6b30pLGM9ITApLGMmJih1Kz0xKSk7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm1vZGlmeU1lc3NhZ2VTZW50QnlQZWVyIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQodCxcIiBjb3VudDpcIikuY29uY2F0KHUpKX19fX0se2tleTpcIm1vZGlmeU1lc3NhZ2VTZW50QnlNZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuY29udmVyc2F0aW9uSUQsbj1lLmxhdGVzdE5pY2ssbz1lLmxhdGVzdEF2YXRhcixzPXRoaXMubGlzdC5nZXQodCk7aWYoIXp0KHMpKXt2YXIgYT1BcnJheS5mcm9tKHMudmFsdWVzKCkpLGk9YS5sZW5ndGg7aWYoMCE9PWkpe2Zvcih2YXIgcj1udWxsLHU9MCxjPSExLGw9aS0xO2w+PTA7bC0tKVwib3V0XCI9PT1hW2xdLmZsb3cmJigocj1hW2xdKS5uaWNrIT09biYmKHIuc2V0Tmlja0FuZEF2YXRhcih7bmljazpufSksYz0hMCksci5hdmF0YXIhPT1vJiYoci5zZXROaWNrQW5kQXZhdGFyKHthdmF0YXI6b30pLGM9ITApLGMmJih1Kz0xKSk7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm1vZGlmeU1lc3NhZ2VTZW50QnlNZSBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KHQsXCIgY291bnQ6XCIpLmNvbmNhdCh1KSl9fX19LHtrZXk6XCJnZXRUb3BpY0NvbnZlcnNhdGlvbklETGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBtKHRoaXMubGlzdC5rZXlzKCkpLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIHQuc3RhcnRzV2l0aChcIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChlKSl9KSl9fSx7a2V5OlwidHJhdmVyc2FsXCIsdmFsdWU6ZnVuY3Rpb24oKXtpZigwIT09dGhpcy5saXN0LnNpemUmJi0xPT09VmUuZ2V0TGV2ZWwoKSl7Y29uc29sZS5ncm91cChcImNvbnZlcnNhdGlvbklELW1lc3NhZ2VDb3VudFwiKTt2YXIgZSx0PUQodGhpcy5saXN0KTt0cnl7Zm9yKHQucygpOyEoZT10Lm4oKSkuZG9uZTspe3ZhciBuPXYoZS52YWx1ZSwyKSxvPW5bMF0scz1uWzFdO2NvbnNvbGUubG9nKFwiXCIuY29uY2F0KG8sXCItXCIpLmNvbmNhdChzLnNpemUpKX19Y2F0Y2goYSl7dC5lKGEpfWZpbmFsbHl7dC5mKCl9Y29uc29sZS5ncm91cEVuZCgpfX19LHtrZXk6XCJvbk1lc3NhZ2VNb2RpZmllZFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7aWYoIXRoaXMubGlzdC5oYXMoZSkpcmV0dXJue2lzVXBkYXRlZDohMSxtZXNzYWdlOm51bGx9O3ZhciBuPXRoaXMuX2dldFVuaXF1ZUlET2ZNZXNzYWdlKHQpLG89dGhpcy5saXN0LmdldChlKS5oYXMobik7aWYoVmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uTWVzc2FnZU1vZGlmaWVkIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQoZSxcIiB1bmlxdWVJRDpcIikuY29uY2F0KG4sXCIgaGFzOlwiKS5jb25jYXQobykpLG8pe3ZhciBzPXRoaXMubGlzdC5nZXQoZSkuZ2V0KG4pLGE9dC5tZXNzYWdlVmVyc2lvbixpPXQuZWxlbWVudHMscj10LmNsb3VkQ3VzdG9tRGF0YTtyZXR1cm4gcy52ZXJzaW9uPGE/KHMudmVyc2lvbj1hLHMuX2VsZW1lbnRzPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaSkpLHMucGF5bG9hZD1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGlbMF0uY29udGVudCkpLHMudHlwZT1pWzBdLnR5cGUscy5jbG91ZEN1c3RvbURhdGE9cixzLmlzTW9kaWZpZWQ9ITAse2lzVXBkYXRlZDohMCxtZXNzYWdlOnN9KTp7aXNVcGRhdGVkOiExLG1lc3NhZ2U6c319cmV0dXJue2lzVXBkYXRlZDohMSxtZXNzYWdlOm51bGx9fX0se2tleTpcIl9nZXRVbmlxdWVJRE9mTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZnJvbSxuPWUudG8sbz1lLnJhbmRvbSxzPWUuc2VxdWVuY2UsYT1lLnRpbWU7cmV0dXJuXCJcIi5jb25jYXQodCxcIi1cIikuY29uY2F0KG4sXCItXCIpLmNvbmNhdChvLFwiLVwiKS5jb25jYXQocyxcIi1cIikuY29uY2F0KGEpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLmxpc3QuY2xlYXIoKSx0aGlzLl9sYXRlc3RNZXNzYWdlU2VudEJ5UGVlck1hcC5jbGVhcigpLHRoaXMuX2xhdGVzdE1lc3NhZ2VTZW50QnlNZU1hcC5jbGVhcigpfX1dKSxlfSgpLGVpPVwiX2EyS2V5QW5kVGlueUlEVXBkYXRlZFwiLHRpPVwiX2Nsb3VkQ29uZmlnVXBkYXRlZFwiLG5pPVwiX3Byb2ZpbGVVcGRhdGVkXCI7ZnVuY3Rpb24gb2koZSl7dGhpcy5taXhpbihlKX1vaS5taXhpbj1mdW5jdGlvbihlKXt2YXIgdD1lLnByb3RvdHlwZXx8ZTt0Ll9pc1JlYWR5PSExLHQucmVhZHk9ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXTtpZihlKXJldHVybiB0aGlzLl9pc1JlYWR5P3ZvaWQodD9lLmNhbGwodGhpcyk6c2V0VGltZW91dChlLDEpKToodGhpcy5fcmVhZHlRdWV1ZT10aGlzLl9yZWFkeVF1ZXVlfHxbXSx2b2lkIHRoaXMuX3JlYWR5UXVldWUucHVzaChlKSl9LHQudHJpZ2dlclJlYWR5PWZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9pc1JlYWR5PSEwLHNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7dmFyIHQ9ZS5fcmVhZHlRdWV1ZTtlLl9yZWFkeVF1ZXVlPVtdLHQmJnQubGVuZ3RoPjAmJnQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5jYWxsKHRoaXMpfSksZSl9KSwxKX0sdC5yZXNldFJlYWR5PWZ1bmN0aW9uKCl7dGhpcy5faXNSZWFkeT0hMSx0aGlzLl9yZWFkeVF1ZXVlPVtdfSx0LmlzUmVhZHk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNSZWFkeX19O3ZhciBzaT1bXCJqcGdcIixcImpwZWdcIixcImdpZlwiLFwicG5nXCIsXCJibXBcIixcImltYWdlXCIsXCJ3ZWJwXCJdLGFpPVtcIm1wNFwiLFwicXVpY2t0aW1lXCIsXCJtb3ZcIl0saWk9MSxyaT0yLHVpPTMsY2k9MjU1LGxpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXt2YXIgbj10aGlzO28odGhpcyxlKSx6dCh0KXx8KHRoaXMudXNlcklEPXQudXNlcklEfHxcIlwiLHRoaXMubmljaz10Lm5pY2t8fFwiXCIsdGhpcy5nZW5kZXI9dC5nZW5kZXJ8fFwiXCIsdGhpcy5iaXJ0aGRheT10LmJpcnRoZGF5fHwwLHRoaXMubG9jYXRpb249dC5sb2NhdGlvbnx8XCJcIix0aGlzLnNlbGZTaWduYXR1cmU9dC5zZWxmU2lnbmF0dXJlfHxcIlwiLHRoaXMuYWxsb3dUeXBlPXQuYWxsb3dUeXBlfHxFLkFMTE9XX1RZUEVfQUxMT1dfQU5ZLHRoaXMubGFuZ3VhZ2U9dC5sYW5ndWFnZXx8MCx0aGlzLmF2YXRhcj10LmF2YXRhcnx8XCJcIix0aGlzLm1lc3NhZ2VTZXR0aW5ncz10Lm1lc3NhZ2VTZXR0aW5nc3x8MCx0aGlzLmFkbWluRm9yYmlkVHlwZT10LmFkbWluRm9yYmlkVHlwZXx8RS5GT1JCSURfVFlQRV9OT05FLHRoaXMubGV2ZWw9dC5sZXZlbHx8MCx0aGlzLnJvbGU9dC5yb2xlfHwwLHRoaXMubGFzdFVwZGF0ZWRUaW1lPTAsdGhpcy5wcm9maWxlQ3VzdG9tRmllbGQ9W10senQodC5wcm9maWxlQ3VzdG9tRmllbGQpfHx0LnByb2ZpbGVDdXN0b21GaWVsZC5mb3JFYWNoKChmdW5jdGlvbihlKXtuLnByb2ZpbGVDdXN0b21GaWVsZC5wdXNoKHtrZXk6ZS5rZXksdmFsdWU6ZS52YWx1ZX0pfSkpKX1yZXR1cm4gYShlLFt7a2V5OlwidmFsaWRhdGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0hMCxuPVwiXCI7aWYoenQoZSkpcmV0dXJue3ZhbGlkOiExLHRpcHM6XCJlbXB0eSBvcHRpb25zXCJ9O2lmKGUucHJvZmlsZUN1c3RvbUZpZWxkKWZvcih2YXIgbz1lLnByb2ZpbGVDdXN0b21GaWVsZC5sZW5ndGgscz1udWxsLGE9MDthPG87YSsrKXtpZihzPWUucHJvZmlsZUN1c3RvbUZpZWxkW2FdLCFudChzLmtleSl8fC0xPT09cy5rZXkuaW5kZXhPZihcIlRhZ19Qcm9maWxlX0N1c3RvbVwiKSlyZXR1cm57dmFsaWQ6ITEsdGlwczpcIlRoZSBwcmVmaXggb2Yga2V5cyBvZiB0aGUgY3VzdG9tIHByb2ZpbGUga2V5LXZhbHVlIHBhaXJzICh3aGljaCBpcyBwcm9maWxlQ3VzdG9tRmllbGQpIG11c3QgYmUgVGFnX1Byb2ZpbGVfQ3VzdG9tXCJ9O2lmKCFudChzLnZhbHVlKSlyZXR1cm57dmFsaWQ6ITEsdGlwczpcIlRoZSB0eXBlIG9mIHZhbHVlcyBvZiB0aGUgY3VzdG9tIHByb2ZpbGUga2V5LXZhbHVlIHBhaXJzICh3aGljaCBpcyBwcm9maWxlQ3VzdG9tRmllbGQpIG11c3QgYmUgU3RyaW5nXCJ9fWZvcih2YXIgaSBpbiBlKWlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLGkpKXtpZihcInByb2ZpbGVDdXN0b21GaWVsZFwiPT09aSljb250aW51ZTtpZih6dChlW2ldKSYmIW50KGVbaV0pJiYhZXQoZVtpXSkpe249XCJrZXk6XCIraStcIiwgaW52YWxpZCB2YWx1ZTpcIitlW2ldLHQ9ITE7Y29udGludWV9c3dpdGNoKGkpe2Nhc2VcIm5pY2tcIjpudChlW2ldKXx8KG49XCJuaWNrIG11c3QgYmUgYSBzdHJpbmdcIix0PSExKSxodChlW2ldKT41MDAmJihuPVwibmljayBuYW1lIGxpbWl0ZWQ6IG11c3QgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIFwiLmNvbmNhdCg1MDAsXCIgYnl0ZXMsIGN1cnJlbnQgc2l6ZTogXCIpLmNvbmNhdChodChlW2ldKSxcIiBieXRlc1wiKSx0PSExKTticmVhaztjYXNlXCJnZW5kZXJcIjptdChLZSxlLmdlbmRlcil8fChuPVwia2V5OmdlbmRlciwgaW52YWxpZCB2YWx1ZTpcIitlLmdlbmRlcix0PSExKTticmVhaztjYXNlXCJiaXJ0aGRheVwiOmV0KGUuYmlydGhkYXkpfHwobj1cImJpcnRoZGF5IG11c3QgYmUgYSBudW1iZXJcIix0PSExKTticmVhaztjYXNlXCJsb2NhdGlvblwiOm50KGUubG9jYXRpb24pfHwobj1cImxvY2F0aW9uIG11c3QgYmUgYSBzdHJpbmdcIix0PSExKTticmVhaztjYXNlXCJzZWxmU2lnbmF0dXJlXCI6bnQoZS5zZWxmU2lnbmF0dXJlKXx8KG49XCJzZWxmU2lnbmF0dXJlIG11c3QgYmUgYSBzdHJpbmdcIix0PSExKTticmVhaztjYXNlXCJhbGxvd1R5cGVcIjptdChZZSxlLmFsbG93VHlwZSl8fChuPVwia2V5OmFsbG93VHlwZSwgaW52YWxpZCB2YWx1ZTpcIitlLmFsbG93VHlwZSx0PSExKTticmVhaztjYXNlXCJsYW5ndWFnZVwiOmV0KGUubGFuZ3VhZ2UpfHwobj1cImxhbmd1YWdlIG11c3QgYmUgYSBudW1iZXJcIix0PSExKTticmVhaztjYXNlXCJhdmF0YXJcIjpudChlLmF2YXRhcil8fChuPVwiYXZhdGFyIG11c3QgYmUgYSBzdHJpbmdcIix0PSExKTticmVhaztjYXNlXCJtZXNzYWdlU2V0dGluZ3NcIjowIT09ZS5tZXNzYWdlU2V0dGluZ3MmJjEhPT1lLm1lc3NhZ2VTZXR0aW5ncyYmKG49XCJtZXNzYWdlU2V0dGluZ3MgbXVzdCBiZSAwIG9yIDFcIix0PSExKTticmVhaztjYXNlXCJhZG1pbkZvcmJpZFR5cGVcIjptdChXZSxlLmFkbWluRm9yYmlkVHlwZSl8fChuPVwia2V5OmFkbWluRm9yYmlkVHlwZSwgaW52YWxpZCB2YWx1ZTpcIitlLmFkbWluRm9yYmlkVHlwZSx0PSExKTticmVhaztjYXNlXCJsZXZlbFwiOmV0KGUubGV2ZWwpfHwobj1cImxldmVsIG11c3QgYmUgYSBudW1iZXJcIix0PSExKTticmVhaztjYXNlXCJyb2xlXCI6ZXQoZS5yb2xlKXx8KG49XCJyb2xlIG11c3QgYmUgYSBudW1iZXJcIix0PSExKTticmVhaztkZWZhdWx0Om49XCJ1bmtub3duIGtleTpcIitpK1wiICBcIitlW2ldLHQ9ITF9fXJldHVybnt2YWxpZDp0LHRpcHM6bn19fV0pLGV9KCksZGk9YSgoZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy52YWx1ZT10LHRoaXMubmV4dD1udWxsfSkpLHBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5NQVhfTEVOR1RIPXQsdGhpcy5wVGFpbD1udWxsLHRoaXMucE5vZGVUb0RlbD1udWxsLHRoaXMubWFwPW5ldyBNYXB9cmV0dXJuIGEoZSxbe2tleTpcInNldFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBkaShlKTtpZih0aGlzLm1hcC5zaXplPHRoaXMuTUFYX0xFTkdUSCludWxsPT09dGhpcy5wVGFpbD8odGhpcy5wVGFpbD10LHRoaXMucE5vZGVUb0RlbD10KToodGhpcy5wVGFpbC5uZXh0PXQsdGhpcy5wVGFpbD10KSx0aGlzLm1hcC5zZXQoZSwxKTtlbHNle3ZhciBuPXRoaXMucE5vZGVUb0RlbDt0aGlzLnBOb2RlVG9EZWw9dGhpcy5wTm9kZVRvRGVsLm5leHQsdGhpcy5tYXAuZGVsZXRlKG4udmFsdWUpLG4ubmV4dD1udWxsLG49bnVsbCx0aGlzLnBUYWlsLm5leHQ9dCx0aGlzLnBUYWlsPXQsdGhpcy5tYXAuc2V0KGUsMSl9fX0se2tleTpcImhhc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLm1hcC5oYXMoZSl9fSx7a2V5OlwiZGVsZXRlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5oYXMoZSkmJnRoaXMubWFwLmRlbGV0ZShlKX19LHtrZXk6XCJ0YWlsXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wVGFpbH19LHtrZXk6XCJzaXplXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAuc2l6ZX19LHtrZXk6XCJkYXRhXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1hcC5rZXlzKCkpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtmb3IodmFyIGU7bnVsbCE9PXRoaXMucE5vZGVUb0RlbDspZT10aGlzLnBOb2RlVG9EZWwsdGhpcy5wTm9kZVRvRGVsPXRoaXMucE5vZGVUb0RlbC5uZXh0LGUubmV4dD1udWxsLGU9bnVsbDt0aGlzLnBUYWlsPW51bGwsdGhpcy5tYXAuY2xlYXIoKX19XSksZX0oKSxnaT1bXCJncm91cElEXCIsXCJuYW1lXCIsXCJhdmF0YXJcIixcInR5cGVcIixcImludHJvZHVjdGlvblwiLFwibm90aWZpY2F0aW9uXCIsXCJvd25lcklEXCIsXCJzZWxmSW5mb1wiLFwiY3JlYXRlVGltZVwiLFwiaW5mb1NlcXVlbmNlXCIsXCJsYXN0SW5mb1RpbWVcIixcImxhc3RNZXNzYWdlXCIsXCJuZXh0TWVzc2FnZVNlcVwiLFwibWVtYmVyTnVtXCIsXCJtYXhNZW1iZXJOdW1cIixcIm1lbWJlckxpc3RcIixcImpvaW5PcHRpb25cIixcImdyb3VwQ3VzdG9tRmllbGRcIixcIm11dGVBbGxNZW1iZXJzXCIsXCJpc1N1cHBvcnRUb3BpY1wiLFwiaW52aXRlT3B0aW9uXCIsXCJfbGFzdFJldm9rZWRUaW1lXCJdLGhpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5ncm91cElEPVwiXCIsdGhpcy5uYW1lPVwiXCIsdGhpcy5hdmF0YXI9XCJcIix0aGlzLnR5cGU9XCJcIix0aGlzLmludHJvZHVjdGlvbj1cIlwiLHRoaXMubm90aWZpY2F0aW9uPVwiXCIsdGhpcy5vd25lcklEPVwiXCIsdGhpcy5jcmVhdGVUaW1lPVwiXCIsdGhpcy5pbmZvU2VxdWVuY2U9XCJcIix0aGlzLmxhc3RJbmZvVGltZT1cIlwiLHRoaXMuc2VsZkluZm89e21lc3NhZ2VSZW1pbmRUeXBlOlwiXCIsam9pblRpbWU6XCJcIixuYW1lQ2FyZDpcIlwiLHJvbGU6XCJcIix1c2VySUQ6XCJcIixtZW1iZXJDdXN0b21GaWVsZDp2b2lkIDAscmVhZGVkU2VxdWVuY2U6MCxleGNsdWRlZFVucmVhZFNlcXVlbmNlTGlzdDp2b2lkIDB9LHRoaXMubGFzdE1lc3NhZ2U9e2xhc3RUaW1lOlwiXCIsbGFzdFNlcXVlbmNlOlwiXCIsZnJvbUFjY291bnQ6XCJcIixtZXNzYWdlRm9yU2hvdzpcIlwifSx0aGlzLm5leHRNZXNzYWdlU2VxPVwiXCIsdGhpcy5tZW1iZXJOdW09XCJcIix0aGlzLm1lbWJlckNvdW50PVwiXCIsdGhpcy5tYXhNZW1iZXJOdW09XCJcIix0aGlzLm1heE1lbWJlckNvdW50PVwiXCIsdGhpcy5qb2luT3B0aW9uPVwiXCIsdGhpcy5pbnZpdGVPcHRpb249XCJcIix0aGlzLmdyb3VwQ3VzdG9tRmllbGQ9W10sdGhpcy5tdXRlQWxsTWVtYmVycz0hMSx0aGlzLmlzU3VwcG9ydFRvcGljPSExLHRoaXMuX2xhc3RSZXZva2VkVGltZT0wLHRoaXMuX2luaXRHcm91cCh0KX1yZXR1cm4gYShlLFt7a2V5OlwibWVtYmVyTnVtXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWVtYmVyQ291bnR9LHNldDpmdW5jdGlvbihlKXt9fSx7a2V5OlwibWF4TWVtYmVyTnVtXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF4TWVtYmVyQ291bnR9LHNldDpmdW5jdGlvbihlKXt9fSx7a2V5OlwiX2luaXRHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiBlKWdpLmluZGV4T2YodCk8MHx8KFwic2VsZkluZm9cIiE9PXQ/KFwibWVtYmVyTnVtXCI9PT10JiYodGhpcy5tZW1iZXJDb3VudD1lW3RdKSxcIm1heE1lbWJlck51bVwiPT09dCYmKHRoaXMubWF4TWVtYmVyQ291bnQ9ZVt0XSksXCJpc1N1cHBvcnRUb3BpY1wiIT09dD90aGlzW3RdPWVbdF06dGhpcy5pc1N1cHBvcnRUb3BpYz0xPT09ZVt0XSk6dGhpcy51cGRhdGVTZWxmSW5mbyhlW3RdKSl9fSx7a2V5OlwidXBkYXRlR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2UuYXBwaWQ9dm9pZCAwLGUuZ3Jvc3NUb3BpY05leHRNc2dTZXE9dm9pZCAwLGUuc2VsZkluZm8mJihlLnNlbGZJbmZvLmdyb3NzVG9waWNSZWFkU2VxPXZvaWQgMCk7dmFyIG49SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlKSk7bi5sYXN0TXNnVGltZSYmKHRoaXMubGFzdE1lc3NhZ2UubGFzdFRpbWU9bi5sYXN0TXNnVGltZSksaXQobi5tdXRlQWxsTWVtYmVycyl8fChcIk9uXCI9PT1uLm11dGVBbGxNZW1iZXJzP24ubXV0ZUFsbE1lbWJlcnM9ITA6bi5tdXRlQWxsTWVtYmVycz0hMSksbi5ncm91cEN1c3RvbUZpZWxkJiZDdCh0aGlzLmdyb3VwQ3VzdG9tRmllbGQsbi5ncm91cEN1c3RvbUZpZWxkKSxpdChuLm1lbWJlck51bSl8fCh0aGlzLm1lbWJlckNvdW50PW4ubWVtYmVyTnVtKSxpdChuLm1heE1lbWJlck51bSl8fCh0aGlzLm1heE1lbWJlckNvdW50PW4ubWF4TWVtYmVyTnVtKSxpdChuLmlzU3VwcG9ydFRvcGljKXx8KHRoaXMuaXNTdXBwb3J0VG9waWM9ZXQobi5pc1N1cHBvcnRUb3BpYyk/MT09PW4uaXNTdXBwb3J0VG9waWM6bi5pc1N1cHBvcnRUb3BpYykscHQodGhpcyxuLFtcIm1lbWJlcnNcIixcImVycm9yQ29kZVwiLFwibGFzdE1zZ1RpbWVcIixcImdyb3VwQ3VzdG9tRmllbGRcIixcIm1lbWJlck51bVwiLFwibWF4TWVtYmVyTnVtXCIsXCJpc1N1cHBvcnRUb3BpY1wiXSksYXQobi5tZW1iZXJzKSYmbi5tZW1iZXJzLmxlbmd0aD4wJiZuLm1lbWJlcnMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS51c2VySUQ9PT10LnNlbGZJbmZvLnVzZXJJRCYmcHQodC5zZWxmSW5mbyxlLFtcInNlcXVlbmNlXCJdKX0pKX19LHtrZXk6XCJ1cGRhdGVTZWxmSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXtuYW1lQ2FyZDplLm5hbWVDYXJkLGpvaW5UaW1lOmUuam9pblRpbWUscm9sZTplLnJvbGUsbWVzc2FnZVJlbWluZFR5cGU6ZS5tZXNzYWdlUmVtaW5kVHlwZSxyZWFkZWRTZXF1ZW5jZTplLnJlYWRlZFNlcXVlbmNlLGV4Y2x1ZGVkVW5yZWFkU2VxdWVuY2VMaXN0OmUuZXhjbHVkZWRVbnJlYWRTZXF1ZW5jZUxpc3R9O3B0KHRoaXMuc2VsZkluZm8sdCh7fSxuKSxbXSxbXCJcIixudWxsLHZvaWQgMCwwLE5hTl0pfX0se2tleTpcInNldFNlbGZOYW1lQ2FyZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuc2VsZkluZm8ubmFtZUNhcmQ9ZX19XSksZX0oKSxfaT1mdW5jdGlvbihlLG4pe3JldHVybiBpdChlKT97bGFzdFRpbWU6MCxsYXN0U2VxdWVuY2U6MCxmcm9tQWNjb3VudDowLG1lc3NhZ2VGb3JTaG93OlwiXCIscGF5bG9hZDpudWxsLHR5cGU6XCJcIixpc1Jldm9rZWQ6ITEsY2xvdWRDdXN0b21EYXRhOlwiXCIsb25saW5lT25seUZsYWc6ITEsbmljazpcIlwiLG5hbWVDYXJkOlwiXCIsdmVyc2lvbjowLGlzUGVlclJlYWQ6ITEscmV2b2tlcjpudWxsfTplIGluc3RhbmNlb2YgV2E/e2xhc3RUaW1lOmUudGltZXx8MCxsYXN0U2VxdWVuY2U6ZS5zZXF1ZW5jZXx8MCxmcm9tQWNjb3VudDplLmZyb218fFwiXCIsbWVzc2FnZUZvclNob3c6VnQoZS50eXBlLGUucGF5bG9hZCxuKSxwYXlsb2FkOmUucGF5bG9hZHx8bnVsbCx0eXBlOmUudHlwZXx8bnVsbCxpc1Jldm9rZWQ6ZS5pc1Jldm9rZWR8fCExLGNsb3VkQ3VzdG9tRGF0YTplLmNsb3VkQ3VzdG9tRGF0YXx8XCJcIixvbmxpbmVPbmx5RmxhZzplLl9vbmxpbmVPbmx5RmxhZ3x8ITEsbmljazplLm5pY2t8fFwiXCIsbmFtZUNhcmQ6ZS5uYW1lQ2FyZHx8XCJcIix2ZXJzaW9uOmUudmVyc2lvbnx8MCxpc1BlZXJSZWFkOmUuaXNQZWVyUmVhZHx8ITEscmV2b2tlcjplLnJldm9rZXJ8fG51bGx9OnQodCh7fSxlKSx7fSx7bWVzc2FnZUZvclNob3c6VnQoZS50eXBlLGUucGF5bG9hZCxuKX0pfSxmaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXtvKHRoaXMsZSksdGhpcy5jb252ZXJzYXRpb25JRD10LmNvbnZlcnNhdGlvbklEfHxcIlwiLHRoaXMudW5yZWFkQ291bnQ9dC51bnJlYWRDb3VudHx8MCx0aGlzLnR5cGU9dC50eXBlfHxcIlwiLHRoaXMubGFzdE1lc3NhZ2U9X2kodC5sYXN0TWVzc2FnZSxuKSx0Lmxhc3RNc2dUaW1lJiYodGhpcy5sYXN0TWVzc2FnZS5sYXN0VGltZT10Lmxhc3RNc2dUaW1lKSx0aGlzLl9pc0luZm9Db21wbGV0ZWQ9ITEsdGhpcy5wZWVyUmVhZFRpbWU9dC5wZWVyUmVhZFRpbWV8fDAsdGhpcy5ncm91cEF0SW5mb0xpc3Q9W10sdGhpcy5yZW1hcms9XCJcIix0aGlzLmlzUGlubmVkPXQuaXNQaW5uZWR8fCExLHRoaXMubWVzc2FnZVJlbWluZFR5cGU9XCJcIix0aGlzLm1hcmtMaXN0PXQubWFya0xpc3R8fFtdLHRoaXMuY3VzdG9tRGF0YT10LmN1c3RvbURhdGF8fFwiXCIsdGhpcy5jb252ZXJzYXRpb25Hcm91cExpc3Q9dC5jb252ZXJzYXRpb25Hcm91cExpc3R8fFtdLHRoaXMuX2luaXRQcm9maWxlKHQpfXJldHVybiBhKGUsW3trZXk6XCJ0b0FjY291bnRcIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb252ZXJzYXRpb25JRC5zdGFydHNXaXRoKEUuQ09OVl9DMkMpP3RoaXMuY29udmVyc2F0aW9uSUQucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpOnRoaXMuY29udmVyc2F0aW9uSUQuc3RhcnRzV2l0aChFLkNPTlZfR1JPVVApP3RoaXMuY29udmVyc2F0aW9uSUQucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIik6XCJcIn19LHtrZXk6XCJzdWJUeXBlXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ3JvdXBQcm9maWxlP3RoaXMuZ3JvdXBQcm9maWxlLnR5cGU6XCJcIn19LHtrZXk6XCJfaW5pdFByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO09iamVjdC5rZXlzKGUpLmZvckVhY2goKGZ1bmN0aW9uKG4pe3N3aXRjaChuKXtjYXNlXCJ1c2VyUHJvZmlsZVwiOnQudXNlclByb2ZpbGU9ZS51c2VyUHJvZmlsZTticmVhaztjYXNlXCJncm91cFByb2ZpbGVcIjp0Lmdyb3VwUHJvZmlsZT1lLmdyb3VwUHJvZmlsZX19KSksaXQodGhpcy51c2VyUHJvZmlsZSkmJnRoaXMudHlwZT09PUUuQ09OVl9DMkM/dGhpcy51c2VyUHJvZmlsZT1uZXcgbGkoe3VzZXJJRDplLmNvbnZlcnNhdGlvbklELnJlcGxhY2UoXCJDMkNcIixcIlwiKX0pOml0KHRoaXMuZ3JvdXBQcm9maWxlKSYmdGhpcy50eXBlPT09RS5DT05WX0dST1VQJiYodGhpcy5ncm91cFByb2ZpbGU9bmV3IGhpKHtncm91cElEOmUuY29udmVyc2F0aW9uSUQucmVwbGFjZShcIkdST1VQXCIsXCJcIil9KSl9fSx7a2V5OlwidXBkYXRlVW5yZWFkQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLm5leHRVbnJlYWRDb3VudCxuPWUuaXNGcm9tR2V0Q29udmVyc2F0aW9ucyxvPWUuaXNVbnJlYWRDMkNNZXNzYWdlO2l0KHQpfHwoVHQodGhpcy5zdWJUeXBlKT90aGlzLnVucmVhZENvdW50PTA6biYmdGhpcy50eXBlPT09RS5DT05WX0dST1VQfHxuJiZ0aGlzLnR5cGU9PT1FLkNPTlZfVE9QSUN8fG8mJnRoaXMudHlwZT09PUUuQ09OVl9DMkM/dGhpcy51bnJlYWRDb3VudD10OnRoaXMudW5yZWFkQ291bnQ9dGhpcy51bnJlYWRDb3VudCt0KX19LHtrZXk6XCJ1cGRhdGVMYXN0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMubGFzdE1lc3NhZ2U9X2koZSl9fSx7a2V5OlwidXBkYXRlR3JvdXBBdEluZm9MaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoIXRoaXMuX2lzTmVlZE1lcmdlR3JvdXBBdEluZm8oZSkpe3ZhciB0LG49KE0odD1lLmdyb3VwQXRUeXBlKXx8eSh0KXx8SSh0KXx8VCgpKS5zbGljZSgwKTstMSE9PW4uaW5kZXhPZihFLkNPTlZfQVRfTUUpJiYtMSE9PW4uaW5kZXhPZihFLkNPTlZfQVRfQUxMKSYmKG49W0UuQ09OVl9BVF9BTExfQVRfTUVdKTt2YXIgbz17ZnJvbTplLmZyb20sZ3JvdXBJRDplLmdyb3VwSUQsdG9waWNJRDplLnRvcGljSUQsbWVzc2FnZVNlcXVlbmNlOmUuc2VxdWVuY2UsYXRUeXBlQXJyYXk6bixfX3JhbmRvbTplLl9fcmFuZG9tLF9fc2VxdWVuY2U6ZS5fX3NlcXVlbmNlfTt0aGlzLmdyb3VwQXRJbmZvTGlzdC5wdXNoKG8pfX19LHtrZXk6XCJfaXNOZWVkTWVyZ2VHcm91cEF0SW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ3JvdXBJRCxuPWUuc2VxdWVuY2U7aWYoIUR0KHtncm91cElEOnR9KSlyZXR1cm4hMTt2YXIgbz0hMTtyZXR1cm4gdGhpcy5ncm91cEF0SW5mb0xpc3QuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC5tZXNzYWdlU2VxdWVuY2U9PT1uJiYodC5hdFR5cGVBcnJheS5pbmRleE9mKEUuQ09OVl9BVF9NRSk+LTEmJmUuZ3JvdXBBdFR5cGUuaW5kZXhPZihFLkNPTlZfQVRfQUxMKT4tMSYmKHQuYXRUeXBlQXJyYXk9W0UuQ09OVl9BVF9BTExfQVRfTUVdKSx0LmF0VHlwZUFycmF5LmluZGV4T2YoRS5DT05WX0FUX0FMTCk+LTEmJmUuZ3JvdXBBdFR5cGUuaW5kZXhPZihFLkNPTlZfQVRfTUUpPi0xJiYodC5hdFR5cGVBcnJheT1bRS5DT05WX0FUX0FMTF9BVF9NRV0sdC5fX3JhbmRvbT1lLl9fcmFuZG9tLHQuX19zZXF1ZW5jZT1lLl9fc2VxdWVuY2UpLG89ITApfSkpLG99fSx7a2V5OlwiY2xlYXJHcm91cEF0SW5mb0xpc3RcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuZ3JvdXBBdEluZm9MaXN0Lmxlbmd0aD0wfX0se2tleTpcInJlZHVjZVVucmVhZENvdW50XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bnJlYWRDb3VudD49MSYmKHRoaXMudW5yZWFkQ291bnQtPTEsITApfX0se2tleTpcImlzTGFzdE1lc3NhZ2VSZXZva2VkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5zZXF1ZW5jZSxuPWUudGltZTtyZXR1cm4gdGhpcy50eXBlPT09RS5DT05WX0MyQyYmdD09PXRoaXMubGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlJiZuPT09dGhpcy5sYXN0TWVzc2FnZS5sYXN0VGltZXx8dGhpcy50eXBlPT09RS5DT05WX0dST1VQJiZ0PT09dGhpcy5sYXN0TWVzc2FnZS5sYXN0U2VxdWVuY2V9fSx7a2V5Olwic2V0TGFzdE1lc3NhZ2VSZXZva2VkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5sYXN0TWVzc2FnZS5pc1Jldm9rZWQ9ZX19LHtrZXk6XCJzZXRMYXN0TWVzc2FnZVJldm9rZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmxhc3RNZXNzYWdlLnJldm9rZXI9ZX19XSksZX0oKSx2aT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpLHRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZT10LHRoaXMuX249XCJNZXNzYWdlUmVtaW5kSGFuZGxlclwiLHRoaXMuX3VwZGF0ZVNlcXVlbmNlPTB9cmV0dXJuIGEoZSxbe2tleTpcImdldEMyQ01lc3NhZ2VSZW1pbmRUeXBlXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRDMkNNZXNzYWdlUmVtaW5kVHlwZVwiKTtyZXR1cm4gdGhpcy5fY29udmVyc2F0aW9uTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpFbyx1cGRhdGVTZXF1ZW5jZTp0aGlzLl91cGRhdGVTZXF1ZW5jZX0pLnRoZW4oKGZ1bmN0aW9uKG4pe1ZlLmwoXCJcIi5jb25jYXQodCxcIiBva1wiKSk7dmFyIG89bi5kYXRhLHM9by51cGRhdGVTZXF1ZW5jZSxhPW8ubXV0ZUZsYWdMaXN0O2UuX3VwZGF0ZVNlcXVlbmNlPXMsZS5fcGF0Y2hDMkNNZXNzYWdlUmVtaW5kVHlwZShhKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7VmUuZShcIlwiLmNvbmNhdCh0LFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpfSkpfX0se2tleTpcIl9wYXRjaEMyQ01lc3NhZ2VSZW1pbmRUeXBlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPTAsbz1cIlwiO2F0KGUpJiZlLmxlbmd0aD4wJiZlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBzPWUudXNlcklELGE9ZS5tdXRlRmxhZzswPT09YT9vPUUuTVNHX1JFTUlORF9BQ1BUX0FORF9OT1RFOjE9PT1hP289RS5NU0dfUkVNSU5EX0RJU0NBUkQ6Mj09PWEmJihvPUUuTVNHX1JFTUlORF9BQ1BUX05PVF9OT1RFKSwhMD09PXQuX2NvbnZlcnNhdGlvbk1vZHVsZS5wYXRjaE1lc3NhZ2VSZW1pbmRUeXBlKHtJRDpzLGlzQzJDQ29udmVyc2F0aW9uOiEwLG1lc3NhZ2VSZW1pbmRUeXBlOm99KSYmKG4rPTEpfSkpLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fcGF0Y2hDMkNNZXNzYWdlUmVtaW5kVHlwZSBjb3VudDpcIikuY29uY2F0KG4pKX19LHtrZXk6XCJzZXRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5ncm91cElEP3RoaXMuX3NldEdyb3VwTWVzc2FnZVJlbWluZFR5cGUoZSk6YXQoZS51c2VySURMaXN0KT90aGlzLl9zZXRDMkNNZXNzYWdlUmVtaW5kVHlwZShlKTp2b2lkIDB9fSx7a2V5OlwiX3NldEdyb3VwTWVzc2FnZVJlbWluZFR5cGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5fc2V0R3JvdXBNZXNzYWdlUmVtaW5kVHlwZVwiKSxvPWUuZ3JvdXBJRCxzPWUubWVzc2FnZVJlbWluZFR5cGUsYT1cImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgbWVzc2FnZVJlbWluZFR5cGU6XCIpLmNvbmNhdChzKSxpPW5ldyBBYShcInNldE1lc3NhZ2VSZW1pbmRUeXBlXCIpO3JldHVybiBpLnNldE1lc3NhZ2UoYSksdGhpcy5fZ2V0TW9kdWxlKHduKS5tb2RpZnlHcm91cE1lbWJlckluZm8oe2dyb3VwSUQ6byxtZXNzYWdlUmVtaW5kVHlwZTpzLHVzZXJJRDp0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZ2V0TXlVc2VySUQoKX0pLnRoZW4oKGZ1bmN0aW9uKCl7aS5zZXROZXR3b3JrVHlwZSh0Ll9jb252ZXJzYXRpb25Nb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rLiBcIikuY29uY2F0KGEpKTt2YXIgbz10Lm9uR3JvdXBNZXNzYWdlUmVtaW5kVHlwZVVwZGF0ZWQoZSk7cmV0dXJuIHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5lbWl0VG90YWxVbnJlYWRNZXNzYWdlQ291bnRVcGRhdGUoKSxZYShvKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5Olwib25Hcm91cE1lc3NhZ2VSZW1pbmRUeXBlVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ3JvdXBJRCxuPWUubWVzc2FnZVJlbWluZFR5cGUsbz10aGlzLl9nZXRNb2R1bGUoUG4pLmdldExvY2FsR3JvdXBQcm9maWxlKHQpO2lmKG8mJihvLnNlbGZJbmZvLm1lc3NhZ2VSZW1pbmRUeXBlPW4pLGt0KHQpKXt2YXIgcz10LGE9eHQocyksaT10aGlzLl9nZXRNb2R1bGUoRm4pLmdldExvY2FsVG9waWMoYSxzKTtyZXR1cm4gaSYmKGkudXBkYXRlU2VsZkluZm8oe21lc3NhZ2VSZW1pbmRUeXBlOm59KSx0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZW1pdE91dGVyRXZlbnQoay5UT1BJQ19VUERBVEVELHtncm91cElEOmEsdG9waWM6aX0pKSx7dG9waWM6aX19cmV0dXJuIHRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5wYXRjaE1lc3NhZ2VSZW1pbmRUeXBlKHtJRDp0LGlzQzJDQ29udmVyc2F0aW9uOiExLG1lc3NhZ2VSZW1pbmRUeXBlOm59KSYmdGhpcy5fZW1pdENvbnZlcnNhdGlvblVwZGF0ZSgpLHtncm91cDpvfX19LHtrZXk6XCJfc2V0QzJDTWVzc2FnZVJlbWluZFR5cGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5fc2V0QzJDTWVzc2FnZVJlbWluZFR5cGVcIiksbz1lLnVzZXJJRExpc3Qscz1lLm1lc3NhZ2VSZW1pbmRUeXBlLGE9by5zbGljZSgwLDMwKSxpPTA7cz09PUUuTVNHX1JFTUlORF9ESVNDQVJEP2k9MTpzPT09RS5NU0dfUkVNSU5EX0FDUFRfTk9UX05PVEUmJihpPTIpO3ZhciByPVwidXNlcklETGlzdDpcIi5jb25jYXQoYSxcIiBtZXNzYWdlUmVtaW5kVHlwZTpcIikuY29uY2F0KHMpLHU9bmV3IEFhKFwic2V0TWVzc2FnZVJlbWluZFR5cGVcIik7cmV0dXJuIHUuc2V0TWVzc2FnZShyKSx0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmtvLHJlcXVlc3REYXRhOnt1c2VySURMaXN0OmEsbXV0ZUZsYWc6aX19KS50aGVuKChmdW5jdGlvbihlKXt1LnNldE5ldHdvcmtUeXBlKHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKTt2YXIgbz1lLmRhdGEsaT1vLnVwZGF0ZVNlcXVlbmNlLHI9by5lcnJvckxpc3Q7dC5fdXBkYXRlU2VxdWVuY2U9aTt2YXIgYz1bXSxsPVtdO2F0KHIpJiZyLmZvckVhY2goKGZ1bmN0aW9uKGUpe2MucHVzaChlLnVzZXJJRCksbC5wdXNoKHt1c2VySUQ6ZS51c2VySUQsY29kZTplLmVycm9yQ29kZX0pfSkpO3ZhciBkPWEuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4tMT09PWMuaW5kZXhPZihlKX0pKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIHN1Y2Nlc3NVc2VySURMaXN0OlwiKS5jb25jYXQoZCxcIiBmYWlsdXJlVXNlcklETGlzdDpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KGwpKSk7dmFyIHA9MDtyZXR1cm4gZC5mb3JFYWNoKChmdW5jdGlvbihlKXt0Ll9jb252ZXJzYXRpb25Nb2R1bGUucGF0Y2hNZXNzYWdlUmVtaW5kVHlwZSh7SUQ6ZSxpc0MyQ0NvbnZlcnNhdGlvbjohMCxtZXNzYWdlUmVtaW5kVHlwZTpzfSkmJihwKz0xKX0pKSxwPj0xJiZ0Ll9lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCksYS5sZW5ndGg9Yy5sZW5ndGg9MCx0Ll9jb252ZXJzYXRpb25Nb2R1bGUuZW1pdFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50VXBkYXRlKCksWGEoe3N1Y2Nlc3NVc2VySURMaXN0OmQubWFwKChmdW5jdGlvbihlKXtyZXR1cm57dXNlcklEOmV9fSkpLGZhaWx1cmVVc2VySURMaXN0Omx9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTt1LnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiX2dldE1vZHVsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZ2V0TW9kdWxlKGUpfX0se2tleTpcIl9lbWl0Q29udmVyc2F0aW9uVXBkYXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSl9fSx7a2V5Olwic2V0VXBkYXRlU2VxdWVuY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl91cGRhdGVTZXF1ZW5jZT1lfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX3VwZGF0ZVNlcXVlbmNlPTB9fV0pLGV9KCksbWk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGU9dCx0aGlzLl9uPVwiQ29udkdyb3VwSGFuZGxlclwiLHRoaXMuX2NvbnZHcm91cE1hcD1uZXcgTWFwLHRoaXMuX3N0YXJ0SW5kZXg9MCx0aGlzLl9wYWdpbmdTdGF0dXM9JHQuTk9UX1NUQVJUfXJldHVybiBhKGUsW3trZXk6XCJzZXRDb252Q3VzdG9tRGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJzZXRDb252Q3VzdG9tRGF0YVwiKSxvPWUuY29udmVyc2F0aW9uSURMaXN0LHM9ZS5jdXN0b21EYXRhO1ZlLmwoXCJcIi5jb25jYXQobixcIiBvcHRpb25zOlwiKSxlKTt2YXIgYT1uZXcgQWEoXCJzZXRDb252Q3VzdG9tRGF0YVwiKTthLnNldE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoZSkpO3ZhciBpPXtmcm9tQWNjb3VudDp0aGlzLl9nZXRNeVVzZXJJRCgpLGl0ZW1MaXN0OltdfSxyPVtdLHU9W107cmV0dXJuIG8uZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYoIXQuX2hhc0xvY2FsQ29udmVyc2F0aW9uKGUpKXJldHVybiB0Ll9vbkNvbnZlcnNhdGlvbk5vdEZvdW5kKHUsZSksITA7aWYoIUV0KGUpJiYhU3QoZSkpcmV0dXJuIHQuX29uQ29udmVyc2F0aW9uSURJbnZhbGlkKHUsZSksITA7dmFyIG49e29wZXJhdGlvblR5cGU6Mixjb250YWN0SXRlbTp2b2lkIDAsY3VzdG9tTWFyazpzfTtFdChlKT9uLmNvbnRhY3RJdGVtPXt0eXBlOjEsdG9BY2NvdW50OmUucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpfTpTdChlKSYmKG4uY29udGFjdEl0ZW09e3R5cGU6Mixncm91cElEOmUucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIil9KSxpLml0ZW1MaXN0LnB1c2gobil9KSksdS5sZW5ndGg9PT1vLmxlbmd0aD9YYSh7c3VjY2Vzc0NvbnZlcnNhdGlvbklETGlzdDpyLGZhaWx1cmVDb252ZXJzYXRpb25JRExpc3Q6dX0pOnRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6cW8scmVxdWVzdERhdGE6aX0pLnRoZW4oKGZ1bmN0aW9uKGUpe2Euc2V0TmV0d29ya1R5cGUodC5fY29udmVyc2F0aW9uTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBva1wiKSk7dmFyIG89ZS5kYXRhLnJlc3VsdEl0ZW07aWYoYXQobykpe3ZhciBpLGMsbD0hMTtvLmZvckVhY2goKGZ1bmN0aW9uKGUpe2k9dC5fY29uY2F0Q29udmVyc2F0aW9uSUQoZS5jb250YWN0SXRlbSksMD09PWUucmVzdWx0Q29kZT8oci5wdXNoKGkpLChjPXQuX2dldExvY2FsQ29udmVyc2F0aW9uKGkpKSYmYy5jdXN0b21EYXRhIT09cyYmKGMuY3VzdG9tRGF0YT1zLGw9ITApKTp1LnB1c2goe2NvbnZlcnNhdGlvbklEOmksY29kZTplLnJlc3VsdENvZGUsbWVzc2FnZTplLnJlc3VsdEluZm99KX0pKSwhMD09PWwmJnQuX2VtaXRDb252ZXJzYXRpb25VcGRhdGUoKX1yZXR1cm4gWWEoe3N1Y2Nlc3NDb252ZXJzYXRpb25JRExpc3Q6cixmYWlsdXJlQ29udmVyc2F0aW9uSURMaXN0OnV9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTthLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwibWFya0NvbnZlcnNhdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoIXRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5jYW5JVXNlKEIuQ09OVl9NQVJLKSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX1VTRV9DT01NRVJDSUFMX0FCSUxJVFl9KTt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJtYXJrQ29udmVyc2F0aW9uXCIpLG89ZS5jb252ZXJzYXRpb25JRExpc3Qscz1lLm1hcmtUeXBlLGE9ZS5lbmFibGVNYXJrO1ZlLmwoXCJcIi5jb25jYXQobixcIiBvcHRpb25zOlwiKSxlKTt2YXIgaT1uZXcgQWEoXCJtYXJrQ29udmVyc2F0aW9uXCIpO2kuc2V0TWVzc2FnZShKU09OLnN0cmluZ2lmeShlKSk7dmFyIHI9dm9pZCAwLHU9dm9pZCAwLGM9dGhpcy5fZ2V0RmxhZ0JpdChzKTshMD09PWE/dT1bY106cj1bY107dmFyIGw9e2Zyb21BY2NvdW50OnRoaXMuX2dldE15VXNlcklEKCksaXRlbUxpc3Q6W119LGQ9W10scD1bXTtyZXR1cm4gby5mb3JFYWNoKChmdW5jdGlvbihlKXtpZighdC5faGFzTG9jYWxDb252ZXJzYXRpb24oZSkpcmV0dXJuIHQuX29uQ29udmVyc2F0aW9uTm90Rm91bmQocCxlKSwhMDtpZighRXQoZSkmJiFTdChlKSlyZXR1cm4gdC5fb25Db252ZXJzYXRpb25JREludmFsaWQocCxlKSwhMDt2YXIgbj17b3BlcmF0aW9uVHlwZToxLGNvbnRhY3RJdGVtOnZvaWQgMCxjbGVhck1hcms6cixzZXRNYXJrOnV9O0V0KGUpP24uY29udGFjdEl0ZW09e3R5cGU6MSx0b0FjY291bnQ6ZS5yZXBsYWNlKEUuQ09OVl9DMkMsXCJcIil9OlN0KGUpJiYobi5jb250YWN0SXRlbT17dHlwZToyLGdyb3VwSUQ6ZS5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKX0pLGwuaXRlbUxpc3QucHVzaChuKX0pKSxwLmxlbmd0aD09PW8ubGVuZ3RoP1hhKHtzdWNjZXNzQ29udmVyc2F0aW9uSURMaXN0OmQsZmFpbHVyZUNvbnZlcnNhdGlvbklETGlzdDpwfSk6dGhpcy5fY29udmVyc2F0aW9uTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp4byxyZXF1ZXN0RGF0YTpsfSkudGhlbigoZnVuY3Rpb24oZSl7aS5zZXROZXR3b3JrVHlwZSh0Ll9jb252ZXJzYXRpb25Nb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKTt2YXIgbz1lLmRhdGEucmVzdWx0SXRlbTtpZihhdChvKSl7dmFyIHIsdSxjPSExO28uZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYocj10Ll9jb25jYXRDb252ZXJzYXRpb25JRChlLmNvbnRhY3RJdGVtKSwwPT09ZS5yZXN1bHRDb2RlKXtpZihkLnB1c2gociksdT10Ll9nZXRMb2NhbENvbnZlcnNhdGlvbihyKSl7dmFyIG49dS5tYXJrTGlzdC5pbmRleE9mKHMpOyEwPT09YT8tMT09PW4mJih1Lm1hcmtMaXN0LnB1c2gocyksYz0hMCk6LTEhPT1uJiYodS5tYXJrTGlzdC5zcGxpY2UobiwxKSxjPSEwKX19ZWxzZSBwLnB1c2goe2NvbnZlcnNhdGlvbklEOnIsY29kZTplLnJlc3VsdENvZGUsbWVzc2FnZTplLnJlc3VsdEluZm99KX0pKSwhMD09PWMmJnQuX2VtaXRDb252ZXJzYXRpb25VcGRhdGUoKX1yZXR1cm4gWWEoe3N1Y2Nlc3NDb252ZXJzYXRpb25JRExpc3Q6ZCxmYWlsdXJlQ29udmVyc2F0aW9uSURMaXN0OnB9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiZ2V0TG9jYWxDb252R3JvdXBMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuZ2V0TG9jYWxDb252R3JvdXBMaXN0IHBhZ2luZ1N0YXR1czpcIikuY29uY2F0KHRoaXMuX3BhZ2luZ1N0YXR1cykpLHRoaXMuX3BhZ2luZ1N0YXR1cz09PSR0LlJFSkVDVEVEP3RoaXMuZ2V0UmVtb3RlQ29udkdyb3VwTGlzdCgpLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIFlhKG0oZS5fY29udkdyb3VwTWFwLnZhbHVlcygpKSl9KSk6WGEobSh0aGlzLl9jb252R3JvdXBNYXAudmFsdWVzKCkpKX19LHtrZXk6XCJnZXRSZW1vdGVDb252R3JvdXBMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRSZW1vdGVDb252R3JvdXBMaXN0XCIpO3JldHVybiB0aGlzLl9wYWdpbmdTdGF0dXM9JHQuUEVORElORyx0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOllvLHJlcXVlc3REYXRhOntmcm9tQWNjb3VudDp0aGlzLl9nZXRNeVVzZXJJRCgpLHN0YXJ0SW5kZXg6dGhpcy5fc3RhcnRJbmRleCxzdGFydFRpbWU6d2UoKX19KS50aGVuKChmdW5jdGlvbihuKXt2YXIgbyxzLGE9bi5kYXRhLGk9YS5jb21wbGV0ZUZsYWcscj1hLmNvbnRhY3RJdGVtLHU9YS5uZXh0U3RhcnRJbmRleCxjPXZvaWQgMD09PXU/MDp1LGw9YS5ncm91cEl0ZW07KGUuX3N0YXJ0SW5kZXg9YyxWZS5sKFwiXCIuY29uY2F0KHQsXCIgY29tcGxldGVGbGFnOlwiKS5jb25jYXQoaSxcIiBuZXh0U3RhcnRJbmRleDpcIikuY29uY2F0KGMpKSxhdChsKSYmbC5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgbj10LmNvbnZHcm91cElELG89dC5ncm91cE5hbWU7ZS5fY29udkdyb3VwTWFwLnNldChuLG8pfSkpLGF0KHIpKSYmci5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgbj10LnN0YW5kYXJkTWFyayxhPXQuY3VzdG9tRGF0YSxpPXQuY29udkdyb3VwSURMaXN0O2lmKG89ZS5fY29uY2F0Q29udmVyc2F0aW9uSUQodCksKHM9ZS5fZ2V0TG9jYWxDb252ZXJzYXRpb24obykpJiYocy5tYXJrTGlzdD1IdChuKSxzLmN1c3RvbURhdGE9YXx8XCJcIixhdChpKSkpe3ZhciByPVtdO2kuZm9yRWFjaCgoZnVuY3Rpb24odCl7ZS5fY29udkdyb3VwTWFwLmhhcyh0KSYmci5wdXNoKGUuX2NvbnZHcm91cE1hcC5nZXQodCkpfSkpLHMuY29udmVyc2F0aW9uR3JvdXBMaXN0PVtdLmNvbmNhdChyKSxyLmxlbmd0aD0wfX0pKTtpZigwPT09aSlyZXR1cm4gZS5nZXRSZW1vdGVDb252R3JvdXBMaXN0KCk7MT09PWkmJihlLl9wYWdpbmdTdGF0dXM9JHQuUkVTT0xWRUQsZS5fZW1pdENvbnZlcnNhdGlvblVwZGF0ZSgpLGUuX2VtaXRDb252R3JvdXBMaXN0VXBkYXRlKCkpfSkpLmNhdGNoKChmdW5jdGlvbihuKXtlLl9wYWdpbmdTdGF0dXM9JHQuUkVKRUNURUQsVmUudyhcIlwiLmNvbmNhdCh0LFwiIGZhaWxlZC4gZXJyb3I6XCIpLG4pfSkpfX0se2tleTpcImNyZWF0ZUNvbnZHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoIXRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5jYW5JVXNlKEIuQ09OVl9HUk9VUCkpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7dmFyIG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiY3JlYXRlQ29udkdyb3VwXCIpO1ZlLmwoXCJcIi5jb25jYXQobixcIiBvcHRpb25zOlwiKSxlKTt2YXIgbz1uZXcgQWEoXCJjcmVhdGVDb252R3JvdXBcIik7by5zZXRNZXNzYWdlKEpTT04uc3RyaW5naWZ5KGUpKTt2YXIgcz1lLmdyb3VwTmFtZSxhPWUuY29udmVyc2F0aW9uSURMaXN0LGk9e2Zyb21BY2NvdW50OnRoaXMuX2dldE15VXNlcklEKCksaXRlbUxpc3Q6W3tncm91cE5hbWU6cyxjb250YWN0SXRlbTpbXX1dfSxyPVtdLHU9W107cmV0dXJuIGEuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2hhc0xvY2FsQ29udmVyc2F0aW9uKGUpP0V0KGUpfHxTdChlKT92b2lkKEV0KGUpP2kuaXRlbUxpc3RbMF0uY29udGFjdEl0ZW0ucHVzaCh7dHlwZToxLHRvQWNjb3VudDplLnJlcGxhY2UoRS5DT05WX0MyQyxcIlwiKX0pOlN0KGUpJiZpLml0ZW1MaXN0WzBdLmNvbnRhY3RJdGVtLnB1c2goe3R5cGU6Mixncm91cElEOmUucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIil9KSk6KHQuX29uQ29udmVyc2F0aW9uSURJbnZhbGlkKHUsZSksITApOih0Ll9vbkNvbnZlcnNhdGlvbk5vdEZvdW5kKHUsZSksITApfSkpLHUubGVuZ3RoPT09YS5sZW5ndGg/WGEoe3N1Y2Nlc3NDb252ZXJzYXRpb25JRExpc3Q6cixmYWlsdXJlQ29udmVyc2F0aW9uSURMaXN0OnV9KTp0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOlZvLHJlcXVlc3REYXRhOml9KS50aGVuKChmdW5jdGlvbihlKXtvLnNldE5ldHdvcmtUeXBlKHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpO3ZhciBhPWUuZGF0YS5ncm91cFJlc3VsdEl0ZW1bMF0saT1hLmdyb3VwSXRlbSxjPWEucmVzdWx0SXRlbTtpZihzdChpKSYmKHQuX2NvbnZHcm91cE1hcC5zZXQoaS5jb252R3JvdXBJRCxpLmdyb3VwTmFtZSksdC5fZW1pdENvbnZHcm91cExpc3RVcGRhdGUoKSksYXQoYykpe3ZhciBsLGQscD0hMTtjLmZvckVhY2goKGZ1bmN0aW9uKGUpe2w9dC5fY29uY2F0Q29udmVyc2F0aW9uSUQoZS5jb250YWN0SXRlbSksMD09PWUucmVzdWx0Q29kZT8oci5wdXNoKGwpLChkPXQuX2dldExvY2FsQ29udmVyc2F0aW9uKGwpKSYmLTE9PT1kLmNvbnZlcnNhdGlvbkdyb3VwTGlzdC5pbmRleE9mKHMpJiYoZC5jb252ZXJzYXRpb25Hcm91cExpc3QucHVzaChzKSxwPSEwKSk6dS5wdXNoKHtjb252ZXJzYXRpb25JRDpsLGNvZGU6ZS5yZXN1bHRDb2RlLG1lc3NhZ2U6ZS5yZXN1bHRJbmZvfSl9KSksITA9PT1wJiYodC5fZW1pdENvbnZlcnNhdGlvblVwZGF0ZSgpLHQuX2VtaXRDb252R3JvdXBMaXN0VXBkYXRlKCkpfXJldHVybiBZYSh7c3VjY2Vzc0NvbnZlcnNhdGlvbklETGlzdDpyLGZhaWx1cmVDb252ZXJzYXRpb25JRExpc3Q6dX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fY29udmVyc2F0aW9uTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0sYT1uWzFdO28uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJkZWxldGVDb252R3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuY2FuSVVzZShCLkNPTlZfR1JPVVApKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWX0pO3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImRlbGV0ZUNvbnZHcm91cFwiKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgZ3JvdXBOYW1lOlwiKS5jb25jYXQoZSkpO3ZhciBvPW5ldyBBYShcImRlbGV0ZUNvbnZHcm91cFwiKTtyZXR1cm4gby5zZXRNZXNzYWdlKGUpLHRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6Qm8scmVxdWVzdERhdGE6e2Zyb21BY2NvdW50OnRoaXMuX2dldE15VXNlcklEKCksZ3JvdXBOYW1lOltlXX19KS50aGVuKChmdW5jdGlvbihzKXtvLnNldE5ldHdvcmtUeXBlKHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpO3ZhciBhPXMuZGF0YS5ncm91cEl0ZW07aWYoYXQoYSkpe3ZhciBpPSExO2EuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dC5fY29udkdyb3VwTWFwLmhhcyhlLmNvbnZHcm91cElEKSYmKHQuX2NvbnZHcm91cE1hcC5kZWxldGUoZS5jb252R3JvdXBJRCksaT0hMCl9KSksITA9PT1pJiZ0Ll9lbWl0Q29udkdyb3VwTGlzdFVwZGF0ZSgpfXQuX2VyYXNlRnJvbUNvbnZlcnNhdGlvbkdyb3VwTGlzdChbZV0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fY29udmVyc2F0aW9uTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0sYT1uWzFdO28uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJyZW5hbWVDb252R3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuY2FuSVVzZShCLkNPTlZfR1JPVVApKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWX0pO3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInJlbmFtZUNvbnZHcm91cFwiKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgb3B0aW9uczpcIiksZSk7dmFyIG89bmV3IEFhKFwicmVuYW1lQ29udkdyb3VwXCIpO28uc2V0TWVzc2FnZShKU09OLnN0cmluZ2lmeShlKSk7dmFyIHM9ZS5vbGROYW1lLGE9ZS5uZXdOYW1lO3JldHVybiB0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkhvLHJlcXVlc3REYXRhOntmcm9tQWNjb3VudDp0aGlzLl9nZXRNeVVzZXJJRCgpLHVwZGF0ZVR5cGU6MSx1cGRhdGVHcm91cDp7dXBkYXRlR3JvdXBUeXBlOjEsb2xkTmFtZTpzLG5ld05hbWU6YX19fSkudGhlbigoZnVuY3Rpb24oZSl7by5zZXROZXR3b3JrVHlwZSh0Ll9jb252ZXJzYXRpb25Nb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKTt2YXIgaT1lLmRhdGEudXBkYXRlR3JvdXBSZXN1bHQuY29udkdyb3VwSUQ7dC5fY29udkdyb3VwTWFwLnNldChpLGEpLHQuX2VtaXRDb252R3JvdXBMaXN0VXBkYXRlKCk7dmFyIHIsdSxjPXQuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKSxsPSExO2MuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cj1lLmNvbnZlcnNhdGlvbkdyb3VwTGlzdCwtMSE9PSh1PXIuaW5kZXhPZihzKSkmJihyLnNwbGljZSh1LDEsYSksbD0hMCl9KSksITA9PT1sJiZ0Ll9lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9jb252ZXJzYXRpb25Nb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLHM9blswXSxhPW5bMV07by5zZXRFcnJvcihlLHMsYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImFkZENvbnZzVG9Hcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoIXRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5jYW5JVXNlKEIuQ09OVl9HUk9VUCkpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7dmFyIG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiYWRkQ29udnNUb0dyb3VwXCIpO1ZlLmwoXCJcIi5jb25jYXQobixcIiBvcHRpb25zOlwiKSxlKTt2YXIgbz1uZXcgQWEoXCJhZGRDb252c1RvR3JvdXBcIik7by5zZXRNZXNzYWdlKEpTT04uc3RyaW5naWZ5KGUpKTt2YXIgcz1lLmNvbnZlcnNhdGlvbklETGlzdCxhPWUuZ3JvdXBOYW1lLGk9e2Zyb21BY2NvdW50OnRoaXMuX2dldE15VXNlcklEKCksdXBkYXRlVHlwZToxLHVwZGF0ZUdyb3VwOnt1cGRhdGVHcm91cFR5cGU6Mixncm91cE5hbWU6YSx1cGRhdGVJdGVtOltdfX0scj1bXSx1PVtdO3JldHVybiBzLmZvckVhY2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9oYXNMb2NhbENvbnZlcnNhdGlvbihlKT9FdChlKXx8U3QoZSk/dm9pZChFdChlKT9pLnVwZGF0ZUdyb3VwLnVwZGF0ZUl0ZW0ucHVzaCh7b3BlcmF0aW9uVHlwZToxLGNvbnRhY3RJdGVtOnt0eXBlOjEsdG9BY2NvdW50OmUucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpfX0pOlN0KGUpJiZpLnVwZGF0ZUdyb3VwLnVwZGF0ZUl0ZW0ucHVzaCh7b3BlcmF0aW9uVHlwZToxLGNvbnRhY3RJdGVtOnt0eXBlOjIsZ3JvdXBJRDplLnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpfX0pKToodC5fb25Db252ZXJzYXRpb25JREludmFsaWQodSxlKSwhMCk6KHQuX29uQ29udmVyc2F0aW9uTm90Rm91bmQodSxlKSwhMCl9KSksdS5sZW5ndGg9PT1zLmxlbmd0aD9YYSh7c3VjY2Vzc0NvbnZlcnNhdGlvbklETGlzdDpyLGZhaWx1cmVDb252ZXJzYXRpb25JRExpc3Q6dX0pOnRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6S28scmVxdWVzdERhdGE6aX0pLnRoZW4oKGZ1bmN0aW9uKGUpe28uc2V0TmV0d29ya1R5cGUodC5fY29udmVyc2F0aW9uTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBva1wiKSk7dmFyIHM9ZS5kYXRhLnVwZGF0ZUdyb3VwUmVzdWx0LmNvbnRhY3RSZXN1bHRJdGVtO2lmKGF0KHMpKXt2YXIgaSxjLGw9ITE7cy5mb3JFYWNoKChmdW5jdGlvbihlKXtpPXQuX2NvbmNhdENvbnZlcnNhdGlvbklEKGUuY29udGFjdEl0ZW0pLDA9PT1lLnJlc3VsdENvZGU/KGM9dC5fZ2V0TG9jYWxDb252ZXJzYXRpb24oaSkpJiYtMT09PWMuY29udmVyc2F0aW9uR3JvdXBMaXN0LmluZGV4T2YoYSkmJihjLmNvbnZlcnNhdGlvbkdyb3VwTGlzdC5wdXNoKGEpLHIucHVzaChpKSxsPSEwKTp1LnB1c2goe2NvbnZlcnNhdGlvbklEOmksY29kZTplLnJlc3VsdENvZGUsbWVzc2FnZTplLnJlc3VsdEluZm99KX0pKSwhMD09PWwmJih0Ll9lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCksdC5fZW1pdENvbnZJbkdyb3VwVXBkYXRlKGEpKX1yZXR1cm4gWWEoe3N1Y2Nlc3NDb252ZXJzYXRpb25JRExpc3Q6cixmYWlsdXJlQ29udmVyc2F0aW9uSURMaXN0OnV9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2NvbnZlcnNhdGlvbk1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMikscz1uWzBdLGE9blsxXTtvLnNldEVycm9yKGUscyxhKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiZGVsZXRlQ29udnNGcm9tR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuY2FuSVVzZShCLkNPTlZfR1JPVVApKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWX0pO3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImRlbGV0ZUNvbnZzRnJvbUdyb3VwXCIpO1ZlLmwoXCJcIi5jb25jYXQobixcIiBvcHRpb25zOlwiKSxlKTt2YXIgbz1uZXcgQWEoXCJkZWxldGVDb252c0Zyb21Hcm91cFwiKTtvLnNldE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoZSkpO3ZhciBzPWUuY29udmVyc2F0aW9uSURMaXN0LGE9ZS5ncm91cE5hbWUsaT17ZnJvbUFjY291bnQ6dGhpcy5fZ2V0TXlVc2VySUQoKSx1cGRhdGVUeXBlOjEsdXBkYXRlR3JvdXA6e3VwZGF0ZUdyb3VwVHlwZToyLGdyb3VwTmFtZTphLHVwZGF0ZUl0ZW06W119fSxyPVtdLHU9W107cmV0dXJuIHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2hhc0xvY2FsQ29udmVyc2F0aW9uKGUpP0V0KGUpfHxTdChlKT92b2lkKEV0KGUpP2kudXBkYXRlR3JvdXAudXBkYXRlSXRlbS5wdXNoKHtvcGVyYXRpb25UeXBlOjIsY29udGFjdEl0ZW06e3R5cGU6MSx0b0FjY291bnQ6ZS5yZXBsYWNlKEUuQ09OVl9DMkMsXCJcIil9fSk6U3QoZSkmJmkudXBkYXRlR3JvdXAudXBkYXRlSXRlbS5wdXNoKHtvcGVyYXRpb25UeXBlOjIsY29udGFjdEl0ZW06e3R5cGU6Mixncm91cElEOmUucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIil9fSkpOih0Ll9vbkNvbnZlcnNhdGlvbklESW52YWxpZCh1LGUpLCEwKToodC5fb25Db252ZXJzYXRpb25Ob3RGb3VuZCh1LGUpLCEwKX0pKSx1Lmxlbmd0aD09PXMubGVuZ3RoP1hhKHtzdWNjZXNzQ29udmVyc2F0aW9uSURMaXN0OnIsZmFpbHVyZUNvbnZlcnNhdGlvbklETGlzdDp1fSk6dGhpcy5fY29udmVyc2F0aW9uTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpXbyxyZXF1ZXN0RGF0YTppfSkudGhlbigoZnVuY3Rpb24oZSl7by5zZXROZXR3b3JrVHlwZSh0Ll9jb252ZXJzYXRpb25Nb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKTt2YXIgcz1lLmRhdGEudXBkYXRlR3JvdXBSZXN1bHQuY29udGFjdFJlc3VsdEl0ZW07aWYoYXQocykpe3ZhciBpLGMsbD0hMTtzLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKGk9dC5fY29uY2F0Q29udmVyc2F0aW9uSUQoZS5jb250YWN0SXRlbSksMD09PWUucmVzdWx0Q29kZSl7aWYoYz10Ll9nZXRMb2NhbENvbnZlcnNhdGlvbihpKSl7dmFyIG49Yy5jb252ZXJzYXRpb25Hcm91cExpc3QuaW5kZXhPZihhKTstMSE9PW4mJihjLmNvbnZlcnNhdGlvbkdyb3VwTGlzdC5zcGxpY2UobiwxKSxyLnB1c2goaSksbD0hMCl9fWVsc2UgdS5wdXNoKHtjb252ZXJzYXRpb25JRDppLGNvZGU6ZS5yZXN1bHRDb2RlLG1lc3NhZ2U6ZS5yZXN1bHRJbmZvfSl9KSksITA9PT1sJiYodC5fZW1pdENvbnZlcnNhdGlvblVwZGF0ZSgpLHQuX2VtaXRDb252SW5Hcm91cFVwZGF0ZShhKSl9cmV0dXJuIFlhKHtzdWNjZXNzQ29udmVyc2F0aW9uSURMaXN0OnIsZmFpbHVyZUNvbnZlcnNhdGlvbklETGlzdDp1fSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9jb252ZXJzYXRpb25Nb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLHM9blswXSxhPW5bMV07by5zZXRFcnJvcihlLHMsYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcIm9uQ29udk1hcmtVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighenQoZSkpe3ZhciBuLG87VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQ29udk1hcmtVcGRhdGVkIG1hcmtJdGVtTGlzdDpcIiksZSk7dmFyIHM9ITE7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgYT1lLnJlY2VudENvbnRhY3RJdGVtLGk9ZS5vcHRUeXBlLHI9ZS5zdGFuZGFyZE1hcmssdT1lLmN1c3RvbU1hcms7aWYobj10Ll9jb25jYXRDb252ZXJzYXRpb25JRChhKSxvPXQuX2dldExvY2FsQ29udmVyc2F0aW9uKG4pKWlmKDE9PT1pKXt2YXIgYz1IdChyKTshMCE9PWZ1bmN0aW9uKGUsdCl7aWYoZT09PXQpcmV0dXJuITA7aWYoIWV8fCF0KXJldHVybiExO2lmKGUubGVuZ3RoIT09dC5sZW5ndGgpcmV0dXJuITE7Zm9yKHZhciBuPTAsbz1lLmxlbmd0aDtuPG87bisrKWlmKGVbbl0hPT10W25dKXJldHVybiExO3JldHVybiEwfShvLm1hcmtMaXN0LGMpJiYoby5tYXJrTGlzdD1jLHM9ITApfWVsc2UgMj09PWkmJm8uY3VzdG9tRGF0YSE9PXUmJnZvaWQgMCE9PXUmJihvLmN1c3RvbURhdGE9dSxzPSEwKX0pKSwhMD09PXMmJnRoaXMuX2VtaXRDb252ZXJzYXRpb25VcGRhdGUoKX19fSx7a2V5Olwib25Db252R3JvdXBDcmVhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25Db252R3JvdXBDcmVhdGVkIHJlc3VsdExpc3Q6XCIpLGUpO3ZhciBuPSExLG89ITE7YXQoZSkmJihlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBzPWUubXNnR3JvdXBJdGVtLGE9cy5ncm91cElELGk9cy5ncm91cE5hbWU7dC5fY29udkdyb3VwTWFwLmdldChhKSE9PWkmJih0Ll9jb252R3JvdXBNYXAuc2V0KGEsaSksbz0hMCk7dmFyIHIsdSxjPWUubXNnUmVjZW50Q29udGFjdEl0ZW07YXQoYykmJmMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cj10Ll9jb25jYXRDb252ZXJzYXRpb25JRChlKSwodT10Ll9nZXRMb2NhbENvbnZlcnNhdGlvbihyKSkmJi0xPT09dS5jb252ZXJzYXRpb25Hcm91cExpc3QuaW5kZXhPZihpKSYmKHUuY29udmVyc2F0aW9uR3JvdXBMaXN0LnB1c2goaSksbj0hMCl9KSl9KSksITA9PT1uJiZ0aGlzLl9lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCksITA9PT1vJiZ0aGlzLl9lbWl0Q29udkdyb3VwTGlzdFVwZGF0ZSgpKX19LHtrZXk6XCJvbkNvbnZHcm91cERlbGV0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkNvbnZHcm91cERlbGV0ZWQgZ3JvdXBJdGVtTGlzdDpcIiksZSk7dmFyIG49W107aWYoYXQoZSkpe3ZhciBvPSExO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHM9ZS5ncm91cElELGE9ZS5ncm91cE5hbWU7dC5fY29udkdyb3VwTWFwLmhhcyhzKSYmKHQuX2NvbnZHcm91cE1hcC5kZWxldGUocyksbz0hMCxuLnB1c2goYSkpfSkpLCEwPT09byYmdGhpcy5fZW1pdENvbnZHcm91cExpc3RVcGRhdGUoKX10aGlzLl9lcmFzZUZyb21Db252ZXJzYXRpb25Hcm91cExpc3Qobil9fSx7a2V5OlwiX2VyYXNlRnJvbUNvbnZlcnNhdGlvbkdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3p0KGUpfHwodGhpcy5fY29udmVyc2F0aW9uTW9kdWxlLmdldExvY2FsQ29udmVyc2F0aW9uTGlzdCgpLmZvckVhY2goKGZ1bmN0aW9uKHQpe3QuY29udmVyc2F0aW9uR3JvdXBMaXN0PXQuY29udmVyc2F0aW9uR3JvdXBMaXN0LmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIWUuaW5jbHVkZXModCl9KSl9KSksdGhpcy5fZW1pdENvbnZlcnNhdGlvblVwZGF0ZSgpKX19LHtrZXk6XCJvbkNvbnZHcm91cE5hbWVVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQ29udkdyb3VwTmFtZVVwZGF0ZWQgb3B0aW9uczpcIiksZSk7dmFyIHQ9ZS5ncm91cElELG49ZS5ncm91cE5hbWUsbz1lLm9sZEdyb3VwTmFtZTtpZih0aGlzLl9jb252R3JvdXBNYXAuZ2V0KHQpIT09bil7dGhpcy5fY29udkdyb3VwTWFwLnNldCh0LG4pLHRoaXMuX2VtaXRDb252R3JvdXBMaXN0VXBkYXRlKCk7dmFyIHMsYSxpPXRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKSxyPSExO2kuZm9yRWFjaCgoZnVuY3Rpb24oZSl7cz1lLmNvbnZlcnNhdGlvbkdyb3VwTGlzdCwtMSE9PShhPXMuaW5kZXhPZihvKSkmJihzLnNwbGljZShhLDEsbikscj0hMCl9KSksITA9PT1yJiZ0aGlzLl9lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCl9fX0se2tleTpcIm9uQ29udkluR3JvdXBVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25Db252SW5Hcm91cFVwZGF0ZWQgb3B0aW9uczpcIiksZSk7dmFyIG49ZS5vbGRHcm91cE5hbWUsbz1lLnJlY2VudENvbnRhY3RVcGRhdGVHcm91cEl0ZW07aWYoYXQobykpe3ZhciBzLGEsaSxyPSExO28uZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG89ZS5jb250YWN0T3B0VHlwZSx1PWUucmVjZW50Q29udGFjdEl0ZW07cz10Ll9jb25jYXRDb252ZXJzYXRpb25JRCh1KSwoYT10Ll9nZXRMb2NhbENvbnZlcnNhdGlvbihzKSkmJihpPWEuY29udmVyc2F0aW9uR3JvdXBMaXN0LmluZGV4T2YobiksMT09PW8/LTE9PT1pJiYoYS5jb252ZXJzYXRpb25Hcm91cExpc3QucHVzaChuKSxyPSEwKToyPT09byYmLTEhPT1pJiYoYS5jb252ZXJzYXRpb25Hcm91cExpc3Quc3BsaWNlKGksMSkscj0hMCkpfSkpLCEwPT09ciYmKHRoaXMuX2VtaXRDb252ZXJzYXRpb25VcGRhdGUoKSx0aGlzLl9lbWl0Q29udkluR3JvdXBVcGRhdGUobikpfX19LHtrZXk6XCJvbkNvbnZBZGRlZFRvT3JEZWxldGVkRnJvbUdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25Db252QWRkZWRUb09yRGVsZXRlZEZyb21Hcm91cCBvcHRpb25zOlwiKSxlKTt2YXIgbj1lLm1zZ1JlY2VudENvbnRhY3RJdGVtLG89ZS5tc2dSZWNlbnRDb250YWN0VXBkYXRlQ29udGFjdEl0ZW0scz10aGlzLl9jb25jYXRDb252ZXJzYXRpb25JRChuKSxhPXRoaXMuX2dldExvY2FsQ29udmVyc2F0aW9uKHMpO2lmKGEmJmF0KG8pKXt2YXIgaSxyPSExO28uZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49ZS5ncm91cE9wdFR5cGUsbz1lLnJlY2VudENvbnRhY3RHcm91cEl0ZW0uZ3JvdXBOYW1lO2k9YS5jb252ZXJzYXRpb25Hcm91cExpc3QuaW5kZXhPZihvKSwxPT09bj8tMT09PWkmJihhLmNvbnZlcnNhdGlvbkdyb3VwTGlzdC5wdXNoKG8pLHI9ITApOjI9PT1uJiYtMSE9PWkmJihhLmNvbnZlcnNhdGlvbkdyb3VwTGlzdC5zcGxpY2UoaSwxKSxyPSEwKSwhMD09PXImJnQuX2VtaXRDb252SW5Hcm91cFVwZGF0ZShvKX0pKSwhMD09PXImJnRoaXMuX2VtaXRDb252ZXJzYXRpb25VcGRhdGUoKX19fSx7a2V5Olwib25Db252R3JvdXBMaXN0U3luY2VkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpczthdChlKSYmMCE9PWUubGVuZ3RoJiYoVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQ29udkdyb3VwTGlzdFN5bmNlZCBncm91cEl0ZW1MaXN0OlwiKSxlKSxlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2NvbnZHcm91cE1hcC5zZXQoZS5jb252R3JvdXBJRCxlLmdyb3VwTmFtZSl9KSkpfX0se2tleTpcImdldENvbnZHcm91cExpc3RCeUlEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighenQoZSkpe3ZhciBuPVtdO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2NvbnZHcm91cE1hcC5oYXMoZSkmJm4ucHVzaCh0Ll9jb252R3JvdXBNYXAuZ2V0KGUpKX0pKSxufX19LHtrZXk6XCJfb25Db252ZXJzYXRpb25Ob3RGb3VuZFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7ZS5wdXNoKHtjb252ZXJzYXRpb25JRDp0LGNvZGU6aGEuQ09OVkVSU0FUSU9OX05PVF9GT1VORCxtZXNzYWdlOnRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXRFcnJvck1lc3NhZ2UoaGEuQ09OVkVSU0FUSU9OX05PVF9GT1VORCl9KX19LHtrZXk6XCJfb25Db252ZXJzYXRpb25JREludmFsaWRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2UucHVzaCh7Y29udmVyc2F0aW9uSUQ6dCxjb2RlOmhhLklOVkFMSURfQ09OVkVSU0FUSU9OX0lELG1lc3NhZ2U6dGhpcy5fY29udmVyc2F0aW9uTW9kdWxlLmdldEVycm9yTWVzc2FnZShoYS5JTlZBTElEX0NPTlZFUlNBVElPTl9JRCl9KX19LHtrZXk6XCJfZ2V0RmxhZ0JpdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLnRvU3RyaW5nKDIpLG49dC5sZW5ndGgsbz1uLTE7bz49MDtvLS0paWYoXCIxXCI9PT10W29dKXJldHVybiBuLW8tMX19LHtrZXk6XCJfY29uY2F0Q29udmVyc2F0aW9uSURcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdCxuPWUudHlwZSxvPWUudG8scz1lLmdyb3VwSUQsYT1lLnVzZXJJRDtyZXR1cm4gMT09PW4/aXQoYSk/aXQobyl8fCh0PVwiXCIuY29uY2F0KEUuQ09OVl9DMkMpLmNvbmNhdChvKSk6dD1cIlwiLmNvbmNhdChFLkNPTlZfQzJDKS5jb25jYXQoYSk6Mj09PW4mJih0PVwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KHMpKSx0fX0se2tleTpcIl9nZXRNeVVzZXJJRFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXRNeVVzZXJJRCgpfX0se2tleTpcIl9pbnNlcnRDb252ZXJzYXRpb25Hcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fZ2V0TG9jYWxDb252ZXJzYXRpb24oZSk7aWYobil7dmFyIG89bi5jb252ZXJzYXRpb25Hcm91cExpc3Q7LTE9PT1vLmluZGV4T2YodCkmJm8ucHVzaCh0KX19fSx7a2V5OlwiX2dldExvY2FsQ29udmVyc2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXRMb2NhbENvbnZlcnNhdGlvbihlKX19LHtrZXk6XCJfaGFzTG9jYWxDb252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udmVyc2F0aW9uTW9kdWxlLmhhc0xvY2FsQ29udmVyc2F0aW9uKGUpfX0se2tleTpcIl9lbWl0Q29udmVyc2F0aW9uVXBkYXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSl9fSx7a2V5OlwiX2VtaXRDb252R3JvdXBMaXN0VXBkYXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZW1pdE91dGVyRXZlbnQoay5DT05WRVJTQVRJT05fR1JPVVBfTElTVF9VUERBVEVELG0odGhpcy5fY29udkdyb3VwTWFwLnZhbHVlcygpKSl9fSx7a2V5OlwiX2VtaXRDb252SW5Hcm91cFVwZGF0ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXtncm91cE5hbWU6ZSxjb252ZXJzYXRpb25MaXN0OltdfSxuPXRoaXMuX2NvbnZlcnNhdGlvbk1vZHVsZS5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKTt0LmNvbnZlcnNhdGlvbkxpc3Q9bi5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiB0LmNvbnZlcnNhdGlvbkdyb3VwTGlzdC5pbmNsdWRlcyhlKX0pKSx0aGlzLl9jb252ZXJzYXRpb25Nb2R1bGUuZW1pdE91dGVyRXZlbnQoay5DT05WRVJTQVRJT05fSU5fR1JPVVBfVVBEQVRFRCx0KX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKSx0aGlzLl9jb252R3JvdXBNYXAuY2xlYXIoKSx0aGlzLl9zdGFydEluZGV4PTAsdGhpcy5fcGFnaW5nU3RhdHVzPSR0Lk5PVF9TVEFSVH19XSksZX0oKSxNaT1mdW5jdGlvbihlKXtyKHMsZSk7dmFyIG49ZihzKTtmdW5jdGlvbiBzKGUpe3ZhciB0O3JldHVybiBvKHRoaXMscyksKHQ9bi5jYWxsKHRoaXMsZSkpLl9uPVwiQ29udmVyc2F0aW9uTW9kdWxlXCIsb2kubWl4aW4oaCh0KSksdC5fbWVzc2FnZUxpc3RIYW5kbGVyPW5ldyAkYSx0Ll9tZXNzYWdlUmVtaW5kSGFuZGxlcj1uZXcgdmkoaCh0KSksdC5fY29udkdyb3VwSGFuZGxlcj1uZXcgbWkoaCh0KSksdC5zaW5nbHlMaW5rZWRMaXN0PW5ldyBwaSgxMDApLHQuX3BhZ2luZ1N0YXR1cz0kdC5OT1RfU1RBUlQsdC5fcGFnaW5nVGltZVN0YW1wPTAsdC5fcGFnaW5nU3RhcnRJbmRleD0wLHQuX3BhZ2luZ1Bpbm5lZFRpbWVTdGFtcD0wLHQuX3BhZ2luZ1Bpbm5lZFN0YXJ0SW5kZXg9MCx0Ll9wYWdpbmdDb252SURNYXA9bmV3IE1hcCx0Ll9jb252SURGcm9tVW5yZWFkREJNYXA9bmV3IE1hcCx0Ll9jb252ZXJzYXRpb25NYXA9bmV3IE1hcCx0Ll90bXBHcm91cExpc3Q9W10sdC5fdG1wR3JvdXBBdFRpcHNMaXN0PVtdLHQuX3BlZXJSZWFkVGltZU1hcD1uZXcgTWFwLHQuX2NvbXBsZXRlZE1hcD1uZXcgTWFwLHQuX3JvYW1pbmdNZXNzYWdlS2V5QW5kVGltZU1hcD1uZXcgTWFwLHQuX3JvYW1pbmdNZXNzYWdlU2VxdWVuY2VNYXA9bmV3IE1hcCx0Ll9yZW1vdGVHcm91cFJlYWRTZXF1ZW5jZU1hcD1uZXcgTWFwLHQuX2NvbnZUb3RhbFVucmVhZENvdW50PTAsdC5fcGFnaW5nR2V0Q29zdExpc3Q9W10sdC5faW5pdExpc3RlbmVycygpLHR9cmV0dXJuIGEocyxbe2tleTpcIl9pbml0TGlzdGVuZXJzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldElubmVyRW1pdHRlckluc3RhbmNlKCk7ZS5vbihlaSx0aGlzLl9pbml0TG9jYWxDb252ZXJzYXRpb25MaXN0LHRoaXMpLGUub24obmksdGhpcy5fb25Qcm9maWxlVXBkYXRlZCx0aGlzKX19LHtrZXk6XCJvbkNoZWNrVGltZXJcIix2YWx1ZTpmdW5jdGlvbihlKXtlJTYwPT0wJiZ0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIudHJhdmVyc2FsKCl9fSx7a2V5OlwiX2luaXRMb2NhbENvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1uZXcgQWEoXCJfaW5pdExvY2FsQ29udmVyc2F0aW9uTGlzdFwiKTtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcIl9pbml0TG9jYWxDb252ZXJzYXRpb25MaXN0XCIpKTt2YXIgbj1cIlwiLG89dGhpcy5fZ2V0U3RvcmFnZUNvbnZlcnNhdGlvbkxpc3QoKSxzPXRoaXMuaXNJbnRsKCk7aWYobyl7Zm9yKHZhciBhPW8ubGVuZ3RoLGk9MDtpPGE7aSsrKXt2YXIgcj1vW2ldO2lmKHIpe2lmKHIuY29udmVyc2F0aW9uSUQ9PT1cIlwiLmNvbmNhdChFLkNPTlZfQzJDLFwiQFRMUyNFUlJPUlwiKXx8ci5jb252ZXJzYXRpb25JRD09PVwiXCIuY29uY2F0KEUuQ09OVl9DMkMsXCJAVExTI05PVF9GT1VORFwiKSljb250aW51ZTtpZihyLmdyb3VwUHJvZmlsZSl7dmFyIHU9ci5ncm91cFByb2ZpbGUudHlwZTtpZihUdCh1KSljb250aW51ZX19dGhpcy5fY29udmVyc2F0aW9uTWFwLnNldChvW2ldLmNvbnZlcnNhdGlvbklELG5ldyBmaShvW2ldLHMpKX10aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpLG49XCJjb3VudDpcIi5jb25jYXQoYSl9ZWxzZSBuPVwiY291bnQ6MFwiO3Quc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKG4pLmVuZCgpLHRoaXMuZ2V0TW9kdWxlKFVuKXx8dGhpcy50cmlnZ2VyUmVhZHkoKSx0aGlzLnJlYWR5KChmdW5jdGlvbigpe2UuX3RtcEdyb3VwTGlzdC5sZW5ndGg+MCYmKGUudXBkYXRlQ29udmVyc2F0aW9uR3JvdXBQcm9maWxlKGUuX3RtcEdyb3VwTGlzdCksZS5fdG1wR3JvdXBMaXN0Lmxlbmd0aD0wKX0pKSx0aGlzLnN5bmNDb252ZXJzYXRpb25MaXN0KCl9fSx7a2V5Olwib25NZXNzYWdlU2VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uU2VuZE9yUmVjZWl2ZU1lc3NhZ2Uoe2NvbnZlcnNhdGlvbk9wdGlvbnNMaXN0OmUuY29udmVyc2F0aW9uT3B0aW9uc0xpc3QsaXNJbnN0YW50TWVzc2FnZTohMH0pfX0se2tleTpcIm9uTmV3TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX29uU2VuZE9yUmVjZWl2ZU1lc3NhZ2UoZSl9fSx7a2V5OlwiX29uU2VuZE9yUmVjZWl2ZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5jb252ZXJzYXRpb25PcHRpb25zTGlzdCxvPWUuaXNJbnN0YW50TWVzc2FnZSxzPXZvaWQgMD09PW98fG8sYT1lLmlzVW5yZWFkQzJDTWVzc2FnZSxpPXZvaWQgMCE9PWEmJmEscj1lLnVwZGF0ZVVucmVhZENvdW50LHU9dm9pZCAwPT09cnx8cjt0aGlzLl9pc1JlYWR5PzAhPT1uLmxlbmd0aCYmKHRoaXMuX2dldEMyQ1BlZXJSZWFkVGltZShuKSx0aGlzLl91cGRhdGVMb2NhbENvbnZlcnNhdGlvbkxpc3Qoe2NvbnZlcnNhdGlvbk9wdGlvbnNMaXN0Om4saXNJbnN0YW50TWVzc2FnZTpzLGlzVW5yZWFkQzJDTWVzc2FnZTppLGlzRnJvbUdldENvbnZlcnNhdGlvbnM6ITEsdXBkYXRlVW5yZWFkQ291bnQ6dX0pLHN8fCh0aGlzLl9jb252SURGcm9tVW5yZWFkREJNYXA9bmV3IE1hcChbXS5jb25jYXQobSh0aGlzLl9jb252SURGcm9tVW5yZWFkREJNYXApLG0obi5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybltlLmNvbnZlcnNhdGlvbklELDFdfSkpKSkpLHRoaXMuX2RpZmZBbmREZWxldGVDb252ZXJzYXRpb24oKSksdGhpcy5fc2V0U3RvcmFnZUNvbnZlcnNhdGlvbkxpc3QoKSxuLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGUudHlwZT09PUUuQ09OVl9UT1BJQ30pKS5sZW5ndGg+MHx8dGhpcy5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCkpOnRoaXMucmVhZHkoKGZ1bmN0aW9uKCl7dC5fb25TZW5kT3JSZWNlaXZlTWVzc2FnZShlKX0pKX19LHtrZXk6XCJ1cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCFhdChlKXx8MCE9PWUubGVuZ3RoKWlmKDAhPT10aGlzLl9jb252ZXJzYXRpb25NYXAuc2l6ZSl7dmFyIG49ITE7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgbz1cIkdST1VQXCIuY29uY2F0KGUuZ3JvdXBJRCk7aWYodC5fY29udmVyc2F0aW9uTWFwLmhhcyhvKSl7bj0hMDt2YXIgcz10Ll9jb252ZXJzYXRpb25NYXAuZ2V0KG8pO3MuZ3JvdXBQcm9maWxlPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZSkpLHMubGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlPGUubmV4dE1lc3NhZ2VTZXEmJihzLmxhc3RNZXNzYWdlLmxhc3RTZXF1ZW5jZT1lLm5leHRNZXNzYWdlU2VxLTEpLHMuc3ViVHlwZXx8KHMuc3ViVHlwZT1lLnR5cGUpfX0pKSxuJiZ0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpfWVsc2UgdGhpcy5fdG1wR3JvdXBMaXN0PWV9fSx7a2V5OlwiX3VwZGF0ZUNvbnZlcnNhdGlvblVzZXJQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztlLmRhdGEuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49XCJDMkNcIi5jb25jYXQoZS51c2VySUQpO3QuX2NvbnZlcnNhdGlvbk1hcC5oYXMobikmJih0Ll9jb252ZXJzYXRpb25NYXAuZ2V0KG4pLnVzZXJQcm9maWxlPWUpfSkpLHRoaXMuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSl9fSx7a2V5Olwib25NZXNzYWdlUmV2b2tlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoMCE9PWUubGVuZ3RoKXt2YXIgbj1udWxsLG89ITEscz1bXTtlLmZvckVhY2goKGZ1bmN0aW9uKGUpeyhuPXQuX2NvbnZlcnNhdGlvbk1hcC5nZXQoZS5jb252ZXJzYXRpb25JRCkpJiYobi50eXBlPT09RS5DT05WX1RPUElDP3MucHVzaChlKToobi5yZWR1Y2VVbnJlYWRDb3VudCgpJiYobz0hMCksbi5pc0xhc3RNZXNzYWdlUmV2b2tlZCh7c2VxdWVuY2U6ZS5zZXF1ZW5jZSx0aW1lOmUudGltZX0pJiYobi5zZXRMYXN0TWVzc2FnZVJldm9rZWQoITApLG4uc2V0TGFzdE1lc3NhZ2VSZXZva2VyKGUucmV2b2tlciksbz0hMCkpKX0pKSx0aGlzLmdldE1vZHVsZShGbikub25NZXNzYWdlUmV2b2tlZChzKSxvJiYodGhpcy5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKSx0aGlzLmVtaXRUb3RhbFVucmVhZE1lc3NhZ2VDb3VudFVwZGF0ZSgpKX19fSx7a2V5OlwiaXNMYXN0TWVzc2FnZVJldm9rZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0hMSxuPWUuY29udmVyc2F0aW9uSUQsbz1lLnNlcXVlbmNlLHM9ZS50aW1lLGE9dGhpcy5fY29udmVyc2F0aW9uTWFwLmdldChuKTthJiYodD1hLnR5cGU9PT1FLkNPTlZfVE9QSUM/dGhpcy5nZXRNb2R1bGUoRm4pLmlzTGFzdE1lc3NhZ2VSZXZva2VkKHt0b3BpY0lEOm4ucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIiksc2VxdWVuY2U6b30pOmEuaXNMYXN0TWVzc2FnZVJldm9rZWQoe3NlcXVlbmNlOm8sdGltZTpzfSkpO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuaXNMYXN0TWVzc2FnZVJldm9rZWQgb3B0aW9uczpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KGUpLFwiIHJldDpcIikuY29uY2F0KHQpKSx0fX0se2tleTpcIm9uTWVzc2FnZURlbGV0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKDAhPT1lLmxlbmd0aCl7dmFyIG49bnVsbDtlLmZvckVhY2goKGZ1bmN0aW9uKGUpeyhuPXQuX21lc3NhZ2VMaXN0SGFuZGxlci5nZXRMb2NhbE1lc3NhZ2UoZS5jb252ZXJzYXRpb25JRCxlLklEKSkmJihuLmlzRGVsZXRlZD0hMCksZSE9PW4mJihlLmlzRGVsZXRlZD0hMCl9KSk7Zm9yKHZhciBvPWVbMF0uY29udmVyc2F0aW9uSUQscz10aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TG9jYWxNZXNzYWdlTGlzdChvKSxhPXt9LGk9cy5sZW5ndGgtMTtpPj0wO2ktLSlpZighc1tpXS5pc0RlbGV0ZWQpe2E9c1tpXTticmVha312YXIgcj10aGlzLl9jb252ZXJzYXRpb25NYXAuZ2V0KG8pO2lmKHIpe3ZhciB1PSExO3IubGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlPT09YS5zZXF1ZW5jZSYmci5sYXN0TWVzc2FnZS5sYXN0VGltZT09PWEudGltZXx8KHp0KGEpJiYoYT12b2lkIDApLHIudXBkYXRlTGFzdE1lc3NhZ2UoYSksci50eXBlIT09RS5DT05WX1RPUElDJiYodT0hMCksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uTWVzc2FnZURlbGV0ZWQuIHVwZGF0ZSBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KG8sXCIgd2l0aCBsYXN0TWVzc2FnZTpcIiksci5sYXN0TWVzc2FnZSkpLG8uc3RhcnRzV2l0aChFLkNPTlZfQzJDKSYmdGhpcy51cGRhdGVVbnJlYWRDb3VudChvKSx1JiZ0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpfX19fSx7a2V5Olwib25NZXNzYWdlTW9kaWZpZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmNvbnZlcnNhdGlvblR5cGUsbj1lLmZyb20sbz1lLnRvLHM9ZS50aW1lLGE9ZS5zZXF1ZW5jZSxpPWUuZWxlbWVudHMscj1lLmNsb3VkQ3VzdG9tRGF0YSx1PWUubWVzc2FnZVZlcnNpb24sYz10aGlzLmdldE15VXNlcklEKCksbD1cIlwiLmNvbmNhdCh0KS5jb25jYXQobyk7bz09PWMmJnQ9PT1FLkNPTlZfQzJDJiYobD1cIlwiLmNvbmNhdCh0KS5jb25jYXQobikpO3ZhciBkPXRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5vbk1lc3NhZ2VNb2RpZmllZChsLGUpLHA9ZC5pc1VwZGF0ZWQsZz1kLm1lc3NhZ2U7ITA9PT1wJiZ0aGlzLmVtaXRPdXRlckV2ZW50KGsuTUVTU0FHRV9NT0RJRklFRCxbZ10pO3ZhciBoPXRoaXMuX2lzVG9waWNDb252ZXJzYXRpb24obCk7aWYoVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uTWVzc2FnZU1vZGlmaWVkIGlzVXBkYXRlZDpcIikuY29uY2F0KHAsXCIgaXNUb3BpY01lc3NhZ2U6XCIpLmNvbmNhdChoLFwiIGZyb206XCIpLmNvbmNhdChuLFwiIHRvOlwiKS5jb25jYXQobykpLGgpe3RoaXMuZ2V0TW9kdWxlKEZuKS5vbk1lc3NhZ2VNb2RpZmllZChlKX1lbHNle3ZhciBfPXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5nZXQobCk7aWYoXyl7dmFyIGY9Xy5sYXN0TWVzc2FnZTtWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24ub25NZXNzYWdlTW9kaWZpZWQsXCIgbGFzdE1lc3NhZ2U6XCIpLEpTT04uc3RyaW5naWZ5KGYpLFwib3B0aW9uczpcIixKU09OLnN0cmluZ2lmeShlKSksZiYmZi5sYXN0VGltZT09PXMmJmYubGFzdFNlcXVlbmNlPT09YSYmZi52ZXJzaW9uIT09dSYmKGYudHlwZT1pWzBdLnR5cGUsZi5wYXlsb2FkPWlbMF0uY29udGVudCxmLm1lc3NhZ2VGb3JTaG93PVZ0KGYudHlwZSxmLnBheWxvYWQsdGhpcy5pc0ludGwoKSksZi5jbG91ZEN1c3RvbURhdGE9cixmLnZlcnNpb249dSx0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpKX19cmV0dXJuIGd9fSx7a2V5Olwib25OZXdHcm91cEF0VGlwc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1lLmRhdGFMaXN0LHM9bnVsbDtvLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UuZ3JvdXBBdFRpcHM/cz1lLmdyb3VwQXRUaXBzOmUuZWxlbWVudHM/cz10KHQoe30sZS5lbGVtZW50cykse30se3N5bmM6ITB9KTplLmdyb3VwQXRUeXBlJiYocz10KHQoe30sZSkse30se3N5bmM6ITB9KSkscy5fX3JhbmRvbT1lLnJhbmRvbSxzLl9fc2VxdWVuY2U9ZS5jbGllbnRTZXF1ZW5jZSxuLl90bXBHcm91cEF0VGlwc0xpc3QucHVzaChzKX0pKSxWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25OZXdHcm91cEF0VGlwcyBpc1JlYWR5OlwiKS5jb25jYXQodGhpcy5faXNSZWFkeSksdGhpcy5fdG1wR3JvdXBBdFRpcHNMaXN0KSx0aGlzLl9pc1JlYWR5JiZ0aGlzLl9oYW5kbGVHcm91cEF0VGlwc0xpc3QoKX19LHtrZXk6XCJfaGFuZGxlR3JvdXBBdFRpcHNMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKDAhPT10aGlzLl90bXBHcm91cEF0VGlwc0xpc3QubGVuZ3RoKXt2YXIgdD0hMTt0aGlzLl90bXBHcm91cEF0VGlwc0xpc3QuZm9yRWFjaCgoZnVuY3Rpb24obil7dmFyIG89bi5ncm91cElELHM9bi5mcm9tLGE9bi50b3BpY0lELGk9dm9pZCAwPT09YT92b2lkIDA6YSxyPW4uc3luYyx1PXZvaWQgMCE9PXImJnI7aWYocyE9PWUuZ2V0TXlVc2VySUQoKSlpZihpdChpKSl7dmFyIGM9ZS5fY29udmVyc2F0aW9uTWFwLmdldChcIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChvKSk7YyYmKGMudXBkYXRlR3JvdXBBdEluZm9MaXN0KG4pLHQ9ITApfWVsc2V7dmFyIGw9ZS5fY29udmVyc2F0aW9uTWFwLmdldChcIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChpKSk7aWYobCl7bC51cGRhdGVHcm91cEF0SW5mb0xpc3Qobik7dmFyIGQ9ZS5nZXRNb2R1bGUoRm4pLHA9bC5ncm91cEF0SW5mb0xpc3Q7ZC5vbkNvbnZlcnNhdGlvblByb3h5KHt0b3BpY0lEOmksZ3JvdXBBdEluZm9MaXN0OnB9KX1pZih6dChsKSYmdSllLnVwZGF0ZVRvcGljQ29udmVyc2F0aW9uKFt7Y29udmVyc2F0aW9uSUQ6XCJcIi5jb25jYXQoRS5DT05WX0dST1VQKS5jb25jYXQoaSksdHlwZTpFLkNPTlZfVE9QSUN9XSksZS5fY29udmVyc2F0aW9uTWFwLmdldChcIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChpKSkudXBkYXRlR3JvdXBBdEluZm9MaXN0KG4pfX0pKSx0JiZ0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpLHRoaXMuX3RtcEdyb3VwQXRUaXBzTGlzdC5sZW5ndGg9MH19fSx7a2V5OlwiX2dldEMyQ1BlZXJSZWFkVGltZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1bXTtpZihlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2NvbnZlcnNhdGlvbk1hcC5oYXMoZS5jb252ZXJzYXRpb25JRCl8fGUudHlwZSE9PUUuQ09OVl9DMkN8fG4ucHVzaChlLmNvbnZlcnNhdGlvbklELnJlcGxhY2UoRS5DT05WX0MyQyxcIlwiKSl9KSksbi5sZW5ndGg+MCl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9nZXRDMkNQZWVyUmVhZFRpbWUgdXNlcklETGlzdDpcIikuY29uY2F0KG4pKTt2YXIgbz10aGlzLmdldE1vZHVsZShVbik7byYmby5nZXRSZW1vdGVQZWVyUmVhZFRpbWUobil9fX0se2tleTpcIl9nZXRTdG9yYWdlQ29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKFZuKS5nZXRJdGVtKFwiY29udmVyc2F0aW9uTWFwXCIpfX0se2tleTpcIl9zZXRTdG9yYWdlQ29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT1FLkNPTlZfQzJDfHxlLnR5cGU9PT1FLkNPTlZfR1JPVVAmJmUubGFzdE1lc3NhZ2UudHlwZSE9PUUuTVNHX0dSUF9USVB9KSkuc2xpY2UoMCwyMCkubWFwKChmdW5jdGlvbihlKXtyZXR1cm57Y29udmVyc2F0aW9uSUQ6ZS5jb252ZXJzYXRpb25JRCx0eXBlOmUudHlwZSxzdWJUeXBlOmUuc3ViVHlwZSxsYXN0TWVzc2FnZTplLmxhc3RNZXNzYWdlLGdyb3VwUHJvZmlsZTplLmdyb3VwUHJvZmlsZSx1c2VyUHJvZmlsZTplLnVzZXJQcm9maWxlfX0pKTt0aGlzLmdldE1vZHVsZShWbikuc2V0SXRlbShcImNvbnZlcnNhdGlvbk1hcFwiLGUpfX0se2tleTpcImVtaXRDb252ZXJzYXRpb25VcGRhdGVcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPSEoYXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0pfHxhcmd1bWVudHNbMF0sdD0hKGFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdKXx8YXJndW1lbnRzWzFdLG49dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKTtpZih0KXt2YXIgbz10aGlzLmdldE1vZHVsZShQbik7byYmby51cGRhdGVHcm91cExhc3RNZXNzYWdlKG4pfWUmJnRoaXMuZW1pdE91dGVyRXZlbnQoay5DT05WRVJTQVRJT05fTElTVF9VUERBVEVEKX19LHtrZXk6XCJnZXRMb2NhbENvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBtKHRoaXMuX2NvbnZlcnNhdGlvbk1hcC52YWx1ZXMoKSkuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZS50eXBlIT09RS5DT05WX1RPUElDfSkpfX0se2tleTpcImdldExvY2FsQ29udmVyc2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NvbnZlcnNhdGlvbk1hcC5nZXQoZSl9fSx7a2V5OlwiaGFzTG9jYWxDb252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udmVyc2F0aW9uTWFwLmhhcyhlKX19LHtrZXk6XCJnZXRMb2NhbE9sZGVzdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsT2xkZXN0TWVzc2FnZShlKX19LHtrZXk6XCJzeW5jQ29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PW5ldyBBYShcInN5bmNDb252ZXJzYXRpb25MaXN0XCIpO3JldHVybiB0aGlzLl9wYWdpbmdTdGF0dXM9PT0kdC5OT1RfU1RBUlQmJnRoaXMuX2NvbnZlcnNhdGlvbk1hcC5jbGVhcigpLHRoaXMuX3BhZ2luZ0dldENvbnZlcnNhdGlvbkxpc3QoKS50aGVuKChmdW5jdGlvbihuKXt2YXIgbz1mdW5jdGlvbihlKXtpZihhdChlKSYmMCE9PWUubGVuZ3RoKXt2YXIgdD0wO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QrPWV9KSksKHQvZS5sZW5ndGgpLnRvRml4ZWQoMCl9fShlLl9wYWdpbmdHZXRDb3N0TGlzdCk7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQoZS5fbixcIi5cIikuY29uY2F0KFwic3luY0NvbnZlcnNhdGlvbkxpc3RcIixcIi4gc3VtIFwiKS5jb25jYXQoZnVuY3Rpb24oZSl7aWYoYXQoZSkmJjAhPT1lLmxlbmd0aCl7dmFyIHQ9MDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Kz1lfSkpLHQudG9GaXhlZCgwKX19KGUuX3BhZ2luZ0dldENvc3RMaXN0KSxcIiBtcywgYXZlcmFnZSBcIikuY29uY2F0KG8sXCIgbXNcIikpLGUuX3BhZ2luZ0dldENvc3RMaXN0Lmxlbmd0aD0wLGUuX3BhZ2luZ1N0YXR1cz0kdC5SRVNPTFZFRCxlLl9kaWZmQW5kRGVsZXRlQ29udmVyc2F0aW9uKCksZS5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKSxlLl9zZXRTdG9yYWdlQ29udmVyc2F0aW9uTGlzdCgpLGUuX2hhbmRsZUMyQ1BlZXJSZWFkVGltZSgpLGUuX3BhdGNoQ29udmVyc2F0aW9uUHJvcGVydGllcygpLHQuc2V0TWVzc2FnZShlLl9jb252ZXJzYXRpb25NYXAuc2l6ZSkuc2V0TW9yZU1lc3NhZ2Uobykuc2V0TmV0d29ya1R5cGUoZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxufSkpLmNhdGNoKChmdW5jdGlvbihuKXtyZXR1cm4gZS5fcGFnaW5nU3RhdHVzPSR0LlJFSkVDVEVELHQuc2V0TWVzc2FnZShlLl9wYWdpbmdUaW1lU3RhbXApLGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89dihlLDIpLHM9b1swXSxhPW9bMV07dC5zZXRFcnJvcihuLHMsYSkuZW5kKCl9KSksWmEobil9KSl9fSx7a2V5OlwiX2RpZmZBbmREZWxldGVDb252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYodGhpcy5faXNTeW5jQ29tcGxldGVkKCkpe3ZhciB0PVtdO3RoaXMuX2NvbnZlcnNhdGlvbk1hcC5mb3JFYWNoKChmdW5jdGlvbihuLG8peyFlLl9wYWdpbmdDb252SURNYXAuaGFzKG8pJiZlLl9jb252SURGcm9tVW5yZWFkREJNYXAuaGFzKG8pJiYoZS5fY29udmVyc2F0aW9uTWFwLmRlbGV0ZShvKSx0LnB1c2gobykpfSkpLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fZGlmZkFuZERlbGV0ZUNvbnZlcnNhdGlvbiBsaXN0OlwiKS5jb25jYXQodCkpfX19LHtrZXk6XCJfcGF0Y2hDb252ZXJzYXRpb25Qcm9wZXJ0aWVzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9RGF0ZS5ub3coKSxuPXRoaXMuY2hlY2tBbmRQYXRjaFJlbWFyaygpLG89dGhpcy5fbWVzc2FnZVJlbWluZEhhbmRsZXIuZ2V0QzJDTWVzc2FnZVJlbWluZFR5cGUoKSxzPXRoaXMuZ2V0TW9kdWxlKFBuKS5nZXRHcm91cExpc3QoKTtQcm9taXNlLmFsbChbbixvLHNdKS50aGVuKChmdW5jdGlvbigpe3ZhciBuPURhdGUubm93KCktdDtWZS5sKFwiXCIuY29uY2F0KGUuX24sXCIuX3BhdGNoQ29udmVyc2F0aW9uUHJvcGVydGllcyBvay4gY29zdCBcIikuY29uY2F0KG4sXCIgbXNcIikpLGUuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSksZS5lbWl0VG90YWxVbnJlYWRNZXNzYWdlQ291bnRVcGRhdGUoKX0pKX19LHtrZXk6XCJfcGFnaW5nR2V0Q29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3BhZ2luZ0dldENvbnZlcnNhdGlvbkxpc3RcIik7VmUubChcIlwiLmNvbmNhdCh0LFwiIHRpbWVTdGFtcDpcIikuY29uY2F0KHRoaXMuX3BhZ2luZ1RpbWVTdGFtcCxcIiBzdGFydEluZGV4OlwiKS5jb25jYXQodGhpcy5fcGFnaW5nU3RhcnRJbmRleCkrXCIgcGlubmVkVGltZVN0YW1wOlwiLmNvbmNhdCh0aGlzLl9wYWdpbmdQaW5uZWRUaW1lU3RhbXAsXCIgcGlubmVkU3RhcnRJbmRleDpcIikuY29uY2F0KHRoaXMuX3BhZ2luZ1Bpbm5lZFN0YXJ0SW5kZXgpKTt2YXIgbj1EYXRlLm5vdygpO3JldHVybiB0aGlzLl9wYWdpbmdTdGF0dXM9JHQuUEVORElORyx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpHbyxyZXF1ZXN0RGF0YTp7ZnJvbUFjY291bnQ6dGhpcy5nZXRNeVVzZXJJRCgpLHRpbWVTdGFtcDp0aGlzLl9wYWdpbmdUaW1lU3RhbXAsc3RhcnRJbmRleDp0aGlzLl9wYWdpbmdTdGFydEluZGV4LHBpbm5lZFRpbWVTdGFtcDp0aGlzLl9wYWdpbmdQaW5uZWRUaW1lU3RhbXAscGlubmVkU3RhcnRJbmRleDp0aGlzLl9wYWdpbmdQaW5uZWRTdGFydEluZGV4LG9yZGVyVHlwZToxfX0pLnRoZW4oKGZ1bmN0aW9uKG8pe3ZhciBzPW8uZGF0YSxhPXMuY29tcGxldGVGbGFnLGk9cy5jb252ZXJzYXRpb25zLHI9dm9pZCAwPT09aT9bXTppLHU9cy50aW1lU3RhbXAsYz1zLnN0YXJ0SW5kZXgsbD1zLnBpbm5lZFRpbWVTdGFtcCxkPXMucGlubmVkU3RhcnRJbmRleCxwPXMuZ3JvdXBJdGVtLGc9RGF0ZS5ub3coKS1uO2lmKGUuX3BhZ2luZ0dldENvc3RMaXN0LnB1c2goZyksVmUubChcIlwiLmNvbmNhdCh0LFwiIG9rLiBjb21wbGV0ZUZsYWc6XCIpLmNvbmNhdChhLFwiIGNvdW50OlwiKS5jb25jYXQoci5sZW5ndGgsXCIgY29zdCBcIikuY29uY2F0KGcsXCIgbXNcIikpLGUuX2NvbnZHcm91cEhhbmRsZXIub25Db252R3JvdXBMaXN0U3luY2VkKHApLHIubGVuZ3RoPjApe3ZhciBoPWUuX2dldENvbnZlcnNhdGlvbk9wdGlvbnMocik7ZS5fcGFnaW5nQ29udklETWFwPW5ldyBNYXAoW10uY29uY2F0KG0oZS5fcGFnaW5nQ29udklETWFwKSxtKGgubWFwKChmdW5jdGlvbihlKXtyZXR1cm5bZS5jb252ZXJzYXRpb25JRCwxXX0pKSkpKSxlLl91cGRhdGVMb2NhbENvbnZlcnNhdGlvbkxpc3Qoe2NvbnZlcnNhdGlvbk9wdGlvbnNMaXN0OmgsaXNGcm9tR2V0Q29udmVyc2F0aW9uczohMH0pLGUuaXNMb2dnZWRJbigpJiZlLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoKX1pZighZS5faXNSZWFkeSl7aWYoIWUuaXNMb2dnZWRJbigpKXJldHVybiBYYSgpO2UudHJpZ2dlclJlYWR5KCl9cmV0dXJuIGUuX3BhZ2luZ1RpbWVTdGFtcD11LGUuX3BhZ2luZ1N0YXJ0SW5kZXg9YyxlLl9wYWdpbmdQaW5uZWRUaW1lU3RhbXA9bCxlLl9wYWdpbmdQaW5uZWRTdGFydEluZGV4PWQsMSE9PWE/ZS5fcGFnaW5nR2V0Q29udmVyc2F0aW9uTGlzdCgpOihlLl9oYW5kbGVHcm91cEF0VGlwc0xpc3QoKSxlLl9jb252R3JvdXBIYW5kbGVyLmdldFJlbW90ZUNvbnZHcm91cExpc3QoKSxYYSgpKX0pKS5jYXRjaCgoZnVuY3Rpb24obil7dGhyb3cgZS5pc0xvZ2dlZEluKCkmJihlLl9pc1JlYWR5fHwoVmUudyhcIlwiLmNvbmNhdCh0LFwiIGZhaWxlZC4gZXJyb3I6XCIpLG4pLGUudHJpZ2dlclJlYWR5KCkpKSxufSkpfX0se2tleTpcIl91cGRhdGVMb2NhbENvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdCxuPWUuaXNGcm9tR2V0Q29udmVyc2F0aW9ucyxvPWUuaXNJbnN0YW50TWVzc2FnZSxzPURhdGUubm93KCk7dD10aGlzLl9nZXRUbXBDb252ZXJzYXRpb25MaXN0TWFwcGluZyhlKSx0aGlzLl9jb252ZXJzYXRpb25NYXA9bmV3IE1hcCh0aGlzLl9zb3J0Q29udmVyc2F0aW9uTGlzdChbXS5jb25jYXQobSh0LnRvQmVVcGRhdGVkQ29udmVyc2F0aW9uTGlzdCksbSh0aGlzLl9jb252ZXJzYXRpb25NYXApKSkpLG58fCh0aGlzLl91cGRhdGVVc2VyT3JHcm91cFByb2ZpbGUodC5uZXdDb252ZXJzYXRpb25MaXN0KSxvJiZ0aGlzLmVtaXRUb3RhbFVucmVhZE1lc3NhZ2VDb3VudFVwZGF0ZSgpKSxWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3VwZGF0ZUxvY2FsQ29udmVyc2F0aW9uTGlzdCBjb3N0IFwiKS5jb25jYXQoRGF0ZS5ub3coKS1zLFwiIG1zXCIpKX19LHtrZXk6XCJfZ2V0VG1wQ29udmVyc2F0aW9uTGlzdE1hcHBpbmdcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5jb252ZXJzYXRpb25PcHRpb25zTGlzdCxuPWUuaXNGcm9tR2V0Q29udmVyc2F0aW9ucyxvPWUuaXNJbnN0YW50TWVzc2FnZSxzPWUuaXNVbnJlYWRDMkNNZXNzYWdlLGE9dm9pZCAwIT09cyYmcyxpPWUudXBkYXRlVW5yZWFkQ291bnQscj1bXSx1PVtdLGM9dGhpcy5nZXRNb2R1bGUoUG4pLGw9dGhpcy5nZXRNb2R1bGUoYm4pLGQ9dGhpcy5pc0ludGwoKSxwPTAsZz10Lmxlbmd0aDtwPGc7cCsrKXt2YXIgaD1uZXcgZmkodFtwXSxkKSxfPWguY29udmVyc2F0aW9uSUQ7aWYoXyE9PVwiXCIuY29uY2F0KEUuQ09OVl9DMkMsXCJAVExTI0VSUk9SXCIpJiZfIT09XCJcIi5jb25jYXQoRS5DT05WX0MyQyxcIkBUTFMjTk9UX0ZPVU5EXCIpKWlmKHRoaXMuX2NvbnZlcnNhdGlvbk1hcC5oYXMoXykpe3ZhciBmPXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5nZXQoXyksdj1bXCJ1bnJlYWRDb3VudFwiLFwiYWxsb3dUeXBlXCIsXCJhZG1pbkZvcmJpZFR5cGVcIixcInBheWxvYWRcIixcImlzUGlubmVkXCJdOyExPT09byYmdi5wdXNoKFwibGFzdE1lc3NhZ2VcIik7dmFyIG09dFtwXS5sYXN0TWVzc2FnZSxNPSFpdChtKTtNfHx0W3BdLnR5cGU9PT1FLkNPTlZfVE9QSUN8fHRoaXMuX29uTGFzdE1lc3NhZ2VOb3RFeGlzdCh0W3BdKSxpdChvKSYmTSYmbnVsbD09PWYubGFzdE1lc3NhZ2UucGF5bG9hZCYmKGYubGFzdE1lc3NhZ2UucGF5bG9hZD1tLnBheWxvYWQpLHp0KGYubGFzdE1lc3NhZ2UucmV2b2tlcil8fChmLmxhc3RNZXNzYWdlLnJldm9rZXI9bnVsbCkscHQoZixoLHYsW251bGwsdm9pZCAwLFwiXCIsMCxOYU5dKSwhMD09PWkmJmYudXBkYXRlVW5yZWFkQ291bnQoe25leHRVbnJlYWRDb3VudDpoLnVucmVhZENvdW50LGlzRnJvbUdldENvbnZlcnNhdGlvbnM6bixpc1VucmVhZEMyQ01lc3NhZ2U6YX0pLG8mJk0mJihtLnBheWxvYWQmJihmLmxhc3RNZXNzYWdlLnBheWxvYWQ9bS5wYXlsb2FkKSxmLnR5cGU9PT1FLkNPTlZfR1JPVVAmJihmLmxhc3RNZXNzYWdlLm5hbWVDYXJkPW0ubmFtZUNhcmQsZi5sYXN0TWVzc2FnZS5uaWNrPW0ubmljaykpLE0mJmYubGFzdE1lc3NhZ2UuY2xvdWRDdXN0b21EYXRhIT09bS5jbG91ZEN1c3RvbURhdGEmJihmLmxhc3RNZXNzYWdlLmNsb3VkQ3VzdG9tRGF0YT1tLmNsb3VkQ3VzdG9tRGF0YXx8XCJcIiksdGhpcy5fY29udmVyc2F0aW9uTWFwLmRlbGV0ZShfKSxyLnB1c2goW18sZl0pfWVsc2V7aWYoaC50eXBlPT09RS5DT05WX0dST1VQJiZjKXt2YXIgeT1oLmdyb3VwUHJvZmlsZS5ncm91cElELEk9Yy5nZXRMb2NhbEdyb3VwUHJvZmlsZSh5KTtJJiYoaC5ncm91cFByb2ZpbGU9SSwhMD09PWkmJmgudXBkYXRlVW5yZWFkQ291bnQoe25leHRVbnJlYWRDb3VudDowfSkpfWVsc2UgaWYoaC50eXBlPT09RS5DT05WX0MyQyl7dmFyIEM9Xy5yZXBsYWNlKEUuQ09OVl9DMkMsXCJcIik7bCYmbC5pc015RnJpZW5kKEMpJiYoaC5yZW1hcms9bC5nZXRGcmllbmRSZW1hcmsoQykpfXUucHVzaChoKSxyLnB1c2goW18saF0pfX12YXIgVD10aGlzLmdldE1vZHVsZShGbik7cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYoZVsxXS50eXBlPT09RS5DT05WX1RPUElDKXt2YXIgdD1lWzFdLG49dC5jb252ZXJzYXRpb25JRCxvPXQudW5yZWFkQ291bnQscz10Lmdyb3VwQXRJbmZvTGlzdDtULm9uQ29udmVyc2F0aW9uUHJveHkoe3RvcGljSUQ6bi5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKSx1bnJlYWRDb3VudDpvLGdyb3VwQXRJbmZvTGlzdDp6dChzKT92b2lkIDA6c30pfX0pKSx7dG9CZVVwZGF0ZWRDb252ZXJzYXRpb25MaXN0OnIsbmV3Q29udmVyc2F0aW9uTGlzdDp1fX19LHtrZXk6XCJfb25MYXN0TWVzc2FnZU5vdEV4aXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7bmV3IEFhKFwibGFzdE1lc3NhZ2VOb3RFeGlzdFwiKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KEpTT04uc3RyaW5naWZ5KGUpKSkuc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKX19LHtrZXk6XCJfc29ydENvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1bXSxuPVtdLG89W10scz1bXTtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXshMD09PWVbMV0uaXNQaW5uZWQ/enQoZVsxXS5sYXN0TWVzc2FnZS5sYXN0VGltZSk/bi5wdXNoKGUpOnQucHVzaChlKTp6dChlWzFdLmxhc3RNZXNzYWdlLmxhc3RUaW1lKT9zLnB1c2goZSk6by5wdXNoKGUpfSkpLHQuc29ydCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gdFsxXS5sYXN0TWVzc2FnZS5sYXN0VGltZS1lWzFdLmxhc3RNZXNzYWdlLmxhc3RUaW1lfSkpLmNvbmNhdChuKS5jb25jYXQoby5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybiB0WzFdLmxhc3RNZXNzYWdlLmxhc3RUaW1lLWVbMV0ubGFzdE1lc3NhZ2UubGFzdFRpbWV9KSkpLmNvbmNhdChzKX19LHtrZXk6XCJfc29ydENvbnZlcnNhdGlvbkxpc3RBbmRFbWl0RXZlbnRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2NvbnZlcnNhdGlvbk1hcD1uZXcgTWFwKHRoaXMuX3NvcnRDb252ZXJzYXRpb25MaXN0KG0odGhpcy5fY29udmVyc2F0aW9uTWFwKSkpLHRoaXMuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSl9fSx7a2V5OlwiX3VwZGF0ZVVzZXJPckdyb3VwUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoMCE9PWUubGVuZ3RoKXt2YXIgbj1bXSxvPVtdLHM9dGhpcy5nZXRNb2R1bGUoR24pLGE9dGhpcy5nZXRNb2R1bGUoUG4pO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYoZS50eXBlPT09RS5DT05WX0MyQyluLnB1c2goZS50b0FjY291bnQpO2Vsc2UgaWYoZS50eXBlPT09RS5DT05WX0dST1VQKXt2YXIgdD1lLnRvQWNjb3VudDthLmhhc0xvY2FsR3JvdXAodCk/ZS5ncm91cFByb2ZpbGU9YS5nZXRMb2NhbEdyb3VwUHJvZmlsZSh0KTpvLnB1c2godCl9fSkpLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fdXBkYXRlVXNlck9yR3JvdXBQcm9maWxlIGMyY1VzZXJJRExpc3Q6XCIpLmNvbmNhdChuLFwiIGdyb3VwSURMaXN0OlwiKS5jb25jYXQobykpLG4ubGVuZ3RoPjAmJnMuZ2V0VXNlclByb2ZpbGUoe3VzZXJJRExpc3Q6bn0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBuPWUuZGF0YTthdChuKT9uLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2RvVXBkYXRlVXNlclByb2ZpbGUoXCJDMkNcIi5jb25jYXQoZS51c2VySUQpLGUpfSkpOnQuX2RvVXBkYXRlVXNlclByb2ZpbGUoXCJDMkNcIi5jb25jYXQobi51c2VySUQpLG4pfSkpLG8ubGVuZ3RoPjAmJmEuZ2V0R3JvdXBQcm9maWxlQWR2YW5jZSh7Z3JvdXBJRExpc3Q6byxyZXNwb25zZUZpbHRlcjp7Z3JvdXBCYXNlSW5mb0ZpbHRlcjpbXCJUeXBlXCIsXCJOYW1lXCIsXCJGYWNlVXJsXCJdfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe2UuZGF0YS5zdWNjZXNzR3JvdXBMaXN0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPVwiR1JPVVBcIi5jb25jYXQoZS5ncm91cElEKTtpZih0Ll9jb252ZXJzYXRpb25NYXAuaGFzKG4pKXt2YXIgbz10Ll9jb252ZXJzYXRpb25NYXAuZ2V0KG4pO3B0KG8uZ3JvdXBQcm9maWxlLGUsW10sW251bGwsdm9pZCAwLFwiXCIsMCxOYU5dKSwhby5zdWJUeXBlJiZlLnR5cGUmJihvLnN1YlR5cGU9ZS50eXBlKX19KSl9KSl9fX0se2tleTpcIl9kb1VwZGF0ZVVzZXJQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLmhhc0xvY2FsQ29udmVyc2F0aW9uKGUpJiYodGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbihlKS51c2VyUHJvZmlsZT10KX19LHtrZXk6XCJfZ2V0Q29udmVyc2F0aW9uT3B0aW9uc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1bXSxzPWUuZmlsdGVyKChmdW5jdGlvbihlKXt2YXIgdD1lLnR5cGUsbj1lLnVzZXJJRDtyZXR1cm4gMT09PXQmJlwiQFRMUyNOT1RfRk9VTkRcIiE9PW4mJlwiQFRMUyNFUlJPUlwiIT09bnx8Mj09PXR9KSksYT10aGlzLmdldE15VXNlcklEKCksaT1zLm1hcCgoZnVuY3Rpb24oZSl7aWYoaXQoZS5sYXN0TXNnKSYmKGUubGFzdE1zZz17ZWxlbWVudHM6W119KSwxPT09ZS50eXBlKXt2YXIgcz17dXNlcklEOmUudXNlcklELG5pY2s6ZS5wZWVyTmljayxhdmF0YXI6ZS5wZWVyQXZhdGFyfTtyZXR1cm4gby5wdXNoKHMpLHtjb252ZXJzYXRpb25JRDpcIkMyQ1wiLmNvbmNhdChlLnVzZXJJRCksdHlwZTpcIkMyQ1wiLGxhc3RNZXNzYWdlOntsYXN0VGltZTplLnRpbWUsbGFzdFNlcXVlbmNlOmUuc2VxdWVuY2UsZnJvbUFjY291bnQ6ZS5sYXN0QzJDTXNnRnJvbUFjY291bnQsbWVzc2FnZUZvclNob3c6ZS5tZXNzYWdlU2hvdyx0eXBlOmUubGFzdE1zZy5lbGVtZW50c1swXT9lLmxhc3RNc2cuZWxlbWVudHNbMF0udHlwZTpudWxsLHBheWxvYWQ6ZS5sYXN0TXNnLmVsZW1lbnRzWzBdP24uX2FtZW5kTGF5ZXJzT3ZlckxpbWl0UHJvcGVydHkoZS5sYXN0TXNnLmVsZW1lbnRzWzBdLmNvbnRlbnQpOm51bGwsY2xvdWRDdXN0b21EYXRhOmUubGFzdE1zZy5jbG91ZEN1c3RvbURhdGF8fFwiXCIsaXNSZXZva2VkOjg9PT1lLmxhc3RNZXNzYWdlRmxhZyxvbmxpbmVPbmx5RmxhZzohMSxuaWNrOlwiXCIsbmFtZUNhcmQ6XCJcIix2ZXJzaW9uOjAsaXNQZWVyUmVhZDplLmxhc3RDMkNNc2dGcm9tQWNjb3VudD09PWEmJmUudGltZTw9ZS5jMmNQZWVyUmVhZFRpbWUscmV2b2tlcjplLmxhc3RNc2cucmV2b2tlckluZm8/ZS5sYXN0TXNnLnJldm9rZXJJbmZvLnJldm9rZXI6bnVsbH0sdXNlclByb2ZpbGU6bmV3IGxpKHMpLHBlZXJSZWFkVGltZTplLmMyY1BlZXJSZWFkVGltZSxpc1Bpbm5lZDoxPT09ZS5pc1Bpbm5lZCxtZXNzYWdlUmVtaW5kVHlwZTpcIlwiLGN1c3RvbURhdGE6ZS5jdXN0b21NYXJrfHxcIlwiLG1hcmtMaXN0Okh0KGUuc3RhbmRhcmRNYXJrKSxjb252ZXJzYXRpb25Hcm91cExpc3Q6bi5fY29udkdyb3VwSGFuZGxlci5nZXRDb252R3JvdXBMaXN0QnlJRChlLmNvbnRhY3RHcm91cElkKX19cmV0dXJue2NvbnZlcnNhdGlvbklEOlwiR1JPVVBcIi5jb25jYXQoZS5ncm91cElEKSx0eXBlOlwiR1JPVVBcIixsYXN0TWVzc2FnZTp0KHQoe2xhc3RUaW1lOmUudGltZSxsYXN0U2VxdWVuY2U6ZS5zZXF1ZW5jZSxmcm9tQWNjb3VudDplLm1zZ0dyb3VwRnJvbUFjY291bnQsbWVzc2FnZUZvclNob3c6ZS5tZXNzYWdlU2hvd30sbi5fcGF0Y2hUeXBlQW5kUGF5bG9hZChlKSkse30se2Nsb3VkQ3VzdG9tRGF0YTplLmxhc3RNc2cuY2xvdWRDdXN0b21EYXRhfHxcIlwiLGlzUmV2b2tlZDoyPT09ZS5sYXN0TWVzc2FnZUZsYWcsb25saW5lT25seUZsYWc6ITEsbmljazplLnNlbmRlck5pY2t8fFwiXCIsbmFtZUNhcmQ6ZS5zZW5kZXJOYW1lQ2FyZHx8XCJcIixyZXZva2VyOmUubGFzdE1zZy5yZXZva2VySW5mbz9lLmxhc3RNc2cucmV2b2tlckluZm8ucmV2b2tlcjpudWxsfSksZ3JvdXBQcm9maWxlOm5ldyBoaSh7Z3JvdXBJRDplLmdyb3VwSUQsbmFtZTplLmdyb3VwTmljayxhdmF0YXI6ZS5ncm91cEltYWdlfSksdW5yZWFkQ291bnQ6ZS51bnJlYWRDb3VudCxwZWVyUmVhZFRpbWU6MCxpc1Bpbm5lZDoxPT09ZS5pc1Bpbm5lZCxtZXNzYWdlUmVtaW5kVHlwZTpcIlwiLHZlcnNpb246MCxjdXN0b21EYXRhOmUuY3VzdG9tTWFya3x8XCJcIixtYXJrTGlzdDpIdChlLnN0YW5kYXJkTWFyayksY29udmVyc2F0aW9uR3JvdXBMaXN0Om4uX2NvbnZHcm91cEhhbmRsZXIuZ2V0Q29udkdyb3VwTGlzdEJ5SUQoZS5jb250YWN0R3JvdXBJZCl9fSkpO28ubGVuZ3RoPjAmJnRoaXMuZ2V0TW9kdWxlKEduKS5vbkNvbnZlcnNhdGlvbnNQcm9maWxlVXBkYXRlZChvKTtyZXR1cm4gaX19LHtrZXk6XCJfcGF0Y2hUeXBlQW5kUGF5bG9hZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPWUubGFzdE1zZyxvPW4uZXZlbnQscz12b2lkIDA9PT1vP3ZvaWQgMDpvLGE9bi5lbGVtZW50cyxpPXZvaWQgMD09PWE/W106YSxyPW4uZ3JvdXBUaXBzLHU9dm9pZCAwPT09cj97fTpyO2lmKCFpdChzKSYmIXp0KHUpKXt2YXIgYz1uZXcgV2EodSk7Yy5zZXRFbGVtZW50KHt0eXBlOkUuTVNHX0dSUF9USVAsY29udGVudDp0KHQoe30sdS5lbGVtZW50cykse30se2dyb3VwUHJvZmlsZTp1Lmdyb3VwUHJvZmlsZX0pfSk7dmFyIGw9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjLnBheWxvYWQpKTtyZXR1cm4gYz1udWxsLHt0eXBlOkUuTVNHX0dSUF9USVAscGF5bG9hZDpsfX1yZXR1cm57dHlwZTppWzBdP2lbMF0udHlwZTpudWxsLHBheWxvYWQ6aVswXT90aGlzLl9hbWVuZExheWVyc092ZXJMaW1pdFByb3BlcnR5KGlbMF0uY29udGVudCk6bnVsbH19fSx7a2V5OlwiX2FtZW5kTGF5ZXJzT3ZlckxpbWl0UHJvcGVydHlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmxheWVyc092ZXJMaW1pdDtyZXR1cm4gMD09PXQ/ZS5sYXllcnNPdmVyTGltaXQ9ITE6MT09PXQmJihlLmxheWVyc092ZXJMaW1pdD0hMCksZX19LHtrZXk6XCJnZXRMb2NhbE1lc3NhZ2VMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5nZXRMb2NhbE1lc3NhZ2VMaXN0KGUpfX0se2tleTpcImRlbGV0ZUxvY2FsTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UgaW5zdGFuY2VvZiBXYSYmdGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLnJlbW92ZShlKX19LHtrZXk6XCJvbkNvbnZlcnNhdGlvbkRlbGV0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihhdChlKSl7dmFyIHQ9ZS5tYXAoKGZ1bmN0aW9uKGUpe3ZhciB0PWUudHlwZSxuPWUudXNlcklELG89ZS5ncm91cElEO3JldHVybiAxPT09dD9cIlwiLmNvbmNhdChFLkNPTlZfQzJDKS5jb25jYXQobik6Mj09PXQ/XCJcIi5jb25jYXQoRS5DT05WX0dST1VQKS5jb25jYXQobyk6dm9pZCAwfSkpO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkNvbnZlcnNhdGlvbkRlbGV0ZWQgY29udmVyc2F0aW9uSURMaXN0OlwiKS5jb25jYXQodCkpLHRoaXMuZGVsZXRlTG9jYWxDb252ZXJzYXRpb25MaXN0KHQpfX19LHtrZXk6XCJvbkNvbnZlcnNhdGlvblBpbm5lZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoYXQoZSkpe3ZhciBuPSExO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG8scz1lLnR5cGUsYT1lLnVzZXJJRCxpPWUuZ3JvdXBJRDsxPT09cz9vPXQuZ2V0TG9jYWxDb252ZXJzYXRpb24oXCJcIi5jb25jYXQoRS5DT05WX0MyQykuY29uY2F0KGEpKToyPT09cyYmKG89dC5nZXRMb2NhbENvbnZlcnNhdGlvbihcIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChpKSkpLG8mJihWZS5sKFwiXCIuY29uY2F0KHQuX24sXCIub25Db252ZXJzYXRpb25QaW5uZWQgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChvLmNvbnZlcnNhdGlvbklELFwiIGlzUGlubmVkOlwiKS5jb25jYXQoby5pc1Bpbm5lZCkpLG8uaXNQaW5uZWR8fChvLmlzUGlubmVkPSEwLG49ITApKX0pKSxuJiZ0aGlzLl9zb3J0Q29udmVyc2F0aW9uTGlzdEFuZEVtaXRFdmVudCgpfX19LHtrZXk6XCJvbkNvbnZlcnNhdGlvblVucGlubmVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZihhdChlKSl7dmFyIG49ITE7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgbyxzPWUudHlwZSxhPWUudXNlcklELGk9ZS5ncm91cElEOzE9PT1zP289dC5nZXRMb2NhbENvbnZlcnNhdGlvbihcIlwiLmNvbmNhdChFLkNPTlZfQzJDKS5jb25jYXQoYSkpOjI9PT1zJiYobz10LmdldExvY2FsQ29udmVyc2F0aW9uKFwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KGkpKSksbyYmKFZlLmwoXCJcIi5jb25jYXQodC5fbixcIi5vbkNvbnZlcnNhdGlvblVucGlubmVkIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQoby5jb252ZXJzYXRpb25JRCxcIiBpc1Bpbm5lZDpcIikuY29uY2F0KG8uaXNQaW5uZWQpKSxvLmlzUGlubmVkJiYoby5pc1Bpbm5lZD0hMSxuPSEwKSl9KSksbiYmdGhpcy5fc29ydENvbnZlcnNhdGlvbkxpc3RBbmRFbWl0RXZlbnQoKX19fSx7a2V5OlwiZ2V0TWVzc2FnZUxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5jb252ZXJzYXRpb25JRCxvPWUubmV4dFJlcU1lc3NhZ2VJRCxzPWUuY291bnQsYT1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldE1lc3NhZ2VMaXN0XCIpLGk9dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbihuKSxyPVwiXCI7aWYoaSYmaS5ncm91cFByb2ZpbGUmJihyPWkuZ3JvdXBQcm9maWxlLnR5cGUpLFR0KHIpKXJldHVybiBWZS5sKFwiXCIuY29uY2F0KGEsXCIgbm90IGF2YWlsYWJsZSBpbiBhdmNoYXRyb29tLiBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KG4pKSxYYSh7bWVzc2FnZUxpc3Q6W10sbmV4dFJlcU1lc3NhZ2VJRDpcIlwiLGlzQ29tcGxldGVkOiEwfSk7KGl0KHMpfHxzPjE1KSYmKHM9MTUpLCFvJiZ0aGlzLl9pc05vdEluQ29tbXVuaXR5KG4pJiYodGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLnJlbW92ZUJ5Q29udmVyc2F0aW9uSUQobiksdGhpcy5fY29tcGxldGVkTWFwLmRlbGV0ZShuKSx0aGlzLl9yb2FtaW5nTWVzc2FnZVNlcXVlbmNlTWFwLmRlbGV0ZShuKSk7dmFyIHU9dGhpcy5fY29tcHV0ZVJlbWFpbmluZ0NvdW50KHtjb252ZXJzYXRpb25JRDpuLG5leHRSZXFNZXNzYWdlSUQ6b30pLGM9dGhpcy5fY29tcGxldGVkTWFwLmhhcyhuKTtpZihWZS5sKFwiXCIuY29uY2F0KGEsXCIgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChuLFwiIG5leHRSZXFNZXNzYWdlSUQ6XCIpLmNvbmNhdChvKStcIiByZW1haW5pbmdDb3VudDpcIi5jb25jYXQodSxcIiBjb3VudDpcIikuY29uY2F0KHMsXCIgaXNDb21wbGV0ZWQ6XCIpLmNvbmNhdChjKSksdGhpcy5fbmVlZEdldEhpc3Rvcnkoe2NvbnZlcnNhdGlvbklEOm4scmVtYWluaW5nQ291bnQ6dSxjb3VudDpzfSkpcmV0dXJuIHRoaXMuZ2V0SGlzdG9yeU1lc3NhZ2VzKHtjb252ZXJzYXRpb25JRDpuLG5leHRSZXFNZXNzYWdlSUQ6byxjb3VudDoyMH0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBvPWUubmV4dFJlcUlELHM9ZS5zdG9yZWRNZXNzYWdlTGlzdCxpPXQuX2NvbXBsZXRlZE1hcC5oYXMobikscj1zO3U+MCYmKHI9dC5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTWVzc2FnZUxpc3Qobikuc2xpY2UoMCxzLmxlbmd0aCt1KSk7dmFyIGM9e25leHRSZXFNZXNzYWdlSUQ6aT9cIlwiOm8sbWVzc2FnZUxpc3Q6cixpc0NvbXBsZXRlZDppfTtyZXR1cm4gVmUubChcIlwiLmNvbmNhdChhLFwiIHJldC5uZXh0UmVxTWVzc2FnZUlEOlwiKS5jb25jYXQoYy5uZXh0UmVxTWVzc2FnZUlELFwiIHJldC5pc0NvbXBsZXRlZDpcIikuY29uY2F0KGMuaXNDb21wbGV0ZWQsXCIgcmV0Lmxlbmd0aDpcIikuY29uY2F0KHIubGVuZ3RoKSksWWEoYyl9KSk7dGhpcy5tb2RpZnlNZXNzYWdlTGlzdChuKTt2YXIgbD10aGlzLl9nZXRNZXNzYWdlTGlzdEZyb21NZW1vcnkoe2NvbnZlcnNhdGlvbklEOm4sbmV4dFJlcU1lc3NhZ2VJRDpvLGNvdW50OnN9KTtyZXR1cm4gWGEobCl9fSx7a2V5OlwiX2dldE1lc3NhZ2VMaXN0RnJvbU1lbW9yeVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuY29udmVyc2F0aW9uSUQsbj1lLm5leHRSZXFNZXNzYWdlSUQsbz1lLmNvdW50LHM9XCJcIi5jb25jYXQodGhpcy5fbixcIi5fZ2V0TWVzc2FnZUxpc3RGcm9tTWVtb3J5XCIpLGE9dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTWVzc2FnZUxpc3QodCksaT1hLmxlbmd0aCxyPTAsdT17aXNDb21wbGV0ZWQ6ITEsbmV4dFJlcU1lc3NhZ2VJRDpcIlwiLG1lc3NhZ2VMaXN0OltdfTtyZXR1cm4gbj8ocj1hLmZpbmRJbmRleCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuSUQ9PT1ufSkpKT5vPyh1Lm1lc3NhZ2VMaXN0PWEuc2xpY2Uoci1vLHIpLHUubmV4dFJlcU1lc3NhZ2VJRD1hW3Itb10uSUQpOih1Lm1lc3NhZ2VMaXN0PWEuc2xpY2UoMCxyKSx1LmlzQ29tcGxldGVkPSEwKTppPm8/KHI9aS1vLHUubWVzc2FnZUxpc3Q9YS5zbGljZShyLGkpLHUubmV4dFJlcU1lc3NhZ2VJRD1hW3JdLklEKToodS5tZXNzYWdlTGlzdD1hLnNsaWNlKDAsaSksdS5pc0NvbXBsZXRlZD0hMCksVmUubChcIlwiLmNvbmNhdChzLFwiIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQodCkrXCIgcmV0Lm5leHRSZXFNZXNzYWdlSUQ6XCIuY29uY2F0KHUubmV4dFJlcU1lc3NhZ2VJRCxcIiByZXQuaXNDb21wbGV0ZWQ6XCIpLmNvbmNhdCh1LmlzQ29tcGxldGVkLFwiIHJldC5sZW5ndGg6XCIpLmNvbmNhdCh1Lm1lc3NhZ2VMaXN0Lmxlbmd0aCkpLHV9fSx7a2V5OlwiZ2V0TWVzc2FnZUxpc3RIb3BwaW5nXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPWUuc2VxdWVuY2Usbz1lLnRpbWUscz1lLmNvdW50LGE9ZS5kaXJlY3Rpb24saT12b2lkIDA9PT1hPzA6YTtpZigoaXQocyl8fHM+MTUpJiYocz0xNSksdC5zdGFydHNXaXRoKEUuQ09OVl9DMkMpKXt2YXIgcj10aGlzLmdldE1vZHVsZShVbiksdT10LnJlcGxhY2UoRS5DT05WX0MyQyxcIlwiKTtyZXR1cm4gci5nZXRSb2FtaW5nTWVzc2FnZXNIb3BwaW5nKHtwZWVyQWNjb3VudDp1LHRpbWU6byxjb3VudDpzLGRpcmVjdGlvbjppfSl9aWYodC5zdGFydHNXaXRoKEUuQ09OVl9HUk9VUCkpe3ZhciBjPXRoaXMuZ2V0TW9kdWxlKFBuKSxsPXQucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIik7cmV0dXJuIGMuZ2V0Um9hbWluZ01lc3NhZ2VzSG9wcGluZyh7Z3JvdXBJRDpsLHNlcXVlbmNlOm4sY291bnQ6cyxkaXJlY3Rpb246aX0pfX19LHtrZXk6XCJfY29tcHV0ZVJlbWFpbmluZ0NvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPWUubmV4dFJlcU1lc3NhZ2VJRCxvPXRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5nZXRMb2NhbE1lc3NhZ2VMaXN0KHQpLHM9by5sZW5ndGg7aWYoIW4pcmV0dXJuIHM7dmFyIGE9MDtyZXR1cm4gRXQodCk/YT1vLmZpbmRJbmRleCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuSUQ9PT1ufSkpOlN0KHQpJiYoYT0tMSE9PW4uaW5kZXhPZihcIi1cIik/by5maW5kSW5kZXgoKGZ1bmN0aW9uKGUpe3JldHVybiBlLklEPT09bn0pKTpvLmZpbmRJbmRleCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuc2VxdWVuY2U9PT1ufSkpKSwtMT09PWEmJihhPTApLGF9fSx7a2V5OlwiX2dldE1lc3NhZ2VMaXN0U2l6ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TG9jYWxNZXNzYWdlTGlzdChlKS5sZW5ndGh9fSx7a2V5OlwiX25lZWRHZXRIaXN0b3J5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPWUucmVtYWluaW5nQ291bnQsbz1lLmNvdW50LHM9dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbih0KSxhPVwiXCI7cmV0dXJuIHMmJnMuZ3JvdXBQcm9maWxlJiYoYT1zLmdyb3VwUHJvZmlsZS50eXBlKSwhTHQodCkmJiFUdChhKSYmKCEoU3QodCkmJnRoaXMuX2lzUGFnaW5nR2V0R3JvdXBMaXN0Q29tcGxldGVkKCkmJnRoaXMuX2dldExvY2FsR3JvdXBDb3VudCgpPD00ZTMmJiF0aGlzLl9oYXNMb2NhbEdyb3VwKHQpJiYhdGhpcy5faXNUb3BpY0NvbnZlcnNhdGlvbih0KSkmJihuPD1vJiYhdGhpcy5fY29tcGxldGVkTWFwLmhhcyh0KSkpfX0se2tleTpcIl9pc1RvcGljQ29udmVyc2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKTtyZXR1cm4ga3QodCl9fSx7a2V5OlwiZ2V0SGlzdG9yeU1lc3NhZ2VzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPWUuY291bnQ7aWYodD09PUUuQ09OVl9TWVNURU0pcmV0dXJuIFhhKCk7dmFyIG89MTU7bj4yMCYmKG89MjApO3ZhciBzPW51bGw7aWYoRXQodCkpe3ZhciBhPXRoaXMuX3JvYW1pbmdNZXNzYWdlS2V5QW5kVGltZU1hcC5oYXModCk7cmV0dXJuKHM9dGhpcy5nZXRNb2R1bGUoVW4pKT9zLmdldFJvYW1pbmdNZXNzYWdlKHtjb252ZXJzYXRpb25JRDp0LHBlZXJBY2NvdW50OnQucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpLGNvdW50Om8sbGFzdE1lc3NhZ2VUaW1lOmE/dGhpcy5fcm9hbWluZ01lc3NhZ2VLZXlBbmRUaW1lTWFwLmdldCh0KS5sYXN0TWVzc2FnZVRpbWU6MCxtZXNzYWdlS2V5OmE/dGhpcy5fcm9hbWluZ01lc3NhZ2VLZXlBbmRUaW1lTWFwLmdldCh0KS5tZXNzYWdlS2V5OlwiXCJ9KTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX1pZihTdCh0KSl7aWYoIShzPXRoaXMuZ2V0TW9kdWxlKFBuKSkpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX01PRFVMRX0pO3ZhciBpPW51bGw7dGhpcy5fY29udmVyc2F0aW9uTWFwLmhhcyh0KSYmKGk9dGhpcy5fY29udmVyc2F0aW9uTWFwLmdldCh0KS5sYXN0TWVzc2FnZSk7dmFyIHI9MDtpJiYocj1pLmxhc3RTZXF1ZW5jZSk7dmFyIHU9dGhpcy5fcm9hbWluZ01lc3NhZ2VTZXF1ZW5jZU1hcC5nZXQodCk7cmV0dXJuIHMuZ2V0Um9hbWluZ01lc3NhZ2Uoe2NvbnZlcnNhdGlvbklEOnQsZ3JvdXBJRDp0LnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpLGNvdW50Om8sc2VxdWVuY2U6dXx8cn0pfXJldHVybiBYYSgpfX0se2tleTpcInBhdGNoQ29udmVyc2F0aW9uTGFzdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldExvY2FsQ29udmVyc2F0aW9uKGUpO2lmKHQpe3ZhciBuPXQubGFzdE1lc3NhZ2Usbz1uLm1lc3NhZ2VGb3JTaG93LHM9bi5wYXlsb2FkO2lmKHp0KG8pfHx6dChzKSl7dmFyIGE9dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTWVzc2FnZUxpc3QoZSk7aWYoMD09PWEubGVuZ3RoKXJldHVybjt2YXIgaT1hW2EubGVuZ3RoLTFdO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5wYXRjaENvbnZlcnNhdGlvbkxhc3RNZXNzYWdlIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQoZSxcIiBwYXlsb2FkOlwiKSxpLnBheWxvYWQpLHQudXBkYXRlTGFzdE1lc3NhZ2UoaSl9fX19LHtrZXk6XCJvblJvYW1pbmdNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06W10sbj1hcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCxvPSEoYXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0pfHxhcmd1bWVudHNbMl0scz1uLnN0YXJ0c1dpdGgoRS5DT05WX0MyQyk/RS5DT05WX0MyQzpFLkNPTlZfR1JPVVAsYT1udWxsLGk9W10scj1bXSx1PTAsYz1lLmxlbmd0aCxsPW51bGwsZD1zPT09RS5DT05WX0dST1VQLHA9dGhpcy5nZXRNb2R1bGUoS24pLGc9dGhpcy5nZXRGaWxlRG93bmxvYWRQcm94eSgpLGg9ZnVuY3Rpb24oKXt1PWQ/ZS5sZW5ndGgtMTowLGM9ZD8wOmUubGVuZ3RofSxfPWZ1bmN0aW9uKCl7ZD8tLXU6Kyt1fSxmPWZ1bmN0aW9uKCl7cmV0dXJuIGQ/dT49Yzp1PGN9O2ZvcihoKCk7ZigpO18oKSlpZihkJiYxPT09ZVt1XS5zZXF1ZW5jZSYmbyYmdGhpcy5zZXRDb21wbGV0ZWQobiksMSE9PWVbdV0uaXNQbGFjZU1lc3NhZ2UpaWYoKGE9bmV3IFdhKGVbdV0pKS50bz1lW3VdLnRvLHMhPT1FLkNPTlZfR1JPVVB8fGl0KGVbdV0udG9waWNJRCl8fChhLnRvPWVbdV0udG9waWNJRCksYS5pc1N5c3RlbU1lc3NhZ2U9ISFlW3VdLmlzU3lzdGVtTWVzc2FnZSxhLmNvbnZlcnNhdGlvblR5cGU9cyw0PT09ZVt1XS5ldmVudD9sPXt0eXBlOkUuTVNHX0dSUF9USVAsY29udGVudDp0KHQoe30sZVt1XS5lbGVtZW50cykse30se2dyb3VwUHJvZmlsZTplW3VdLmdyb3VwUHJvZmlsZX0pfTooZVt1XS5lbGVtZW50cz1wLnBhcnNlRWxlbWVudHMoZVt1XS5lbGVtZW50cyxlW3VdLmZyb20pLGw9ZVt1XS5lbGVtZW50cyksZHx8YS5zZXROaWNrQW5kQXZhdGFyKHtuaWNrOmVbdV0ubmljayxhdmF0YXI6ZVt1XS5hdmF0YXJ9KSx6dChsKSl7dmFyIHY9bmV3IEFhKFwiZW1wdHlNZXNzYWdlQm9keVwiKTt2LnNldE1lc3NhZ2UoXCJmcm9tOlwiLmNvbmNhdChhLmZyb20sXCIgdG86XCIpLmNvbmNhdChhLnRvLFwiIHNlcXVlbmNlOlwiKS5jb25jYXQoYS5zZXF1ZW5jZSxcIiBldmVudDpcIikuY29uY2F0KGVbdV0uZXZlbnQpKSx2LnNldE5ldHdvcmtUeXBlKHRoaXMuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TGV2ZWwoXCJ3YXJuaW5nXCIpLmVuZCgpfWVsc2UgYS5zZXRFbGVtZW50KGwsZyksYS5yZUluaXRpYWxpemUodGhpcy5nZXRNeVVzZXJJRCgpKSxpLnB1c2goYSk7cmV0dXJuIGg9Xz1mPW51bGwsbz8odGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLnVuc2hpZnQoaSxyKSxpPW51bGwscik6KHI9bnVsbCxpKX19LHtrZXk6XCJmaW5kTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZmluZE1lc3NhZ2UoZSl9fSx7a2V5OlwiX2lzTm90SW5Db21tdW5pdHlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0hMTtpZihlLnN0YXJ0c1dpdGgoRS5DT05WX0dST1VQKSYmdGhpcy5faXNUb3BpY0NvbnZlcnNhdGlvbihlKSl7dmFyIG49eHQoZS5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKSk7dGhpcy5nZXRNb2R1bGUoUG4pLmhhc0xvY2FsR3JvdXAobil8fCh0PSEwKX1yZXR1cm4gdH19LHtrZXk6XCJkZWxldGVUb3BpY1JvYW1pbmdNZXNzYWdlSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7RHQoe2dyb3VwSUQ6ZX0pJiZ0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0VG9waWNDb252ZXJzYXRpb25JRExpc3QoZSkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dC5fbWVzc2FnZUxpc3RIYW5kbGVyLnJlbW92ZUJ5Q29udmVyc2F0aW9uSUQoZSksdC5fY29tcGxldGVkTWFwLmRlbGV0ZShlKSx0Ll9yb2FtaW5nTWVzc2FnZVNlcXVlbmNlTWFwLmRlbGV0ZShlKX0pKX19LHtrZXk6XCJkZWxldGVHcm91cFJvbWFpbmdNZXNzYWdlSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KGUpO3RoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5yZW1vdmVCeUNvbnZlcnNhdGlvbklEKHQpLHRoaXMuX2NvbXBsZXRlZE1hcC5kZWxldGUodCksdGhpcy5fcm9hbWluZ01lc3NhZ2VTZXF1ZW5jZU1hcC5kZWxldGUodCl9fSx7a2V5Olwic2V0TWVzc2FnZVJlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmNvbnZlcnNhdGlvbklELG49dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbih0KTtpZihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuc2V0TWVzc2FnZVJlYWQgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdCh0LFwiIHVucmVhZENvdW50OlwiKS5jb25jYXQobj9uLnVucmVhZENvdW50OjApKSwhbilyZXR1cm4gWGEoKTtpZihuLnR5cGUhPT1FLkNPTlZfR1JPVVAmJm4udHlwZSE9PUUuQ09OVl9UT1BJQ3x8enQobi5ncm91cEF0SW5mb0xpc3QpfHx0aGlzLmRlbGV0ZUdyb3VwQXRUaXBzKHQpLDA9PT1uLnVucmVhZENvdW50KXJldHVybiBYYSgpO2lmKG4udHlwZT09PUUuQ09OVl9HUk9VUCYmIXRoaXMuX2hhc0xvY2FsR3JvdXAodCkpcmV0dXJuIDAhPT1uLnVucmVhZENvdW50JiYobi51bnJlYWRDb3VudD0wLHRoaXMuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSkpLFhhKCk7dmFyIG89dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTGFzdE1lc3NhZ2UodCkscz1uLmxhc3RNZXNzYWdlLmxhc3RUaW1lO28mJnM8by50aW1lJiYocz1vLnRpbWUpO3ZhciBhPW4ubGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlO2lmKG8mJmE8by5zZXF1ZW5jZSYmKGE9by5zZXF1ZW5jZSksbi50eXBlPT09RS5DT05WX1RPUElDJiZpdChvKSl7dmFyIGk9dGhpcy5nZXRNb2R1bGUoRm4pLHI9dC5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKSx1PXh0KHIpLGM9aS5nZXRMb2NhbFRvcGljKHUscik7YyYmKGE9Yy5uZXh0TWVzc2FnZVNlcS0xKX12YXIgbD1udWxsO3N3aXRjaChuLnR5cGUpe2Nhc2UgRS5DT05WX0MyQzpyZXR1cm4obD10aGlzLmdldE1vZHVsZShVbikpP2wuc2V0TWVzc2FnZVJlYWQoe2NvbnZlcnNhdGlvbklEOnQsbGFzdE1lc3NhZ2VUaW1lOnN9KTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KTtjYXNlIEUuQ09OVl9HUk9VUDpjYXNlIEUuQ09OVl9UT1BJQzpyZXR1cm4obD10aGlzLmdldE1vZHVsZShQbikpP2wuc2V0TWVzc2FnZVJlYWQoe2NvbnZlcnNhdGlvbklEOnQsbGFzdE1lc3NhZ2VTZXE6YX0pOlphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX01PRFVMRX0pO2Nhc2UgRS5DT05WX1NZU1RFTTpyZXR1cm4gbi51bnJlYWRDb3VudD0wLHRoaXMuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSksWGEoKTtkZWZhdWx0OnJldHVybiBYYSgpfX19LHtrZXk6XCJzZXRBbGxNZXNzYWdlUmVhZFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fSxuPVwic2V0QWxsTWVzc2FnZVJlYWRcIixvPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChuKTt0LnNjb3BlfHwodC5zY29wZT1FLlJFQURfQUxMX01TRyksVmUubChcIlwiLmNvbmNhdChvLFwiIG9wdGlvbnM6XCIpLHQpO3ZhciBzPXRoaXMuX2NyZWF0ZVNldEFsbE1lc3NhZ2VSZWFkUGFjayh0KTtpZigwPT09cy5yZWFkQWxsQzJDTWVzc2FnZSYmMD09PXMuZ3JvdXBNZXNzYWdlUmVhZEluZm9MaXN0Lmxlbmd0aClyZXR1cm4gWGEoKTt2YXIgYT1uZXcgQWEobik7cmV0dXJuIHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOnVzLHJlcXVlc3REYXRhOnN9KS50aGVuKChmdW5jdGlvbihuKXt2YXIgbz1uLmRhdGEscz1lLl9oYW5kbGVBbGxNZXNzYWdlUmVhZChvKTtyZXR1cm4gYS5zZXRNZXNzYWdlKFwic2NvcGU6XCIuY29uY2F0KHQuc2NvcGUsXCIgZmFpbHVyZUdyb3VwczpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KHMpKSkuc2V0TmV0d29ya1R5cGUoZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxYYSgpfSkpLmNhdGNoKChmdW5jdGlvbih0KXtyZXR1cm4gZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbihlKXt2YXIgbj12KGUsMiksbz1uWzBdLHM9blsxXTthLnNldEVycm9yKHQsbyxzKS5lbmQoKX0pKSxWZS53KFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksdCksWmEoe2NvZGU6dCYmdC5jb2RlP3QuY29kZTpoYS5NRVNTQUdFX1VOUkVBRF9BTExfRkFJTCxtZXNzYWdlOnQmJnQubWVzc2FnZT90Lm1lc3NhZ2U6dm9pZCAwfSl9KSl9fSx7a2V5Olwic2V0Q29udmVyc2F0aW9uQ3VzdG9tRGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9jb252R3JvdXBIYW5kbGVyLnNldENvbnZDdXN0b21EYXRhKGUpfX0se2tleTpcIm1hcmtDb252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udkdyb3VwSGFuZGxlci5tYXJrQ29udmVyc2F0aW9uKGUpfX0se2tleTpcImdldENvbnZlcnNhdGlvbkdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnZHcm91cEhhbmRsZXIuZ2V0TG9jYWxDb252R3JvdXBMaXN0KCl9fSx7a2V5OlwiY3JlYXRlQ29udmVyc2F0aW9uR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udkdyb3VwSGFuZGxlci5jcmVhdGVDb252R3JvdXAoZSl9fSx7a2V5OlwiZGVsZXRlQ29udmVyc2F0aW9uR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udkdyb3VwSGFuZGxlci5kZWxldGVDb252R3JvdXAoZSl9fSx7a2V5OlwicmVuYW1lQ29udmVyc2F0aW9uR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udkdyb3VwSGFuZGxlci5yZW5hbWVDb252R3JvdXAoZSl9fSx7a2V5OlwiYWRkQ29udmVyc2F0aW9uc1RvR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fY29udkdyb3VwSGFuZGxlci5hZGRDb252c1RvR3JvdXAoZSl9fSx7a2V5OlwiZGVsZXRlQ29udmVyc2F0aW9uc0Zyb21Hcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9jb252R3JvdXBIYW5kbGVyLmRlbGV0ZUNvbnZzRnJvbUdyb3VwKGUpfX0se2tleTpcIm9uQ29udmVyc2F0aW9uTWFya1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jb252R3JvdXBIYW5kbGVyLm9uQ29udk1hcmtVcGRhdGVkKGUpfX0se2tleTpcIm9uQ29udmVyc2F0aW9uR3JvdXBDcmVhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fY29udkdyb3VwSGFuZGxlci5vbkNvbnZHcm91cENyZWF0ZWQoZSl9fSx7a2V5Olwib25Db252ZXJzYXRpb25Hcm91cERlbGV0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jb252R3JvdXBIYW5kbGVyLm9uQ29udkdyb3VwRGVsZXRlZChlKX19LHtrZXk6XCJvbkNvbnZlcnNhdGlvbkdyb3VwTmFtZVVwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jb252R3JvdXBIYW5kbGVyLm9uQ29udkdyb3VwTmFtZVVwZGF0ZWQoZSl9fSx7a2V5Olwib25Db252ZXJzYXRpb25Jbkdyb3VwVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NvbnZHcm91cEhhbmRsZXIub25Db252SW5Hcm91cFVwZGF0ZWQoZSl9fSx7a2V5Olwib25Db252ZXJzYXRpb25BZGRlZFRvT3JEZWxldGVkRnJvbUdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fY29udkdyb3VwSGFuZGxlci5vbkNvbnZBZGRlZFRvT3JEZWxldGVkRnJvbUdyb3VwKGUpfX0se2tleTpcIl9nZXRDb252ZXJzYXRpb25MYXN0TWVzc2FnZVNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTGFzdE1lc3NhZ2UoZS5jb252ZXJzYXRpb25JRCksbj1lLmxhc3RNZXNzYWdlLmxhc3RTZXF1ZW5jZTtyZXR1cm4gdCYmbjx0LnNlcXVlbmNlJiYobj10LnNlcXVlbmNlKSxufX0se2tleTpcIl9nZXRDb252ZXJzYXRpb25MYXN0TWVzc2FnZVRpbWVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TG9jYWxMYXN0TWVzc2FnZShlLmNvbnZlcnNhdGlvbklEKSxuPWUubGFzdE1lc3NhZ2UubGFzdFRpbWU7cmV0dXJuIHQmJm48dC50aW1lJiYobj10LnRpbWUpLG59fSx7a2V5OlwiX2NyZWF0ZVNldEFsbE1lc3NhZ2VSZWFkUGFja1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0LG49e3JlYWRBbGxDMkNNZXNzYWdlOjAsZ3JvdXBNZXNzYWdlUmVhZEluZm9MaXN0OltdfSxvPWUuc2NvcGUscz1EKHRoaXMuX2NvbnZlcnNhdGlvbk1hcCk7dHJ5e2ZvcihzLnMoKTshKHQ9cy5uKCkpLmRvbmU7KXt2YXIgYT12KHQudmFsdWUsMilbMV07aWYoYS51bnJlYWRDb3VudD4wKWlmKGEudHlwZT09PUUuQ09OVl9DMkMmJjA9PT1uLnJlYWRBbGxDMkNNZXNzYWdlKXtpZihvPT09RS5SRUFEX0FMTF9NU0cpbi5yZWFkQWxsQzJDTWVzc2FnZT0xO2Vsc2UgaWYobz09PUUuUkVBRF9BTExfQzJDX01TRyl7bi5yZWFkQWxsQzJDTWVzc2FnZT0xO2JyZWFrfX1lbHNlIGlmKGEudHlwZT09PUUuQ09OVl9HUk9VUCYmKG89PT1FLlJFQURfQUxMX0dST1VQX01TR3x8bz09PUUuUkVBRF9BTExfTVNHKSl7dmFyIGk9dGhpcy5fZ2V0Q29udmVyc2F0aW9uTGFzdE1lc3NhZ2VTZXF1ZW5jZShhKTtuLmdyb3VwTWVzc2FnZVJlYWRJbmZvTGlzdC5wdXNoKHtncm91cElEOmEuZ3JvdXBQcm9maWxlLmdyb3VwSUQsbWVzc2FnZVNlcXVlbmNlOml9KX19fWNhdGNoKHIpe3MuZShyKX1maW5hbGx5e3MuZigpfXJldHVybiBufX0se2tleTpcIm9uUHVzaGVkQWxsTWVzc2FnZVJlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9oYW5kbGVBbGxNZXNzYWdlUmVhZChlKX19LHtrZXk6XCJfaGFuZGxlQWxsTWVzc2FnZVJlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmdyb3VwTWVzc2FnZVJlYWRJbmZvTGlzdCxuPWUucmVhZEFsbEMyQ01lc3NhZ2Usbz10aGlzLl9wYXJzZUdyb3VwUmVhZEluZm8odCk7cmV0dXJuIHRoaXMuX3VwZGF0ZUFsbENvbnZlcnNhdGlvblVucmVhZENvdW50KHtyZWFkQWxsQzJDTWVzc2FnZTpufSk+PTEmJih0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpLHRoaXMuZW1pdFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50VXBkYXRlKCkpLG99fSx7a2V5OlwiX3BhcnNlR3JvdXBSZWFkSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVtdO2lmKGUmJmUubGVuZ3RoKWZvcih2YXIgbj0wLG89ZS5sZW5ndGg7bjxvO24rKyl7dmFyIHM9ZVtuXSxhPXMuZ3JvdXBJRCxpPXMuc2VxdWVuY2Uscj1zLnJldENvZGUsdT1zLmxhc3RNZXNzYWdlU2VxO2l0KHIpP3RoaXMuX3JlbW90ZUdyb3VwUmVhZFNlcXVlbmNlTWFwLnNldChhLHUpOih0aGlzLl9yZW1vdGVHcm91cFJlYWRTZXF1ZW5jZU1hcC5zZXQoYSxpKSwwIT09ciYmdC5wdXNoKFwiXCIuY29uY2F0KGEsXCItXCIpLmNvbmNhdChpLFwiLVwiKS5jb25jYXQocikpKX1yZXR1cm4gdH19LHtrZXk6XCJfdXBkYXRlQWxsQ29udmVyc2F0aW9uVW5yZWFkQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdCxuPWUucmVhZEFsbEMyQ01lc3NhZ2Usbz0wLHM9RCh0aGlzLl9jb252ZXJzYXRpb25NYXApO3RyeXtmb3Iocy5zKCk7ISh0PXMubigpKS5kb25lOyl7dmFyIGE9dih0LnZhbHVlLDIpLGk9YVswXSxyPWFbMV07aWYoci51bnJlYWRDb3VudD49MSl7aWYoMT09PW4mJnIudHlwZT09PUUuQ09OVl9DMkMpe3ZhciB1PXRoaXMuX2dldENvbnZlcnNhdGlvbkxhc3RNZXNzYWdlVGltZShyKTt0aGlzLnVwZGF0ZUlzUmVhZEFmdGVyUmVhZFJlcG9ydCh7Y29udmVyc2F0aW9uSUQ6aSxsYXN0TWVzc2FnZVRpbWU6dX0pfWVsc2UgaWYoci50eXBlPT09RS5DT05WX0dST1VQKXt2YXIgYz1pLnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpO2lmKHRoaXMuX3JlbW90ZUdyb3VwUmVhZFNlcXVlbmNlTWFwLmhhcyhjKSl7dmFyIGw9dGhpcy5fcmVtb3RlR3JvdXBSZWFkU2VxdWVuY2VNYXAuZ2V0KGMpLGQ9dGhpcy5fZ2V0Q29udmVyc2F0aW9uTGFzdE1lc3NhZ2VTZXF1ZW5jZShyKTt0aGlzLnVwZGF0ZUlzUmVhZEFmdGVyUmVhZFJlcG9ydCh7Y29udmVyc2F0aW9uSUQ6aSxyZW1vdGVSZWFkU2VxdWVuY2U6bH0pLGQ+PWwmJnRoaXMuX3JlbW90ZUdyb3VwUmVhZFNlcXVlbmNlTWFwLmRlbGV0ZShjKX19dGhpcy51cGRhdGVVbnJlYWRDb3VudChpLCExKSYmKG8rPTEpfX19Y2F0Y2gocCl7cy5lKHApfWZpbmFsbHl7cy5mKCl9cmV0dXJuIG99fSx7a2V5OlwiaXNSZW1vdGVSZWFkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPWUuc2VxdWVuY2Usbz10LnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpLHM9ITE7aWYodGhpcy5fcmVtb3RlR3JvdXBSZWFkU2VxdWVuY2VNYXAuaGFzKG8pKXt2YXIgYT10aGlzLl9yZW1vdGVHcm91cFJlYWRTZXF1ZW5jZU1hcC5nZXQobyk7bjw9YSYmKHM9ITAsVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmlzUmVtb3RlUmVhZCBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KHQsXCIgbWVzc2FnZVNlcXVlbmNlOlwiKS5jb25jYXQobixcIiByZW1vdGVSZWFkU2VxdWVuY2U6XCIpLmNvbmNhdChhKSkpLG4+PWErMTAmJnRoaXMuX3JlbW90ZUdyb3VwUmVhZFNlcXVlbmNlTWFwLmRlbGV0ZShvKX1yZXR1cm4gc319LHtrZXk6XCJ1cGRhdGVJc1JlYWRBZnRlclJlYWRSZXBvcnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmNvbnZlcnNhdGlvbklELG49ZS5sYXN0TWVzc2FnZVNlcSxvPWUubGFzdE1lc3NhZ2VUaW1lLHM9dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTWVzc2FnZUxpc3QodCk7aWYoMCE9PXMubGVuZ3RoKWZvcih2YXIgYSxpPXMubGVuZ3RoLTE7aT49MDtpLS0paWYoYT1zW2ldLCEobyYmYS50aW1lPm98fG4mJmEuc2VxdWVuY2U+bikpe2lmKFwiaW5cIj09PWEuZmxvdyYmYS5pc1JlYWQpYnJlYWs7YS5zZXRJc1JlYWQoITApfX19LHtrZXk6XCJ1cGRhdGVVbnJlYWRDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PSEoYXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pfHxhcmd1bWVudHNbMV0sbj0hMSxvPXRoaXMuZ2V0TG9jYWxDb252ZXJzYXRpb24oZSkscz10aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TG9jYWxNZXNzYWdlTGlzdChlKTtpZihvKXt2YXIgYT1vLnVucmVhZENvdW50LGk9cy5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiFlLmlzUmVhZCYmIWUuX29ubGluZU9ubHlGbGFnJiYhZS5pc0RlbGV0ZWR9KSkubGVuZ3RoO2lmKGEhPT1pJiYoby51bnJlYWRDb3VudD1pLG49ITAsVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnVwZGF0ZVVucmVhZENvdW50IGZyb20gXCIpLmNvbmNhdChhLFwiIHRvIFwiKS5jb25jYXQoaSxcIiwgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChlKSksITA9PT10JiYodGhpcy5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKSx0aGlzLmVtaXRUb3RhbFVucmVhZE1lc3NhZ2VDb3VudFVwZGF0ZSgpKSksbiYmby50eXBlPT09RS5DT05WX1RPUElDKXt2YXIgcj1vLnVucmVhZENvdW50LHU9dGhpcy5nZXRNb2R1bGUoRm4pLGM9ZS5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKTt1Lm9uQ29udmVyc2F0aW9uUHJveHkoe3RvcGljSUQ6Yyx1bnJlYWRDb3VudDpyfSl9cmV0dXJuIG59fX0se2tleTpcImNsZWFyR3JvdXBBdEluZm9MaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9IShhcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSl8fGFyZ3VtZW50c1sxXSxuPXRoaXMuZ2V0TG9jYWxDb252ZXJzYXRpb24oZSk7aWYobiYmbi5ncm91cEF0SW5mb0xpc3QubGVuZ3RoPjApe2lmKG4uY2xlYXJHcm91cEF0SW5mb0xpc3QoKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuY2xlYXJHcm91cEF0SW5mb0xpc3QgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChlKSksbi50eXBlPT09RS5DT05WX1RPUElDKXt2YXIgbz1uLmdyb3VwQXRJbmZvTGlzdCxzPXRoaXMuZ2V0TW9kdWxlKEZuKSxhPWUucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIik7cy5vbkNvbnZlcnNhdGlvblByb3h5KHt0b3BpY0lEOmEsZ3JvdXBBdEluZm9MaXN0Om99KX0hMD09PXQmJnRoaXMuZW1pdENvbnZlcnNhdGlvblVwZGF0ZSghMCwhMSl9fX0se2tleTpcInVwZGF0ZVJlYWRSZWNlaXB0SW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLnVzZXJJRCxvPXZvaWQgMD09PW4/dm9pZCAwOm4scz1lLmdyb3VwSUQsYT12b2lkIDA9PT1zP3ZvaWQgMDpzLGk9ZS5yZWFkUmVjZWlwdExpc3Q7aWYoIXp0KGkpKXt2YXIgcj1bXTtpZihpdChvKSl7aWYoIWl0KGEpKXt2YXIgdT1cIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChhKTtpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPWUudGlueUlELG89ZS5jbGllbnRUaW1lLHM9ZS5yYW5kb20saT1lLnJlYWRDb3VudCxjPWUudW5yZWFkQ291bnQsbD1cIlwiLmNvbmNhdChuLFwiLVwiKS5jb25jYXQobyxcIi1cIikuY29uY2F0KHMpLGQ9dC5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTWVzc2FnZSh1LGwpLHA9e2dyb3VwSUQ6YSxtZXNzYWdlSUQ6bCxyZWFkQ291bnQ6MCx1bnJlYWRDb3VudDowfTtkJiYoZXQoaSkmJihkLnJlYWRSZWNlaXB0SW5mby5yZWFkQ291bnQ9aSxwLnJlYWRDb3VudD1pKSxldChjKSYmKGQucmVhZFJlY2VpcHRJbmZvLnVucmVhZENvdW50PWMscC51bnJlYWRDb3VudD1jKSxyLnB1c2gocCkpfSkpfX1lbHNle3ZhciBjPVwiXCIuY29uY2F0KEUuQ09OVl9DMkMpLmNvbmNhdChvKTtpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPWUudGlueUlELHM9ZS5jbGllbnRUaW1lLGE9ZS5yYW5kb20saT1cIlwiLmNvbmNhdChuLFwiLVwiKS5jb25jYXQocyxcIi1cIikuY29uY2F0KGEpLHU9dC5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExvY2FsTWVzc2FnZShjLGkpO2lmKHUpe3UucmVhZFJlY2VpcHRJbmZvLmlzUGVlclJlYWQ9ITA7dmFyIGw9e3VzZXJJRDpvLG1lc3NhZ2VJRDppLGlzUGVlclJlYWQ6ITB9O3IucHVzaChsKX19KSl9ci5sZW5ndGg+MCYmdGhpcy5lbWl0T3V0ZXJFdmVudChrLk1FU1NBR0VfUkVBRF9SRUNFSVBUX1JFQ0VJVkVELHIpfX19LHtrZXk6XCJyZWNvbXB1dGVHcm91cFVucmVhZENvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jb252ZXJzYXRpb25JRCxuPWUuY291bnQsbz10aGlzLmdldExvY2FsQ29udmVyc2F0aW9uKHQpO2lmKG8pe3ZhciBzPW8udW5yZWFkQ291bnQsYT1zLW47YTwwJiYoYT0wKSxvLnVucmVhZENvdW50PWEsVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlY29tcHV0ZUdyb3VwVW5yZWFkQ291bnQgZnJvbSBcIikuY29uY2F0KHMsXCIgdG8gXCIpLmNvbmNhdChhLFwiLCBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KHQpKX19fSx7a2V5OlwidXBkYXRlSXNSZWFkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbihlKSxuPXRoaXMuZ2V0TG9jYWxNZXNzYWdlTGlzdChlKTtpZih0JiYwIT09bi5sZW5ndGgmJiFMdCh0LnR5cGUpKXtmb3IodmFyIG89W10scz0wLGE9bi5sZW5ndGg7czxhO3MrKylcImluXCIhPT1uW3NdLmZsb3c/XCJvdXRcIiE9PW5bc10uZmxvd3x8bltzXS5pc1JlYWR8fG5bc10uc2V0SXNSZWFkKCEwKTpvLnB1c2gobltzXSk7dmFyIGk9MDtpZih0LnR5cGU9PT1FLkNPTlZfQzJDKXt2YXIgcj1vLnNsaWNlKC10LnVucmVhZENvdW50KS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlzUmV2b2tlZH0pKS5sZW5ndGg7aT1vLmxlbmd0aC10LnVucmVhZENvdW50LXJ9ZWxzZSBpPW8ubGVuZ3RoLXQudW5yZWFkQ291bnQ7Zm9yKHZhciB1PTA7dTxpJiYhb1t1XS5pc1JlYWQ7dSsrKW9bdV0uc2V0SXNSZWFkKCEwKX19fSx7a2V5OlwiZGVsZXRlR3JvdXBBdFRpcHNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5kZWxldGVHcm91cEF0VGlwc1wiKTtWZS5sKFwiXCIuY29uY2F0KG4pKTt2YXIgbz10aGlzLl9jb252ZXJzYXRpb25NYXAuZ2V0KGUpO2lmKCFvKXJldHVybiBQcm9taXNlLnJlc29sdmUoKTt2YXIgcz1vLmdyb3VwQXRJbmZvTGlzdDtpZigwPT09cy5sZW5ndGgpcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO3ZhciBhPXZvaWQgMDtlLnN0YXJ0c1dpdGgoRS5DT05WX0dST1VQKSYmKGE9ZS5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKSk7dmFyIGk9bShzKTtpZigoRHQoe2dyb3VwSUQ6YX0pfHxrdChhKSkmJjA9PT0oaT1zLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIWUuYXRUeXBlQXJyYXkuaW5jbHVkZXMoRS5DT05WX0FUX0FMTCl9KSkpLmxlbmd0aClyZXR1cm4gdGhpcy5jbGVhckdyb3VwQXRJbmZvTGlzdChlLCExKSxQcm9taXNlLnJlc29sdmUoKTt2YXIgcj10aGlzLmdldE15VXNlcklEKCk7cmV0dXJuIHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkZvLHJlcXVlc3REYXRhOnttZXNzYWdlTGlzdFRvRGVsZXRlOmkubWFwKChmdW5jdGlvbihlKXtyZXR1cm57ZnJvbTplLmZyb20sdG86cixtZXNzYWdlU2VxOmUuX19zZXF1ZW5jZSxtZXNzYWdlUmFuZG9tOmUuX19yYW5kb20sZ3JvdXBJRDppdChlLnRvcGljSUQpP2UuZ3JvdXBJRDplLnRvcGljSUR9fSkpfX0pLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gY291bnQ6XCIpLmNvbmNhdChzLmxlbmd0aCkpLHQuY2xlYXJHcm91cEF0SW5mb0xpc3QoZSwhMSksUHJvbWlzZS5yZXNvbHZlKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiBWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiYXBwZW5kVG9NZXNzYWdlTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5wdXNoSW4oZSl9fSx7a2V5Olwic2V0TWVzc2FnZVJhbmRvbVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuc2luZ2x5TGlua2VkTGlzdC5zZXQoZS5yYW5kb20pfX0se2tleTpcImRlbGV0ZU1lc3NhZ2VSYW5kb21cIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLnNpbmdseUxpbmtlZExpc3QuZGVsZXRlKGUucmFuZG9tKX19LHtrZXk6XCJwdXNoSW50b01lc3NhZ2VMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiEoIXRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5wdXNoSW4odCxuKXx8dGhpcy5faXNNZXNzYWdlRnJvbUN1cnJlbnRJbnN0YW5jZSh0KSYmIW4pJiYoZS5wdXNoKHQpLCEwKX19LHtrZXk6XCJfaXNNZXNzYWdlRnJvbUN1cnJlbnRJbnN0YW5jZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnNpbmdseUxpbmtlZExpc3QuaGFzKGUucmFuZG9tKX19LHtrZXk6XCJyZXZva2VcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5yZXZva2UoZSx0LG4pfX0se2tleTpcImdldFBlZXJSZWFkVGltZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9wZWVyUmVhZFRpbWVNYXAuZ2V0KGUpfX0se2tleTpcInJlY29yZFBlZXJSZWFkVGltZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fcGVlclJlYWRUaW1lTWFwLmhhcyhlKT90aGlzLl9wZWVyUmVhZFRpbWVNYXAuZ2V0KGUpPHQmJnRoaXMuX3BlZXJSZWFkVGltZU1hcC5zZXQoZSx0KTp0aGlzLl9wZWVyUmVhZFRpbWVNYXAuc2V0KGUsdCl9fSx7a2V5OlwidXBkYXRlTWVzc2FnZUlzUGVlclJlYWRQcm9wZXJ0eVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7aWYoZS5zdGFydHNXaXRoKEUuQ09OVl9DMkMpJiZ0PjApe3ZhciBuPXRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci51cGRhdGVNZXNzYWdlSXNQZWVyUmVhZFByb3BlcnR5KGUsdCk7aWYobi5sZW5ndGg+MCYmdGhpcy5lbWl0T3V0ZXJFdmVudChrLk1FU1NBR0VfUkVBRF9CWV9QRUVSLG4pLHRoaXMuX2NvbnZlcnNhdGlvbk1hcC5oYXMoZSkpe3ZhciBvPXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5nZXQoZSkubGFzdE1lc3NhZ2U7enQobyl8fG8uZnJvbUFjY291bnQ9PT10aGlzLmdldE15VXNlcklEKCkmJm8ubGFzdFRpbWU8PXQmJiFvLmlzUGVlclJlYWQmJihvLmlzUGVlclJlYWQ9ITAsdGhpcy5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKSl9fX19LHtrZXk6XCJ1cGRhdGVNZXNzYWdlSXNNb2RpZmllZFByb3BlcnR5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLnVwZGF0ZU1lc3NhZ2VJc01vZGlmaWVkUHJvcGVydHkoZSl9fSx7a2V5Olwic2V0Q29tcGxldGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnNldENvbXBsZXRlZC4gY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChlKSksdGhpcy5fY29tcGxldGVkTWFwLnNldChlLCEwKX19LHtrZXk6XCJ1cGRhdGVSb2FtaW5nTWVzc2FnZUtleUFuZFRpbWVcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7dGhpcy5fcm9hbWluZ01lc3NhZ2VLZXlBbmRUaW1lTWFwLnNldChlLHttZXNzYWdlS2V5OnQsbGFzdE1lc3NhZ2VUaW1lOm59KX19LHtrZXk6XCJ1cGRhdGVSb2FtaW5nTWVzc2FnZVNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9yb2FtaW5nTWVzc2FnZVNlcXVlbmNlTWFwLnNldChlLHQpfX0se2tleTpcImdldENvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJnZXRDb252ZXJzYXRpb25MaXN0XCIsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQobikscz1cInBhZ2luZ1N0YXR1czpcIi5jb25jYXQodGhpcy5fcGFnaW5nU3RhdHVzLFwiLCBsb2NhbCBjb252ZXJzYXRpb24gY291bnQ6XCIpLmNvbmNhdCh0aGlzLl9jb252ZXJzYXRpb25NYXAuc2l6ZSxcIiwgb3B0aW9uczpcIikuY29uY2F0KGUpO2lmKFZlLmwoXCJcIi5jb25jYXQobyxcIi4gXCIpLmNvbmNhdChzKSksdGhpcy5fcGFnaW5nU3RhdHVzPT09JHQuUkVKRUNURUQpe3ZhciBhPW5ldyBBYShuKTtyZXR1cm4gYS5zZXRNZXNzYWdlKHMpLHRoaXMuc3luY0NvbnZlcnNhdGlvbkxpc3QoKS50aGVuKChmdW5jdGlvbigpe2Euc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKTt2YXIgbj10Ll9nZXRDb252ZXJzYXRpb25MaXN0KGUpO3JldHVybiBZYSh7Y29udmVyc2F0aW9uTGlzdDpuLGlzU3luY0NvbXBsZXRlZDp0Ll9pc1N5bmNDb21wbGV0ZWQoKX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTthLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9aWYoMD09PXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5zaXplKXt2YXIgaT1uZXcgQWEobik7cmV0dXJuIGkuc2V0TWVzc2FnZShzKSx0aGlzLnN5bmNDb252ZXJzYXRpb25MaXN0KCkudGhlbigoZnVuY3Rpb24oKXtpLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCk7dmFyIG49dC5fZ2V0Q29udmVyc2F0aW9uTGlzdChlKTtyZXR1cm4gWWEoe2NvbnZlcnNhdGlvbkxpc3Q6bixpc1N5bmNDb21wbGV0ZWQ6dC5faXNTeW5jQ29tcGxldGVkKCl9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07aS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChvLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfXZhciByPXRoaXMuX2dldENvbnZlcnNhdGlvbkxpc3QoZSk7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQobyxcIi4gcmV0dXJuZWQgY29udmVyc2F0aW9uIGNvdW50OlwiKS5jb25jYXQoci5sZW5ndGgpKSxYYSh7Y29udmVyc2F0aW9uTGlzdDpyLGlzU3luY0NvbXBsZXRlZDp0aGlzLl9pc1N5bmNDb21wbGV0ZWQoKX0pfX0se2tleTpcIl9nZXRDb252ZXJzYXRpb25MaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoaXQoZSkpcmV0dXJuIHRoaXMuZ2V0TG9jYWxDb252ZXJzYXRpb25MaXN0KCk7aWYoYXQoZSkpcmV0dXJuIDA9PT1lLmxlbmd0aD9bXTp0aGlzLmdldExvY2FsQ29udmVyc2F0aW9uTGlzdCgpLmZpbHRlcigoZnVuY3Rpb24odCl7cmV0dXJuIGUuaW5jbHVkZXModC5jb252ZXJzYXRpb25JRCl9KSk7aWYoc3QoZSkpe3ZhciB0PWUudHlwZSxuPWUubWFya1R5cGUsbz1lLmdyb3VwTmFtZTtyZXR1cm4gdGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybih0IT09RS5DT05WX0MyQyYmdCE9PUUuQ09OVl9HUk9VUHx8ZS50eXBlPT09dCkmJighbnQobyl8fGUuY29udmVyc2F0aW9uR3JvdXBMaXN0LmluY2x1ZGVzKG8pKSYmKCFldChuKXx8ZS5tYXJrTGlzdC5pbmNsdWRlcyhuKSl9KSl9cmV0dXJuW119fSx7a2V5OlwiX2hhbmRsZUMyQ1BlZXJSZWFkVGltZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGUsdD1EKHRoaXMuX2NvbnZlcnNhdGlvbk1hcCk7dHJ5e2Zvcih0LnMoKTshKGU9dC5uKCkpLmRvbmU7KXt2YXIgbj12KGUudmFsdWUsMiksbz1uWzBdLHM9blsxXTtzLnR5cGU9PT1FLkNPTlZfQzJDJiYoVmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9oYW5kbGVDMkNQZWVyUmVhZFRpbWUgY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChvLFwiIHBlZXJSZWFkVGltZTpcIikuY29uY2F0KHMucGVlclJlYWRUaW1lKSksdGhpcy5yZWNvcmRQZWVyUmVhZFRpbWUobyxzLnBlZXJSZWFkVGltZSkpfX1jYXRjaChhKXt0LmUoYSl9ZmluYWxseXt0LmYoKX19fSx7a2V5OlwiX2lzUGFnaW5nR2V0R3JvdXBMaXN0Q29tcGxldGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRNb2R1bGUoUG4pLmlzUGFnaW5nR2V0Q29tcGxldGVkKCl9fSx7a2V5OlwiX2dldExvY2FsR3JvdXBDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKFBuKS5nZXRMb2NhbEdyb3VwTGlzdCgpLmxlbmd0aH19LHtrZXk6XCJfaGFzTG9jYWxHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldE1vZHVsZShQbikuaGFzTG9jYWxHcm91cChlLnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpKX19LHtrZXk6XCJnZXRDb252ZXJzYXRpb25Qcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQsbj10aGlzO2lmKCh0PXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5oYXMoZSk/dGhpcy5fY29udmVyc2F0aW9uTWFwLmdldChlKTpuZXcgZmkoe2NvbnZlcnNhdGlvbklEOmUsdHlwZTplLnNsaWNlKDAsMyk9PT1FLkNPTlZfQzJDP0UuQ09OVl9DMkM6RS5DT05WX0dST1VQfSx0aGlzLmlzSW50bCgpKSkuX2lzSW5mb0NvbXBsZXRlZHx8dC50eXBlPT09RS5DT05WX1NZU1RFTSlyZXR1cm4gWGEoe2NvbnZlcnNhdGlvbjp0fSk7aWYoU3QoZSkmJiF0aGlzLl9oYXNMb2NhbEdyb3VwKGUpKXJldHVybiBYYSh7Y29udmVyc2F0aW9uOnR9KTt2YXIgbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJnZXRDb252ZXJzYXRpb25Qcm9maWxlXCIpLHM9bmV3IEFhKFwiZ2V0Q29udmVyc2F0aW9uUHJvZmlsZVwiKTtyZXR1cm4gVmUubChcIlwiLmNvbmNhdChvLFwiLiBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KGUsXCIgcmVtYXJrOlwiKS5jb25jYXQodC5yZW1hcmssXCIgbGFzdE1lc3NhZ2U6XCIpLHQubGFzdE1lc3NhZ2UpLHRoaXMuX3VwZGF0ZVVzZXJPckdyb3VwUHJvZmlsZUNvbXBsZXRlbHkodCkudGhlbigoZnVuY3Rpb24oYSl7cy5zZXROZXR3b3JrVHlwZShuLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJjb252ZXJzYXRpb25JRDpcIi5jb25jYXQoZSxcIiB1bnJlYWRDb3VudDpcIikuY29uY2F0KGEuZGF0YS5jb252ZXJzYXRpb24udW5yZWFkQ291bnQpKS5lbmQoKTt2YXIgaT1uLmdldE1vZHVsZShibik7aWYoaSYmdC50eXBlPT09RS5DT05WX0MyQyl7dmFyIHI9ZS5yZXBsYWNlKEUuQ09OVl9DMkMsXCJcIik7aWYoaS5pc015RnJpZW5kKHIpKXt2YXIgdT1pLmdldEZyaWVuZFJlbWFyayhyKTt0LnJlbWFyayE9PXUmJih0LnJlbWFyaz11LFZlLmwoXCJcIi5jb25jYXQobyxcIi4gY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChlLFwiIHBhdGNoIHJlbWFyazpcIikuY29uY2F0KHQucmVtYXJrKSkpfX1yZXR1cm4gVmUubChcIlwiLmNvbmNhdChvLFwiIG9rLiBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KGUpKSxhfSkpLmNhdGNoKChmdW5jdGlvbih0KXtyZXR1cm4gbi5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbihuKXt2YXIgbz12KG4sMiksYT1vWzBdLGk9b1sxXTtzLnNldEVycm9yKHQsYSxpKS5zZXRNZXNzYWdlKFwiY29udmVyc2F0aW9uSUQ6XCIuY29uY2F0KGUpKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksdCksWmEodCl9KSl9fSx7a2V5OlwiX3VwZGF0ZVVzZXJPckdyb3VwUHJvZmlsZUNvbXBsZXRlbHlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO3JldHVybiBlLnR5cGU9PT1FLkNPTlZfQzJDP3RoaXMuZ2V0TW9kdWxlKEduKS5nZXRVc2VyUHJvZmlsZSh7dXNlcklETGlzdDpbZS50b0FjY291bnRdfSkudGhlbigoZnVuY3Rpb24obil7dmFyIG89bi5kYXRhO3JldHVybiAwPT09by5sZW5ndGg/WmEobmV3IGphKHtjb2RlOmhhLlVTRVJfT1JfR1JPVVBfTk9UX0ZPVU5EfSkpOihlLnVzZXJQcm9maWxlPW9bMF0sZS5faXNJbmZvQ29tcGxldGVkPSEwLHQuX3Vuc2hpZnRDb252ZXJzYXRpb24oZSksWGEoe2NvbnZlcnNhdGlvbjplfSkpfSkpOnRoaXMuZ2V0TW9kdWxlKFBuKS5nZXRHcm91cFByb2ZpbGUoe2dyb3VwSUQ6ZS50b0FjY291bnR9KS50aGVuKChmdW5jdGlvbihuKXtyZXR1cm4gZS5ncm91cFByb2ZpbGU9bi5kYXRhLmdyb3VwLGUuX2lzSW5mb0NvbXBsZXRlZD0hMCx0Ll91bnNoaWZ0Q29udmVyc2F0aW9uKGUpLFhhKHtjb252ZXJzYXRpb246ZX0pfSkpfX0se2tleTpcIl91bnNoaWZ0Q29udmVyc2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7ZSBpbnN0YW5jZW9mIGZpJiYhdGhpcy5fY29udmVyc2F0aW9uTWFwLmhhcyhlLmNvbnZlcnNhdGlvbklEKSYmKHRoaXMuX2NvbnZlcnNhdGlvbk1hcD1uZXcgTWFwKFtbZS5jb252ZXJzYXRpb25JRCxlXV0uY29uY2F0KG0odGhpcy5fY29udmVyc2F0aW9uTWFwKSkpLHRoaXMuX3NldFN0b3JhZ2VDb252ZXJzYXRpb25MaXN0KCksdGhpcy5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKSl9fSx7a2V5OlwiX29uUHJvZmlsZVVwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2UuZGF0YS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgbj1lLnVzZXJJRDtpZihuPT09dC5nZXRNeVVzZXJJRCgpKXQuX29uTXlQcm9maWxlTW9kaWZpZWQoe2xhdGVzdE5pY2s6ZS5uaWNrLGxhdGVzdEF2YXRhcjplLmF2YXRhcn0pO2Vsc2V7dmFyIG89dC5fY29udmVyc2F0aW9uTWFwLmdldChcIlwiLmNvbmNhdChFLkNPTlZfQzJDKS5jb25jYXQobikpO28mJihvLnVzZXJQcm9maWxlPWUpfX0pKX19LHtrZXk6XCJfaXNTeW5jQ29tcGxldGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFnaW5nU3RhdHVzPT09JHQuUkVTT0xWRUR9fSx7a2V5OlwiX2Vycm9yTG9nXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4sbyl7dmFyIHM9bmV3IEVycm9yKFwiUGFyYW1zIHZhbGlkYXRlIGZhaWxlZC5cIiksYT1cIlwiLmNvbmNhdCh0aGlzLmdldEVycm9yTWVzc2FnZShcIkFQSV9SRUZFUlwiKSkuY29uY2F0KGUpO3Rocm93IFZlLncoXCJbXCIuY29uY2F0KGUsXCJdIHwgXCIpLmNvbmNhdCh0LFwiIHwgXCIpLmNvbmNhdCh0aGlzLmdldEVycm9yTWVzc2FnZShuLG8pLFwiLCBcIikuY29uY2F0KGEpKSxWZS5lKFwiW1wiLmNvbmNhdChlLFwiXSBJbnZhbGlkIFwiKS5jb25jYXQodCxcIjogdHlwZSBjaGVjayBmYWlsZWQgZm9yIFwiKS5jb25jYXQodCxcIi5cIikpLHN9fSx7a2V5OlwiX2lzVmFsaWRDb252ZXJzYXRpb25JRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBFdChlKXx8U3QoZSl8fEx0KGUpfX0se2tleTpcImRlbGV0ZUNvbnZlcnNhdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cImRlbGV0ZUNvbnZlcnNhdGlvblwiO3JldHVybiBudChlKXx8b3QoZSl8fHRoaXMuX2Vycm9yTG9nKG4sXCJvcHRpb25zXCIsXCJTdHJpbmdPck9iamVjdFJlcXVpcmVkTG9nXCIpLG50KGUpPyh0aGlzLl9pc1ZhbGlkQ29udmVyc2F0aW9uSUQoZSl8fHRoaXMuX2Vycm9yTG9nKG4sXCJvcHRpb25zXCIsXCJJbnZhbGlkQ29udmVyc2F0aW9uSURcIixlKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChuLFwiIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQoZSkpLHRoaXMuZGVsZXRlQ29udmVyc2F0aW9uTGlzdCh7Y29udmVyc2F0aW9uSURMaXN0OltlXSxmbGFnOjF9KSk6KGF0KGUuY29udmVyc2F0aW9uSURMaXN0KXx8dGhpcy5fZXJyb3JMb2cobixcImNvbnZlcnNhdGlvbklETGlzdFwiLFwiQXJyYXlSZXF1aXJlZExvZ1wiKSwwPT09ZS5jb252ZXJzYXRpb25JRExpc3QubGVuZ3RoJiZ0aGlzLl9lcnJvckxvZyhuLFwiY29udmVyc2F0aW9uSURMaXN0XCIsXCJOb25FbXB0eUFycmF5TG9nXCIpLGUuY29udmVyc2F0aW9uSURMaXN0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2lzVmFsaWRDb252ZXJzYXRpb25JRChlKXx8dC5fZXJyb3JMb2cobixcImNvbnZlcnNhdGlvbklETGlzdFwiLFwiSW52YWxpZENvbnZlcnNhdGlvbklEXCIsZSl9KSksXCJjbGVhckhpc3RvcnlNZXNzYWdlXCJpbiBlJiZcImJvb2xlYW5cIiE9dHlwZW9mIGUuY2xlYXJIaXN0b3J5TWVzc2FnZSYmdGhpcy5fZXJyb3JMb2cobixcImNsZWFySGlzdG9yeU1lc3NhZ2VcIixcIkJvb2xlYW5SZXF1aXJlZExvZ1wiKSxlLmNvbnZlcnNhdGlvbklETGlzdC5sZW5ndGg+MTAwJiYoZS5jb252ZXJzYXRpb25JRExpc3Q9ZS5jb252ZXJzYXRpb25JRExpc3Quc2xpY2UoMCwxMDApKSx0aGlzLmRlbGV0ZUNvbnZlcnNhdGlvbkxpc3QoZSkpfX0se2tleTpcImRlbGV0ZUNvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5jb252ZXJzYXRpb25JRExpc3Qsbz12b2lkIDA9PT1uP1tdOm4scz1lLmNsZWFySGlzdG9yeU1lc3NhZ2UsYT12b2lkIDA9PT1zfHxzLGk9ZS5mbGFnLHI9dm9pZCAwPT09aT8wOmksdT1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJkZWxldGVDb252ZXJzYXRpb25MaXN0XCIpO1ZlLmwoXCJcIi5jb25jYXQodSxcIiBjb252ZXJzYXRpb25JRExpc3QubGVuZ3RoOlwiKS5jb25jYXQoby5sZW5ndGgsXCIgY2xlYXJIaXN0b3J5TWVzc2FnZTpcIikuY29uY2F0KGEpKTt2YXIgYz1uZXcgQWEoXCJkZWxldGVDb252ZXJzYXRpb25MaXN0XCIpO3JldHVybiBjLnNldE1lc3NhZ2UoXCJjb252ZXJzYXRpb25JRExpc3Q6XCIuY29uY2F0KG8pKSxQcm9taXNlLmFsbChbdGhpcy5ybUxvY2FsT25seUNvbnZlcnNhdGlvbkxpc3QobyksdGhpcy5ybUxvY2FsQW5kUmVtb3RlQ29udmVyc2F0aW9uTGlzdChvLGEpXSkudGhlbigoZnVuY3Rpb24oZSl7Yy5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpO3ZhciBuPVtdLmNvbmNhdChtKGVbMF0pLG0oZVsxXSkpO3JldHVybiAwPT09bi5sZW5ndGg/WmEobmV3IGphKHtjb2RlOmhhLkNPTlZFUlNBVElPTl9OT1RfRk9VTkR9KSk6KFZlLmwoXCJcIi5jb25jYXQodSxcIiBva1wiKSksWGEoMT09PXI/e2NvbnZlcnNhdGlvbklEOm5bMF19Ontjb252ZXJzYXRpb25JRExpc3Q6bn0pKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07Yy5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdCh1LFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcInJtTG9jYWxPbmx5Q29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7cmV0dXJuIGUuZmlsdGVyKChmdW5jdGlvbihlKXtpZighdC5fY29udmVyc2F0aW9uTWFwLmhhcyhlKSlyZXR1cm4hMTt2YXIgbj10LmdldExvY2FsQ29udmVyc2F0aW9uKGUpLnR5cGU7cmV0dXJuIG4hPT1FLkNPTlZfR1JPVVB8fHQuX2hhc0xvY2FsR3JvdXAoZSk/bj09PUUuQ09OVl9TWVNURU0mJih0LmdldE1vZHVsZShQbikuZGVsZXRlR3JvdXBTeXN0ZW1Ob3RpY2Uoe21lc3NhZ2VMaXN0OnQuX21lc3NhZ2VMaXN0SGFuZGxlci5nZXRMb2NhbE1lc3NhZ2VMaXN0KGUpfSksdC5kZWxldGVMb2NhbENvbnZlcnNhdGlvbihlKSwhMCk6KHQuZGVsZXRlTG9jYWxDb252ZXJzYXRpb24oZSksITApfSkpfX0se2tleTpcInJtTG9jYWxBbmRSZW1vdGVDb252ZXJzYXRpb25MaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLG89e2Zyb21BY2NvdW50OnRoaXMuZ2V0TXlVc2VySUQoKSxjb252ZXJzYXRpb25MaXN0OltdLGNsZWFySGlzdG9yeU1lc3NhZ2U6dD8xOjB9O3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKG4uX2NvbnZlcnNhdGlvbk1hcC5oYXMoZSkpe3ZhciB0PW4uZ2V0TG9jYWxDb252ZXJzYXRpb24oZSkudHlwZTt0PT09RS5DT05WX0MyQz9vLmNvbnZlcnNhdGlvbkxpc3QucHVzaCh7dG9BY2NvdW50OmUucmVwbGFjZSh0LFwiXCIpLHR5cGU6MX0pOnQ9PT1FLkNPTlZfR1JPVVAmJm4uX2hhc0xvY2FsR3JvdXAoZSkmJm8uY29udmVyc2F0aW9uTGlzdC5wdXNoKHt0b0dyb3VwSUQ6ZS5yZXBsYWNlKHQsXCJcIiksdHlwZToyfSl9fSkpLDA9PT1vLmNvbnZlcnNhdGlvbkxpc3QubGVuZ3RoP1tdOnRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOlBvLHJlcXVlc3REYXRhOm99KS50aGVuKChmdW5jdGlvbihlKXt2YXIgdD1bXTtyZXR1cm4gZS5kYXRhLnJlc3VsdExpc3QubGVuZ3RoPjAmJmUuZGF0YS5yZXN1bHRMaXN0Lm1hcCgoZnVuY3Rpb24oZSl7aWYoMD09PWUuY29kZSl7dmFyIG49MT09PWUudHlwZT9cIlwiLmNvbmNhdChFLkNPTlZfQzJDKS5jb25jYXQoZS50byk6XCJcIi5jb25jYXQoRS5DT05WX0dST1VQKS5jb25jYXQoZS5ncm91cElEKTt0LnB1c2gobil9fSkpLG4uZGVsZXRlTG9jYWxDb252ZXJzYXRpb25MaXN0KHQpLHR9KSl9fSx7a2V5OlwiY2xlYXJIaXN0b3J5TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj17ZnJvbUFjY291bnQ6dGhpcy5nZXRNeVVzZXJJRCgpLHRvQWNjb3VudDp2b2lkIDAsdHlwZTp2b2lkIDAsdG9Hcm91cElEOnZvaWQgMH07aWYoIXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5oYXMoZSkpcmV0dXJuIFphKHtjb2RlOmhhLkNPTlZFUlNBVElPTl9OT1RfRk9VTkR9KTt2YXIgbz10aGlzLl9jb252ZXJzYXRpb25NYXAuZ2V0KGUpLnR5cGU7aWYobz09PUUuQ09OVl9DMkMpbi50eXBlPTEsbi50b0FjY291bnQ9ZS5yZXBsYWNlKEUuQ09OVl9DMkMsXCJcIik7ZWxzZXtpZihvIT09RS5DT05WX0dST1VQKXJldHVybiBvPT09RS5DT05WX1NZU1RFTT8odGhpcy5nZXRNb2R1bGUoUG4pLmRlbGV0ZUdyb3VwU3lzdGVtTm90aWNlKHttZXNzYWdlTGlzdDp0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TG9jYWxNZXNzYWdlTGlzdChlKX0pLFhhKHtjb252ZXJzYXRpb25JRDplfSkpOlphKHtjb2RlOmhhLkNPTlZFUlNBVElPTl9VTl9SRUNPUkRFRF9UWVBFfSk7bi50eXBlPTIsbi50b0dyb3VwSUQ9ZS5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKX12YXIgcz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJjbGVhckhpc3RvcnlNZXNzYWdlXCIpLGE9bmV3IEFhKFwiY2xlYXJIaXN0b3J5TWVzc2FnZVwiKTtyZXR1cm4gYS5zZXRNZXNzYWdlKFwiY29udmVyc2F0aW9uSUQ6XCIuY29uY2F0KGUpKSxWZS5sKFwiXCIuY29uY2F0KHMsXCIuIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQoZSkpLHRoaXMuc2V0TWVzc2FnZVJlYWQoe2NvbnZlcnNhdGlvbklEOmV9KS50aGVuKChmdW5jdGlvbigpe3JldHVybiB0LnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpibyxyZXF1ZXN0RGF0YTpufSl9KSkudGhlbigoZnVuY3Rpb24oKXthLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChzLFwiIG9rXCIpKSx0Ll9tZXNzYWdlTGlzdEhhbmRsZXIucmVtb3ZlQnlDb252ZXJzYXRpb25JRChlKSx0LnNldENvbXBsZXRlZChlKTt2YXIgbj10LmdldExvY2FsQ29udmVyc2F0aW9uKGUpO3JldHVybiBuJiYobi51cGRhdGVMYXN0TWVzc2FnZSgpLHQuX3NvcnRDb252ZXJzYXRpb25MaXN0QW5kRW1pdEV2ZW50KCkpLFhhKHtjb252ZXJzYXRpb25JRDplfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2Euc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQocyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJwaW5Db252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5jb252ZXJzYXRpb25JRCxvPWUuaXNQaW5uZWQ7aWYoIXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5oYXMobikpcmV0dXJuIFphKHtjb2RlOmhhLkNPTlZFUlNBVElPTl9OT1RfRk9VTkR9KTt2YXIgcz10aGlzLmdldExvY2FsQ29udmVyc2F0aW9uKG4pO2lmKHMuaXNQaW5uZWQ9PT1vKXJldHVybiBYYSh7Y29udmVyc2F0aW9uSUQ6bn0pO3ZhciBhPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInBpbkNvbnZlcnNhdGlvblwiKSxpPW5ldyBBYShcInBpbkNvbnZlcnNhdGlvblwiKTtpLnNldE1lc3NhZ2UoXCJjb252ZXJzYXRpb25JRDpcIi5jb25jYXQobixcIiBpc1Bpbm5lZDpcIikuY29uY2F0KG8pKSxWZS5sKFwiXCIuY29uY2F0KGEsXCIuIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQobixcIiBpc1Bpbm5lZDpcIikuY29uY2F0KG8pKTt2YXIgcj1udWxsO3JldHVybiBFdChuKT9yPXt0eXBlOjEsdG9BY2NvdW50Om4ucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpfTpTdChuKSYmKHI9e3R5cGU6Mixncm91cElEOm4ucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIil9KSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp3byxyZXF1ZXN0RGF0YTp7ZnJvbUFjY291bnQ6dGhpcy5nZXRNeVVzZXJJRCgpLG9wZXJhdGlvblR5cGU6ITA9PT1vPzE6MixpdGVtTGlzdDpbcl19fSkudGhlbigoZnVuY3Rpb24oKXtyZXR1cm4gaS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQoYSxcIiBva1wiKSkscy5pc1Bpbm5lZCE9PW8mJihzLmlzUGlubmVkPW8sdC5fc29ydENvbnZlcnNhdGlvbkxpc3RBbmRFbWl0RXZlbnQoKSksWWEoe2NvbnZlcnNhdGlvbklEOm59KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07aS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChhLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcInNldE1lc3NhZ2VSZW1pbmRUeXBlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX21lc3NhZ2VSZW1pbmRIYW5kbGVyLnNldChlKX19LHtrZXk6XCJwYXRjaE1lc3NhZ2VSZW1pbmRUeXBlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5JRCxuPWUuaXNDMkNDb252ZXJzYXRpb24sbz1lLm1lc3NhZ2VSZW1pbmRUeXBlLHM9ITEsYT10aGlzLmdldExvY2FsQ29udmVyc2F0aW9uKG4/XCJcIi5jb25jYXQoRS5DT05WX0MyQykuY29uY2F0KHQpOlwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KHQpKTtyZXR1cm4gYSYmYS5tZXNzYWdlUmVtaW5kVHlwZSE9PW8mJihhLm1lc3NhZ2VSZW1pbmRUeXBlPW8scz0hMCksVmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnBhdGNoTWVzc2FnZVJlbWluZFR5cGUgb3B0aW9uczpcIiksZSxcInJldDpcIi5jb25jYXQocykpLHN9fSx7a2V5Olwib25DMkNNZXNzYWdlUmVtaW5kVHlwZVN5bmNlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQzJDTWVzc2FnZVJlbWluZFR5cGVTeW5jZWRcIik7VmUuZChuLGUpLGUuZGF0YUxpc3QuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYoIXp0KGUubXV0ZU5vdGlmaWNhdGlvbnNTeW5jKSl7dmFyIG8scz1lLm11dGVOb3RpZmljYXRpb25zU3luYyxhPXMudG8saT1zLnVwZGF0ZVNlcXVlbmNlLHI9cy5tdXRlRmxhZzt0Ll9tZXNzYWdlUmVtaW5kSGFuZGxlci5zZXRVcGRhdGVTZXF1ZW5jZShpKSwwPT09cj9vPUUuTVNHX1JFTUlORF9BQ1BUX0FORF9OT1RFOjE9PT1yP289RS5NU0dfUkVNSU5EX0RJU0NBUkQ6Mj09PXImJihvPUUuTVNHX1JFTUlORF9BQ1BUX05PVF9OT1RFKTt2YXIgdT0wO3QucGF0Y2hNZXNzYWdlUmVtaW5kVHlwZSh7SUQ6YSxpc0MyQ0NvbnZlcnNhdGlvbjohMCxtZXNzYWdlUmVtaW5kVHlwZTpvfSkmJih1Kz0xKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgdXBkYXRlQ291bnQ6XCIpLmNvbmNhdCh1KSksdT49MSYmdC5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKX19KSl9fSx7a2V5Olwib25Hcm91cE1lc3NhZ2VSZW1pbmRUeXBlU3luY2VkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uR3JvdXBNZXNzYWdlUmVtaW5kVHlwZVN5bmNlZCBvcHRpb25zOlwiKSxlKSx0aGlzLl9tZXNzYWdlUmVtaW5kSGFuZGxlci5vbkdyb3VwTWVzc2FnZVJlbWluZFR5cGVVcGRhdGVkKGUpfX0se2tleTpcImRlbGV0ZUxvY2FsQ29udmVyc2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9IShhcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSl8fGFyZ3VtZW50c1sxXSxuPXRoaXMuX2NvbnZlcnNhdGlvbk1hcC5oYXMoZSk7aWYoVmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmRlbGV0ZUxvY2FsQ29udmVyc2F0aW9uIGNvbnZlcnNhdGlvbklEOlwiKS5jb25jYXQoZSxcIiBoYXM6XCIpLmNvbmNhdChuKSksbiYmKHRoaXMuX2NvbnZlcnNhdGlvbk1hcC5kZWxldGUoZSksdGhpcy5fcm9hbWluZ01lc3NhZ2VLZXlBbmRUaW1lTWFwLmhhcyhlKSYmdGhpcy5fcm9hbWluZ01lc3NhZ2VLZXlBbmRUaW1lTWFwLmRlbGV0ZShlKSx0aGlzLl9yb2FtaW5nTWVzc2FnZVNlcXVlbmNlTWFwLmhhcyhlKSYmdGhpcy5fcm9hbWluZ01lc3NhZ2VTZXF1ZW5jZU1hcC5kZWxldGUoZSksdGhpcy5fc2V0U3RvcmFnZUNvbnZlcnNhdGlvbkxpc3QoKSx0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIucmVtb3ZlQnlDb252ZXJzYXRpb25JRChlKSx0aGlzLl9jb21wbGV0ZWRNYXAuZGVsZXRlKGUpLHQpKXt2YXIgbz0hdGhpcy5faXNUb3BpY0NvbnZlcnNhdGlvbihlKTt0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUobywhMSl9fX0se2tleTpcImRlbGV0ZUxvY2FsQ29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj0wLG89ITE7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Ll9jb252ZXJzYXRpb25NYXAuaGFzKGUpJiYobis9dC5fY29udmVyc2F0aW9uTWFwLmdldChlKS51bnJlYWRDb3VudHx8MCx0LmRlbGV0ZUxvY2FsQ29udmVyc2F0aW9uKGUsITEpLG89ITApfSkpLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5kZWxldGVMb2NhbENvbnZlcnNhdGlvbkxpc3QgY29udmVyc2F0aW9uSURMaXN0Lmxlbmd0aDpcIikuY29uY2F0KGUubGVuZ3RoLFwiIGlzQ29udklERXhpc3RlZDpcIikuY29uY2F0KG8pKSxvJiYodGhpcy5lbWl0Q29udmVyc2F0aW9uVXBkYXRlKCEwLCExKSxuPjAmJnRoaXMuZW1pdFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50VXBkYXRlKCkpfX0se2tleTpcImlzTWVzc2FnZVNlbnRCeUN1cnJlbnRJbnN0YW5jZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiEoIXRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5oYXNMb2NhbE1lc3NhZ2UoZS5jb252ZXJzYXRpb25JRCxlLklEKSYmIXRoaXMuc2luZ2x5TGlua2VkTGlzdC5oYXMoZS5yYW5kb20pKX19LHtrZXk6XCJtb2RpZnlNZXNzYWdlTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGUuc3RhcnRzV2l0aChFLkNPTlZfQzJDKSYmdGhpcy5fY29udmVyc2F0aW9uTWFwLmhhcyhlKSl7dmFyIHQ9dGhpcy5fY29udmVyc2F0aW9uTWFwLmdldChlKSxuPURhdGUubm93KCk7dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLm1vZGlmeU1lc3NhZ2VTZW50QnlQZWVyKHtjb252ZXJzYXRpb25JRDplLGxhdGVzdE5pY2s6dC51c2VyUHJvZmlsZS5uaWNrLGxhdGVzdEF2YXRhcjp0LnVzZXJQcm9maWxlLmF2YXRhcn0pO3ZhciBvPXRoaXMuZ2V0TW9kdWxlKEduKS5nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQodGhpcy5nZXRNeVVzZXJJRCgpKTt0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIubW9kaWZ5TWVzc2FnZVNlbnRCeU1lKHtjb252ZXJzYXRpb25JRDplLGxhdGVzdE5pY2s6by5uaWNrLGxhdGVzdEF2YXRhcjpvLmF2YXRhcn0pLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5tb2RpZnlNZXNzYWdlTGlzdCBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KGUsXCIgY29zdCBcIikuY29uY2F0KERhdGUubm93KCktbixcIiBtc1wiKSl9fX0se2tleTpcInVwZGF0ZVVzZXJQcm9maWxlU3BlY2lmaWVkS2V5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnVwZGF0ZVVzZXJQcm9maWxlU3BlY2lmaWVkS2V5IG9wdGlvbnM6XCIpLGUpO3ZhciB0PWUuY29udmVyc2F0aW9uSUQsbj1lLm5pY2ssbz1lLmF2YXRhcjtpZih0aGlzLl9jb252ZXJzYXRpb25NYXAuaGFzKHQpKXt2YXIgcz10aGlzLl9jb252ZXJzYXRpb25NYXAuZ2V0KHQpLnVzZXJQcm9maWxlO250KG4pJiZzLm5pY2shPT1uJiYocy5uaWNrPW4pLG50KG8pJiZzLmF2YXRhciE9PW8mJihzLmF2YXRhcj1vKSx0aGlzLmVtaXRDb252ZXJzYXRpb25VcGRhdGUoITAsITEpfX19LHtrZXk6XCJfb25NeVByb2ZpbGVNb2RpZmllZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz10aGlzLmdldExvY2FsQ29udmVyc2F0aW9uTGlzdCgpLHM9RGF0ZS5ub3coKTtvLmZvckVhY2goKGZ1bmN0aW9uKG8pe24ubW9kaWZ5TWVzc2FnZVNlbnRCeU1lKHQoe2NvbnZlcnNhdGlvbklEOm8uY29udmVyc2F0aW9uSUR9LGUpKX0pKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uTXlQcm9maWxlTW9kaWZpZWQuIG1vZGlmeSBhbGwgbWVzc2FnZXMgc2VudCBieSBtZSwgY29zdCBcIikuY29uY2F0KERhdGUubm93KCktcyxcIiBtc1wiKSl9fSx7a2V5OlwibW9kaWZ5TWVzc2FnZVNlbnRCeU1lXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLm1vZGlmeU1lc3NhZ2VTZW50QnlNZShlKX19LHtrZXk6XCJnZXRMYXRlc3RNZXNzYWdlU2VudEJ5TWVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbWVzc2FnZUxpc3RIYW5kbGVyLmdldExhdGVzdE1lc3NhZ2VTZW50QnlNZShlKX19LHtrZXk6XCJtb2RpZnlNZXNzYWdlU2VudEJ5UGVlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5tb2RpZnlNZXNzYWdlU2VudEJ5UGVlcihlKX19LHtrZXk6XCJnZXRMYXRlc3RNZXNzYWdlU2VudEJ5UGVlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TGF0ZXN0TWVzc2FnZVNlbnRCeVBlZXIoZSl9fSx7a2V5OlwicHVzaEludG9Ob3RpY2VSZXN1bHRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiEoIXRoaXMuX21lc3NhZ2VMaXN0SGFuZGxlci5wdXNoSW4odCl8fHRoaXMuc2luZ2x5TGlua2VkTGlzdC5oYXModC5yYW5kb20pKSYmKGUucHVzaCh0KSwhMCl9fSx7a2V5OlwiZ2V0TG9jYWxMYXN0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIuZ2V0TG9jYWxMYXN0TWVzc2FnZShlKX19LHtrZXk6XCJjaGVja0FuZFBhdGNoUmVtYXJrXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1Qcm9taXNlLnJlc29sdmUoKTtpZigwPT09dGhpcy5fY29udmVyc2F0aW9uTWFwLnNpemUpcmV0dXJuIGU7dmFyIHQ9dGhpcy5nZXRNb2R1bGUoYm4pO2lmKCF0KXJldHVybiBlO3ZhciBuPW0odGhpcy5fY29udmVyc2F0aW9uTWFwLnZhbHVlcygpKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT1FLkNPTlZfQzJDfSkpO2lmKDA9PT1uLmxlbmd0aClyZXR1cm4gZTt2YXIgbz0wO3JldHVybiBuLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPWUuY29udmVyc2F0aW9uSUQucmVwbGFjZShFLkNPTlZfQzJDLFwiXCIpO2lmKHQuaXNNeUZyaWVuZChuKSl7dmFyIHM9dC5nZXRGcmllbmRSZW1hcmsobik7ZS5yZW1hcmshPT1zJiYoZS5yZW1hcms9cyxvKz0xKX19KSksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmNoZWNrQW5kUGF0Y2hSZW1hcmsuIGMyYyBjb252ZXJzYXRpb24gY291bnQ6XCIpLmNvbmNhdChuLmxlbmd0aCxcIiwgcGF0Y2hlZCBjb3VudDpcIikuY29uY2F0KG8pKSxlfX0se2tleTpcInVwZGF0ZVRvcGljQ29udmVyc2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fdXBkYXRlTG9jYWxDb252ZXJzYXRpb25MaXN0KHtjb252ZXJzYXRpb25PcHRpb25zTGlzdDplLGlzRnJvbUdldENvbnZlcnNhdGlvbnM6ITB9KX19LHtrZXk6XCJzZW5kUmVhZFJlY2VpcHRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lWzBdLG49bnVsbDtyZXR1cm4gdC5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0MyQz9uPXRoaXMuX20uZ2V0TW9kdWxlKFVuKTp0LmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfR1JPVVAmJihuPXRoaXMuX20uZ2V0TW9kdWxlKFBuKSksbj9uLnNlbmRSZWFkUmVjZWlwdChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJnZXRSZWFkUmVjZWlwdExpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lWzBdLG49bnVsbDtyZXR1cm4gdC5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0MyQz9uPXRoaXMuX20uZ2V0TW9kdWxlKFVuKTp0LmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfR1JPVVAmJihuPXRoaXMuX20uZ2V0TW9kdWxlKFBuKSksbj9uLmdldFJlYWRSZWNlaXB0TGlzdChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJnZXRMYXN0TWVzc2FnZVRpbWVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldExvY2FsQ29udmVyc2F0aW9uKGUpO3JldHVybiB0P3QubGFzdE1lc3NhZ2UubGFzdFRpbWU6MH19LHtrZXk6XCJnZXRUb3RhbFVucmVhZE1lc3NhZ2VDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKSx0PTA7cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS50eXBlIT09RS5DT05WX1NZU1RFTSYmKFwiXCIhPT1lLm1lc3NhZ2VSZW1pbmRUeXBlJiZlLm1lc3NhZ2VSZW1pbmRUeXBlIT09RS5NU0dfUkVNSU5EX0FDUFRfQU5EX05PVEV8fCh0Kz1lLnVucmVhZENvdW50KSl9KSksdH19LHtrZXk6XCJlbWl0VG90YWxVbnJlYWRNZXNzYWdlQ291bnRVcGRhdGVcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0VG90YWxVbnJlYWRNZXNzYWdlQ291bnQoKTt0aGlzLl9jb252VG90YWxVbnJlYWRDb3VudCE9PWUmJihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuZW1pdFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50VXBkYXRlIGZyb20gXCIpLmNvbmNhdCh0aGlzLl9jb252VG90YWxVbnJlYWRDb3VudCxcIiB0byBcIikuY29uY2F0KGUpKSx0aGlzLl9jb252VG90YWxVbnJlYWRDb3VudD1lLHRoaXMuZW1pdE91dGVyRXZlbnQoay5UT1RBTF9VTlJFQURfTUVTU0FHRV9DT1VOVF9VUERBVEVEKSl9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSksdGhpcy5fcGFnaW5nU3RhdHVzPSR0Lk5PVF9TVEFSVCx0aGlzLl9tZXNzYWdlTGlzdEhhbmRsZXIucmVzZXQoKSx0aGlzLl9tZXNzYWdlUmVtaW5kSGFuZGxlci5yZXNldCgpLHRoaXMuX3JvYW1pbmdNZXNzYWdlS2V5QW5kVGltZU1hcC5jbGVhcigpLHRoaXMuX3JvYW1pbmdNZXNzYWdlU2VxdWVuY2VNYXAuY2xlYXIoKSx0aGlzLnNpbmdseUxpbmtlZExpc3QucmVzZXQoKSx0aGlzLl9wZWVyUmVhZFRpbWVNYXAuY2xlYXIoKSx0aGlzLl9jb21wbGV0ZWRNYXAuY2xlYXIoKSx0aGlzLl9jb252ZXJzYXRpb25NYXAuY2xlYXIoKSx0aGlzLl9wYWdpbmdUaW1lU3RhbXA9MCx0aGlzLl9wYWdpbmdTdGFydEluZGV4PTAsdGhpcy5fcGFnaW5nUGlubmVkVGltZVN0YW1wPTAsdGhpcy5fcGFnaW5nUGlubmVkU3RhcnRJbmRleD0wLHRoaXMuX3JlbW90ZUdyb3VwUmVhZFNlcXVlbmNlTWFwLmNsZWFyKCksdGhpcy5fY29udlRvdGFsVW5yZWFkQ291bnQ9MCx0aGlzLl9wYWdpbmdHZXRDb3N0TGlzdC5sZW5ndGg9MCx0aGlzLnJlc2V0UmVhZHkoKX19XSksc30odW8pLHlpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fZ3JvdXBNb2R1bGU9dCx0aGlzLl9uPVwiR3JvdXBUaXBzSGFuZGxlclwiLHRoaXMuX2NhY2hlZEdyb3VwVGlwc01hcD1uZXcgTWFwLHRoaXMuX2NoZWNrQ291bnRNYXA9bmV3IE1hcCx0aGlzLk1BWF9DSEVDS19DT1VOVD00LHRoaXMuX2dldFRvcGljUGVuZGluZ01hcD1uZXcgTWFwfXJldHVybiBhKGUsW3trZXk6XCJvbkNoZWNrVGltZXJcIix2YWx1ZTpmdW5jdGlvbihlKXtlJTE9PTAmJnRoaXMuX2NhY2hlZEdyb3VwVGlwc01hcC5zaXplPjAmJnRoaXMuX2NoZWNrQ2FjaGVkR3JvdXBUaXBzKCl9fSx7a2V5OlwiX2NoZWNrQ2FjaGVkR3JvdXBUaXBzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX2NhY2hlZEdyb3VwVGlwc01hcC5mb3JFYWNoKChmdW5jdGlvbih0LG4pe3ZhciBvPWUuX2NoZWNrQ291bnRNYXAuZ2V0KG4pLHM9ZS5fZ3JvdXBNb2R1bGUuaGFzTG9jYWxHcm91cChuKTtWZS5sKFwiXCIuY29uY2F0KGUuX24sXCIuX2NoZWNrQ2FjaGVkR3JvdXBUaXBzIGdyb3VwSUQ6XCIpLmNvbmNhdChuLFwiIGhhc0xvY2FsR3JvdXA6XCIpLmNvbmNhdChzLFwiIGNoZWNrQ291bnQ6XCIpLmNvbmNhdChvKSkscz8oZS5fbm90aWZ5Q2FjaGVkR3JvdXBUaXBzKG4pLGUuX2NoZWNrQ291bnRNYXAuZGVsZXRlKG4pLGUuX2dyb3VwTW9kdWxlLmRlbGV0ZVVuam9pbmVkQVZDaGF0Um9vbShuKSk6bz49ZS5NQVhfQ0hFQ0tfQ09VTlQ/KGUuX2RlbGV0ZUNhY2hlZEdyb3VwVGlwcyhuKSxlLl9jaGVja0NvdW50TWFwLmRlbGV0ZShuKSk6KG8rKyxlLl9jaGVja0NvdW50TWFwLnNldChuLG8pKX0pKX19LHtrZXk6XCJvbk5ld0dyb3VwVGlwc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vblJlY2VpdmVHcm91cFRpcHMgY291bnQ6XCIpLmNvbmNhdChlLmRhdGFMaXN0Lmxlbmd0aCkpO3ZhciB0PXRoaXMubmV3R3JvdXBUaXBzU3RvcmVkQW5kU3VtbWFyeShlKSxuPXQuZXZlbnREYXRhTGlzdCxvPXQucmVzdWx0LHM9dC5BVkNoYXRSb29tTWVzc2FnZUxpc3Q7KHMubGVuZ3RoPjAmJnRoaXMuX2dyb3VwTW9kdWxlLm9uQVZDaGF0Um9vbU1lc3NhZ2Uocyksbi5sZW5ndGg+MCkmJih0aGlzLl9ncm91cE1vZHVsZS51cGRhdGVOZXh0TWVzc2FnZVNlcShuKSx0aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUocW4pLm9uTmV3TWVzc2FnZSh7Y29udmVyc2F0aW9uT3B0aW9uc0xpc3Q6bixpc0luc3RhbnRNZXNzYWdlOiEwfSkpO28ubGVuZ3RoPjAmJih0aGlzLl9ncm91cE1vZHVsZS5lbWl0T3V0ZXJFdmVudChrLk1FU1NBR0VfUkVDRUlWRUQsbyksdGhpcy5oYW5kbGVNZXNzYWdlTGlzdChvKSl9fSx7a2V5OlwibmV3R3JvdXBUaXBzU3RvcmVkQW5kU3VtbWFyeVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgbj10aGlzLG89ZS5ldmVudCxzPWUuZGF0YUxpc3QsYT1udWxsLGk9W10scj1bXSx1PXt9LGM9W10sbD1mdW5jdGlvbihlLGwpe3ZhciBkPUl0KHNbZV0pO2lmKDY9PT1vKXtpZihuLl9ncm91cE1vZHVsZS5pc0dyb3VwQXR0cmlidXRlc1VwZGF0ZWROb3RpY2UoZCkpcmV0dXJuXCJjb250aW51ZVwiO2lmKG4uX2dyb3VwTW9kdWxlLmlzR3JvdXBDb3VudGVyc05vdGljZShkKSlyZXR1cm5cImNvbnRpbnVlXCJ9dmFyIHA9ZC5ncm91cFByb2ZpbGUsZz1wLmdyb3VwSUQsaD1wLmNvbW11bml0eVR5cGUsXz12b2lkIDA9PT1oPzA6aCxmPXAudG9waWNJRCx2PXZvaWQgMD09PWY/dm9pZCAwOmYsbT1wLmludmlzaWJsZSxNPXZvaWQgMCx5PW4uX2dyb3VwTW9kdWxlLmlzTWVzc2FnZUZyb21Ub3BpYyhfLHYpO2lmKHkpe009RS5DT05WX1RPUElDLGQudG89djt2YXIgST1uLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUoRm4pO0kuaGFzTG9jYWxUb3BpYyhnLHYpfHxuLl9nZXRUb3BpY1BlbmRpbmdNYXAuaGFzKHYpfHwobi5fZ2V0VG9waWNQZW5kaW5nTWFwLnNldCh2LDEpLEkuZ2V0VG9waWNMaXN0KHtncm91cElEOmcsdG9waWNJRExpc3Q6W3ZdfSkuZmluYWxseSgoZnVuY3Rpb24oKXtuLl9nZXRUb3BpY1BlbmRpbmdNYXAuZGVsZXRlKHYpfSkpKX12YXIgQz1uLl9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKGcpO2lmKCFDJiZuLl9ncm91cE1vZHVsZS5pc1Vuam9pbmVkQVZDaGF0Um9vbShnKSlyZXR1cm5cImNvbnRpbnVlXCI7aWYoIUMmJiF5KXJldHVybiBuLl9jYWNoZUdyb3VwVGlwc0FuZFByb2JlKHtncm91cElEOmcsZXZlbnQ6byxpdGVtOmR9KSxcImNvbnRpbnVlXCI7aWYobi5fZ3JvdXBNb2R1bGUuaXNNZXNzYWdlRnJvbU9yVG9BVkNoYXRyb29tKGcpKXJldHVybiBkLmV2ZW50PW8sYy5wdXNoKGQpLFwiY29udGludWVcIjtpZihkLmN1cnJlbnRVc2VyPW4uX2dyb3VwTW9kdWxlLmdldE15VXNlcklEKCksZC5jb252ZXJzYXRpb25UeXBlPUUuQ09OVl9HUk9VUCwoYT1uZXcgV2EoZCkpLnNldEVsZW1lbnQoe3R5cGU6RS5NU0dfR1JQX1RJUCxjb250ZW50OnQodCh7fSxkLmVsZW1lbnRzKSx7fSx7Z3JvdXBQcm9maWxlOmQuZ3JvdXBQcm9maWxlfSl9KSxhLmlzU3lzdGVtTWVzc2FnZT0hMSwxPT09bSlyZXR1cm4gbi5fcXVhbGl0eVN0YXQoYSksXCJjb250aW51ZVwiO3ZhciBUPW4uX2dyb3VwTW9kdWxlLmdldE1vZHVsZShxbiksRD1hLGs9RC5jb252ZXJzYXRpb25JRCxTPUQuc2VxdWVuY2U7aWYoNj09PW8pYS5fb25saW5lT25seUZsYWc9ITAsci5wdXNoKGEpO2Vsc2UgaWYoIVQucHVzaEludG9Ob3RpY2VSZXN1bHQocixhKSlyZXR1cm5cImNvbnRpbnVlXCI7aWYobi5fZ3JvdXBNb2R1bGUuaXNNZXNzYWdlRnJvbUNvbW11bml0eU9mVG9waWMoXyx2KSlyZXR1cm5cImNvbnRpbnVlXCI7aWYoNj09PW8mJlQuZ2V0TG9jYWxDb252ZXJzYXRpb24oaykpcmV0dXJuXCJjb250aW51ZVwiOzYhPT1vJiZuLl9xdWFsaXR5U3RhdChhKTt2YXIgTD1ULmlzUmVtb3RlUmVhZCh7Y29udmVyc2F0aW9uSUQ6ayxzZXF1ZW5jZTpTfSk7aWYoaXQodVtrXSkpe3ZhciBBPTA7XCJpblwiPT09YS5mbG93JiYoYS5faXNFeGNsdWRlZEZyb21VbnJlYWRDb3VudHx8YS5fb25saW5lT25seUZsYWd8fEx8fChBPTEpKSx1W2tdPWkucHVzaCh7Y29udmVyc2F0aW9uSUQ6ayx1bnJlYWRDb3VudDpBLHR5cGU6aXQoTSk/YS5jb252ZXJzYXRpb25UeXBlOk0sc3ViVHlwZTphLmNvbnZlcnNhdGlvblN1YlR5cGUsbGFzdE1lc3NhZ2U6YS5faXNFeGNsdWRlZEZyb21MYXN0TWVzc2FnZT9cIlwiOmF9KS0xfWVsc2V7dmFyIFI9dVtrXTtpW1JdLnR5cGU9YS5jb252ZXJzYXRpb25UeXBlLGlbUl0uc3ViVHlwZT1hLmNvbnZlcnNhdGlvblN1YlR5cGUsaVtSXS5sYXN0TWVzc2FnZT1hLl9pc0V4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlP1wiXCI6YSxcImluXCI9PT1hLmZsb3cmJihhLl9pc0V4Y2x1ZGVkRnJvbVVucmVhZENvdW50fHxhLl9vbmxpbmVPbmx5RmxhZ3x8THx8aVtSXS51bnJlYWRDb3VudCsrKX19LGQ9MCxwPXMubGVuZ3RoO2Q8cDtkKyspbChkKTtyZXR1cm57ZXZlbnREYXRhTGlzdDppLHJlc3VsdDpyLEFWQ2hhdFJvb21NZXNzYWdlTGlzdDpjfX19LHtrZXk6XCJfcXVhbGl0eVN0YXRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUoZW8pLmFkZE1lc3NhZ2VTZXF1ZW5jZSh7a2V5OkNhLG1lc3NhZ2U6ZX0pfX0se2tleTpcImhhbmRsZU1lc3NhZ2VMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3N3aXRjaChlLnBheWxvYWQub3BlcmF0aW9uVHlwZSl7Y2FzZSAxOnQuX29uTmV3TWVtYmVyQ29tZUluKGUpO2JyZWFrO2Nhc2UgMjp0Ll9vbk1lbWJlclF1aXQoZSk7YnJlYWs7Y2FzZSAzOnQuX29uTWVtYmVyS2lja2VkT3V0KGUpO2JyZWFrO2Nhc2UgNDp0Ll9vbk1lbWJlclNldEFkbWluKGUpO2JyZWFrO2Nhc2UgNTp0Ll9vbk1lbWJlckNhbmNlbGxlZEFkbWluKGUpO2JyZWFrO2Nhc2UgNjp0Ll9vbkdyb3VwUHJvZmlsZU1vZGlmaWVkKGUpO2JyZWFrO2Nhc2UgNzp0Ll9vbk1lbWJlckluZm9Nb2RpZmllZChlKTticmVhaztjYXNlIDg6dC5fb25Ub3BpY1Byb2ZpbGVVcGRhdGVkKGUpO2JyZWFrO2RlZmF1bHQ6VmUudyhcIlwiLmNvbmNhdCh0Ll9uLFwiLmhhbmRsZU1lc3NhZ2VMaXN0IHVua25vd24gb3BlcmF0aW9uVHlwZTpcIikuY29uY2F0KGUucGF5bG9hZC5vcGVyYXRpb25UeXBlKSl9fSkpfX0se2tleTpcIl9vbk5ld01lbWJlckNvbWVJblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGF5bG9hZCxuPXQubWVtYmVyTnVtLG89dC5ncm91cFByb2ZpbGUuZ3JvdXBJRCxzPXRoaXMuX2dyb3VwTW9kdWxlLmdldExvY2FsR3JvdXBQcm9maWxlKG8pO3MmJmV0KG4pJiZzLm1lbWJlckNvdW50IT09biYmKHMubWVtYmVyQ291bnQ9bix0aGlzLl91cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUocykpfX0se2tleTpcIl9vbk1lbWJlclF1aXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnBheWxvYWQsbj10Lm1lbWJlck51bSxvPXQuZ3JvdXBQcm9maWxlLmdyb3VwSUQscz10aGlzLl9ncm91cE1vZHVsZS5nZXRMb2NhbEdyb3VwUHJvZmlsZShvKTtzJiZldChuKSYmcy5tZW1iZXJDb3VudCE9PW4mJihzLm1lbWJlckNvdW50PW4sdGhpcy5fdXBkYXRlQ29udmVyc2F0aW9uR3JvdXBQcm9maWxlKHMpKSx0aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUod24pLmRlbGV0ZUxvY2FsR3JvdXBNZW1iZXJzKG8sZS5wYXlsb2FkLnVzZXJJRExpc3QpfX0se2tleTpcIl9vbk1lbWJlcktpY2tlZE91dFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGF5bG9hZCxuPXQubWVtYmVyTnVtLG89dC5ncm91cFByb2ZpbGUuZ3JvdXBJRCxzPXRoaXMuX2dyb3VwTW9kdWxlLmdldExvY2FsR3JvdXBQcm9maWxlKG8pO3MmJmV0KG4pJiZzLm1lbWJlckNvdW50IT09biYmKHMubWVtYmVyQ291bnQ9bix0aGlzLl91cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUocykpLHRoaXMuX2dyb3VwTW9kdWxlLmdldE1vZHVsZSh3bikuZGVsZXRlTG9jYWxHcm91cE1lbWJlcnMobyxlLnBheWxvYWQudXNlcklETGlzdCl9fSx7a2V5OlwiX3VwZGF0ZUNvbnZlcnNhdGlvbkdyb3VwUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShxbikudXBkYXRlQ29udmVyc2F0aW9uR3JvdXBQcm9maWxlKFtlXSl9fSx7a2V5OlwiX29uTWVtYmVyU2V0QWRtaW5cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnBheWxvYWQuZ3JvdXBQcm9maWxlLmdyb3VwSUQsbj1lLnBheWxvYWQudXNlcklETGlzdCxvPXRoaXMuX2dyb3VwTW9kdWxlLmdldE1vZHVsZSh3bik7bi5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgbj1vLmdldExvY2FsR3JvdXBNZW1iZXJJbmZvKHQsZSk7biYmbi51cGRhdGVSb2xlKEUuR1JQX01CUl9ST0xFX0FETUlOKX0pKX19LHtrZXk6XCJfb25NZW1iZXJDYW5jZWxsZWRBZG1pblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGF5bG9hZC5ncm91cFByb2ZpbGUuZ3JvdXBJRCxuPWUucGF5bG9hZC51c2VySURMaXN0LG89dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TW9kdWxlKHduKTtuLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPW8uZ2V0TG9jYWxHcm91cE1lbWJlckluZm8odCxlKTtuJiZuLnVwZGF0ZVJvbGUoRS5HUlBfTUJSX1JPTEVfTUVNQkVSKX0pKX19LHtrZXk6XCJfb25Hcm91cFByb2ZpbGVNb2RpZmllZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLnBheWxvYWQsbz1uLm5ld0dyb3VwUHJvZmlsZSxzPW4uZ3JvdXBQcm9maWxlLmdyb3VwSUQsYT10aGlzLl9ncm91cE1vZHVsZS5nZXRMb2NhbEdyb3VwUHJvZmlsZShzKTtPYmplY3Qua2V5cyhvKS5mb3JFYWNoKChmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZVwib3duZXJJRFwiOnQuX293bmVyQ2hhbmdlZChhLG8pO2JyZWFrO2Nhc2VcImdyb3VwTmFtZVwiOmEubmFtZT1vW2VdO2JyZWFrO2RlZmF1bHQ6YVtlXT1vW2VdfX0pKTt2YXIgaT0hYS5pc1N1cHBvcnRUb3BpYzt0aGlzLl9ncm91cE1vZHVsZS5lbWl0R3JvdXBMaXN0VXBkYXRlKCEwLGkpfX0se2tleTpcIl9vd25lckNoYW5nZWRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPWUuZ3JvdXBJRCxvPXRoaXMuX2dyb3VwTW9kdWxlLmdldExvY2FsR3JvdXBQcm9maWxlKG4pLHM9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TXlVc2VySUQoKTtpZihzPT09dC5vd25lcklEKXtvLnVwZGF0ZUdyb3VwKHtzZWxmSW5mbzp7cm9sZTpFLkdSUF9NQlJfUk9MRV9PV05FUn19KTt2YXIgYT10aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUod24pLGk9YS5nZXRMb2NhbEdyb3VwTWVtYmVySW5mbyhuLHMpLHI9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TG9jYWxHcm91cFByb2ZpbGUobikub3duZXJJRCx1PWEuZ2V0TG9jYWxHcm91cE1lbWJlckluZm8obixyKTtpJiZpLnVwZGF0ZVJvbGUoRS5HUlBfTUJSX1JPTEVfT1dORVIpLHUmJnUudXBkYXRlUm9sZShFLkdSUF9NQlJfUk9MRV9NRU1CRVIpfX19LHtrZXk6XCJfb25NZW1iZXJJbmZvTW9kaWZpZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnRvLG49ZS5wYXlsb2FkLG89bi5ncm91cFByb2ZpbGUscz1uLm1lbWJlckxpc3QsYT1vLmdyb3VwSUQ7a3QodCkmJnRoaXMuX3VwZGF0ZVRvcGljTXV0ZVRpbWUoZSk7dmFyIGk9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TW9kdWxlKHduKTtzLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWkuZ2V0TG9jYWxHcm91cE1lbWJlckluZm8oYSxlLnVzZXJJRCk7dCYmZXQoZS5tdXRlVGltZSkmJnQudXBkYXRlTXV0ZVVudGlsKGUubXV0ZVRpbWUpfSkpfX0se2tleTpcIl91cGRhdGVUb3BpY011dGVUaW1lXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50byxuPWUucGF5bG9hZCxvPW4uZ3JvdXBQcm9maWxlLHM9bi5tZW1iZXJMaXN0LGE9dm9pZCAwPT09cz9bXTpzLGk9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TW9kdWxlKEZuKSxyPW8uZ3JvdXBJRCx1PWkuZ2V0TG9jYWxUb3BpYyhyLHQpO2lmKHUpe2Zvcih2YXIgYz0hMSxsPTA7bDxhLmxlbmd0aDtsKyspe3ZhciBkPWFbbF07aWYoZC51c2VySUQ9PT10aGlzLl9ncm91cE1vZHVsZS5nZXRNeVVzZXJJRCgpJiZkLm11dGVUaW1lPj0wKXt1LnVwZGF0ZVNlbGZJbmZvKHttdXRlVGltZTpkLm11dGVUaW1lfSksYz0hMDticmVha319YyYmdGhpcy5fZ3JvdXBNb2R1bGUuZW1pdE91dGVyRXZlbnQoay5UT1BJQ19VUERBVEVELHtncm91cElEOnIsdG9waWM6dX0pfX19LHtrZXk6XCJfb25Ub3BpY1Byb2ZpbGVVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIG49ZS5wYXlsb2FkLG89bi5ncm91cFByb2ZpbGUuZ3JvdXBJRCxzPW4ubmV3VG9waWNJbmZvO3RoaXMuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShGbikub25Ub3BpY1Byb2ZpbGVVcGRhdGVkKHQoe2dyb3VwSUQ6byx0b3BpY0lEOmUudG99LHMpKX19LHtrZXk6XCJfY2FjaGVHcm91cFRpcHNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX2NhY2hlZEdyb3VwVGlwc01hcC5oYXMoZSl8fHRoaXMuX2NhY2hlZEdyb3VwVGlwc01hcC5zZXQoZSxbXSksdGhpcy5fY2FjaGVkR3JvdXBUaXBzTWFwLmdldChlKS5wdXNoKHQpfX0se2tleTpcIl9kZWxldGVDYWNoZWRHcm91cFRpcHNcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jYWNoZWRHcm91cFRpcHNNYXAuaGFzKGUpJiZ0aGlzLl9jYWNoZWRHcm91cFRpcHNNYXAuZGVsZXRlKGUpfX0se2tleTpcIl9ub3RpZnlDYWNoZWRHcm91cFRpcHNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49dGhpcy5fY2FjaGVkR3JvdXBUaXBzTWFwLmdldChlKXx8W107bi5mb3JFYWNoKChmdW5jdGlvbihlKXt0Lm9uTmV3R3JvdXBUaXBzKGUpfSkpLHRoaXMuX2RlbGV0ZUNhY2hlZEdyb3VwVGlwcyhlKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX25vdGlmeUNhY2hlZEdyb3VwVGlwcyBncm91cElEOlwiKS5jb25jYXQoZSxcIiBjb3VudDpcIikuY29uY2F0KG4ubGVuZ3RoKSl9fSx7a2V5OlwiX2NhY2hlR3JvdXBUaXBzQW5kUHJvYmVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ncm91cElELG89ZS5ldmVudCxzPWUuaXRlbTt0aGlzLl9jYWNoZUdyb3VwVGlwcyhuLHtldmVudDpvLGRhdGFMaXN0OltzXX0pLHRoaXMuX2dyb3VwTW9kdWxlLmdldEdyb3VwU2ltcGxpZmllZEluZm8obikudGhlbigoZnVuY3Rpb24oZSl7ZS50eXBlPT09RS5HUlBfQVZDSEFUUk9PTT90Ll9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKG4pP3QuX25vdGlmeUNhY2hlZEdyb3VwVGlwcyhuKTp0Ll9ncm91cE1vZHVsZS5zZXRVbmpvaW5lZEFWQ2hhdFJvb20obik6KHQuX2dyb3VwTW9kdWxlLnVwZGF0ZUdyb3VwTWFwKFtlXSksdC5fbm90aWZ5Q2FjaGVkR3JvdXBUaXBzKG4pKX0pKSx0aGlzLl9jaGVja0NvdW50TWFwLmhhcyhuKXx8dGhpcy5fY2hlY2tDb3VudE1hcC5zZXQobiwwKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2NhY2hlR3JvdXBUaXBzQW5kUHJvYmUgZ3JvdXBJRDpcIikuY29uY2F0KG4pKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fY2FjaGVkR3JvdXBUaXBzTWFwLmNsZWFyKCksdGhpcy5fY2hlY2tDb3VudE1hcC5jbGVhcigpLHRoaXMuX2dldFRvcGljUGVuZGluZ01hcC5jbGVhcigpfX1dKSxlfSgpLElpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fZ3JvdXBNb2R1bGU9dCx0aGlzLl9uPVwiQ29tbW9uR3JvdXBIYW5kbGVyXCIsdGhpcy50ZW1wQ29udmVyc2F0aW9uTGlzdD1udWxsLHRoaXMuX2NhY2hlZEdyb3VwTWVzc2FnZU1hcD1uZXcgTWFwLHRoaXMuX2NoZWNrQ291bnRNYXA9bmV3IE1hcCx0aGlzLk1BWF9DSEVDS19DT1VOVD00LHRoaXMuX2dldFRvcGljUGVuZGluZ01hcD1uZXcgTWFwLHRoaXMuX2lzUGFnaW5nR2V0Q29tcGxldGVkPSExLHQuZ2V0SW5uZXJFbWl0dGVySW5zdGFuY2UoKS5vbmNlKGVpLHRoaXMuX2luaXRHcm91cExpc3QsdGhpcyl9cmV0dXJuIGEoZSxbe2tleTpcIm9uQ2hlY2tUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UlMT09MCYmdGhpcy5fY2FjaGVkR3JvdXBNZXNzYWdlTWFwLnNpemU+MCYmdGhpcy5fY2hlY2tDYWNoZWRHcm91cE1lc3NhZ2UoKX19LHtrZXk6XCJfY2hlY2tDYWNoZWRHcm91cE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5fY2FjaGVkR3JvdXBNZXNzYWdlTWFwLmZvckVhY2goKGZ1bmN0aW9uKHQsbil7dmFyIG89ZS5fY2hlY2tDb3VudE1hcC5nZXQobikscz1lLl9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKG4pO1ZlLmwoXCJcIi5jb25jYXQoZS5fbixcIi5fY2hlY2tDYWNoZWRHcm91cE1lc3NhZ2UgZ3JvdXBJRDpcIikuY29uY2F0KG4sXCIgaGFzTG9jYWxHcm91cDpcIikuY29uY2F0KHMsXCIgY2hlY2tDb3VudDpcIikuY29uY2F0KG8pKSxzPyhlLl9ub3RpZnlDYWNoZWRHcm91cE1lc3NhZ2UobiksZS5fY2hlY2tDb3VudE1hcC5kZWxldGUobiksZS5fZ3JvdXBNb2R1bGUuZGVsZXRlVW5qb2luZWRBVkNoYXRSb29tKG4pKTpvPj1lLk1BWF9DSEVDS19DT1VOVD8oZS5fZGVsZXRlQ2FjaGVkR3JvdXBNZXNzYWdlKG4pLGUuX2NoZWNrQ291bnRNYXAuZGVsZXRlKG4pKToobysrLGUuX2NoZWNrQ291bnRNYXAuc2V0KG4sbykpfSkpfX0se2tleTpcIl9pbml0R3JvdXBMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5faW5pdEdyb3VwTGlzdFwiKSk7dmFyIHQ9bmV3IEFhKFwiZ2V0R3JvdXBMaXN0SW5TdG9yYWdlXCIpLG49dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0U3RvcmFnZUdyb3VwTGlzdCgpO2lmKGF0KG4pJiZuLmxlbmd0aD4wKXtuLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UuX2dyb3VwTW9kdWxlLmluaXRHcm91cE1hcCh0KX0pKSx0aGlzLl9ncm91cE1vZHVsZS5lbWl0R3JvdXBMaXN0VXBkYXRlKCEwLCExKTt2YXIgbz10aGlzLl9ncm91cE1vZHVsZS5nZXRMb2NhbEdyb3VwTGlzdCgpLmxlbmd0aDt0LnNldE5ldHdvcmtUeXBlKHRoaXMuX2dyb3VwTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJncm91cCBjb3VudDpcIi5jb25jYXQobykpLmVuZCgpfWVsc2UgdC5zZXROZXR3b3JrVHlwZSh0aGlzLl9ncm91cE1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiZ3JvdXAgY291bnQ6MFwiKS5lbmQoKTtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2luaXRHcm91cExpc3Qgb2tcIikpfX0se2tleTpcImhhbmRsZVVwZGF0ZUdyb3VwTGFzdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmhhbmRsZVVwZGF0ZUdyb3VwTGFzdE1lc3NhZ2VcIik7aWYoVmUubChcIlwiLmNvbmNhdChuLFwiIGNvbnZlcnNhdGlvbiBjb3VudDpcIikuY29uY2F0KGUubGVuZ3RoLFwiLCBsb2NhbCBncm91cCBjb3VudDpcIikuY29uY2F0KHRoaXMuX2dyb3VwTW9kdWxlLmdldExvY2FsR3JvdXBMaXN0KCkubGVuZ3RoKSksMCE9PXRoaXMuX2dyb3VwTW9kdWxlLmdldEdyb3VwTWFwKCkuc2l6ZSl7Zm9yKHZhciBvLHMsYSxpPSExLHI9MCx1PWUubGVuZ3RoO3I8dTtyKyspKG89ZVtyXSkudHlwZT09PUUuQ09OVl9HUk9VUCYmKHM9by5jb252ZXJzYXRpb25JRC5zcGxpdCgvXkdST1VQLylbMV0sKGE9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TG9jYWxHcm91cFByb2ZpbGUocykpJiYoYS5sYXN0TWVzc2FnZT10KHt9LG8ubGFzdE1lc3NhZ2UpLGk9ITApKTtpJiYodGhpcy5fZ3JvdXBNb2R1bGUuc29ydExvY2FsR3JvdXBMaXN0KCksdGhpcy5fZ3JvdXBNb2R1bGUuZW1pdEdyb3VwTGlzdFVwZGF0ZSghMCwhMSkpfWVsc2UgdGhpcy50ZW1wQ29udmVyc2F0aW9uTGlzdD1lfX0se2tleTpcIm9uTmV3R3JvdXBNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uTmV3R3JvdXBNZXNzYWdlIGNvdW50OlwiKS5jb25jYXQoZS5kYXRhTGlzdC5sZW5ndGgpKTt2YXIgdD10aGlzLl9uZXdHcm91cE1lc3NhZ2VTdG9yZWRBbmRTdW1tYXJ5KGUpLG49dC5jb252ZXJzYXRpb25PcHRpb25zTGlzdCxvPXQubWVzc2FnZUxpc3Qscz10LkFWQ2hhdFJvb21NZXNzYWdlTGlzdDsocy5sZW5ndGg+MCYmdGhpcy5fZ3JvdXBNb2R1bGUub25BVkNoYXRSb29tTWVzc2FnZShzKSx0aGlzLl9ncm91cE1vZHVsZS5maWx0ZXJNb2RpZmllZE1lc3NhZ2Uobyksbi5sZW5ndGg+MCkmJih0aGlzLl9ncm91cE1vZHVsZS51cGRhdGVOZXh0TWVzc2FnZVNlcShuKSx0aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUocW4pLm9uTmV3TWVzc2FnZSh7Y29udmVyc2F0aW9uT3B0aW9uc0xpc3Q6bixpc0luc3RhbnRNZXNzYWdlOmUuaXNJbnN0YW50TWVzc2FnZXx8ITAsdXBkYXRlVW5yZWFkQ291bnQ6ZS51cGRhdGVVbnJlYWRDb3VudHx8ITB9KSk7dmFyIGE9dGhpcy5fZ3JvdXBNb2R1bGUuZmlsdGVyVW5tb2RpZmllZE1lc3NhZ2Uobyk7YS5sZW5ndGg+MCYmdGhpcy5fZ3JvdXBNb2R1bGUuZW1pdE91dGVyRXZlbnQoay5NRVNTQUdFX1JFQ0VJVkVELGEpLG8ubGVuZ3RoPTB9fSx7a2V5OlwiX25ld0dyb3VwTWVzc2FnZVN0b3JlZEFuZFN1bW1hcnlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5kYXRhTGlzdCxvPWUuZXZlbnQscz1lLmlzSW5zdGFudE1lc3NhZ2UsYT1udWxsLGk9W10scj1bXSx1PVtdLGM9e30sbD10aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUoS24pLGQ9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0RmlsZURvd25sb2FkUHJveHkoKSxwPW4ubGVuZ3RoO3A+MSYmbi5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybiBlLnNlcXVlbmNlLXQuc2VxdWVuY2V9KSk7Zm9yKHZhciBnPWZ1bmN0aW9uKGUpe3ZhciBwPUl0KG5bZV0pLGc9cC5ncm91cFByb2ZpbGUsaD1nLmdyb3VwSUQsXz1nLmNvbW11bml0eVR5cGUsZj12b2lkIDA9PT1fPzA6Xyx2PWcudG9waWNJRCxtPXZvaWQgMD09PXY/dm9pZCAwOnYsTT1nLmludmlzaWJsZSx5PXZvaWQgMCxJPXQuX2dyb3VwTW9kdWxlLmlzTWVzc2FnZUZyb21Ub3BpYyhmLG0pO2lmKEkpe3k9RS5DT05WX1RPUElDLHAudG89bTt2YXIgQz10Ll9ncm91cE1vZHVsZS5nZXRNb2R1bGUoRm4pO0MuaGFzTG9jYWxUb3BpYyhoLG0pfHx0Ll9nZXRUb3BpY1BlbmRpbmdNYXAuaGFzKG0pfHwodC5fZ2V0VG9waWNQZW5kaW5nTWFwLnNldChtLDEpLEMuZ2V0VG9waWNMaXN0KHtncm91cElEOmgsdG9waWNJRExpc3Q6W21dfSkuZmluYWxseSgoZnVuY3Rpb24oKXt0Ll9nZXRUb3BpY1BlbmRpbmdNYXAuZGVsZXRlKG0pfSkpKX12YXIgVD10Ll9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKGgpO2lmKCFUJiZ0Ll9ncm91cE1vZHVsZS5pc1Vuam9pbmVkQVZDaGF0Um9vbShoKSlyZXR1cm5cImNvbnRpbnVlXCI7aWYoIVQmJiFJKXJldHVybiB0Ll9jYWNoZUdyb3VwTWVzc2FnZUFuZFByb2JlKHtncm91cElEOmgsZXZlbnQ6byxpdGVtOnB9KSxcImNvbnRpbnVlXCI7aWYodC5fZ3JvdXBNb2R1bGUuaXNNZXNzYWdlRnJvbU9yVG9BVkNoYXRyb29tKGgpKXJldHVybiBwLmV2ZW50PW8sdS5wdXNoKHApLFwiY29udGludWVcIjtpZihwLmN1cnJlbnRVc2VyPXQuX2dyb3VwTW9kdWxlLmdldE15VXNlcklEKCkscC5jb252ZXJzYXRpb25UeXBlPUUuQ09OVl9HUk9VUCxwLmlzU3lzdGVtTWVzc2FnZT0hIXAuaXNTeXN0ZW1NZXNzYWdlLGE9bmV3IFdhKHApLHAuZWxlbWVudHM9bC5wYXJzZUVsZW1lbnRzKHAuZWxlbWVudHMscC5mcm9tKSxhLnNldEVsZW1lbnQocC5lbGVtZW50cyxkKSwxPT09TSlyZXR1cm4gdC5fcXVhbGl0eVN0YXQocyxhKSxcImNvbnRpbnVlXCI7dmFyIEQ9MT09PW5bZV0uaXNNb2RpZmllZCxrPXQuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShxbik7aWYoay5pc01lc3NhZ2VTZW50QnlDdXJyZW50SW5zdGFuY2UoYSk/YS5pc01vZGlmaWVkPUQ6RD0hMSwxPT09cC5vbmxpbmVPbmx5RmxhZylhLl9vbmxpbmVPbmx5RmxhZz0hMCxrLmlzTWVzc2FnZVNlbnRCeUN1cnJlbnRJbnN0YW5jZShhKXx8ci5wdXNoKGEpO2Vsc2V7aWYodC5fZ3JvdXBNb2R1bGUuaXNNZXNzYWdlRnJvbUNvbW11bml0eU9mVG9waWMoZixtKSlyZXR1cm4gci5wdXNoKGEpLFwiY29udGludWVcIjtpZighay5wdXNoSW50b01lc3NhZ2VMaXN0KHIsYSxEKSlyZXR1cm5cImNvbnRpbnVlXCI7dC5fcXVhbGl0eVN0YXQocyxhKTt2YXIgUz1hLEw9Uy5jb252ZXJzYXRpb25JRCxBPVMuc2VxdWVuY2UsUj1rLmlzUmVtb3RlUmVhZCh7Y29udmVyc2F0aW9uSUQ6TCxzZXF1ZW5jZTpBfSk7aWYoaXQoY1tMXSkpe3ZhciBOPTA7XCJpblwiPT09YS5mbG93JiYoYS5faXNFeGNsdWRlZEZyb21VbnJlYWRDb3VudHx8Unx8KE49MSkpLGNbTF09aS5wdXNoKHtjb252ZXJzYXRpb25JRDpMLHVucmVhZENvdW50Ok4sdHlwZTppdCh5KT9hLmNvbnZlcnNhdGlvblR5cGU6eSxzdWJUeXBlOmEuY29udmVyc2F0aW9uU3ViVHlwZSxsYXN0TWVzc2FnZTphLl9pc0V4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlP1wiXCI6YX0pLTF9ZWxzZXt2YXIgTz1jW0xdO2lbT10udHlwZT1pdCh5KT9hLmNvbnZlcnNhdGlvblR5cGU6eSxpW09dLnN1YlR5cGU9YS5jb252ZXJzYXRpb25TdWJUeXBlLGlbT10ubGFzdE1lc3NhZ2U9YS5faXNFeGNsdWRlZEZyb21MYXN0TWVzc2FnZT9cIlwiOmEsXCJpblwiPT09YS5mbG93JiYoYS5faXNFeGNsdWRlZEZyb21VbnJlYWRDb3VudHx8Unx8aVtPXS51bnJlYWRDb3VudCsrKX19fSxoPTA7aDxwO2grKylnKGgpO3JldHVybntjb252ZXJzYXRpb25PcHRpb25zTGlzdDppLG1lc3NhZ2VMaXN0OnIsQVZDaGF0Um9vbU1lc3NhZ2VMaXN0OnV9fX0se2tleTpcIl9xdWFsaXR5U3RhdFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TW9kdWxlKGVvKTtuLmFkZE1lc3NhZ2VTZXF1ZW5jZSh7a2V5OkNhLG1lc3NhZ2U6dH0pLGUmJnQuY2xpZW50VGltZT4wJiZuLmFkZE1lc3NhZ2VEZWxheSh0LmNsaWVudFRpbWUpfX0se2tleTpcIm9uR3JvdXBNZXNzYWdlUmV2b2tlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShxbiksbj1bXSxvPW51bGwscz0hMDtlLmRhdGFMaXN0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBhPWUuZWxlbWVudHMucmV2b2tlZEluZm9zO2l0KGEpfHxhLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBhPXp0KGUudG9waWNJRCk/XCJHUk9VUFwiLmNvbmNhdChlLmdyb3VwSUQpOlwiR1JPVVBcIi5jb25jYXQoZS50b3BpY0lEKTtvPXQucmV2b2tlKGEsZS5zZXF1ZW5jZSxlLnJhbmRvbSk7dmFyIGk9ZS5yZXZva2VySW5mbyYmZS5yZXZva2VySW5mby5yZXZva2VyO2lmKG8pby5yZXZva2VyPWksbi5wdXNoKG8pO2Vsc2V7dmFyIHI9e2NvbnZlcnNhdGlvbklEOmEsdG86ZS50b3BpY0lEfHxcIlwiLHNlcXVlbmNlOmUuc2VxdWVuY2UsdGltZTplLnRpbWUscmV2b2tlcjppfTt0LmlzTGFzdE1lc3NhZ2VSZXZva2VkKHIpJiYobi5wdXNoKHIpLHM9ITEpfX0pKX0pKSwwIT09bi5sZW5ndGgmJih0Lm9uTWVzc2FnZVJldm9rZWQobiksITA9PT1zJiYoVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uR3JvdXBNZXNzYWdlUmV2b2tlZCBjb3VudDpcIikuY29uY2F0KG4ubGVuZ3RoKSksdGhpcy5fZ3JvdXBNb2R1bGUuZW1pdE91dGVyRXZlbnQoay5NRVNTQUdFX1JFVk9LRUQsbikpKX19LHtrZXk6XCJfZ3JvdXBMaXN0VHJlZVNoYWtpbmdcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9bmV3IE1hcChtKHRoaXMuX2dyb3VwTW9kdWxlLmdldEdyb3VwTWFwKCkpKSxuPTAsbz1lLmxlbmd0aDtuPG87bisrKXQuZGVsZXRlKGVbbl0uZ3JvdXBJRCk7dGhpcy5fZ3JvdXBNb2R1bGUuaGFzSm9pbmVkQVZDaGF0Um9vbSgpJiZ0aGlzLl9ncm91cE1vZHVsZS5nZXRKb2luZWRBVkNoYXRSb29tKCkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dC5kZWxldGUoZSl9KSk7dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0R3JvdXBNYXAoKS5mb3JFYWNoKChmdW5jdGlvbihlLG4pe2UuaXNTdXBwb3J0VG9waWMmJnQuZGVsZXRlKG4pfSkpO2Zvcih2YXIgcz1tKHQua2V5cygpKSxhPTAsaT1zLmxlbmd0aDthPGk7YSsrKXRoaXMuX2dyb3VwTW9kdWxlLmRlbGV0ZUdyb3VwKHNbYV0pfX0se2tleTpcImdldEdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJnZXRHcm91cExpc3RcIiksbz1uZXcgQWEoXCJnZXRHcm91cExpc3RcIik7VmUubChcIlwiLmNvbmNhdChuKSk7dmFyIHM9e2ludHJvZHVjdGlvbjpcIkludHJvZHVjdGlvblwiLG5vdGlmaWNhdGlvbjpcIk5vdGlmaWNhdGlvblwiLGNyZWF0ZVRpbWU6XCJDcmVhdGVUaW1lXCIsb3duZXJJRDpcIk93bmVyX0FjY291bnRcIixsYXN0SW5mb1RpbWU6XCJMYXN0SW5mb1RpbWVcIixtZW1iZXJOdW06XCJNZW1iZXJOdW1cIixtYXhNZW1iZXJOdW06XCJNYXhNZW1iZXJOdW1cIixqb2luT3B0aW9uOlwiQXBwbHlKb2luT3B0aW9uXCIsaW52aXRlT3B0aW9uOlwiSW52aXRlSm9pbk9wdGlvblwiLG11dGVBbGxNZW1iZXJzOlwiU2h1dFVwQWxsTWVtYmVyXCJ9LGE9W1wiVHlwZVwiLFwiTmFtZVwiLFwiRmFjZVVybFwiLFwiTmV4dE1zZ1NlcVwiLFwiTGFzdE1zZ1RpbWVcIixcIkF0SW5mb0xpc3RcIixcIkxhc3RSZWNhbGxUaW1lXCJdLGk9W107ZSYmZS5ncm91cFByb2ZpbGVGaWx0ZXImJmUuZ3JvdXBQcm9maWxlRmlsdGVyLmZvckVhY2goKGZ1bmN0aW9uKGUpe3NbZV0mJmEucHVzaChzW2VdKX0pKTt2YXIgcj0oZXx8e30pLmlzR3JvdXBXaXRoVG9waWNPbmx5LHU9dm9pZCAwIT09ciYmcjtyZXR1cm4gdGhpcy5fcGFnaW5nR2V0R3JvdXBMaXN0KHtsaW1pdDo1MCxvZmZzZXQ6MCxncm91cEJhc2VJbmZvRmlsdGVyOmEsZ3JvdXBMaXN0OmksaXNHcm91cFdpdGhUb3BpY09ubHk6dX0pLnRoZW4oKGZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdChuLFwiIG9rLiBjb3VudDpcIikuY29uY2F0KGkubGVuZ3RoLFwiIGlzR3JvdXBXaXRoVG9waWNPbmx5OlwiKS5jb25jYXQodSkpLHV8fHQuX2dyb3VwTGlzdFRyZWVTaGFraW5nKGkpLHQuX2dyb3VwTW9kdWxlLnVwZGF0ZUdyb3VwTWFwKGkpO3ZhciBlPXQuX2dyb3VwTW9kdWxlLmdldExvY2FsR3JvdXBMaXN0KCkubGVuZ3RoO28uc2V0TmV0d29ya1R5cGUodC5fZ3JvdXBNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcInJlbW90ZSBjb3VudDpcIi5jb25jYXQoaS5sZW5ndGgsXCIsIGFmdGVyIHRyZWUgc2hha2luZywgbG9jYWwgY291bnQ6XCIpLmNvbmNhdChlLFwiLCBpc0dyb3VwV2l0aFRvcGljT25seTpcIikuY29uY2F0KHUpKS5lbmQoKSx0LnRlbXBDb252ZXJzYXRpb25MaXN0JiYodC5oYW5kbGVVcGRhdGVHcm91cExhc3RNZXNzYWdlKHQudGVtcENvbnZlcnNhdGlvbkxpc3QpLHQudGVtcENvbnZlcnNhdGlvbkxpc3Q9bnVsbCksdC5fZ3JvdXBNb2R1bGUucGF0Y2hHcm91cE1lc3NhZ2VSZW1pbmRUeXBlKCksdC5fZ3JvdXBNb2R1bGUucmVjb21wdXRlVW5yZWFkQ291bnQoKSx0Ll9ncm91cE1vZHVsZS5lbWl0R3JvdXBMaXN0VXBkYXRlKCEwLCF1KTt2YXIgcz10Ll9ncm91cE1vZHVsZS5nZXRMb2NhbEdyb3VwTGlzdCgpO2lmKHUpe3ZhciBhPXMuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4hMD09PWUuaXNTdXBwb3J0VG9waWN9KSk7cmV0dXJuIFlhKHtncm91cExpc3Q6YX0pfXJldHVybiB0Ll9pc1BhZ2luZ0dldENvbXBsZXRlZD0hMCxZYSh7Z3JvdXBMaXN0OnN9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2dyb3VwTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0sYT1uWzFdO28uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJpc1BhZ2luZ0dldENvbXBsZXRlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzUGFnaW5nR2V0Q29tcGxldGVkfX0se2tleTpcIl9wYWdpbmdHZXRHcm91cExpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX3BhZ2luZ0dldEdyb3VwTGlzdFwiKSxvPWUuaXNDb21tdW5pdHlSZWxheSxzPXZvaWQgMCE9PW8mJm8sYT1lLmlzR3JvdXBXaXRoVG9waWNPbmx5LGk9dm9pZCAwIT09YSYmYSxyPWUubGltaXQsdT1lLm9mZnNldCxjPWUuZ3JvdXBCYXNlSW5mb0ZpbHRlcixsPWUuZ3JvdXBMaXN0O2lmKGkpcmV0dXJuIHRoaXMuX3BhZ2luZ0dldEdyb3VwTGlzdFdpdGhUb3BpYyh7bGltaXQ6cixvZmZzZXQ6dSxncm91cEJhc2VJbmZvRmlsdGVyOmMsZ3JvdXBMaXN0Omx9KTt2YXIgZD1uZXcgQWEoXCJfcGFnaW5nR2V0R3JvdXBMaXN0XCIpO3JldHVybiB0aGlzLl9ncm91cE1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6am8scmVxdWVzdERhdGE6e3R5cGU6cz9FLkdSUF9DT01NVU5JVFk6dm9pZCAwLG1lbWJlckFjY291bnQ6dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TXlVc2VySUQoKSxsaW1pdDpyLG9mZnNldDp1LHJlc3BvbnNlRmlsdGVyOntncm91cEJhc2VJbmZvRmlsdGVyOmMsc2VsZkluZm9GaWx0ZXI6W1wiUm9sZVwiLFwiSm9pblRpbWVcIixcIk1zZ0ZsYWdcIixcIk1zZ1NlcVwiXX19fSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89ZS5kYXRhLGE9by5ncm91cHMsaT12b2lkIDA9PT1hP1tdOmEscD1vLnRvdGFsQ291bnQ7bC5wdXNoLmFwcGx5KGwsbShpKSksdC5faGFuZGxlR3JvdXBBdEluZm9XaXRob3V0VG9waWMocyxpKTt2YXIgZz11K3IsaD0hKHA+ZyksXz1cIm9mZnNldDpcIi5jb25jYXQodSxcIiB0b3RhbENvdW50OlwiKS5jb25jYXQocCxcIiBpc0NvbXBsZXRlZDpcIikuY29uY2F0KGgsXCIgXCIpK1wiY3VycmVudENvdW50OlwiLmNvbmNhdChsLmxlbmd0aCxcIiBpc0NvbW11bml0eVJlbGF5OlwiKS5jb25jYXQocyk7cmV0dXJuIGQuc2V0TmV0d29ya1R5cGUodC5fZ3JvdXBNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChfKSkuZW5kKCksc3x8aD8hcyYmaD8oVmUubChcIlwiLmNvbmNhdChuLFwiIHN0YXJ0IHRvIGdldCBjb21tdW5pdHkgbGlzdFwiKSksdT0wLHQuX3BhZ2luZ0dldEdyb3VwTGlzdCh7bGltaXQ6cixvZmZzZXQ6dSxncm91cEJhc2VJbmZvRmlsdGVyOmMsZ3JvdXBMaXN0OmwsaXNDb21tdW5pdHlSZWxheTohMH0pKTpzJiYhaD8odT1nLHQuX3BhZ2luZ0dldEdyb3VwTGlzdCh7bGltaXQ6cixvZmZzZXQ6dSxncm91cEJhc2VJbmZvRmlsdGVyOmMsZ3JvdXBMaXN0OmwsaXNDb21tdW5pdHlSZWxheTohMH0pKTooVmUubChcIlwiLmNvbmNhdChuLFwiIG9rLiB0b3RhbENvdW50OlwiKS5jb25jYXQobC5sZW5ndGgpKSxZYSh7Z3JvdXBMaXN0Omx9KSk6KHU9Zyx0Ll9wYWdpbmdHZXRHcm91cExpc3Qoe2xpbWl0OnIsb2Zmc2V0OnUsZ3JvdXBCYXNlSW5mb0ZpbHRlcjpjLGdyb3VwTGlzdDpsfSkpfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gMTFlMyE9PWUuY29kZSYmdC5fZ3JvdXBNb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxhPW5bMV07ZC5zZXRNZXNzYWdlKFwiaXNDb21tdW5pdHlSZWxheTpcIi5jb25jYXQocykpLnNldEVycm9yKGUsbyxhKS5lbmQoKX0pKSxzPygxMWUzPT09ZS5jb2RlJiYoZD1udWxsLFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gY29tbXVuaXR5IHVuYXZhaWxhYmxlXCIpKSksWGEoe2dyb3VwTGlzdDpsfSkpOlphKGUpfSkpfX0se2tleTpcIl9wYWdpbmdHZXRHcm91cExpc3RXaXRoVG9waWNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5fcGFnaW5nR2V0R3JvdXBMaXN0V2l0aFRvcGljXCIpLG89ZS5saW1pdCxzPWUub2Zmc2V0LGE9ZS5ncm91cEJhc2VJbmZvRmlsdGVyLGk9ZS5ncm91cExpc3Qscj1uZXcgQWEoXCJwYWdpbmdHZXRHcm91cExpc3RXaXRoVG9waWNcIik7cmV0dXJuIHRoaXMuX2dyb3VwTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpqbyxyZXF1ZXN0RGF0YTp7dHlwZTpFLkdSUF9DT01NVU5JVFksbWVtYmVyQWNjb3VudDp0aGlzLl9ncm91cE1vZHVsZS5nZXRNeVVzZXJJRCgpLGxpbWl0Om8sb2Zmc2V0OnMscmVzcG9uc2VGaWx0ZXI6e2dyb3VwQmFzZUluZm9GaWx0ZXI6YSxzZWxmSW5mb0ZpbHRlcjpbXCJSb2xlXCIsXCJKb2luVGltZVwiLFwiTXNnRmxhZ1wiLFwiTXNnU2VxXCJdfSxpc1N1cHBvcnRUb3BpYzoxfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB1PWUuZGF0YSxjPXUuZ3JvdXBzLGw9dm9pZCAwPT09Yz9bXTpjLGQ9dS50b3RhbENvdW50O2kucHVzaC5hcHBseShpLG0obCkpO3ZhciBwPXMrbyxnPSEoZD5wKSxoPVwib2Zmc2V0OlwiLmNvbmNhdChzLFwiIHRvdGFsQ291bnQ6XCIpLmNvbmNhdChkLFwiIGlzQ29tcGxldGVkOlwiKS5jb25jYXQoZyxcIiBcIikrXCJjdXJyZW50Q291bnQ6XCIuY29uY2F0KGkubGVuZ3RoKTtyZXR1cm4gci5zZXROZXR3b3JrVHlwZSh0Ll9ncm91cE1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KGgpKS5lbmQoKSxnPyhWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIHRvdGFsQ291bnQ6XCIpLmNvbmNhdChpLmxlbmd0aCkpLFlhKHtncm91cExpc3Q6aX0pKToocz1wLHQuX3BhZ2luZ0dldEdyb3VwTGlzdFdpdGhUb3BpYyh7bGltaXQ6byxvZmZzZXQ6cyxncm91cEJhc2VJbmZvRmlsdGVyOmEsZ3JvdXBMaXN0Oml9KSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9ncm91cE1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtyLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxaYShlKX0pKX19LHtrZXk6XCJfY2FjaGVHcm91cE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX2NhY2hlZEdyb3VwTWVzc2FnZU1hcC5oYXMoZSl8fHRoaXMuX2NhY2hlZEdyb3VwTWVzc2FnZU1hcC5zZXQoZSxbXSksdGhpcy5fY2FjaGVkR3JvdXBNZXNzYWdlTWFwLmdldChlKS5wdXNoKHQpfX0se2tleTpcIl9kZWxldGVDYWNoZWRHcm91cE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jYWNoZWRHcm91cE1lc3NhZ2VNYXAuaGFzKGUpJiZ0aGlzLl9jYWNoZWRHcm91cE1lc3NhZ2VNYXAuZGVsZXRlKGUpfX0se2tleTpcIl9ub3RpZnlDYWNoZWRHcm91cE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49dGhpcy5fY2FjaGVkR3JvdXBNZXNzYWdlTWFwLmdldChlKXx8W107bi5mb3JFYWNoKChmdW5jdGlvbihlKXt0Lm9uTmV3R3JvdXBNZXNzYWdlKGUpfSkpLHRoaXMuX2RlbGV0ZUNhY2hlZEdyb3VwTWVzc2FnZShlKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX25vdGlmeUNhY2hlZEdyb3VwTWVzc2FnZSBncm91cElEOlwiKS5jb25jYXQoZSxcIiBjb3VudDpcIikuY29uY2F0KG4ubGVuZ3RoKSl9fSx7a2V5OlwiX2NhY2hlR3JvdXBNZXNzYWdlQW5kUHJvYmVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ncm91cElELG89ZS5ldmVudCxzPWUuaXRlbTt0aGlzLl9jYWNoZUdyb3VwTWVzc2FnZShuLHtldmVudDpvLGRhdGFMaXN0OltzXX0pLHRoaXMuX2dyb3VwTW9kdWxlLmdldEdyb3VwU2ltcGxpZmllZEluZm8obikudGhlbigoZnVuY3Rpb24oZSl7ZS50eXBlPT09RS5HUlBfQVZDSEFUUk9PTT90Ll9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKG4pP3QuX25vdGlmeUNhY2hlZEdyb3VwTWVzc2FnZShuKTp0Ll9ncm91cE1vZHVsZS5zZXRVbmpvaW5lZEFWQ2hhdFJvb20obik6KHQuX2dyb3VwTW9kdWxlLnVwZGF0ZUdyb3VwTWFwKFtlXSksdC5fbm90aWZ5Q2FjaGVkR3JvdXBNZXNzYWdlKG4pKX0pKSx0aGlzLl9jaGVja0NvdW50TWFwLmhhcyhuKXx8dGhpcy5fY2hlY2tDb3VudE1hcC5zZXQobiwwKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2NhY2hlR3JvdXBNZXNzYWdlQW5kUHJvYmUgZ3JvdXBJRDpcIikuY29uY2F0KG4pKX19LHtrZXk6XCJfaGFuZGxlR3JvdXBBdEluZm9XaXRob3V0VG9waWNcIix2YWx1ZTpmdW5jdGlvbihlLG4pe3ZhciBvPXRoaXM7ZSYmMCE9PW4ubGVuZ3RoJiZuLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPWUuZ3JvdXBJRCxzPWUuZ3JvdXBBdEluZm9MaXN0LGE9W107aXQocyl8fChzLmZvckVhY2goKGZ1bmN0aW9uKGUpe2EucHVzaCh0KHQoe30sZSkse30se2dyb3VwSUQ6bn0pKX0pKSxvLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUocW4pLm9uTmV3R3JvdXBBdFRpcHMoe2RhdGFMaXN0OmF9KSl9KSl9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2NhY2hlZEdyb3VwTWVzc2FnZU1hcC5jbGVhcigpLHRoaXMuX2NoZWNrQ291bnRNYXAuY2xlYXIoKSx0aGlzLl9nZXRUb3BpY1BlbmRpbmdNYXAuY2xlYXIoKSx0aGlzLl9pc1BhZ2luZ0dldENvbXBsZXRlZD0hMSx0aGlzLl9ncm91cE1vZHVsZS5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpLm9uY2UoZWksdGhpcy5faW5pdEdyb3VwTGlzdCx0aGlzKX19XSksZX0oKSxDaT0xLFRpPTIsRGk9MyxraT00LEVpPTUsU2k9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9ncm91cE1vZHVsZT10LHRoaXMuX249XCJHcm91cEF0dHJpYnV0ZXNIYW5kbGVyXCIsdGhpcy5fZ3JvdXBBdHRyaWJ1dGVzTWFwPW5ldyBNYXAsdGhpcy5fZ3JvdXBBdHRyaWJ1dGVzQ29weT17fSx0aGlzLkNBQ0hFX0VYUElSRV9USU1FPTNlNCx0aGlzLl9ncm91cE1vZHVsZS5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpLm9uKHRpLHRoaXMuX29uQ2xvdWRDb25maWdVcGRhdGVkLHRoaXMpfXJldHVybiBhKGUsW3trZXk6XCJfb25DbG91ZENvbmZpZ1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX2dyb3VwTW9kdWxlLmdldENsb3VkQ29uZmlnKFwiZ3JwX2F0dHJfY2FjaGVfdGltZVwiKTtpdChlKXx8KHRoaXMuQ0FDSEVfRVhQSVJFX1RJTUU9TnVtYmVyKGUpKX19LHtrZXk6XCJ1cGRhdGVMb2NhbE1haW5TZXF1ZW5jZU9uUmVjb25uZWN0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2dyb3VwQXR0cmlidXRlc01hcC5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmxvY2FsTWFpblNlcXVlbmNlPTB9KSl9fSx7a2V5OlwiaXNHcm91cEF0dHJpYnV0ZXNVcGRhdGVkTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50byxuPWUuZWxlbWVudHMubmV3R3JvdXBQcm9maWxlLG89IWl0KG4pJiYhenQobi5ncm91cEF0dHJpYnV0ZU9wdGlvbik7cmV0dXJuIG8mJnRoaXMuX29uR3JvdXBBdHRyaWJ1dGVzVXBkYXRlZCh7Z3JvdXBJRDp0LGdyb3VwQXR0cmlidXRlT3B0aW9uOm4uZ3JvdXBBdHRyaWJ1dGVPcHRpb259KSxvfX0se2tleTpcIl9vbkdyb3VwQXR0cmlidXRlc1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ncm91cElELG89ZS5ncm91cEF0dHJpYnV0ZU9wdGlvbixzPW8ubWFpblNlcXVlbmNlLGE9by5pc1dpdGhDaGFuZ2VkQXR0cmlidXRlSW5mbyxpPW8uZ3JvdXBBdHRyaWJ1dGVMaXN0LHI9dm9pZCAwPT09aT9bXTppLHU9by5vcGVyYXRpb25UeXBlO2lmKFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkdyb3VwQXR0cmlidXRlc1VwZGF0ZWQuIFwiKStcImdyb3VwSUQ6XCIuY29uY2F0KG4sXCIgaXNXaXRoQ2hhbmdlZEF0dHJpYnV0ZUluZm86XCIpLmNvbmNhdChhLFwiIG9wZXJhdGlvblR5cGU6XCIpLmNvbmNhdCh1KSksIWl0KHUpKXt0aGlzLl9ncm91cEF0dHJpYnV0ZXNDb3B5PXRoaXMuX2dldENhY2hlZEF0dHJpYnV0ZXMoe2dyb3VwSUQ6bn0pO3ZhciBjPXMtdGhpcy5fZ2V0TG9jYWxHcm91cEF0dHJpYnV0ZXMobikubG9jYWxNYWluU2VxdWVuY2U7aWYoMCE9PWMpe2lmKDE9PT1hJiYxPT09YylyZXR1cm4gdGhpcy5fcmVmcmVzaENhY2hlZEdyb3VwQXR0cmlidXRlcyh7Z3JvdXBJRDpuLHJlbW90ZU1haW5TZXF1ZW5jZTpzLGdyb3VwQXR0cmlidXRlTGlzdDpyLG9wZXJhdGlvblR5cGU6dX0pLHZvaWQgdGhpcy5fZW1pdEdyb3VwQXR0cmlidXRlc1VwZGF0ZWQobik7aWYodGhpcy5faGFzTG9jYWxHcm91cEF0dHJpYnV0ZXMobikpe3ZhciBsPXRoaXMuX2dldExvY2FsR3JvdXBBdHRyaWJ1dGVzKG4pLmF2Q2hhdFJvb21LZXk7dGhpcy5fZ2V0R3JvdXBBdHRyaWJ1dGVzKHtncm91cElEOm4sYXZDaGF0Um9vbUtleTpsfSkudGhlbigoZnVuY3Rpb24oKXt0Ll9lbWl0R3JvdXBBdHRyaWJ1dGVzVXBkYXRlZChuKX0pKX19fX19LHtrZXk6XCJpbml0R3JvdXBBdHRyaWJ1dGVzQ2FjaGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmdyb3VwSUQsbj1lLmF2Q2hhdFJvb21LZXksbz12b2lkIDA9PT1uP3ZvaWQgMDpuO3RoaXMuX2dyb3VwQXR0cmlidXRlc01hcC5zZXQodCx7bGFzdFVwZGF0ZVRpbWU6MCxsb2NhbE1haW5TZXF1ZW5jZTowLHJlbW90ZU1haW5TZXF1ZW5jZTowLGF0dHJpYnV0ZXM6bmV3IE1hcCxhdkNoYXRSb29tS2V5Om99KSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuaW5pdEdyb3VwQXR0cmlidXRlc0NhY2hlIGdyb3VwSUQ6XCIpLmNvbmNhdCh0LFwiIGF2Q2hhdFJvb21LZXk6XCIpLmNvbmNhdChvKSl9fSx7a2V5OlwiaW5pdEdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLmdyb3VwSUQsbz1lLmdyb3VwQXR0cmlidXRlcyxzPXRoaXMuX2dldExvY2FsR3JvdXBBdHRyaWJ1dGVzKG4pLGE9cy5yZW1vdGVNYWluU2VxdWVuY2UsaT1zLmF2Q2hhdFJvb21LZXkscj1uZXcgQWEoXCJpbml0R3JvdXBBdHRyaWJ1dGVzXCIpO3JldHVybiByLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChuLFwiIGF2Q2hhdFJvb21LZXk6XCIpLmNvbmNhdChpLFwiIG1haW5TZXF1ZW5jZTpcIikuY29uY2F0KGEpKSx0aGlzLl9ncm91cE1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6SXMscmVxdWVzdERhdGE6e2dyb3VwSUQ6bixhdkNoYXRSb29tS2V5OmksbWFpblNlcXVlbmNlOmEsZ3JvdXBBdHRyaWJ1dGVMaXN0OnRoaXMuX3RyYW5zZm9ybUdyb3VwQXR0cmlidXRlcyhvKX19KS50aGVuKChmdW5jdGlvbihlKXtWZS5sKFwiXCIuY29uY2F0KHQuX24sXCIuXCIpLmNvbmNhdChcImluaXRHcm91cEF0dHJpYnV0ZXNcIixcIiBvay4gZ3JvdXBJRDpcIikuY29uY2F0KG4pKTt2YXIgcz1lLmRhdGEsYT1zLm1haW5TZXF1ZW5jZSxpPW0ocy5ncm91cEF0dHJpYnV0ZUxpc3QpO3JldHVybiBpLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UudmFsdWU9b1tlLmtleV19KSksdC5fZ3JvdXBBdHRyaWJ1dGVzQ29weT10Ll9nZXRDYWNoZWRBdHRyaWJ1dGVzKHtncm91cElEOm59KSx0Ll9yZWZyZXNoQ2FjaGVkR3JvdXBBdHRyaWJ1dGVzKHtncm91cElEOm4scmVtb3RlTWFpblNlcXVlbmNlOmEsZ3JvdXBBdHRyaWJ1dGVMaXN0Omksb3BlcmF0aW9uVHlwZTpDaX0pLHQuX2VtaXRHcm91cEF0dHJpYnV0ZXNVcGRhdGVkKG4pLHIuc2V0TmV0d29ya1R5cGUodC5fZ3JvdXBNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksWWEoe2dyb3VwQXR0cmlidXRlczpvfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9ncm91cE1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtyLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxaYShlKX0pKX19LHtrZXk6XCJzZXRHcm91cEF0dHJpYnV0ZXNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwic2V0R3JvdXBBdHRyaWJ1dGVzXCIpLG89ZS5ncm91cElELHM9ZS5ncm91cEF0dHJpYnV0ZXMsYT10aGlzLl9nZXRMb2NhbEdyb3VwQXR0cmlidXRlcyhvKSxpPWEucmVtb3RlTWFpblNlcXVlbmNlLHI9YS5hdkNoYXRSb29tS2V5LHU9YS5hdHRyaWJ1dGVzLGM9dGhpcy5fdHJhbnNmb3JtR3JvdXBBdHRyaWJ1dGVzKHMpO2MuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5rZXk7ZS5zZXF1ZW5jZT0wLHUuaGFzKHQpJiYoZS5zZXF1ZW5jZT11LmdldCh0KS5zZXF1ZW5jZSl9KSk7dmFyIGw9bmV3IEFhKFwic2V0R3JvdXBBdHRyaWJ1dGVzXCIpO3JldHVybiBsLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChvLFwiIGdyb3VwQXR0cmlidXRlczpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KHMpKSksVmUubChcIlwiLmNvbmNhdChuLFwiLiBncm91cElEOlwiKS5jb25jYXQobyxcIiBtYWluU2VxdWVuY2U6XCIpLmNvbmNhdChpKSksdGhpcy5fZ3JvdXBNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkNzLHJlcXVlc3REYXRhOntncm91cElEOm8sYXZDaGF0Um9vbUtleTpyLG1haW5TZXF1ZW5jZTppLGdyb3VwQXR0cmlidXRlTGlzdDpjfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe1ZlLmwoXCJcIi5jb25jYXQobixcIiBvay5cIikpO3ZhciBhPWUuZGF0YSxpPWEubWFpblNlcXVlbmNlLHI9bShhLmdyb3VwQXR0cmlidXRlTGlzdCk7cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS52YWx1ZT1zW2Uua2V5XX0pKSx0Ll9ncm91cEF0dHJpYnV0ZXNDb3B5PXQuX2dldENhY2hlZEF0dHJpYnV0ZXMoe2dyb3VwSUQ6b30pLHQuX3JlZnJlc2hDYWNoZWRHcm91cEF0dHJpYnV0ZXMoe2dyb3VwSUQ6byxyZW1vdGVNYWluU2VxdWVuY2U6aSxncm91cEF0dHJpYnV0ZUxpc3Q6cixvcGVyYXRpb25UeXBlOlRpfSksdC5fZW1pdEdyb3VwQXR0cmlidXRlc1VwZGF0ZWQobyksbC5zZXROZXR3b3JrVHlwZSh0Ll9ncm91cE1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxZYSh7Z3JvdXBBdHRyaWJ1dGVzOnN9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2dyb3VwTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2wuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFphKGUpfSkpfX0se2tleTpcImRlbGV0ZUdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLmdyb3VwSUQsbz1lLmtleUxpc3Qscz12b2lkIDA9PT1vP1tdOm8sYT10aGlzLl9nZXRMb2NhbEdyb3VwQXR0cmlidXRlcyhuKSxpPWEucmVtb3RlTWFpblNlcXVlbmNlLHI9YS5hdkNoYXRSb29tS2V5LHU9YS5hdHRyaWJ1dGVzLGM9bSh1LmtleXMoKSksbD1EcyxkPURpLHA9e2dyb3VwSUQ6bixhdkNoYXRSb29tS2V5OnIsbWFpblNlcXVlbmNlOml9LGc9W107cy5sZW5ndGg+MCYmKGM9W10sbD1UcyxkPWtpLHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9MDt1LmhhcyhlKSYmKHQ9dS5nZXQoZSkuc2VxdWVuY2UsYy5wdXNoKGUpKSxnLnB1c2goe2tleTplLHNlcXVlbmNlOnR9KX0pKSxwLmdyb3VwQXR0cmlidXRlTGlzdD1nKTt2YXIgaD1uZXcgQWEoXCJkZWxldGVHcm91cEF0dHJpYnV0ZXNcIik7cmV0dXJuIGguc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG4sXCIgbWFpblNlcXVlbmNlOlwiKS5jb25jYXQoaSxcIiBrZXlMaXN0OlwiKS5jb25jYXQocyxcIiBwcm90b2NvbE5hbWU6XCIpLmNvbmNhdChsKSksdGhpcy5fZ3JvdXBNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmwscmVxdWVzdERhdGE6cH0pLnRoZW4oKGZ1bmN0aW9uKGUpe1ZlLmwoXCJcIi5jb25jYXQodC5fbixcIi5cIikuY29uY2F0KFwiZGVsZXRlR3JvdXBBdHRyaWJ1dGVzXCIsXCIgb2suIGdyb3VwSUQ6XCIpLmNvbmNhdChuKSk7dmFyIG89ZS5kYXRhLm1haW5TZXF1ZW5jZTtyZXR1cm4gdC5fZ3JvdXBBdHRyaWJ1dGVzQ29weT10Ll9nZXRDYWNoZWRBdHRyaWJ1dGVzKHtncm91cElEOm59KSx0Ll9yZWZyZXNoQ2FjaGVkR3JvdXBBdHRyaWJ1dGVzKHtncm91cElEOm4scmVtb3RlTWFpblNlcXVlbmNlOm8sZ3JvdXBBdHRyaWJ1dGVMaXN0Omcsb3BlcmF0aW9uVHlwZTpkfSksdC5fZW1pdEdyb3VwQXR0cmlidXRlc1VwZGF0ZWQobiksaC5zZXROZXR3b3JrVHlwZSh0Ll9ncm91cE1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxZYSh7a2V5TGlzdDpjfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9ncm91cE1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtoLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxaYShlKX0pKX19LHtrZXk6XCJnZXRHcm91cEF0dHJpYnV0ZXNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZ2V0R3JvdXBBdHRyaWJ1dGVzXCIpLG89ZS5ncm91cElELHM9dGhpcy5fZ2V0TG9jYWxHcm91cEF0dHJpYnV0ZXMobyksYT1zLmF2Q2hhdFJvb21LZXksaT1zLmxhc3RVcGRhdGVUaW1lLHI9cy5sb2NhbE1haW5TZXF1ZW5jZSx1PXMucmVtb3RlTWFpblNlcXVlbmNlLGM9bmV3IEFhKFwiZ2V0R3JvdXBBdHRyaWJ1dGVzXCIpO2lmKGMuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgbG9jYWxNYWluU2VxdWVuY2U6XCIpLmNvbmNhdChyLFwiIHJlbW90ZU1haW5TZXF1ZW5jZTpcIikuY29uY2F0KHUsXCIga2V5TGlzdDpcIikuY29uY2F0KGUua2V5TGlzdCkpLERhdGUubm93KCktaT49dGhpcy5DQUNIRV9FWFBJUkVfVElNRXx8cjx1KXJldHVybiB0aGlzLl9nZXRHcm91cEF0dHJpYnV0ZXMoe2dyb3VwSUQ6byxhdkNoYXRSb29tS2V5OmF9KS50aGVuKChmdW5jdGlvbihzKXtjLnNldE1vcmVNZXNzYWdlKFwiZ2V0IGF0dHJpYnV0ZXMgZnJvbSByZW1vdGUuIGNvdW50OlwiLmNvbmNhdChzLmxlbmd0aCkpLnNldE5ldHdvcmtUeXBlKHQuX2dyb3VwTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBmcm9tIHJlbW90ZS4gZ3JvdXBJRDpcIikuY29uY2F0KG8pKTt2YXIgYT10Ll9nZXRDYWNoZWRBdHRyaWJ1dGVzKGUpO3JldHVybiBZYSh7Z3JvdXBBdHRyaWJ1dGVzOmF9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2dyb3VwTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2Muc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFphKGUpfSkpO2Muc2V0TW9yZU1lc3NhZ2UoXCJnZXQgYXR0cmlidXRlcyBmcm9tIGNhY2hlXCIpLnNldE5ldHdvcmtUeXBlKHRoaXMuX2dyb3VwTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBmcm9tIGNhY2hlLiBncm91cElEOlwiKS5jb25jYXQobykpO3ZhciBsPXRoaXMuX2dldENhY2hlZEF0dHJpYnV0ZXMoZSk7cmV0dXJuIFhhKHtncm91cEF0dHJpYnV0ZXM6bH0pfX0se2tleTpcIl9nZXRHcm91cEF0dHJpYnV0ZXNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLG89MDtyZXR1cm4gaXQoZS5hdkNoYXRSb29tS2V5KXx8KG89MSksdGhpcy5fZ3JvdXBNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmtzLHJlcXVlc3REYXRhOnQodCh7fSxlKSx7fSx7Z3JvdXBUeXBlOm99KX0pLnRoZW4oKGZ1bmN0aW9uKHQpe1ZlLmwoXCJcIi5jb25jYXQobi5fbixcIi5fZ2V0R3JvdXBBdHRyaWJ1dGVzIG9rLiBncm91cElEOlwiKS5jb25jYXQoZS5ncm91cElEKSk7dmFyIG89dC5kYXRhLHM9by5tYWluU2VxdWVuY2UsYT1vLmdyb3VwQXR0cmlidXRlTGlzdCxpPW0oYSk7cmV0dXJuIGl0KHMpfHxuLl9yZWZyZXNoQ2FjaGVkR3JvdXBBdHRyaWJ1dGVzKHtncm91cElEOmUuZ3JvdXBJRCxyZW1vdGVNYWluU2VxdWVuY2U6cyxncm91cEF0dHJpYnV0ZUxpc3Q6aSxvcGVyYXRpb25UeXBlOkVpfSksYX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIFphKGUpfSkpfX0se2tleTpcIl9yZWZyZXNoQ2FjaGVkR3JvdXBBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cElELG49ZS5yZW1vdGVNYWluU2VxdWVuY2Usbz1lLmdyb3VwQXR0cmlidXRlTGlzdCxzPWUub3BlcmF0aW9uVHlwZTtpZih0aGlzLl9oYXNMb2NhbEdyb3VwQXR0cmlidXRlcyh0KSl7dmFyIGE9dGhpcy5fZ2V0TG9jYWxHcm91cEF0dHJpYnV0ZXModCksaT1hLmxvY2FsTWFpblNlcXVlbmNlO2lmKHM9PT1FaXx8bi1pPT0xKWEucmVtb3RlTWFpblNlcXVlbmNlPW4sYS5sb2NhbE1haW5TZXF1ZW5jZT1uLGEubGFzdFVwZGF0ZVRpbWU9RGF0ZS5ub3coKSx0aGlzLl91cGRhdGVDYWNoZWRBdHRyaWJ1dGVzKHtncm91cEF0dHJpYnV0ZXM6YSxncm91cEF0dHJpYnV0ZUxpc3Q6byxvcGVyYXRpb25UeXBlOnN9KTtlbHNle2lmKGk9PT1uKXJldHVybjthLnJlbW90ZU1haW5TZXF1ZW5jZT1ufXRoaXMuX2dyb3VwQXR0cmlidXRlc01hcC5zZXQodCxhKTt2YXIgcj1cIm9wZXJhdGlvblR5cGU6XCIuY29uY2F0KHMsXCIgbG9jYWxNYWluU2VxdWVuY2U6XCIpLmNvbmNhdChpLFwiIHJlbW90ZU1haW5TZXF1ZW5jZTpcIikuY29uY2F0KG4pO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fcmVmcmVzaENhY2hlZEdyb3VwQXR0cmlidXRlcy4gXCIpLmNvbmNhdChyKSl9fX0se2tleTpcIl9nZXRDYWNoZWRBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cElELG49ZS5rZXlMaXN0LG89dm9pZCAwPT09bj9bXTpuLHM9e307aWYodGhpcy5faGFzTG9jYWxHcm91cEF0dHJpYnV0ZXModCkpe3ZhciBhPXRoaXMuX2dldExvY2FsR3JvdXBBdHRyaWJ1dGVzKHQpLmF0dHJpYnV0ZXM7aWYoby5sZW5ndGg+MClvLmZvckVhY2goKGZ1bmN0aW9uKGUpe2EuaGFzKGUpJiYoc1tlXT1hLmdldChlKS52YWx1ZSl9KSk7ZWxzZXt2YXIgaSxyPUQoYS5rZXlzKCkpO3RyeXtmb3Ioci5zKCk7IShpPXIubigpKS5kb25lOyl7dmFyIHU9aS52YWx1ZTtzW3VdPWEuZ2V0KHUpLnZhbHVlfX1jYXRjaChjKXtyLmUoYyl9ZmluYWxseXtyLmYoKX19fXJldHVybiBzfX0se2tleTpcIl91cGRhdGVDYWNoZWRBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cEF0dHJpYnV0ZXMsbj1lLmdyb3VwQXR0cmlidXRlTGlzdCxvPWUub3BlcmF0aW9uVHlwZTtvIT09RGk/byE9PWtpPyhvPT09Q2kmJnQuYXR0cmlidXRlcy5jbGVhcigpLG4uZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49ZS5rZXksbz1lLnZhbHVlLHM9ZS5zZXF1ZW5jZTt0LmF0dHJpYnV0ZXMuc2V0KG4se3ZhbHVlOm8sc2VxdWVuY2U6c30pfSkpKTpuLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuYXR0cmlidXRlcy5kZWxldGUoZS5rZXkpfSkpOnQuYXR0cmlidXRlcy5jbGVhcigpfX0se2tleTpcIl9oYXNMb2NhbEdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9ncm91cEF0dHJpYnV0ZXNNYXAuaGFzKGUpfX0se2tleTpcIl9nZXRMb2NhbEdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9oYXNMb2NhbEdyb3VwQXR0cmlidXRlcyhlKXx8dGhpcy5pbml0R3JvdXBBdHRyaWJ1dGVzQ2FjaGUoe2dyb3VwSUQ6ZX0pLHRoaXMuX2dyb3VwQXR0cmlidXRlc01hcC5nZXQoZSl9fSx7a2V5OlwiX3RyYW5zZm9ybUdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVtdO3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihuKXt0LnB1c2goe2tleTpuLHZhbHVlOmVbbl19KX0pKSx0fX0se2tleTpcIl9lbWl0R3JvdXBBdHRyaWJ1dGVzVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dldENhY2hlZEF0dHJpYnV0ZXMoe2dyb3VwSUQ6ZX0pLG49dGhpcy5fY29tcHV0ZUF0dHJDaGFuZ2VkSW5mbyh0KSxvPW4udXBkYXRlZEtleUxpc3Qscz1uLmRlbGV0ZWRLZXlMaXN0O1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fZW1pdEdyb3VwQXR0cmlidXRlc1VwZGF0ZWQgdXBkYXRlOlwiKS5jb25jYXQoby5sZW5ndGgsXCIsIGRlbGV0ZTpcIikuY29uY2F0KHMubGVuZ3RoKSksMD09PW8ubGVuZ3RoJiYwPT09cy5sZW5ndGh8fHRoaXMuX2dyb3VwTW9kdWxlLmVtaXRPdXRlckV2ZW50KGsuR1JPVVBfQVRUUklCVVRFU19VUERBVEVELHtncm91cElEOmUsZ3JvdXBBdHRyaWJ1dGVzOnQsdXBkYXRlZEtleUxpc3Q6byxkZWxldGVkS2V5TGlzdDpzfSl9fSx7a2V5OlwiX2NvbXB1dGVBdHRyQ2hhbmdlZEluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49W10sbz1bXTtyZXR1cm4gT2JqZWN0LmtleXMoZSkuZm9yRWFjaCgoZnVuY3Rpb24obyl7ZVtvXSE9PXQuX2dyb3VwQXR0cmlidXRlc0NvcHlbb10mJm4ucHVzaChvKX0pKSxPYmplY3Qua2V5cyh0aGlzLl9ncm91cEF0dHJpYnV0ZXNDb3B5KS5mb3JFYWNoKChmdW5jdGlvbih0KXtpdChlW3RdKSYmby5wdXNoKHQpfSkpLHRoaXMuX2dyb3VwQXR0cmlidXRlc0NvcHk9e30se3VwZGF0ZWRLZXlMaXN0Om4sZGVsZXRlZEtleUxpc3Q6b319fSx7a2V5OlwiZGVsZXRlTG9jYWxHcm91cEF0dHJpYnV0ZXNcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9oYXNMb2NhbEdyb3VwQXR0cmlidXRlcyhlKSYmdGhpcy5fZ3JvdXBBdHRyaWJ1dGVzTWFwLmRlbGV0ZShlKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZ3JvdXBBdHRyaWJ1dGVzTWFwLmNsZWFyKCksdGhpcy5fZ3JvdXBBdHRyaWJ1dGVzQ29weT17fSx0aGlzLkNBQ0hFX0VYUElSRV9USU1FPTNlNH19XSksZX0oKSxMaT1cIlNldFwiLEFpPVwiSW5jcmVhc2VcIixSaT1cIkRlY3JlYXNlXCIsTmk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9ncm91cE1vZHVsZT10LHRoaXMuX249XCJHcm91cENvdW50ZXJzSGFuZGxlclwiLHRoaXMuX2dyb3VwQ291bnRlcnNNYXA9bmV3IE1hcCx0aGlzLkVYUElSRV9USU1FPTNlNCx0aGlzLl9ncm91cE1vZHVsZS5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpLm9uKHRpLHRoaXMuX29uQ2xvdWRDb25maWdVcGRhdGVkLHRoaXMpfXJldHVybiBhKGUsW3trZXk6XCJfb25DbG91ZENvbmZpZ1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX2dyb3VwTW9kdWxlLmdldENsb3VkQ29uZmlnKFwiZ3JwX2NvdW50ZXJfZXhwaXJlX3RpbWVcIik7aXQoZSl8fCh0aGlzLkVYUElSRV9USU1FPU51bWJlcihlKSl9fSx7a2V5OlwiaXNHcm91cENvdW50ZXJzTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50byxuPWUuZWxlbWVudHMuZ3JvdXBDb3VudGVySW5mbyxvPSExO3JldHVybiB6dChuKXx8KHRoaXMuX29uR3JvdXBDb3VudGVyc1VwZGF0ZWQoe2dyb3VwSUQ6dCxncm91cENvdW50ZXJJbmZvOm59KSxvPSEwKSxvfX0se2tleTpcIl9vbkdyb3VwQ291bnRlcnNVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUuZ3JvdXBJRDtlLmdyb3VwQ291bnRlckluZm8uZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG89ZS50eXBlLHM9ZS5ncm91cENvdW50ZXJTZXEsYT1lLmNvdW50ZXJMaXN0LGk9dm9pZCAwPT09YT9bXTphOzAhPT1vJiYyIT09b3x8KHQuX3VwZGF0ZUxvY2FsR3JvdXBDb3VudGVycyh7Z3JvdXBJRDpuLGdyb3VwQ291bnRlclNlcTpzLGNvdW50ZXJMaXN0Oml9KSxpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2dyb3VwTW9kdWxlLmVtaXRPdXRlckV2ZW50KGsuR1JPVVBfQ09VTlRFUl9VUERBVEVELHtncm91cElEOm4sa2V5OmUua2V5LHZhbHVlOmUudmFsdWV9KX0pKSksMT09PW8mJnQuX2RlbGV0ZUxvY2FsR3JvdXBDb3VudGVycyh7Z3JvdXBJRDpuLGdyb3VwQ291bnRlclNlcTpzLGNvdW50ZXJMaXN0Oml9KX0pKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uR3JvdXBDb3VudGVyc1VwZGF0ZWQgZ3JvdXBJRDpcIikuY29uY2F0KG4pKX19LHtrZXk6XCJpbml0R3JvdXBDb3VudGVyc0NhY2hlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cElELG49ZS5hdkNoYXRSb29tS2V5O3RoaXMuX2dyb3VwQ291bnRlcnNNYXAuc2V0KHQse2xhc3RVcGRhdGVUaW1lOjAsZ3JvdXBDb3VudGVyU2VxOjAsY291bnRlcnM6bmV3IE1hcCxhdkNoYXRSb29tS2V5Om59KSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuaW5pdEdyb3VwQ291bnRlcnNDYWNoZSBncm91cElEOlwiKS5jb25jYXQodCxcIiBhdkNoYXRSb29tS2V5OlwiKS5jb25jYXQobikpfX0se2tleTpcInNldEdyb3VwQ291bnRlcnNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0aGlzLl9ncm91cE1vZHVsZS5jYW5JVXNlKEIuR1JQX0NPVU5URVIpKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWX0pO3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuc2V0R3JvdXBDb3VudGVyc1wiKSxvPWUuZ3JvdXBJRCxzPWUuY291bnRlcnMsYT10aGlzLl9jb252ZXJ0T2JqZWN0VG9MaXN0KHMpLGk9dGhpcy5fZ2V0TG9jYWxHcm91cENvdW50ZXJzKG8pLmF2Q2hhdFJvb21LZXkscj1cImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgY291bnQ6XCIpLmNvbmNhdChhLmxlbmd0aCksdT1uZXcgQWEoXCJzZXRHcm91cENvdW50ZXJzXCIpO3JldHVybiB1LnNldE1lc3NhZ2UoXCJcIi5jb25jYXQocikpLFZlLmwoXCJcIi5jb25jYXQobixcIi4gXCIpLmNvbmNhdChyKSksdGhpcy5fdXBkYXRlR3JvdXBDb3VudGVycyh7Z3JvdXBJRDpvLGNvdW50ZXJMaXN0OmEsYXZDaGF0Um9vbUtleTppLG1vZGU6TGl9KS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gdS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suXCIpKSxZYSh7Y291bnRlcnM6ZX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fZ3JvdXBNb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07dS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImluY3JlYXNlR3JvdXBDb3VudGVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighdGhpcy5fZ3JvdXBNb2R1bGUuY2FuSVVzZShCLkdSUF9DT1VOVEVSKSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX1VTRV9DT01NRVJDSUFMX0FCSUxJVFl9KTt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmluY3JlYXNlR3JvdXBDb3VudGVyc1wiKSxvPWUuZ3JvdXBJRCxzPWUua2V5LGE9ZS52YWx1ZSxpPXRoaXMuX2dldExvY2FsR3JvdXBDb3VudGVycyhvKS5hdkNoYXRSb29tS2V5LHI9XCJncm91cElEOlwiLmNvbmNhdChvLFwiIGtleTpcIikuY29uY2F0KHMsXCIgdmFsdWU6XCIpLmNvbmNhdChhKSx1PW5ldyBBYShcImluY3JlYXNlR3JvdXBDb3VudGVyXCIpO3Uuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChyKSksVmUubChcIlwiLmNvbmNhdChuLFwiLiBcIikuY29uY2F0KHIpKTt2YXIgYz1be2tleTpzLHZhbHVlOmF9XTtyZXR1cm4gdGhpcy5fdXBkYXRlR3JvdXBDb3VudGVycyh7Z3JvdXBJRDpvLGNvdW50ZXJMaXN0OmMsYXZDaGF0Um9vbUtleTppLG1vZGU6QWl9KS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gdS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suXCIpKSxZYSh7Y291bnRlcnM6ZX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fZ3JvdXBNb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07dS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImRlY3JlYXNlR3JvdXBDb3VudGVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighdGhpcy5fZ3JvdXBNb2R1bGUuY2FuSVVzZShCLkdSUF9DT1VOVEVSKSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX1VTRV9DT01NRVJDSUFMX0FCSUxJVFl9KTt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmRlY3JlYXNlR3JvdXBDb3VudGVyXCIpLG89ZS5ncm91cElELHM9ZS5rZXksYT1lLnZhbHVlLGk9dGhpcy5fZ2V0TG9jYWxHcm91cENvdW50ZXJzKG8pLmF2Q2hhdFJvb21LZXkscj1cImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIga2V5OlwiKS5jb25jYXQocyxcIiB2YWx1ZTpcIikuY29uY2F0KGEpLHU9bmV3IEFhKFwiZGVjcmVhc2VHcm91cENvdW50ZXJcIik7dS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KHIpKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIuIFwiKS5jb25jYXQocikpO3ZhciBjPVt7a2V5OnMsdmFsdWU6YX1dO3JldHVybiB0aGlzLl91cGRhdGVHcm91cENvdW50ZXJzKHtncm91cElEOm8sY291bnRlckxpc3Q6YyxhdkNoYXRSb29tS2V5OmksbW9kZTpSaX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiB1LmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBvay5cIikpLFlhKHtjb3VudGVyczplfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll9ncm91cE1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTt1LnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiZ2V0R3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoIXRoaXMuX2dyb3VwTW9kdWxlLmNhbklVc2UoQi5HUlBfQ09VTlRFUikpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7dmFyIG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRHcm91cENvdW50ZXJzXCIpLG89ZS5ncm91cElELHM9ZS5rZXlMaXN0LGE9dm9pZCAwPT09cz9bXTpzLGk9dGhpcy5fZ2V0TG9jYWxHcm91cENvdW50ZXJzKG8pLHI9aS5hdkNoYXRSb29tS2V5LHU9aS5sYXN0VXBkYXRlVGltZSxjPW5ldyBBYShcImdldEdyb3VwQ291bnRlcnNcIik7aWYoYy5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQobykpLERhdGUubm93KCktdT49dGhpcy5FWFBJUkVfVElNRSlyZXR1cm4gdGhpcy5fZ2V0UmVtb3RlR3JvdXBDb3VudGVycyh7Z3JvdXBJRDpvLGF2Q2hhdFJvb21LZXk6cn0pLnRoZW4oKGZ1bmN0aW9uKGUpe2Muc2V0TW9yZU1lc3NhZ2UoXCJmcm9tIHJlbW90ZS4gY291bnQ6XCIuY29uY2F0KGUubGVuZ3RoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIGZyb20gcmVtb3RlLiBncm91cElEOlwiKS5jb25jYXQobykpO3ZhciBzPXQuX2dldExvY2FsQ291bnRlcnMobyxhKTtyZXR1cm4gWWEoe2NvdW50ZXJzOnN9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX2dyb3VwTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2Muc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFphKGUpfSkpO2Muc2V0TW9yZU1lc3NhZ2UoXCJmcm9tIGNhY2hlXCIpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBmcm9tIGNhY2hlLiBncm91cElEOlwiKS5jb25jYXQobykpO3ZhciBsPXRoaXMuX2dldExvY2FsQ291bnRlcnMobyxhKTtyZXR1cm4gWGEoe2NvdW50ZXJzOmx9KX19LHtrZXk6XCJfZ2V0UmVtb3RlR3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXM7cmV0dXJuIHRoaXMuX2dyb3VwTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpScyxyZXF1ZXN0RGF0YTp0KHt9LGUpfSkudGhlbigoZnVuY3Rpb24odCl7dmFyIG89dC5kYXRhLHM9by5jb3VudGVyTGlzdCxhPXZvaWQgMD09PXM/W106cyxpPW8uZ3JvdXBDb3VudGVyU2VxO3JldHVybiBuLl91cGRhdGVMb2NhbEdyb3VwQ291bnRlcnMoe2dyb3VwSUQ6ZS5ncm91cElELGNvdW50ZXJMaXN0OmEsZ3JvdXBDb3VudGVyU2VxOml9KSxWZS5sKFwiXCIuY29uY2F0KG4uX24sXCIuX2dldFJlbW90ZUdyb3VwQ291bnRlcnMgb2suIGdyb3VwSUQ6XCIpLmNvbmNhdChlLmdyb3VwSUQpKSxhfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gWmEoZSl9KSl9fSx7a2V5OlwiX2NvbnZlcnRPYmplY3RUb0xpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1bXTtyZXR1cm4gT2JqZWN0LmtleXMoZSkuZm9yRWFjaCgoZnVuY3Rpb24obil7dC5wdXNoKHtrZXk6bix2YWx1ZTplW25dfSl9KSksdH19LHtrZXk6XCJfdXBkYXRlR3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3VwZGF0ZUdyb3VwQ291bnRlcnNcIiksbz1lLmdyb3VwSUQscz1lLmF2Q2hhdFJvb21LZXksYT1lLm1vZGU7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQobixcIi4gZ3JvdXBJRDpcIikuY29uY2F0KG8sXCIgYXZDaGF0Um9vbUtleTpcIikuY29uY2F0KHMsXCIgbW9kZTpcIikuY29uY2F0KGEpKSx0aGlzLl9ncm91cE1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6QXMscmVxdWVzdERhdGE6dCh7fSxlKX0pLnRoZW4oKGZ1bmN0aW9uKGUpe1ZlLmwoXCJcIi5jb25jYXQobixcIiBvay5cIikpO3ZhciB0PWUuZGF0YS5jb3VudGVyTGlzdCxvPXt9O3JldHVybih2b2lkIDA9PT10P1tdOnQpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUua2V5LG49ZS52YWx1ZTtvW3RdPW59KSksb30pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIFphKGUpfSkpfX0se2tleTpcIl9oYXNMb2NhbEdyb3VwQ291bnRlcnNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ3JvdXBDb3VudGVyc01hcC5oYXMoZSl9fSx7a2V5OlwiX2dldExvY2FsR3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9oYXNMb2NhbEdyb3VwQ291bnRlcnMoZSl8fHRoaXMuaW5pdEdyb3VwQ291bnRlcnNDYWNoZSh7Z3JvdXBJRDplfSksdGhpcy5fZ3JvdXBDb3VudGVyc01hcC5nZXQoZSl9fSx7a2V5OlwiX3VwZGF0ZUxvY2FsR3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ3JvdXBJRCxuPWUuY291bnRlckxpc3Qsbz12b2lkIDA9PT1uP1tdOm4scz1lLmdyb3VwQ291bnRlclNlcTtpZih0aGlzLl9oYXNMb2NhbEdyb3VwQ291bnRlcnModCkpe3ZhciBhPXRoaXMuX2dldExvY2FsR3JvdXBDb3VudGVycyh0KSxpPWEuY291bnRlcnMscj1hLmF2Q2hhdFJvb21LZXksdT1hLmdyb3VwQ291bnRlclNlcTtpZihzPjAmJnM8dSlyZXR1cm47by5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1lLmtleSxuPWUudmFsdWU7aS5zZXQodCxuKX0pKSx0aGlzLl9ncm91cENvdW50ZXJzTWFwLnNldCh0LHtsYXN0VXBkYXRlVGltZTpEYXRlLm5vdygpLGdyb3VwQ291bnRlclNlcTpzLGNvdW50ZXJzOmksYXZDaGF0Um9vbUtleTpyfSl9fX0se2tleTpcIl9kZWxldGVMb2NhbEdyb3VwQ291bnRlcnNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmdyb3VwSUQsbj1lLmNvdW50ZXJMaXN0LG89dm9pZCAwPT09bj9bXTpuLHM9ZS5ncm91cENvdW50ZXJTZXE7aWYodGhpcy5faGFzTG9jYWxHcm91cENvdW50ZXJzKHQpKXt2YXIgYT10aGlzLl9nZXRMb2NhbEdyb3VwQ291bnRlcnModCksaT1hLmNvdW50ZXJzLHI9YS5hdkNoYXRSb29tS2V5O28uZm9yRWFjaCgoZnVuY3Rpb24oZSl7aS5kZWxldGUoZS5rZXkpfSkpLHRoaXMuX2dyb3VwQ291bnRlcnNNYXAuc2V0KHQse2xhc3RVcGRhdGVUaW1lOkRhdGUubm93KCksZ3JvdXBDb3VudGVyU2VxOnMsY291bnRlcnM6aSxhdkNoYXRSb29tS2V5OnJ9KX19fSx7a2V5OlwiX2dldExvY2FsQ291bnRlcnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXt9O2lmKCF0aGlzLl9oYXNMb2NhbEdyb3VwQ291bnRlcnMoZSkpcmV0dXJuIG47dmFyIG89dGhpcy5fZ2V0TG9jYWxHcm91cENvdW50ZXJzKGUpLmNvdW50ZXJzO2lmKHQubGVuZ3RoPjApdC5mb3JFYWNoKChmdW5jdGlvbihlKXtvLmhhcyhlKSYmKG5bZV09by5nZXQoZSkpfSkpO2Vsc2V7dmFyIHMsYT1EKG8ua2V5cygpKTt0cnl7Zm9yKGEucygpOyEocz1hLm4oKSkuZG9uZTspe3ZhciBpPXMudmFsdWU7bltpXT1vLmdldChpKX19Y2F0Y2gocil7YS5lKHIpfWZpbmFsbHl7YS5mKCl9fXJldHVybiBufX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9ncm91cENvdW50ZXJzTWFwLmNsZWFyKCksdGhpcy5FWFBJUkVfVElNRT0zZTR9fV0pLGV9KCksT2k9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKTt2YXIgbj10Lm1hbmFnZXIscz10Lmdyb3VwSUQsYT10Lm9uSW5pdCxpPXQub25TdWNjZXNzLHI9dC5vbkZhaWw7dGhpcy5fbj1cIlBvbGxpbmdcIix0aGlzLl9tYW5hZ2VyPW4sdGhpcy5fZ3JvdXBNb2R1bGU9bi5fZ3JvdXBNb2R1bGUsdGhpcy5fb25Jbml0PWEsdGhpcy5fb25TdWNjZXNzPWksdGhpcy5fb25GYWlsPXIsdGhpcy5fZ3JvdXBJRD1zLHRoaXMuX3RpbWVvdXRJRD0tMSx0aGlzLl9pc1J1bm5pbmc9ITEsdGhpcy5fcHJvdG9jb2xOYW1lPWZzfXJldHVybiBhKGUsW3trZXk6XCJzdGFydFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZ3JvdXBNb2R1bGUuaXNMb2dnZWRJbigpO2V8fCh0aGlzLl9wcm90b2NvbE5hbWU9dnMpLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5zdGFydCBwb2xsaW5nSW50ZXJ2YWw6XCIpLmNvbmNhdCh0aGlzLl9tYW5hZ2VyLmdldFBvbGxpbmdJbnRlcnZhbCgpLFwiIGlzTG9nZ2VkSW46XCIpLmNvbmNhdChlKSksdGhpcy5faXNSdW5uaW5nPSEwLHRoaXMuX3JlcXVlc3QoKX19LHtrZXk6XCJpc1J1bm5pbmdcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1J1bm5pbmd9fSx7a2V5OlwiX3JlcXVlc3RcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLl9vbkluaXQodGhpcy5fZ3JvdXBJRCk7dGhpcy5fZ3JvdXBNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOnRoaXMuX3Byb3RvY29sTmFtZSxyZXF1ZXN0RGF0YTp0fSkudGhlbigoZnVuY3Rpb24odCl7ZS5fb25TdWNjZXNzKGUuX2dyb3VwSUQsdCksZS5pc1J1bm5pbmcoKSYmKGNsZWFyVGltZW91dChlLl90aW1lb3V0SUQpLGUuX3RpbWVvdXRJRD1zZXRUaW1lb3V0KGUuX3JlcXVlc3QuYmluZChlKSxlLl9tYW5hZ2VyLmdldFBvbGxpbmdJbnRlcnZhbCgpKSl9KSkuY2F0Y2goKGZ1bmN0aW9uKHQpe2UuX29uRmFpbChlLl9ncm91cElELHQpLGUuaXNSdW5uaW5nKCkmJihjbGVhclRpbWVvdXQoZS5fdGltZW91dElEKSxlLl90aW1lb3V0SUQ9c2V0VGltZW91dChlLl9yZXF1ZXN0LmJpbmQoZSksZS5fbWFuYWdlci5NQVhfUE9MTElOR19JTlRFUlZBTCkpfSkpfX0se2tleTpcInN0b3BcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5zdG9wXCIpKSx0aGlzLl90aW1lb3V0SUQ+MCYmKGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0SUQpLHRoaXMuX3RpbWVvdXRJRD0tMSksdGhpcy5faXNSdW5uaW5nPSExfX0se2tleTpcImdldFBvbGxpbmdUaW1lcklEXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGltZW91dElEfX1dKSxlfSgpLEdpPXszOiEwLDQ6ITAsNTohMCw2OiEwLDE3OiEwfSxVaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpLHRoaXMuX2dyb3VwTW9kdWxlPXQsdGhpcy5fbj1cIkFWQ2hhdFJvb21IYW5kbGVyXCIsdGhpcy5fam9pbmVkR3JvdXBNYXA9bmV3IE1hcCx0aGlzLl9wb2xsaW5nUmVxdWVzdEluZm9NYXA9bmV3IE1hcCx0aGlzLl9wb2xsaW5nSW5zdGFuY2VNYXA9bmV3IE1hcCx0aGlzLnNlcXVlbmNlc0xpbmtlZExpc3Q9bmV3IHBpKDIwMCksdGhpcy5tZXNzYWdlSURMaW5rZWRMaXN0PW5ldyBwaSgxMDApLHRoaXMucmVjZWl2ZWRNZXNzYWdlQ291bnQ9MCx0aGlzLl9yZXBvcnRNZXNzYWdlU3RhY2tlZENvdW50PTAsdGhpcy5fb25saW5lTWVtYmVyQ291bnRNYXA9bmV3IE1hcCx0aGlzLkRFRkFVTFRfRVhQSVJFX1RJTUU9NjAsdGhpcy5ERUZBVUxUX1BPTExJTkdfSU5URVJWQUw9MzAwLHRoaXMuTUFYX1BPTExJTkdfSU5URVJWQUw9MmUzLHRoaXMuX3BvbGxpbmdJbnRlcnZhbD10aGlzLkRFRkFVTFRfUE9MTElOR19JTlRFUlZBTCx0aGlzLkRFRkFVTFRfUE9MTElOR19OT19NRVNTQUdFX0NPVU5UPTIwLHRoaXMuREVGQVVMVF9QT0xMSU5HX0lOVEVSVkFMX1BMVVM9MmUzLHRoaXMuX3BvbGxpbmdOb01lc3NhZ2VDb3VudD0wLHRoaXMuX3N0YXJ0QnJvYWRjYXN0U2VxPTEsdGhpcy5fYnJvYWRjYXN0TWVzc2FnZUlETWFwPW5ldyBNYXAsdGhpcy5ERUZBVUxUX1BPTExJTkdfU0lNUExJRklFRF9NU0c9MH1yZXR1cm4gYShlLFt7a2V5OlwiaGFzSm9pbmVkQVZDaGF0Um9vbVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2pvaW5lZEdyb3VwTWFwLnNpemU+MH19LHtrZXk6XCJjaGVja0pvaW5lZEFWQ2hhdFJvb21CeUlEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2pvaW5lZEdyb3VwTWFwLmhhcyhlKX19LHtrZXk6XCJnZXRKb2luZWRBVkNoYXRSb29tXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fam9pbmVkR3JvdXBNYXAuc2l6ZT4wP20odGhpcy5fam9pbmVkR3JvdXBNYXAua2V5cygpKTpudWxsfX0se2tleTpcIl91cGRhdGVSZXF1ZXN0RGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMuX3BvbGxpbmdSZXF1ZXN0SW5mb01hcC5nZXQoZSk7cmV0dXJuIGU9PT1tKHRoaXMuX3BvbGxpbmdJbnN0YW5jZU1hcC5rZXlzKCkpWzBdP3QodCh7fSxuKSx7fSx7c3RhcnRCcm9hZGNhc3RTZXE6dGhpcy5fc3RhcnRCcm9hZGNhc3RTZXEsc2ltcGxpZmllZE1lc3NhZ2U6dGhpcy5ERUZBVUxUX1BPTExJTkdfU0lNUExJRklFRF9NU0d9KTp0KHQoe30sbikse30se3NpbXBsaWZpZWRNZXNzYWdlOnRoaXMuREVGQVVMVF9QT0xMSU5HX1NJTVBMSUZJRURfTVNHfSl9fSx7a2V5OlwiX2hhbmRsZVN1Y2Nlc3NcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXQuZGF0YSxvPW4ua2V5LHM9bi5uZXh0U2VxLGE9bi5yc3BNc2dMaXN0LGk9bi5lcnJvckNvZGUscj1uLm5leHRCcm9hZGNhc3RTZXEsdT1uLmJyb2FkY2FzdE1lc3NhZ2VMaXN0O2lmKDAhPT1pKXt2YXIgYz10aGlzLl9wb2xsaW5nUmVxdWVzdEluZm9NYXAuZ2V0KGUpLGw9bmV3IEFhKFwibG9uZ1BvbGxpbmdBVkVycm9yXCIpLGQ9Yz9cIlwiLmNvbmNhdChjLmtleSxcIi1cIikuY29uY2F0KGMuc3RhcnRTZXEpOlwicmVxdWVzdEluZm8gaXMgdW5kZWZpbmVkXCI7bC5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KGUsXCItXCIpLmNvbmNhdChkLFwiLVwiKS5jb25jYXQodC5lcnJvckluZm8pKS5zZXRDb2RlKHQuZXJyb3JDb2RlKS5zZXROZXR3b3JrVHlwZSh0aGlzLl9ncm91cE1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoITApfWVsc2V7aWYoIXRoaXMuY2hlY2tKb2luZWRBVkNoYXRSb29tQnlJRChlKSlyZXR1cm47bnQobykmJmV0KHMpJiZ0aGlzLl9wb2xsaW5nUmVxdWVzdEluZm9NYXAuc2V0KGUse2tleTpvLHN0YXJ0U2VxOnN9KSxldChyKSYmcj50aGlzLl9zdGFydEJyb2FkY2FzdFNlcSYmKHRoaXMuX3N0YXJ0QnJvYWRjYXN0U2VxPXIpLGF0KGEpJiZhLmxlbmd0aD4wPyhhLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UudG89ZS5ncm91cElEfSkpLHRoaXMub25NZXNzYWdlKGEpKToodGhpcy5fcG9sbGluZ05vTWVzc2FnZUNvdW50Kz0xLHRoaXMuX3BvbGxpbmdOb01lc3NhZ2VDb3VudD09PXRoaXMuREVGQVVMVF9QT0xMSU5HX05PX01FU1NBR0VfQ09VTlQmJih0aGlzLl9wb2xsaW5nSW50ZXJ2YWw9dGhpcy5ERUZBVUxUX1BPTExJTkdfSU5URVJWQUwrdGhpcy5ERUZBVUxUX1BPTExJTkdfSU5URVJWQUxfUExVUykpLHRoaXMuX29uQnJvYWRjYXN0TWVzc2FnZSh1KX19fSx7a2V5OlwiX2hhbmRsZUZhaWx1cmVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe319LHtrZXk6XCJvbk1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihhdChlKSYmMCE9PWUubGVuZ3RoKXswIT09dGhpcy5fcG9sbGluZ05vTWVzc2FnZUNvdW50JiYodGhpcy5fcG9sbGluZ05vTWVzc2FnZUNvdW50PTAsdGhpcy5fcG9sbGluZ0ludGVydmFsPXRoaXMuREVGQVVMVF9QT0xMSU5HX0lOVEVSVkFMKTt2YXIgdD1udWxsLG49W10sbz10aGlzLl9nZXRNb2R1bGUocW4pLHM9dGhpcy5fZ2V0TW9kdWxlKGVvKSxhPWUubGVuZ3RoO2E+MSYmZS5zb3J0KChmdW5jdGlvbihlLHQpe3JldHVybiBlLnNlcXVlbmNlLXQuc2VxdWVuY2V9KSk7Zm9yKHZhciBpPXRoaXMuX2dldE1vZHVsZSh4bikscj0wO3I8YTtyKyspe3ZhciB1PXRoaXMucmVzdG9yZU1lc3NhZ2VGcm9tU2ltcGxpZmllZChlW3JdKTtpZihHaVt1LmV2ZW50XSl7aWYoNj09PXUuZXZlbnQpe2lmKHRoaXMuX2dyb3VwTW9kdWxlLmlzR3JvdXBBdHRyaWJ1dGVzVXBkYXRlZE5vdGljZSh1KSljb250aW51ZTtpZih0aGlzLl9ncm91cE1vZHVsZS5pc0dyb3VwQ291bnRlcnNOb3RpY2UodSkpY29udGludWV9dGhpcy5yZWNlaXZlZE1lc3NhZ2VDb3VudCs9MSx0PXRoaXMucGFja01lc3NhZ2UodSx1LmV2ZW50KTt2YXIgYz0xPT09dS5pc01vZGlmaWVkLGw9MT09PXUuaXNIaXN0b3J5TWVzc2FnZTtpZigoaS5pc1VubGltaXRlZEFWQ2hhdFJvb20oKXx8IXRoaXMuc2VxdWVuY2VzTGlua2VkTGlzdC5oYXModC5zZXF1ZW5jZSkpJiYhdGhpcy5tZXNzYWdlSURMaW5rZWRMaXN0Lmhhcyh0LklEKSl7dmFyIGQ9dC5jb252ZXJzYXRpb25JRDtpZih0aGlzLnJlY2VpdmVkTWVzc2FnZUNvdW50JTUwPT0wP3RoaXMuX2dldE1vZHVsZShYbikuZGV0ZWN0Rmlyc3RSb3VuZChkLHRoaXMuc2VxdWVuY2VzTGlua2VkTGlzdC5kYXRhKCkpOnRoaXMucmVjZWl2ZWRNZXNzYWdlQ291bnQlODA9PTAmJnRoaXMuX2dldE1vZHVsZShYbikuZGV0ZWN0U2Vjb25kUm91bmQoZCx0aGlzLnNlcXVlbmNlc0xpbmtlZExpc3QuZGF0YSgpKSxudWxsIT09dGhpcy5zZXF1ZW5jZXNMaW5rZWRMaXN0LnRhaWwoKSl7dmFyIHA9dGhpcy5zZXF1ZW5jZXNMaW5rZWRMaXN0LnRhaWwoKS52YWx1ZSxnPXQuc2VxdWVuY2UtcDtnPjEmJmc8PTIwP3RoaXMuX2dldE1vZHVsZShYbikub25NZXNzYWdlTWF5YmVMb3N0KGQscCsxLGctMSk6ZzwtMSYmZz49LTIwJiZ0aGlzLl9nZXRNb2R1bGUoWG4pLm9uTWVzc2FnZU1heWJlTG9zdChkLHQuc2VxdWVuY2UrMSxNYXRoLmFicyhnKS0xKX10aGlzLnNlcXVlbmNlc0xpbmtlZExpc3Quc2V0KHQuc2VxdWVuY2UpLHRoaXMubWVzc2FnZUlETGlua2VkTGlzdC5zZXQodC5JRCk7dmFyIGg9ITE7aWYodGhpcy5faXNNZXNzYWdlU2VudEJ5Q3VycmVudEluc3RhbmNlKHQpP2MmJihoPSEwLHQuaXNNb2RpZmllZD1jLG8udXBkYXRlTWVzc2FnZUlzTW9kaWZpZWRQcm9wZXJ0eSh0KSk6aD0hMCxoKXtpZih0LmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfU1lTVEVNJiY1PT09dC5wYXlsb2FkLm9wZXJhdGlvblR5cGUmJnRoaXMuX29uR3JvdXBEaXNtaXNzZWQodC5wYXlsb2FkLmdyb3VwUHJvZmlsZS5ncm91cElEKSwhbCYmdC5jb252ZXJzYXRpb25UeXBlIT09RS5DT05WX1NZU1RFTSl7dmFyIF89dC5jb252ZXJzYXRpb25JRC5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKTt0aGlzLl9wb2xsaW5nSW5zdGFuY2VNYXAuaGFzKF8pP3RoaXMuX2dyb3VwTW9kdWxlLmlzTG9nZ2VkSW4oKSYmcy5hZGRNZXNzYWdlU2VxdWVuY2Uoe2tleTpEYSxtZXNzYWdlOnR9KToodC50eXBlIT09RS5NU0dfR1JQX1RJUCYmdC5jbGllbnRUaW1lPjAmJnMuYWRkTWVzc2FnZURlbGF5KHQuY2xpZW50VGltZSkscy5hZGRNZXNzYWdlU2VxdWVuY2Uoe2tleTpUYSxtZXNzYWdlOnR9KSl9bi5wdXNoKHQpfX19ZWxzZSBWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25NZXNzYWdlIHVua25vd24gZXZlbnQ6XCIpLmNvbmNhdCh1LmV2ZW50KSl9aWYoMCE9PW4ubGVuZ3RoKXt0aGlzLl9ncm91cE1vZHVsZS5maWx0ZXJNb2RpZmllZE1lc3NhZ2Uobik7dmFyIGY9dGhpcy5wYWNrQ29udmVyc2F0aW9uT3B0aW9uKG4pO2lmKGYubGVuZ3RoPjApdGhpcy5fZ2V0TW9kdWxlKHFuKS5vbk5ld01lc3NhZ2Uoe2NvbnZlcnNhdGlvbk9wdGlvbnNMaXN0OmYsaXNJbnN0YW50TWVzc2FnZTohMH0pO1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbk1lc3NhZ2UgY291bnQ6XCIpLmNvbmNhdChuLmxlbmd0aCkpLHRoaXMuX2NoZWNrTWVzc2FnZVN0YWNrZWQobik7dmFyIHY9dGhpcy5fZ3JvdXBNb2R1bGUuZmlsdGVyVW5tb2RpZmllZE1lc3NhZ2Uobik7di5sZW5ndGg+MCYmdGhpcy5fZ3JvdXBNb2R1bGUuZW1pdE91dGVyRXZlbnQoay5NRVNTQUdFX1JFQ0VJVkVELHYpLG4ubGVuZ3RoPTB9fX19LHtrZXk6XCJpc0Jyb2FkY2FzdE9yTm9ybWFsXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIDM9PT1lfHwxNz09PWV9fSx7a2V5OlwiaXNHcm91cFRpcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiA0PT09ZXx8Nj09PWV9fSx7a2V5OlwiaXNHcm91cFN5c3RlbU5vdGljZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiA1PT09ZX19LHtrZXk6XCJyZXN0b3JlR3JvdXBUaXBFbGVtZW50c1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnt9O2UuZ3JvdXBKb2luVHlwZXx8KGUuZ3JvdXBKb2luVHlwZT0xKTt2YXIgdD1lLm9wZXJhdG9ySW5mbyxuPXZvaWQgMD09PXQ/e306dCxvPWUub3BlcmF0b3JJRCxzPWUudXNlcklETGlzdCxhPXZvaWQgMD09PXM/W106cyxpPW4udXNlcklELHI9dm9pZCAwPT09aT9vOmksdT1uLmF2YXRhcixjPXZvaWQgMD09PXU/XCJcIjp1LGw9bi5uaWNrLGQ9dm9pZCAwPT09bD9cIlwiOmw7ZS5vcGVyYXRvckluZm89e3VzZXJJRDpyLGF2YXRhcjpjLG5pY2s6ZH07dmFyIHA9YS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybnt1c2VySUQ6ZX19KSk7cmV0dXJuIGUubWVtYmVySW5mb0xpc3Q9ZS5tZW1iZXJJbmZvTGlzdHx8cCxlfX0se2tleTpcInJlc3RvcmVNZXNzYWdlRnJvbVNpbXBsaWZpZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj1lLmV2ZW50O2lmKHRoaXMuaXNCcm9hZGNhc3RPck5vcm1hbChuKSYmKGUuY2xvdWRDdXN0b21EYXRhPWUuY2xvdWRDdXN0b21EYXRhfHxcIlwiLGUuZWxlbWVudHM9ZS5lbGVtZW50cy5tYXAoKGZ1bmN0aW9uKGUpe2lmKGUudHlwZT09PUUuTVNHX0NVU1RPTSl7dmFyIG49ZS5jb250ZW50LG89dm9pZCAwPT09bj97fTpuO2UuY29udGVudD10KHtkYXRhOlwiXCIsZGVzY3JpcHRpb246XCJcIixleHRlbnNpb246XCJcIn0sbyl9cmV0dXJuIGV9KSkpLCh0aGlzLmlzR3JvdXBUaXAobil8fHRoaXMuaXNHcm91cFN5c3RlbU5vdGljZShuKSkmJihlLmZyb209ZS5mcm9tfHxcIkBUSU0jU1lTVEVNXCIpLHRoaXMuaXNHcm91cFRpcChuKSl7ZS5lbGVtZW50cz10aGlzLnJlc3RvcmVHcm91cFRpcEVsZW1lbnRzKGUuZWxlbWVudHMpO3ZhciBvPWUuZWxlbWVudHMscz12b2lkIDA9PT1vP3t9Om8sYT1zLm9wZXJhdGlvblR5cGUscj1zLm9wZXJhdG9ySW5mbztpZigxPT09YSl7dmFyIHU9W3t1c2VySUQ6KHZvaWQgMD09PXI/e306cikudXNlcklEfV07cy5tZW1iZXJJbmZvTGlzdD1zLm1lbWJlckluZm9MaXN0fHx1fX1pZih0aGlzLmlzR3JvdXBTeXN0ZW1Ob3RpY2Uobikpe3ZhciBjPWUuZWxlbWVudHMsbD1jLm1lbWJlckluZm9MaXN0LGQ9Yy5vcGVyYXRvckluZm87bHx8KGw9dm9pZCAwPT09ZD97fTpkKSxlLmVsZW1lbnRzLm1lbWJlckluZm9MaXN0PXQoe3VzZXJJRDplLmVsZW1lbnRzLm9wZXJhdG9ySUQsYXZhdGFyOlwiXCIsbmljazpcIlwifSxsKSxlLmVsZW1lbnRzPXQoe2F1dGhlbnRpY2F0aW9uOlwiXCIscmVtYXJrSW5mbzpcIlwiLG1lc3NhZ2VLZXk6MWUzKmUudGltZX0sZS5lbGVtZW50cyk7dmFyIHA9T2JqZWN0LmtleXMoZS5lbGVtZW50cykuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm5cIm9wZXJhdG9ySW5mb1wiIT09ZX0pKS5yZWR1Y2UoKGZ1bmN0aW9uKG4sbyl7cmV0dXJuIHQodCh7fSxuKSx7fSxpKHt9LG8sZS5lbGVtZW50c1tvXSkpfSkse30pO2UuZWxlbWVudHM9cH1yZXR1cm4gZX19LHtrZXk6XCJfb25Hcm91cERpc21pc3NlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fb25Hcm91cERpc21pc3NlZCBncm91cElEOlwiKS5jb25jYXQoZSkpLHRoaXMuX2dyb3VwTW9kdWxlLmRlbGV0ZUxvY2FsR3JvdXBBbmRDb252ZXJzYXRpb24oZSksdGhpcy5yZXNldChlKX19LHtrZXk6XCJfY2hlY2tNZXNzYWdlU3RhY2tlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVwiTWVzc2FnZVN0YWNrZWRcIixuPWUubGVuZ3RoO24+PTEwMCYmKHRoaXMuX2dyb3VwTW9kdWxlLm91dHB1dFdhcm5pbmcodCxuKSx0aGlzLl9yZXBvcnRNZXNzYWdlU3RhY2tlZENvdW50PDUmJihuZXcgQWEodCkuc2V0TmV0d29ya1R5cGUodGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcImNvdW50OlwiLmNvbmNhdChuLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChtKHRoaXMuX2pvaW5lZEdyb3VwTWFwLmtleXMoKSkpKS5zZXRMZXZlbChcIndhcm5pbmdcIikuZW5kKCksdGhpcy5fcmVwb3J0TWVzc2FnZVN0YWNrZWRDb3VudCs9MSkpfX0se2tleTpcIl9pc01lc3NhZ2VTZW50QnlDdXJyZW50SW5zdGFuY2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4hIXRoaXMuX2dldE1vZHVsZShxbikuaXNNZXNzYWdlU2VudEJ5Q3VycmVudEluc3RhbmNlKGUpfX0se2tleTpcInBhY2tNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtlLmN1cnJlbnRVc2VyPXRoaXMuX2dyb3VwTW9kdWxlLmdldE15VXNlcklEKCksZS5jb252ZXJzYXRpb25UeXBlPTU9PT10P0UuQ09OVl9TWVNURU06RS5DT05WX0dST1VQLGUuaXNTeXN0ZW1NZXNzYWdlPSEhZS5pc1N5c3RlbU1lc3NhZ2U7dmFyIG49bmV3IFdhKGUpLG89dGhpcy5wYWNrRWxlbWVudHMoZSx0KTtyZXR1cm4gbi5zZXRFbGVtZW50KG8sdGhpcy5fZ3JvdXBNb2R1bGUuZ2V0RmlsZURvd25sb2FkUHJveHkoKSksbn19LHtrZXk6XCJwYWNrRWxlbWVudHNcIix2YWx1ZTpmdW5jdGlvbihlLG4pe3JldHVybiA0PT09bnx8Nj09PW4/KHRoaXMuX3VwZGF0ZU1lbWJlckNvdW50QnlHcm91cFRpcHMoZSkse3R5cGU6RS5NU0dfR1JQX1RJUCxjb250ZW50OnQodCh7fSxlLmVsZW1lbnRzKSx7fSx7Z3JvdXBQcm9maWxlOmUuZ3JvdXBQcm9maWxlfSl9KTo1PT09bj97dHlwZTpFLk1TR19HUlBfU1lTX05PVElDRSxjb250ZW50OnQodCh7fSxlLmVsZW1lbnRzKSx7fSx7Z3JvdXBQcm9maWxlOnQodCh7fSxlLmdyb3VwUHJvZmlsZSkse30se2dyb3VwSUQ6ZS5ncm91cElEfSl9KX06dGhpcy5fZ2V0TW9kdWxlKEtuKS5wYXJzZUVsZW1lbnRzKGUuZWxlbWVudHMsZS5mcm9tKX19LHtrZXk6XCJwYWNrQ29udmVyc2F0aW9uT3B0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PW5ldyBNYXAsbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgbz1lW25dLHM9by5jb252ZXJzYXRpb25JRDtpZih0LmhhcyhzKSl7dmFyIGE9dC5nZXQocyk7YS5sYXN0TWVzc2FnZT1vLFwiaW5cIj09PW8uZmxvdyYmYS51bnJlYWRDb3VudCsrfWVsc2UgdC5zZXQocyx7Y29udmVyc2F0aW9uSUQ6by5jb252ZXJzYXRpb25JRCx1bnJlYWRDb3VudDpcIm91dFwiPT09by5mbG93PzA6MSx0eXBlOm8uY29udmVyc2F0aW9uVHlwZSxzdWJUeXBlOm8uY29udmVyc2F0aW9uU3ViVHlwZSxsYXN0TWVzc2FnZTpvfSl9cmV0dXJuIG0odC52YWx1ZXMoKSl9fSx7a2V5OlwiX3VwZGF0ZU1lbWJlckNvdW50QnlHcm91cFRpcHNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmdyb3VwUHJvZmlsZS5ncm91cElELG49ZS5lbGVtZW50cy5vbmxpbmVNZW1iZXJJbmZvLG89dm9pZCAwPT09bj92b2lkIDA6bjtpZighenQobykpe3ZhciBzPW8ub25saW5lTWVtYmVyTnVtLGE9dm9pZCAwPT09cz8wOnMsaT1vLmV4cGlyZVRpbWUscj12b2lkIDA9PT1pP3RoaXMuREVGQVVMVF9FWFBJUkVfVElNRTppLHU9dGhpcy5fb25saW5lTWVtYmVyQ291bnRNYXAuZ2V0KHQpfHx7fSxjPURhdGUubm93KCk7enQodSk/T2JqZWN0LmFzc2lnbih1LHtsYXN0UmVxVGltZTowLGxhc3RTeW5jVGltZTowLGxhdGVzdFVwZGF0ZVRpbWU6YyxtZW1iZXJDb3VudDphLGV4cGlyZVRpbWU6cn0pOih1LmxhdGVzdFVwZGF0ZVRpbWU9Yyx1Lm1lbWJlckNvdW50PWEpLFZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fdXBkYXRlTWVtYmVyQ291bnRCeUdyb3VwVGlwcyBpbmZvOlwiKSx1KSx0aGlzLl9vbmxpbmVNZW1iZXJDb3VudE1hcC5zZXQodCx1KX19fSx7a2V5OlwiX29uQnJvYWRjYXN0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCF6dChlKSl7Zm9yKHZhciB0PVtdLG49ZS5sZW5ndGgsbz1udWxsLHM9MDtzPG47cysrKXt2YXIgYT10aGlzLnJlc3RvcmVNZXNzYWdlRnJvbVNpbXBsaWZpZWQoZVtzXSk7R2lbYS5ldmVudF0/KChvPXRoaXMucGFja01lc3NhZ2UoYSxhLmV2ZW50KSkuaXNCcm9hZGNhc3RNZXNzYWdlPSEwLHRoaXMuX2Jyb2FkY2FzdE1lc3NhZ2VJRE1hcC5oYXMoby5JRCl8fCh0LnB1c2gobyksdGhpcy5fYnJvYWRjYXN0TWVzc2FnZUlETWFwLnNldChvLklELDEpKSk6VmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vbkJyb2FkY2FzdE1lc3NhZ2UgdW5rbm93biBldmVudDpcIikuY29uY2F0KGEuZXZlbnQpKX10Lmxlbmd0aD4wJiZ0aGlzLl9ncm91cE1vZHVsZS5lbWl0T3V0ZXJFdmVudChrLk1FU1NBR0VfUkVDRUlWRUQsdCl9fX0se2tleTpcInN0YXJ0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYodGhpcy5fcG9sbGluZ0luc3RhbmNlTWFwLmhhcyhlKSl7dmFyIHQ9dGhpcy5fcG9sbGluZ0luc3RhbmNlTWFwLmdldChlKTt0LmlzUnVubmluZygpfHx0LnN0YXJ0KCl9ZWxzZXt2YXIgbj1uZXcgT2koe21hbmFnZXI6dGhpcyxncm91cElEOmUsb25Jbml0OnRoaXMuX3VwZGF0ZVJlcXVlc3REYXRhLmJpbmQodGhpcyksb25TdWNjZXNzOnRoaXMuX2hhbmRsZVN1Y2Nlc3MuYmluZCh0aGlzKSxvbkZhaWw6dGhpcy5faGFuZGxlRmFpbHVyZS5iaW5kKHRoaXMpfSk7bi5zdGFydCgpLHRoaXMuX3BvbGxpbmdJbnN0YW5jZU1hcC5zZXQoZSxuKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuc3RhcnQgZ3JvdXBJRDpcIikuY29uY2F0KGUpKX19fSx7a2V5OlwiaGFuZGxlSm9pblJlc3VsdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7cmV0dXJuIHRoaXMuX3ByZUNoZWNrKCkudGhlbigoZnVuY3Rpb24oKXt2YXIgbj1lLmxvbmdQb2xsaW5nS2V5LG89ZS5ncm91cCxzPW8uZ3JvdXBJRDtyZXR1cm4gdC5fam9pbmVkR3JvdXBNYXAuc2V0KHMsbyksdC5fZ3JvdXBNb2R1bGUudXBkYXRlR3JvdXBNYXAoW29dKSx0Ll9ncm91cE1vZHVsZS5kZWxldGVVbmpvaW5lZEFWQ2hhdFJvb20ocyksdC5fZ3JvdXBNb2R1bGUuZW1pdEdyb3VwTGlzdFVwZGF0ZSghMCwhMSksaXQobik/WGEoe3N0YXR1czpqZSxncm91cDpvfSk6UHJvbWlzZS5yZXNvbHZlKCl9KSl9fSx7a2V5Olwic3RhcnRSdW5Mb29wXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztyZXR1cm4gdGhpcy5oYW5kbGVKb2luUmVzdWx0KGUpLnRoZW4oKGZ1bmN0aW9uKCl7dmFyIG49ZS5sb25nUG9sbGluZ0tleSxvPWUuZ3JvdXAscz1lLnN0YXJ0U2VxLGE9dm9pZCAwPT09cz8wOnMsaT1vLmdyb3VwSUQ7cmV0dXJuIHQuX3BvbGxpbmdSZXF1ZXN0SW5mb01hcC5zZXQoaSx7a2V5Om4sc3RhcnRTZXE6YX0pLHQuc3RhcnQoaSksdC5fZ3JvdXBNb2R1bGUuaXNMb2dnZWRJbigpP1hhKHtzdGF0dXM6amUsZ3JvdXA6b30pOlhhKHtzdGF0dXM6amV9KX0pKX19LHtrZXk6XCJfcHJlQ2hlY2tcIix2YWx1ZTpmdW5jdGlvbigpe2lmKHRoaXMuX2dldE1vZHVsZSh4bikuaXNVbmxpbWl0ZWRBVkNoYXRSb29tKCkpcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO2lmKCF0aGlzLmhhc0pvaW5lZEFWQ2hhdFJvb20oKSlyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7dmFyIGU9dih0aGlzLl9qb2luZWRHcm91cE1hcC5lbnRyaWVzKCkubmV4dCgpLnZhbHVlLDIpLHQ9ZVswXSxuPWVbMV07aWYodGhpcy5fZ3JvdXBNb2R1bGUuaXNMb2dnZWRJbigpKXtpZighKG4uc2VsZkluZm8ucm9sZT09PUUuR1JQX01CUl9ST0xFX09XTkVSfHxuLm93bmVySUQ9PT10aGlzLl9ncm91cE1vZHVsZS5nZXRNeVVzZXJJRCgpKSlyZXR1cm4gdGhpcy5fZ3JvdXBNb2R1bGUucXVpdEdyb3VwKHQpO3RoaXMuX2dyb3VwTW9kdWxlLmRlbGV0ZUxvY2FsR3JvdXBBbmRDb252ZXJzYXRpb24odCl9ZWxzZSB0aGlzLl9ncm91cE1vZHVsZS5kZWxldGVMb2NhbEdyb3VwQW5kQ29udmVyc2F0aW9uKHQpO3JldHVybiB0aGlzLnJlc2V0KHQpLFByb21pc2UucmVzb2x2ZSgpfX0se2tleTpcImpvaW5XaXRob3V0QXV0aFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLmdyb3VwSUQsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJqb2luV2l0aG91dEF1dGhcIikscz1uZXcgQWEoXCJqb2luV2l0aG91dEF1dGhcIik7cmV0dXJuIHRoaXMuX2dyb3VwTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTokbyxyZXF1ZXN0RGF0YTplfSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIGE9ZS5kYXRhLmxvbmdQb2xsaW5nS2V5O2lmKHQuX2dyb3VwTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PXYoZSwyKTt0WzBdO3ZhciBvPXRbMV07cy5zZXROZXR3b3JrVHlwZShvKS5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQobixcIiBsb25nUG9sbGluZ0tleTpcIikuY29uY2F0KGEpKS5lbmQoITApfSkpLGl0KGEpKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfSk9JTl9OT05fQVZDSEFUUk9PTV9XSVRIT1VUX0xPR0lOfSk7VmUubChcIlwiLmNvbmNhdChvLFwiIG9rLiBncm91cElEOlwiKS5jb25jYXQobikpLHQuX2dldE1vZHVsZShxbikuc2V0Q29tcGxldGVkKFwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KG4pKTt2YXIgaT1uZXcgaGkoe2dyb3VwSUQ6bn0pO3JldHVybiB0LnN0YXJ0UnVuTG9vcCh7Z3JvdXA6aSxsb25nUG9sbGluZ0tleTphfSksWWEoe3N0YXR1czpqZX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gVmUuZShcIlwiLmNvbmNhdChvLFwiIGZhaWxlZC4gZ3JvdXBJRDpcIikuY29uY2F0KG4sXCIgZXJyb3I6XCIpLGUpLHQuX2dyb3VwTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBvPXYodCwyKSxhPW9bMF0saT1vWzFdO3Muc2V0RXJyb3IoZSxhLGkpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChuKSkuZW5kKCEwKX0pKSxaYShlKX0pKS5maW5hbGx5KChmdW5jdGlvbigpe3QuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShCbikucmVwb3J0QXRPbmNlKCl9KSl9fSx7a2V5OlwiZ2V0R3JvdXBPbmxpbmVNZW1iZXJDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX29ubGluZU1lbWJlckNvdW50TWFwLmdldChlKXx8e30sbj1EYXRlLm5vdygpO3JldHVybiB6dCh0KXx8bi10Lmxhc3RTeW5jVGltZT4xZTMqdC5leHBpcmVUaW1lJiZuLXQubGF0ZXN0VXBkYXRlVGltZT4xZTQmJm4tdC5sYXN0UmVxVGltZT4zZTM/KHQubGFzdFJlcVRpbWU9bix0aGlzLl9vbmxpbmVNZW1iZXJDb3VudE1hcC5zZXQoZSx0KSx0aGlzLl9nZXRHcm91cE9ubGluZU1lbWJlckNvdW50KGUpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBZYSh7bWVtYmVyQ291bnQ6ZS5tZW1iZXJDb3VudH0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gWmEoZSl9KSkpOlhhKHttZW1iZXJDb3VudDp0Lm1lbWJlckNvdW50fSl9fSx7a2V5OlwiX2dldEdyb3VwT25saW5lTWVtYmVyQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX2dldEdyb3VwT25saW5lTWVtYmVyQ291bnRcIik7cmV0dXJuIHRoaXMuX2dyb3VwTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTptcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDplfX0pLnRoZW4oKGZ1bmN0aW9uKG8pe3ZhciBzPXQuX29ubGluZU1lbWJlckNvdW50TWFwLmdldChlKXx8e30sYT1vLmRhdGEsaT1hLm9ubGluZU1lbWJlck51bSxyPXZvaWQgMD09PWk/MDppLHU9YS5leHBpcmVUaW1lLGM9dm9pZCAwPT09dT90LkRFRkFVTFRfRVhQSVJFX1RJTUU6dTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIGdyb3VwSUQ6XCIpLmNvbmNhdChlLFwiIG1lbWJlckNvdW50OlwiKS5jb25jYXQocixcIiBleHBpcmVUaW1lOlwiKS5jb25jYXQoYykpO3ZhciBsPURhdGUubm93KCk7cmV0dXJuIHp0KHMpJiYocy5sYXN0UmVxVGltZT1sKSx0Ll9vbmxpbmVNZW1iZXJDb3VudE1hcC5zZXQoZSxPYmplY3QuYXNzaWduKHMse2xhc3RTeW5jVGltZTpsLGxhdGVzdFVwZGF0ZVRpbWU6bCxtZW1iZXJDb3VudDpyLGV4cGlyZVRpbWU6Y30pKSx7bWVtYmVyQ291bnQ6cn19KSkuY2F0Y2goKGZ1bmN0aW9uKG8pe3JldHVybiBWZS53KFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksbyksbmV3IEFhKFwiX2dldEdyb3VwT25saW5lTWVtYmVyQ291bnRcIikuc2V0Q29kZShvLmNvZGUpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChlLFwiIGVycm9yOlwiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkobykpKS5zZXROZXR3b3JrVHlwZSh0Ll9ncm91cE1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxQcm9taXNlLnJlamVjdChvKX0pKX19LHtrZXk6XCJfZ2V0TW9kdWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShlKX19LHtrZXk6XCJzZXRQb2xsaW5nSW50ZXJ2YWxcIix2YWx1ZTpmdW5jdGlvbihlKXtpdChlKXx8KGV0KGUpP3RoaXMuX3BvbGxpbmdJbnRlcnZhbD10aGlzLkRFRkFVTFRfUE9MTElOR19JTlRFUlZBTD1lOnRoaXMuX3BvbGxpbmdJbnRlcnZhbD10aGlzLkRFRkFVTFRfUE9MTElOR19JTlRFUlZBTD1wYXJzZUludChlLDEwKSl9fSx7a2V5Olwic2V0UG9sbGluZ0ludGVydmFsUGx1c1wiLHZhbHVlOmZ1bmN0aW9uKGUpe2l0KGUpfHwoZXQoZSk/dGhpcy5ERUZBVUxUX1BPTExJTkdfSU5URVJWQUxfUExVUz1lOnRoaXMuREVGQVVMVF9QT0xMSU5HX0lOVEVSVkFMX1BMVVM9cGFyc2VJbnQoZSwxMCkpfX0se2tleTpcInNldFBvbGxpbmdOb01lc3NhZ2VDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2l0KGUpfHwoZXQoZSk/dGhpcy5ERUZBVUxUX1BPTExJTkdfTk9fTUVTU0FHRV9DT1VOVD1lOnRoaXMuREVGQVVMVF9QT0xMSU5HX05PX01FU1NBR0VfQ09VTlQ9cGFyc2VJbnQoZSwxMCkpfX0se2tleTpcInNldFBvbGxpbmdTaW1wbGlmaWVkTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2l0KGUpfHxcIjBcIiE9PWUmJlwiMVwiIT09ZXx8KHRoaXMuREVGQVVMVF9QT0xMSU5HX1NJTVBMSUZJRURfTVNHPXBhcnNlSW50KGUsMTApKX19LHtrZXk6XCJnZXRQb2xsaW5nSW50ZXJ2YWxcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb2xsaW5nSW50ZXJ2YWx9fSx7a2V5Olwib25BVkNoYXRSb29tTWVtYmVyQmFubmVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXlsb2FkLmdyb3VwUHJvZmlsZS5ncm91cElEO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkFWQ2hhdFJvb21NZW1iZXJCYW5uZWQgZ3JvdXBJRDpcIikuY29uY2F0KHQpKSx0aGlzLl9ncm91cE1vZHVsZS5kZWxldGVMb2NhbEdyb3VwQW5kQ29udmVyc2F0aW9uKHQpLHRoaXMucmVzZXQodCl9fSx7a2V5OlwicmVzdGFydFBvbGxpbmdcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXN0YXJ0UG9sbGluZyBjb3VudDpcIikuY29uY2F0KHRoaXMuX3BvbGxpbmdJbnN0YW5jZU1hcC5zaXplKSk7dmFyIGUsdD1EKHRoaXMuX3BvbGxpbmdJbnN0YW5jZU1hcC52YWx1ZXMoKSk7dHJ5e2Zvcih0LnMoKTshKGU9dC5uKCkpLmRvbmU7KXt2YXIgbj1lLnZhbHVlO24uc3RvcCgpLG4uc3RhcnQoKX19Y2F0Y2gobyl7dC5lKG8pfWZpbmFsbHl7dC5mKCl9fX0se2tleTpcImdldFBvbGxpbmdUaW1lcklEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoIXRoaXMuX3BvbGxpbmdJbnN0YW5jZU1hcC5oYXMoZSkpcmV0dXJuLTE7dmFyIHQ9dGhpcy5fcG9sbGluZ0luc3RhbmNlTWFwLmdldChlKS5nZXRQb2xsaW5nVGltZXJJRCgpO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuZ2V0UG9sbGluZ1RpbWVySUQgZ3JvdXBJRDpcIikuY29uY2F0KGUsXCIgdGltZXJJRDpcIikuY29uY2F0KHQpKSx0fX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoZSl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0IGdyb3VwSUQ6XCIpLmNvbmNhdChlKSk7dmFyIHQ9dGhpcy5fcG9sbGluZ0luc3RhbmNlTWFwLmdldChlKTt0JiZ0LnN0b3AoKSx0aGlzLl9wb2xsaW5nSW5zdGFuY2VNYXAuZGVsZXRlKGUpLHRoaXMuX2pvaW5lZEdyb3VwTWFwLmRlbGV0ZShlKSx0aGlzLl9wb2xsaW5nUmVxdWVzdEluZm9NYXAuZGVsZXRlKGUpLHRoaXMuX29ubGluZU1lbWJlckNvdW50TWFwLmRlbGV0ZShlKX1lbHNle1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldCBhbGxcIikpO3ZhciBuLG89RCh0aGlzLl9wb2xsaW5nSW5zdGFuY2VNYXAudmFsdWVzKCkpO3RyeXtmb3Ioby5zKCk7IShuPW8ubigpKS5kb25lOyl7bi52YWx1ZS5zdG9wKCl9fWNhdGNoKHMpe28uZShzKX1maW5hbGx5e28uZigpfXRoaXMuX3BvbGxpbmdJbnN0YW5jZU1hcC5jbGVhcigpLHRoaXMuX2pvaW5lZEdyb3VwTWFwLmNsZWFyKCksdGhpcy5fcG9sbGluZ1JlcXVlc3RJbmZvTWFwLmNsZWFyKCksdGhpcy5fb25saW5lTWVtYmVyQ291bnRNYXAuY2xlYXIoKSx0aGlzLl9icm9hZGNhc3RNZXNzYWdlSURNYXAuY2xlYXIoKX10aGlzLnNlcXVlbmNlc0xpbmtlZExpc3QucmVzZXQoKSx0aGlzLm1lc3NhZ2VJRExpbmtlZExpc3QucmVzZXQoKSx0aGlzLnJlY2VpdmVkTWVzc2FnZUNvdW50PTAsdGhpcy5fcmVwb3J0TWVzc2FnZVN0YWNrZWRDb3VudD0wLHRoaXMuX3BvbGxpbmdJbnRlcnZhbD10aGlzLkRFRkFVTFRfUE9MTElOR19JTlRFUlZBTD0zMDAsdGhpcy5ERUZBVUxUX1BPTExJTkdfTk9fTUVTU0FHRV9DT1VOVD0yMCx0aGlzLkRFRkFVTFRfUE9MTElOR19JTlRFUlZBTF9QTFVTPTJlMyx0aGlzLl9wb2xsaW5nTm9NZXNzYWdlQ291bnQ9MH19XSksZX0oKSxQaT0xLGJpPTE1LHdpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fZ3JvdXBNb2R1bGU9dCx0aGlzLl9uPVwiR3JvdXBTeXN0ZW1Ob3RpY2VIYW5kbGVyXCIsdGhpcy5wZW5kZW5jeU1hcD1uZXcgTWFwfXJldHVybiBhKGUsW3trZXk6XCJvbk5ld0dyb3VwU3lzdGVtTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5kYXRhTGlzdCxuPWUuaXNTeW5jaW5nRW5kZWQsbz1lLmlzSW5zdGFudE1lc3NhZ2U7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uUmVjZWl2ZVN5c3RlbU5vdGljZSBjb3VudDpcIikuY29uY2F0KHQubGVuZ3RoKSk7dmFyIHM9dGhpcy5uZXdTeXN0ZW1Ob3RpY2VTdG9yZWRBbmRTdW1tYXJ5KHtub3RpZmllc0xpc3Q6dCxpc0luc3RhbnRNZXNzYWdlOm99KSxhPXMuZXZlbnREYXRhTGlzdCxpPXMucmVzdWx0O2EubGVuZ3RoPjAmJih0aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUocW4pLm9uTmV3TWVzc2FnZSh7Y29udmVyc2F0aW9uT3B0aW9uc0xpc3Q6YSxpc0luc3RhbnRNZXNzYWdlOm99KSx0aGlzLl9vblJlY2VpdmVkR3JvdXBTeXN0ZW1Ob3RpY2Uoe3Jlc3VsdDppLGlzSW5zdGFudE1lc3NhZ2U6b30pKTtvP2kubGVuZ3RoPjAmJnRoaXMuX2dyb3VwTW9kdWxlLmVtaXRPdXRlckV2ZW50KGsuTUVTU0FHRV9SRUNFSVZFRCxpKTohMD09PW4mJnRoaXMuX2NsZWFyR3JvdXBTeXN0ZW1Ob3RpY2UoKX19LHtrZXk6XCJuZXdTeXN0ZW1Ob3RpY2VTdG9yZWRBbmRTdW1tYXJ5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIG49ZS5ub3RpZmllc0xpc3Qsbz1lLmlzSW5zdGFudE1lc3NhZ2Uscz1udWxsLGE9bi5sZW5ndGgsaT0wLHI9W10sdT17Y29udmVyc2F0aW9uSUQ6RS5DT05WX1NZU1RFTSx1bnJlYWRDb3VudDowLHR5cGU6RS5DT05WX1NZU1RFTSxzdWJUeXBlOm51bGwsbGFzdE1lc3NhZ2U6bnVsbH07Zm9yKGk9MDtpPGE7aSsrKXt2YXIgYz1uW2ldLGw9Yy5ncm91cFByb2ZpbGUsZD1sLmNvbW11bml0eVR5cGUscD12b2lkIDA9PT1kPzA6ZCxnPWwudG9waWNJRCxoPXZvaWQgMD09PWc/dm9pZCAwOmcsXz1jLmVsZW1lbnRzLGY9Xy50b3BpY0lETGlzdCx2PXZvaWQgMD09PWY/dm9pZCAwOmYsbT1fLm9wZXJhdGlvblR5cGU7aWYoISgyIT09cHx8enQoaCkmJnp0KHYpKSl7aWYoWzE3LDE4LDIwXS5pbmNsdWRlcyhtKSl7dGhpcy5faGFuZGxlVG9waWNTeXN0ZW1Ob3RpY2UoYyk7Y29udGludWV9enQoaCl8fChjLnRvPWgpfWlmKGMuZWxlbWVudHMub3BlcmF0aW9uVHlwZSE9PWJpKWMuY3VycmVudFVzZXI9dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TXlVc2VySUQoKSxjLmNvbnZlcnNhdGlvblR5cGU9RS5DT05WX1NZU1RFTSxjLmNvbnZlcnNhdGlvbklEPUUuQ09OVl9TWVNURU0sKHM9bmV3IFdhKGMpKS5zZXRFbGVtZW50KHt0eXBlOkUuTVNHX0dSUF9TWVNfTk9USUNFLGNvbnRlbnQ6dCh0KHt9LGMuZWxlbWVudHMpLHt9LHtncm91cFByb2ZpbGU6dCh7fSxjLmdyb3VwUHJvZmlsZSl9KX0pLHMuaXNTeXN0ZW1NZXNzYWdlPSEwLCgxPT09cy5zZXF1ZW5jZSYmMT09PXMucmFuZG9tfHwyPT09cy5zZXF1ZW5jZSYmMj09PXMucmFuZG9tKSYmKHMuc2VxdWVuY2U9X3QoKSxzLnJhbmRvbT1fdCgpLHMuZ2VuZXJhdGVNZXNzYWdlSUQoKSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIubmV3U3lzdGVtTm90aWNlU3RvcmVkQW5kU3VtbWFyeSBzZXF1ZW5jZSBhbmQgcmFuZG9tIG1heWJlIGR1cGxpY2F0ZWQsIHJlZ2VuZXJhdGUuIElEOlwiKS5jb25jYXQocy5JRCkpKSx0aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUocW4pLnB1c2hJbnRvTm90aWNlUmVzdWx0KHIscykmJihvP3UudW5yZWFkQ291bnQrKzpzLnNldElzUmVhZCghMCksdS5zdWJUeXBlPXMuY29udmVyc2F0aW9uU3ViVHlwZSl9cmV0dXJuIHUubGFzdE1lc3NhZ2U9cltyLmxlbmd0aC0xXSx7ZXZlbnREYXRhTGlzdDpyLmxlbmd0aD4wP1t1XTpbXSxyZXN1bHQ6cn19fSx7a2V5OlwiX2NsZWFyR3JvdXBTeXN0ZW1Ob3RpY2VcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5fZ2V0UGVuZGVuY3lMaXN0KCkudGhlbigoZnVuY3Rpb24odCl7dC5mb3JFYWNoKChmdW5jdGlvbih0KXtlLnBlbmRlbmN5TWFwLnNldChcIlwiLmNvbmNhdCh0LmZyb20sXCJfXCIpLmNvbmNhdCh0Lmdyb3VwSUQsXCJfXCIpLmNvbmNhdCh0LnRvKSx0KX0pKTt2YXIgbj1lLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUocW4pLmdldExvY2FsTWVzc2FnZUxpc3QoRS5DT05WX1NZU1RFTSksbz1bXTtuLmZvckVhY2goKGZ1bmN0aW9uKHQpe3ZhciBuPXQucGF5bG9hZCxzPW4ub3BlcmF0b3JJRCxhPW4ub3BlcmF0aW9uVHlwZSxpPW4uZ3JvdXBQcm9maWxlO2lmKGE9PT1QaSl7dmFyIHI9XCJcIi5jb25jYXQocyxcIl9cIikuY29uY2F0KGkuZ3JvdXBJRCxcIl9cIikuY29uY2F0KGkudG8pLHU9ZS5wZW5kZW5jeU1hcC5nZXQocik7dSYmZXQodS5oYW5kbGVkKSYmMCE9PXUuaGFuZGxlZCYmby5wdXNoKHQpfX0pKSxlLmRlbGV0ZUdyb3VwU3lzdGVtTm90aWNlKHttZXNzYWdlTGlzdDpvfSl9KSl9fSx7a2V5OlwiZGVsZXRlR3JvdXBTeXN0ZW1Ob3RpY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5kZWxldGVHcm91cFN5c3RlbU5vdGljZVwiKTtyZXR1cm4gYXQoZS5tZXNzYWdlTGlzdCkmJjAhPT1lLm1lc3NhZ2VMaXN0Lmxlbmd0aD8oVmUubChcIlwiLmNvbmNhdChuLFwiIFwiKStlLm1lc3NhZ2VMaXN0Lm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUuSUR9KSkpLHRoaXMuX2dyb3VwTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpfcyxyZXF1ZXN0RGF0YTp7bWVzc2FnZUxpc3RUb0RlbGV0ZTplLm1lc3NhZ2VMaXN0Lm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJue2Zyb206RS5DT05WX1NZU1RFTSxtZXNzYWdlU2VxOmUuY2xpZW50U2VxdWVuY2UsbWVzc2FnZVJhbmRvbTplLnJhbmRvbX19KSl9fSkudGhlbigoZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpO3ZhciBvPXQuX2dyb3VwTW9kdWxlLmdldE1vZHVsZShxbik7cmV0dXJuIGUubWVzc2FnZUxpc3QuZm9yRWFjaCgoZnVuY3Rpb24oZSl7by5kZWxldGVMb2NhbE1lc3NhZ2UoZSl9KSksWWEoKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIFZlLmUoXCJcIi5jb25jYXQobixcIiBlcnJvcjpcIiksZSksWmEoZSl9KSkpOlhhKCl9fSx7a2V5OlwiX2dldFBlbmRlbmN5TGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fSxuPXQudHlwZSxvPXZvaWQgMD09PW4/dm9pZCAwOm4scz10LnN0YXJ0VGltZSxhPXZvaWQgMD09PXM/MDpzLGk9dC5saW1pdCxyPXZvaWQgMD09PWk/MjA6aTtyZXR1cm4gdGhpcy5fZ3JvdXBNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmhzLHJlcXVlc3REYXRhOnt0eXBlOm8sc3RhcnRUaW1lOmEsbGltaXQ6cixoYW5kbGVBY2NvdW50OnRoaXMuX2dyb3VwTW9kdWxlLmdldE15VXNlcklEKCl9fSkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dC5kYXRhLnBlbmRlbmN5TGlzdDtyZXR1cm4gMCE9PXQuZGF0YS5uZXh0U3RhcnRUaW1lP2UuX2dldFBlbmRlbmN5TGlzdCh7c3RhcnRUaW1lOnQuZGF0YS5uZXh0U3RhcnRUaW1lfSkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuW10uY29uY2F0KG0obiksbShlKSl9KSk6bn0pKX19LHtrZXk6XCJnZXRHcm91cEFwcGxpY2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5fZ2V0UGVuZGVuY3lMaXN0KCkudGhlbigoZnVuY3Rpb24odCl7cmV0dXJuIGUuX2dldFBlbmRlbmN5TGlzdCh7dHlwZTpFLkdSUF9DT01NVU5JVFl9KS50aGVuKChmdW5jdGlvbihuKXtyZXR1cm4gdC5wdXNoLmFwcGx5KHQsbShuKSksZS5faGFuZGxlUGVuZGVuY3lSZXN1bHQodCl9KSkuY2F0Y2goKGZ1bmN0aW9uKG4pe3JldHVybiBlLl9oYW5kbGVQZW5kZW5jeVJlc3VsdCh0KX0pKX0pKX19LHtrZXk6XCJfaGFuZGxlUGVuZGVuY3lSZXN1bHRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49W107cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dC5wZW5kZW5jeU1hcC5zZXQoXCJcIi5jb25jYXQoZS5mcm9tLFwiX1wiKS5jb25jYXQoZS5ncm91cElELFwiX1wiKS5jb25jYXQoZS50byksZSksMD09PWUuaGFuZGxlZCYmbi5wdXNoKHthcHBsaWNhbnQ6ZS5mcm9tLGFwcGxpY2FudE5pY2s6ZS5mcm9tVXNlck5pY2tOYW1lLGdyb3VwTmFtZTplLmdyb3VwTmFtZSxncm91cElEOmUuZ3JvdXBJRCxhdXRoZW50aWNhdGlvbjplLmF1dGhlbnRpY2F0aW9uLG1lc3NhZ2VLZXk6ZS50aW1lLGFwcGxpY2F0aW9uVHlwZTplLmFwcGxpY2F0aW9uVHlwZSx1c2VySUQ6ZS51c2VySUR9KX0pKSxYYSh7YXBwbGljYXRpb25MaXN0Om59KX19LHtrZXk6XCJfb25SZWNlaXZlZEdyb3VwU3lzdGVtTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUucmVzdWx0O2UuaXNJbnN0YW50TWVzc2FnZSYmbi5mb3JFYWNoKChmdW5jdGlvbihlKXtzd2l0Y2goZS5wYXlsb2FkLm9wZXJhdGlvblR5cGUpe2Nhc2UgMTpicmVhaztjYXNlIDI6dC5fb25BcHBseUdyb3VwUmVxdWVzdEFncmVlZChlKTticmVhaztjYXNlIDM6YnJlYWs7Y2FzZSA0OnQuX29uTWVtYmVyS2lja2VkKGUpO2JyZWFrO2Nhc2UgNTp0Ll9vbkdyb3VwRGlzbWlzc2VkKGUpO2JyZWFrO2Nhc2UgNjpicmVhaztjYXNlIDc6dC5fb25JbnZpdGVHcm91cChlKTticmVhaztjYXNlIDg6dC5fb25RdWl0R3JvdXAoZSk7YnJlYWs7Y2FzZSA5OnQuX29uU2V0TWFuYWdlcihlKTticmVhaztjYXNlIDEwOnQuX29uRGVsZXRlTWFuYWdlcihlKTticmVhaztjYXNlIDExOmNhc2UgMTI6Y2FzZSAxNTpicmVhaztjYXNlIDIwOnQuX29uTWVzc2FnZVJlbWluZFR5cGVTeW5jZWQoZSk7YnJlYWs7Y2FzZSAyMTp0Ll9ncm91cE1vZHVsZS5vbkFWQ2hhdFJvb21NZW1iZXJCYW5uZWQoZSl9fSkpfX0se2tleTpcIl9vbkFwcGx5R3JvdXBSZXF1ZXN0QWdyZWVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUucGF5bG9hZC5ncm91cFByb2ZpbGUuZ3JvdXBJRDt0aGlzLl9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKG4pfHx0aGlzLl9ncm91cE1vZHVsZS5nZXRHcm91cFByb2ZpbGUoe2dyb3VwSUQ6bn0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBuPWUuZGF0YS5ncm91cDtpZihuKXt0Ll9ncm91cE1vZHVsZS51cGRhdGVHcm91cE1hcChbbl0pO3ZhciBvPSFuLmlzU3VwcG9ydFRvcGljO3QuX2dyb3VwTW9kdWxlLmVtaXRHcm91cExpc3RVcGRhdGUoITAsbyl9fSkpfX0se2tleTpcIl9vbk1lbWJlcktpY2tlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGF5bG9hZC5ncm91cFByb2ZpbGUuZ3JvdXBJRDt0aGlzLl9ncm91cE1vZHVsZS5oYXNMb2NhbEdyb3VwKHQpJiZ0aGlzLl9ncm91cE1vZHVsZS5kZWxldGVMb2NhbEdyb3VwQW5kQ29udmVyc2F0aW9uKHQpfX0se2tleTpcIl9vbkdyb3VwRGlzbWlzc2VkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXlsb2FkLmdyb3VwUHJvZmlsZS5ncm91cElEO3RoaXMuX2dyb3VwTW9kdWxlLmhhc0xvY2FsR3JvdXAodCkmJnRoaXMuX2dyb3VwTW9kdWxlLmRlbGV0ZUxvY2FsR3JvdXBBbmRDb252ZXJzYXRpb24odCk7dmFyIG49dGhpcy5fZ3JvdXBNb2R1bGUuX0FWQ2hhdFJvb21IYW5kbGVyO24mJm4uY2hlY2tKb2luZWRBVkNoYXRSb29tQnlJRCh0KSYmbi5yZXNldCh0KX19LHtrZXk6XCJfb25JbnZpdGVHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLnBheWxvYWQuZ3JvdXBQcm9maWxlLmdyb3VwSUQ7dGhpcy5fZ3JvdXBNb2R1bGUuaGFzTG9jYWxHcm91cChuKXx8dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0R3JvdXBQcm9maWxlKHtncm91cElEOm59KS50aGVuKChmdW5jdGlvbihlKXt2YXIgbj1lLmRhdGEuZ3JvdXA7biYmKHQuX2dyb3VwTW9kdWxlLnVwZGF0ZUdyb3VwTWFwKFtuXSksdC5fZ3JvdXBNb2R1bGUuZW1pdEdyb3VwTGlzdFVwZGF0ZSgpKX0pKX19LHtrZXk6XCJfb25RdWl0R3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnBheWxvYWQuZ3JvdXBQcm9maWxlLmdyb3VwSUQ7dGhpcy5fZ3JvdXBNb2R1bGUuaGFzTG9jYWxHcm91cCh0KSYmdGhpcy5fZ3JvdXBNb2R1bGUuZGVsZXRlTG9jYWxHcm91cEFuZENvbnZlcnNhdGlvbih0KX19LHtrZXk6XCJfb25TZXRNYW5hZ2VyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXlsb2FkLmdyb3VwUHJvZmlsZSxuPXQudG8sbz10Lmdyb3VwSUQscz10aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUod24pLmdldExvY2FsR3JvdXBNZW1iZXJJbmZvKG8sbik7cyYmcy51cGRhdGVSb2xlKEUuR1JQX01CUl9ST0xFX0FETUlOKX19LHtrZXk6XCJfb25EZWxldGVNYW5hZ2VyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXlsb2FkLmdyb3VwUHJvZmlsZSxuPXQudG8sbz10Lmdyb3VwSUQscz10aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUod24pLmdldExvY2FsR3JvdXBNZW1iZXJJbmZvKG8sbik7cyYmcy51cGRhdGVSb2xlKEUuR1JQX01CUl9ST0xFX01FTUJFUil9fSx7a2V5OlwiX29uTWVzc2FnZVJlbWluZFR5cGVTeW5jZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnBheWxvYWQuZ3JvdXBQcm9maWxlLmdyb3VwSUQsbj1lLnBheWxvYWQubWVzc2FnZVJlbWluZFR5cGU7dGhpcy5fZ3JvdXBNb2R1bGUuZ2V0TW9kdWxlKHFuKS5vbkdyb3VwTWVzc2FnZVJlbWluZFR5cGVTeW5jZWQoe2dyb3VwSUQ6dCxtZXNzYWdlUmVtaW5kVHlwZTpufSl9fSx7a2V5OlwiX2hhbmRsZVRvcGljU3lzdGVtTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cFByb2ZpbGUsbj10Lmdyb3VwSUQsbz10LnRvcGljSUQscz1lLmVsZW1lbnRzLGE9cy5vcGVyYXRpb25UeXBlLGk9cy50b3BpY0lETGlzdCxyPXMubWVzc2FnZVJlbWluZFR5cGUsdT10aGlzLl9ncm91cE1vZHVsZS5nZXRNb2R1bGUoRm4pOzE3PT09YT91Lm9uVG9waWNDcmVhdGVkKHtncm91cElEOm4sdG9waWNJRDpvfSk6MTg9PT1hP3Uub25Ub3BpY0RlbGV0ZWQoe2dyb3VwSUQ6bix0b3BpY0lETGlzdDppfSk6MjA9PT1hJiZ1Lm9uVG9waWNNZXNzYWdlUmVtaW5kVHlwZVVwZGF0ZWQoe2dyb3VwSUQ6bix0b3BpY0lEOm8sbWVzc2FnZVJlbWluZFR5cGU6cn0pfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnBlbmRlbmN5TWFwLmNsZWFyKCl9fV0pLGV9KCksRmk9W1wicmVsYXlGbGFnXCJdLHFpPWZ1bmN0aW9uKGUpe3IocyxlKTt2YXIgbj1mKHMpO2Z1bmN0aW9uIHMoZSl7dmFyIHQ7cmV0dXJuIG8odGhpcyxzKSwodD1uLmNhbGwodGhpcyxlKSkuX249XCJHcm91cE1vZHVsZVwiLHQuX2NvbW1vbkdyb3VwSGFuZGxlcj1udWxsLHQuX0FWQ2hhdFJvb21IYW5kbGVyPW51bGwsdC5fZ3JvdXBTeXN0ZW1Ob3RpY2VIYW5kbGVyPW51bGwsdC5fY29tbW9uR3JvdXBIYW5kbGVyPW5ldyBJaShoKHQpKSx0Ll9ncm91cEF0dHJpYnV0ZXNIYW5kbGVyPW5ldyBTaShoKHQpKSx0Ll9ncm91cENvdW50ZXJzSGFuZGxlcj1uZXcgTmkoaCh0KSksdC5fQVZDaGF0Um9vbUhhbmRsZXI9bmV3IFVpKGgodCkpLHQuX2dyb3VwVGlwc0hhbmRsZXI9bmV3IHlpKGgodCkpLHQuX2dyb3VwU3lzdGVtTm90aWNlSGFuZGxlcj1uZXcgd2koaCh0KSksdC5ncm91cE1hcD1uZXcgTWFwLHQuX3Vuam9pbmVkQVZDaGF0Um9vbUxpc3Q9bmV3IE1hcCx0Ll9yZWNlaXB0RGV0YWlsQ29tcGxldGVNYXA9bmV3IE1hcCx0LmdldElubmVyRW1pdHRlckluc3RhbmNlKCkub24odGksdC5fb25DbG91ZENvbmZpZ1VwZGF0ZWQsaCh0KSksdH1yZXR1cm4gYShzLFt7a2V5OlwiX29uQ2xvdWRDb25maWdVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldENsb3VkQ29uZmlnKFwicG9sbGluZ19pbnRlcnZhbFwiKSx0PXRoaXMuZ2V0Q2xvdWRDb25maWcoXCJwb2xsaW5nX2ludGVydmFsX3BsdXNcIiksbj10aGlzLmdldENsb3VkQ29uZmlnKFwicG9sbGluZ19ub19tc2dfY291bnRcIiksbz10aGlzLmdldENsb3VkQ29uZmlnKFwicG9sbGluZ19zaW1wbGlmaWVkX21zZ1wiKTt0aGlzLl9BVkNoYXRSb29tSGFuZGxlciYmKFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fb25DbG91ZENvbmZpZ1VwZGF0ZWQgcG9sbGluZ0ludGVydmFsOlwiKS5jb25jYXQoZSkrXCIgcG9sbGluZ0ludGVydmFsUGx1czpcIi5jb25jYXQodCxcIiBwb2xsaW5nTm9NZXNzYWdlQ291bnQ6XCIpLmNvbmNhdChuKStcIiBwb2xsaW5nU2ltcGxpZmllZE1lc3NhZ2U6XCIuY29uY2F0KG8pKSx0aGlzLl9BVkNoYXRSb29tSGFuZGxlci5zZXRQb2xsaW5nSW50ZXJ2YWwoZSksdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIuc2V0UG9sbGluZ0ludGVydmFsUGx1cyh0KSx0aGlzLl9BVkNoYXRSb29tSGFuZGxlci5zZXRQb2xsaW5nTm9NZXNzYWdlQ291bnQobiksdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIuc2V0UG9sbGluZ1NpbXBsaWZpZWRNZXNzYWdlKG8pKX19LHtrZXk6XCJvbkNoZWNrVGltZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmlzTG9nZ2VkSW4oKSYmKHRoaXMuX2NvbW1vbkdyb3VwSGFuZGxlci5vbkNoZWNrVGltZXIoZSksdGhpcy5fZ3JvdXBUaXBzSGFuZGxlci5vbkNoZWNrVGltZXIoZSkpfX0se2tleTpcImd1YXJkRm9yQVZDaGF0Um9vbVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoZS5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0dST1VQKXt2YXIgbj1rdChlLnRvKT94dChlLnRvKTplLnRvO3JldHVybiB0aGlzLmhhc0xvY2FsR3JvdXAobik/WGEoKTp0aGlzLmdldEdyb3VwUHJvZmlsZSh7Z3JvdXBJRDpufSkudGhlbigoZnVuY3Rpb24obyl7dmFyIHM9by5kYXRhLmdyb3VwLnR5cGU7aWYoVmUubChcIlwiLmNvbmNhdCh0Ll9uLFwiLmd1YXJkRm9yQVZDaGF0Um9vbS4gZ3JvdXBJRDpcIikuY29uY2F0KG4sXCIgdHlwZTpcIikuY29uY2F0KHMpKSxzPT09RS5HUlBfQVZDSEFUUk9PTSl7dmFyIGE9aGEuTUVTU0FHRV9TRU5EX0ZBSUxfTk9UX0lOX0FWQ0hBVFJPT007cmV0dXJuIFphKG5ldyBqYSh7Y29kZTphLG1lc3NhZ2U6dC5nZXRFcnJvck1lc3NhZ2UoYSxlLmZyb20sbiksZGF0YTp7bWVzc2FnZTplfX0pKX1yZXR1cm4gWGEoKX0pKX1yZXR1cm4gWGEoKX19LHtrZXk6XCJjaGVja0pvaW5lZEFWQ2hhdFJvb21CeUlEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuISF0aGlzLl9BVkNoYXRSb29tSGFuZGxlciYmdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIuY2hlY2tKb2luZWRBVkNoYXRSb29tQnlJRChlKX19LHtrZXk6XCJvbk5ld0dyb3VwTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NvbW1vbkdyb3VwSGFuZGxlciYmdGhpcy5fY29tbW9uR3JvdXBIYW5kbGVyLm9uTmV3R3JvdXBNZXNzYWdlKGUpfX0se2tleTpcInVwZGF0ZU5leHRNZXNzYWdlU2VxXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZihhdChlKSl7dmFyIG49dGhpcy5nZXRNb2R1bGUoRm4pO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG89ZS5jb252ZXJzYXRpb25JRC5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKTtrdChvKSYmbi51cGRhdGVMYXN0TWVzc2FnZShvLGUubGFzdE1lc3NhZ2UpLHQuZ3JvdXBNYXAuaGFzKG8pJiYodC5ncm91cE1hcC5nZXQobykubmV4dE1lc3NhZ2VTZXE9ZS5sYXN0TWVzc2FnZS5zZXF1ZW5jZSsxKX0pKX19fSx7a2V5Olwib25OZXdHcm91cFRpcHNcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9ncm91cFRpcHNIYW5kbGVyJiZ0aGlzLl9ncm91cFRpcHNIYW5kbGVyLm9uTmV3R3JvdXBUaXBzKGUpfX0se2tleTpcIm9uR3JvdXBNZXNzYWdlUmV2b2tlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NvbW1vbkdyb3VwSGFuZGxlciYmdGhpcy5fY29tbW9uR3JvdXBIYW5kbGVyLm9uR3JvdXBNZXNzYWdlUmV2b2tlZChlKX19LHtrZXk6XCJvbk5ld0dyb3VwU3lzdGVtTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZ3JvdXBTeXN0ZW1Ob3RpY2VIYW5kbGVyJiZ0aGlzLl9ncm91cFN5c3RlbU5vdGljZUhhbmRsZXIub25OZXdHcm91cFN5c3RlbU5vdGljZShlKX19LHtrZXk6XCJvbkdyb3VwTWVzc2FnZVJlYWROb3RpY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2UuZGF0YUxpc3QuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49ZS5lbGVtZW50cy5ncm91cE1lc3NhZ2VSZWFkTm90aWNlO2lmKCFpdChuKSl7dmFyIG89dC5nZXRNb2R1bGUocW4pO24uZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49ZS5ncm91cElELHM9ZS50b3BpY0lELGE9dm9pZCAwPT09cz92b2lkIDA6cyxpPWUubGFzdE1lc3NhZ2VTZXE7VmUuZChcIlwiLmNvbmNhdCh0Ll9uLFwiLm9uR3JvdXBNZXNzYWdlUmVhZE5vdGljZSBncm91cElEOlwiKS5jb25jYXQobixcIiBsYXN0TWVzc2FnZVNlcTpcIikuY29uY2F0KGkpKTt2YXIgcj1cIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChuKSx1PSEwO3p0KGEpfHwocj1cIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChhKSx1PSExKSxvLnVwZGF0ZUlzUmVhZEFmdGVyUmVhZFJlcG9ydCh7Y29udmVyc2F0aW9uSUQ6cixsYXN0TWVzc2FnZVNlcTppfSksby51cGRhdGVVbnJlYWRDb3VudChyLHUpLG8uY2xlYXJHcm91cEF0SW5mb0xpc3Qocix1KX0pKX19KSl9fSx7a2V5Olwib25SZWFkUmVjZWlwdExpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vblJlYWRSZWNlaXB0TGlzdCBvcHRpb25zOlwiKSxKU09OLnN0cmluZ2lmeShlKSksZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgbj1lLmdyb3VwUHJvZmlsZSxvPWUuZWxlbWVudHMscz1uLmdyb3VwSUQsYT10LmdldE1vZHVsZShxbiksaT1vLnJlYWRSZWNlaXB0TGlzdDthLnVwZGF0ZVJlYWRSZWNlaXB0SW5mbyh7Z3JvdXBJRDpzLHJlYWRSZWNlaXB0TGlzdDppfSl9KSl9fSx7a2V5Olwib25Hcm91cE1lc3NhZ2VNb2RpZmllZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkdyb3VwTWVzc2FnZU1vZGlmaWVkIG9wdGlvbnM6XCIpLEpTT04uc3RyaW5naWZ5KGUpKTt2YXIgbj10aGlzLmdldE1vZHVsZShxbik7ZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtuLm9uTWVzc2FnZU1vZGlmaWVkKHQodCh7fSxlKSx7fSx7Y29udmVyc2F0aW9uVHlwZTpFLkNPTlZfR1JPVVAsdG86ZS50b3BpY0lEP2UudG9waWNJRDplLmdyb3VwSUR9KSl9KSl9fSx7a2V5OlwiZGVsZXRlR3JvdXBTeXN0ZW1Ob3RpY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9ncm91cFN5c3RlbU5vdGljZUhhbmRsZXImJnRoaXMuX2dyb3VwU3lzdGVtTm90aWNlSGFuZGxlci5kZWxldGVHcm91cFN5c3RlbU5vdGljZShlKX19LHtrZXk6XCJpbml0R3JvdXBNYXBcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmdyb3VwTWFwLnNldChlLmdyb3VwSUQsbmV3IGhpKGUpKX19LHtrZXk6XCJkZWxldGVHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZ3JvdXBNYXAuZGVsZXRlKGUpfX0se2tleTpcInVwZGF0ZUdyb3VwTWFwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQsbj10aGlzLG89dGhpcy5nZXRNb2R1bGUocW4pO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dD1lLmdyb3VwSUQsbi5ncm91cE1hcC5oYXModCk/bi5ncm91cE1hcC5nZXQodCkudXBkYXRlR3JvdXAoZSk6KG4uZ3JvdXBNYXAuc2V0KHQsbmV3IGhpKGUpKSxvLmRlbGV0ZUdyb3VwUm9tYWluZ01lc3NhZ2VJbmZvKHQpKX0pKTt2YXIgcyxhPXRoaXMuZ2V0TXlVc2VySUQoKSxpPUQodGhpcy5ncm91cE1hcCk7dHJ5e2ZvcihpLnMoKTshKHM9aS5uKCkpLmRvbmU7KXt2YXIgcj12KHMudmFsdWUsMilbMV07ci5zZWxmSW5mby51c2VySUQ9YSxcIk93bmVyXCI9PT1yLnNlbGZJbmZvLnJvbGUmJihyLm93bmVySUQ9YSl9fWNhdGNoKHUpe2kuZSh1KX1maW5hbGx5e2kuZigpfXRoaXMuX3NldFN0b3JhZ2VHcm91cExpc3QoKX19LHtrZXk6XCJnZXRTdG9yYWdlR3JvdXBMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRNb2R1bGUoVm4pLmdldEl0ZW0oXCJncm91cE1hcFwiKX19LHtrZXk6XCJfc2V0U3RvcmFnZUdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRMb2NhbEdyb3VwTGlzdCgpLmZpbHRlcigoZnVuY3Rpb24oZSl7dmFyIHQ9ZS50eXBlO3JldHVybiFUdCh0KX0pKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiFlLmlzU3VwcG9ydFRvcGljfSkpLnNsaWNlKDAsMjApLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJue2dyb3VwSUQ6ZS5ncm91cElELG5hbWU6ZS5uYW1lLGF2YXRhcjplLmF2YXRhcix0eXBlOmUudHlwZX19KSk7dGhpcy5nZXRNb2R1bGUoVm4pLnNldEl0ZW0oXCJncm91cE1hcFwiLGUpfX0se2tleTpcImdldEdyb3VwTWFwXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cE1hcH19LHtrZXk6XCJnZXRMb2NhbEdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIG0odGhpcy5ncm91cE1hcC52YWx1ZXMoKSl9fSx7a2V5OlwiZ2V0TG9jYWxHcm91cFByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5ncm91cE1hcC5nZXQoZSl9fSx7a2V5Olwic29ydExvY2FsR3JvdXBMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1tKHRoaXMuZ3JvdXBNYXApLmZpbHRlcigoZnVuY3Rpb24oZSl7dmFyIHQ9dihlLDIpO3JldHVybiB0WzBdLCF6dCh0WzFdLmxhc3RNZXNzYWdlKX0pKTtlLnNvcnQoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRbMV0ubGFzdE1lc3NhZ2UubGFzdFRpbWUtZVsxXS5sYXN0TWVzc2FnZS5sYXN0VGltZX0pKSx0aGlzLmdyb3VwTWFwPW5ldyBNYXAobShlKSl9fSx7a2V5OlwidXBkYXRlR3JvdXBMYXN0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NvbW1vbkdyb3VwSGFuZGxlciYmdGhpcy5fY29tbW9uR3JvdXBIYW5kbGVyLmhhbmRsZVVwZGF0ZUdyb3VwTGFzdE1lc3NhZ2UoZSl9fSx7a2V5OlwiZW1pdEdyb3VwTGlzdFVwZGF0ZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9IShhcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXSl8fGFyZ3VtZW50c1swXSx0PSEoYXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pfHxhcmd1bWVudHNbMV0sbj10aGlzLmdldExvY2FsR3JvdXBMaXN0KCk7aWYoZSYmdGhpcy5lbWl0T3V0ZXJFdmVudChrLkdST1VQX0xJU1RfVVBEQVRFRCksdCl7dmFyIG89SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShuKSkscz10aGlzLmdldE1vZHVsZShxbik7cy51cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUobyl9fX0se2tleTpcInBhdGNoR3JvdXBNZXNzYWdlUmVtaW5kVHlwZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRMb2NhbEdyb3VwTGlzdCgpLHQ9dGhpcy5nZXRNb2R1bGUocW4pLG49MDtlLmZvckVhY2goKGZ1bmN0aW9uKGUpeyEwPT09dC5wYXRjaE1lc3NhZ2VSZW1pbmRUeXBlKHtJRDplLmdyb3VwSUQsaXNDMkNDb252ZXJzYXRpb246ITEsbWVzc2FnZVJlbWluZFR5cGU6ZS5zZWxmSW5mby5tZXNzYWdlUmVtaW5kVHlwZX0pJiYobis9MSl9KSksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnBhdGNoR3JvdXBNZXNzYWdlUmVtaW5kVHlwZSBjb3VudDpcIikuY29uY2F0KG4pKX19LHtrZXk6XCJyZWNvbXB1dGVVbnJlYWRDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRMb2NhbEdyb3VwTGlzdCgpLHQ9dGhpcy5nZXRNb2R1bGUocW4pO2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49ZS5ncm91cElELG89ZS5zZWxmSW5mbyxzPW8uZXhjbHVkZWRVbnJlYWRTZXF1ZW5jZUxpc3QsYT1vLnJlYWRlZFNlcXVlbmNlO2lmKGF0KHMpKXt2YXIgaT0wO3MuZm9yRWFjaCgoZnVuY3Rpb24odCl7dD49YSYmdDw9ZS5uZXh0TWVzc2FnZVNlcS0xJiYoaSs9MSl9KSksaT49MSYmdC5yZWNvbXB1dGVHcm91cFVucmVhZENvdW50KHtjb252ZXJzYXRpb25JRDpcIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChuKSxjb3VudDppfSl9fSkpfX0se2tleTpcImdldE15TmFtZUNhcmRCeUdyb3VwSURcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldExvY2FsR3JvdXBQcm9maWxlKGUpO3JldHVybiB0P3Quc2VsZkluZm8ubmFtZUNhcmQ6XCJcIn19LHtrZXk6XCJpc1BhZ2luZ0dldENvbXBsZXRlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLl9jb21tb25Hcm91cEhhbmRsZXImJnRoaXMuX2NvbW1vbkdyb3VwSGFuZGxlci5pc1BhZ2luZ0dldENvbXBsZXRlZCgpfX0se2tleTpcImdldEdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9jb21tb25Hcm91cEhhbmRsZXI/dGhpcy5fY29tbW9uR3JvdXBIYW5kbGVyLmdldEdyb3VwTGlzdChlKTpYYSgpfX0se2tleTpcImdldEdyb3VwUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJnZXRHcm91cFByb2ZpbGVcIiksbz1uZXcgQWEoXCJnZXRHcm91cFByb2ZpbGVcIikscz1lLmdyb3VwSUQsYT1lLmdyb3VwQ3VzdG9tRmllbGRGaWx0ZXI7VmUubChcIlwiLmNvbmNhdChuLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChzKSk7dmFyIGk9e2dyb3VwSURMaXN0OltzXSxyZXNwb25zZUZpbHRlcjp7Z3JvdXBCYXNlSW5mb0ZpbHRlcjpbXCJUeXBlXCIsXCJOYW1lXCIsXCJJbnRyb2R1Y3Rpb25cIixcIk5vdGlmaWNhdGlvblwiLFwiRmFjZVVybFwiLFwiT3duZXJfQWNjb3VudFwiLFwiQ3JlYXRlVGltZVwiLFwiSW5mb1NlcVwiLFwiTGFzdEluZm9UaW1lXCIsXCJMYXN0TXNnVGltZVwiLFwiTWVtYmVyTnVtXCIsXCJNYXhNZW1iZXJOdW1cIixcIkFwcGx5Sm9pbk9wdGlvblwiLFwiTmV4dE1zZ1NlcVwiLFwiU2h1dFVwQWxsTWVtYmVyXCIsXCJJbnZpdGVKb2luT3B0aW9uXCJdLGdyb3VwQ3VzdG9tRmllbGRGaWx0ZXI6YSxtZW1iZXJJbmZvRmlsdGVyOltcIlJvbGVcIixcIkpvaW5UaW1lXCIsXCJNc2dTZXFcIixcIk1zZ0ZsYWdcIixcIk5hbWVDYXJkXCJdfX07cmV0dXJuIHRoaXMuZ2V0R3JvdXBQcm9maWxlQWR2YW5jZShpKS50aGVuKChmdW5jdGlvbihlKXt2YXIgYSxpPWUuZGF0YSxyPWkuc3VjY2Vzc0dyb3VwTGlzdCx1PWkuZmFpbHVyZUdyb3VwTGlzdDtpZihWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpLHUubGVuZ3RoPjApcmV0dXJuIFphKHVbMF0pOyhUdChyWzBdLnR5cGUpJiYhdC5oYXNMb2NhbEdyb3VwKHMpP2E9bmV3IGhpKHJbMF0pOih0LnVwZGF0ZUdyb3VwTWFwKHIpLGE9dC5nZXRMb2NhbEdyb3VwUHJvZmlsZShzKSksYS5pc1N1cHBvcnRUb3BpYyl8fHQuZ2V0TW9kdWxlKHFuKS51cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUoW2FdKTtyZXR1cm4gby5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChzLFwiIHR5cGU6XCIpLmNvbmNhdChhLnR5cGUsXCIgbXV0ZUFsbE1lbWJlcnM6XCIpLmNvbmNhdChhLm11dGVBbGxNZW1iZXJzLFwiIG93bmVySUQ6XCIpLmNvbmNhdChhLm93bmVySUQpKS5lbmQoKSxZYSh7Z3JvdXA6YX0pfSkpLmNhdGNoKChmdW5jdGlvbihzKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksYT1uWzBdLGk9blsxXTtvLnNldEVycm9yKHMsYSxpKS5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQoZS5ncm91cElEKSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLHMpLFphKHMpfSkpfX0se2tleTpcImdldEdyb3VwUHJvZmlsZUFkdmFuY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldEdyb3VwUHJvZmlsZUFkdmFuY2VcIiksbz1lLmdyb3VwSURMaXN0O2F0KG8pJiZvLmxlbmd0aD41MCYmKHRoaXMub3V0cHV0V2FybmluZyhcIkdldEdyb3VwUHJvZmlsZUxpbWl0XCIpLG8ubGVuZ3RoPTUwKTt2YXIgcz1bXSxhPVtdO28uZm9yRWFjaCgoZnVuY3Rpb24oZSl7RHQoe2dyb3VwSUQ6ZX0pP2EucHVzaChlKTpzLnB1c2goZSl9KSk7dmFyIGk9W107aWYocy5sZW5ndGg+MCl7dmFyIHI9dGhpcy5fZ2V0R3JvdXBQcm9maWxlQWR2YW5jZSh0KHQoe30sZSkse30se2dyb3VwSURMaXN0OnN9KSk7aS5wdXNoKHIpfWlmKGEubGVuZ3RoPjApe3ZhciB1PXRoaXMuX2dldEdyb3VwUHJvZmlsZUFkdmFuY2UodCh0KHt9LGUpLHt9LHtncm91cElETGlzdDphLHJlbGF5RmxhZzpzLmxlbmd0aD4wfSkpO2kucHVzaCh1KX1yZXR1cm4gUHJvbWlzZS5hbGwoaSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9W10sbj1bXTtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LnB1c2guYXBwbHkodCxtKGUuc3VjY2Vzc0dyb3VwTGlzdCkpLG4ucHVzaC5hcHBseShuLG0oZS5mYWlsdXJlR3JvdXBMaXN0KSl9KSksWWEoe3N1Y2Nlc3NHcm91cExpc3Q6dCxmYWlsdXJlR3JvdXBMaXN0Om59KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfZ2V0R3JvdXBQcm9maWxlQWR2YW5jZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLnJlbGF5RmxhZyxvPXZvaWQgMCE9PW4mJm4scz1nKGUsRmkpO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp6byxyZXF1ZXN0RGF0YTpzfSkudGhlbigoZnVuY3Rpb24oZSl7VmUubChcIlwiLmNvbmNhdCh0Ll9uLFwiLl9nZXRHcm91cFByb2ZpbGVBZHZhbmNlIG9rLlwiKSk7dmFyIG49ZS5kYXRhLmdyb3VwcztyZXR1cm57c3VjY2Vzc0dyb3VwTGlzdDpuLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGl0KGUuZXJyb3JDb2RlKXx8MD09PWUuZXJyb3JDb2RlfSkpLGZhaWx1cmVHcm91cExpc3Q6bi5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlLmVycm9yQ29kZSYmMCE9PWUuZXJyb3JDb2RlfSkpLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBqYSh7Y29kZTplLmVycm9yQ29kZSxtZXNzYWdlOmUuZXJyb3JJbmZvLGRhdGE6e2dyb3VwSUQ6ZS5ncm91cElEfX0pfSkpfX0pKS5jYXRjaCgoZnVuY3Rpb24odCl7cmV0dXJuIG8mJkR0KHtncm91cElEOmUuZ3JvdXBJRExpc3RbMF19KT97c3VjY2Vzc0dyb3VwTGlzdDpbXSxmYWlsdXJlR3JvdXBMaXN0OltdfTpaYSh0KX0pKX19LHtrZXk6XCJjcmVhdGVHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJjcmVhdGVHcm91cFwiKSxzPWUudHlwZSxhPWUuZ3JvdXBJRDtpZihlLm5hbWUmJiExPT09dGhpcy5fZmlsdGVyUHJvZmFuaXR5KFwibmFtZVwiLGUpKXJldHVybiBaYSh7Y29kZTpoYS5QUk9GQU5JVFlfRk9VTkR9KTtpZihlLmludHJvZHVjdGlvbiYmITE9PT10aGlzLl9maWx0ZXJQcm9mYW5pdHkoXCJpbnRyb2R1Y3Rpb25cIixlKSlyZXR1cm4gWmEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSk7aWYoZS5ub3RpZmljYXRpb24mJiExPT09dGhpcy5fZmlsdGVyUHJvZmFuaXR5KFwibm90aWZpY2F0aW9uXCIsZSkpcmV0dXJuIFphKHtjb2RlOmhhLlBST0ZBTklUWV9GT1VORH0pO2lmKCFbXCJQdWJsaWNcIixcIlByaXZhdGVcIixcIkNoYXRSb29tXCIsXCJBVkNoYXRSb29tXCIsXCJDb21tdW5pdHlcIl0uaW5jbHVkZXMocykpcmV0dXJuIFphKHtjb2RlOmhhLklMTEVHQUxfR1JPVVBfVFlQRX0pO2lmKCFEdCh7dHlwZTpzfSkpe2lmKCF6dChhKSYmRHQoe2dyb3VwSUQ6YX0pKXJldHVybiBaYSh7Y29kZTpoYS5JTExFR0FMX0dST1VQX0lEfSk7ZS5pc1N1cHBvcnRUb3BpYz12b2lkIDB9aWYoVHQocykmJiFpdChlLm1lbWJlckxpc3QpJiZlLm1lbWJlckxpc3QubGVuZ3RoPjAmJihlLm1lbWJlckxpc3Q9dm9pZCAwKSx0aGlzLl9jYW5JVXNlSm9pbk9wdGlvbihzKXx8aXQoZS5qb2luT3B0aW9uKXx8KGUuam9pbk9wdGlvbj12b2lkIDApLER0KHt0eXBlOnN9KSl7aWYoIXp0KGEpJiYhRHQoe2dyb3VwSUQ6YX0pKXJldHVybiBaYSh7Y29kZTpoYS5JTExFR0FMX0dST1VQX0lEfSk7ZS5pc1N1cHBvcnRUb3BpYz0hMD09PWUuaXNTdXBwb3J0VG9waWM/MTowfXZhciBpPW5ldyBBYShcImNyZWF0ZUdyb3VwXCIpO1ZlLmwoXCJcIi5jb25jYXQobyxcIiBvcHRpb25zOlwiKSxlKTt2YXIgcj1udWxsLHU9W107cmV0dXJuIHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkpvLHJlcXVlc3REYXRhOnQodCh7fSxlKSx7fSx7b3duZXJJRDp0aGlzLmdldE15VXNlcklEKCksd2ViUHVzaEZsYWc6MX0pfSkudGhlbigoZnVuY3Rpb24ocyl7dmFyIGE9cy5kYXRhLGM9YS5ncm91cElELGw9YS5vdmVyTGltaXRVc2VySURMaXN0LGQ9dm9pZCAwPT09bD9bXTpsO2lmKHI9Yyx1PWQsaS5zZXROZXR3b3JrVHlwZShuLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJncm91cFR5cGU6XCIuY29uY2F0KGUudHlwZSxcIiBncm91cElEOlwiKS5jb25jYXQoYyxcIiBvdmVyTGltaXRVc2VySURMaXN0PVwiKS5jb25jYXQoZCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBvayBncm91cElEOlwiKS5jb25jYXQoYyxcIiBvdmVyTGltaXRVc2VySURMaXN0OlwiKSxkKSxlLnR5cGU9PT1FLkdSUF9BVkNIQVRST09NKXJldHVybiBuLmdldEdyb3VwUHJvZmlsZSh7Z3JvdXBJRDpjfSk7aWYoZS50eXBlPT09RS5HUlBfQ09NTVVOSVRZJiYxPT09ZS5pc1N1cHBvcnRUb3BpYylyZXR1cm4gbi5nZXRHcm91cFByb2ZpbGUoe2dyb3VwSUQ6Y30pO3p0KGUubWVtYmVyTGlzdCl8fHp0KGQpfHwoZS5tZW1iZXJMaXN0PWUubWVtYmVyTGlzdC5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybi0xPT09ZC5pbmRleE9mKGUudXNlcklEKX0pKSksbi51cGRhdGVHcm91cE1hcChbdCh0KHt9LGUpLHt9LHtncm91cElEOmN9KV0pO3ZhciBwPW4uZ2V0TW9kdWxlKE5uKSxnPXAuY3JlYXRlQ3VzdG9tTWVzc2FnZSh7dG86Yyxjb252ZXJzYXRpb25UeXBlOkUuQ09OVl9HUk9VUCxwYXlsb2FkOntkYXRhOlwiZ3JvdXBfY3JlYXRlXCIsZXh0ZW5zaW9uOm4uaXNJbnRsKCk/XCJcIi5jb25jYXQobi5nZXRNeVVzZXJJRCgpLFwiIGNyZWF0ZWQgYSBncm91cFwiKTpcIlwiLmNvbmNhdChuLmdldE15VXNlcklEKCksXCLliJvlu7rnvqTnu4RcIil9fSk7cmV0dXJuIHAuc2VuZE1lc3NhZ2VJbnN0YW5jZShnKSxuLmVtaXRHcm91cExpc3RVcGRhdGUoKSxuLmdldEdyb3VwUHJvZmlsZSh7Z3JvdXBJRDpjfSl9KSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5kYXRhLmdyb3VwLG49dC5zZWxmSW5mbyxvPW4ubmFtZUNhcmQscz1uLmpvaW5UaW1lO3JldHVybiB0LnVwZGF0ZVNlbGZJbmZvKHtuYW1lQ2FyZDpvLGpvaW5UaW1lOnMsbWVzc2FnZVJlbWluZFR5cGU6RS5NU0dfUkVNSU5EX0FDUFRfQU5EX05PVEUscm9sZTpFLkdSUF9NQlJfUk9MRV9PV05FUn0pLFlhKHtncm91cDp0LG92ZXJMaW1pdFVzZXJJRExpc3Q6dX0pfSkpLmNhdGNoKChmdW5jdGlvbihzKXtpZihpLnNldE1lc3NhZ2UoXCJncm91cFR5cGU6XCIuY29uY2F0KGUudHlwZSkpLG4ucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9dihlLDIpLG49dFswXSxvPXRbMV07aS5zZXRFcnJvcihzLG4sbykuZW5kKCl9KSksMTAwMTA9PT1zLmNvZGV8fDEwMDA3PT09cy5jb2RlKXtuLnVwZGF0ZUdyb3VwTWFwKFt0KHQoe30sZSkse30se2dyb3VwSUQ6cn0pXSk7dmFyIGE9bi5nZXRMb2NhbEdyb3VwUHJvZmlsZShyKTtyZXR1cm4gVmUubChcIlwiLmNvbmNhdChvLFwiIHN1Y2Nlc3MsIGJ1dCBmYWlsZWQgdG8gZ2V0IGdyb3VwIHByb2ZpbGUuXCIpKSxZYSh7Z3JvdXA6YSxvdmVyTGltaXRVc2VySURMaXN0OnV9KX1yZXR1cm4gVmUuZShcIlwiLmNvbmNhdChvLFwiIGZhaWxlZC4gZXJyb3I6XCIpLHMpLFphKHMpfSkpfX0se2tleTpcImRpc21pc3NHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJkaXNtaXNzR3JvdXBcIik7aWYodGhpcy5oYXNMb2NhbEdyb3VwKGUpJiZ0aGlzLmdldExvY2FsR3JvdXBQcm9maWxlKGUpLnR5cGU9PT1FLkdSUF9XT1JLKXJldHVybiBaYShuZXcgamEoe2NvZGU6aGEuQ0FOTk9UX0RJU01JU1NfV09SS30pKTt2YXIgbz1uZXcgQWEoXCJkaXNtaXNzR3JvdXBcIik7cmV0dXJuIG8uc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KGUpKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgZ3JvdXBJRDpcIikuY29uY2F0KGUpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpYbyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDplfX0pLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIG8uc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpLHQuZGVsZXRlTG9jYWxHcm91cEFuZENvbnZlcnNhdGlvbihlKSx0LmNoZWNrSm9pbmVkQVZDaGF0Um9vbUJ5SUQoZSkmJnQuX0FWQ2hhdFJvb21IYW5kbGVyLnJlc2V0KGUpLHQuX2dyb3VwQXR0cmlidXRlc0hhbmRsZXIuZGVsZXRlTG9jYWxHcm91cEF0dHJpYnV0ZXMoZSksWWEoe2dyb3VwSUQ6ZX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMikscz1uWzBdLGE9blsxXTtvLnNldEVycm9yKGUscyxhKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwidXBkYXRlR3JvdXBQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInVwZGF0ZUdyb3VwUHJvZmlsZVwiKTtpZih0aGlzLmhhc0xvY2FsR3JvdXAoZS5ncm91cElEKSl7dmFyIG89dGhpcy5nZXRMb2NhbEdyb3VwUHJvZmlsZShlLmdyb3VwSUQpLnR5cGU7dGhpcy5fY2FuSVVzZUpvaW5PcHRpb24obyl8fGl0KGUuam9pbk9wdGlvbil8fChWZS53KFwiXCIuY29uY2F0KG4sXCIgam9pbk9wdGlvbiBpcyB1bmF2YWlsYWJsZSBmb3IgV29yay9NZWV0aW5nL0FWQ2hhdFJvb21cIikpLGUuam9pbk9wdGlvbj12b2lkIDApfWlmKGl0KGUubXV0ZUFsbE1lbWJlcnMpfHwoZS5tdXRlQWxsTWVtYmVycz9lLm11dGVBbGxNZW1iZXJzPVwiT25cIjplLm11dGVBbGxNZW1iZXJzPVwiT2ZmXCIpLGUubmFtZSYmITE9PT10aGlzLl9maWx0ZXJQcm9mYW5pdHkoXCJuYW1lXCIsZSkpcmV0dXJuIFphKHtjb2RlOmhhLlBST0ZBTklUWV9GT1VORH0pO2lmKGUuaW50cm9kdWN0aW9uJiYhMT09PXRoaXMuX2ZpbHRlclByb2Zhbml0eShcImludHJvZHVjdGlvblwiLGUpKXJldHVybiBaYSh7Y29kZTpoYS5QUk9GQU5JVFlfRk9VTkR9KTtpZihlLm5vdGlmaWNhdGlvbiYmITE9PT10aGlzLl9maWx0ZXJQcm9mYW5pdHkoXCJub3RpZmljYXRpb25cIixlKSlyZXR1cm4gWmEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSk7dmFyIHM9bmV3IEFhKFwidXBkYXRlR3JvdXBQcm9maWxlXCIpO3JldHVybiBzLnNldE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoZSkpLFZlLmwoXCJcIi5jb25jYXQobixcIiBncm91cElEOlwiKS5jb25jYXQoZS5ncm91cElEKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6Wm8scmVxdWVzdERhdGE6ZX0pLnRoZW4oKGZ1bmN0aW9uKCl7KHMuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpLHQuaGFzTG9jYWxHcm91cChlLmdyb3VwSUQpKSYmKHQuZ3JvdXBNYXAuZ2V0KGUuZ3JvdXBJRCkudXBkYXRlR3JvdXAoZSksdC5fc2V0U3RvcmFnZUdyb3VwTGlzdCgpKTtyZXR1cm4gWWEoe2dyb3VwOnQuZ3JvdXBNYXAuZ2V0KGUuZ3JvdXBJRCl9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxhPW5bMV07cy5zZXRFcnJvcihlLG8sYSkuZW5kKCl9KSksVmUubChcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcIl9maWx0ZXJQcm9mYW5pdHlcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuZ2V0TW9kdWxlKG9vKTtpZighbilyZXR1cm4hMDt2YXIgbz1uLmZpbHRlclRleHQodFtlXSx6KSxzPW8uaXNBbGxvd2VkVG9TZW5kLGE9by5tb2RpZmllZFRleHQ7cmV0dXJuITA9PT1zJiYodFtlXT1hLCEwKX19LHtrZXk6XCJqb2luR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ncm91cElELG89ZS50eXBlLHM9XCJcIi5jb25jYXQodGhpcy5fbixcIi5qb2luR3JvdXBcIik7aWYobz09PUUuR1JQX1dPUkspcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9KT0lOX1dPUkt9KTtpZih0aGlzLmRlbGV0ZVVuam9pbmVkQVZDaGF0Um9vbShuKSx0aGlzLmhhc0xvY2FsR3JvdXAobikpe2lmKCF0aGlzLmlzTG9nZ2VkSW4oKSlyZXR1cm4gWGEoe3N0YXR1czpFLkpPSU5fU1RBVFVTX0FMUkVBRFlfSU5fR1JPVVB9KTt2YXIgYT1uZXcgQWEoXCJhcHBseUpvaW5Hcm91cFwiKTtyZXR1cm4gdGhpcy5nZXRHcm91cFByb2ZpbGUoe2dyb3VwSUQ6bn0pLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIGEuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQobixcIiBqb2luZWRTdGF0dXM6XCIpLmNvbmNhdChFLkpPSU5fU1RBVFVTX0FMUkVBRFlfSU5fR1JPVVApKS5lbmQoKSxYYSh7c3RhdHVzOkUuSk9JTl9TVEFUVVNfQUxSRUFEWV9JTl9HUk9VUH0pfSkpLmNhdGNoKChmdW5jdGlvbihvKXtyZXR1cm4gYS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChuLFwiIHVuam9pbmVkXCIpKS5lbmQoKSxWZS53KFwiXCIuY29uY2F0KHMsXCIgXCIpLmNvbmNhdChuLFwiIHdhcyB1bmpvaW5lZCwgbm93IGpvaW4hXCIpKSx0Lmdyb3VwTWFwLmRlbGV0ZShuKSx0LmFwcGx5Sm9pbkdyb3VwKGUpfSkpfXJldHVybiBWZS5sKFwiXCIuY29uY2F0KHMsXCIgZ3JvdXBJRDpcIikuY29uY2F0KG4pKSx0aGlzLmlzTG9nZ2VkSW4oKT90aGlzLmFwcGx5Sm9pbkdyb3VwKGUpOnRoaXMuX0FWQ2hhdFJvb21IYW5kbGVyLmpvaW5XaXRob3V0QXV0aChlKX19LHtrZXk6XCJhcHBseUpvaW5Hcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJhcHBseUpvaW5Hcm91cFwiKSxzPWUuZ3JvdXBJRDtpZighenQoZS5hcHBseU1lc3NhZ2UpJiYhMT09PXRoaXMuX2ZpbHRlclByb2Zhbml0eShcImFwcGx5TWVzc2FnZVwiLGUpKXJldHVybiBaYSh7Y29kZTpoYS5QUk9GQU5JVFlfRk9VTkR9KTt2YXIgYT1uZXcgQWEoXCJhcHBseUpvaW5Hcm91cFwiKSxpPXQoe30sZSkscj10aGlzLmNhbklVc2UoQi5BVkNIQVRST09NX0hJU1RPUllfTVNHKTtyZXR1cm4gciYmKGkuaGlzdG9yeU1lc3NhZ2VGbGFnPTEpLHRoaXMuZ2V0TW9kdWxlKHFuKS5kZWxldGVUb3BpY1JvYW1pbmdNZXNzYWdlSW5mbyhzKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpRbyxyZXF1ZXN0RGF0YTppfSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5kYXRhLGk9dC5qb2luZWRTdGF0dXMsdT10LmxvbmdQb2xsaW5nS2V5LGM9dC5zdGFydFNlcSxsPXQuYXZDaGF0Um9vbUZsYWcsZD10LmF2Q2hhdFJvb21LZXkscD10Lm1lc3NhZ2VMaXN0LGc9XCJncm91cElEOlwiLmNvbmNhdChzLFwiIGpvaW5lZFN0YXR1czpcIikuY29uY2F0KGksXCIgbG9uZ1BvbGxpbmdLZXk6XCIpLmNvbmNhdCh1LFwiIHN0YXJ0U2VxOlwiKS5jb25jYXQoYykrXCIgYXZDaGF0Um9vbUZsYWc6XCIuY29uY2F0KGwsXCIgY2FuR2V0QVZDaGF0Um9vbUhpc3RvcnlNZXNzYWdlOlwiKS5jb25jYXQocixcIixcIikrXCIgaGlzdG9yeSBtZXNzYWdlIGNvdW50OlwiLmNvbmNhdCh6dChwKT8wOnAubGVuZ3RoKTtzd2l0Y2goYS5zZXROZXR3b3JrVHlwZShuLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQoZykpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBvay4gXCIpLmNvbmNhdChnKSksaSl7Y2FzZSB6ZTpyZXR1cm4gWWEoe3N0YXR1czp6ZX0pO2Nhc2UgamU6cmV0dXJuIG4uZ2V0R3JvdXBQcm9maWxlKHtncm91cElEOnN9KS50aGVuKChmdW5jdGlvbihlKXt2YXIgdD1lLmRhdGEuZ3JvdXA7cmV0dXJuIG4uX2hhbmRsZUpvaW5SZXN1bHQoe2dyb3VwOnQsYXZDaGF0Um9vbUZsYWc6bCxsb25nUG9sbGluZ0tleTp1LHN0YXJ0U2VxOmMsYXZDaGF0Um9vbUtleTpkLG1lc3NhZ2VMaXN0OnB9KX0pKS5jYXRjaCgoZnVuY3Rpb24oKXt2YXIgZT1uZXcgaGkoe2dyb3VwSUQ6c30pO3JldHVybiBuLl9oYW5kbGVKb2luUmVzdWx0KHtncm91cDplLGF2Q2hhdFJvb21GbGFnOmwsbG9uZ1BvbGxpbmdLZXk6dSxzdGFydFNlcTpjLGF2Q2hhdFJvb21LZXk6ZCxtZXNzYWdlTGlzdDpwfSl9KSk7ZGVmYXVsdDp2YXIgaD1uZXcgamEoe2NvZGU6aGEuSk9JTl9HUk9VUF9GQUlMfSk7cmV0dXJuIFZlLmUoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGVycm9yOlwiKSxoKSxaYShoKX19KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiBhLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChzKSksbi5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTthLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiX2hhbmRsZUpvaW5SZXN1bHRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdCxuPXRoaXMsbz1lLmdyb3VwLHM9ZS5hdkNoYXRSb29tRmxhZyxhPWUubG9uZ1BvbGxpbmdLZXksaT1lLnN0YXJ0U2VxLHI9ZS5hdkNoYXRSb29tS2V5LHU9ZS5tZXNzYWdlTGlzdCxjPW8uZ3JvdXBJRDtyZXR1cm4gMT09PXM/KHRoaXMuZ2V0TW9kdWxlKHFuKS5zZXRDb21wbGV0ZWQoXCJcIi5jb25jYXQoRS5DT05WX0dST1VQKS5jb25jYXQoYykpLHRoaXMuX2dyb3VwQXR0cmlidXRlc0hhbmRsZXIuaW5pdEdyb3VwQXR0cmlidXRlc0NhY2hlKHtncm91cElEOmMsYXZDaGF0Um9vbUtleTpyfSksdGhpcy5fZ3JvdXBDb3VudGVyc0hhbmRsZXIuaW5pdEdyb3VwQ291bnRlcnNDYWNoZSh7Z3JvdXBJRDpjLGF2Q2hhdFJvb21LZXk6cn0pLCh0PWl0KGEpP3RoaXMuX0FWQ2hhdFJvb21IYW5kbGVyLmhhbmRsZUpvaW5SZXN1bHQoe2dyb3VwOm99KTp0aGlzLl9BVkNoYXRSb29tSGFuZGxlci5zdGFydFJ1bkxvb3Aoe2dyb3VwOm8sbG9uZ1BvbGxpbmdLZXk6YSxzdGFydFNlcTppfSkpLnRoZW4oKGZ1bmN0aW9uKCl7bi5fb25BVkNoYXRSb29tSGlzdG9yeU1lc3NhZ2UodSl9KSksdCk6KHRoaXMuZW1pdEdyb3VwTGlzdFVwZGF0ZSghMCwhMSksWWEoe3N0YXR1czpqZSxncm91cDpvfSkpfX0se2tleTpcInF1aXRHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJxdWl0R3JvdXBcIik7VmUubChcIlwiLmNvbmNhdChuLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChlKSk7dmFyIG89dGhpcy5jaGVja0pvaW5lZEFWQ2hhdFJvb21CeUlEKGUpO2lmKCFvJiYhdGhpcy5oYXNMb2NhbEdyb3VwKGUpKXJldHVybiBaYSh7Y29kZTpoYS5NRU1CRVJfTk9UX0lOX0dST1VQfSk7aWYobyYmIXRoaXMuaXNMb2dnZWRJbigpKXJldHVybiBWZS5sKFwiXCIuY29uY2F0KG4sXCIgYW5vbnltb3VzbHkgb2suIGdyb3VwSUQ6XCIpLmNvbmNhdChlKSksdGhpcy5kZWxldGVMb2NhbEdyb3VwQW5kQ29udmVyc2F0aW9uKGUpLHRoaXMuX0FWQ2hhdFJvb21IYW5kbGVyLnJlc2V0KGUpLFhhKHtncm91cElEOmV9KTt2YXIgcz1uZXcgQWEoXCJxdWl0R3JvdXBcIik7cmV0dXJuIHMuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KGUpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTplcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDplfX0pLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIHMuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpLHQuZGVsZXRlTG9jYWxHcm91cEFuZENvbnZlcnNhdGlvbihlKSxvJiZ0Ll9BVkNoYXRSb29tSGFuZGxlci5yZXNldChlKSx0Ll9ncm91cEF0dHJpYnV0ZXNIYW5kbGVyLmRlbGV0ZUxvY2FsR3JvdXBBdHRyaWJ1dGVzKGUpLFlhKHtncm91cElEOmV9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxhPW5bMV07cy5zZXRFcnJvcihlLG8sYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcInNlYXJjaEdyb3VwQnlJRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJzZWFyY2hHcm91cEJ5SURcIiksbz17Z3JvdXBJRExpc3Q6W2VdfSxzPW5ldyBBYShcInNlYXJjaEdyb3VwQnlJRFwiKTtyZXR1cm4gcy5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQoZSkpLFZlLmwoXCJcIi5jb25jYXQobixcIiBncm91cElEOlwiKS5jb25jYXQoZSkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOnRzLHJlcXVlc3REYXRhOm99KS50aGVuKChmdW5jdGlvbihlKXt2YXIgbz1lLmRhdGEuZ3JvdXBQcm9maWxlO2lmKDAhPT1vWzBdLmVycm9yQ29kZSl0aHJvdyBuZXcgamEoe2NvZGU6b1swXS5lcnJvckNvZGUsbWVzc2FnZTpvWzBdLmVycm9ySW5mb30pO3JldHVybiBzLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKSxZYSh7Z3JvdXA6bmV3IGhpKG9bMF0pfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0sYT1uWzFdO3Muc2V0RXJyb3IoZSxvLGEpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJjaGFuZ2VHcm91cE93bmVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImNoYW5nZUdyb3VwT3duZXJcIik7aWYodGhpcy5oYXNMb2NhbEdyb3VwKGUuZ3JvdXBJRCkmJnRoaXMuZ2V0TG9jYWxHcm91cFByb2ZpbGUoZS5ncm91cElEKS50eXBlPT09RS5HUlBfQVZDSEFUUk9PTSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX0NIQU5HRV9PV05FUl9JTl9BVkNIQVRST09NfSk7aWYoZS5uZXdPd25lcklEPT09dGhpcy5nZXRNeVVzZXJJRCgpKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfQ0hBTkdFX09XTkVSX1RPX1NFTEZ9KTt2YXIgbz1uZXcgQWEoXCJjaGFuZ2VHcm91cE93bmVyXCIpO3JldHVybiBvLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChlLmdyb3VwSUQsXCIgbmV3T3duZXJJRDpcIikuY29uY2F0KGUubmV3T3duZXJJRCkpLFZlLmwoXCJcIi5jb25jYXQobixcIiBncm91cElEOlwiKS5jb25jYXQoZS5ncm91cElEKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6bnMscmVxdWVzdERhdGE6ZX0pLnRoZW4oKGZ1bmN0aW9uKCl7by5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBva1wiKSk7dmFyIHM9ZS5ncm91cElELGE9ZS5uZXdPd25lcklEO3QuZ3JvdXBNYXAuZ2V0KHMpLm93bmVySUQ9YTt2YXIgaT10LmdldE1vZHVsZSh3bikuZ2V0TG9jYWxHcm91cE1lbWJlckxpc3Qocyk7aWYoaSBpbnN0YW5jZW9mIE1hcCl7dmFyIHI9aS5nZXQodC5nZXRNeVVzZXJJRCgpKTtpdChyKXx8KHIudXBkYXRlUm9sZShcIk1lbWJlclwiKSx0Lmdyb3VwTWFwLmdldChzKS5zZWxmSW5mby5yb2xlPVwiTWVtYmVyXCIpO3ZhciB1PWkuZ2V0KGEpO2l0KHUpfHx1LnVwZGF0ZVJvbGUoXCJPd25lclwiKX1yZXR1cm4gdC5lbWl0R3JvdXBMaXN0VXBkYXRlKCEwLCExKSxZYSh7Z3JvdXA6dC5ncm91cE1hcC5nZXQocyl9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLHM9blswXSxhPW5bMV07by5zZXRFcnJvcihlLHMsYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImdldEdyb3VwQXBwbGljYXRpb25MaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ3JvdXBTeXN0ZW1Ob3RpY2VIYW5kbGVyLmdldEdyb3VwQXBwbGljYXRpb25MaXN0KCl9fSx7a2V5OlwiaGFuZGxlR3JvdXBBcHBsaWNhdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0LG4sbyxzLGEsaT10aGlzLHI9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiaGFuZGxlR3JvdXBBcHBsaWNhdGlvblwiKSx1PWUuaGFuZGxlQWN0aW9uLGM9ZS5oYW5kbGVNZXNzYWdlLGw9ZS5tZXNzYWdlLGQ9ZS5hcHBsaWNhdGlvbjtsPyh0PWwucGF5bG9hZC5vcGVyYXRvcklELG49bC5wYXlsb2FkLmdyb3VwUHJvZmlsZS5ncm91cElELG89bC5wYXlsb2FkLmF1dGhlbnRpY2F0aW9uLHM9bC5wYXlsb2FkLm1lc3NhZ2VLZXkpOmQmJih0PWQuYXBwbGljYW50LG49ZC5ncm91cElELG89ZC5hdXRoZW50aWNhdGlvbixzPWQubWVzc2FnZUtleSk7dmFyIHA9b3M7ZCYmMj09PWQuYXBwbGljYXRpb25UeXBlJiYocD1zcyxhPWQudXNlcklEKTt2YXIgZz1uZXcgQWEoXCJoYW5kbGVHcm91cEFwcGxpY2F0aW9uXCIpO3JldHVybiBnLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChuKSksVmUubChcIlwiLmNvbmNhdChyLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChuKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6cCxyZXF1ZXN0RGF0YTp7aGFuZGxlQWN0aW9uOnUsaGFuZGxlTWVzc2FnZTpjLGFwcGxpY2FudDp0LGludml0ZWU6YSxncm91cElEOm4sYXV0aGVudGljYXRpb246byxtZXNzYWdlS2V5OnN9fSkudGhlbigoZnVuY3Rpb24oKXtyZXR1cm4gZy5zZXROZXR3b3JrVHlwZShpLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQocixcIiBva1wiKSksbCYmaS5fZ3JvdXBTeXN0ZW1Ob3RpY2VIYW5kbGVyLmRlbGV0ZUdyb3VwU3lzdGVtTm90aWNlKHttZXNzYWdlTGlzdDpbZS5tZXNzYWdlXX0pLFlhKHtncm91cDppLmdldExvY2FsR3JvdXBQcm9maWxlKG4pfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiBpLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2cuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQocixcIiBmYWlsZWQuIGVycm9yXCIpLGUpLFphKGUpfSkpfX0se2tleTpcImhhbmRsZUdyb3VwSW52aXRhdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJoYW5kbGVHcm91cEludml0YXRpb25cIikscz1lLm1lc3NhZ2UucGF5bG9hZCxhPXMuZ3JvdXBQcm9maWxlLmdyb3VwSUQsaT1zLmF1dGhlbnRpY2F0aW9uLHI9cy5tZXNzYWdlS2V5LHU9cy5vcGVyYXRvcklELGM9ZS5oYW5kbGVBY3Rpb24sbD1uZXcgQWEoXCJoYW5kbGVHcm91cEludml0YXRpb25cIik7cmV0dXJuIGwuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KGEsXCIgaW52aXRlcjpcIikuY29uY2F0KHUsXCIgaGFuZGxlQWN0aW9uOlwiKS5jb25jYXQoYykpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBncm91cElEOlwiKS5jb25jYXQoYSxcIiBpbnZpdGVyOlwiKS5jb25jYXQodSxcIiBoYW5kbGVBY3Rpb246XCIpLmNvbmNhdChjKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6YXMscmVxdWVzdERhdGE6dCh0KHt9LGUpLHt9LHtpbnZpdGVyOnUsZ3JvdXBJRDphLGF1dGhlbnRpY2F0aW9uOmksbWVzc2FnZUtleTpyfSl9KS50aGVuKChmdW5jdGlvbigpe3JldHVybiBsLnNldE5ldHdvcmtUeXBlKG4uZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChvLFwiIG9rXCIpKSxuLl9ncm91cFN5c3RlbU5vdGljZUhhbmRsZXIuZGVsZXRlR3JvdXBTeXN0ZW1Ob3RpY2Uoe21lc3NhZ2VMaXN0OltlLm1lc3NhZ2VdfSksWWEoe2dyb3VwOm4uZ2V0TG9jYWxHcm91cFByb2ZpbGUoYSl9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIG4ucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07bC5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChvLFwiIGZhaWxlZC4gZXJyb3JcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiZ2V0R3JvdXBPbmxpbmVNZW1iZXJDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9BVkNoYXRSb29tSGFuZGxlcj90aGlzLl9BVkNoYXRSb29tSGFuZGxlci5jaGVja0pvaW5lZEFWQ2hhdFJvb21CeUlEKGUpP3RoaXMuX0FWQ2hhdFJvb21IYW5kbGVyLmdldEdyb3VwT25saW5lTWVtYmVyQ291bnQoZSk6WGEoe21lbWJlckNvdW50OjB9KTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJoYXNMb2NhbEdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ3JvdXBNYXAuaGFzKGUpfX0se2tleTpcImRlbGV0ZUxvY2FsR3JvdXBBbmRDb252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmNoZWNrSm9pbmVkQVZDaGF0Um9vbUJ5SUQoZSk7KFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5kZWxldGVMb2NhbEdyb3VwQW5kQ29udmVyc2F0aW9uIGlzSm9pbmVkQVZDaGF0Um9vbTpcIikuY29uY2F0KHQpKSx0KSYmdGhpcy5nZXRNb2R1bGUocW4pLmRlbGV0ZUxvY2FsQ29udmVyc2F0aW9uKFwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KGUpKTtpZihEdCh7Z3JvdXBJRDplfSkpe3ZhciBuPXRoaXMuZ2V0TG9jYWxHcm91cFByb2ZpbGUoZSk7aWYobiYmITA9PT1uLmlzU3VwcG9ydFRvcGljKXRoaXMuZ2V0TW9kdWxlKEZuKS5kZWxldGVUb3BpY0xpc3RJbkNvbW11bml0eShlKX10aGlzLl9kZWxldGVMb2NhbEdyb3VwKGUpLHRoaXMuZW1pdEdyb3VwTGlzdFVwZGF0ZSghMCwhMSl9fSx7a2V5OlwiX2RlbGV0ZUxvY2FsR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmdyb3VwTWFwLmRlbGV0ZShlKSx0aGlzLmdldE1vZHVsZSh3bikuZGVsZXRlR3JvdXBNZW1iZXJMaXN0KGUpLHRoaXMuX3NldFN0b3JhZ2VHcm91cExpc3QoKX19LHtrZXk6XCJzZW5kTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7aWYoYXQoZS5fcmVjZWl2ZXJMaXN0KSYmZS5fcmVjZWl2ZXJMaXN0Lmxlbmd0aD4wJiYhdGhpcy5jYW5JVXNlKEIuTVNHX1RPX1NQRUNJRklFRF9HUlBfTUJSKSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX1VTRV9DT01NRVJDSUFMX0FCSUxJVFl9KTt2YXIgbj10aGlzLmNyZWF0ZUdyb3VwTWVzc2FnZVBhY2soZSx0KTtyZXR1cm4gdGhpcy5yZXF1ZXN0KG4pfX0se2tleTpcImNyZWF0ZUdyb3VwTWVzc2FnZVBhY2tcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPW51bGw7dCYmdC5vZmZsaW5lUHVzaEluZm8mJihuPXQub2ZmbGluZVB1c2hJbmZvKTt2YXIgbz1cIlwiO250KGUuY2xvdWRDdXN0b21EYXRhKSYmZS5jbG91ZEN1c3RvbURhdGEubGVuZ3RoPjAmJihvPWUuY2xvdWRDdXN0b21EYXRhKTt2YXIgcz1bXTtpZihzdCh0KSYmc3QodC5tZXNzYWdlQ29udHJvbEluZm8pKXt2YXIgYT10Lm1lc3NhZ2VDb250cm9sSW5mbyxpPWEuZXhjbHVkZWRGcm9tVW5yZWFkQ291bnQscj1hLmV4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlLHU9YS5leGNsdWRlZEZyb21Db250ZW50TW9kZXJhdGlvbjshMD09PWkmJnMucHVzaChcIk5vVW5yZWFkXCIpLCEwPT09ciYmcy5wdXNoKFwiTm9MYXN0TXNnXCIpLCEwPT09dSYmcy5wdXNoKFwiTm9Nc2dDaGVja1wiKX12YXIgYz12b2lkIDA7YXQoZS5fcmVjZWl2ZXJMaXN0KSYmZS5fcmVjZWl2ZXJMaXN0Lmxlbmd0aD4wJiYoYz1lLl9yZWNlaXZlckxpc3QsZS5fcmVjZWl2ZXJMaXN0Lmxlbmd0aD41MCYmKGM9ZS5fcmVjZWl2ZXJMaXN0LnNsaWNlKDAsNTApLHRoaXMub3V0cHV0V2FybmluZyhcIlJlY2VpdmVyTGlzdExpbWl0XCIpKSk7dmFyIGw9dGhpcy5pc09ubGluZU1lc3NhZ2UoZSx0KT8xOjAsZD1lLmdldEdyb3VwQXRJbmZvTGlzdCgpLHA9e2Zyb21BY2NvdW50OnRoaXMuZ2V0TXlVc2VySUQoKSxncm91cElEOmUudG8sbXNnQm9keTplLmdldEVsZW1lbnRzKCksY2xvdWRDdXN0b21EYXRhOm8scmFuZG9tOmUucmFuZG9tLHByaW9yaXR5OmUucHJpb3JpdHksY2xpZW50U2VxdWVuY2U6ZS5jbGllbnRTZXF1ZW5jZSxncm91cEF0SW5mbzplLnR5cGUhPT1FLk1TR19URVhUfHx6dChkKT92b2lkIDA6ZCxvbmxpbmVPbmx5RmxhZzpsLGNsaWVudFRpbWU6ZS5jbGllbnRUaW1lLG9mZmxpbmVQdXNoSW5mbzpuP3twdXNoRmxhZzohMD09PW4uZGlzYWJsZVB1c2g/MTowLHRpdGxlOm4udGl0bGV8fFwiXCIsZGVzYzpuLmRlc2NyaXB0aW9ufHxcIlwiLGV4dDpuLmV4dGVuc2lvbnx8XCJcIixhcG5zSW5mbzp7YmFkZ2VNb2RlOiEwPT09bi5pZ25vcmVJT1NCYWRnZT8xOjAsaXNWb2lwUHVzaDp0aGlzLl9pc1ZvaXBQdXNoKG4pfSxhbmRyb2lkSW5mbzp7T1BQT0NoYW5uZWxJRDpuLmFuZHJvaWRPUFBPQ2hhbm5lbElEfHxcIlwifX06dm9pZCAwLG1lc3NhZ2VDb250cm9sSW5mbzowPT09bD9zOnZvaWQgMCxuZWVkUmVhZFJlY2VpcHQ6ITAhPT1lLm5lZWRSZWFkUmVjZWlwdHx8dGhpcy5pc01lc3NhZ2VGcm9tT3JUb0FWQ2hhdHJvb20oZS50byk/MDoxLHJlY2VpdmVyTGlzdDpjLGlzU3VwcG9ydEV4dGVuc2lvbjohMD09PWUuaXNTdXBwb3J0RXh0ZW5zaW9uPzE6MH07cmV0dXJuIGt0KGUudG8pJiYocC5ncm91cElEPXh0KGUudG8pLHAudG9waWNJRD1lLnRvKSx7cHJvdG9jb2xOYW1lOnZvLHRqZ0lEOnRoaXMuZ2VuZXJhdGVUamdJRChlKSxyZXF1ZXN0RGF0YTpwfX19LHtrZXk6XCJfaXNWb2lwUHVzaFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXZvaWQgMDtyZXR1cm4gaXQoZS5kaXNhYmxlVm9pcFB1c2gpfHwodD0hMT09PWUuZGlzYWJsZVZvaXBQdXNoPzE6MCksdH19LHtrZXk6XCJyZXZva2VNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9e2dyb3VwSUQ6ZS50byxtc2dTZXFMaXN0Olt7bXNnU2VxOmUuc2VxdWVuY2V9XX07cmV0dXJuIGt0KGUudG8pJiYodC5ncm91cElEPXh0KGUudG8pLHQudG9waWNJRD1lLnRvKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTppcyxyZXF1ZXN0RGF0YTp0fSl9fSx7a2V5OlwiZGVsZXRlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUudG8sbj1lLmtleUxpc3Q7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmRlbGV0ZU1lc3NhZ2UgZ3JvdXBJRDpcIikuY29uY2F0KHQsXCIgY291bnQ6XCIpLmNvbmNhdChuLmxlbmd0aCkpO3ZhciBvPXtncm91cElEOnQsZGVsZXRlcjp0aGlzLmdldE15VXNlcklEKCksa2V5TGlzdDpufTtyZXR1cm4ga3QodCkmJihvLmdyb3VwSUQ9eHQodCksby50b3BpY0lEPXQpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOk1zLHJlcXVlc3REYXRhOm99KX19LHtrZXk6XCJtb2RpZnlSZW1vdGVNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50byxuPWUuc2VxdWVuY2Usbz1lLnBheWxvYWQscz1lLnR5cGUsYT1lLnZlcnNpb24saT12b2lkIDA9PT1hPzA6YSxyPWUuY2xvdWRDdXN0b21EYXRhLHU9dCxjPXZvaWQgMDtrdCh0KSYmKHU9eHQodCksYz10KTt2YXIgbD12b2lkIDA7cmV0dXJuIEJ0KHMpJiYobD1bXSkucHVzaCh7dHlwZTpzLGNvbnRlbnQ6b30pLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOnlzLHJlcXVlc3REYXRhOntncm91cElEOnUsdG9waWNJRDpjLHNlcXVlbmNlOm4sdmVyc2lvbjppLGVsZW1lbnRzOmwsY2xvdWRDdXN0b21EYXRhOnJ9fSl9fSx7a2V5OlwiZ2V0Um9hbWluZ01lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRSb2FtaW5nTWVzc2FnZVwiKSxvPWUuY29udmVyc2F0aW9uSUQscz1lLmdyb3VwSUQsYT1lLnNlcXVlbmNlLGk9bmV3IEFhKFwiZ2V0R3JvdXBSb2FtaW5nTWVzc2FnZXNcIikscj0wLHU9dm9pZCAwO3JldHVybiBrdChzKSYmKHM9eHQodT1zKSksdGhpcy5fY29tcHV0ZUxhc3RTZXF1ZW5jZSh7Z3JvdXBJRDpzLHRvcGljSUQ6dSxzZXF1ZW5jZTphfSkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuIHI9ZSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgZ3JvdXBJRDpcIikuY29uY2F0KHMsXCIgc3RhcnRTZXF1ZW5jZTpcIikuY29uY2F0KHIpKSx0LnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpjcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDpzLGNvdW50OjIxLHNlcXVlbmNlOnIsdG9waWNJRDp1fX0pfSkpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBhPWUuZGF0YSxjPWEubWVzc2FnZUxpc3QsbD1hLmNvbXBsZXRlLGQ9YS5pbnZpc2libGVTZXF1ZW5jZUxpc3QscD12b2lkIDA9PT1kP1tdOmQ7aXQoYyk/VmUubChcIlwiLmNvbmNhdChuLFwiIG9rLiBjb21wbGV0ZTpcIikuY29uY2F0KGwsXCIgYnV0IG1lc3NhZ2VMaXN0IGlzIHVuZGVmaW5lZCFcIikpOlZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gY29tcGxldGU6XCIpLmNvbmNhdChsLFwiIGNvdW50OlwiKS5jb25jYXQoYy5sZW5ndGgpKTt2YXIgZz10Ll9nZXRNaW5TZXF1ZW5jZShwLGMpLTE7aS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChzLFwiIHRvcGljSUQ6XCIpLmNvbmNhdCh1LFwiIHN0YXJ0U2VxdWVuY2U6XCIpLmNvbmNhdChyLFwiIGNvbXBsZXRlOlwiKS5jb25jYXQobCxcIiBuZXh0U2VxdWVuY2U6XCIpLmNvbmNhdChnKSkuZW5kKCk7dmFyIGg9dC5nZXRNb2R1bGUocW4pLF89W107cmV0dXJuIHp0KGMpfHwoaC51cGRhdGVSb2FtaW5nTWVzc2FnZVNlcXVlbmNlKG8sZyksXz1oLm9uUm9hbWluZ01lc3NhZ2UoYyxvKSxoLnVwZGF0ZUlzUmVhZChvKSxoLnBhdGNoQ29udmVyc2F0aW9uTGFzdE1lc3NhZ2UobykpLCgyPT09bHx8Zzw9MSkmJihoLnNldENvbXBsZXRlZChvKSxnPVwiXCIpLFZlLmwoXCJcIi5jb25jYXQobixcIiBuZXh0UmVxSUQ6XCIpLmNvbmNhdChnLFwiLCBzdG9yZWQgbWVzc2FnZSBjb3VudDpcIikuY29uY2F0KF8ubGVuZ3RoLFwiLCBpbnZpc2libGUgc2VxdWVuY2UgY291bnQ6XCIpLmNvbmNhdChwLmxlbmd0aCkpLHtuZXh0UmVxSUQ6ZytcIlwiLHN0b3JlZE1lc3NhZ2VMaXN0Ol99fSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLGE9blsxXTtpLnNldEVycm9yKGUsbyxhKS5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQocyxcIiB0b3BpY0lEOlwiKS5jb25jYXQodSxcIiBzdGFydFNlcXVlbmNlOlwiKS5jb25jYXQocikpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfZ2V0R3JvdXBJRE9mTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlLmNvbnZlcnNhdGlvbklELnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpfX0se2tleTpcIl9nZXRNaW5TZXF1ZW5jZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49MDt6dCh0KXx8KG49dFt0Lmxlbmd0aC0xXS5zZXF1ZW5jZSk7dmFyIG89MDt6dChlKXx8KG89ZVtlLmxlbmd0aC0xXSk7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fZ2V0TWluU2VxdWVuY2UgbWluVmlzaWJsZVNlcXVlbmNlOlwiKS5jb25jYXQobixcIiBtaW5JbnZpc2libGVTZXF1ZW5jZTpcIikuY29uY2F0KG8pKSxvPjAmJm88bj9vOm59fSx7a2V5OlwiZ2V0UmVhZFJlY2VpcHRMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImdldFJlYWRSZWNlaXB0TGlzdFwiKSxvPXRoaXMuX2dldEdyb3VwSURPZk1lc3NhZ2UoZVswXSkscz10aGlzLmdldE15VXNlcklEKCksYT1lLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGUuZnJvbT09PXMmJiEwPT09ZS5uZWVkUmVhZFJlY2VpcHR9KSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm57c2VxdWVuY2U6ZS5zZXF1ZW5jZX19KSk7aWYoVmUubChcIlwiLmNvbmNhdChuLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChvLFwiIHNlcXVlbmNlTGlzdDpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KGEpKSksMD09PWEubGVuZ3RoKXJldHVybiBYYSh7bWVzc2FnZUxpc3Q6ZX0pO3ZhciBpPW5ldyBBYShcImdldFJlYWRSZWNlaXB0TGlzdFwiKTtyZXR1cm4gaS5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQobykpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmxzLHJlcXVlc3REYXRhOntncm91cElEOm8sc2VxdWVuY2VMaXN0OmF9fSkudGhlbigoZnVuY3Rpb24odCl7aS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpO3ZhciBvPXQuZGF0YS5yZWFkUmVjZWlwdExpc3Q7cmV0dXJuIGF0KG8pJiZvLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UuZm9yRWFjaCgoZnVuY3Rpb24oZSl7MD09PXQuY29kZSYmdC5zZXF1ZW5jZT09PWUuc2VxdWVuY2UmJihlLnJlYWRSZWNlaXB0SW5mby5yZWFkQ291bnQ9dC5yZWFkQ291bnQsZS5yZWFkUmVjZWlwdEluZm8udW5yZWFkQ291bnQ9dC51bnJlYWRDb3VudCl9KSl9KSksWWEoe21lc3NhZ2VMaXN0OmV9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07aS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcInNlbmRSZWFkUmVjZWlwdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJzZW5kUmVhZFJlY2VpcHRcIiksbz10aGlzLl9nZXRHcm91cElET2ZNZXNzYWdlKGVbMF0pLHM9bmV3IEFhKFwic2VuZFJlYWRSZWNlaXB0XCIpO3Muc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG8pKTt2YXIgYT10aGlzLmdldE15VXNlcklEKCksaT1lLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGUuZnJvbSE9PWEmJiEwPT09ZS5uZWVkUmVhZFJlY2VpcHR9KSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm57c2VxdWVuY2U6ZS5zZXF1ZW5jZX19KSk7cmV0dXJuIDA9PT1pLmxlbmd0aD9aYSh7Y29kZTpoYS5SRUFEX1JFQ0VJUFRfTUVTU0FHRV9MSVNUX0VNUFRZfSk6KFZlLmwoXCJcIi5jb25jYXQobixcIi4gc2VxdWVuY2VMaXN0OlwiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkoaSkpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpkcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDpvLHNlcXVlbmNlTGlzdDppfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBzLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBva1wiKSksWWEoKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxhPW5bMV07cy5zZXRFcnJvcihlLG8sYSkuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpKX19LHtrZXk6XCJnZXRSZWFkUmVjZWlwdERldGFpbFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLm1lc3NhZ2Usbz1lLmZpbHRlcixzPWUuY3Vyc29yLGE9ZS5jb3VudCxpPXRoaXMuX2dldEdyb3VwSURPZk1lc3NhZ2Uobikscj1uLklELHU9bi5zZXF1ZW5jZSxjPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImdldFJlYWRSZWNlaXB0RGV0YWlsXCIpLGw9dGhpcy5fcmVjZWlwdERldGFpbENvbXBsZXRlTWFwLmdldChyKXx8ITEsZD0wIT09byYmMSE9PW8/MDpvLHA9bnQocyk/czpcIlwiLGc9IWV0KGEpfHxhPD0wfHxhPj0xMDA/MTAwOmEsaD1cImdyb3VwSUQ6XCIuY29uY2F0KGksXCIgc2VxdWVuY2U6XCIpLmNvbmNhdCh1LFwiIGN1cnNvcjpcIikuY29uY2F0KHAsXCIgZmlsdGVyOlwiKS5jb25jYXQoZCxcIiBjb21wbGV0ZUZsYWc6XCIpLmNvbmNhdChsKTtWZS5sKFwiXCIuY29uY2F0KGMsXCIgXCIpLmNvbmNhdChoKSk7dmFyIF89e2N1cnNvcjpcIlwiLGlzQ29tcGxldGVkOiExLG1lc3NhZ2VJRDpyLHVucmVhZFVzZXJJRExpc3Q6W10scmVhZFVzZXJJRExpc3Q6W119LGY9bmV3IEFhKFwiZ2V0UmVhZFJlY2VpcHREZXRhaWxcIik7cmV0dXJuIGYuc2V0TWVzc2FnZShoKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpncyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDppLHNlcXVlbmNlOnUsZmxhZzpkLGN1cnNvcjpwLGNvdW50Omd9fSkudGhlbigoZnVuY3Rpb24oZSl7Zi5lbmQoKTt2YXIgbj1lLmRhdGEsbz1uLmN1cnNvcixzPW4uaXNDb21wbGV0ZWQsYT1uLnVucmVhZFVzZXJJRExpc3QsaT1uLnJlYWRVc2VySURMaXN0O3JldHVybiBfLmN1cnNvcj1vLDE9PT1zJiYoXy5pc0NvbXBsZXRlZD0hMCx0Ll9yZWNlaXB0RGV0YWlsQ29tcGxldGVNYXAuc2V0KHIsITApKSwwPT09ZD9fLnJlYWRVc2VySURMaXN0PWkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS51c2VySUR9KSk6MT09PWQmJihfLnVucmVhZFVzZXJJRExpc3Q9YS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnVzZXJJRH0pKSksVmUubChcIlwiLmNvbmNhdChjLFwiIG9rXCIpKSxZYShfKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07Zi5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdChjLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImdldFJvYW1pbmdNZXNzYWdlc0hvcHBpbmdcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRSb2FtaW5nTWVzc2FnZXNIb3BwaW5nXCIpLG89bmV3IEFhKFwiZ2V0R3JvdXBSb2FtaW5nTWVzc2FnZXNIb3BwaW5nXCIpLHM9ZS5ncm91cElELGE9ZS5jb3VudCxpPWUuc2VxdWVuY2Uscj1lLmRpcmVjdGlvbix1PWk7MT09PXImJih1PWkrYS0xKTt2YXIgYz12b2lkIDA7a3QocykmJihzPXh0KGM9cykpO3ZhciBsPVwiXCIuY29uY2F0KGM/XCJ0b3BpY0lEOlwiLmNvbmNhdChjKTpcImdyb3VwSUQ6XCIuY29uY2F0KHMpLFwiIHNlcXVlbmNlOlwiKS5jb25jYXQoaSxcIiBkaXJlY3Rpb246XCIpLmNvbmNhdChyKTtyZXR1cm4gVmUubChcIlwiLmNvbmNhdChuLFwiIFwiKS5jb25jYXQobCkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmNzLHJlcXVlc3REYXRhOntncm91cElEOnMsdG9waWNJRDpjLGNvdW50OmEsc2VxdWVuY2U6dX19KS50aGVuKChmdW5jdGlvbihzKXt2YXIgYT1zLmRhdGEsdT1hLm1lc3NhZ2VMaXN0LGM9YS5jb21wbGV0ZSxkPVwiY29tcGxldGU6XCIuY29uY2F0KGMsXCIgY291bnQ6XCIpLmNvbmNhdCh1P3UubGVuZ3RoOjApO2lmKFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gXCIpLmNvbmNhdChkKSksby5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQobCxcIiBcIikuY29uY2F0KGQpKS5lbmQoKSwyPT09Y3x8enQodSkpe3ZhciBwPXQuX2NvbXB1dGVSZXN1bHQoKTtyZXR1cm4gWWEocCl9dmFyIGc9XCJcIi5jb25jYXQoRS5DT05WX0dST1VQKS5jb25jYXQoZS5ncm91cElEKSxoPXQuZ2V0TW9kdWxlKHFuKS5vblJvYW1pbmdNZXNzYWdlKHUsZywhMSksXz10Ll9jb21wdXRlUmVzdWx0KHtkaXJlY3Rpb246cixzZXF1ZW5jZTppLHJlbW90ZU1lc3NhZ2VMaXN0OnUscHJvY2Vzc2VkTWVzc2FnZUxpc3Q6aH0pO3JldHVybiBZYShfKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLHI9blswXSx1PW5bMV07by5zZXRFcnJvcihlLHIsdSkuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KHMsXCIgc2VxdWVuY2U6XCIpLmNvbmNhdChpLFwiIGNvdW50OlwiKS5jb25jYXQoYSkpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfY29tcHV0ZVJlc3VsdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXttZXNzYWdlTGlzdDpbXSxpc0NvbXBsZXRlZDohMSxuZXh0TWVzc2FnZVNlcTpcIlwifTtpZihpdChlKSlyZXR1cm4gdC5pc0NvbXBsZXRlZD0hMCx0O3ZhciBuPWUuZGlyZWN0aW9uLG89ZS5zZXF1ZW5jZSxzPWUucmVtb3RlTWVzc2FnZUxpc3QsYT12b2lkIDA9PT1zP1tdOnMsaT1lLnByb2Nlc3NlZE1lc3NhZ2VMaXN0LHI9dm9pZCAwPT09aT9bXTppLHU9YS5sZW5ndGg7cmV0dXJuIDE9PT1uPyh0Lm5leHRNZXNzYWdlU2VxPWFbMF0uc2VxdWVuY2UrMSxyLmZvckVhY2goKGZ1bmN0aW9uKGUpe2Uuc2VxdWVuY2U+PW8mJnQubWVzc2FnZUxpc3QucHVzaChlKX0pKSwwPT09dC5tZXNzYWdlTGlzdC5sZW5ndGgmJmFbMF0uc2VxdWVuY2U8byYmKHQuaXNDb21wbGV0ZWQ9ITAsdC5uZXh0TWVzc2FnZVNlcT1cIlwiKSx0KToodC5uZXh0TWVzc2FnZVNlcT1hW3UtMV0uc2VxdWVuY2UtMSx0Lm1lc3NhZ2VMaXN0PW0ociksMD09PXQubmV4dE1lc3NhZ2VTZXEmJih0LmlzQ29tcGxldGVkPSEwLHQubmV4dE1lc3NhZ2VTZXE9XCJcIiksdCl9fSx7a2V5Olwic2V0TWVzc2FnZVJlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5jb252ZXJzYXRpb25JRCxvPWUubGFzdE1lc3NhZ2VTZXEscz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnNldE1lc3NhZ2VSZWFkXCIpO1ZlLmwoXCJcIi5jb25jYXQocyxcIiBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KG4sXCIgbGFzdE1lc3NhZ2VTZXE6XCIpLmNvbmNhdChvKSksZXQobyl8fHRoaXMub3V0cHV0V2FybmluZyhcIkRvTm90TW9kaWZ5TGFzdFNlcVwiKTt2YXIgYT1uZXcgQWEoXCJzZXRHcm91cE1lc3NhZ2VSZWFkXCIpO2Euc2V0TWVzc2FnZShcIlwiLmNvbmNhdChuLFwiLVwiKS5jb25jYXQobykpO3ZhciBpPW4ucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIikscj12b2lkIDA7cmV0dXJuIGt0KGkpJiYoaT14dChyPWkpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpycyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDppLHRvcGljSUQ6cixtZXNzYWdlUmVhZFNlcTpvfX0pLnRoZW4oKGZ1bmN0aW9uKCl7YS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQocyxcIiBvay5cIikpO3ZhciBlPXQuZ2V0TW9kdWxlKHFuKTtlLnVwZGF0ZUlzUmVhZEFmdGVyUmVhZFJlcG9ydCh7Y29udmVyc2F0aW9uSUQ6bixsYXN0TWVzc2FnZVNlcTpvfSk7dmFyIHU9ITA7aWYoIWl0KHIpKXt1PSExO3ZhciBjPXQuZ2V0TW9kdWxlKEZuKS5nZXRMb2NhbFRvcGljKGkscik7YyYmYy51cGRhdGVTZWxmSW5mbyh7cmVhZGVkU2VxdWVuY2U6b30pfXJldHVybiBlLnVwZGF0ZVVucmVhZENvdW50KG4sdSksWWEoKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07YS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUubChcIlwiLmNvbmNhdChzLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcIl9jb21wdXRlTGFzdFNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cElELG49ZS50b3BpY0lELG89dm9pZCAwPT09bj92b2lkIDA6bixzPWUuc2VxdWVuY2U7cmV0dXJuIHM+MD9Qcm9taXNlLnJlc29sdmUocyk6aXQobyl8fHRoaXMuaGFzTG9jYWxHcm91cCh0KT9pdChvKT90aGlzLmdldEdyb3VwTGFzdFNlcXVlbmNlKHQpOnRoaXMuZ2V0VG9waWNMYXN0U2VxdWVuY2Uoe2dyb3VwSUQ6dCx0b3BpY0lEOm99KTpQcm9taXNlLnJlc29sdmUoMCl9fSx7a2V5OlwiZ2V0R3JvdXBMYXN0U2VxdWVuY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZ2V0R3JvdXBMYXN0U2VxdWVuY2VcIiksbz1uZXcgQWEoXCJnZXRHcm91cExhc3RTZXF1ZW5jZVwiKSxzPTAsYT1cIlwiO2lmKHRoaXMuaGFzTG9jYWxHcm91cChlKSl7dmFyIGk9dGhpcy5nZXRMb2NhbEdyb3VwUHJvZmlsZShlKSxyPWkubGFzdE1lc3NhZ2U7aWYoci5sYXN0U2VxdWVuY2U+MCYmITE9PT1yLm9ubGluZU9ubHlGbGFnKXJldHVybiBzPXIubGFzdFNlcXVlbmNlLGE9XCJnb3QgbGFzdFNlcXVlbmNlOlwiLmNvbmNhdChzLFwiIGZyb20gbG9jYWwgZ3JvdXAgcHJvZmlsZVtsYXN0TWVzc2FnZS5sYXN0U2VxdWVuY2VdLiBncm91cElEOlwiKS5jb25jYXQoZSksVmUubChcIlwiLmNvbmNhdChuLFwiIFwiKS5jb25jYXQoYSkpLG8uc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KGEpKS5lbmQoKSxQcm9taXNlLnJlc29sdmUocyk7aWYoaS5uZXh0TWVzc2FnZVNlcT4xKXJldHVybiBzPWkubmV4dE1lc3NhZ2VTZXEtMSxhPVwiZ290IGxhc3RTZXF1ZW5jZTpcIi5jb25jYXQocyxcIiBmcm9tIGxvY2FsIGdyb3VwIHByb2ZpbGVbbmV4dE1lc3NhZ2VTZXFdLiBncm91cElEOlwiKS5jb25jYXQoZSksVmUubChcIlwiLmNvbmNhdChuLFwiIFwiKS5jb25jYXQoYSkpLG8uc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KGEpKS5lbmQoKSxQcm9taXNlLnJlc29sdmUocyl9dmFyIHU9XCJHUk9VUFwiLmNvbmNhdChlKSxjPXRoaXMuZ2V0TW9kdWxlKHFuKS5nZXRMb2NhbENvbnZlcnNhdGlvbih1KTtpZihjJiZjLmxhc3RNZXNzYWdlLmxhc3RTZXF1ZW5jZSYmITE9PT1jLmxhc3RNZXNzYWdlLm9ubGluZU9ubHlGbGFnKXJldHVybiBzPWMubGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlLGE9XCJnb3QgbGFzdFNlcXVlbmNlOlwiLmNvbmNhdChzLFwiIGZyb20gbG9jYWwgY29udmVyc2F0aW9uIHByb2ZpbGVbbGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlXS4gZ3JvdXBJRDpcIikuY29uY2F0KGUpLFZlLmwoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KGEpKSxvLnNldE5ldHdvcmtUeXBlKHRoaXMuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChhKSkuZW5kKCksUHJvbWlzZS5yZXNvbHZlKHMpO3ZhciBsPXtncm91cElETGlzdDpbZV0scmVzcG9uc2VGaWx0ZXI6e2dyb3VwQmFzZUluZm9GaWx0ZXI6W1wiTmV4dE1zZ1NlcVwiXX19O3JldHVybiB0aGlzLmdldEdyb3VwUHJvZmlsZUFkdmFuY2UobCkudGhlbigoZnVuY3Rpb24oaSl7dmFyIHI9aS5kYXRhLnN1Y2Nlc3NHcm91cExpc3Q7cmV0dXJuIHp0KHIpP1ZlLmwoXCJcIi5jb25jYXQobixcIiBzdWNjZXNzR3JvdXBMaXN0IGlzIGVtcHR5LiBncm91cElEOlwiKS5jb25jYXQoZSkpOihzPXJbMF0ubmV4dE1lc3NhZ2VTZXEtMSxhPVwiZ290IGxhc3RTZXF1ZW5jZTpcIi5jb25jYXQocyxcIiBmcm9tIGdldEdyb3VwUHJvZmlsZUFkdmFuY2UuIGdyb3VwSUQ6XCIpLmNvbmNhdChlKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgXCIpLmNvbmNhdChhKSkpLG8uc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KGEpKS5lbmQoKSxzfSkpLmNhdGNoKChmdW5jdGlvbihzKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksYT1uWzBdLGk9blsxXTtvLnNldEVycm9yKHMsYSxpKS5zZXRNZXNzYWdlKFwiZ2V0IGxhc3RTZXF1ZW5jZSBmYWlsZWQgZnJvbSBnZXRHcm91cFByb2ZpbGVBZHZhbmNlLiBncm91cElEOlwiLmNvbmNhdChlKSkuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLHMpLFphKHMpfSkpfX0se2tleTpcImdldFRvcGljTGFzdFNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUuZ3JvdXBJRCxvPWUudG9waWNJRCxzPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImdldFRvcGljTGFzdFNlcXVlbmNlXCIpLGE9bmV3IEFhKFwiZ2V0VG9waWNMYXN0U2VxdWVuY2VcIiksaT0wLHI9XCJcIix1PXRoaXMuZ2V0TW9kdWxlKEZuKTtyZXR1cm4gdS5oYXNMb2NhbFRvcGljKG4sbyk/KGk9dS5nZXRMb2NhbFRvcGljKG4sbykubmV4dE1lc3NhZ2VTZXEtMSxyPVwiZ2V0IGxhc3RTZXF1ZW5jZTpcIi5jb25jYXQoaSxcIiBmcm9tIGxvY2FsIHRvcGljIGluZm9bbmV4dE1lc3NhZ2VTZXFdLiB0b3BpY0lEOlwiKS5jb25jYXQobyksVmUubChcIlwiLmNvbmNhdChzLFwiIFwiKS5jb25jYXQocikpLGEuc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KHIpKS5lbmQoKSxQcm9taXNlLnJlc29sdmUoaSkpOnUuZ2V0VG9waWNMaXN0KHtncm91cElEOm4sdG9waWNJRExpc3Q6W29dfSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG49ZS5kYXRhLnN1Y2Nlc3NUb3BpY0xpc3Q7cmV0dXJuIHp0KG4pP1ZlLmwoXCJcIi5jb25jYXQocyxcIiBzdWNjZXNzVG9waWNMaXN0IGlzIGVtcHR5LiB0b3BpY0lEOlwiKS5jb25jYXQobykpOihpPW5bMF0ubmV4dE1lc3NhZ2VTZXEtMSxyPVwiZ2V0IGxhc3RTZXF1ZW5jZTpcIi5jb25jYXQoaSxcIiBmcm9tIGdldFRvcGljTGlzdC4gdG9waWNJRDpcIikuY29uY2F0KG8pLFZlLmwoXCJcIi5jb25jYXQocyxcIiBcIikuY29uY2F0KHIpKSksYS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQocikpLmVuZCgpLGl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0saT1uWzFdO2Euc2V0RXJyb3IoZSxzLGkpLnNldE1lc3NhZ2UoXCJnZXQgbGFzdFNlcXVlbmNlIGZhaWxlZCBmcm9tIGdldFRvcGljTGlzdC4gdG9waWNJRDpcIi5jb25jYXQobykpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQocyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJpc01lc3NhZ2VGcm9tT3JUb0FWQ2hhdHJvb21cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4hIXRoaXMuX0FWQ2hhdFJvb21IYW5kbGVyJiZ0aGlzLl9BVkNoYXRSb29tSGFuZGxlci5jaGVja0pvaW5lZEFWQ2hhdFJvb21CeUlEKGUpfX0se2tleTpcImhhc0pvaW5lZEFWQ2hhdFJvb21cIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9BVkNoYXRSb29tSGFuZGxlcj90aGlzLl9BVkNoYXRSb29tSGFuZGxlci5oYXNKb2luZWRBVkNoYXRSb29tKCk6MH19LHtrZXk6XCJnZXRKb2luZWRBVkNoYXRSb29tXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXI/dGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIuZ2V0Sm9pbmVkQVZDaGF0Um9vbSgpOltdfX0se2tleTpcImlzT25saW5lTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuISghdGhpcy5fY2FuSVVzZU9ubGluZU9ubHlGbGFnKGUpfHwhdHx8ITAhPT10Lm9ubGluZVVzZXJPbmx5KX19LHtrZXk6XCJfY2FuSVVzZU9ubGluZU9ubHlGbGFnXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRKb2luZWRBVkNoYXRSb29tKCk7cmV0dXJuIXR8fCF0LmluY2x1ZGVzKGUudG8pfHxlLmNvbnZlcnNhdGlvblR5cGUhPT1FLkNPTlZfR1JPVVB9fSx7a2V5OlwiX29uQVZDaGF0Um9vbUhpc3RvcnlNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoIXp0KGUpKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uQVZDaGF0Um9vbUhpc3RvcnlNZXNzYWdlIGNvdW50OlwiKS5jb25jYXQoZS5sZW5ndGgpKTt2YXIgbj1bXTtlLmZvckVhY2goKGZ1bmN0aW9uKGUpe24ucHVzaCh0KHQoe30sZSkse30se2lzSGlzdG9yeU1lc3NhZ2U6MX0pKX0pKSx0aGlzLm9uQVZDaGF0Um9vbU1lc3NhZ2Uobil9fX0se2tleTpcIm9uQVZDaGF0Um9vbU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9BVkNoYXRSb29tSGFuZGxlciYmdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIub25NZXNzYWdlKGUpfX0se2tleTpcIm9uQVZDaGF0Um9vbU1lbWJlckJhbm5lZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX0FWQ2hhdFJvb21IYW5kbGVyJiZ0aGlzLl9BVkNoYXRSb29tSGFuZGxlci5vbkFWQ2hhdFJvb21NZW1iZXJCYW5uZWQoZSl9fSx7a2V5OlwiZ2V0R3JvdXBTaW1wbGlmaWVkSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1uZXcgQWEoXCJnZXRHcm91cFNpbXBsaWZpZWRJbmZvXCIpLG89e2dyb3VwSURMaXN0OltlXSxyZXNwb25zZUZpbHRlcjp7Z3JvdXBCYXNlSW5mb0ZpbHRlcjpbXCJUeXBlXCIsXCJOYW1lXCJdfX07cmV0dXJuIHRoaXMuZ2V0R3JvdXBQcm9maWxlQWR2YW5jZShvKS50aGVuKChmdW5jdGlvbihvKXt2YXIgcz1vLmRhdGEuc3VjY2Vzc0dyb3VwTGlzdDtyZXR1cm4gbi5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChlLFwiIHR5cGU6XCIpLmNvbmNhdChzWzBdLnR5cGUpKS5lbmQoKSxzWzBdfSkpLmNhdGNoKChmdW5jdGlvbihvKXt0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBzPXYodCwyKSxhPXNbMF0saT1zWzFdO24uc2V0RXJyb3IobyxhLGkpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChlKSkuZW5kKCl9KSl9KSl9fSx7a2V5Olwic2V0VW5qb2luZWRBVkNoYXRSb29tXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fdW5qb2luZWRBVkNoYXRSb29tTGlzdC5zZXQoZSwxKX19LHtrZXk6XCJkZWxldGVVbmpvaW5lZEFWQ2hhdFJvb21cIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl91bmpvaW5lZEFWQ2hhdFJvb21MaXN0LmhhcyhlKSYmdGhpcy5fdW5qb2luZWRBVkNoYXRSb29tTGlzdC5kZWxldGUoZSl9fSx7a2V5OlwiaXNVbmpvaW5lZEFWQ2hhdFJvb21cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fdW5qb2luZWRBVkNoYXRSb29tTGlzdC5oYXMoZSl9fSx7a2V5OlwiaXNHcm91cEF0dHJpYnV0ZXNVcGRhdGVkTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dyb3VwQXR0cmlidXRlc0hhbmRsZXIuaXNHcm91cEF0dHJpYnV0ZXNVcGRhdGVkTm90aWNlKGUpfX0se2tleTpcInVwZGF0ZUxvY2FsTWFpblNlcXVlbmNlT25SZWNvbm5lY3RlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZ3JvdXBBdHRyaWJ1dGVzSGFuZGxlci51cGRhdGVMb2NhbE1haW5TZXF1ZW5jZU9uUmVjb25uZWN0ZWQoKX19LHtrZXk6XCJpbml0R3JvdXBBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dyb3VwQXR0cmlidXRlc0hhbmRsZXIuaW5pdEdyb3VwQXR0cmlidXRlcyhlKX19LHtrZXk6XCJzZXRHcm91cEF0dHJpYnV0ZXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ3JvdXBBdHRyaWJ1dGVzSGFuZGxlci5zZXRHcm91cEF0dHJpYnV0ZXMoZSl9fSx7a2V5OlwiZGVsZXRlR3JvdXBBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dyb3VwQXR0cmlidXRlc0hhbmRsZXIuZGVsZXRlR3JvdXBBdHRyaWJ1dGVzKGUpfX0se2tleTpcImdldEdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9ncm91cEF0dHJpYnV0ZXNIYW5kbGVyLmdldEdyb3VwQXR0cmlidXRlcyhlKX19LHtrZXk6XCJpc01lc3NhZ2VGcm9tVG9waWNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiAyPT09ZSYmIXp0KHQpfX0se2tleTpcImlzTWVzc2FnZUZyb21Db21tdW5pdHlPZlRvcGljXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gMj09PWUmJnp0KHQpfX0se2tleTpcImdldE1lc3NhZ2VFeHRlbnNpb25zXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldE1lc3NhZ2VFeHRlbnNpb25zIHN0YXJ0U2VxdWVuY2U6XCIpLmNvbmNhdCh0KSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6U3MscmVxdWVzdERhdGE6e2dyb3VwSUQ6ZS50byxtZXNzYWdlU2VxdWVuY2U6ZS5zZXF1ZW5jZSxzdGFydFNlcXVlbmNlOnR9fSl9fSx7a2V5OlwibW9kaWZ5TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXToxO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIubW9kaWZ5TWVzc2FnZUV4dGVuc2lvbnMgb3BlcmF0ZVR5cGU6XCIpLmNvbmNhdChuKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6RXMscmVxdWVzdERhdGE6e2dyb3VwSUQ6ZS50byxtZXNzYWdlU2VxdWVuY2U6ZS5zZXF1ZW5jZSxleHRlbnNpb25MaXN0OnQsb3BlcmF0ZVR5cGU6bn19KX19LHtrZXk6XCJnZXRHcm91cE5vdGlmeVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXM7aWYodGhpcy5oYXNMb2NhbEdyb3VwKGUpKXt2YXIgbz10aGlzLmdldExvY2FsR3JvdXBQcm9maWxlKGUpLHM9by50eXBlLGE9by5pc1N1cHBvcnRUb3BpYztpZighVHQocykmJiFhKXt2YXIgaT1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldEdyb3VwTm90aWZ5XCIpLHI9dGhpcy5fZ2V0R3JvdXBMYXN0UmV2b2tlZFRpbWUoZSksdT0xZTMqUGUoKTtWZS5sKFwiXCIuY29uY2F0KGksXCIgZ3JvdXBJRDpcIikuY29uY2F0KGUsXCIgdHlwZTpcIikuY29uY2F0KHMsXCIgYmVnaW5UaW1lOlwiKS5jb25jYXQocixcIiBlbmRUaW1lOlwiKS5jb25jYXQodSkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkxzLHJlcXVlc3REYXRhOnt0eXBlOkR0KHt0eXBlOnMsZ3JvdXBJRDplfSk/RS5HUlBfQ09NTVVOSVRZOnZvaWQgMCxncm91cElEOmUsYmVnaW5UaW1lOnIsZW5kVGltZTp1fX0pLnRoZW4oKGZ1bmN0aW9uKG8pe3ZhciBzPW8uZGF0YSxhPXMubmV4dFJldm9rZWRUaW1lLHI9cy5ub3RpZnlMaXN0O1ZlLmwoXCJcIi5jb25jYXQoaSxcIiBvay4gZ3JvdXBJRDpcIikuY29uY2F0KGUsXCIgbmV4dFJldm9rZWRUaW1lOlwiKS5jb25jYXQoYSkpO3ZhciB1PXtkYXRhTGlzdDpbe2VsZW1lbnRzOntyZXZva2VkSW5mb3M6W119fV19O2F0KHIpJiZyLmZvckVhY2goKGZ1bmN0aW9uKG4pe3UuZGF0YUxpc3RbMF0uZWxlbWVudHMucmV2b2tlZEluZm9zLnB1c2goe2dyb3VwSUQ6ZSxzZXF1ZW5jZTpuLnNlcXVlbmNlLHJhbmRvbTpuLnJhbmRvbSxyZXZva2VySW5mbzp0KHt9LG4ucmV2b2tlckluZm8pfSl9KSksbi5vbkdyb3VwTWVzc2FnZVJldm9rZWQodSksMCE9PWE/KG4uX3NldEdyb3VwTGFzdFJldm9rZWRUaW1lKGUsYSksbi5nZXRHcm91cE5vdGlmeShlKSk6bi5fc2V0R3JvdXBMYXN0UmV2b2tlZFRpbWUoZSwxZTMqUGUoKSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe1ZlLmUoXCJcIi5jb25jYXQoaSxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKX0pKX19fX0se2tleTpcIl9nZXRHcm91cExhc3RSZXZva2VkVGltZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmhhc0xvY2FsR3JvdXAoZSk/dGhpcy5nZXRMb2NhbEdyb3VwUHJvZmlsZShlKS5fbGFzdFJldm9rZWRUaW1lOjB9fSx7a2V5OlwiX3NldEdyb3VwTGFzdFJldm9rZWRUaW1lXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLmhhc0xvY2FsR3JvdXAoZSkmJih0aGlzLmdldExvY2FsR3JvdXBQcm9maWxlKGUpLl9sYXN0UmV2b2tlZFRpbWU9dCl9fSx7a2V5OlwiaXNHcm91cENvdW50ZXJzTm90aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dyb3VwQ291bnRlcnNIYW5kbGVyLmlzR3JvdXBDb3VudGVyc05vdGljZShlKX19LHtrZXk6XCJzZXRHcm91cENvdW50ZXJzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dyb3VwQ291bnRlcnNIYW5kbGVyLnNldEdyb3VwQ291bnRlcnMoZSl9fSx7a2V5OlwiaW5jcmVhc2VHcm91cENvdW50ZXJcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ3JvdXBDb3VudGVyc0hhbmRsZXIuaW5jcmVhc2VHcm91cENvdW50ZXIoZSl9fSx7a2V5OlwiZGVjcmVhc2VHcm91cENvdW50ZXJcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ3JvdXBDb3VudGVyc0hhbmRsZXIuZGVjcmVhc2VHcm91cENvdW50ZXIoZSl9fSx7a2V5OlwiZ2V0R3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9ncm91cENvdW50ZXJzSGFuZGxlci5nZXRHcm91cENvdW50ZXJzKGUpfX0se2tleTpcInJlc3RhcnRQb2xsaW5nXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9BVkNoYXRSb29tSGFuZGxlciYmdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIucmVzdGFydFBvbGxpbmcoKX19LHtrZXk6XCJnZXRQb2xsaW5nVGltZXJJRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybi0xO3ZhciB0PXRoaXMuZ2V0TG9jYWxHcm91cFByb2ZpbGUoZSk7cmV0dXJuIHQmJlR0KHQudHlwZSk/dGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIuZ2V0UG9sbGluZ1RpbWVySUQoZSk6LTF9fSx7a2V5OlwiX2NhbklVc2VKb2luT3B0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBlPT09RS5HUlBfUFVCTElDfShlKXx8RHQoe3R5cGU6ZX0pfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLmdyb3VwTWFwLmNsZWFyKCksdGhpcy5fdW5qb2luZWRBVkNoYXRSb29tTGlzdC5jbGVhcigpLHRoaXMuX3JlY2VpcHREZXRhaWxDb21wbGV0ZU1hcC5jbGVhcigpLHRoaXMuX2NvbW1vbkdyb3VwSGFuZGxlci5yZXNldCgpLHRoaXMuX2dyb3VwU3lzdGVtTm90aWNlSGFuZGxlci5yZXNldCgpLHRoaXMuX2dyb3VwVGlwc0hhbmRsZXIucmVzZXQoKSx0aGlzLl9ncm91cEF0dHJpYnV0ZXNIYW5kbGVyLnJlc2V0KCksdGhpcy5fZ3JvdXBDb3VudGVyc0hhbmRsZXIucmVzZXQoKSx0aGlzLl9BVkNoYXRSb29tSGFuZGxlciYmdGhpcy5fQVZDaGF0Um9vbUhhbmRsZXIucmVzZXQoKX19XSksc30odW8pLHhpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy51c2VySUQ9XCJcIix0aGlzLmF2YXRhcj1cIlwiLHRoaXMubmljaz1cIlwiLHRoaXMucm9sZT1cIlwiLHRoaXMuam9pblRpbWU9XCJcIix0aGlzLmxhc3RTZW5kTXNnVGltZT1cIlwiLHRoaXMubmFtZUNhcmQ9XCJcIix0aGlzLm11dGVVbnRpbD0wLHRoaXMubWVtYmVyQ3VzdG9tRmllbGQ9W10sdGhpcy5faW5pdE1lbWJlcih0KX1yZXR1cm4gYShlLFt7a2V5OlwiX2luaXRNZW1iZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLnVwZGF0ZU1lbWJlcihlKX19LHtrZXk6XCJ1cGRhdGVNZW1iZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1bbnVsbCx2b2lkIDAsXCJcIiwwLE5hTl07ZS5tZW1iZXJDdXN0b21GaWVsZCYmQ3QodGhpcy5tZW1iZXJDdXN0b21GaWVsZCxlLm1lbWJlckN1c3RvbUZpZWxkKSxwdCh0aGlzLGUsW1wibWVtYmVyQ3VzdG9tRmllbGRcIixcIm1hcmtzXCJdLHQpfX0se2tleTpcInVwZGF0ZVJvbGVcIix2YWx1ZTpmdW5jdGlvbihlKXtbXCJPd25lclwiLFwiQWRtaW5cIixcIk1lbWJlclwiXS5pbmRleE9mKGUpPDB8fCh0aGlzLnJvbGU9ZSl9fSx7a2V5OlwidXBkYXRlTXV0ZVVudGlsXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aXQoZSl8fCh0aGlzLm11dGVVbnRpbD1NYXRoLmZsb29yKChEYXRlLm5vdygpKzFlMyplKS8xZTMpKX19LHtrZXk6XCJ1cGRhdGVOYW1lQ2FyZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2l0KGUpfHwodGhpcy5uYW1lQ2FyZD1lKX19LHtrZXk6XCJ1cGRhdGVNZW1iZXJDdXN0b21GaWVsZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UmJkN0KHRoaXMubWVtYmVyQ3VzdG9tRmllbGQsZSl9fV0pLGV9KCksVmk9ZnVuY3Rpb24oZSl7cihzLGUpO3ZhciBuPWYocyk7ZnVuY3Rpb24gcyhlKXt2YXIgdDtyZXR1cm4gbyh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIkdyb3VwTWVtYmVyTW9kdWxlXCIsdC5ncm91cE1lbWJlckxpc3RNYXA9bmV3IE1hcCx0LmdldElubmVyRW1pdHRlckluc3RhbmNlKCkub24obmksdC5fb25Qcm9maWxlVXBkYXRlZCxoKHQpKSx0fXJldHVybiBhKHMsW3trZXk6XCJfb25Qcm9maWxlVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD10aGlzLG49ZS5kYXRhLG89ZnVuY3Rpb24oZSl7dmFyIG89bltlXTt0Lmdyb3VwTWVtYmVyTGlzdE1hcC5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmhhcyhvLnVzZXJJRCkmJmUuZ2V0KG8udXNlcklEKS51cGRhdGVNZW1iZXIoe25pY2s6by5uaWNrLGF2YXRhcjpvLmF2YXRhcn0pfSkpfSxzPTA7czxuLmxlbmd0aDtzKyspbyhzKX19LHtrZXk6XCJkZWxldGVHcm91cE1lbWJlckxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmdyb3VwTWVtYmVyTGlzdE1hcC5kZWxldGUoZSl9fSx7a2V5OlwiZ2V0R3JvdXBNZW1iZXJMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUuZ3JvdXBJRCxvPWUub2Zmc2V0LHM9dm9pZCAwPT09bz8wOm8sYT1lLmNvdW50LGk9dm9pZCAwPT09YT8xNTphLHI9ZS5maWx0ZXIsdT12b2lkIDA9PT1yP3ZvaWQgMDpyLGM9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZ2V0R3JvdXBNZW1iZXJMaXN0XCIpLGw9dGhpcy5nZXRNb2R1bGUoUG4pLGQ9bC5oYXNMb2NhbEdyb3VwKG4pO2lmKFZlLmwoXCJcIi5jb25jYXQoYyxcIiBncm91cElEOlwiKS5jb25jYXQobixcIiBvZmZzZXQ6XCIpLmNvbmNhdChzLFwiIGNvdW50OlwiKS5jb25jYXQoaSxcIiBoYXNMb2NhbEdyb3VwOlwiKS5jb25jYXQoZCkpLCFkKXJldHVybiBYYSh7bWVtYmVyTGlzdDpbXSxvZmZzZXQ6MH0pO2lmKGwuZ2V0TG9jYWxHcm91cFByb2ZpbGUobikudHlwZT09PUUuR1JQX0FWQ0hBVFJPT00pe2lmKHRoaXMuY2FuSVVzZShCLkFWQ0hBVFJPT01fTUJSX0xJU1QpKXJldHVybiB0aGlzLl9nZXRBVkNoYXRSb29tTWVtYmVyTGlzdCh7Z3JvdXBJRDpuLG9mZnNldDpzLGZpbHRlcjp1fSk7dGhpcy5vdXRwdXRXYXJuaW5nKFwiTGl2ZU9ubGluZU1lbWJlclwiKX12YXIgcD1uZXcgQWEoXCJnZXRHcm91cE1lbWJlckxpc3RcIiksZz0wLGg9e2dyb3VwSUQ6bixsaW1pdDppPjEwMD8xMDA6aX07RHQoe2dyb3VwSUQ6bn0pP2gubmV4dD1cIlwiLmNvbmNhdChzKTooaC5vZmZzZXQ9cyxnPXMraSk7dmFyIF89W107cmV0dXJuIHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOk5zLHJlcXVlc3REYXRhOmh9KS50aGVuKChmdW5jdGlvbihlKXt2YXIgbz1lLmRhdGEscz1vLm1lbWJlcnMsYT1vLm1lbWJlck51bSxpPW8ubmV4dCxyPXZvaWQgMD09PWk/dm9pZCAwOmk7aWYoaXQocil8fChnPXp0KHIpPzA6ciksIWF0KHMpfHwwPT09cy5sZW5ndGgpcmV0dXJuIGc9MCxQcm9taXNlLnJlc29sdmUoW10pO3ZhciB1PXQuZ2V0TW9kdWxlKFBuKTtyZXR1cm4gdS5oYXNMb2NhbEdyb3VwKG4pJiYodS5nZXRMb2NhbEdyb3VwUHJvZmlsZShuKS5tZW1iZXJOdW09YSksXz10Ll91cGRhdGVMb2NhbEdyb3VwTWVtYmVyTWFwKG4scyksdC5nZXRNb2R1bGUoR24pLmdldFVzZXJQcm9maWxlKHt1c2VySURMaXN0OnMubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS51c2VySUR9KSksdGFnTGlzdDpbSGUuTklDSyxIZS5BVkFUQVJdfSl9KSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89ZS5kYXRhO2lmKCFhdChvKXx8MD09PW8ubGVuZ3RoKXJldHVybiBYYSh7bWVtYmVyTGlzdDpbXSxvZmZzZXQ6Z30pO3ZhciBhPW8ubWFwKChmdW5jdGlvbihlKXtyZXR1cm57dXNlcklEOmUudXNlcklELG5pY2s6ZS5uaWNrLGF2YXRhcjplLmF2YXRhcn19KSk7cmV0dXJuIHQuX3VwZGF0ZUxvY2FsR3JvdXBNZW1iZXJNYXAobixhKSxfLmxlbmd0aDxpJiYoZz0wKSxwLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG4sXCIgb2Zmc2V0OlwiKS5jb25jYXQocyxcIiBjb3VudDpcIikuY29uY2F0KGkpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KGMsXCIgb2suXCIpKSxZYSh7bWVtYmVyTGlzdDpfLG9mZnNldDpnfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO3Auc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQoYyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfZ2V0QVZDaGF0Um9vbU1lbWJlckxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ncm91cElELG89ZS5vZmZzZXQscz1lLmZpbHRlcixhPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcIl9nZXRBVkNoYXRSb29tTWVtYmVyTGlzdFwiKSxpPW5ldyBBYShcIl9nZXRBVkNoYXRSb29tTWVtYmVyTGlzdFwiKTtyZXR1cm4gaS5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQobixcIiBvZmZzZXQ6XCIpLmNvbmNhdChvLFwiIGZpbHRlcjpcIikuY29uY2F0KHMpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpPcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDpuLG9mZnNldDpvLGZpbHRlcjpzfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBvPWUuZGF0YSxzPW8ubWVtYmVyTGlzdCxyPXZvaWQgMD09PXM/W106cyx1PW8ub2Zmc2V0LGM9dm9pZCAwPT09dT8wOnU7aS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQoYSxcIiBvay4gbWVtYmVyIGNvdW50OlwiKS5jb25jYXQoci5sZW5ndGgsXCIsIG5leHQgcmVxdWVzdCB0aW1lc3RhbXA6XCIpLmNvbmNhdChjKSk7dmFyIGw9dC5fdXBkYXRlTG9jYWxHcm91cE1lbWJlck1hcChuLHIpO3JldHVybiBZYSh7bWVtYmVyTGlzdDpsLG9mZnNldDpjfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2kuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQoYSxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJnZXRHcm91cE1lbWJlclByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLG89XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZ2V0R3JvdXBNZW1iZXJQcm9maWxlXCIpLHM9bmV3IEFhKFwiZ2V0R3JvdXBNZW1iZXJQcm9maWxlXCIpO3Muc2V0TWVzc2FnZShlLnVzZXJJRExpc3QubGVuZ3RoPjU/XCJ1c2VySURMaXN0Lmxlbmd0aDpcIi5jb25jYXQoZS51c2VySURMaXN0Lmxlbmd0aCk6XCJ1c2VySURMaXN0OlwiLmNvbmNhdChlLnVzZXJJRExpc3QpKSxWZS5sKFwiXCIuY29uY2F0KG8sXCIgZ3JvdXBJRDpcIikuY29uY2F0KGUuZ3JvdXBJRCxcIiB1c2VySURMaXN0OlwiKS5jb25jYXQoZS51c2VySURMaXN0LmpvaW4oXCIsXCIpKSksZS51c2VySURMaXN0Lmxlbmd0aD41MCYmKGUudXNlcklETGlzdD1lLnVzZXJJRExpc3Quc2xpY2UoMCw1MCkpO3ZhciBhPWUuZ3JvdXBJRCxpPWUudXNlcklETGlzdDtyZXR1cm4gdGhpcy5fZ2V0R3JvdXBNZW1iZXJQcm9maWxlQWR2YW5jZSh0KHQoe30sZSkse30se3VzZXJJRExpc3Q6aX0pKS50aGVuKChmdW5jdGlvbihlKXt2YXIgdD1lLmRhdGEubWVtYmVycztyZXR1cm4gYXQodCkmJjAhPT10Lmxlbmd0aD8obi5fdXBkYXRlTG9jYWxHcm91cE1lbWJlck1hcChhLHQpLG4uZ2V0TW9kdWxlKEduKS5nZXRVc2VyUHJvZmlsZSh7dXNlcklETGlzdDp0Lm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUudXNlcklEfSkpLHRhZ0xpc3Q6W0hlLk5JQ0ssSGUuQVZBVEFSXX0pKTpYYShbXSl9KSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5kYXRhLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJue3VzZXJJRDplLnVzZXJJRCxuaWNrOmUubmljayxhdmF0YXI6ZS5hdmF0YXJ9fSkpO24uX3VwZGF0ZUxvY2FsR3JvdXBNZW1iZXJNYXAoYSx0KTt2YXIgbz1pLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIG4uaGFzTG9jYWxHcm91cE1lbWJlcihhLGUpfSkpLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIG4uZ2V0TG9jYWxHcm91cE1lbWJlckluZm8oYSxlKX0pKTtyZXR1cm4gcy5zZXROZXR3b3JrVHlwZShuLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFlhKHttZW1iZXJMaXN0Om99KX0pKX19LHtrZXk6XCJhZGRHcm91cE1lbWJlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJhZGRHcm91cE1lbWJlclwiKSxvPWUuZ3JvdXBJRCxzPXRoaXMuZ2V0TW9kdWxlKFBuKS5nZXRMb2NhbEdyb3VwUHJvZmlsZShvKSxhPXMudHlwZSxpPW5ldyBBYShcImFkZEdyb3VwTWVtYmVyXCIpO2lmKGkuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgZ3JvdXBUeXBlOlwiKS5jb25jYXQoYSkpLFR0KGEpKXt2YXIgcj1uZXcgamEoe2NvZGU6aGEuQ0FOTk9UX0FERF9NRU1CRVJfSU5fQVZDSEFUUk9PTX0pO3JldHVybiBpLnNldEVycm9yKHIsITAsdGhpcy5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxaYShyKX1yZXR1cm4gZS51c2VySURMaXN0PWUudXNlcklETGlzdC5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybnt1c2VySUQ6ZX19KSksVmUubChcIlwiLmNvbmNhdChuLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChvKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6VXMscmVxdWVzdERhdGE6ZX0pLnRoZW4oKGZ1bmN0aW9uKG8pe3ZhciBhPW8uZGF0YS5tZW1iZXJzO1ZlLmwoXCJcIi5jb25jYXQobixcIiBva1wiKSk7dmFyIHI9YS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5yZXN1bHR9KSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS51c2VySUR9KSksdT1hLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIDA9PT1lLnJlc3VsdH0pKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnVzZXJJRH0pKSxjPWEuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gMj09PWUucmVzdWx0fSkpLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUudXNlcklEfSkpLGw9YS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiA0PT09ZS5yZXN1bHR9KSkubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZS51c2VySUR9KSksZD1cImdyb3VwSUQ6XCIuY29uY2F0KGUuZ3JvdXBJRCxcIiwgXCIpK1wic3VjY2Vzc1VzZXJJRExpc3Q6XCIuY29uY2F0KHIsXCIsIFwiKStcImZhaWx1cmVVc2VySURMaXN0OlwiLmNvbmNhdCh1LFwiLCBcIikrXCJleGlzdGVkVXNlcklETGlzdDpcIi5jb25jYXQoYyxcIiwgXCIpK1wib3ZlckxpbWl0VXNlcklETGlzdDpcIi5jb25jYXQobCk7cmV0dXJuIGkuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNb3JlTWVzc2FnZShkKS5lbmQoKSwwPT09ci5sZW5ndGg/WWEoe3N1Y2Nlc3NVc2VySURMaXN0OnIsZmFpbHVyZVVzZXJJRExpc3Q6dSxleGlzdGVkVXNlcklETGlzdDpjLG92ZXJMaW1pdFVzZXJJRExpc3Q6bH0pOihzLm1lbWJlckNvdW50Kz1yLmxlbmd0aCx0Ll91cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUocyksWWEoe3N1Y2Nlc3NVc2VySURMaXN0OnIsZmFpbHVyZVVzZXJJRExpc3Q6dSxleGlzdGVkVXNlcklETGlzdDpjLG92ZXJMaW1pdFVzZXJJRExpc3Q6bCxncm91cDpzfSkpfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiZGVsZXRlR3JvdXBNZW1iZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZGVsZXRlR3JvdXBNZW1iZXJcIiksbz1lLmdyb3VwSUQscz1lLnVzZXJJRExpc3QsYT10aGlzLmdldE1vZHVsZShQbikuZ2V0TG9jYWxHcm91cFByb2ZpbGUobyk7aWYoaXQoYSkpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX0dST1VQfSk7aWYoVHQoYS50eXBlKSlyZXR1cm4gdGhpcy5jYW5JVXNlKEIuQVZDSEFUUk9PTV9CQU5fTUJSKT90aGlzLl9iYW5BVkNoYXRSb29tTWVtYmVyKGUpOlphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7dmFyIGk9bmV3IEFhKFwiZGVsZXRlR3JvdXBNZW1iZXJcIikscj1cImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgXCIpLmNvbmNhdChzLmxlbmd0aD41P1widXNlcklETGlzdC5sZW5ndGg6XCIuY29uY2F0KHMubGVuZ3RoKTpcInVzZXJJRExpc3Q6XCIuY29uY2F0KHMpKTtyZXR1cm4gaS5zZXRNZXNzYWdlKHIpLFZlLmwoXCJcIi5jb25jYXQobixcIiBncm91cElEOlwiKS5jb25jYXQobyxcIiB1c2VySURMaXN0OlwiKSxzKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpQcyxyZXF1ZXN0RGF0YTplfSkudGhlbigoZnVuY3Rpb24oKXtyZXR1cm4gaS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBva1wiKSksYS5tZW1iZXJDb3VudC09MSx0Ll91cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUoYSksdC5kZWxldGVMb2NhbEdyb3VwTWVtYmVycyhvLHMpLFlhKHtncm91cDphLHVzZXJJRExpc3Q6c30pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiX3VwZGF0ZUNvbnZlcnNhdGlvbkdyb3VwUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZ2V0TW9kdWxlKHFuKS51cGRhdGVDb252ZXJzYXRpb25Hcm91cFByb2ZpbGUoW2VdKX19LHtrZXk6XCJfYmFuQVZDaGF0Um9vbU1lbWJlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJkZWxldGVHcm91cE1lbWJlclwiKSxvPWUuZ3JvdXBJRCxzPWUudXNlcklETGlzdCxhPVwiZ3JvdXBJRDpcIi5jb25jYXQobyxcIiBcIikuY29uY2F0KHMubGVuZ3RoPjU/XCJ1c2VySURMaXN0Lmxlbmd0aDpcIi5jb25jYXQocy5sZW5ndGgpOlwidXNlcklETGlzdDpcIi5jb25jYXQocykpLGk9bmV3IEFhKFwiZGVsZXRlR3JvdXBNZW1iZXJcIik7aS5zZXRNZXNzYWdlKGEpLFZlLmwoXCJcIi5jb25jYXQobixcIiBncm91cElEOlwiKS5jb25jYXQobyxcIiB1c2VySURMaXN0OlwiKSxzKTt2YXIgcj10aGlzLmdldE1vZHVsZShQbikuZ2V0TG9jYWxHcm91cFByb2ZpbGUobyk7cmV0dXJuIGl0KGUuZHVyYXRpb24pfHwwPT09ZS5kdXJhdGlvbj9aYSh7Y29kZTpoYS5CQU5fRFVSQVRJT05fSU5WQUxJRH0pOnRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmJzLHJlcXVlc3REYXRhOmV9KS50aGVuKChmdW5jdGlvbigpe3JldHVybiBpLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKSx0LmRlbGV0ZUxvY2FsR3JvdXBNZW1iZXJzKG8scyksWWEoe2dyb3VwOnIsdXNlcklETGlzdDpzfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2kuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJzZXRHcm91cE1lbWJlck11dGVUaW1lXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUuZ3JvdXBJRCxvPWUudXNlcklELHM9ZS5tdXRlVGltZSxhPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInNldEdyb3VwTWVtYmVyTXV0ZVRpbWVcIik7aWYobz09PXRoaXMuZ2V0TXlVc2VySUQoKSlyZXR1cm4gWmEobmV3IGphKHtjb2RlOmhhLkNBTk5PVF9NVVRFX1NFTEZ9KSk7VmUubChcIlwiLmNvbmNhdChhLFwiIGdyb3VwSUQ6XCIpLmNvbmNhdChuLFwiIHVzZXJJRDpcIikuY29uY2F0KG8pKTt2YXIgaT1uZXcgQWEoXCJzZXRHcm91cE1lbWJlck11dGVUaW1lXCIpO3JldHVybiBpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChuLFwiIHVzZXJJRDpcIikuY29uY2F0KG8sXCIgbXV0ZVRpbWU6XCIpLmNvbmNhdChzKSksdGhpcy5tb2RpZnlHcm91cE1lbWJlckluZm8oe2dyb3VwSUQ6bix1c2VySUQ6byxtdXRlVGltZTpzfSkudGhlbigoZnVuY3Rpb24oZSl7aS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQoYSxcIiBva1wiKSk7dmFyIG89dC5nZXRNb2R1bGUoUG4pO3JldHVybiBZYSh7Z3JvdXA6by5nZXRMb2NhbEdyb3VwUHJvZmlsZShuKSxtZW1iZXI6ZX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KGEsXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5Olwic2V0R3JvdXBNZW1iZXJSb2xlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInNldEdyb3VwTWVtYmVyUm9sZVwiKSxvPWUuZ3JvdXBJRCxzPWUudXNlcklELGE9ZS5yb2xlLGk9dGhpcy5nZXRNb2R1bGUoUG4pLmdldExvY2FsR3JvdXBQcm9maWxlKG8pO2lmKGkuc2VsZkluZm8ucm9sZSE9PUUuR1JQX01CUl9ST0xFX09XTkVSKXJldHVybiBaYSh7Y29kZTpoYS5OT1RfT1dORVJ9KTtpZihbRS5HUlBfV09SSyxFLkdSUF9BVkNIQVRST09NXS5pbmNsdWRlcyhpLnR5cGUpKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfU0VUX01FTUJFUl9ST0xFX0lOX1dPUktfQU5EX0FWQ0hBVFJPT019KTt2YXIgcj1bRS5HUlBfTUJSX1JPTEVfQURNSU4sRS5HUlBfTUJSX1JPTEVfTUVNQkVSXTtpZihEdCh7Z3JvdXBJRDpvfSkmJnIucHVzaChFLkdSUF9NQlJfUk9MRV9DVVNUT00pLHIuaW5kZXhPZihhKTwwKXJldHVybiBaYSh7Y29kZTpoYS5JTlZBTElEX01FTUJFUl9ST0xFfSk7aWYocz09PXRoaXMuZ2V0TXlVc2VySUQoKSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX1NFVF9TRUxGX01FTUJFUl9ST0xFfSk7dmFyIHU9bmV3IEFhKFwic2V0R3JvdXBNZW1iZXJSb2xlXCIpO3JldHVybiB1LnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChvLFwiIHVzZXJJRDpcIikuY29uY2F0KHMsXCIgcm9sZTpcIikuY29uY2F0KGEpKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgZ3JvdXBJRDpcIikuY29uY2F0KG8sXCIgdXNlcklEOlwiKS5jb25jYXQocykpLHRoaXMubW9kaWZ5R3JvdXBNZW1iZXJJbmZvKHtncm91cElEOm8sdXNlcklEOnMscm9sZTphfSkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuIHUuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpLFlhKHtncm91cDppLG1lbWJlcjplfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO3Uuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfZmlsdGVyUHJvZmFuaXR5XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdldE1vZHVsZShvbyk7aWYoIW4pcmV0dXJuITA7dmFyIG89bi5maWx0ZXJUZXh0KHRbZV0sSikscz1vLmlzQWxsb3dlZFRvU2VuZCxhPW8ubW9kaWZpZWRUZXh0O3JldHVybiEwPT09cyYmKHRbZV09YSwhMCl9fSx7a2V5Olwic2V0R3JvdXBNZW1iZXJOYW1lQ2FyZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJzZXRHcm91cE1lbWJlck5hbWVDYXJkXCIpO2lmKGUubmFtZUNhcmQmJiExPT09dGhpcy5fZmlsdGVyUHJvZmFuaXR5KFwibmFtZUNhcmRcIixlKSlyZXR1cm4gWmEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSk7dmFyIG89ZS5ncm91cElELHM9ZS51c2VySUQsYT12b2lkIDA9PT1zP3RoaXMuZ2V0TXlVc2VySUQoKTpzLGk9ZS5uYW1lQ2FyZDtWZS5sKFwiXCIuY29uY2F0KG4sXCIgZ3JvdXBJRDpcIikuY29uY2F0KG8sXCIgdXNlcklEOlwiKS5jb25jYXQoYSkpO3ZhciByPW5ldyBBYShcInNldEdyb3VwTWVtYmVyTmFtZUNhcmRcIik7cmV0dXJuIHIuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgdXNlcklEOlwiKS5jb25jYXQoYSxcIiBuYW1lQ2FyZDpcIikuY29uY2F0KGkpKSx0aGlzLm1vZGlmeUdyb3VwTWVtYmVySW5mbyh7Z3JvdXBJRDpvLHVzZXJJRDphLG5hbWVDYXJkOml9KS50aGVuKChmdW5jdGlvbihlKXtWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2tcIikpLHIuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKTt2YXIgcz10LmdldE1vZHVsZShQbikuZ2V0TG9jYWxHcm91cFByb2ZpbGUobyk7cmV0dXJuIGE9PT10LmdldE15VXNlcklEKCkmJnMmJnMuc2V0U2VsZk5hbWVDYXJkKGkpLFlhKHtncm91cDpzLG1lbWJlcjplfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO3Iuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJzZXRHcm91cE1lbWJlckN1c3RvbUZpZWxkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInNldEdyb3VwTWVtYmVyQ3VzdG9tRmllbGRcIiksbz1lLmdyb3VwSUQscz1lLnVzZXJJRCxhPXZvaWQgMD09PXM/dGhpcy5nZXRNeVVzZXJJRCgpOnMsaT1lLm1lbWJlckN1c3RvbUZpZWxkO1ZlLmwoXCJcIi5jb25jYXQobixcIiBncm91cElEOlwiKS5jb25jYXQobyxcIiB1c2VySUQ6XCIpLmNvbmNhdChhKSk7dmFyIHI9bmV3IEFhKFwic2V0R3JvdXBNZW1iZXJDdXN0b21GaWVsZFwiKTtyZXR1cm4gci5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQobyxcIiB1c2VySUQ6XCIpLmNvbmNhdChhLFwiIG1lbWJlckN1c3RvbUZpZWxkOlwiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkoaSkpKSx0aGlzLm1vZGlmeUdyb3VwTWVtYmVySW5mbyh7Z3JvdXBJRDpvLHVzZXJJRDphLG1lbWJlckN1c3RvbUZpZWxkOml9KS50aGVuKChmdW5jdGlvbihlKXtyLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKTt2YXIgcz10LmdldE1vZHVsZShQbikuZ2V0TG9jYWxHcm91cFByb2ZpbGUobyk7cmV0dXJuIFlhKHtncm91cDpzLG1lbWJlcjplfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO3Iuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJtb2RpZnlHcm91cE1lbWJlckluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLG89ZS5ncm91cElELHM9ZS51c2VySUQsYT12b2lkIDA7cmV0dXJuIGt0KG8pJiYobz14dChhPW8pKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp3cyxyZXF1ZXN0RGF0YTp0KHQoe30sZSkse30se2dyb3VwSUQ6byx0b3BpY0lEOmF9KX0pLnRoZW4oKGZ1bmN0aW9uKCl7aWYobi5oYXNMb2NhbEdyb3VwTWVtYmVyKG8scykpe3ZhciB0PW4uZ2V0TG9jYWxHcm91cE1lbWJlckluZm8obyxzKTtyZXR1cm4gaXQoZS5tdXRlVGltZSl8fHQudXBkYXRlTXV0ZVVudGlsKGUubXV0ZVRpbWUpLGl0KGUucm9sZSl8fHQudXBkYXRlUm9sZShlLnJvbGUpLGl0KGUubmFtZUNhcmQpfHx0LnVwZGF0ZU5hbWVDYXJkKGUubmFtZUNhcmQpLGl0KGUubWVtYmVyQ3VzdG9tRmllbGQpfHx0LnVwZGF0ZU1lbWJlckN1c3RvbUZpZWxkKGUubWVtYmVyQ3VzdG9tRmllbGQpLHR9cmV0dXJuIG4uZ2V0R3JvdXBNZW1iZXJQcm9maWxlKHtncm91cElEOm8sdXNlcklETGlzdDpbc119KS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gdihlLmRhdGEubWVtYmVyTGlzdCwxKVswXX0pKX0pKX19LHtrZXk6XCJtYXJrR3JvdXBNZW1iZXJMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcIm1hcmtHcm91cE1lbWJlckxpc3RcIiksbz1lLmdyb3VwSUQscz1lLm1hcmtUeXBlLGE9ZS5lbmFibGVNYXJrLGk9ZS51c2VySURMaXN0LHI9dm9pZCAwPT09aT9bXTppLHU9XCJncm91cElEOlwiLmNvbmNhdChvLFwiIG1hcmtUeXBlOlwiKS5jb25jYXQocyxcIiBlbmFibGVNYXJrOlwiKS5jb25jYXQoYSxcIiB1c2VySURMaXN0IGNvdW50OiBcIikuY29uY2F0KHIubGVuZ3RoKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgXCIpLmNvbmNhdCh1KSk7dmFyIGM9MixsPVtdOyEwPT09YSYmKGM9MSk7dmFyIGQ9bShyKTtyLmxlbmd0aD41MDAmJihkPXIuc2xpY2UoMCw1MDApLFZlLncoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KFd0KDUwMCkpKSksZC5mb3JFYWNoKChmdW5jdGlvbihlKXtsLnB1c2goe3VzZXJJRDplLG1hcmtUeXBlOltzXX0pfSkpLGQ9bnVsbDt2YXIgcD1uZXcgQWEoXCJtYXJrR3JvdXBNZW1iZXJMaXN0XCIpO3JldHVybiBwLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQodSkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkZzLHJlcXVlc3REYXRhOntncm91cElEOm8sb3BlcmF0aW9uVHlwZTpjLG1lbWJlckxpc3Q6bH19KS50aGVuKChmdW5jdGlvbihlKXt2YXIgbz1lLmRhdGEubWVtYmVyTGlzdCxzPXZvaWQgMD09PW8/W106byxhPVtdLGk9W107cy5sZW5ndGg9PT1yLmxlbmd0aD9hLnB1c2guYXBwbHkoYSxtKHIpKToocy5mb3JFYWNoKChmdW5jdGlvbihlKXthLnB1c2goZS51c2VySUQpfSkpLHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7YS5pbmNsdWRlcyhlKXx8aS5wdXNoKGUpfSkpKTt2YXIgdT1cInN1Y2Nlc3MgY291bnQ6XCIuY29uY2F0KGEubGVuZ3RoLFwiIGZhaWwgY291bnQ6XCIpLmNvbmNhdChpLmxlbmd0aCk7cmV0dXJuIHAuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKHUpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gXCIpLmNvbmNhdCh1KSksWWEoe3N1Y2Nlc3NVc2VySURMaXN0OmEsZmFpbHVyZVVzZXJJRExpc3Q6aX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtwLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiX2dldEdyb3VwTWVtYmVyUHJvZmlsZUFkdmFuY2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6R3MscmVxdWVzdERhdGE6dCh0KHt9LGUpLHt9LHttZW1iZXJJbmZvRmlsdGVyOmUubWVtYmVySW5mb0ZpbHRlcj9lLm1lbWJlckluZm9GaWx0ZXI6W1wiUm9sZVwiLFwiSm9pblRpbWVcIixcIk5hbWVDYXJkXCIsXCJTaHV0VXBVbnRpbFwiXX0pfSl9fSx7a2V5OlwiX3VwZGF0ZUxvY2FsR3JvdXBNZW1iZXJNYXBcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7cmV0dXJuIGF0KHQpJiYwIT09dC5sZW5ndGg/dC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBuLmhhc0xvY2FsR3JvdXBNZW1iZXIoZSx0LnVzZXJJRCk/bi5nZXRMb2NhbEdyb3VwTWVtYmVySW5mbyhlLHQudXNlcklEKS51cGRhdGVNZW1iZXIodCk6bi5zZXRMb2NhbEdyb3VwTWVtYmVyKGUsbmV3IHhpKHQpKSxuLmdldExvY2FsR3JvdXBNZW1iZXJJbmZvKGUsdC51c2VySUQpfSkpOltdfX0se2tleTpcImRlbGV0ZUxvY2FsR3JvdXBNZW1iZXJzXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdyb3VwTWVtYmVyTGlzdE1hcC5nZXQoZSk7biYmdC5mb3JFYWNoKChmdW5jdGlvbihlKXtuLmRlbGV0ZShlKX0pKX19LHtrZXk6XCJnZXRMb2NhbEdyb3VwTWVtYmVySW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZ3JvdXBNZW1iZXJMaXN0TWFwLmhhcyhlKT90aGlzLmdyb3VwTWVtYmVyTGlzdE1hcC5nZXQoZSkuZ2V0KHQpOm51bGx9fSx7a2V5Olwic2V0TG9jYWxHcm91cE1lbWJlclwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7aWYodGhpcy5ncm91cE1lbWJlckxpc3RNYXAuaGFzKGUpKXRoaXMuZ3JvdXBNZW1iZXJMaXN0TWFwLmdldChlKS5zZXQodC51c2VySUQsdCk7ZWxzZXt2YXIgbj0obmV3IE1hcCkuc2V0KHQudXNlcklELHQpO3RoaXMuZ3JvdXBNZW1iZXJMaXN0TWFwLnNldChlLG4pfX19LHtrZXk6XCJnZXRMb2NhbEdyb3VwTWVtYmVyTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdyb3VwTWVtYmVyTGlzdE1hcC5nZXQoZSl9fSx7a2V5OlwiaGFzTG9jYWxHcm91cE1lbWJlclwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZ3JvdXBNZW1iZXJMaXN0TWFwLmhhcyhlKSYmdGhpcy5ncm91cE1lbWJlckxpc3RNYXAuZ2V0KGUpLmhhcyh0KX19LHtrZXk6XCJoYXNMb2NhbEdyb3VwTWVtYmVyTWFwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ3JvdXBNZW1iZXJMaXN0TWFwLmhhcyhlKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5ncm91cE1lbWJlckxpc3RNYXAuY2xlYXIoKX19XSksc30odW8pLEJpPVtcInRvcGljSURcIixcInRvcGljTmFtZVwiLFwiYXZhdGFyXCIsXCJpbnRyb2R1Y3Rpb25cIixcIm5vdGlmaWNhdGlvblwiLFwidW5yZWFkQ291bnRcIixcIm11dGVBbGxNZW1iZXJzXCIsXCJjdXN0b21EYXRhXCIsXCJncm91cEF0SW5mb0xpc3RcIixcIm5leHRNZXNzYWdlU2VxXCIsXCJzZWxmSW5mb1wiXSxIaT1mdW5jdGlvbihlLHQpe3JldHVybiB6dChlKT97bGFzdFRpbWU6MCxsYXN0U2VxdWVuY2U6MCxmcm9tQWNjb3VudDpcIlwiLHBheWxvYWQ6bnVsbCx0eXBlOlwiXCIsbWVzc2FnZUZvclNob3c6XCJcIixuaWNrOlwiXCIsdmVyc2lvbjowLGNsb3VkQ3VzdG9tRGF0YTpcIlwiLGlzUmV2b2tlZDohMSxyZXZva2VyOm51bGx9OntsYXN0VGltZTplLnRpbWV8fDAsbGFzdFNlcXVlbmNlOmUuc2VxdWVuY2V8fDAsZnJvbUFjY291bnQ6ZS5mcm9tfHxcIlwiLHBheWxvYWQ6ZS5wYXlsb2FkfHxudWxsLHR5cGU6ZS50eXBlfHxcIlwiLG1lc3NhZ2VGb3JTaG93OlZ0KGUudHlwZSxlLnBheWxvYWQsdCksbmljazplLm5pY2t8fFwiXCIsdmVyc2lvbjplLnZlcnNpb258fDAsY2xvdWRDdXN0b21EYXRhOmUuY2xvdWRDdXN0b21EYXRhfHxcIlwiLGlzUmV2b2tlZDplLmlzUmV2b2tlZHx8ITEscmV2b2tlcjplLnJldm9rZXJ8fG51bGx9fSxLaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXtvKHRoaXMsZSksdGhpcy50b3BpY0lEPVwiXCIsdGhpcy50b3BpY05hbWU9XCJcIix0aGlzLmF2YXRhcj1cIlwiLHRoaXMuaW50cm9kdWN0aW9uPVwiXCIsdGhpcy5ub3RpZmljYXRpb249XCJcIix0aGlzLnVucmVhZENvdW50PTAsdGhpcy5tdXRlQWxsTWVtYmVycz0hMSx0aGlzLmN1c3RvbURhdGE9XCJcIix0aGlzLmdyb3VwQXRJbmZvTGlzdD1bXSx0aGlzLm5leHRNZXNzYWdlU2VxPTAsdGhpcy5sYXN0TWVzc2FnZT1IaSh0Lmxhc3RNZXNzYWdlLG4pLHRoaXMuc2VsZkluZm89e211dGVUaW1lOjAscmVhZGVkU2VxdWVuY2U6MCxtZXNzYWdlUmVtaW5kVHlwZTpcIlwiLGV4Y2x1ZGVkVW5yZWFkU2VxdWVuY2VMaXN0OnZvaWQgMH0sdGhpcy5faW5pdFRvcGljKHQpfXJldHVybiBhKGUsW3trZXk6XCJfaW5pdFRvcGljXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIGUpQmkuaW5kZXhPZih0KTwwfHwoXCJzZWxmSW5mb1wiPT09dD90aGlzLnVwZGF0ZVNlbGZJbmZvKGVbdF0pOnRoaXNbdF09XCJtdXRlQWxsTWVtYmVyc1wiPT09dD8xPT09ZVt0XTplW3RdKX19LHtrZXk6XCJ1cGRhdGVVbnJlYWRDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOjA7dGhpcy51bnJlYWRDb3VudD1lfX0se2tleTpcInVwZGF0ZU5leHRNZXNzYWdlU2VxXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5uZXh0TWVzc2FnZVNlcT1lfX0se2tleTpcInVwZGF0ZUxhc3RNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5sYXN0TWVzc2FnZT1IaShlKX19LHtrZXk6XCJ1cGRhdGVHcm91cEF0SW5mb0xpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmdyb3VwQXRJbmZvTGlzdD1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGUpKX19LHtrZXk6XCJ1cGRhdGVUb3BpY1wiLHZhbHVlOmZ1bmN0aW9uKGUpe2l0KGUuc2VsZkluZm8pfHx0aGlzLnVwZGF0ZVNlbGZJbmZvKGUuc2VsZkluZm8pLGl0KGUubXV0ZUFsbE1lbWJlcnMpfHwodGhpcy5tdXRlQWxsTWVtYmVycz0xPT09ZS5tdXRlQWxsTWVtYmVycykscHQodGhpcyxlLFtcImdyb3VwSURcIixcImxhc3RNZXNzYWdlVGltZVwiLFwic2VsZkluZm9cIixcIm11dGVBbGxNZW1iZXJzXCIsXCJsYXN0TXNnXCJdKX19LHtrZXk6XCJ1cGRhdGVTZWxmSW5mb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiAwIT09cHQodGhpcy5zZWxmSW5mbyxlLFtdLFtcIlwiXSl9fSx7a2V5OlwicmVkdWNlVW5yZWFkQ291bnRcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVucmVhZENvdW50Pj0xJiYodGhpcy51bnJlYWRDb3VudC09MSwhMCl9fSx7a2V5OlwiaXNMYXN0TWVzc2FnZVJldm9rZWRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5zZXF1ZW5jZT09PXRoaXMubGFzdE1lc3NhZ2UubGFzdFNlcXVlbmNlfX0se2tleTpcInNldExhc3RNZXNzYWdlUmV2b2tlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMubGFzdE1lc3NhZ2UuaXNSZXZva2VkPWV9fSx7a2V5Olwic2V0TGFzdE1lc3NhZ2VSZXZva2VyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5sYXN0TWVzc2FnZS5yZXZva2VyPWV9fV0pLGV9KCksV2k9ZnVuY3Rpb24oZSl7cihzLGUpO3ZhciBuPWYocyk7ZnVuY3Rpb24gcyhlKXt2YXIgdDtyZXR1cm4gbyh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIlRvcGljTW9kdWxlXCIsdC5fdG9waWNNYXA9bmV3IE1hcCx0Ll9nZXRUb3BpY1RpbWVNYXA9bmV3IE1hcCx0LlRPUElDX0NBQ0hFX1RJTUU9MzAwLHQuVE9QSUNfTEFTVF9BQ1RJVkVfVElNRT0zNjAwLHQuZ2V0SW5uZXJFbWl0dGVySW5zdGFuY2UoKS5vbih0aSx0Ll9vbkNsb3VkQ29uZmlnVXBkYXRlZCxoKHQpKSx0fXJldHVybiBhKHMsW3trZXk6XCJfb25DbG91ZENvbmZpZ1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0Q2xvdWRDb25maWcoXCJ0b3BpY19jYWNoZV90aW1lXCIpLHQ9dGhpcy5nZXRDbG91ZENvbmZpZyhcInRvcGljX2xhc3RfYWN0aXZlX3RpbWVcIik7aXQoZSl8fCh0aGlzLlRPUElDX0NBQ0hFX1RJTUU9TnVtYmVyKGUpKSxpdCh0KXx8KHRoaXMuVE9QSUNfTEFTVF9BQ1RJVkVfVElNRT1OdW1iZXIodCkpfX0se2tleTpcIm9uVG9waWNDcmVhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cElEO3RoaXMucmVzZXRHZXRUb3BpY1RpbWUodCksdGhpcy5lbWl0T3V0ZXJFdmVudChrLlRPUElDX0NSRUFURUQsZSl9fSx7a2V5Olwib25Ub3BpY0RlbGV0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5ncm91cElELG89ZS50b3BpY0lETGlzdDsodm9pZCAwPT09bz9bXTpvKS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Ll9kZWxldGVMb2NhbFRvcGljKG4sZSl9KSksdGhpcy5lbWl0T3V0ZXJFdmVudChrLlRPUElDX0RFTEVURUQsZSl9fSx7a2V5Olwib25Ub3BpY01lc3NhZ2VSZW1pbmRUeXBlVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ3JvdXBJRCxuPWUudG9waWNJRCxvPWUubWVzc2FnZVJlbWluZFR5cGUscz10aGlzLmdldExvY2FsVG9waWModCxuKTtpZihzKXt2YXIgYT1zLnVwZGF0ZVNlbGZJbmZvKHttZXNzYWdlUmVtaW5kVHlwZTpvfSk7YSYmdGhpcy5lbWl0T3V0ZXJFdmVudChrLlRPUElDX1VQREFURUQse2dyb3VwSUQ6dCx0b3BpYzpzfSksVmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uVG9waWNNZXNzYWdlUmVtaW5kVHlwZVVwZGF0ZWQgdG9waWNJRDpcIikuY29uY2F0KG4pK1wiIG1lc3NhZ2VSZW1pbmRUeXBlOlwiLmNvbmNhdChvLFwiIGlzVG9waWNVcGRhdGVkOlwiKS5jb25jYXQoYSkpfX19LHtrZXk6XCJvblRvcGljUHJvZmlsZVVwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmdyb3VwSUQsbj1lLnRvcGljSUQsbz10aGlzLmdldExvY2FsVG9waWModCxuKTtvJiYoby51cGRhdGVUb3BpYyhlKSx0aGlzLmVtaXRPdXRlckV2ZW50KGsuVE9QSUNfVVBEQVRFRCx7Z3JvdXBJRDp0LHRvcGljOm99KSl9fSx7a2V5Olwib25Db252ZXJzYXRpb25Qcm94eVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUudG9waWNJRCxuPWUudW5yZWFkQ291bnQsbz1lLmdyb3VwQXRJbmZvTGlzdCxzPXh0KHQpLGE9dGhpcy5nZXRMb2NhbFRvcGljKHMsdCksaT0hMTthJiYoaXQobil8fGEudW5yZWFkQ291bnQ9PT1ufHwoYS51cGRhdGVVbnJlYWRDb3VudChuKSxpPSEwKSxpdChvKXx8KGEudXBkYXRlR3JvdXBBdEluZm9MaXN0KG8pLGk9ITApKSxpJiZ0aGlzLmVtaXRPdXRlckV2ZW50KGsuVE9QSUNfVVBEQVRFRCx7Z3JvdXBJRDpzLHRvcGljOmF9KX19LHtrZXk6XCJvbk1lc3NhZ2VTZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ncm91cElELG49ZS50b3BpY0lELG89ZS5sYXN0TWVzc2FnZSxzPXRoaXMuZ2V0TG9jYWxUb3BpYyh0LG4pO3MmJihzLm5leHRNZXNzYWdlU2VxKz0xLHMudXBkYXRlTGFzdE1lc3NhZ2UobyksdGhpcy5lbWl0T3V0ZXJFdmVudChrLlRPUElDX1VQREFURUQse2dyb3VwSUQ6dCx0b3BpYzpzfSkpfX0se2tleTpcIm9uTWVzc2FnZU1vZGlmaWVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50byxuPWUudGltZSxvPWUuc2VxdWVuY2Uscz1lLmVsZW1lbnRzLGE9ZS5jbG91ZEN1c3RvbURhdGEsaT1lLm1lc3NhZ2VWZXJzaW9uLHI9eHQodCksdT10aGlzLmdldExvY2FsVG9waWMocix0KTtpZih1KXt2YXIgYz11Lmxhc3RNZXNzYWdlO1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbk1lc3NhZ2VNb2RpZmllZCB0b3BpY0lEOlwiKS5jb25jYXQodCxcIiBsYXN0TWVzc2FnZTpcIiksSlNPTi5zdHJpbmdpZnkoYyksXCJvcHRpb25zOlwiLEpTT04uc3RyaW5naWZ5KGUpKSxjJiYobnVsbD09PWMucGF5bG9hZHx8Yy5sYXN0VGltZT09PW4mJmMubGFzdFNlcXVlbmNlPT09byYmYy52ZXJzaW9uIT09aSkmJihjLnR5cGU9c1swXS50eXBlLGMucGF5bG9hZD1zWzBdLmNvbnRlbnQsYy5tZXNzYWdlRm9yU2hvdz1WdChjLnR5cGUsYy5wYXlsb2FkLHRoaXMuaXNJbnRsKCkpLGMuY2xvdWRDdXN0b21EYXRhPWEsYy52ZXJzaW9uPWksYy5sYXN0U2VxdWVuY2U9byxjLmxhc3RUaW1lPW4sdGhpcy5lbWl0T3V0ZXJFdmVudChrLlRPUElDX1VQREFURUQse2dyb3VwSUQ6cix0b3BpYzp1fSkpfX19LHtrZXk6XCJvbk1lc3NhZ2VSZXZva2VkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZigwIT09ZS5sZW5ndGgpe3ZhciBuPW51bGwsbz1udWxsLHM9ITE7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgYT1lLnRvO289eHQoYSksKG49dC5nZXRMb2NhbFRvcGljKG8sYSkpJiYobi5yZWR1Y2VVbnJlYWRDb3VudCgpJiYocz0hMCksbi5pc0xhc3RNZXNzYWdlUmV2b2tlZChlKSYmKG4uc2V0TGFzdE1lc3NhZ2VSZXZva2VkKCEwKSxuLnNldExhc3RNZXNzYWdlUmV2b2tlcihlLnJldm9rZXIpLHM9ITApKX0pKSxzJiZ0aGlzLmVtaXRPdXRlckV2ZW50KGsuVE9QSUNfVVBEQVRFRCx7Z3JvdXBJRDpvLHRvcGljOm59KX19fSx7a2V5OlwiaXNMYXN0TWVzc2FnZVJldm9rZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnRvcGljSUQsbj1lLnNlcXVlbmNlLG89eHQodCkscz10aGlzLmdldExvY2FsVG9waWMobyx0KSxhPSExO3JldHVybiBzJiYoYT1zLmlzTGFzdE1lc3NhZ2VSZXZva2VkKHtzZXF1ZW5jZTpufSkpLGF9fSx7a2V5OlwiZ2V0Sm9pbmVkQ29tbXVuaXR5TGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKFBuKS5nZXRHcm91cExpc3Qoe2lzR3JvdXBXaXRoVG9waWNPbmx5OiEwfSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5kYXRhLmdyb3VwTGlzdDtyZXR1cm4gWWEoe2dyb3VwTGlzdDp2b2lkIDA9PT10P1tdOnR9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIFphKGUpfSkpfX0se2tleTpcImNyZWF0ZVRvcGljSW5Db21tdW5pdHlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLG89XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiY3JlYXRlVG9waWNJbkNvbW11bml0eVwiKSxzPWUudG9waWNJRDtpZighaXQocykmJiFrdChzKSlyZXR1cm4gWmEoe2NvZGU6aGEuSUxMRUdBTF9UT1BJQ19JRH0pO2lmKGUudG9waWNOYW1lJiYhMT09PXRoaXMuX2ZpbHRlclByb2Zhbml0eShcInRvcGljTmFtZVwiLGUpKXJldHVybiBaYSh7Y29kZTpoYS5QUk9GQU5JVFlfRk9VTkR9KTtpZihlLmludHJvZHVjdGlvbiYmITE9PT10aGlzLl9maWx0ZXJQcm9mYW5pdHkoXCJpbnRyb2R1Y3Rpb25cIixlKSlyZXR1cm4gWmEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSk7aWYoZS5ub3RpZmljYXRpb24mJiExPT09dGhpcy5fZmlsdGVyUHJvZmFuaXR5KFwibm90aWZpY2F0aW9uXCIsZSkpcmV0dXJuIFphKHtjb2RlOmhhLlBST0ZBTklUWV9GT1VORH0pO3ZhciBhPW5ldyBBYShcImNyZWF0ZVRvcGljSW5Db21tdW5pdHlcIik7cmV0dXJuIHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOnRhLHJlcXVlc3REYXRhOnQoe30sZSl9KS50aGVuKChmdW5jdGlvbihzKXt2YXIgaT1zLmRhdGEudG9waWNJRDtyZXR1cm4gYS5zZXRNZXNzYWdlKFwidG9waWNJRDpcIi5jb25jYXQoaSkpLnNldE5ldHdvcmtUeXBlKG4uZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChvLFwiIG9rXCIpKSxuLl91cGRhdGVUb3BpY01hcChbdCh0KHt9LGUpLHt9LHt0b3BpY0lEOml9KV0pLFlhKHt0b3BpY0lEOml9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIG4ucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07YS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChvLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImRlbGV0ZVRvcGljRnJvbUNvbW11bml0eVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJkZWxldGVUb3BpY0Zyb21Db21tdW5pdHlcIiksbz1lLmdyb3VwSUQscz1lLnRvcGljSURMaXN0LGE9dm9pZCAwPT09cz9bXTpzLGk9bmV3IEFhKFwiZGVsZXRlVG9waWNGcm9tQ29tbXVuaXR5XCIpO3JldHVybiBpLnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChvLFwiIHRvcGljSURMaXN0OlwiKS5jb25jYXQoYSkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOm5hLHJlcXVlc3REYXRhOntncm91cElEOm8sdG9waWNJRExpc3Q6YX19KS50aGVuKChmdW5jdGlvbihlKXt2YXIgbj1lLmRhdGEucmVzdWx0TGlzdCxzPVtdLGE9W107KHZvaWQgMD09PW4/W106bikuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS50b3BpY0lELG49ZS5lcnJvckNvZGUsbz1lLmVycm9ySW5mbzswPT09bj9zLnB1c2goe3RvcGljSUQ6dH0pOmEucHVzaCh7dG9waWNJRDp0LGNvZGU6bixtZXNzYWdlOm99KX0pKTt2YXIgcj1cInN1Y2Nlc3MgY291bnQ6XCIuY29uY2F0KHMubGVuZ3RoLFwiLCBmYWlsIGNvdW50OlwiKS5jb25jYXQoYS5sZW5ndGgpO3JldHVybiBpLnNldE1vcmVNZXNzYWdlKFwiXCIuY29uY2F0KHIpKS5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQocikpLHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dC5fZGVsZXRlTG9jYWxUb3BpYyhvLGUudG9waWNJRCl9KSksWWEoe3N1Y2Nlc3NUb3BpY0xpc3Q6cyxmYWlsdXJlVG9waWNMaXN0OmF9KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07aS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcInVwZGF0ZVRvcGljUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJ1cGRhdGVUb3BpY1Byb2ZpbGVcIik7aWYoVmUubChcIlwiLmNvbmNhdChvLFwiIG9wdGlvbnM6XCIpLGUpLGUudG9waWNOYW1lJiYhMT09PXRoaXMuX2ZpbHRlclByb2Zhbml0eShcInRvcGljTmFtZVwiLGUpKXJldHVybiBaYSh7Y29kZTpoYS5QUk9GQU5JVFlfRk9VTkR9KTtpZihlLmludHJvZHVjdGlvbiYmITE9PT10aGlzLl9maWx0ZXJQcm9mYW5pdHkoXCJpbnRyb2R1Y3Rpb25cIixlKSlyZXR1cm4gWmEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSk7aWYoZS5ub3RpZmljYXRpb24mJiExPT09dGhpcy5fZmlsdGVyUHJvZmFuaXR5KFwibm90aWZpY2F0aW9uXCIsZSkpcmV0dXJuIFphKHtjb2RlOmhhLlBST0ZBTklUWV9GT1VORH0pO3ZhciBzPW5ldyBBYShcInVwZGF0ZVRvcGljUHJvZmlsZVwiKTtyZXR1cm4gcy5zZXRNZXNzYWdlKFwiZ3JvdXBJRDpcIi5jb25jYXQoZS5ncm91cElELFwiIHRvcGljSUQ6XCIpLmNvbmNhdChlLnRvcGljSUQpKSxpdChlLm11dGVBbGxNZW1iZXJzKXx8KGUubXV0ZUFsbE1lbWJlcnM9ITA9PT1lLm11dGVBbGxNZW1iZXJzP1wiT25cIjpcIk9mZlwiKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpvYSxyZXF1ZXN0RGF0YTp0KHt9LGUpfSkudGhlbigoZnVuY3Rpb24oKXtyZXR1cm4gcy5zZXROZXR3b3JrVHlwZShuLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBva1wiKSksbi5fdXBkYXRlVG9waWNNYXAoW2VdKSxZYSh7dG9waWM6bi5nZXRMb2NhbFRvcGljKGUuZ3JvdXBJRCxlLnRvcGljSUQpfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiBuLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0sYT1uWzFdO3Muc2V0RXJyb3IoZSxvLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJnZXRUb3BpY0xpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLG89XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZ2V0VG9waWNMaXN0XCIpLHM9ZS5ncm91cElELGE9ZS50b3BpY0lETGlzdCxpPXZvaWQgMD09PWE/W106YSxyPTA9PT1pLmxlbmd0aCx1PW5ldyBBYShcImdldFRvcGljTGlzdFwiKTtpZih1LnNldE1lc3NhZ2UoXCJncm91cElEOlwiLmNvbmNhdChzKSksdGhpcy5fZ2V0VG9waWNUaW1lTWFwLmhhcyhzKSl7dmFyIGM9dGhpcy5fZ2V0VG9waWNUaW1lTWFwLmdldChzKSxsPWMuaXNHZXRBbGwsZD1jLnRpbWU7aWYoKGx8fCFsJiYhcikmJkRhdGUubm93KCktZDwxZTMqdGhpcy5UT1BJQ19DQUNIRV9USU1FKXt2YXIgcD10aGlzLl9nZXRMb2NhbFRvcGljTGlzdChzLGkpO2lmKHJ8fHAubGVuZ3RoPT09aS5sZW5ndGgpcmV0dXJuIHUuc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5zZXRNb3JlTWVzc2FnZShcImZyb20gY2FjaGUsIHRvcGljIGNvdW50OlwiLmNvbmNhdChwLmxlbmd0aCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBncm91cElEOlwiKS5jb25jYXQocyxcIiBmcm9tIGNhY2hlLCB0b3BpYyBjb3VudDpcIikuY29uY2F0KHAubGVuZ3RoKSksWGEoe3N1Y2Nlc3NUb3BpY0xpc3Q6cCxmYWlsdXJlVG9waWNMaXN0OltdfSl9fXJldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpzYSxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDpzLHRvcGljSURMaXN0Oml9fSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIGE9ZS5kYXRhLnRvcGljSW5mb0xpc3QsaT1bXSxjPVtdLGw9W107KHZvaWQgMD09PWE/W106YSkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIG49ZS50b3BpYyxvPWUuc2VsZkluZm8scz1lLmVycm9yQ29kZSxhPWUuZXJyb3JJbmZvLHI9bi50b3BpY0lEOzA9PT1zPyhpLnB1c2godCh0KHt9LG4pLHt9LHtzZWxmSW5mbzpvfSkpLGMucHVzaChyKSk6bC5wdXNoKHt0b3BpY0lEOnIsY29kZTpzLG1lc3NhZ2U6YX0pfSkpLG4uX3VwZGF0ZVRvcGljTWFwKGkpLG4uX2hhbmRsZVRvcGljQXRJbmZvKGkpO3ZhciBkPVwic3VjY2VzcyBjb3VudDpcIi5jb25jYXQoYy5sZW5ndGgsXCIsIGZhaWwgY291bnQ6XCIpLmNvbmNhdChsLmxlbmd0aCk7dS5zZXROZXR3b3JrVHlwZShuLmdldE5ldHdvcmtUeXBlKCkpLnNldE1vcmVNZXNzYWdlKFwiXCIuY29uY2F0KGQpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG8sXCIgZ3JvdXBJRDpcIikuY29uY2F0KHMsXCIgZnJvbSByZW1vdGUsIFwiKS5jb25jYXQoZCkpO3ZhciBwPVtdO3JldHVybiB6dChjKXx8KG4uX2dldFRvcGljVGltZU1hcC5zZXQocyx7dGltZTpEYXRlLm5vdygpLGlzR2V0QWxsOnJ9KSxwPW4uX2dldExvY2FsVG9waWNMaXN0KHMsYykpLFlhKHtzdWNjZXNzVG9waWNMaXN0OnAsZmFpbHVyZVRvcGljTGlzdDpsfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiBuLnByb2JlTmV0d29yayhlKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTt1LnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiaGFzTG9jYWxUb3BpY1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuISF0aGlzLl90b3BpY01hcC5oYXMoZSkmJnRoaXMuX3RvcGljTWFwLmdldChlKS5oYXModCl9fSx7a2V5OlwiZ2V0TG9jYWxUb3BpY1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49bnVsbDtyZXR1cm4gdGhpcy5fdG9waWNNYXAuaGFzKGUpJiYobj10aGlzLl90b3BpY01hcC5nZXQoZSkuZ2V0KHQpKSxufX0se2tleTpcIl9nZXRMb2NhbFRvcGljTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTpbXSxuPXRoaXMuX3RvcGljTWFwLmdldChlKSxvPVtdO3JldHVybiBuJiYobz1tKG4udmFsdWVzKCkpKSwwPT09dC5sZW5ndGg/bzpvLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIHQuaW5jbHVkZXMoZS50b3BpY0lEKX0pKX19LHtrZXk6XCJfZGVsZXRlTG9jYWxUb3BpY1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fdG9waWNNYXAuaGFzKGUpJiYodGhpcy5fdG9waWNNYXAuZ2V0KGUpLmRlbGV0ZSh0KSxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2RlbGV0ZUxvY2FsVG9waWMgZ3JvdXBJRDpcIikuY29uY2F0KGUsXCIgdG9waWNJRDpcIikuY29uY2F0KHQpKSl9fSx7a2V5OlwiX3VwZGF0ZVRvcGljTWFwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVtdOyhlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBvPWUuZ3JvdXBJRCxzPWUudG9waWNJRCxhPW51bGw7dC5fdG9waWNNYXAuaGFzKG8pfHx0Ll90b3BpY01hcC5zZXQobyxuZXcgTWFwKSx0Ll90b3BpY01hcC5nZXQobykuaGFzKHMpPyhhPXQuX3RvcGljTWFwLmdldChvKS5nZXQocykpLnVwZGF0ZVRvcGljKGUpOih0Ll9nZXRUb3BpY0xhc3RNZXNzYWdlKGUpLGE9bmV3IEtpKGUsdC5pc0ludGwoKSksdC5fdG9waWNNYXAuZ2V0KG8pLnNldChzLGEpKTt2YXIgaT10Ll9jb21wdXRlVW5yZWFkQ291bnQoYSk7YS51cGRhdGVVbnJlYWRDb3VudChpKSxuLnB1c2goe2NvbnZlcnNhdGlvbklEOlwiXCIuY29uY2F0KEUuQ09OVl9HUk9VUCkuY29uY2F0KHMpLHR5cGU6RS5DT05WX1RPUElDLHVucmVhZENvdW50Oml9KX0pKSxuLmxlbmd0aD4wKSYmdGhpcy5nZXRNb2R1bGUocW4pLnVwZGF0ZVRvcGljQ29udmVyc2F0aW9uKG4pfX0se2tleTpcInJlc2V0R2V0VG9waWNUaW1lXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpdChlKT9tKHRoaXMuX2dldFRvcGljVGltZU1hcC5rZXlzKCkpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2dldFRvcGljVGltZU1hcC5zZXQoZSwwKX0pKTp0aGlzLl9nZXRUb3BpY1RpbWVNYXAuc2V0KGUsMCl9fSx7a2V5OlwiZ2V0VG9waWNMaXN0T25SZWNvbm5lY3RlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PW0odGhpcy5fdG9waWNNYXAua2V5cygpKSxuPVtdO3QuZm9yRWFjaCgoZnVuY3Rpb24odCl7dmFyIG89W107ZS5fZ2V0TG9jYWxUb3BpY0xpc3QodCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7dmFyIG49dC5sYXN0TWVzc2FnZS5sYXN0VGltZSxzPXZvaWQgMD09PW4/MDpuO0RhdGUubm93KCktMWUzKnM8MWUzKmUuVE9QSUNfTEFTVF9BQ1RJVkVfVElNRSYmby5wdXNoKHQudG9waWNJRCl9KSksby5sZW5ndGg+MCYmbi5wdXNoKHtncm91cElEOnQsdG9waWNJRExpc3Q6b30pfSkpLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRUb3BpY0xpc3RPblJlY29ubmVjdGVkLiBhY3RpdmUgY29tbXVuaXR5IGNvdW50OlwiKS5jb25jYXQobi5sZW5ndGgpKSx0aGlzLl9yZWxheUdldFRvcGljTGlzdChuKX19LHtrZXk6XCJfcmVsYXlHZXRUb3BpY0xpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKDAhPT1lLmxlbmd0aCl7dmFyIG49ZS5zaGlmdCgpLG89bi50b3BpY0lETGlzdC5sZW5ndGg+NT9cInRvcGljSURMaXN0Lmxlbmd0aDpcIi5jb25jYXQobi50b3BpY0lETGlzdC5sZW5ndGgpOlwidG9waWNJRExpc3Q6XCIuY29uY2F0KG4udG9waWNJRExpc3QpLHM9bmV3IEFhKFwicmVsYXlHZXRUb3BpY0xpc3RcIik7cy5zZXRNZXNzYWdlKG8pLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fcmVsYXlHZXRUb3BpY0xpc3QuIFwiKS5jb25jYXQobykpLHRoaXMuZ2V0VG9waWNMaXN0KG4pLnRoZW4oKGZ1bmN0aW9uKCl7cy5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLHQuX3JlbGF5R2V0VG9waWNMaXN0KGUpfSkpLmNhdGNoKChmdW5jdGlvbihuKXt0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PXYoZSwyKSxvPXRbMF0sYT10WzFdO3Muc2V0RXJyb3IobixvLGEpLmVuZCgpfSkpLHQuX3JlbGF5R2V0VG9waWNMaXN0KGUpfSkpfX19LHtrZXk6XCJfaGFuZGxlVG9waWNBdEluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzOzAhPT1lLmxlbmd0aCYmZS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgbz1lLmdyb3VwSUQscz1lLnRvcGljSUQsYT1lLmdyb3VwQXRJbmZvTGlzdCxpPVtdO2l0KGEpfHwoYS5mb3JFYWNoKChmdW5jdGlvbihlKXtpLnB1c2godCh0KHt9LGUpLHt9LHtncm91cElEOm8sdG9waWNJRDpzfSkpfSkpLG4uZ2V0TW9kdWxlKHFuKS5vbk5ld0dyb3VwQXRUaXBzKHtkYXRhTGlzdDppfSkpfSkpfX0se2tleTpcIl9nZXRUb3BpY0xhc3RNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoIWl0KGUubGFzdE1zZykpe3ZhciB0PXt0aW1lOmUubGFzdE1zZy50aW1lLHNlcXVlbmNlOmUubGFzdE1zZy5zZXF1ZW5jZSxmcm9tOmUubGFzdE1zZy5mcm9tLHBheWxvYWQ6ZS5sYXN0TXNnLmVsZW1lbnRzWzBdP2UubGFzdE1zZy5lbGVtZW50c1swXS5jb250ZW50Om51bGwsdHlwZTplLmxhc3RNc2cuZWxlbWVudHNbMF0/ZS5sYXN0TXNnLmVsZW1lbnRzWzBdLnR5cGU6XCJcIixuaWNrOmUubGFzdE1zZy5uaWNrLHZlcnNpb246ZS5sYXN0TXNnLm1lc3NhZ2VWZXJzaW9uLGNsb3VkQ3VzdG9tRGF0YTplLmxhc3RNc2cuY2xvdWRDdXN0b21EYXRhLGlzUmV2b2tlZDoyPT09ZS5sYXN0TXNnLmlzUGxhY2VNZXNzYWdlLHJldm9rZXI6enQoZS5sYXN0TXNnLnJldm9rZXJJbmZvKT9udWxsOmUubGFzdE1zZy5yZXZva2VySW5mby5yZXZva2VyfTtlLmxhc3RNZXNzYWdlPXR9fX0se2tleTpcImRlbGV0ZVRvcGljTGlzdEluQ29tbXVuaXR5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPXRoaXMuX2dldExvY2FsVG9waWNMaXN0KGUpLG89dGhpcy5nZXRNb2R1bGUocW4pO24uZm9yRWFjaCgoZnVuY3Rpb24obil7dmFyIHM9bi50b3BpY0lEO3QuX2RlbGV0ZUxvY2FsVG9waWMoZSxzKSx0Ll9nZXRUb3BpY1RpbWVNYXAuZGVsZXRlKGUpLG8uZGVsZXRlTG9jYWxDb252ZXJzYXRpb24oXCJcIi5jb25jYXQoRS5DT05WX0dST1VQKS5jb25jYXQocykpfSkpfX0se2tleTpcIl9jb21wdXRlVW5yZWFkQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnNlbGZJbmZvLG49dC5leGNsdWRlZFVucmVhZFNlcXVlbmNlTGlzdCxvPXQucmVhZGVkU2VxdWVuY2Uscz1lLm5leHRNZXNzYWdlU2VxLWUuc2VsZkluZm8ucmVhZGVkU2VxdWVuY2UtMTtpZihhdChuKSl7dmFyIGE9MDtuLmZvckVhY2goKGZ1bmN0aW9uKHQpe3Q+PW8mJnQ8PWUubmV4dE1lc3NhZ2VTZXEtMSYmKGErPTEpfSkpLGE+PTEmJihzLT1hKX1yZXR1cm4gczwwPzA6c319LHtrZXk6XCJfZmlsdGVyUHJvZmFuaXR5XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdldE1vZHVsZShvbyk7aWYoIW4pcmV0dXJuITA7dmFyIG89bi5maWx0ZXJUZXh0KHRbZV0seikscz1vLmlzQWxsb3dlZFRvU2VuZCxhPW8ubW9kaWZpZWRUZXh0O3JldHVybiEwPT09cyYmKHRbZV09YSwhMCl9fSx7a2V5OlwidXBkYXRlTGFzdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXh0KGUpLG89dGhpcy5nZXRMb2NhbFRvcGljKG4sZSk7aWYobyl7dmFyIHM9dC5zZXF1ZW5jZSsxO28udXBkYXRlTmV4dE1lc3NhZ2VTZXEocyksby51cGRhdGVMYXN0TWVzc2FnZSh0KSx0aGlzLmVtaXRPdXRlckV2ZW50KGsuVE9QSUNfVVBEQVRFRCx7Z3JvdXBJRDpuLHRvcGljOm99KX19fSx7a2V5OlwiZ2V0TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRNZXNzYWdlRXh0ZW5zaW9ucyBzdGFydFNlcXVlbmNlOlwiKS5jb25jYXQodCkpO3ZhciBuPXh0KGUudG8pO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpTcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDpuLHRvcGljSUQ6ZS50byxtZXNzYWdlU2VxdWVuY2U6ZS5zZXF1ZW5jZSxzdGFydFNlcXVlbmNlOnR9fSl9fSx7a2V5OlwibW9kaWZ5TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXToxO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5tb2RpZnlNZXNzYWdlRXh0ZW5zaW9ucyBvcGVyYXRlVHlwZTpcIikuY29uY2F0KG4pKTt2YXIgbz14dChlLnRvKTtyZXR1cm4gdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6RXMscmVxdWVzdERhdGE6e2dyb3VwSUQ6byx0b3BpY0lEOmUudG8sbWVzc2FnZVNlcXVlbmNlOmUuc2VxdWVuY2UsZXh0ZW5zaW9uTGlzdDp0LG9wZXJhdGVUeXBlOm59fSl9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSksdGhpcy5fdG9waWNNYXAuY2xlYXIoKSx0aGlzLl9nZXRUb3BpY1RpbWVNYXAuY2xlYXIoKSx0aGlzLlRPUElDX0NBQ0hFX1RJTUU9MzAwLHRoaXMuVE9QSUNfTEFTVF9BQ1RJVkVfVElNRT0zNjAwfX1dKSxzfSh1byksWWk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl91c2VyTW9kdWxlPXQsdGhpcy5fbj1cIlByb2ZpbGVIYW5kbGVyXCIsdGhpcy5UQUc9XCJwcm9maWxlXCIsdGhpcy5hY2NvdW50UHJvZmlsZU1hcD1uZXcgTWFwLHRoaXMuZXhwaXJhdGlvblRpbWU9ODY0ZTV9cmV0dXJuIGEoZSxbe2tleTpcInNldEV4cGlyYXRpb25UaW1lXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5leHBpcmF0aW9uVGltZT1lfX0se2tleTpcImdldFVzZXJQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcImdldFVzZXJQcm9maWxlXCIpLG89ZS51c2VySURMaXN0O2UuZnJvbUFjY291bnQ9dGhpcy5fdXNlck1vZHVsZS5nZXRNeUFjY291bnQoKSxvLmxlbmd0aD4xMDAmJihWZS53KFwiXCIuY29uY2F0KG4sXCIgXCIpLmNvbmNhdChXdCgxMDApKSksby5sZW5ndGg9MTAwKTtmb3IodmFyIHMsYT1bXSxpPVtdLHI9MCx1PW8ubGVuZ3RoO3I8dTtyKyspcz1vW3JdLHRoaXMuX3VzZXJNb2R1bGUuaXNNeUZyaWVuZChzKSYmdGhpcy5fY29udGFpbnMocyk/aS5wdXNoKHRoaXMuX2dldFByb2ZpbGVGcm9tTWFwKHMpKTphLnB1c2gocyk7aWYoMD09PWEubGVuZ3RoKXJldHVybiBYYShpKTtlLnRvQWNjb3VudD1hO3ZhciBjPWUuYkZyb21HZXRNeVByb2ZpbGV8fCExLGw9W107ZS50b0FjY291bnQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bC5wdXNoKHt0b0FjY291bnQ6ZSxzdGFuZGFyZFNlcXVlbmNlOjAsY3VzdG9tU2VxdWVuY2U6MH0pfSkpLGUudXNlckl0ZW09bDt2YXIgZD1uZXcgQWEoXCJnZXRVc2VyUHJvZmlsZVwiKTtyZXR1cm4gZC5zZXRNZXNzYWdlKG8ubGVuZ3RoPjU/XCJ1c2VySURMaXN0Lmxlbmd0aDpcIi5jb25jYXQoby5sZW5ndGgpOlwidXNlcklETGlzdDpcIi5jb25jYXQobykpLHRoaXMuX3VzZXJNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOm1vLHJlcXVlc3REYXRhOmV9KS50aGVuKChmdW5jdGlvbihlKXtkLnNldE5ldHdvcmtUeXBlKHQuX3VzZXJNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUuaShcIlwiLmNvbmNhdChuLFwiIG9rXCIpKTt2YXIgbz10Ll9oYW5kbGVSZXNwb25zZShlKS5jb25jYXQoaSk7cmV0dXJuIFlhKGM/b1swXTpvKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX3VzZXJNb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07ZC5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcImdldE15UHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fdXNlck1vZHVsZS5nZXRNeUFjY291bnQoKSx0PVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZ2V0TXlQcm9maWxlXCIpO2lmKFZlLmwoXCJcIi5jb25jYXQodCxcIiBteUFjY291bnQ6XCIpLmNvbmNhdChlKSksdGhpcy5fZmlsbCgpLHRoaXMuX2NvbnRhaW5zKGUpKXt2YXIgbj10aGlzLl9nZXRQcm9maWxlRnJvbU1hcChlKTtyZXR1cm4gVmUuZChcIlwiLmNvbmNhdCh0LFwiIGZyb20gY2FjaGUsIG15UHJvZmlsZTpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KG4pKSksWGEobil9cmV0dXJuIHRoaXMuZ2V0VXNlclByb2ZpbGUoe2Zyb21BY2NvdW50OmUsdXNlcklETGlzdDpbZV0sYkZyb21HZXRNeVByb2ZpbGU6ITB9KX19LHtrZXk6XCJfaGFuZGxlUmVzcG9uc2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmRhdGEudXNlclByb2ZpbGVJdGVtO2lmKCFhdCh0KSlyZXR1cm5bXTtmb3IodmFyIG49W10sbz1EYXRlLm5vdygpLHM9MCxhPXQubGVuZ3RoO3M8YTtzKyspe3ZhciBpPXRbc10scj1pLnRvLHU9aS5wcm9maWxlSXRlbTtpZihcIkBUTFMjTk9UX0ZPVU5EXCIhPT1yJiZcIlwiIT09cil7dmFyIGM9dGhpcy5fdXBkYXRlKHIsdGhpcy5fZ2V0TGF0ZXN0UHJvZmlsZUZyb21SZXNwb25zZShyLHUpKS5sYXRlc3RQcm9maWxlO24ucHVzaChjKX19cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5faGFuZGxlUmVzcG9uc2UgY29zdCBcIikuY29uY2F0KERhdGUubm93KCktbyxcIiBtc1wiKSksbn19LHtrZXk6XCJfZ2V0TGF0ZXN0UHJvZmlsZUZyb21SZXNwb25zZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49e3VzZXJJRDplLHByb2ZpbGVDdXN0b21GaWVsZDpbXX07aWYoIXp0KHQpKWZvcih2YXIgbz0wLHM9dC5sZW5ndGg7bzxzO28rKylpZih0W29dLnRhZy5pbmRleE9mKFwiVGFnX1Byb2ZpbGVfQ3VzdG9tXCIpPi0xKW4ucHJvZmlsZUN1c3RvbUZpZWxkLnB1c2goe2tleTp0W29dLnRhZyx2YWx1ZTp0W29dLnZhbHVlfSk7ZWxzZSBzd2l0Y2godFtvXS50YWcpe2Nhc2UgSGUuTklDSzpuLm5pY2s9dFtvXS52YWx1ZTticmVhaztjYXNlIEhlLkdFTkRFUjpuLmdlbmRlcj10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuQklSVEhEQVk6bi5iaXJ0aGRheT10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuTE9DQVRJT046bi5sb2NhdGlvbj10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuU0VMRlNJR05BVFVSRTpuLnNlbGZTaWduYXR1cmU9dFtvXS52YWx1ZTticmVhaztjYXNlIEhlLkFMTE9XVFlQRTpuLmFsbG93VHlwZT10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuTEFOR1VBR0U6bi5sYW5ndWFnZT10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuQVZBVEFSOm4uYXZhdGFyPXRbb10udmFsdWU7YnJlYWs7Y2FzZSBIZS5NRVNTQUdFU0VUVElOR1M6bi5tZXNzYWdlU2V0dGluZ3M9dFtvXS52YWx1ZTticmVhaztjYXNlIEhlLkFETUlORk9SQklEVFlQRTpuLmFkbWluRm9yYmlkVHlwZT10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuTEVWRUw6bi5sZXZlbD10W29dLnZhbHVlO2JyZWFrO2Nhc2UgSGUuUk9MRTpuLnJvbGU9dFtvXS52YWx1ZTticmVhaztkZWZhdWx0OlZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fZ2V0TGF0ZXN0UHJvZmlsZUZyb21SZXNwb25zZSB1bmtub3duIHRhZzpcIiksdFtvXS50YWcsdFtvXS52YWx1ZSl9cmV0dXJuIG59fSx7a2V5OlwidXBkYXRlTXlQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInVwZGF0ZU15UHJvZmlsZVwiKTtpZihlLm5pY2smJiExPT09dGhpcy5fdXNlck1vZHVsZS5maWx0ZXJQcm9mYW5pdHkoXCJuaWNrXCIsZSkpcmV0dXJuIFphKHtjb2RlOmhhLlBST0ZBTklUWV9GT1VORH0pO2lmKGUuc2VsZlNpZ25hdHVyZSYmITE9PT10aGlzLl91c2VyTW9kdWxlLmZpbHRlclByb2Zhbml0eShcInNlbGZTaWduYXR1cmVcIixlKSlyZXR1cm4gWmEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSk7dmFyIG89bmV3IEFhKFwidXBkYXRlTXlQcm9maWxlXCIpO28uc2V0TWVzc2FnZShKU09OLnN0cmluZ2lmeShlKSk7dmFyIHM9KG5ldyBsaSkudmFsaWRhdGUoZSk7aWYoIXMudmFsaWQpcmV0dXJuIG8uc2V0Q29kZShoYS5VUERBVEVfUFJPRklMRV9JTlZBTElEX1BBUkFNKS5zZXRNb3JlTWVzc2FnZShcImluZm86XCIuY29uY2F0KHMudGlwcykpLnNldE5ldHdvcmtUeXBlKHRoaXMuX3VzZXJNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUuZShcIlwiLmNvbmNhdChuLFwiIGluZm86XCIpLmNvbmNhdChzLnRpcHMpKSxaYSh7Y29kZTpoYS5VUERBVEVfUFJPRklMRV9JTlZBTElEX1BBUkFNfSk7dmFyIGE9W107Zm9yKHZhciBpIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsaSkmJihcInByb2ZpbGVDdXN0b21GaWVsZFwiPT09aT9lLnByb2ZpbGVDdXN0b21GaWVsZC5mb3JFYWNoKChmdW5jdGlvbihlKXthLnB1c2goe3RhZzplLmtleSx2YWx1ZTplLnZhbHVlfSl9KSk6YS5wdXNoKHt0YWc6SGVbaS50b1VwcGVyQ2FzZSgpXSx2YWx1ZTplW2ldfSkpO2lmKDA9PT1hLmxlbmd0aCl7dmFyIHI9bmV3IGphKHtjb2RlOmhhLlVQREFURV9QUk9GSUxFX05PX0tFWX0pO3JldHVybiBvLnNldEVycm9yKHIsITAsdGhpcy5fdXNlck1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksciksWmEocil9dmFyIHU9dGhpcy5fdXNlck1vZHVsZS5nZXRNeUFjY291bnQoKTtyZXR1cm4gdGhpcy5fdXNlck1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6TW8scmVxdWVzdERhdGE6e2Zyb21BY2NvdW50OnUscHJvZmlsZUl0ZW06YX19KS50aGVuKChmdW5jdGlvbihzKXtvLnNldE5ldHdvcmtUeXBlKHQuX3VzZXJNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUuaShcIlwiLmNvbmNhdChuLFwiIG9rXCIpKTt2YXIgYT10Ll91cGRhdGUodSxlKSxpPWEuaXNQcm9maWxlVXBkYXRlZCxyPWEubGF0ZXN0UHJvZmlsZTtyZXR1cm4hMD09PWkmJnQuX3VzZXJNb2R1bGUuZW1pdE91dGVyRXZlbnQoay5QUk9GSUxFX1VQREFURUQsW3JdKSxYYShyKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIHQuX3VzZXJNb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLHM9blswXSxhPW5bMV07by5zZXRFcnJvcihlLHMsYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcIm9uUHJvZmlsZU1vZGlmaWVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5kYXRhTGlzdDtpZighenQodCkpe3ZhciBuLG89dC5sZW5ndGg7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uUHJvZmlsZU1vZGlmaWVkIGNvdW50OlwiKS5jb25jYXQobyxcIiBkYXRhTGlzdDpcIiksZS5kYXRhTGlzdCk7Zm9yKHZhciBzPVtdLGE9MDthPG87YSsrKXtuPXRbYV0udXNlcklEO3ZhciBpPXRoaXMuX3VwZGF0ZShuLHRoaXMuX2dldExhdGVzdFByb2ZpbGVGcm9tUmVzcG9uc2Uobix0W2FdLnByb2ZpbGVMaXN0KSkscj1pLmlzUHJvZmlsZVVwZGF0ZWQsdT1pLmxhdGVzdFByb2ZpbGU7ITA9PT1yJiZzLnB1c2godSl9cy5sZW5ndGg+MCYmKHRoaXMuX3VzZXJNb2R1bGUuZW1pdElubmVyRXZlbnQobmkscyksdGhpcy5fdXNlck1vZHVsZS5lbWl0T3V0ZXJFdmVudChrLlBST0ZJTEVfVVBEQVRFRCxzKSl9fX0se2tleTpcIl9maWxsXCIsdmFsdWU6ZnVuY3Rpb24oKXtpZigwPT09dGhpcy5hY2NvdW50UHJvZmlsZU1hcC5zaXplKXtmb3IodmFyIGU9dGhpcy5fZ2V0Q2FjaGVkUHJvZmlsZXMoKSx0PURhdGUubm93KCksbj0wLG89ZS5sZW5ndGg7bjxvO24rKyl0LWVbbl0ubGFzdFVwZGF0ZWRUaW1lPHRoaXMuZXhwaXJhdGlvblRpbWUmJnRoaXMuYWNjb3VudFByb2ZpbGVNYXAuc2V0KGVbbl0udXNlcklELGVbbl0pO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fZmlsbCBmcm9tIGNhY2hlLCBzaXplOlwiKS5jb25jYXQodGhpcy5hY2NvdW50UHJvZmlsZU1hcC5zaXplKSl9fX0se2tleTpcIl91cGRhdGVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuLG89ITEscz1EYXRlLm5vdygpO3RoaXMuX2NvbnRhaW5zKGUpPyhuPXRoaXMuX2dldFByb2ZpbGVGcm9tTWFwKGUpLHQucHJvZmlsZUN1c3RvbUZpZWxkJiYhMD09PUN0KG4ucHJvZmlsZUN1c3RvbUZpZWxkLHQucHJvZmlsZUN1c3RvbUZpZWxkKSYmKG4ubGFzdFVwZGF0ZWRUaW1lPXMsbz0hMCkscHQobix0LFtcInByb2ZpbGVDdXN0b21GaWVsZFwiXSk+MCYmKG4ubGFzdFVwZGF0ZWRUaW1lPXMsbz0hMCkpOihuPW5ldyBsaSh0KSwodGhpcy5fdXNlck1vZHVsZS5pc015RnJpZW5kKGUpfHxlPT09dGhpcy5fdXNlck1vZHVsZS5nZXRNeUFjY291bnQoKSkmJihuLmxhc3RVcGRhdGVkVGltZT1zLG89ITAsdGhpcy5hY2NvdW50UHJvZmlsZU1hcC5zZXQoZSxuKSkpO3JldHVybiB0aGlzLl9mbHVzaChlPT09dGhpcy5fdXNlck1vZHVsZS5nZXRNeUFjY291bnQoKSksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl91cGRhdGUgYWNjb3VudDpcIikuY29uY2F0KGUsXCIgaXNQcm9maWxlVXBkYXRlZDpcIikuY29uY2F0KG8pKSx7aXNQcm9maWxlVXBkYXRlZDpvLGxhdGVzdFByb2ZpbGU6bn19fSx7a2V5OlwiX2ZsdXNoXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9bSh0aGlzLmFjY291bnRQcm9maWxlTWFwLnZhbHVlcygpKSxuPXRoaXMuX3VzZXJNb2R1bGUuZ2V0U3RvcmFnZU1vZHVsZSgpO1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fZmx1c2ggbGVuZ3RoOlwiKS5jb25jYXQodC5sZW5ndGgsXCIgZmx1c2hBdE9uY2U6XCIpLmNvbmNhdChlKSksbi5zZXRJdGVtKHRoaXMuVEFHLHQsZSl9fSx7a2V5OlwiX2NvbnRhaW5zXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuYWNjb3VudFByb2ZpbGVNYXAuaGFzKGUpfX0se2tleTpcIl9nZXRQcm9maWxlRnJvbU1hcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmFjY291bnRQcm9maWxlTWFwLmdldChlKX19LHtrZXk6XCJfZ2V0Q2FjaGVkUHJvZmlsZXNcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX3VzZXJNb2R1bGUuZ2V0U3RvcmFnZU1vZHVsZSgpLmdldEl0ZW0odGhpcy5UQUcpO3JldHVybiB6dChlKT9bXTplfX0se2tleTpcIm9uQ29udmVyc2F0aW9uc1Byb2ZpbGVVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4sbyxzPVtdLGE9MCxpPWUubGVuZ3RoO2E8aTthKyspbj0odD1lW2FdKS51c2VySUQsdGhpcy5fdXNlck1vZHVsZS5pc015RnJpZW5kKG4pJiYodGhpcy5fY29udGFpbnMobik/KG89dGhpcy5fZ2V0UHJvZmlsZUZyb21NYXAobikscHQobyx0KT4wJiZzLnB1c2gobikpOnMucHVzaCh0LnVzZXJJRCkpOzAhPT1zLmxlbmd0aCYmKFZlLmkoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkNvbnZlcnNhdGlvbnNQcm9maWxlVXBkYXRlZCB0b0FjY291bnRMaXN0OlwiKS5jb25jYXQocykpLHRoaXMuZ2V0VXNlclByb2ZpbGUoe3VzZXJJRExpc3Q6c30pKX19LHtrZXk6XCJnZXROaWNrQW5kQXZhdGFyQnlVc2VySURcIix2YWx1ZTpmdW5jdGlvbihlKXtpZih0aGlzLl9jb250YWlucyhlKSl7dmFyIHQ9dGhpcy5fZ2V0UHJvZmlsZUZyb21NYXAoZSk7cmV0dXJue25pY2s6dC5uaWNrLGF2YXRhcjp0LmF2YXRhcn19cmV0dXJue25pY2s6XCJcIixhdmF0YXI6XCJcIn19fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2ZsdXNoKCEwKSx0aGlzLmFjY291bnRQcm9maWxlTWFwLmNsZWFyKCl9fV0pLGV9KCksamk9YSgoZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksenR8fCh0aGlzLnVzZXJJRD10LnVzZXJJRHx8XCJcIix0aGlzLnRpbWVTdGFtcD10LnRpbWVTdGFtcHx8MCl9KSksemk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl91c2VyTW9kdWxlPXQsdGhpcy5fbj1cIkJsYWNrbGlzdEhhbmRsZXJcIix0aGlzLl9ibGFja2xpc3RNYXA9bmV3IE1hcCx0aGlzLnN0YXJ0SW5kZXg9MCx0aGlzLm1heExpbWl0ZWQ9MTAwLHRoaXMuY3VycmVudFNlcXVlbmNlPTB9cmV0dXJuIGEoZSxbe2tleTpcImdldExvY2FsQmxhY2tsaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gbSh0aGlzLl9ibGFja2xpc3RNYXAua2V5cygpKX19LHtrZXk6XCJnZXRCbGFja2xpc3RcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldEJsYWNrbGlzdFwiKSxuPXtmcm9tQWNjb3VudDp0aGlzLl91c2VyTW9kdWxlLmdldE15QWNjb3VudCgpLG1heExpbWl0ZWQ6dGhpcy5tYXhMaW1pdGVkLHN0YXJ0SW5kZXg6MCxsYXN0U2VxdWVuY2U6dGhpcy5jdXJyZW50U2VxdWVuY2V9LG89bmV3IEFhKFwiZ2V0QmxhY2tsaXN0XCIpO3JldHVybiB0aGlzLl91c2VyTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp5byxyZXF1ZXN0RGF0YTpufSkudGhlbigoZnVuY3Rpb24obil7dmFyIHM9bi5kYXRhLGE9cy5ibGFja0xpc3RJdGVtLGk9cy5jdXJyZW50U2VxdWVuY2Uscj16dChhKT8wOmEubGVuZ3RoO28uc2V0TmV0d29ya1R5cGUoZS5fdXNlck1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiY291bnQ6XCIuY29uY2F0KHIpKS5lbmQoKSxWZS5pKFwiXCIuY29uY2F0KHQsXCIgb2tcIikpLGUuY3VycmVudFNlcXVlbmNlPWksZS5faGFuZGxlUmVzcG9uc2UoYSwhMCksZS5fdXNlck1vZHVsZS5lbWl0T3V0ZXJFdmVudChrLkJMQUNLTElTVF9VUERBVEVELG0oZS5fYmxhY2tsaXN0TWFwLmtleXMoKSkpfSkpLmNhdGNoKChmdW5jdGlvbihuKXtyZXR1cm4gZS5fdXNlck1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbihlKXt2YXIgdD12KGUsMikscz10WzBdLGE9dFsxXTtvLnNldEVycm9yKG4scyxhKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KHQsXCIgZmFpbGVkLiBlcnJvcjpcIiksbiksWmEobil9KSl9fSx7a2V5OlwiYWRkQmxhY2tsaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPW5ldyBBYShcImFkZFRvQmxhY2tsaXN0XCIpLG89XCJcIi5jb25jYXQodGhpcy5fbixcIi5hZGRCbGFja2xpc3RcIikscz10aGlzLl91c2VyTW9kdWxlLmdldE15QWNjb3VudCgpO2lmKDE9PT1lLnVzZXJJRExpc3QubGVuZ3RoJiZlLnVzZXJJRExpc3RbMF09PT1zKXt2YXIgYT1oYS5DQU5OT1RfQUREX1NFTEZfVE9fQkxBQ0tMSVNULGk9dGhpcy5fdXNlck1vZHVsZS5nZXRFcnJvck1lc3NhZ2UoYSk7bi5zZXRDb2RlKGEpLnNldE1lc3NhZ2UoaSkuc2V0TmV0d29ya1R5cGUodGhpcy5fdXNlck1vZHVsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKTt2YXIgcj1uZXcgamEoe2NvZGU6YX0pO3JldHVybiBWZS5lKFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksciksWmEocil9cmV0dXJuIGUudXNlcklETGlzdC5pbmNsdWRlcyhzKSYmKGUudXNlcklETGlzdD1lLnVzZXJJRExpc3QuZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4gZSE9PXN9KSkpLGUuZnJvbUFjY291bnQ9dGhpcy5fdXNlck1vZHVsZS5nZXRNeUFjY291bnQoKSxlLnRvQWNjb3VudD1lLnVzZXJJRExpc3QsdGhpcy5fdXNlck1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6SW8scmVxdWVzdERhdGE6ZX0pLnRoZW4oKGZ1bmN0aW9uKHMpe3JldHVybiBuLnNldE5ldHdvcmtUeXBlKHQuX3VzZXJNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShlLnVzZXJJRExpc3QubGVuZ3RoPjU/XCJ1c2VySURMaXN0Lmxlbmd0aDpcIi5jb25jYXQoZS51c2VySURMaXN0Lmxlbmd0aCk6XCJ1c2VySURMaXN0OlwiLmNvbmNhdChlLnVzZXJJRExpc3QpKS5lbmQoKSxWZS5pKFwiXCIuY29uY2F0KG8sXCIgb2tcIikpLHQuX2hhbmRsZVJlc3BvbnNlKHMucmVzdWx0SXRlbSwhMCksWWEobSh0Ll9ibGFja2xpc3RNYXAua2V5cygpKSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll91c2VyTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBvPXYodCwyKSxzPW9bMF0sYT1vWzFdO24uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfaGFuZGxlUmVzcG9uc2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKCF6dChlKSlmb3IodmFyIG4sbyxzLGE9MCxpPWUubGVuZ3RoO2E8aTthKyspbz1lW2FdLnRvLHM9ZVthXS5yZXN1bHRDb2RlLChpdChzKXx8MD09PXMpJiYodD8oKG49dGhpcy5fYmxhY2tsaXN0TWFwLmhhcyhvKT90aGlzLl9ibGFja2xpc3RNYXAuZ2V0KG8pOm5ldyBqaSkudXNlcklEPW8sIXp0KGVbYV0uYWRkQmxhY2tUaW1lU3RhbXApJiYobi50aW1lU3RhbXA9ZVthXS5hZGRCbGFja1RpbWVTdGFtcCksdGhpcy5fYmxhY2tsaXN0TWFwLnNldChvLG4pKTp0aGlzLl9ibGFja2xpc3RNYXAuaGFzKG8pJiYobj10aGlzLl9ibGFja2xpc3RNYXAuZ2V0KG8pLHRoaXMuX2JsYWNrbGlzdE1hcC5kZWxldGUobykpKTtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2hhbmRsZVJlc3BvbnNlIHRvdGFsOlwiKS5jb25jYXQodGhpcy5fYmxhY2tsaXN0TWFwLnNpemUsXCIgYkFkZDpcIikuY29uY2F0KHQpKX19LHtrZXk6XCJkZWxldGVCbGFja2xpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5kZWxldGVCbGFja2xpc3RcIiksbz1uZXcgQWEoXCJyZW1vdmVGcm9tQmxhY2tsaXN0XCIpO3JldHVybiBlLmZyb21BY2NvdW50PXRoaXMuX3VzZXJNb2R1bGUuZ2V0TXlBY2NvdW50KCksZS50b0FjY291bnQ9ZS51c2VySURMaXN0LHRoaXMuX3VzZXJNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkNvLHJlcXVlc3REYXRhOmV9KS50aGVuKChmdW5jdGlvbihzKXtyZXR1cm4gby5zZXROZXR3b3JrVHlwZSh0Ll91c2VyTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoZS51c2VySURMaXN0Lmxlbmd0aD41P1widXNlcklETGlzdC5sZW5ndGg6XCIuY29uY2F0KGUudXNlcklETGlzdC5sZW5ndGgpOlwidXNlcklETGlzdDpcIi5jb25jYXQoZS51c2VySURMaXN0KSkuZW5kKCksVmUuaShcIlwiLmNvbmNhdChuLFwiIG9rXCIpKSx0Ll9oYW5kbGVSZXNwb25zZShzLmRhdGEucmVzdWx0SXRlbSwhMSksWWEobSh0Ll9ibGFja2xpc3RNYXAua2V5cygpKSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll91c2VyTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0sYT1uWzFdO28uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJvbkFjY291bnREZWxldGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49W10sbz0wLHM9ZS5sZW5ndGg7bzxzO28rKyl0PWVbb10sdGhpcy5fYmxhY2tsaXN0TWFwLmhhcyh0KSYmKHRoaXMuX2JsYWNrbGlzdE1hcC5kZWxldGUodCksbi5wdXNoKHQpKTtuLmxlbmd0aD4wJiYoVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uQWNjb3VudERlbGV0ZWQgY291bnQ6XCIpLmNvbmNhdChuLmxlbmd0aCxcIiB1c2VySURMaXN0OlwiKSxuKSx0aGlzLl91c2VyTW9kdWxlLmVtaXRPdXRlckV2ZW50KGsuQkxBQ0tMSVNUX1VQREFURUQsbSh0aGlzLl9ibGFja2xpc3RNYXAua2V5cygpKSkpfX0se2tleTpcIm9uQWNjb3VudEFkZGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49W10sbz0wLHM9ZS5sZW5ndGg7bzxzO28rKyl0PWVbb10sdGhpcy5fYmxhY2tsaXN0TWFwLmhhcyh0KXx8KHRoaXMuX2JsYWNrbGlzdE1hcC5zZXQodCxuZXcgamkoe3VzZXJJRDp0fSkpLG4ucHVzaCh0KSk7bi5sZW5ndGg+MCYmKFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbkFjY291bnRBZGRlZCBjb3VudDpcIikuY29uY2F0KG4ubGVuZ3RoLFwiIHVzZXJJRExpc3Q6XCIpLG4pLHRoaXMuX3VzZXJNb2R1bGUuZW1pdE91dGVyRXZlbnQoay5CTEFDS0xJU1RfVVBEQVRFRCxtKHRoaXMuX2JsYWNrbGlzdE1hcC5rZXlzKCkpKSl9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2JsYWNrbGlzdE1hcC5jbGVhcigpLHRoaXMuc3RhcnRJbmRleD0wLHRoaXMubWF4TGltaXRlZD0xMDAsdGhpcy5jdXJyZW50U2VxdWVuY2U9MH19XSksZX0oKSxKaT1mdW5jdGlvbihlKXt2YXIgdD1TdHJpbmcoZSkucmVwbGFjZSgvWz1dKyQvLFwiXCIpLG49XCJcIjtpZih0Lmxlbmd0aCU0PT0xKXJldHVyblwiXCI7Zm9yKHZhciBvLHMsYT0wLGk9MDtzPXQuY2hhckF0KGkrKyk7fnMmJihvPWElND82NCpvK3M6cyxhKyslNCk/bis9U3RyaW5nLmZyb21DaGFyQ29kZSgyNTUmbz4+KC0yKmEmNikpOjApcz1cIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCIuaW5kZXhPZihzKTt0cnl7cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChlc2NhcGUobikpfWNhdGNoKHIpe3JldHVyblwiXCJ9fSxYaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpLHRoaXMuX3VzZXJNb2R1bGU9dCx0aGlzLl9uPVwiVXNlclN0YXR1c0hhbmRsZXJcIix0aGlzLk1BWF9RVUVSWV9VU0VSX0NPVU5UPTUwMCx0aGlzLk1BWF9TVUJTQ1JJQkVfVVNFUl9DT1VOVD0xMDAsdGhpcy5NQVhfVU5TVUJTQ1JJQkVfVVNFUl9DT1VOVD0xMDAsdGhpcy5fdXNlck1vZHVsZS5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpLm9uKHRpLHRoaXMuX29uQ2xvdWRDb25maWdVcGRhdGVkLHRoaXMpfXJldHVybiBhKGUsW3trZXk6XCJfb25DbG91ZENvbmZpZ1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX3VzZXJNb2R1bGUuZ2V0Q2xvdWRDb25maWcoXCJzdGF0dXNfcXVlcnlfY291bnRcIiksdD10aGlzLl91c2VyTW9kdWxlLmdldENsb3VkQ29uZmlnKFwic3RhdHVzX3N1Yl9jb3VudFwiKSxuPXRoaXMuX3VzZXJNb2R1bGUuZ2V0Q2xvdWRDb25maWcoXCJzdGF0dXNfdW5zdWJfY291bnRcIik7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vbkNsb3VkQ29uZmlnVXBkYXRlZCBzdGF0dXNRdWVyeUNvdW50OlwiKS5jb25jYXQoZSxcIiBzdGF0dXNTdWJzY3JpYmVDb3VudDpcIikuY29uY2F0KHQpK1wiIHN0YXR1c1Vuc3Vic2NyaWJlQ291bnQ6XCIuY29uY2F0KG4pKSxpdChlKXx8KHRoaXMuTUFYX1FVRVJZX1VTRVJfQ09VTlQ9cGFyc2VJbnQoZSwxMCkpLGl0KGUpfHwodGhpcy5NQVhfU1VCU0NSSUJFX1VTRVJfQ09VTlQ9cGFyc2VJbnQodCwxMCkpLGl0KGUpfHwodGhpcy5NQVhfVU5TVUJTQ1JJQkVfVVNFUl9DT1VOVD1wYXJzZUludChuLDEwKSl9fSx7a2V5Olwib25Vc2VyU3RhdHVzVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZGF0YUxpc3Qsbj10aGlzLl91c2VyTW9kdWxlLmdldE15VXNlcklEKCksbz10aGlzLl91c2VyTW9kdWxlLmdldE1vZHVsZSh4bikscz10Lm1hcCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS50byxzPWUuc3RhdHVzVHlwZSxhPWUuY3VzdG9tU3RhdHVzLGk9SmkoYSk7cmV0dXJuIHQ9PT1uJiZvLnNldEN1c3RvbVN0YXR1cyhpKSx7dXNlcklEOnQsc3RhdHVzVHlwZTpzLGN1c3RvbVN0YXR1czppfX0pKTt0aGlzLl91c2VyTW9kdWxlLmVtaXRPdXRlckV2ZW50KGsuVVNFUl9TVEFUVVNfVVBEQVRFRCxzKX19LHtrZXk6XCJzZXRTZWxmU3RhdHVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuc2V0U2VsZlN0YXR1c1wiKTtpZighMT09PXRoaXMuX3VzZXJNb2R1bGUuZmlsdGVyUHJvZmFuaXR5KFwiY3VzdG9tU3RhdHVzXCIsZSkpcmV0dXJuIFphKHtjb2RlOmhhLlBST0ZBTklUWV9GT1VORH0pO3ZhciBvPW5ldyBBYShcInNldFNlbGZTdGF0dXNcIikscz1lLmN1c3RvbVN0YXR1cztyZXR1cm4gdGhpcy5fdXNlck1vZHVsZS5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6YWEscmVxdWVzdERhdGE6e2N1c3RvbVN0YXR1czpzfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBvLnNldE5ldHdvcmtUeXBlKHQuX3VzZXJNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcImN1c3RvbVN0YXR1czpcIi5jb25jYXQocykpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gY3VzdG9tU3RhdHVzOlwiKS5jb25jYXQocykpLHQuX3VzZXJNb2R1bGUuZ2V0TW9kdWxlKHhuKS5zZXRDdXN0b21TdGF0dXMocyksWWEoe3VzZXJJRDp0Ll91c2VyTW9kdWxlLmdldE15VXNlcklEKCksc3RhdHVzVHlwZToxLGN1c3RvbVN0YXR1czpzfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll91c2VyTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxzPW5bMF0sYT1uWzFdO28uc2V0RXJyb3IoZSxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJnZXRVc2VyU3RhdHVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZ2V0VXNlclN0YXR1c1wiKSxvPWUudXNlcklETGlzdCxzPXZvaWQgMD09PW8/W106byxhPXRoaXMuX3VzZXJNb2R1bGUuZ2V0TXlVc2VySUQoKSxpPW0ocykscj12b2lkIDAsdT1pLmluZGV4T2YoYSk7aWYodT4tMSl7aS5zcGxpY2UodSwxKTt2YXIgYz10aGlzLl91c2VyTW9kdWxlLmdldE1vZHVsZSh4bikuZ2V0Q3VzdG9tU3RhdHVzKCk7cj17dXNlcklEOmEsc3RhdHVzVHlwZToxLGN1c3RvbVN0YXR1czpjfX1pZigwPT09aS5sZW5ndGgpcmV0dXJuIFhhKHtzdWNjZXNzVXNlckxpc3Q6W3JdLGZhaWx1cmVVc2VyTGlzdDpbXX0pO2lmKCF0aGlzLl91c2VyTW9kdWxlLmNhbklVc2UoQi5VU0VSX1NUQVRVUykpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7aS5sZW5ndGg+dGhpcy5NQVhfUVVFUllfVVNFUl9DT1VOVCYmKFZlLncoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KFd0KHRoaXMuTUFYX1FVRVJZX1VTRVJfQ09VTlQpKSksaT1zLnNsaWNlKDAsdGhpcy5NQVhfUVVFUllfVVNFUl9DT1VOVCkpO3ZhciBsPW5ldyBBYShcImdldFVzZXJTdGF0dXNcIik7cmV0dXJuIHRoaXMuX3VzZXJNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmlhLHJlcXVlc3REYXRhOnt1c2VySURMaXN0Oml9fSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89ZS5kYXRhLGE9by5zdWNjZXNzVXNlckxpc3QsaT12b2lkIDA9PT1hP1tdOmEsdT1vLmZhaWx1cmVVc2VyTGlzdCxjPXZvaWQgMD09PXU/W106dSxkPWkubWFwKChmdW5jdGlvbihlKXt2YXIgdD1lLnVzZXJJRCxuPWUuc3RhdHVzVHlwZSxvPWUuY3VzdG9tU3RhdHVzO3JldHVybnt1c2VySUQ6dCxzdGF0dXNUeXBlOm4sY3VzdG9tU3RhdHVzOkppKG8pfX0pKSxwPWMubWFwKChmdW5jdGlvbihlKXt2YXIgdD1lLnVzZXJJRCxuPWUuaW52YWxpZFVzZXJJRCxvPWUuZXJyb3JDb2RlLHM9ZS5lcnJvckluZm87cmV0dXJue3VzZXJJRDp6dChuKT90Om4sY29kZTpvLG1lc3NhZ2U6c319KSk7aXQocil8fGQudW5zaGlmdChyKTt2YXIgZz1cInVzZXJJRCBjb3VudDpcIi5jb25jYXQocy5sZW5ndGgsXCIsIHN1Y2Nlc3MgY291bnQ6XCIpLmNvbmNhdChkLmxlbmd0aCxcIiwgZmFpbCBjb3VudDpcIikuY29uY2F0KHAubGVuZ3RoKTtyZXR1cm4gbC5zZXROZXR3b3JrVHlwZSh0Ll91c2VyTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQoZykpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gXCIpLmNvbmNhdChnLFwiLlwiKSksWWEoe3N1Y2Nlc3NVc2VyTGlzdDpkLGZhaWx1cmVVc2VyTGlzdDpwfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll91c2VyTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0sYT1uWzFdO2wuc2V0TWVzc2FnZShcInVzZXJJRCBjb3VudDpcIi5jb25jYXQocy5sZW5ndGgpKS5zZXRFcnJvcihlLG8sYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLGUpLFphKGUpfSkpfX0se2tleTpcInN1YnNjcmliZVVzZXJTdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0aGlzLl91c2VyTW9kdWxlLmNhbklVc2UoQi5VU0VSX1NUQVRVUykpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7dmFyIG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5zdWJzY3JpYmVVc2VyU3RhdHVzXCIpLG89ZS51c2VySURMaXN0LHM9dm9pZCAwPT09bz9bXTpvLGE9bShzKTthLmxlbmd0aD50aGlzLk1BWF9TVUJTQ1JJQkVfVVNFUl9DT1VOVCYmKFZlLncoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KFd0KHRoaXMuTUFYX1NVQlNDUklCRV9VU0VSX0NPVU5UKSkpLGE9cy5zbGljZSgwLHRoaXMuTUFYX1NVQlNDUklCRV9VU0VSX0NPVU5UKSk7dmFyIGk9bmV3IEFhKFwic3Vic2NyaWJlVXNlclN0YXR1c1wiKSxyPVwidXNlcklEIGNvdW50OlwiLmNvbmNhdChzLmxlbmd0aCk7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KHIpKSx0aGlzLl91c2VyTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpyYSxyZXF1ZXN0RGF0YTp7dXNlcklETGlzdDphfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBvPWUuZGF0YS5mYWlsdXJlVXNlckxpc3Qscz0odm9pZCAwPT09bz9bXTpvKS5tYXAoKGZ1bmN0aW9uKGUpe3ZhciB0PWUudXNlcklELG49ZS5pbnZhbGlkVXNlcklELG89ZS5lcnJvckNvZGUscz1lLmVycm9ySW5mbztyZXR1cm57dXNlcklEOnp0KG4pP3Q6bixjb2RlOm8sbWVzc2FnZTpzfX0pKTtyZXR1cm4gaS5zZXROZXR3b3JrVHlwZSh0Ll91c2VyTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQocixcIiBmYWlsIGNvdW50OlwiKS5jb25jYXQocy5sZW5ndGgpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIGZhaWwgY291bnQ6XCIpLmNvbmNhdChzLmxlbmd0aCxcIi5cIikpLFlhKHtmYWlsdXJlVXNlckxpc3Q6c30pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fdXNlck1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQocikpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwidW5zdWJzY3JpYmVVc2VyU3RhdHVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighdGhpcy5fdXNlck1vZHVsZS5jYW5JVXNlKEIuVVNFUl9TVEFUVVMpKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWX0pO3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIudW5zdWJzY3JpYmVVc2VyU3RhdHVzXCIpLG89KGV8fHt9KS51c2VySURMaXN0LHM9dm9pZCAwPT09bz9bXTpvLGE9bShzKTtzLmxlbmd0aD50aGlzLk1BWF9VTlNVQlNDUklCRV9VU0VSX0NPVU5UJiYoVmUudyhcIlwiLmNvbmNhdChuLFwiIFwiKS5jb25jYXQoV3QodGhpcy5NQVhfVU5TVUJTQ1JJQkVfVVNFUl9DT1VOVCkpKSxhPXMuc2xpY2UoMCx0aGlzLk1BWF9VTlNVQlNDUklCRV9VU0VSX0NPVU5UKSk7dmFyIGk9bmV3IEFhKFwidW5zdWJzY3JpYmVVc2VyU3RhdHVzXCIpLHI9XCJ1c2VySUQgY291bnQ6XCIuY29uY2F0KHMubGVuZ3RoKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgXCIpLmNvbmNhdChyKSk7dmFyIHU9e3VzZXJJRExpc3Q6YX07cmV0dXJuIDA9PT1hLmxlbmd0aCYmKHUudXNlcklETGlzdD12b2lkIDAsdS51bnN1YnNjcmliZUFsbD0xKSx0aGlzLl91c2VyTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp1YSxyZXF1ZXN0RGF0YTp1fSkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89ZS5kYXRhLmZhaWx1cmVVc2VyTGlzdCxzPSh2b2lkIDA9PT1vP1tdOm8pLm1hcCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS51c2VySUQsbj1lLmludmFsaWRVc2VySUQsbz1lLmVycm9yQ29kZSxzPWUuZXJyb3JJbmZvO3JldHVybnt1c2VySUQ6enQobik/dDpuLGNvZGU6byxtZXNzYWdlOnN9fSkpO3JldHVybiBpLnNldE5ldHdvcmtUeXBlKHQuX3VzZXJNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChyLFwiIGZhaWwgY291bnQ6XCIpLmNvbmNhdChzLmxlbmd0aCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBvay4gZmFpbCBjb3VudDpcIikuY29uY2F0KHMubGVuZ3RoLFwiLlwiKSksWWEoe2ZhaWx1cmVVc2VyTGlzdDpzfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0Ll91c2VyTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2kuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChyKSkuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5NQVhfUVVFUllfVVNFUl9DT1VOVD01MDAsdGhpcy5NQVhfU1VCU0NSSUJFX1VTRVJfQ09VTlQ9MTAwLHRoaXMuTUFYX1VOU1VCU0NSSUJFX1VTRVJfQ09VTlQ9MTAwfX1dKSxlfSgpLFppPWZ1bmN0aW9uKGUpe3IobixlKTt2YXIgdD1mKG4pO2Z1bmN0aW9uIG4oZSl7dmFyIHM7cmV0dXJuIG8odGhpcyxuKSwocz10LmNhbGwodGhpcyxlKSkuX249XCJVc2VyTW9kdWxlXCIscy5fcHJvZmlsZUhhbmRsZXI9bmV3IFlpKGgocykpLHMuX2JsYWNrbGlzdEhhbmRsZXI9bmV3IHppKGgocykpLHMuX3VzZXJTdGF0dXNIYW5kbGVyPW5ldyBYaShoKHMpKSxzLmdldElubmVyRW1pdHRlckluc3RhbmNlKCkub24oZWkscy5vbkNvbnRleHRVcGRhdGVkLGgocykpLHN9cmV0dXJuIGEobixbe2tleTpcIm9uQ29udGV4dFVwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9wcm9maWxlSGFuZGxlci5nZXRNeVByb2ZpbGUoKSx0aGlzLl9ibGFja2xpc3RIYW5kbGVyLmdldEJsYWNrbGlzdCgpfX0se2tleTpcIm9uUHJvZmlsZU1vZGlmaWVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcHJvZmlsZUhhbmRsZXIub25Qcm9maWxlTW9kaWZpZWQoZSl9fSx7a2V5Olwib25SZWxhdGlvbkNoYWluTW9kaWZpZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmRhdGFMaXN0O2lmKCF6dCh0KSl7dmFyIG49W107dC5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmJsYWNrTGlzdERlbEFjY291bnQmJm4ucHVzaC5hcHBseShuLG0oZS5ibGFja0xpc3REZWxBY2NvdW50KSl9KSksbi5sZW5ndGg+MCYmdGhpcy5fYmxhY2tsaXN0SGFuZGxlci5vbkFjY291bnREZWxldGVkKG4pO3ZhciBvPVtdO3QuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5ibGFja0xpc3RBZGRBY2NvdW50JiZvLnB1c2guYXBwbHkobyxtKGUuYmxhY2tMaXN0QWRkQWNjb3VudCkpfSkpLG8ubGVuZ3RoPjAmJnRoaXMuX2JsYWNrbGlzdEhhbmRsZXIub25BY2NvdW50QWRkZWQobyl9fX0se2tleTpcIm9uQ29udmVyc2F0aW9uc1Byb2ZpbGVVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcHJvZmlsZUhhbmRsZXIub25Db252ZXJzYXRpb25zUHJvZmlsZVVwZGF0ZWQoZSl9fSx7a2V5OlwiZ2V0TXlBY2NvdW50XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRNeVVzZXJJRCgpfX0se2tleTpcImdldE15UHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2ZpbGVIYW5kbGVyLmdldE15UHJvZmlsZSgpfX0se2tleTpcImdldFN0b3JhZ2VNb2R1bGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldE1vZHVsZShWbil9fSx7a2V5OlwiZmlsdGVyUHJvZmFuaXR5XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmdldE1vZHVsZShvbyk7aWYoIW4pcmV0dXJuITA7dmFyIG89bi5maWx0ZXJUZXh0KHRbZV0saikscz1vLmlzQWxsb3dlZFRvU2VuZCxhPW8ubW9kaWZpZWRUZXh0O3JldHVybiEwPT09cyYmKHRbZV09YSwhMCl9fSx7a2V5OlwiaXNNeUZyaWVuZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZ2V0TW9kdWxlKGJuKTtyZXR1cm4hIXQmJnQuaXNNeUZyaWVuZChlKX19LHtrZXk6XCJnZXRVc2VyUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9wcm9maWxlSGFuZGxlci5nZXRVc2VyUHJvZmlsZShlKX19LHtrZXk6XCJ1cGRhdGVNeVByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fcHJvZmlsZUhhbmRsZXIudXBkYXRlTXlQcm9maWxlKGUpfX0se2tleTpcImdldE5pY2tBbmRBdmF0YXJCeVVzZXJJRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9wcm9maWxlSGFuZGxlci5nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQoZSl9fSx7a2V5OlwiZ2V0TG9jYWxCbGFja2xpc3RcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX2JsYWNrbGlzdEhhbmRsZXIuZ2V0TG9jYWxCbGFja2xpc3QoKTtyZXR1cm4gWGEoZSl9fSx7a2V5OlwiYWRkQmxhY2tsaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2JsYWNrbGlzdEhhbmRsZXIuYWRkQmxhY2tsaXN0KGUpfX0se2tleTpcImRlbGV0ZUJsYWNrbGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9ibGFja2xpc3RIYW5kbGVyLmRlbGV0ZUJsYWNrbGlzdChlKX19LHtrZXk6XCJvblVzZXJTdGF0dXNVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fdXNlclN0YXR1c0hhbmRsZXIub25Vc2VyU3RhdHVzVXBkYXRlZChlKX19LHtrZXk6XCJzZXRTZWxmU3RhdHVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3VzZXJTdGF0dXNIYW5kbGVyLnNldFNlbGZTdGF0dXMoZSl9fSx7a2V5OlwiZ2V0VXNlclN0YXR1c1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl91c2VyU3RhdHVzSGFuZGxlci5nZXRVc2VyU3RhdHVzKGUpfX0se2tleTpcInN1YnNjcmliZVVzZXJTdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fdXNlclN0YXR1c0hhbmRsZXIuc3Vic2NyaWJlVXNlclN0YXR1cyhlKX19LHtrZXk6XCJ1bnN1YnNjcmliZVVzZXJTdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fdXNlclN0YXR1c0hhbmRsZXIudW5zdWJzY3JpYmVVc2VyU3RhdHVzKGUpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX3Byb2ZpbGVIYW5kbGVyLnJlc2V0KCksdGhpcy5fYmxhY2tsaXN0SGFuZGxlci5yZXNldCgpLHRoaXMuX3VzZXJTdGF0dXNIYW5kbGVyLnJlc2V0KCl9fV0pLG59KHVvKSxRaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXtvKHRoaXMsZSksdGhpcy5fbT10LHRoaXMuX2lzTG9nZ2VkSW49ITEsdGhpcy5fU0RLQXBwSUQ9bi5TREtBcHBJRCx0aGlzLl91c2VySUQ9bi51c2VySUR8fFwiXCIsdGhpcy5fdXNlclNpZz1uLnVzZXJTaWd8fFwiXCIsdGhpcy5fdmVyc2lvbj1cIjIuMjcuNlwiLHRoaXMuX2EyS2V5PVwiXCIsdGhpcy5fdGlueUlEPVwiXCIsdGhpcy5fY3VzdG9tU3RhdHVzPVwiXCIsdGhpcy5fY29udGVudFR5cGU9XCJqc29uXCIsdGhpcy5fdW5saW1pdGVkQVZDaGF0Um9vbT1uLnVubGltaXRlZEFWQ2hhdFJvb20sdGhpcy5fc2NlbmU9bi5zY2VuZXx8XCJcIix0aGlzLl9vdmVyc2VhPW4ub3ZlcnNlYSx0aGlzLl9pbnN0YW5jZUlEPW4uaW5zdGFuY2VJRCx0aGlzLl9zdGF0dXNJbnN0YW5jZUlEPTAsdGhpcy5faXNEZXZNb2RlPW4uZGV2TW9kZSx0aGlzLl9wcm94eVNlcnZlcj1uLnByb3h5U2VydmVyLHRoaXMuX2ZpbGVVcGxvYWRQcm94eT1uLmZpbGVVcGxvYWRQcm94eSx0aGlzLl9maWxlRG93bmxvYWRQcm94eT1uLmZpbGVEb3dubG9hZFByb3h5fXJldHVybiBhKGUsW3trZXk6XCJpc0xvZ2dlZEluXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNMb2dnZWRJbn19LHtrZXk6XCJpc092ZXJzZWFcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vdmVyc2VhfX0se2tleTpcImlzUHJpdmF0ZU5ldFdvcmtcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wcm94eVNlcnZlcn19LHtrZXk6XCJpc0Rldk1vZGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc0Rldk1vZGV9fSx7a2V5OlwiaXNTaW5nYXBvcmVTaXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fU0RLQXBwSUQ+PTJlNyYmdGhpcy5fU0RLQXBwSUQ8M2U3fHx0aGlzLl9TREtBcHBJRD49MTcyZTcmJnRoaXMuX1NES0FwcElEPDE3M2U3fX0se2tleTpcImlzS29yZWFTaXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fU0RLQXBwSUQ+PTNlNyYmdGhpcy5fU0RLQXBwSUQ8NGU3fHx0aGlzLl9TREtBcHBJRD49MTczZTcmJnRoaXMuX1NES0FwcElEPDE3NGU3fX0se2tleTpcImlzR2VybWFueVNpdGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9TREtBcHBJRD49NGU3JiZ0aGlzLl9TREtBcHBJRDw1ZTd8fHRoaXMuX1NES0FwcElEPj0xNzRlNyYmdGhpcy5fU0RLQXBwSUQ8MTc1ZTd9fSx7a2V5OlwiaXNJbmRpYVNpdGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9TREtBcHBJRD49NWU3JiZ0aGlzLl9TREtBcHBJRDw2ZTd8fHRoaXMuX1NES0FwcElEPj0xNzVlNyYmdGhpcy5fU0RLQXBwSUQ8MTc2ZTd9fSx7a2V5OlwiaXNKYXBhblNpdGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9TREtBcHBJRD49NmU3JiZ0aGlzLl9TREtBcHBJRDw3ZTd8fHRoaXMuX1NES0FwcElEPj0xNzZlNyYmdGhpcy5fU0RLQXBwSUQ8MTc3ZTd9fSx7a2V5OlwiaXNVU0FTaXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fU0RLQXBwSUQ+PTdlNyYmdGhpcy5fU0RLQXBwSUQ8OGU3fHx0aGlzLl9TREtBcHBJRD49MTc3ZTcmJnRoaXMuX1NES0FwcElEPDE3OGU3fX0se2tleTpcImlzSW50bFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT0oZT10aGlzLl9TREtBcHBJRCl8fGU+PTJlNyYmZTw4ZTd8fGU+PTE3MmU3JiZlPDE3OGU3O3ZhciBlfX0se2tleTpcImlzVW5saW1pdGVkQVZDaGF0Um9vbVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3VubGltaXRlZEFWQ2hhdFJvb219fSx7a2V5Olwic2V0VXNlcklEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fdXNlcklEPWV9fSx7a2V5OlwiZ2V0VXNlcklEXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXNlcklEfX0se2tleTpcInNldFVzZXJTaWdcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl91c2VyU2lnPWV9fSx7a2V5OlwiZ2V0VXNlclNpZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3VzZXJTaWd9fSx7a2V5OlwiZ2V0U0RLQXBwSURcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9TREtBcHBJRH19LHtrZXk6XCJzZXRUaW55SURcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl90aW55SUQ9ZSx0aGlzLl9pc0xvZ2dlZEluPSEwfX0se2tleTpcImdldFRpbnlJRFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RpbnlJRH19LHtrZXk6XCJzZXRDdXN0b21TdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9jdXN0b21TdGF0dXM9ZX19LHtrZXk6XCJnZXRDdXN0b21TdGF0dXNcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXN0b21TdGF0dXN9fSx7a2V5OlwiZ2V0U2NlbmVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBBZT93aW5kb3cudGVuY2VudF9jbG91ZF9pbV9jc2lnX2ZsdXR0ZXJfZm9yX3dlYl8yNUZfY3k6dGhpcy5faXNUVUlLaXQoKT9cInR1aWtpdFwiOnRoaXMuX3NjZW5lfX0se2tleTpcImdldEluc3RhbmNlSURcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pbnN0YW5jZUlEfX0se2tleTpcImdldFN0YXR1c0luc3RhbmNlSURcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zdGF0dXNJbnN0YW5jZUlEfX0se2tleTpcInNldFN0YXR1c0luc3RhbmNlSURcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9zdGF0dXNJbnN0YW5jZUlEPWV9fSx7a2V5OlwiZ2V0VmVyc2lvblwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZlcnNpb259fSx7a2V5OlwiZ2V0QTJLZXlcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hMktleX19LHtrZXk6XCJzZXRBMktleVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2EyS2V5PWV9fSx7a2V5OlwiZ2V0Q29udGVudFR5cGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jb250ZW50VHlwZX19LHtrZXk6XCJnZXRQcm94eVNlcnZlclwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb3h5U2VydmVyfX0se2tleTpcImdldEZpbGVVcGxvYWRQcm94eVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZpbGVVcGxvYWRQcm94eX19LHtrZXk6XCJnZXRGaWxlRG93bmxvYWRQcm94eVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2ZpbGVEb3dubG9hZFByb3h5fX0se2tleTpcIl9pc1RVSUtpdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9ITEsdD0hMSxuPSExLG89ITEscz1bXTthZSYmKHM9T2JqZWN0LmtleXMocmUpKSxpZSYmKHM9c2U/T2JqZWN0LmtleXModW5pKTpPYmplY3Qua2V5cyh3aW5kb3cpKTtmb3IodmFyIGE9MCxpPXMubGVuZ3RoO2E8aTthKyspaWYoc1thXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwidWlraXRcIikpe2U9ITA7YnJlYWt9aWYocz1udWxsLGFlJiYhdXQocmUuY3JlYXRlR2FtZVBvcnRhbCkmJnV0KGdldEFwcCkmJiFpdChnZXRBcHAoKSkpe3ZhciByPWdldEFwcCgpLmdsb2JhbERhdGE7c3QocikmJiEwPT09ci5pc1RVSUtpdCYmKHQ9ITApfSEwPT09dGhpcy5fbS5nZXRNb2R1bGUoVm4pLmdldFN0b3JhZ2VTeW5jKFwiVElNX1wiLmNvbmNhdCh0aGlzLl9TREtBcHBJRCxcIl9pc1RVSUtpdFwiKSkmJihuPSEwKTt2YXIgdT1udWxsO2lmKFgmJiEkJiZcInVuZGVmaW5lZFwiPT10eXBlb2YgdW5pJiZfX3d4Q29uZmlnJiYodT1fX3d4Q29uZmlnLnBhZ2VzKSxRJiZcInVuZGVmaW5lZFwiPT10eXBlb2YgdW5pJiZfX3FxQ29uZmlnJiYodT1fX3FxQ29uZmlnLnBhZ2VzKSxhdCh1KSYmdS5sZW5ndGg+MCl7Zm9yKHZhciBjPTAsbD11Lmxlbmd0aDtjPGw7YysrKWlmKHVbY10udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInR1aVwiKSl7bz0hMDticmVha311PW51bGx9cmV0dXJuIGV8fHR8fG58fG99fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2lzTG9nZ2VkSW49ITEsdGhpcy5fdXNlclNpZz1cIlwiLHRoaXMuX2EyS2V5PVwiXCIsdGhpcy5fdGlueUlEPVwiXCIsdGhpcy5fY3VzdG9tU3RhdHVzPVwiXCIsdGhpcy5fc3RhdHVzSW5zdGFuY2VJRD0wfX1dKSxlfSgpLCRpPWZ1bmN0aW9uKGUpe3IobixlKTt2YXIgdD1mKG4pO2Z1bmN0aW9uIG4oZSl7dmFyIHM7cmV0dXJuIG8odGhpcyxuKSwocz10LmNhbGwodGhpcyxlKSkuX249XCJTaWduTW9kdWxlXCIscy5faGVsbG9JbnRlcnZhbD0xMjAscy5fbGFzdExvZ2luVHM9MCxzLl9sYXN0V3NIZWxsb1RzPTAscy5faXNXZWJVbmlhcHA9MCxvaS5taXhpbihoKHMpKSxzfXJldHVybiBhKG4sW3trZXk6XCJvbkNoZWNrVGltZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmlzTG9nZ2VkSW4oKSYmZSV0aGlzLl9oZWxsb0ludGVydmFsPT0wJiZ0aGlzLl9oZWxsbygpfX0se2tleTpcImxvZ2luXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9XCJcIjtpZih0aGlzLmlzTG9nZ2VkSW4oKSl7dmFyIG49dGhpcy5nZXRNeVVzZXJJRCgpO3JldHVybih0PXRoaXMuZ2V0RXJyb3JNZXNzYWdlKFwiUmVwZWF0TG9naW5cIixuKSkmJlZlLncodCksWGEoe2FjdGlvblN0YXR1czpcIk9LXCIsZXJyb3JDb2RlOjAsZXJyb3JJbmZvOnQscmVwZWF0TG9naW46ITB9KX1pZihEYXRlLm5vdygpLXRoaXMuX2xhc3RMb2dpblRzPD0xNWUzKXJldHVybiB0aGlzLm91dHB1dFdhcm5pbmcoXCJMb2dnaW5nSW5cIixlLnVzZXJJRCksWmEoe2NvZGU6aGEuUkVQRUFUX0xPR0lOfSk7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmxvZ2luIHVzZXJJRDpcIikuY29uY2F0KGUudXNlcklEKSk7dmFyIG89dGhpcy5fY2hlY2tMb2dpbkluZm8oZSk7aWYoMCE9PW8uY29kZSlyZXR1cm4gWmEobyk7dmFyIHM9dGhpcy5nZXRNb2R1bGUoeG4pLGE9ZS51c2VySUQsaT1lLnVzZXJTaWc7cmV0dXJuIHMuc2V0VXNlcklEKGEpLHMuc2V0VXNlclNpZyhpKSx0aGlzLmdldE1vZHVsZSh6bikudXBkYXRlUHJvdG9jb2xDb25maWcoKSx0aGlzLl9sb2dpbigpfX0se2tleTpcIl9sb2dpblwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PXRoaXMuZ2V0TW9kdWxlKHhuKSxuPXQuZ2V0U2NlbmUoKSxvPTAscz1uZXcgQWEoXCJsb2dpblwiKTtzLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQobikpLnNldE1vcmVNZXNzYWdlKFwiaWRlbnRpZmllcjpcIi5jb25jYXQodGhpcy5nZXRNeVVzZXJJRCgpKSksc2U/XCJ0dWlraXRcIj09PW4/cy5zZXRVSVBsYXRmb3JtKDQpOnMuc2V0VUlQbGF0Zm9ybSgzKTphZT9cInR1aWtpdFwiPT09bj9zLnNldFVJUGxhdGZvcm0oMTIpOnMuc2V0VUlQbGF0Zm9ybSgxMSk6aWUmJihBZT9cImZsdXR0ZXJfd2ViX3Vpa2l0XCI9PT1uP3Muc2V0VUlQbGF0Zm9ybSgyMSk6cy5zZXRVSVBsYXRmb3JtKDIwKTp0aGlzLl9pc1JlYWN0VUlLaXQoKT9MZT9zLnNldFVJUGxhdGZvcm0oMjUpOnMuc2V0VUlQbGF0Zm9ybSgyNCk6TGU/XCJ0dWlraXRcIj09PW4/cy5zZXRVSVBsYXRmb3JtKDE3KTpzLnNldFVJUGxhdGZvcm0oMTYpOlwidHVpa2l0XCI9PT1uP3Muc2V0VUlQbGF0Zm9ybSgxNCk6cy5zZXRVSVBsYXRmb3JtKDEzKSk7dmFyIGE9dGhpcy5nZXRNb2R1bGUobm8pO2lmKGEuY2FuSVVzZU9mZmxpbmVQdXNoKCkpe3RoaXMuX2lzV2ViVW5pYXBwPWEuZ2V0VW5pQXBwUGxhdGZvcm0oKTt2YXIgaT10aGlzLl9nZXRTdGF0dXNJbnN0YW5jZUlEKCk7dC5zZXRTdGF0dXNJbnN0YW5jZUlEKGkpLHRoaXMuZ2V0TW9kdWxlKHpuKS51cGRhdGVQcm90b2NvbENvbmZpZygpLG89YS5nZXREZXZpY2VCcmFuZCgpfXZhciByPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2xvZ2luXCIpO3JldHVybiB0aGlzLl9sYXN0TG9naW5Ucz1EYXRlLm5vdygpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmNvLHJlcXVlc3REYXRhOntkZXZpY2VCcmFuZDpvLGlzV2ViVW5pYXBwOnRoaXMuX2lzV2ViVW5pYXBwfX0pLnRoZW4oKGZ1bmN0aW9uKG8pe2UuX2xhc3RMb2dpblRzPTA7dmFyIGE9RGF0ZS5ub3coKSxpPW51bGwsdT1vLmRhdGEsYz11LmEyS2V5LGw9dS50aW55SUQsZD11LmhlbGxvSW50ZXJ2YWwscD11Lmluc3RhbmNlSUQsZz11LnRpbWVTdGFtcCxoPXUuY3VzdG9tU3RhdHVzLF89dm9pZCAwPT09aD9cIlwiOmgsZj11LnB1cmNoYXNlQml0cztWZS5sKFwiXCIuY29uY2F0KHIsXCIgb2suIHNjZW5lOlwiKS5jb25jYXQobixcIiBoZWxsb0ludGVydmFsOlwiKS5jb25jYXQoZCxcIiBpbnN0YW5jZUlEOlwiKS5jb25jYXQocCxcIiB0aW1lU3RhbXA6XCIpLmNvbmNhdChnKSk7dmFyIHY9MWUzKmcsbT1hLXMuZ2V0U3RhcnRUcygpLE09ditwYXJzZUludChtLzIpLWEseT1zLmdldFN0YXJ0VHMoKStNO2lmKHMuc3RhcnQoeSksZnVuY3Rpb24oZSx0KXtVZT10O3ZhciBuPW5ldyBEYXRlO24uc2V0VGltZShlKSxWZS5pKFwiYmFzZVRpbWUgZnJvbSBzZXJ2ZXI6XCIuY29uY2F0KG4sXCIgb2Zmc2V0OlwiKS5jb25jYXQoVWUpKX0odixNKSwhbCl0aHJvdyBpPW5ldyBqYSh7Y29kZTpoYS5OT19USU5ZSUR9KSxzLnNldEVycm9yKGksITAsZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxpO2lmKCFjKXRocm93IGk9bmV3IGphKHtjb2RlOmhhLk5PX0EyS0VZfSkscy5zZXRFcnJvcihpLCEwLGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksaTt2YXIgST1KaShfKTsocy5zZXROZXR3b3JrVHlwZShlLmdldE5ldHdvcmtUeXBlKCkpLnNldE1vcmVNZXNzYWdlKFwiaGVsbG9JbnRlcnZhbDpcIi5jb25jYXQoZCxcIiBpbnN0YW5jZUlEOlwiKS5jb25jYXQocCxcIiBvZmZzZXQ6XCIpLmNvbmNhdChNLFwiIGN1c3RvbVN0YXR1czpcIikuY29uY2F0KEkpKS5lbmQoKSx0LnNldEEyS2V5KGMpLHQuc2V0VGlueUlEKGwpLHQuc2V0U3RhdHVzSW5zdGFuY2VJRChwKSx0LnNldEN1c3RvbVN0YXR1cyhJKSxmKSYmZS5nZXRNb2R1bGUodG8pLm9uUHVzaGVkQ29uZmlnKHtlcnJvckNvZGU6MCxleHBpcmVkVGltZTowLHB1cmNoYXNlQml0czpmfSk7ZS5nZXRNb2R1bGUoem4pLnVwZGF0ZVByb3RvY29sQ29uZmlnKCksZS5lbWl0SW5uZXJFdmVudChlaSksZS5faGVsbG9JbnRlcnZhbD1kLGUudHJpZ2dlclJlYWR5KCk7dmFyIEM9ZS5nZXRNb2R1bGUobm8pO3JldHVybiBDLmNhbklVc2VPZmZsaW5lUHVzaCgpJiYodW5pLnNldFN0b3JhZ2VTeW5jKFwidGltVW5pQXBwSW5zdGFuY2VJRFwiLHApLEMuaW5pdCgpKSxlLl9mZXRjaENsb3VkQ29udHJvbENvbmZpZygpLGUuZ2V0TW9kdWxlKG9vKS5pbml0KCksb30pKS5jYXRjaCgoZnVuY3Rpb24odCl7cmV0dXJuIGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG49dihlLDIpLG89blswXSxhPW5bMV07cy5zZXRFcnJvcih0LG8sYSkuZW5kKCEwKX0pKSxlLl9tLnNldE5vdFJlYWR5UmVhc29uKGhhLkxPR0lOX0ZBSUxFRCksVmUuZShcIlwiLmNvbmNhdChyLFwiIGZhaWxlZC4gZXJyb3I6XCIpLHQpLGUuX2xhc3RMb2dpblRzPTAsZS5fbS5vbkxvZ2luRmFpbGVkKCksWmEodCl9KSl9fSx7a2V5OlwibG9nb3V0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOjA7aWYoIXRoaXMuaXNMb2dnZWRJbigpKXJldHVybiBaYSh7Y29kZTpoYS5VU0VSX05PVF9MT0dHRURfSU59KTt2YXIgbj1uZXcgQWEoXCJsb2dvdXRcIik7bi5zZXROZXR3b3JrVHlwZSh0aGlzLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJpZGVudGlmaWVyOlwiLmNvbmNhdCh0aGlzLmdldE15VXNlcklEKCkpKS5lbmQoITApO3ZhciBvPVwiXCIuY29uY2F0KHRoaXMuX24sXCIubG9nb3V0XCIpO3JldHVybiBWZS5pKFwiXCIuY29uY2F0KG8sXCIgdHlwZTpcIikuY29uY2F0KHQpKSwwPT09dCYmdGhpcy5fbS5zZXROb3RSZWFkeVJlYXNvbihoYS5MT0dHRURfT1VUKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpsbyxyZXF1ZXN0RGF0YTp7dHlwZTp0fX0pLnRoZW4oKGZ1bmN0aW9uKCl7cmV0dXJuIGUucmVzZXRSZWFkeSgpLFhhKHt9KX0pKS5jYXRjaCgoZnVuY3Rpb24odCl7cmV0dXJuIFZlLmUoXCJcIi5jb25jYXQobyxcIiBlcnJvcjpcIiksdCksZS5yZXNldFJlYWR5KCksWGEoe30pfSkpfX0se2tleTpcIl9mZXRjaENsb3VkQ29udHJvbENvbmZpZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5nZXRNb2R1bGUoWm4pLmZldGNoQ29uZmlnKCl9fSx7a2V5OlwiX2dldFN0YXR1c0luc3RhbmNlSURcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB1bmkuZ2V0U3RvcmFnZVN5bmMoXCJ0aW1VbmlBcHBJbnN0YW5jZUlEXCIpfX0se2tleTpcIl9oZWxsb1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9sYXN0V3NIZWxsb1RzPURhdGUubm93KCksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6cG8scmVxdWVzdERhdGE6e2lzV2ViVW5pYXBwOnRoaXMuX2lzV2ViVW5pYXBwfX0pLmNhdGNoKChmdW5jdGlvbih0KXtWZS53KFwiXCIuY29uY2F0KGUuX24sXCIuX2hlbGxvIGVycm9yOlwiKSx0KX0pKX19LHtrZXk6XCJnZXRMYXN0V3NIZWxsb1RzXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGFzdFdzSGVsbG9Uc319LHtrZXk6XCJfY2hlY2tMb2dpbkluZm9cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0wO3JldHVybiB6dCh0aGlzLmdldE1vZHVsZSh4bikuZ2V0U0RLQXBwSUQoKSk/dD1oYS5OT19TREtBUFBJRDp6dChlLnVzZXJJRCk/dD1oYS5OT19JREVOVElGSUVSOnp0KGUudXNlclNpZykmJih0PWhhLk5PX1VTRVJTSUcpLHtjb2RlOnR9fX0se2tleTpcIl9pc1JlYWN0VUlLaXRcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBpZSYmdm9pZCAwIT09d2luZG93LnRlbmNlbnRfY2xvdWRfaW1fY3NpZ19yZWFjdF91aWtpdF8yM0ZfeGF9fSx7a2V5Olwib25NdWx0aXBsZUFjY291bnRLaWNrZWRPdXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO25ldyBBYShcImtpY2tlZE91dFwiKS5zZXROZXR3b3JrVHlwZSh0aGlzLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJ0eXBlOlwiLmNvbmNhdChFLktJQ0tFRF9PVVRfTVVMVF9BQ0NPVU5ULFwiIG5ld0luc3RhbmNlSW5mbzpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KGUpKSkuZW5kKCEwKSxWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25NdWx0aXBsZUFjY291bnRLaWNrZWRPdXQgdXNlcklEOlwiKS5jb25jYXQodGhpcy5nZXRNeVVzZXJJRCgpLFwiIG5ld0luc3RhbmNlSW5mbzpcIiksZSksdGhpcy5sb2dvdXQoMSkudGhlbigoZnVuY3Rpb24oKXt0LmVtaXRPdXRlckV2ZW50KGsuS0lDS0VEX09VVCx7dHlwZTpFLktJQ0tFRF9PVVRfTVVMVF9BQ0NPVU5UfSksdC5fbS5zZXROb3RSZWFkeVJlYXNvbihoYS5LSUNLRURfT1VUX01VTFRfQUNDT1VOVCksdC5fbS5yZXNldCgpfSkpfX0se2tleTpcIm9uTXVsdGlwbGVEZXZpY2VLaWNrZWRPdXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO25ldyBBYShcImtpY2tlZE91dFwiKS5zZXROZXR3b3JrVHlwZSh0aGlzLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJ0eXBlOlwiLmNvbmNhdChFLktJQ0tFRF9PVVRfTVVMVF9ERVZJQ0UsXCIgbmV3SW5zdGFuY2VJbmZvOlwiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkoZSkpKS5lbmQoITApLFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbk11bHRpcGxlRGV2aWNlS2lja2VkT3V0IHVzZXJJRDpcIikuY29uY2F0KHRoaXMuZ2V0TXlVc2VySUQoKSxcIiBuZXdJbnN0YW5jZUluZm86XCIpLGUpLHRoaXMubG9nb3V0KDEpLnRoZW4oKGZ1bmN0aW9uKCl7dC5lbWl0T3V0ZXJFdmVudChrLktJQ0tFRF9PVVQse3R5cGU6RS5LSUNLRURfT1VUX01VTFRfREVWSUNFfSksdC5fbS5zZXROb3RSZWFkeVJlYXNvbihoYS5LSUNLRURfT1VUX01VTFRfREVWSUNFKSx0Ll9tLnJlc2V0KCl9KSl9fSx7a2V5Olwib25Vc2VyU2lnRXhwaXJlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7bmV3IEFhKFwia2lja2VkT3V0XCIpLnNldE5ldHdvcmtUeXBlKHRoaXMuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShFLktJQ0tFRF9PVVRfVVNFUlNJR19FWFBJUkVEKS5lbmQoITApLFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vblVzZXJTaWdFeHBpcmVkOiB1c2VyU2lnIGV4cGlyZWRcIikpLDAhPT10aGlzLmdldE1vZHVsZSh4bikuZ2V0U3RhdHVzSW5zdGFuY2VJRCgpJiYodGhpcy5lbWl0T3V0ZXJFdmVudChrLktJQ0tFRF9PVVQse3R5cGU6RS5LSUNLRURfT1VUX1VTRVJTSUdfRVhQSVJFRH0pLHRoaXMuX20uc2V0Tm90UmVhZHlSZWFzb24oaGEuS0lDS0VEX09VVF9VU0VSU0lHX0VYUElSRUQpLHRoaXMuX20ucmVzZXQoKSl9fSx7a2V5Olwib25SZXN0QXBpS2lja2VkT3V0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7KG5ldyBBYShcImtpY2tlZE91dFwiKS5zZXROZXR3b3JrVHlwZSh0aGlzLmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXCJ0eXBlOlwiLmNvbmNhdChFLktJQ0tFRF9PVVRfUkVTVF9BUEksXCIgbmV3SW5zdGFuY2VJbmZvOlwiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkoZSkpKS5lbmQoITApLFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vblJlc3RBcGlLaWNrZWRPdXQgdXNlcklEOlwiKS5jb25jYXQodGhpcy5nZXRNeVVzZXJJRCgpLFwiIG5ld0luc3RhbmNlSW5mbzpcIiksZSksMCE9PXRoaXMuZ2V0TW9kdWxlKHhuKS5nZXRTdGF0dXNJbnN0YW5jZUlEKCkpJiYodGhpcy5lbWl0T3V0ZXJFdmVudChrLktJQ0tFRF9PVVQse3R5cGU6RS5LSUNLRURfT1VUX1JFU1RfQVBJfSksdGhpcy5fbS5zZXROb3RSZWFkeVJlYXNvbihoYS5LSUNLRURfT1VUX1JFU1RfQVBJKSx0aGlzLl9tLnJlc2V0KCksdGhpcy5nZXRNb2R1bGUoSm4pLm9uUmVzdEFwaUtpY2tlZE91dCgpKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKSx0aGlzLnJlc2V0UmVhZHkoKSx0aGlzLl9oZWxsb0ludGVydmFsPTEyMCx0aGlzLl9sYXN0TG9naW5Ucz0wLHRoaXMuX2xhc3RXc0hlbGxvVHM9MCx0aGlzLl9pc1dlYlVuaWFwcD0wfX1dKSxufSh1byk7ZnVuY3Rpb24gZXIoKXtyZXR1cm4gbnVsbH12YXIgdHI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9tPXQsdGhpcy5fbj1cIlN0b3JhZ2VNb2R1bGVcIix0aGlzLl9zdG9yYWdlUXVldWU9bmV3IE1hcCx0aGlzLl9lcnJvclRvbGVyYW50SGFuZGxlKCl9cmV0dXJuIGEoZSxbe2tleTpcIl9lcnJvclRvbGVyYW50SGFuZGxlXCIsdmFsdWU6ZnVuY3Rpb24oKXthZXx8IWl0KHdpbmRvdykmJnRoaXMuX2NhbklVc2VDb29raWVzKCl8fCh0aGlzLmdldEl0ZW09ZXIsdGhpcy5zZXRJdGVtPWVyLHRoaXMucmVtb3ZlSXRlbT1lcix0aGlzLmNsZWFyPWVyKX19LHtrZXk6XCJvbkNoZWNrVGltZXJcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihlJTIwPT0wKXtpZigwPT09dGhpcy5fc3RvcmFnZVF1ZXVlLnNpemUpcmV0dXJuO3RoaXMuX2RvRmx1c2goKX19fSx7a2V5OlwiX2RvRmx1c2hcIix2YWx1ZTpmdW5jdGlvbigpe3RyeXt2YXIgZSx0PUQodGhpcy5fc3RvcmFnZVF1ZXVlKTt0cnl7Zm9yKHQucygpOyEoZT10Lm4oKSkuZG9uZTspe3ZhciBuPXYoZS52YWx1ZSwyKSxvPW5bMF0scz1uWzFdO3RoaXMuX3NldFN0b3JhZ2VTeW5jKHRoaXMuX2dldEtleShvKSxzKX19Y2F0Y2goYSl7dC5lKGEpfWZpbmFsbHl7dC5mKCl9dGhpcy5fc3RvcmFnZVF1ZXVlLmNsZWFyKCl9Y2F0Y2goaSl7VmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9kb0ZsdXNoIGVycm9yOlwiKSxpKX19fSx7a2V5OlwiX2dldFByZWZpeFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fbS5nZXRNb2R1bGUoeG4pO3JldHVyblwiVElNX1wiLmNvbmNhdChlLmdldFNES0FwcElEKCksXCJfXCIpLmNvbmNhdChlLmdldFVzZXJJRCgpLFwiX1wiKX19LHtrZXk6XCJfZ2V0S2V5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuXCJcIi5jb25jYXQodGhpcy5fZ2V0UHJlZml4KCkpLmNvbmNhdChlKX19LHtrZXk6XCJnZXRJdGVtXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9IShhcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSl8fGFyZ3VtZW50c1sxXTt0cnl7dmFyIG49dD90aGlzLl9nZXRLZXkoZSk6ZTtyZXR1cm4gdGhpcy5nZXRTdG9yYWdlU3luYyhuKX1jYXRjaChvKXtyZXR1cm4gVmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmdldEl0ZW0gZXJyb3I6XCIpLG8pLHt9fX19LHtrZXk6XCJzZXRJdGVtXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXSYmYXJndW1lbnRzWzJdLG89IShhcmd1bWVudHMubGVuZ3RoPjMmJnZvaWQgMCE9PWFyZ3VtZW50c1szXSl8fGFyZ3VtZW50c1szXTtpZihuKXt2YXIgcz1vP3RoaXMuX2dldEtleShlKTplO3RoaXMuX3NldFN0b3JhZ2VTeW5jKHMsdCl9ZWxzZSB0aGlzLl9zdG9yYWdlUXVldWUuc2V0KGUsdCl9fSx7a2V5OlwiY2xlYXJcIix2YWx1ZTpmdW5jdGlvbigpe3RyeXthZT9yZS5jbGVhclN0b3JhZ2VTeW5jKCk6dGhpcy5fY2FuSVVzZUNvb2tpZXMoKSYmbG9jYWxTdG9yYWdlLmNsZWFyKCl9Y2F0Y2goZSl7VmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmNsZWFyIGVycm9yOlwiKSxlKX19fSx7a2V5OlwicmVtb3ZlSXRlbVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PSEoYXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pfHxhcmd1bWVudHNbMV07dHJ5e3ZhciBuPXQ/dGhpcy5fZ2V0S2V5KGUpOmU7dGhpcy5fcmVtb3ZlU3RvcmFnZVN5bmMobil9Y2F0Y2gobyl7VmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlbW92ZUl0ZW0gZXJyb3I6XCIpLG8pfX19LHtrZXk6XCJnZXRTaXplXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTpcImJcIjt0cnl7dmFyIG89e3NpemU6MCxsaW1pdFNpemU6NTI0Mjg4MCx1bml0Om59O2lmKE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLFwibGVmdFNpemVcIix7ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gby5saW1pdFNpemUtby5zaXplfX0pLGFlJiYoby5saW1pdFNpemU9MTAyNCpyZS5nZXRTdG9yYWdlSW5mb1N5bmMoKS5saW1pdFNpemUpLGUpby5zaXplPUpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0SXRlbShlKSkubGVuZ3RoK3RoaXMuX2dldEtleShlKS5sZW5ndGg7ZWxzZSBpZihhZSl7dmFyIHM9cmUuZ2V0U3RvcmFnZUluZm9TeW5jKCksYT1zLmtleXM7YS5mb3JFYWNoKChmdW5jdGlvbihlKXtvLnNpemUrPUpTT04uc3RyaW5naWZ5KHQuZ2V0U3RvcmFnZVN5bmMoZSkpLmxlbmd0aCt0Ll9nZXRLZXkoZSkubGVuZ3RofSkpfWVsc2UgaWYodGhpcy5fY2FuSVVzZUNvb2tpZXMoKSlmb3IodmFyIGkgaW4gbG9jYWxTdG9yYWdlKWxvY2FsU3RvcmFnZS5oYXNPd25Qcm9wZXJ0eShpKSYmKG8uc2l6ZSs9bG9jYWxTdG9yYWdlLmdldEl0ZW0oaSkubGVuZ3RoK2kubGVuZ3RoKTtyZXR1cm4gdGhpcy5fY29udmVydFVuaXQobyl9Y2F0Y2gocil7VmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiIGVycm9yOlwiKSxyKX19fSx7a2V5OlwiX2NvbnZlcnRVbml0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9e30sbj1lLnVuaXQ7Zm9yKHZhciBvIGluIHQudW5pdD1uLGUpXCJudW1iZXJcIj09dHlwZW9mIGVbb10mJihcImtiXCI9PT1uLnRvTG93ZXJDYXNlKCk/dFtvXT1NYXRoLnJvdW5kKGVbb10vMTAyNCk6XCJtYlwiPT09bi50b0xvd2VyQ2FzZSgpP3Rbb109TWF0aC5yb3VuZChlW29dLzEwMjQvMTAyNCk6dFtvXT1lW29dKTtyZXR1cm4gdH19LHtrZXk6XCJfc2V0U3RvcmFnZVN5bmNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2FlP3RlP215LnNldFN0b3JhZ2VTeW5jKHtrZXk6ZSxkYXRhOnR9KTpyZS5zZXRTdG9yYWdlU3luYyhlLHQpOnRoaXMuX2NhbklVc2VDb29raWVzKCkmJmxvY2FsU3RvcmFnZS5zZXRJdGVtKGUsSlNPTi5zdHJpbmdpZnkodCkpfX0se2tleTpcImdldFN0b3JhZ2VTeW5jXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGFlP3RlP215LmdldFN0b3JhZ2VTeW5jKHtrZXk6ZX0pLmRhdGE6cmUuZ2V0U3RvcmFnZVN5bmMoZSk6dGhpcy5fY2FuSVVzZUNvb2tpZXMoKT9KU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGUpKTp7fX19LHtrZXk6XCJfcmVtb3ZlU3RvcmFnZVN5bmNcIix2YWx1ZTpmdW5jdGlvbihlKXthZT90ZT9teS5yZW1vdmVTdG9yYWdlU3luYyh7a2V5OmV9KTpyZS5yZW1vdmVTdG9yYWdlU3luYyhlKTp0aGlzLl9jYW5JVXNlQ29va2llcygpJiZsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShlKX19LHtrZXk6XCJfY2FuSVVzZUNvb2tpZXNcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBuYXZpZ2F0b3ImJm5hdmlnYXRvci5jb29raWVFbmFibGVkJiZsb2NhbFN0b3JhZ2V9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSksdGhpcy5fZG9GbHVzaCgpfX1dKSxlfSgpLG5yPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fbj1cIlNTT0xvZ0JvZHlcIix0aGlzLl9yZXBvcnQ9W119cmV0dXJuIGEoZSxbe2tleTpcInB1c2hJblwiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5wdXNoSW5cIiksdGhpcy5fcmVwb3J0Lmxlbmd0aCxlKSx0aGlzLl9yZXBvcnQucHVzaChlKX19LHtrZXk6XCJiYWNrZmlsbFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0O2F0KGUpJiYwIT09ZS5sZW5ndGgmJihWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuYmFja2ZpbGxcIiksdGhpcy5fcmVwb3J0Lmxlbmd0aCxlLmxlbmd0aCksKHQ9dGhpcy5fcmVwb3J0KS51bnNoaWZ0LmFwcGx5KHQsbShlKSkpfX0se2tleTpcImdldExvZ3NOdW1Jbk1lbW9yeVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlcG9ydC5sZW5ndGh9fSx7a2V5OlwiaXNFbXB0eVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLl9yZXBvcnQubGVuZ3RofX0se2tleTpcIl9yZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fcmVwb3J0Lmxlbmd0aD0wLHRoaXMuX3JlcG9ydD1bXX19LHtrZXk6XCJnZXRMb2dzSW5NZW1vcnlcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX3JlcG9ydC5zbGljZSgpO3JldHVybiB0aGlzLl9yZXNldCgpLGV9fV0pLGV9KCksb3I9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5nZXRNb2R1bGUoeG4pO3JldHVybntTREtUeXBlOjEwLFNES0FwcElEOnQuZ2V0U0RLQXBwSUQoKSxTREtWZXJzaW9uOnQuZ2V0VmVyc2lvbigpLHRpbnlJRDpOdW1iZXIodC5nZXRUaW55SUQoKSksdXNlcklEOnQuZ2V0VXNlcklEKCkscGxhdGZvcm06ZS5nZXRQbGF0Zm9ybSgpLGluc3RhbmNlSUQ6dC5nZXRJbnN0YW5jZUlEKCksdHJhY2VJRDpQZSgpfX0sc3I9ZnVuY3Rpb24oZSl7cihzLGUpO3ZhciBuPWYocyk7ZnVuY3Rpb24gcyhlKXt2YXIgdDtvKHRoaXMscyksKHQ9bi5jYWxsKHRoaXMsZSkpLl9uPVwiRXZlbnRTdGF0TW9kdWxlXCIsdC5UQUc9XCJpbS1zc29sb2ctZXZlbnRcIix0Ll9yZXBvcnRCb2R5PW5ldyBucix0Lk1JTl9USFJFU0hPTEQ9MjAsdC5NQVhfVEhSRVNIT0xEPTEwMCx0LldBSVRJTkdfVElNRT02ZTQsdC5SRVBPUlRfTEVWRUw9WzQsNSw2XSx0LlJFUE9SVF9TREtBUFBJRF9CTEFDS0xJU1Q9W10sdC5SRVBPUlRfVElOWUlEX1dISVRFTElTVD1bXSx0Ll9sYXN0UmVwb3J0VGltZT1EYXRlLm5vdygpO3ZhciBhPXQuZ2V0SW5uZXJFbWl0dGVySW5zdGFuY2UoKTtyZXR1cm4gYS5vbihlaSx0Ll9vbkxvZ2luU3VjY2VzcyxoKHQpKSxhLm9uKHRpLHQuX29uQ2xvdWRDb25maWdVcGRhdGVkLGgodCkpLHR9cmV0dXJuIGEocyxbe2tleTpcInJlcG9ydEF0T25jZVwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlcG9ydEF0T25jZVwiKSksdGhpcy5fcmVwb3J0KCl9fSx7a2V5OlwiX29uTG9naW5TdWNjZXNzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5nZXRNb2R1bGUoVm4pLG49dC5nZXRJdGVtKHRoaXMuVEFHLCExKTshenQobikmJnV0KG4uZm9yRWFjaCkmJihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uTG9naW5TdWNjZXNzIGdldCBzc29sb2cgaW4gc3RvcmFnZSwgY291bnQ6XCIpLmNvbmNhdChuLmxlbmd0aCkpLG4uZm9yRWFjaCgoZnVuY3Rpb24odCl7ZS5fcmVwb3J0Qm9keS5wdXNoSW4odCl9KSksdC5yZW1vdmVJdGVtKHRoaXMuVEFHLCExKSl9fSx7a2V5OlwiX29uQ2xvdWRDb25maWdVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldENsb3VkQ29uZmlnKFwiZXZ0X3JwdF90aHJlc2hvbGRcIiksdD10aGlzLmdldENsb3VkQ29uZmlnKFwiZXZ0X3JwdF93YWl0aW5nXCIpLG49dGhpcy5nZXRDbG91ZENvbmZpZyhcImV2dF9ycHRfbGV2ZWxcIiksbz10aGlzLmdldENsb3VkQ29uZmlnKFwiZXZ0X3JwdF9zZGthcHBpZF9ibFwiKSxzPXRoaXMuZ2V0Q2xvdWRDb25maWcoXCJldnRfcnB0X3RpbnlpZF93bFwiKTtpdChlKXx8KHRoaXMuTUlOX1RIUkVTSE9MRD1OdW1iZXIoZSkpLGl0KHQpfHwodGhpcy5XQUlUSU5HX1RJTUU9TnVtYmVyKHQpKSxpdChuKXx8KHRoaXMuUkVQT1JUX0xFVkVMPW4uc3BsaXQoXCIsXCIpLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIE51bWJlcihlKX0pKSksaXQobyl8fCh0aGlzLlJFUE9SVF9TREtBUFBJRF9CTEFDS0xJU1Q9by5zcGxpdChcIixcIikubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gTnVtYmVyKGUpfSkpKSxpdChzKXx8KHRoaXMuUkVQT1JUX1RJTllJRF9XSElURUxJU1Q9cy5zcGxpdChcIixcIikpfX0se2tleTpcInB1c2hJblwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UgaW5zdGFuY2VvZiBBYSYmKGUudXBkYXRlVGltZVN0YW1wKCksdGhpcy5fcmVwb3J0Qm9keS5wdXNoSW4oZSksdGhpcy5fcmVwb3J0Qm9keS5nZXRMb2dzTnVtSW5NZW1vcnkoKT49dGhpcy5NSU5fVEhSRVNIT0xEJiZ0aGlzLl9yZXBvcnQoKSl9fSx7a2V5Olwib25DaGVja1RpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oKXtEYXRlLm5vdygpPHRoaXMuX2xhc3RSZXBvcnRUaW1lK3RoaXMuV0FJVElOR19USU1FfHx0aGlzLl9yZXBvcnRCb2R5LmlzRW1wdHkoKXx8dGhpcy5fcmVwb3J0KCl9fSx7a2V5OlwiX2ZpbHRlckxvZ3NcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49dGhpcy5nZXRNb2R1bGUoeG4pLG89bi5nZXRTREtBcHBJRCgpLHM9bi5nZXRUaW55SUQoKTtyZXR1cm4gRnQodGhpcy5SRVBPUlRfU0RLQVBQSURfQkxBQ0tMSVNULG8pJiYhcXQodGhpcy5SRVBPUlRfVElOWUlEX1dISVRFTElTVCxzKT9bXTplLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIHQuUkVQT1JUX0xFVkVMLmluY2x1ZGVzKGUubGV2ZWwpfSkpfX0se2tleTpcIl9yZXBvcnRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYoIXRoaXMuX3JlcG9ydEJvZHkuaXNFbXB0eSgpKXt2YXIgbj10aGlzLl9yZXBvcnRCb2R5LmdldExvZ3NJbk1lbW9yeSgpLG89dGhpcy5fZmlsdGVyTG9ncyhuKTtpZigwIT09by5sZW5ndGgpe3ZhciBzPXtoZWFkZXI6b3IodGhpcyksZXZlbnQ6b307dGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6QnMscmVxdWVzdERhdGE6dCh7fSxzKX0pLnRoZW4oKGZ1bmN0aW9uKCl7ZS5fbGFzdFJlcG9ydFRpbWU9RGF0ZS5ub3coKX0pKS5jYXRjaCgoZnVuY3Rpb24odCl7VmUudyhcIlwiLmNvbmNhdChlLl9uLFwiLnJlcG9ydCBmYWlsZWQuIG5ldHdvcmtUeXBlOlwiKS5jb25jYXQoZS5nZXROZXR3b3JrVHlwZSgpLFwiIGVycm9yOlwiKSx0KSxlLl9yZXBvcnRCb2R5LmJhY2tmaWxsKG4pLGUuX3JlcG9ydEJvZHkuZ2V0TG9nc051bUluTWVtb3J5KCk+ZS5NQVhfVEhSRVNIT0xEJiZlLl9mbHVzaEF0T25jZSgpfSkpfWVsc2UgdGhpcy5fbGFzdFJlcG9ydFRpbWU9RGF0ZS5ub3coKX19fSx7a2V5OlwiX2ZsdXNoQXRPbmNlXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldE1vZHVsZShWbiksdD1lLmdldEl0ZW0odGhpcy5UQUcsITEpLG49dGhpcy5fcmVwb3J0Qm9keS5nZXRMb2dzSW5NZW1vcnkoKSxvPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2ZsdXNoQXRPbmNlXCIpO2lmKHp0KHQpKVZlLmwoXCJcIi5jb25jYXQobyxcIiBjb3VudDpcIikuY29uY2F0KG4ubGVuZ3RoKSksZS5zZXRJdGVtKHRoaXMuVEFHLG4sITAsITEpO2Vsc2V7dmFyIHM9bi5jb25jYXQodCk7cy5sZW5ndGg+dGhpcy5NQVhfVEhSRVNIT0xEJiYocz1zLnNsaWNlKDAsdGhpcy5NQVhfVEhSRVNIT0xEKSksVmUubChcIlwiLmNvbmNhdChvLFwiIGNvdW50OlwiKS5jb25jYXQocy5sZW5ndGgpKSxlLnNldEl0ZW0odGhpcy5UQUcscywhMCwhMSl9fX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX2xhc3RSZXBvcnRUaW1lPTAsdGhpcy5fcmVwb3J0KCksdGhpcy5SRVBPUlRfU0RLQVBQSURfQkxBQ0tMSVNUPVtdLHRoaXMuUkVQT1JUX1RJTllJRF9XSElURUxJU1Q9W119fV0pLHN9KHVvKSxhcj1cIm5vbmVcIixpcj1cIm9ubGluZVwiLHJyPVtoYS5PVkVSX0ZSRVFVRU5DWV9MSU1JVCxoYS5PUEVOX1NFUlZJQ0VfT1ZFUkxPQURfRVJST1JdLHVyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fbT10LHRoaXMuX25ldHdvcmtUeXBlPVwiXCIsdGhpcy5fbj1cIk5ldE1vbml0b3JNb2R1bGVcIix0aGlzLk1BWF9XQUlUX1RJTUU9M2UzLHRoaXMuX21wTmV0d29ya1N0YXR1c0NhbGxiYWNrPW51bGwsdGhpcy5fd2ViT25saW5lQ2FsbGJhY2s9bnVsbCx0aGlzLl93ZWJPZmZsaW5lQ2FsbGJhY2s9bnVsbH1yZXR1cm4gYShlLFt7a2V5Olwic3RhcnRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7YWU/KHJlLmdldE5ldHdvcmtUeXBlKHtzdWNjZXNzOmZ1bmN0aW9uKHQpe2UuX25ldHdvcmtUeXBlPXQubmV0d29ya1R5cGV8fHQuc3VidHlwZXx8XCJcIix0Lm5ldHdvcmtUeXBlPT09YXI/VmUudyhcIlwiLmNvbmNhdChlLl9uLFwiLnN0YXJ0IG5vIG5ldHdvcmssIHBsZWFzZSBjaGVjayFcIikpOlZlLmkoXCJcIi5jb25jYXQoZS5fbixcIi5zdGFydCBuZXR3b3JrVHlwZTpcIikuY29uY2F0KHQubmV0d29ya1R5cGUpKX19KSx0aGlzLl9tcE5ldHdvcmtTdGF0dXNDYWxsYmFjaz10aGlzLl9vbk5ldHdvcmtTdGF0dXNDaGFuZ2UuYmluZCh0aGlzKSxyZS5vbk5ldHdvcmtTdGF0dXNDaGFuZ2UodGhpcy5fbXBOZXR3b3JrU3RhdHVzQ2FsbGJhY2spKToodGhpcy5fbmV0d29ya1R5cGU9aXIsdGhpcy5fd2ViT25saW5lQ2FsbGJhY2s9dGhpcy5fb25XZWJPbmxpbmUuYmluZCh0aGlzKSx0aGlzLl93ZWJPZmZsaW5lQ2FsbGJhY2s9dGhpcy5fb25XZWJPZmZsaW5lLmJpbmQodGhpcyksd2luZG93JiYod2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIix0aGlzLl93ZWJPbmxpbmVDYWxsYmFjayksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsdGhpcy5fd2ViT2ZmbGluZUNhbGxiYWNrKSkpfX0se2tleTpcIl9vbldlYk9ubGluZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fb25OZXR3b3JrU3RhdHVzQ2hhbmdlKHtpc0Nvbm5lY3RlZDohMCxuZXR3b3JrVHlwZTppcn0pfX0se2tleTpcIl9vbldlYk9mZmxpbmVcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX29uTmV0d29ya1N0YXR1c0NoYW5nZSh7aXNDb25uZWN0ZWQ6ITEsbmV0d29ya1R5cGU6YXJ9KX19LHtrZXk6XCJfb25OZXR3b3JrU3RhdHVzQ2hhbmdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5pc0Nvbm5lY3RlZCxuPWUubmV0d29ya1R5cGUsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vbk5ldHdvcmtTdGF0dXNDaGFuZ2VcIikscz0hMTt0PyhWZS5pKFwiXCIuY29uY2F0KG8sXCIgcHJldmlvdXM6XCIpLmNvbmNhdCh0aGlzLl9uZXR3b3JrVHlwZSxcIiBjdXJyZW50OlwiKS5jb25jYXQobikpLHRoaXMuX25ldHdvcmtUeXBlIT09biYmKHM9ITAsdGhpcy5fbS5nZXRNb2R1bGUoSm4pLnJlQ29ubmVjdCghMCkpKTp0aGlzLl9uZXR3b3JrVHlwZSE9PW4mJihzPSEwLFZlLncoXCJcIi5jb25jYXQobyxcIiBubyBuZXR3b3JrLCBwbGVhc2UgY2hlY2shXCIpKSx0aGlzLl9tLmdldE1vZHVsZShKbikub2ZmbGluZSgpKTtzJiYobmV3IEFhKFwibmV0d29ya0NoYW5nZVwiKS5zZXRNZXNzYWdlKFwiaXNDb25uZWN0ZWQ6XCIuY29uY2F0KHQsXCIgcHJldmlvdXNOZXR3b3JrVHlwZTpcIikuY29uY2F0KHRoaXMuX25ldHdvcmtUeXBlLFwiIG5ldHdvcmtUeXBlOlwiKS5jb25jYXQobikpLmVuZCgpLHRoaXMuX25ldHdvcmtUeXBlPW4pfX0se2tleTpcInByb2JlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighaXQoZSkmJnJyLmluY2x1ZGVzKGUuY29kZSkpcmV0dXJuIFByb21pc2UucmVzb2x2ZShbITAsdGhpcy5fbmV0d29ya1R5cGVdKTt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnByb2JlXCIpO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24oZSxvKXthZT9yZS5nZXROZXR3b3JrVHlwZSh7c3VjY2VzczpmdW5jdGlvbihvKXt0Ll9uZXR3b3JrVHlwZT1vLm5ldHdvcmtUeXBlLG8ubmV0d29ya1R5cGU9PT1hcj8oVmUudyhcIlwiLmNvbmNhdChuLFwiIG5vIG5ldHdvcmssIHBsZWFzZSBjaGVjayFcIikpLGUoWyExLG8ubmV0d29ya1R5cGVdKSk6KFZlLmkoXCJcIi5jb25jYXQobixcIiBuZXR3b3JrVHlwZTpcIikuY29uY2F0KG8ubmV0d29ya1R5cGUpKSxlKFshMCxvLm5ldHdvcmtUeXBlXSkpfX0pOnQuX25ldHdvcmtUeXBlPT09YXI/ZShbITEsYXJdKTplKFshMCxpcl0pfSkpfX0se2tleTpcImdldE5ldHdvcmtUeXBlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbmV0d29ya1R5cGV9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSksYWU/bnVsbCE9PXRoaXMuX21wTmV0d29ya1N0YXR1c0NhbGxiYWNrJiYocmUub2ZmTmV0d29ya1N0YXR1c0NoYW5nZSYmKG9lfHwkP3JlLm9mZk5ldHdvcmtTdGF0dXNDaGFuZ2UodGhpcy5fbXBOZXR3b3JrU3RhdHVzQ2FsbGJhY2spOnJlLm9mZk5ldHdvcmtTdGF0dXNDaGFuZ2UoKSksdGhpcy5fbXBOZXR3b3JrU3RhdHVzQ2FsbGJhY2s9bnVsbCk6d2luZG93JiYobnVsbCE9PXRoaXMuX3dlYk9ubGluZUNhbGxiYWNrJiYod2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIix0aGlzLl93ZWJPbmxpbmVDYWxsYmFjayksdGhpcy5fd2ViT25saW5lQ2FsbGJhY2s9bnVsbCksbnVsbCE9PXRoaXMuX29uV2ViT2ZmbGluZSYmKHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib2ZmbGluZVwiLHRoaXMuX3dlYk9mZmxpbmVDYWxsYmFjayksdGhpcy5fd2ViT2ZmbGluZUNhbGxiYWNrPW51bGwpKX19XSksZX0oKTtmdW5jdGlvbiBjcihlLHQpe3JldHVybiBlKHQ9e2V4cG9ydHM6e319LHQuZXhwb3J0cyksdC5leHBvcnRzfXZhciBscj1jcigoZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxuPVwiflwiO2Z1bmN0aW9uIG8oKXt9ZnVuY3Rpb24gcyhlLHQsbil7dGhpcy5mbj1lLHRoaXMuY29udGV4dD10LHRoaXMub25jZT1ufHwhMX1mdW5jdGlvbiBhKGUsdCxvLGEsaSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2Ygbyl0aHJvdyBuZXcgVHlwZUVycm9yKFwiVGhlIGxpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvblwiKTt2YXIgcj1uZXcgcyhvLGF8fGUsaSksdT1uP24rdDp0O3JldHVybiBlLl9ldmVudHNbdV0/ZS5fZXZlbnRzW3VdLmZuP2UuX2V2ZW50c1t1XT1bZS5fZXZlbnRzW3VdLHJdOmUuX2V2ZW50c1t1XS5wdXNoKHIpOihlLl9ldmVudHNbdV09cixlLl9ldmVudHNDb3VudCsrKSxlfWZ1bmN0aW9uIGkoZSx0KXswPT0tLWUuX2V2ZW50c0NvdW50P2UuX2V2ZW50cz1uZXcgbzpkZWxldGUgZS5fZXZlbnRzW3RdfWZ1bmN0aW9uIHIoKXt0aGlzLl9ldmVudHM9bmV3IG8sdGhpcy5fZXZlbnRzQ291bnQ9MH1PYmplY3QuY3JlYXRlJiYoby5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShudWxsKSwobmV3IG8pLl9fcHJvdG9fX3x8KG49ITEpKSxyLnByb3RvdHlwZS5ldmVudE5hbWVzPWZ1bmN0aW9uKCl7dmFyIGUsbyxzPVtdO2lmKDA9PT10aGlzLl9ldmVudHNDb3VudClyZXR1cm4gcztmb3IobyBpbiBlPXRoaXMuX2V2ZW50cyl0LmNhbGwoZSxvKSYmcy5wdXNoKG4/by5zbGljZSgxKTpvKTtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scz9zLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpKTpzfSxyLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7dmFyIHQ9bj9uK2U6ZSxvPXRoaXMuX2V2ZW50c1t0XTtpZighbylyZXR1cm5bXTtpZihvLmZuKXJldHVybltvLmZuXTtmb3IodmFyIHM9MCxhPW8ubGVuZ3RoLGk9bmV3IEFycmF5KGEpO3M8YTtzKyspaVtzXT1vW3NdLmZuO3JldHVybiBpfSxyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50PWZ1bmN0aW9uKGUpe3ZhciB0PW4/bitlOmUsbz10aGlzLl9ldmVudHNbdF07cmV0dXJuIG8/by5mbj8xOm8ubGVuZ3RoOjB9LHIucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24oZSx0LG8scyxhLGkpe3ZhciByPW4/bitlOmU7aWYoIXRoaXMuX2V2ZW50c1tyXSlyZXR1cm4hMTt2YXIgdSxjLGw9dGhpcy5fZXZlbnRzW3JdLGQ9YXJndW1lbnRzLmxlbmd0aDtpZihsLmZuKXtzd2l0Y2gobC5vbmNlJiZ0aGlzLnJlbW92ZUxpc3RlbmVyKGUsbC5mbix2b2lkIDAsITApLGQpe2Nhc2UgMTpyZXR1cm4gbC5mbi5jYWxsKGwuY29udGV4dCksITA7Y2FzZSAyOnJldHVybiBsLmZuLmNhbGwobC5jb250ZXh0LHQpLCEwO2Nhc2UgMzpyZXR1cm4gbC5mbi5jYWxsKGwuY29udGV4dCx0LG8pLCEwO2Nhc2UgNDpyZXR1cm4gbC5mbi5jYWxsKGwuY29udGV4dCx0LG8scyksITA7Y2FzZSA1OnJldHVybiBsLmZuLmNhbGwobC5jb250ZXh0LHQsbyxzLGEpLCEwO2Nhc2UgNjpyZXR1cm4gbC5mbi5jYWxsKGwuY29udGV4dCx0LG8scyxhLGkpLCEwfWZvcihjPTEsdT1uZXcgQXJyYXkoZC0xKTtjPGQ7YysrKXVbYy0xXT1hcmd1bWVudHNbY107bC5mbi5hcHBseShsLmNvbnRleHQsdSl9ZWxzZXt2YXIgcCxnPWwubGVuZ3RoO2ZvcihjPTA7YzxnO2MrKylzd2l0Y2gobFtjXS5vbmNlJiZ0aGlzLnJlbW92ZUxpc3RlbmVyKGUsbFtjXS5mbix2b2lkIDAsITApLGQpe2Nhc2UgMTpsW2NdLmZuLmNhbGwobFtjXS5jb250ZXh0KTticmVhaztjYXNlIDI6bFtjXS5mbi5jYWxsKGxbY10uY29udGV4dCx0KTticmVhaztjYXNlIDM6bFtjXS5mbi5jYWxsKGxbY10uY29udGV4dCx0LG8pO2JyZWFrO2Nhc2UgNDpsW2NdLmZuLmNhbGwobFtjXS5jb250ZXh0LHQsbyxzKTticmVhaztkZWZhdWx0OmlmKCF1KWZvcihwPTEsdT1uZXcgQXJyYXkoZC0xKTtwPGQ7cCsrKXVbcC0xXT1hcmd1bWVudHNbcF07bFtjXS5mbi5hcHBseShsW2NdLmNvbnRleHQsdSl9fXJldHVybiEwfSxyLnByb3RvdHlwZS5vbj1mdW5jdGlvbihlLHQsbil7cmV0dXJuIGEodGhpcyxlLHQsbiwhMSl9LHIucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBhKHRoaXMsZSx0LG4sITApfSxyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbihlLHQsbyxzKXt2YXIgYT1uP24rZTplO2lmKCF0aGlzLl9ldmVudHNbYV0pcmV0dXJuIHRoaXM7aWYoIXQpcmV0dXJuIGkodGhpcyxhKSx0aGlzO3ZhciByPXRoaXMuX2V2ZW50c1thXTtpZihyLmZuKXIuZm4hPT10fHxzJiYhci5vbmNlfHxvJiZyLmNvbnRleHQhPT1vfHxpKHRoaXMsYSk7ZWxzZXtmb3IodmFyIHU9MCxjPVtdLGw9ci5sZW5ndGg7dTxsO3UrKykoclt1XS5mbiE9PXR8fHMmJiFyW3VdLm9uY2V8fG8mJnJbdV0uY29udGV4dCE9PW8pJiZjLnB1c2goclt1XSk7Yy5sZW5ndGg/dGhpcy5fZXZlbnRzW2FdPTE9PT1jLmxlbmd0aD9jWzBdOmM6aSh0aGlzLGEpfXJldHVybiB0aGlzfSxyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnM9ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIGU/KHQ9bj9uK2U6ZSx0aGlzLl9ldmVudHNbdF0mJmkodGhpcyx0KSk6KHRoaXMuX2V2ZW50cz1uZXcgbyx0aGlzLl9ldmVudHNDb3VudD0wKSx0aGlzfSxyLnByb3RvdHlwZS5vZmY9ci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIsci5wcm90b3R5cGUuYWRkTGlzdGVuZXI9ci5wcm90b3R5cGUub24sci5wcmVmaXhlZD1uLHIuRXZlbnRFbWl0dGVyPXIsZS5leHBvcnRzPXJ9KSksZHI9ZnVuY3Rpb24oZSl7cihuLGUpO3ZhciB0PWYobik7ZnVuY3Rpb24gbihlKXt2YXIgcztyZXR1cm4gbyh0aGlzLG4pLChzPXQuY2FsbCh0aGlzLGUpKS5fbj1cIkJpZ0RhdGFDaGFubmVsTW9kdWxlXCIscy5GSUxFVFlQRT17U09VTkQ6MjEwNixGSUxFOjIxMDcsVklERU86MjExM30scy5fYmRoX2Rvd25sb2FkX3NlcnZlcj1cImdyb3VwdGFsay5jMmMucXEuY29tXCIscy5fQkRIQml6SUQ9MTAwMDEscy5fYXV0aEtleT1cIlwiLHMuX2V4cGlyZVRpbWU9MCxzLmdldElubmVyRW1pdHRlckluc3RhbmNlKCkub24oZWkscy5fZ2V0QXV0aEtleSxoKHMpKSxzfXJldHVybiBhKG4sW3trZXk6XCJfZ2V0QXV0aEtleVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLmlzSW50bCgpfHx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpfb30pLnRoZW4oKGZ1bmN0aW9uKHQpe3QuZGF0YS5hdXRoS2V5JiYoZS5fYXV0aEtleT10LmRhdGEuYXV0aEtleSxlLl9leHBpcmVUaW1lPXBhcnNlSW50KHQuZGF0YS5leHBpcmVUaW1lKSl9KSl9fSx7a2V5OlwiX2lzRnJvbU9sZGVyVmVyc2lvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiEoIWUuY29udGVudHx8Mj09PWUuY29udGVudC5kb3dubG9hZEZsYWcpfX0se2tleTpcInBhcnNlRWxlbWVudHNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKCFhdChlKXx8IXQpcmV0dXJuW107Zm9yKHZhciBuPVtdLG89bnVsbCxzPTA7czxlLmxlbmd0aDtzKyspbz1lW3NdLHRoaXMuX25lZWRQYXJzZShvKT9uLnB1c2godGhpcy5fcGFyc2VFbGVtZW50KG8sdCkpOm4ucHVzaChlW3NdKTtyZXR1cm4gbn19LHtrZXk6XCJfbmVlZFBhcnNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIWUuY2xvdWRDdXN0b21EYXRhJiYhKCF0aGlzLl9pc0Zyb21PbGRlclZlcnNpb24oZSl8fGUudHlwZSE9PUUuTVNHX0FVRElPJiZlLnR5cGUhPT1FLk1TR19GSUxFJiZlLnR5cGUhPT1FLk1TR19WSURFTyl9fSx7a2V5OlwiX3BhcnNlRWxlbWVudFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7c3dpdGNoKGUudHlwZSl7Y2FzZSBFLk1TR19BVURJTzpyZXR1cm4gdGhpcy5fcGFyc2VBdWRpb0VsZW1lbnQoZSx0KTtjYXNlIEUuTVNHX0ZJTEU6cmV0dXJuIHRoaXMuX3BhcnNlRmlsZUVsZW1lbnQoZSx0KTtjYXNlIEUuTVNHX1ZJREVPOnJldHVybiB0aGlzLl9wYXJzZVZpZGVvRWxlbWVudChlLHQpfX19LHtrZXk6XCJfcGFyc2VBdWRpb0VsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiBlLmNvbnRlbnQudXJsPXRoaXMuX2dlbkF1ZGlvVXJsKGUuY29udGVudC51dWlkLHQpLGV9fSx7a2V5OlwiX3BhcnNlRmlsZUVsZW1lbnRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiBlLmNvbnRlbnQudXJsPXRoaXMuX2dlbkZpbGVVcmwoZS5jb250ZW50LnV1aWQsdCxlLmNvbnRlbnQuZmlsZU5hbWUpLGV9fSx7a2V5OlwiX3BhcnNlVmlkZW9FbGVtZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5jb250ZW50LnVybD10aGlzLl9nZW5WaWRlb1VybChlLmNvbnRlbnQudXVpZCx0KSxlfX0se2tleTpcIl9nZW5BdWRpb1VybFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7aWYoXCJcIj09PXRoaXMuX2F1dGhLZXkpcmV0dXJuXCJcIjt2YXIgbj10aGlzLmdldE1vZHVsZSh4bikuZ2V0U0RLQXBwSUQoKTtyZXR1cm5cImh0dHBzOi8vXCIuY29uY2F0KHRoaXMuX2JkaF9kb3dubG9hZF9zZXJ2ZXIsXCIvYXNuLmNvbS9zdGRkb3dubG9hZF9jb21tb25fZmlsZT9hdXRoa2V5PVwiKS5jb25jYXQodGhpcy5fYXV0aEtleSxcIiZiaWQ9XCIpLmNvbmNhdCh0aGlzLl9CREhCaXpJRCxcIiZzdWJiaWQ9XCIpLmNvbmNhdChuLFwiJmZpbGVpZD1cIikuY29uY2F0KGUsXCImZmlsZXR5cGU9XCIpLmNvbmNhdCh0aGlzLkZJTEVUWVBFLlNPVU5ELFwiJm9wZW5pZD1cIikuY29uY2F0KHQsXCImdmVyPTBcIil9fSx7a2V5OlwiX2dlbkZpbGVVcmxcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7aWYoXCJcIj09PXRoaXMuX2F1dGhLZXkpcmV0dXJuXCJcIjtufHwobj1cIlwiLmNvbmNhdChNYXRoLmZsb29yKDFlNSpNYXRoLnJhbmRvbSgpKSxcIi1cIikuY29uY2F0KERhdGUubm93KCkpKTt2YXIgbz10aGlzLmdldE1vZHVsZSh4bikuZ2V0U0RLQXBwSUQoKTtyZXR1cm5cImh0dHBzOi8vXCIuY29uY2F0KHRoaXMuX2JkaF9kb3dubG9hZF9zZXJ2ZXIsXCIvYXNuLmNvbS9zdGRkb3dubG9hZF9jb21tb25fZmlsZT9hdXRoa2V5PVwiKS5jb25jYXQodGhpcy5fYXV0aEtleSxcIiZiaWQ9XCIpLmNvbmNhdCh0aGlzLl9CREhCaXpJRCxcIiZzdWJiaWQ9XCIpLmNvbmNhdChvLFwiJmZpbGVpZD1cIikuY29uY2F0KGUsXCImZmlsZXR5cGU9XCIpLmNvbmNhdCh0aGlzLkZJTEVUWVBFLkZJTEUsXCImb3BlbmlkPVwiKS5jb25jYXQodCxcIiZ2ZXI9MCZmaWxlbmFtZT1cIikuY29uY2F0KGVuY29kZVVSSUNvbXBvbmVudChuKSl9fSx7a2V5OlwiX2dlblZpZGVvVXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtpZihcIlwiPT09dGhpcy5fYXV0aEtleSlyZXR1cm5cIlwiO3ZhciBuPXRoaXMuZ2V0TW9kdWxlKHhuKS5nZXRTREtBcHBJRCgpO3JldHVyblwiaHR0cHM6Ly9cIi5jb25jYXQodGhpcy5fYmRoX2Rvd25sb2FkX3NlcnZlcixcIi9hc24uY29tL3N0ZGRvd25sb2FkX2NvbW1vbl9maWxlP2F1dGhrZXk9XCIpLmNvbmNhdCh0aGlzLl9hdXRoS2V5LFwiJmJpZD1cIikuY29uY2F0KHRoaXMuX0JESEJpeklELFwiJnN1YmJpZD1cIikuY29uY2F0KG4sXCImZmlsZWlkPVwiKS5jb25jYXQoZSxcIiZmaWxldHlwZT1cIikuY29uY2F0KHRoaXMuRklMRVRZUEUuVklERU8sXCImb3BlbmlkPVwiKS5jb25jYXQodCxcIiZ2ZXI9MFwiKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fYXV0aEtleT1cIlwiLHRoaXMuZXhwaXJlVGltZT0wfX1dKSxufSh1bykscHI9W1wicmVxdWVzdFNuYXBzaG90VXJsXCJdLGdyPWZ1bmN0aW9uKGUpe3IocyxlKTt2YXIgbj1mKHMpO2Z1bmN0aW9uIHMoZSl7dmFyIHQ7byh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIlVwbG9hZE1vZHVsZVwiLHQuVElNVXBsb2FkUGx1Z2luPW51bGwsdC50aW1VcGxvYWRQbHVnaW49bnVsbCx0LkNPU1NESz1udWxsLHQuX2Nvc1VwbG9hZE1ldGhvZD1udWxsLHQuZXhwaXJlZFRpbWVMaW1pdD02MDAsdC5hcHBpZD0wLHQuYnVja2V0TmFtZT1cIlwiLHQuY2lVcmw9XCJcIix0LmRpcmVjdG9yeT1cIlwiLHQuZG93bmxvYWRVcmw9XCJcIix0LnVwbG9hZFVybD1cIlwiLHQucmVnaW9uPVwiYXAtc2hhbmdoYWlcIix0LmNvcz1udWxsLHQuY29zT3B0aW9ucz17c2VjcmV0SWQ6XCJcIixzZWNyZXRLZXk6XCJcIixzZXNzaW9uVG9rZW46XCJcIixleHBpcmVkVGltZTowfSx0LnVwbG9hZEZpbGVUeXBlPVwiXCIsdC5kdXJhdGlvbj05MDAsdC50cnlDb3VudD0wLHQuVVBMT0FEX1NJWkVfTElNSVQ9e0FVRElPOjIwOTcxNTIwLEZJTEU6MTA0ODU3NjAwLElNQUdFOjIwOTcxNTIwLFZJREVPOjEwNDg1NzYwMH07dmFyIGE9dC5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpO3JldHVybiBhLm9uKGVpLHQuX2luaXQsaCh0KSksYS5vbih0aSx0Ll9vbkNsb3VkQ29uZmlnVXBkYXRlZCxoKHQpKSx0fXJldHVybiBhKHMsW3trZXk6XCJfaW5pdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRNb2R1bGUoWW4pO2lmKHRoaXMuVElNVXBsb2FkUGx1Z2luPWUuZ2V0UGx1Z2luKFwidGltLXVwbG9hZC1wbHVnaW5cIiksdGhpcy5USU1VcGxvYWRQbHVnaW4pdGhpcy5faW5pdFVwbG9hZGVyTWV0aG9kKCk7ZWxzZXt2YXIgdD1hZT9cImNvcy13eC1zZGtcIjpcImNvcy1qcy1zZGtcIjt0aGlzLkNPU1NESz1lLmdldFBsdWdpbih0KSx0aGlzLkNPU1NESz8odGhpcy5fZ2V0QXV0aG9yaXphdGlvbktleSgpLHRoaXMub3V0cHV0V2FybmluZyhcIkNvc1JlcGxhY2VtZW50XCIsdCkpOnRoaXMub3V0cHV0V2FybmluZyhcIlBsdWdpblVuZGV0ZWN0ZWRcIil9fX0se2tleTpcIl9vbkNsb3VkQ29uZmlnVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9XCJcIi5jb25jYXQodGhpcy5fbixcIi5fb25DbG91ZENvbmZpZ1VwZGF0ZWRcIiksdD10aGlzLmdldENsb3VkQ29uZmlnKFwidXBsb2FkX3NpemVfbGltaXRcIik7aWYoVmUubChcIlwiLmNvbmNhdChlLFwiIHVwbG9hZFNpemVMaW1pdDpcIikuY29uY2F0KHQpKSwhaXQodCkpdHJ5e3ZhciBuPUpTT04ucGFyc2UodCk7dGhpcy5VUExPQURfU0laRV9MSU1JVD17QVVESU86bi5hPzEwNDg1NzYqcGFyc2VJbnQobi5hKTp0aGlzLlVQTE9BRF9TSVpFX0xJTUlULkFVRElPLEZJTEU6bi5mPzEwNDg1NzYqcGFyc2VJbnQobi5mKTp0aGlzLlVQTE9BRF9TSVpFX0xJTUlULkZJTEUsSU1BR0U6bi5pPzEwNDg1NzYqcGFyc2VJbnQobi5pKTp0aGlzLlVQTE9BRF9TSVpFX0xJTUlULklNQUdFLFZJREVPOm4udj8xMDQ4NTc2KnBhcnNlSW50KG4udik6dGhpcy5VUExPQURfU0laRV9MSU1JVC5WSURFT319Y2F0Y2gobyl7VmUuZShcIlwiLmNvbmNhdChlLFwiIEpTT04gcGFyc2UgZXJyb3IuIHVwbG9hZFNpemVMaW1pdDpcIiksdCl9fX0se2tleTpcIl9nZXRBdXRob3JpemF0aW9uS2V5XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX2dldEF1dGhvcml6YXRpb25LZXlcIiksbj1uZXcgQWEoXCJfZ2V0QXV0aG9yaXphdGlvbktleVwiKSxvPU1hdGguY2VpbChEYXRlLm5vdygpLzFlMyk7dGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6cXMscmVxdWVzdERhdGE6e2R1cmF0aW9uOnRoaXMuZXhwaXJlZFRpbWVMaW1pdH19KS50aGVuKChmdW5jdGlvbihzKXt2YXIgYT1zLmRhdGE7VmUubChcIlwiLmNvbmNhdCh0LFwiIG9rLiBkYXRhOlwiKSxhKTt2YXIgaT1hLmV4cGlyZWRUaW1lLW87bi5zZXRNZXNzYWdlKFwicmVxdWVzdElkOlwiLmNvbmNhdChhLnJlcXVlc3RJZCxcIiByZXF1ZXN0VGltZTpcIikuY29uY2F0KG8sXCIgZXhwaXJlZFRpbWU6XCIpLmNvbmNhdChhLmV4cGlyZWRUaW1lLFwiIGRpZmY6XCIpLmNvbmNhdChpLFwic1wiKSkuc2V0TmV0d29ya1R5cGUoZS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSwhYWUmJmEucmVnaW9uJiYoZS5yZWdpb249YS5yZWdpb24pLGUuYXBwaWQ9YS5hcHBpZCxlLmJ1Y2tldE5hbWU9YS5idWNrZXROYW1lLGUuY2lVcmw9YS5jaVVybCxlLmRpcmVjdG9yeT1hLmRpcmVjdG9yeSxlLmRvd25sb2FkVXJsPWEuZG93bmxvYWRVcmwsZS51cGxvYWRVcmw9YS51cGxvYWRVcmwsZS5jb3NPcHRpb25zPXtzZWNyZXRJZDphLnNlY3JldElkLHNlY3JldEtleTphLnNlY3JldEtleSxzZXNzaW9uVG9rZW46YS5zZXNzaW9uVG9rZW4sZXhwaXJlZFRpbWU6YS5leHBpcmVkVGltZX0sVmUubChcIlwiLmNvbmNhdCh0LFwiIG9rLiByZWdpb246XCIpLmNvbmNhdChlLnJlZ2lvbixcIiBidWNrZXROYW1lOlwiKS5jb25jYXQoZS5idWNrZXROYW1lKSksZS5faW5pdFVwbG9hZGVyTWV0aG9kKCl9KSkuY2F0Y2goKGZ1bmN0aW9uKG8pe2UucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24oZSl7dmFyIHQ9dihlLDIpLHM9dFswXSxhPXRbMV07bi5zZXRFcnJvcihvLHMsYSkuZW5kKCl9KSksVmUudyhcIlwiLmNvbmNhdCh0LFwiIGZhaWxlZC4gZXJyb3I6XCIpLG8pfSkpfX0se2tleTpcIl9nZXRDb3NQcmVTaWdVcmxcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX2dldENvc1ByZVNpZ1VybFwiKSxvPU1hdGguY2VpbChEYXRlLm5vdygpLzFlMykscz1uZXcgQWEoXCJfZ2V0Q29zUHJlU2lnVXJsXCIpO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTp4cyxyZXF1ZXN0RGF0YTp7ZmlsZVR5cGU6ZS5maWxlVHlwZSxmaWxlTmFtZTplLmZpbGVOYW1lLHVwbG9hZE1ldGhvZDplLnVwbG9hZE1ldGhvZCxkdXJhdGlvbjplLmR1cmF0aW9ufX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3QudHJ5Q291bnQ9MDt2YXIgYT1lLmRhdGF8fHt9LGk9YS5leHBpcmVkVGltZS1vO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIGRhdGE6XCIpLGEpLHMuc2V0TWVzc2FnZShcInJlcXVlc3RJZDpcIi5jb25jYXQoYS5yZXF1ZXN0SWQsXCIgZXhwaXJlZFRpbWU6XCIpLmNvbmNhdChhLmV4cGlyZWRUaW1lLFwiIGRpZmY6XCIpLmNvbmNhdChpLFwic1wiKSkuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxhfSkpLmNhdGNoKChmdW5jdGlvbihvKXtyZXR1cm4tMT09PW8uY29kZSYmKG8uY29kZT1oYS5DT1NfR0VUX1NJR19GQUlMKSx0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PXYoZSwyKSxuPXRbMF0sYT10WzFdO3Muc2V0RXJyb3IobyxuLGEpLmVuZCgpfSkpLFZlLncoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxvKSx0LnRyeUNvdW50PDE/KHQudHJ5Q291bnQrKyx0Ll9nZXRDb3NQcmVTaWdVcmwoZSkpOih0LnRyeUNvdW50PTAsWmEoe2NvZGU6aGEuQ09TX0dFVF9TSUdfRkFJTH0pKX0pKX19LHtrZXk6XCJfaW5pdFVwbG9hZGVyTWV0aG9kXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKHRoaXMuVElNVXBsb2FkUGx1Z2luKXJldHVybiB0aGlzLnRpbVVwbG9hZFBsdWdpbj1uZXcgdGhpcy5USU1VcGxvYWRQbHVnaW4sdm9pZCh0aGlzLl9jb3NVcGxvYWRNZXRob2Q9ZnVuY3Rpb24odCxuKXtlLnRpbVVwbG9hZFBsdWdpbi51cGxvYWRGaWxlKHQsbil9KTt0aGlzLmFwcGlkJiYodGhpcy5jb3M9YWU/bmV3IHRoaXMuQ09TU0RLKHtGb3JjZVBhdGhTdHlsZTohMCxnZXRBdXRob3JpemF0aW9uOnRoaXMuX2dldEF1dGhvcml6YXRpb24uYmluZCh0aGlzKX0pOm5ldyB0aGlzLkNPU1NESyh7Z2V0QXV0aG9yaXphdGlvbjp0aGlzLl9nZXRBdXRob3JpemF0aW9uLmJpbmQodGhpcyl9KSx0aGlzLl9jb3NVcGxvYWRNZXRob2Q9YWU/ZnVuY3Rpb24odCxuKXtlLmNvcy5wb3N0T2JqZWN0KHQsbil9OmZ1bmN0aW9uKHQsbil7ZS5jb3MudXBsb2FkRmlsZXModCxuKX0pfX0se2tleTpcIm9uQ2hlY2tUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuQ09TU0RLJiYodGhpcy5USU1VcGxvYWRQbHVnaW58fHRoaXMuaXNMb2dnZWRJbigpJiZlJTYwPT0wJiZNYXRoLmNlaWwoRGF0ZS5ub3coKS8xZTMpPj10aGlzLmNvc09wdGlvbnMuZXhwaXJlZFRpbWUtMTIwJiZ0aGlzLl9nZXRBdXRob3JpemF0aW9uS2V5KCkpfX0se2tleTpcIl9nZXRBdXRob3JpemF0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0KHtUbXBTZWNyZXRJZDp0aGlzLmNvc09wdGlvbnMuc2VjcmV0SWQsVG1wU2VjcmV0S2V5OnRoaXMuY29zT3B0aW9ucy5zZWNyZXRLZXksWENvc1NlY3VyaXR5VG9rZW46dGhpcy5jb3NPcHRpb25zLnNlc3Npb25Ub2tlbixFeHBpcmVkVGltZTp0aGlzLmNvc09wdGlvbnMuZXhwaXJlZFRpbWV9KX19LHtrZXk6XCJ1cGxvYWRcIix2YWx1ZTpmdW5jdGlvbihlKXtpZighMD09PWUuZ2V0UmVsYXlGbGFnKCkpcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO3ZhciB0PXRoaXMuZ2V0TW9kdWxlKGVvKTtzd2l0Y2goZS50eXBlKXtjYXNlIEUuTVNHX0lNQUdFOnJldHVybiB0LmFkZFRvdGFsQ291bnQoSWEpLHRoaXMuX3VwbG9hZEltYWdlKGUpO2Nhc2UgRS5NU0dfRklMRTpyZXR1cm4gdC5hZGRUb3RhbENvdW50KElhKSx0aGlzLl91cGxvYWRGaWxlKGUpO2Nhc2UgRS5NU0dfQVVESU86cmV0dXJuIHQuYWRkVG90YWxDb3VudChJYSksdGhpcy5fdXBsb2FkQXVkaW8oZSk7Y2FzZSBFLk1TR19WSURFTzpyZXR1cm4gdC5hZGRUb3RhbENvdW50KElhKSx0aGlzLl91cGxvYWRWaWRlbyhlKTtkZWZhdWx0OnJldHVybiBQcm9taXNlLnJlc29sdmUoKX19fSx7a2V5OlwiX3VwbG9hZEltYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIG49dGhpcyxvPXRoaXMuZ2V0TW9kdWxlKE5uKSxzPWUuZ2V0RWxlbWVudHMoKVswXSxhPW8uZ2V0TWVzc2FnZU9wdGlvbihlLmNsaWVudFNlcXVlbmNlKTtyZXR1cm4gdGhpcy5kb1VwbG9hZEltYWdlKHtmaWxlOmEucGF5bG9hZC5maWxlLHRvOmEudG8sb25Qcm9ncmVzczpmdW5jdGlvbihlKXtpZihzLnVwZGF0ZVBlcmNlbnQoZSksdXQoYS5vblByb2dyZXNzKSl0cnl7YS5vblByb2dyZXNzKGUpfWNhdGNoKHQpe3JldHVybiBaYSh7Y29kZTpoYS5NRVNTQUdFX09OUFJPR1JFU1NfRlVOQ1RJT05fRVJST1J9KX19fSkudGhlbigoZnVuY3Rpb24obyl7dmFyIGEsaSxyPW8ubG9jYXRpb24sdT1vLmZpbGVUeXBlLGM9by5maWxlU2l6ZSxsPW8ud2lkdGgsZD1vLmhlaWdodCxwPW8uc21hbGxJbWFnZVVybCxnPW8uc21hbGxJbWFnZVdpZHRoLGg9by5zbWFsbEltYWdlSGVpZ2h0LF89by5sYXJnZUltYWdlVXJsLGY9by5sYXJnZUltYWdlV2lkdGgsdj1vLmxhcmdlSW1hZ2VIZWlnaHQsbT1uLmlzUHJpdmF0ZU5ldFdvcmsoKT9yOnl0KHIpO3JldHVybiBzLnVwZGF0ZUltYWdlRm9ybWF0KHUpLHAmJl8/KGE9e3VybDpwLHdpZHRoOmcsaGVpZ2h0Omh9LGk9e3VybDpfLHdpZHRoOmYsaGVpZ2h0OnZ9KTooYT1VdCh7b3JpZ2luVXJsOm0sb3JpZ2luV2lkdGg6bCxvcmlnaW5IZWlnaHQ6ZCxtaW46MTk4fSksaT1VdCh7b3JpZ2luVXJsOm0sb3JpZ2luV2lkdGg6bCxvcmlnaW5IZWlnaHQ6ZCxtaW46NzIwfSkpLHMudXBkYXRlSW1hZ2VJbmZvQXJyYXkoW3tzaXplOmMsdXJsOm0sd2lkdGg6bCxoZWlnaHQ6ZH0sdCh7fSxpKSx0KHt9LGEpXSksZX0pKX19LHtrZXk6XCJfdXBsb2FkRmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj10aGlzLmdldE1vZHVsZShObiksbz1lLmdldEVsZW1lbnRzKClbMF0scz1uLmdldE1lc3NhZ2VPcHRpb24oZS5jbGllbnRTZXF1ZW5jZSk7cmV0dXJuIHRoaXMuZG9VcGxvYWRGaWxlKHtmaWxlOnMucGF5bG9hZC5maWxlLHRvOnMudG8sb25Qcm9ncmVzczpmdW5jdGlvbihlKXtpZihvLnVwZGF0ZVBlcmNlbnQoZSksdXQocy5vblByb2dyZXNzKSl0cnl7cy5vblByb2dyZXNzKGUpfWNhdGNoKHQpe3JldHVybiBaYSh7Y29kZTpoYS5NRVNTQUdFX09OUFJPR1JFU1NfRlVOQ1RJT05fRVJST1J9KX19fSkudGhlbigoZnVuY3Rpb24obil7dmFyIHM9bi5sb2NhdGlvbixhPXQuaXNQcml2YXRlTmV0V29yaygpP3M6eXQocyk7cmV0dXJuIG8udXBkYXRlRmlsZVVybChhKSxlfSkpfX0se2tleTpcIl91cGxvYWRBdWRpb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj10aGlzLmdldE1vZHVsZShObiksbz1lLmdldEVsZW1lbnRzKClbMF0scz1uLmdldE1lc3NhZ2VPcHRpb24oZS5jbGllbnRTZXF1ZW5jZSk7cmV0dXJuIHRoaXMuZG9VcGxvYWRBdWRpbyh7ZmlsZTpzLnBheWxvYWQuZmlsZSx0bzpzLnRvLG9uUHJvZ3Jlc3M6ZnVuY3Rpb24oZSl7aWYoby51cGRhdGVQZXJjZW50KGUpLHV0KHMub25Qcm9ncmVzcykpdHJ5e3Mub25Qcm9ncmVzcyhlKX1jYXRjaCh0KXtyZXR1cm4gWmEoe2NvZGU6aGEuTUVTU0FHRV9PTlBST0dSRVNTX0ZVTkNUSU9OX0VSUk9SfSl9fX0pLnRoZW4oKGZ1bmN0aW9uKG4pe3ZhciBzPW4ubG9jYXRpb24sYT10LmlzUHJpdmF0ZU5ldFdvcmsoKT9zOnl0KHMpO3JldHVybiBvLnVwZGF0ZUF1ZGlvVXJsKGEpLGV9KSl9fSx7a2V5OlwiX3VwbG9hZFZpZGVvXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPXRoaXMuZ2V0TW9kdWxlKE5uKSxvPWUuZ2V0RWxlbWVudHMoKVswXSxzPW4uZ2V0TWVzc2FnZU9wdGlvbihlLmNsaWVudFNlcXVlbmNlKTtyZXR1cm4gdGhpcy5kb1VwbG9hZFZpZGVvKHtmaWxlOnMucGF5bG9hZC5maWxlLHRvOnMudG8sb25Qcm9ncmVzczpmdW5jdGlvbihlKXtpZihvLnVwZGF0ZVBlcmNlbnQoZSksdXQocy5vblByb2dyZXNzKSl0cnl7cy5vblByb2dyZXNzKGUpfWNhdGNoKHQpe3JldHVybiBaYSh7Y29kZTpoYS5NRVNTQUdFX09OUFJPR1JFU1NfRlVOQ1RJT05fRVJST1J9KX19fSkudGhlbigoZnVuY3Rpb24obil7dmFyIHM9bi5sb2NhdGlvbixhPW4uc25hcHNob3RJbmZvLGk9dC5pc1ByaXZhdGVOZXRXb3JrKCk/czp5dChzKTtyZXR1cm4gby51cGRhdGVWaWRlb1VybChpKSx6dChhKXx8by51cGRhdGVTbmFwc2hvdEluZm8oYSksZX0pKX19LHtrZXk6XCJfY2hlY2tTaXplRXJyb3JcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gWmEoe2NvZGU6aGFbXCJNRVNTQUdFX1wiLmNvbmNhdChlLFwiX1NJWkVfTElNSVRcIildLG1lc3NhZ2U6dGhpcy5nZXRFcnJvck1lc3NhZ2UoXCJVcGxvYWRTaXplTGltaXRcIixlLnRvTG93ZXJDYXNlKCksXCJcIi5jb25jYXQodGhpcy5VUExPQURfU0laRV9MSU1JVFtlXS8xMDQ4NTc2LFwiIE1CXCIpKX0pfX0se2tleTpcImRvVXBsb2FkSW1hZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCFlLmZpbGUpcmV0dXJuIFphKHtjb2RlOmhhLk1FU1NBR0VfSU1BR0VfU0VMRUNUX0ZJTEVfRklSU1R9KTt2YXIgbj10aGlzLl9jaGVja0ltYWdlVHlwZShlLmZpbGUpO2lmKCEwIT09bilyZXR1cm4gbjt2YXIgbz10aGlzLl9jaGVja0ltYWdlU2l6ZShlLmZpbGUpO2lmKCEwIT09bylyZXR1cm4gbzt2YXIgcz1udWxsO3JldHVybiB0aGlzLl9zZXRVcGxvYWRGaWxlVHlwZShpaSksdGhpcy51cGxvYWRCeUNPUyhlKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gcz1lLHQuaXNQcml2YXRlTmV0V29yaygpP1J0KGUubG9jYXRpb24pOlJ0KFwiaHR0cHM6Ly9cIi5jb25jYXQoZS5sb2NhdGlvbikpfSkpLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBzLndpZHRoPWUud2lkdGgscy5oZWlnaHQ9ZS5oZWlnaHQsUHJvbWlzZS5yZXNvbHZlKHMpfSkpfX0se2tleTpcIl9jaGVja0ltYWdlVHlwZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVwiXCI7cmV0dXJuIHQ9YWU/ZS51cmwuc2xpY2UoZS51cmwubGFzdEluZGV4T2YoXCIuXCIpKzEpOmUuZmlsZXNbMF0ubmFtZS5zbGljZShlLmZpbGVzWzBdLm5hbWUubGFzdEluZGV4T2YoXCIuXCIpKzEpLHNpLmluZGV4T2YodC50b0xvd2VyQ2FzZSgpKT49MHx8WmEoe2NvZGU6aGEuTUVTU0FHRV9JTUFHRV9UWVBFU19MSU1JVH0pfX0se2tleTpcIl9jaGVja0ltYWdlU2l6ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PTA7cmV0dXJuIDA9PT0odD1hZT9lLnNpemU6ZS5maWxlc1swXS5zaXplKT9aYSh7Y29kZTpoYS5NRVNTQUdFX0ZJTEVfSVNfRU1QVFl9KTp0PHRoaXMuVVBMT0FEX1NJWkVfTElNSVQuSU1BR0V8fHRoaXMuX2NoZWNrU2l6ZUVycm9yKFwiSU1BR0VcIil9fSx7a2V5OlwiZG9VcGxvYWRGaWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZmlsZT9lLmZpbGUuZmlsZXNbMF0uc2l6ZT50aGlzLlVQTE9BRF9TSVpFX0xJTUlULkZJTEU/dGhpcy5fY2hlY2tTaXplRXJyb3IoXCJGSUxFXCIpOjA9PT1lLmZpbGUuZmlsZXNbMF0uc2l6ZT9aYSh7Y29kZTpoYS5NRVNTQUdFX0ZJTEVfSVNfRU1QVFl9KToodGhpcy5fc2V0VXBsb2FkRmlsZVR5cGUoY2kpLHRoaXMudXBsb2FkQnlDT1MoZSkpOlphKHtjb2RlOmhhLk1FU1NBR0VfRklMRV9TRUxFQ1RfRklMRV9GSVJTVH0pfX0se2tleTpcImRvVXBsb2FkVmlkZW9cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5maWxlLnZpZGVvRmlsZS5zaXplPnRoaXMuVVBMT0FEX1NJWkVfTElNSVQuVklERU8/dGhpcy5fY2hlY2tTaXplRXJyb3IoXCJWSURFT1wiKTowPT09ZS5maWxlLnZpZGVvRmlsZS5zaXplP1phKHtjb2RlOmhhLk1FU1NBR0VfRklMRV9JU19FTVBUWX0pOi0xPT09YWkuaW5kZXhPZihlLmZpbGUudmlkZW9GaWxlLnR5cGUpP1phKHtjb2RlOmhhLk1FU1NBR0VfVklERU9fVFlQRVNfTElNSVR9KToodGhpcy5fc2V0VXBsb2FkRmlsZVR5cGUocmkpLGFlP3RoaXMuaGFuZGxlVmlkZW9VcGxvYWQoe2ZpbGU6ZS5maWxlLnZpZGVvRmlsZSxvblByb2dyZXNzOmUub25Qcm9ncmVzc30pOmllP3RoaXMuaGFuZGxlVmlkZW9VcGxvYWQoZSk6dm9pZCAwKX19LHtrZXk6XCJoYW5kbGVWaWRlb1VwbG9hZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihuLG8pe3QudXBsb2FkQnlDT1MoZSkudGhlbigoZnVuY3Rpb24oZSl7bihlKX0pKS5jYXRjaCgoZnVuY3Rpb24oKXt0LnVwbG9hZEJ5Q09TKGUpLnRoZW4oKGZ1bmN0aW9uKGUpe24oZSl9KSkuY2F0Y2goKGZ1bmN0aW9uKCl7byhuZXcgamEoe2NvZGU6aGEuTUVTU0FHRV9WSURFT19VUExPQURfRkFJTH0pKX0pKX0pKX0pKX19LHtrZXk6XCJkb1VwbG9hZEF1ZGlvXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZmlsZT9lLmZpbGUuc2l6ZT50aGlzLlVQTE9BRF9TSVpFX0xJTUlULkFVRElPP3RoaXMuX2NoZWNrU2l6ZUVycm9yKFwiQVVESU9cIik6MD09PWUuZmlsZS5zaXplP1phKHtjb2RlOmhhLk1FU1NBR0VfRklMRV9JU19FTVBUWX0pOih0aGlzLl9zZXRVcGxvYWRGaWxlVHlwZSh1aSksdGhpcy51cGxvYWRCeUNPUyhlKSk6WmEoe2NvZGU6aGEuTUVTU0FHRV9BVURJT19VUExPQURfRkFJTH0pfX0se2tleTpcInVwbG9hZEJ5Q09TXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztpZighdXQodGhpcy5fY29zVXBsb2FkTWV0aG9kKSlyZXR1cm4gdGhpcy5vdXRwdXRXYXJuaW5nKFwiUGx1Z2luVW5kZXRlY3RlZFwiKSxaYSh7Y29kZTpoYS5DT1NfVU5ERVRFQ1RFRH0pO2lmKHRoaXMudGltVXBsb2FkUGx1Z2luKXJldHVybiB0aGlzLl91cGxvYWRXaXRoUHJlU2lnVXJsKGUpO3ZhciBuPW5ldyBBYShcInVwbG9hZFwiKSxvPVwiXCIuY29uY2F0KHRoaXMuX24sXCIudXBsb2FkQnlDT1NcIikscz1EYXRlLm5vdygpLGE9dGhpcy5fZ2V0RmlsZShlKTtyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKGkscil7dmFyIHU9YWU/dC5fY3JlYXRlQ29zT3B0aW9uc1dYTWluaUFwcChlKTp0Ll9jcmVhdGVDb3NPcHRpb25zV2ViKGUpLGM9dDt0Ll9jb3NVcGxvYWRNZXRob2QodSwoZnVuY3Rpb24oZSx1KXt2YXIgbD1PYmplY3QuY3JlYXRlKG51bGwpO2lmKHUpe2lmKGV8fGF0KHUuZmlsZXMpJiZ1LmZpbGVzWzBdLmVycm9yKXt2YXIgZD1uZXcgamEoe2NvZGU6aGEuTUVTU0FHRV9GSUxFX1VQTE9BRF9GQUlMfSk7cmV0dXJuIG4uc2V0RXJyb3IoZCwhMCx0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGVycm9yOlwiKSx1LmZpbGVzWzBdLmVycm9yKSw0MDM9PT11LmZpbGVzWzBdLmVycm9yLnN0YXR1c0NvZGUmJihWZS53KFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBjb3MgQWNjZXNzS2V5SWQgd2FzIGludmFsaWQsIHJlZ2FpbiBhdXRoIGtleSFcIikpLHQuX2dldEF1dGhvcml6YXRpb25LZXkoKSksdm9pZCByKGQpfWwuZmlsZU5hbWU9YS5uYW1lLGwuZmlsZVNpemU9YS5zaXplLGwuZmlsZVR5cGU9YS50eXBlLnNsaWNlKGEudHlwZS5pbmRleE9mKFwiL1wiKSsxKS50b0xvd2VyQ2FzZSgpLGwubG9jYXRpb249YWU/dS5Mb2NhdGlvbjp1LmZpbGVzWzBdLmRhdGEuTG9jYXRpb247dmFyIHA9RGF0ZS5ub3coKS1zLGc9Yy5fZm9ybWF0RmlsZVNpemUoYS5zaXplKSxoPWMuX2Zvcm1hdFNwZWVkKDFlMyphLnNpemUvcCksXz1cInNpemU6XCIuY29uY2F0KGcsXCIgdGltZTpcIikuY29uY2F0KHAsXCJtcyBzcGVlZDpcIikuY29uY2F0KGgpO1ZlLmwoXCJcIi5jb25jYXQobyxcIiBzdWNjZXNzLiBuYW1lOlwiKS5jb25jYXQoYS5uYW1lLFwiIFwiKS5jb25jYXQoXykpLGkobCk7dmFyIGY9dC5nZXRNb2R1bGUoZW8pO3JldHVybiBmLmFkZENvc3QoSWEscCksZi5hZGRGaWxlU2l6ZShJYSxhLnNpemUpLHZvaWQgbi5zZXROZXR3b3JrVHlwZSh0LmdldE5ldHdvcmtUeXBlKCkpLnNldE1lc3NhZ2UoXykuZW5kKCl9dmFyIHY9bmV3IGphKHtjb2RlOmhhLk1FU1NBR0VfRklMRV9VUExPQURfRkFJTH0pO24uc2V0RXJyb3IodiwhMCxjLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLncoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSw0MDM9PT1lLnN0YXR1c0NvZGUmJihWZS53KFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBjb3MgQWNjZXNzS2V5SWQgd2FzIGludmFsaWQsIHJlZ2FpbiBhdXRoIGtleSFcIikpLHQuX2dldEF1dGhvcml6YXRpb25LZXkoKSkscih2KX0pKX0pKX19LHtrZXk6XCJfdXBsb2FkV2l0aFByZVNpZ1VybFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl91cGxvYWRXaXRoUHJlU2lnVXJsXCIpLG89dGhpcy5fZ2V0RmlsZShlKTtyZXR1cm4gdGhpcy5fY3JlYXRlQ29zT3B0aW9uc1ByZVNpZ1VybChlKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKHMsYSl7dmFyIGk9bmV3IEFhKFwidXBsb2FkXCIpLHI9ZS5yZXF1ZXN0U25hcHNob3RVcmwsdT12b2lkIDA9PT1yP3ZvaWQgMDpyLGM9ZyhlLHByKSxsPURhdGUubm93KCk7dC5fY29zVXBsb2FkTWV0aG9kKGMsKGZ1bmN0aW9uKGUscil7aWYoZXx8NDAzPT09ci5zdGF0dXNDb2RlKXJldHVybiBpLnNldEVycm9yKG5ldyBqYShlKSwhMCx0LmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobixcIiBmYWlsZWQsIGVycm9yOlwiKSxlKSx2b2lkIGEobmV3IGphKHtjb2RlOmhhLk1FU1NBR0VfRklMRV9VUExPQURfRkFJTH0pKTt2YXIgZD1PYmplY3QuY3JlYXRlKG51bGwpLHA9ci5kYXRhLmxvY2F0aW9ufHxcIlwiO3QuaXNQcml2YXRlTmV0V29yaygpfHwwIT09cC5pbmRleE9mKFwiaHR0cHM6Ly9cIikmJjAhPT1wLmluZGV4T2YoXCJodHRwOi8vXCIpfHwocD1wLnNwbGl0KFwiLy9cIilbMV0pLGQuZmlsZU5hbWU9by5uYW1lLGQuZmlsZVNpemU9by5zaXplLGQuZmlsZVR5cGU9by50eXBlLnNsaWNlKG8udHlwZS5pbmRleE9mKFwiL1wiKSsxKS50b0xvd2VyQ2FzZSgpLGQubG9jYXRpb249cDt2YXIgZz1EYXRlLm5vdygpLWwsaD10Ll9mb3JtYXRGaWxlU2l6ZShvLnNpemUpLF89dC5fZm9ybWF0U3BlZWQoMWUzKm8uc2l6ZS9nKSxmPVwic2l6ZTpcIi5jb25jYXQoaCxcIix0aW1lOlwiKS5jb25jYXQoZyxcIm1zLHNwZWVkOlwiKS5jb25jYXQoXyxcIiByZXM6XCIpLmNvbmNhdChKU09OLnN0cmluZ2lmeShyLmRhdGEpKTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgc3VjY2VzcyBuYW1lOlwiKS5jb25jYXQoby5uYW1lLFwiLFwiKS5jb25jYXQoZikpLGkuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKGYpLmVuZCgpO3ZhciB2PXQuZ2V0TW9kdWxlKGVvKTt2LmFkZENvc3QoSWEsZyksdi5hZGRGaWxlU2l6ZShJYSxvLnNpemUpO3ZhciBtPVtdO2lmKGMudGh1bWJVcmwmJmMubGFyZ2VVcmwmJihtPVt0Ll9nZXRTbWFsbEltYWdlSW5mb0J5VXJsKGMudGh1bWJVcmwsZCksdC5fZ2V0TGFyZ2VJbWFnZUluZm9CeVVybChjLmxhcmdlVXJsLGQpXSksdSYmbS5wdXNoKHQuX2dldFNuYXBzaG90SW5mb0J5VXJsKHUsZCkpLG0ubGVuZ3RoPjApcmV0dXJuIFByb21pc2UuYWxsKG0pLnRoZW4oKGZ1bmN0aW9uKCl7cyhkKX0pKTtzKGQpfSkpfSkpfSkpfX0se2tleTpcIl9nZXRSYXdPclVwbG9hZFByb3h5VXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRNb2R1bGUoeG4pLmdldEZpbGVVcGxvYWRQcm94eSgpLG49ZTtyZXR1cm4gdCYmKG49ZS5yZXBsYWNlKC9eaHR0cHM6XFwvXFwvW14vXSsvLHQpKSxufX0se2tleTpcIl9nZXRGaWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIGF0KGUuZmlsZS5maWxlcyl8fCh0PWUuZmlsZS5maWxlcyxcImZpbGVsaXN0XCI9PT1sdCh0KSk/ZS5maWxlLmZpbGVzWzBdOmUuZmlsZX19LHtrZXk6XCJfZm9ybWF0RmlsZVNpemVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZTwxMDI0P2UrXCJCXCI6ZTwxMDQ4NTc2P01hdGguZmxvb3IoZS8xMDI0KStcIktCXCI6TWF0aC5mbG9vcihlLzEwNDg1NzYpK1wiTUJcIn19LHtrZXk6XCJfZm9ybWF0U3BlZWRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZTw9MTA0ODU3Nj93dChlLzEwMjQsMSkrXCJLQi9zXCI6d3QoZS8xMDQ4NTc2LDEpK1wiTUIvc1wifX0se2tleTpcIl9jcmVhdGVDb3NPcHRpb25zV2ViXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0RmlsZShlKSxuPXQubmFtZSxvPW4uc2xpY2Uobi5sYXN0SW5kZXhPZihcIi5cIikpLHM9dGhpcy5fZ2VuRmlsZU5hbWUoXCJcIi5jb25jYXQoX3QoOTk5OTk5KSkuY29uY2F0KG8pKTtyZXR1cm57ZmlsZXM6W3tCdWNrZXQ6XCJcIi5jb25jYXQodGhpcy5idWNrZXROYW1lLFwiLVwiKS5jb25jYXQodGhpcy5hcHBpZCksUmVnaW9uOnRoaXMucmVnaW9uLEtleTpcIlwiLmNvbmNhdCh0aGlzLmRpcmVjdG9yeSxcIi9cIikuY29uY2F0KHMpLEJvZHk6dH1dLFNsaWNlU2l6ZToxMDQ4NTc2LG9uUHJvZ3Jlc3M6ZnVuY3Rpb24odCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgZS5vblByb2dyZXNzKXRyeXtlLm9uUHJvZ3Jlc3ModC5wZXJjZW50KX1jYXRjaChuKXtWZS53KFwib25Qcm9ncmVzcyBjYWxsYmFjayBlcnJvcjpcIixuKX19LG9uRmlsZUZpbmlzaDpmdW5jdGlvbihlLHQsbil7fX19fSx7a2V5OlwiX2NyZWF0ZUNvc09wdGlvbnNXWE1pbmlBcHBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRGaWxlKGUpLG49dGhpcy5fZ2VuRmlsZU5hbWUodC5uYW1lKSxvPXQudXJsO3JldHVybntCdWNrZXQ6XCJcIi5jb25jYXQodGhpcy5idWNrZXROYW1lLFwiLVwiKS5jb25jYXQodGhpcy5hcHBpZCksUmVnaW9uOnRoaXMucmVnaW9uLEtleTpcIlwiLmNvbmNhdCh0aGlzLmRpcmVjdG9yeSxcIi9cIikuY29uY2F0KG4pLEZpbGVQYXRoOm8sb25Qcm9ncmVzczpmdW5jdGlvbih0KXtpZihWZS5sKEpTT04uc3RyaW5naWZ5KHQpKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLm9uUHJvZ3Jlc3MpdHJ5e2Uub25Qcm9ncmVzcyh0LnBlcmNlbnQpfWNhdGNoKG4pe1ZlLncoXCJvblByb2dyZXNzIGNhbGxiYWNrIGVycm9yOlwiLG4pfX19fX0se2tleTpcIl9jcmVhdGVDb3NPcHRpb25zUHJlU2lnVXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPVwiXCIsbz1cIlwiLHM9MCxhPXRoaXMuX2dldEZpbGUoZSk7aWYoYWUpbj10aGlzLl9nZW5GaWxlTmFtZShhLm5hbWUpLG89YS51cmwscz0xO2Vsc2V7dmFyIGk9YS5uYW1lLHI9aS5zbGljZShpLmxhc3RJbmRleE9mKFwiLlwiKSk7bj10aGlzLl9nZW5GaWxlTmFtZShcIlwiLmNvbmNhdChfdCg5OTk5OTkpKS5jb25jYXQocikpLG89YSxzPTB9cmV0dXJuIHRoaXMuX2dldENvc1ByZVNpZ1VybCh7ZmlsZVR5cGU6dGhpcy51cGxvYWRGaWxlVHlwZSxmaWxlTmFtZTpuLHVwbG9hZE1ldGhvZDpzLGR1cmF0aW9uOnRoaXMuZHVyYXRpb259KS50aGVuKChmdW5jdGlvbihzKXt2YXIgYT1zLnVwbG9hZFVybCxpPXMuZG93bmxvYWRVcmwscj1zLnJlcXVlc3RTbmFwc2hvdFVybCx1PXZvaWQgMD09PXI/dm9pZCAwOnIsYz1zLnRodW1iVXJsLGw9cy5sYXJnZVVybDtyZXR1cm57dXJsOnQuX2dldFJhd09yVXBsb2FkUHJveHlVcmwoYSksZmlsZVR5cGU6dC51cGxvYWRGaWxlVHlwZSxmaWxlTmFtZTpuLHJlc291cmNlczpvLGRvd25sb2FkVXJsOmkscmVxdWVzdFNuYXBzaG90VXJsOnUsdGh1bWJVcmw6YyxsYXJnZVVybDpsLG9uUHJvZ3Jlc3M6ZnVuY3Rpb24odCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgZS5vblByb2dyZXNzKXRyeXtlLm9uUHJvZ3Jlc3ModC5wZXJjZW50KX1jYXRjaChuKXtWZS53KFwib25Qcm9ncmVzcyBjYWxsYmFjayBlcnJvcjpcIixuKSxWZS5lKG4pfX19fSkpfX0se2tleTpcIl9nZW5GaWxlTmFtZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVyblwiXCIuY29uY2F0KE50KCksXCItXCIpLmNvbmNhdChlKX19LHtrZXk6XCJfc2V0VXBsb2FkRmlsZVR5cGVcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLnVwbG9hZEZpbGVUeXBlPWV9fSx7a2V5OlwiX2dldFNuYXBzaG90SW5mb0J5VXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLG89bmV3IEFhKFwiZ2V0U25hcHNob3RJbmZvXCIpO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpWcyxyZXF1ZXN0RGF0YTp7cGxhdGZvcm06dGhpcy5nZXRQbGF0Zm9ybSgpLGNvdmVyTmFtZTp0aGlzLl9nZW5GaWxlTmFtZShfdCg5OTk5OSkpLHJlcXVlc3RTbmFwc2hvdFVybDplfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBuPShlLmRhdGF8fHt9KS5zbmFwc2hvdFVybDtyZXR1cm4gby5zZXRNZXNzYWdlKFwic25hcHNob3RVcmw6XCIuY29uY2F0KG4pKS5lbmQoKSx6dChuKT97fTpSdChuKS50aGVuKChmdW5jdGlvbihlKXt0LnNuYXBzaG90SW5mbz17c25hcHNob3RVcmw6bixzbmFwc2hvdFdpZHRoOmUud2lkdGgsc25hcHNob3RIZWlnaHQ6ZS5oZWlnaHR9fSkpfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gVmUudyhcIlwiLmNvbmNhdChuLl9uLFwiLl9nZXRTbmFwc2hvdEluZm9CeVVybCBmYWlsZWQuIGVycm9yOlwiKSxlKSxvLnNldENvZGUoZS5lcnJvckNvZGUpLnNldE1lc3NhZ2UoZS5lcnJvckluZm8pLmVuZCgpLHt9fSkpfX0se2tleTpcIl9nZXRTbWFsbEltYWdlSW5mb0J5VXJsXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gUnQoZSkudGhlbigoZnVuY3Rpb24obil7dC5zbWFsbEltYWdlVXJsPWUsdC5zbWFsbEltYWdlV2lkdGg9bi53aWR0aCx0LnNtYWxsSW1hZ2VIZWlnaHQ9bi5oZWlnaHR9KSl9fSx7a2V5OlwiX2dldExhcmdlSW1hZ2VJbmZvQnlVcmxcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiBSdChlKS50aGVuKChmdW5jdGlvbihuKXt0LmxhcmdlSW1hZ2VVcmw9ZSx0LmxhcmdlSW1hZ2VXaWR0aD1uLndpZHRoLHQubGFyZ2VJbWFnZUhlaWdodD1uLmhlaWdodH0pKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKX19XSksc30odW8pLGhyPVtcImRvd25sb2FkS2V5XCIsXCJwYkRvd25sb2FkS2V5XCIsXCJtZXNzYWdlTGlzdFwiXSxfcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpLHRoaXMuX249XCJNZXJnZXJNZXNzYWdlSGFuZGxlclwiLHRoaXMuX21lc3NhZ2VNb2R1bGU9dH1yZXR1cm4gYShlLFt7a2V5OlwidXBsb2FkTWVyZ2VyTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcyxvPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInVwbG9hZE1lcmdlck1lc3NhZ2VcIik7VmUuZChcIlwiLmNvbmNhdChvLFwiIG1lc3NhZ2U6XCIpLGUsXCJtZXNzYWdlQnl0ZXM6XCIuY29uY2F0KHQpKTt2YXIgcz1lLnBheWxvYWQubWVzc2FnZUxpc3QsYT1zLmxlbmd0aCxpPW5ldyBBYShcInVwbG9hZE1lcmdlck1lc3NhZ2VcIik7cmV0dXJuIHRoaXMuX21lc3NhZ2VNb2R1bGUucmVxdWVzdCh7cHJvdG9jb2xOYW1lOnpzLHJlcXVlc3REYXRhOnttZXNzYWdlTGlzdDpzfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe1ZlLmQoXCJcIi5jb25jYXQobyxcIiBvay4gcmVzcG9uc2U6XCIpLGUuZGF0YSk7dmFyIHM9ZS5kYXRhLHI9cy5wYkRvd25sb2FkS2V5LHU9cy5kb3dubG9hZEtleSxjPXtwYkRvd25sb2FkS2V5OnIsZG93bmxvYWRLZXk6dSxtZXNzYWdlTnVtYmVyOmF9O3JldHVybiBpLnNldE5ldHdvcmtUeXBlKG4uX21lc3NhZ2VNb2R1bGUuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChhLFwiLVwiKS5jb25jYXQodCxcIi1cIikuY29uY2F0KHUpKS5lbmQoKSxjfSkpLmNhdGNoKChmdW5jdGlvbihlKXt0aHJvdyBWZS53KFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksbi5fbWVzc2FnZU1vZHVsZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtpLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxlfSkpfX0se2tleTpcImRvd25sb2FkTWVyZ2VyTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJkb3dubG9hZE1lcmdlck1lc3NhZ2VcIik7VmUuZChcIlwiLmNvbmNhdChvLFwiIG1lc3NhZ2U6XCIpLGUpO3ZhciBzPWUucGF5bG9hZC5kb3dubG9hZEtleSxhPXRoaXMuX21lc3NhZ2VNb2R1bGUuZ2V0RmlsZURvd25sb2FkUHJveHkoKSxpPW5ldyBBYShcImRvd25sb2FkTWVyZ2VyTWVzc2FnZVwiKTtyZXR1cm4gaS5zZXRNZXNzYWdlKFwiZG93bmxvYWRLZXk6XCIuY29uY2F0KHMpKSx0aGlzLl9tZXNzYWdlTW9kdWxlLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpKcyxyZXF1ZXN0RGF0YTp7ZG93bmxvYWRLZXk6c319KS50aGVuKChmdW5jdGlvbihzKXtpZihWZS5kKFwiXCIuY29uY2F0KG8sXCIgb2suIHJlc3BvbnNlOlwiKSxzLmRhdGEpLHV0KGUuY2xlYXJFbGVtZW50KSl7dmFyIHI9ZS5wYXlsb2FkO3IuZG93bmxvYWRLZXksci5wYkRvd25sb2FkS2V5LHIubWVzc2FnZUxpc3Q7dmFyIHU9ZyhyLGhyKTtlLmNsZWFyRWxlbWVudCgpLGUuc2V0RWxlbWVudCh7dHlwZTplLnR5cGUsY29udGVudDp0KHttZXNzYWdlTGlzdDpzLmRhdGEubWVzc2FnZUxpc3R9LHUpfSxhKX1lbHNle3ZhciBjPVtdO3MuZGF0YS5tZXNzYWdlTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtpZighenQoZSkpe3ZhciB0PW5ldyBCYShlLGEpO2MucHVzaCh0KX19KSksZS5wYXlsb2FkLm1lc3NhZ2VMaXN0PWMsZS5wYXlsb2FkLmRvd25sb2FkS2V5PVwiXCIsZS5wYXlsb2FkLnBiRG93bmxvYWRLZXk9XCJcIn1yZXR1cm4gaS5zZXROZXR3b3JrVHlwZShuLl9tZXNzYWdlTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpLGV9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3Rocm93IFZlLncoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGtleTpcIikuY29uY2F0KHMsXCIgZXJyb3I6XCIpLGUpLG4uX21lc3NhZ2VNb2R1bGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dih0LDIpLG89blswXSxzPW5bMV07aS5zZXRFcnJvcihlLG8scykuZW5kKCl9KSksZX0pKX19LHtrZXk6XCJjcmVhdGVNZXJnZXJNZXNzYWdlUGFja1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZS5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0MyQz90aGlzLl9jcmVhdGVDMkNNZXJnZXJNZXNzYWdlUGFjayhlLHQsbik6dGhpcy5fY3JlYXRlR3JvdXBNZXJnZXJNZXNzYWdlUGFjayhlLHQsbil9fSx7a2V5OlwiX2NyZWF0ZUMyQ01lcmdlck1lc3NhZ2VQYWNrXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPW51bGw7dCYmKHQub2ZmbGluZVB1c2hJbmZvJiYobz10Lm9mZmxpbmVQdXNoSW5mbyksITA9PT10Lm9ubGluZVVzZXJPbmx5JiYobz9vLmRpc2FibGVQdXNoPSEwOm89e2Rpc2FibGVQdXNoOiEwfSkpO3ZhciBzPVtdO2lmKHN0KHQpJiZzdCh0Lm1lc3NhZ2VDb250cm9sSW5mbykpe3ZhciBhPXQubWVzc2FnZUNvbnRyb2xJbmZvLGk9YS5leGNsdWRlZEZyb21VbnJlYWRDb3VudCxyPWEuZXhjbHVkZWRGcm9tTGFzdE1lc3NhZ2UsdT1hLmV4Y2x1ZGVkRnJvbUNvbnRlbnRNb2RlcmF0aW9uOyEwPT09aSYmcy5wdXNoKFwiTm9VbnJlYWRcIiksITA9PT1yJiZzLnB1c2goXCJOb0xhc3RNc2dcIiksITA9PT11JiZzLnB1c2goXCJOb01zZ0NoZWNrXCIpfXZhciBjPVwiXCI7bnQoZS5jbG91ZEN1c3RvbURhdGEpJiZlLmNsb3VkQ3VzdG9tRGF0YS5sZW5ndGg+MCYmKGM9ZS5jbG91ZEN1c3RvbURhdGEpO3ZhciBsPW4ucGJEb3dubG9hZEtleSxkPW4uZG93bmxvYWRLZXkscD1uLm1lc3NhZ2VOdW1iZXIsZz1lLnBheWxvYWQsaD1nLnRpdGxlLF89Zy5hYnN0cmFjdExpc3QsZj1nLmNvbXBhdGlibGVUZXh0LHY9dGhpcy5fbWVzc2FnZU1vZHVsZS5nZXRNb2R1bGUoVW4pLG09diYmdi5pc09ubGluZU1lc3NhZ2UoZSx0KT8wOnZvaWQgMDtyZXR1cm57cHJvdG9jb2xOYW1lOmZvLHRqZ0lEOnRoaXMuX21lc3NhZ2VNb2R1bGUuZ2VuZXJhdGVUamdJRChlKSxyZXF1ZXN0RGF0YTp7ZnJvbUFjY291bnQ6dGhpcy5fbWVzc2FnZU1vZHVsZS5nZXRNeVVzZXJJRCgpLHRvQWNjb3VudDplLnRvLG1zZ0JvZHk6W3ttc2dUeXBlOmUudHlwZSxtc2dDb250ZW50OntwYkRvd25sb2FkS2V5OmwsZG93bmxvYWRLZXk6ZCx0aXRsZTpoLGFic3RyYWN0TGlzdDpfLGNvbXBhdGlibGVUZXh0OmYsbWVzc2FnZU51bWJlcjpwfX1dLGNsb3VkQ3VzdG9tRGF0YTpjLGNsaWVudFRpbWU6ZS5jbGllbnRUaW1lLG1zZ1NlcTplLnNlcXVlbmNlLG1zZ1JhbmRvbTplLnJhbmRvbSxtc2dMaWZlVGltZTptLG9mZmxpbmVQdXNoSW5mbzpvP3twdXNoRmxhZzohMD09PW8uZGlzYWJsZVB1c2g/MTowLHRpdGxlOm8udGl0bGV8fFwiXCIsZGVzYzpvLmRlc2NyaXB0aW9ufHxcIlwiLGV4dDpvLmV4dGVuc2lvbnx8XCJcIixhcG5zSW5mbzp7YmFkZ2VNb2RlOiEwPT09by5pZ25vcmVJT1NCYWRnZT8xOjB9LGFuZHJvaWRJbmZvOntPUFBPQ2hhbm5lbElEOm8uYW5kcm9pZE9QUE9DaGFubmVsSUR8fFwiXCJ9fTp2b2lkIDAsbWVzc2FnZUNvbnRyb2xJbmZvOjAhPT1tP3M6dm9pZCAwLGlzU3VwcG9ydEV4dGVuc2lvbjohMD09PWUuaXNTdXBwb3J0RXh0ZW5zaW9uPzE6MH19fX0se2tleTpcIl9jcmVhdGVHcm91cE1lcmdlck1lc3NhZ2VQYWNrXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPW51bGw7dCYmdC5vZmZsaW5lUHVzaEluZm8mJihvPXQub2ZmbGluZVB1c2hJbmZvKTt2YXIgcz1bXTtpZihzdCh0KSYmc3QodC5tZXNzYWdlQ29udHJvbEluZm8pKXt2YXIgYT10Lm1lc3NhZ2VDb250cm9sSW5mbyxpPWEuZXhjbHVkZWRGcm9tVW5yZWFkQ291bnQscj1hLmV4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlLHU9YS5leGNsdWRlZEZyb21Db250ZW50TW9kZXJhdGlvbjshMD09PWkmJnMucHVzaChcIk5vVW5yZWFkXCIpLCEwPT09ciYmcy5wdXNoKFwiTm9MYXN0TXNnXCIpLCEwPT09dSYmcy5wdXNoKFwiTm9Nc2dDaGVja1wiKX12YXIgYz1cIlwiO250KGUuY2xvdWRDdXN0b21EYXRhKSYmZS5jbG91ZEN1c3RvbURhdGEubGVuZ3RoPjAmJihjPWUuY2xvdWRDdXN0b21EYXRhKTt2YXIgbD1uLnBiRG93bmxvYWRLZXksZD1uLmRvd25sb2FkS2V5LHA9bi5tZXNzYWdlTnVtYmVyLGc9ZS5wYXlsb2FkLGg9Zy50aXRsZSxfPWcuYWJzdHJhY3RMaXN0LGY9Zy5jb21wYXRpYmxlVGV4dCx2PXRoaXMuX21lc3NhZ2VNb2R1bGUuZ2V0TW9kdWxlKFBuKSxtPXYmJnYuaXNPbmxpbmVNZXNzYWdlKGUsdCk/MTowO3JldHVybntwcm90b2NvbE5hbWU6dm8sdGpnSUQ6dGhpcy5fbWVzc2FnZU1vZHVsZS5nZW5lcmF0ZVRqZ0lEKGUpLHJlcXVlc3REYXRhOntmcm9tQWNjb3VudDp0aGlzLl9tZXNzYWdlTW9kdWxlLmdldE15VXNlcklEKCksZ3JvdXBJRDplLnRvLG1zZ0JvZHk6W3ttc2dUeXBlOmUudHlwZSxtc2dDb250ZW50OntwYkRvd25sb2FkS2V5OmwsZG93bmxvYWRLZXk6ZCx0aXRsZTpoLGFic3RyYWN0TGlzdDpfLGNvbXBhdGlibGVUZXh0OmYsbWVzc2FnZU51bWJlcjpwfX1dLHJhbmRvbTplLnJhbmRvbSxwcmlvcml0eTplLnByaW9yaXR5LGNsaWVudFNlcXVlbmNlOmUuY2xpZW50U2VxdWVuY2UsZ3JvdXBBdEluZm86dm9pZCAwLGNsb3VkQ3VzdG9tRGF0YTpjLG9ubGluZU9ubHlGbGFnOm0sb2ZmbGluZVB1c2hJbmZvOm8/e3B1c2hGbGFnOiEwPT09by5kaXNhYmxlUHVzaD8xOjAsdGl0bGU6by50aXRsZXx8XCJcIixkZXNjOm8uZGVzY3JpcHRpb258fFwiXCIsZXh0Om8uZXh0ZW5zaW9ufHxcIlwiLGFwbnNJbmZvOntiYWRnZU1vZGU6ITA9PT1vLmlnbm9yZUlPU0JhZGdlPzE6MH0sYW5kcm9pZEluZm86e09QUE9DaGFubmVsSUQ6by5hbmRyb2lkT1BQT0NoYW5uZWxJRHx8XCJcIn19OnZvaWQgMCxjbGllbnRUaW1lOmUuY2xpZW50VGltZSxuZWVkUmVhZFJlY2VpcHQ6ITAhPT1lLm5lZWRSZWFkUmVjZWlwdHx8di5pc01lc3NhZ2VGcm9tT3JUb0FWQ2hhdHJvb20oZS50byk/MDoxLG1lc3NhZ2VDb250cm9sSW5mbzowPT09bT9zOnZvaWQgMCxpc1N1cHBvcnRFeHRlbnNpb246ITA9PT1lLmlzU3VwcG9ydEV4dGVuc2lvbj8xOjB9fX19XSksZX0oKSxmcj17RVJSX1NWUl9DT01NX1NFTlNJVElWRV9URVhUOjgwMDAxLEVSUl9TVlJfQ09NTV9CT0RZX1NJWkVfTElNSVQ6ODAwMDIsT1BFTl9TRVJWSUNFX09WRVJMT0FEX0VSUk9SOjYwMDIyLEVSUl9TVlJfTVNHX1BLR19QQVJTRV9GQUlMRUQ6MjAwMDEsRVJSX1NWUl9NU0dfSU5URVJOQUxfQVVUSF9GQUlMRUQ6MjAwMDIsRVJSX1NWUl9NU0dfSU5WQUxJRF9JRDoyMDAwMyxFUlJfU1ZSX01TR19QVVNIX0RFTlk6MjAwMDYsRVJSX1NWUl9NU0dfSU5fUEVFUl9CTEFDS0xJU1Q6MjAwMDcsRVJSX1NWUl9NU0dfQk9USF9OT1RfRlJJRU5EOjIwMDA5LEVSUl9TVlJfTVNHX05PVF9QRUVSX0ZSSUVORDoyMDAxMCxFUlJfU1ZSX01TR19OT1RfU0VMRl9GUklFTkQ6MjAwMTEsRVJSX1NWUl9NU0dfU0hVVFVQX0RFTlk6MjAwMTIsRVJSX1NWUl9HUk9VUF9JTlZBTElEX1BBUkFNRVRFUlM6MTAwMDQsRVJSX1NWUl9HUk9VUF9QRVJNSVNTSU9OX0RFTlk6MTAwMDcsRVJSX1NWUl9HUk9VUF9OT1RfRk9VTkQ6MTAwMTAsRVJSX1NWUl9HUk9VUF9JTlZBTElEX0dST1VQSUQ6MTAwMTUsRVJSX1NWUl9HUk9VUF9SRUpFQ1RfRlJPTV9USElSRFBBUlRZOjEwMDE2LEVSUl9TVlJfR1JPVVBfU0hVVFVQX0RFTlk6MTAwMTcsTUVTU0FHRV9TRU5EX0ZBSUw6MjEwMCxPVkVSX0ZSRVFVRU5DWV9MSU1JVDoyOTk2fSx2cj1baGEuTUVTU0FHRV9PTlBST0dSRVNTX0ZVTkNUSU9OX0VSUk9SLGhhLk1FU1NBR0VfSU1BR0VfU0VMRUNUX0ZJTEVfRklSU1QsaGEuTUVTU0FHRV9JTUFHRV9UWVBFU19MSU1JVCxoYS5NRVNTQUdFX0ZJTEVfSVNfRU1QVFksaGEuTUVTU0FHRV9JTUFHRV9TSVpFX0xJTUlULGhhLk1FU1NBR0VfRklMRV9TRUxFQ1RfRklMRV9GSVJTVCxoYS5NRVNTQUdFX0ZJTEVfU0laRV9MSU1JVCxoYS5NRVNTQUdFX1ZJREVPX1NJWkVfTElNSVQsaGEuTUVTU0FHRV9WSURFT19UWVBFU19MSU1JVCxoYS5NRVNTQUdFX0FVRElPX1VQTE9BRF9GQUlMLGhhLk1FU1NBR0VfQVVESU9fU0laRV9MSU1JVCxoYS5DT1NfVU5ERVRFQ1RFRF07ZnVuY3Rpb24gbXIoZSl7dmFyIHQ9ITE7cmV0dXJuIE9iamVjdC52YWx1ZXMoZnIpLmluY2x1ZGVzKGUpJiYodD0hMCksKGU+PTEyMDAwMSYmZTw9MTNlNHx8ZT49MTAxMDAmJmU8PTEwMjAwKSYmKHQ9ITApLHR9dmFyIE1yPWZ1bmN0aW9uKGUpe3IocyxlKTt2YXIgbj1mKHMpO2Z1bmN0aW9uIHMoZSl7dmFyIHQ7cmV0dXJuIG8odGhpcyxzKSwodD1uLmNhbGwodGhpcyxlKSkuX249XCJNZXNzYWdlTW9kdWxlXCIsdC5fbWVzc2FnZU9wdGlvbnNNYXA9bmV3IE1hcCx0Ll9tZXJnZXJNZXNzYWdlSGFuZGxlcj1uZXcgX3IoaCh0KSksdH1yZXR1cm4gYShzLFt7a2V5OlwiY3JlYXRlVGV4dE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldE15VXNlcklEKCk7ZS5jdXJyZW50VXNlcj10LGUuc2VuZGVyVGlueUlEPXRoaXMuZ2V0TXlUaW55SUQoKTt2YXIgbj1uZXcgV2EoZSksbz1cInN0cmluZ1wiPT10eXBlb2YgZS5wYXlsb2FkP2UucGF5bG9hZDplLnBheWxvYWQudGV4dCxzPW5ldyBSYSh7dGV4dDpvfSksYT10aGlzLl9nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQodCk7cmV0dXJuIG4uc2V0RWxlbWVudChzKSxuLnNldE5pY2tBbmRBdmF0YXIoYSksbi5zZXROYW1lQ2FyZCh0aGlzLl9nZXROYW1lQ2FyZEJ5R3JvdXBJRChuKSksbn19LHtrZXk6XCJjcmVhdGVJbWFnZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldE15VXNlcklEKCk7ZS5jdXJyZW50VXNlcj10LGUuc2VuZGVyVGlueUlEPXRoaXMuZ2V0TXlUaW55SUQoKTt2YXIgbj1uZXcgV2EoZSk7aWYoYWUpe3ZhciBvPWUucGF5bG9hZC5maWxlO2lmKCRlKG8pKXJldHVybiB2b2lkIHRoaXMub3V0cHV0V2FybmluZyhcIkZpbGVVbnN1cHBvcnRlZEluTVBcIixcImNyZWF0ZUltYWdlTWVzc2FnZVwiKTt2YXIgcz1vLnRlbXBGaWxlc1swXS5wYXRofHxvLnRlbXBGaWxlc1swXS50ZW1wRmlsZVBhdGgsYT17dXJsOnMsbmFtZTpzLnNsaWNlKHMubGFzdEluZGV4T2YoXCIvXCIpKzEpLHNpemU6by50ZW1wRmlsZXMmJm8udGVtcEZpbGVzWzBdLnNpemV8fDEsdHlwZTpzLnNsaWNlKHMubGFzdEluZGV4T2YoXCIuXCIpKzEpLnRvTG93ZXJDYXNlKCl9O2UucGF5bG9hZC5maWxlPWF9ZWxzZSBpZihpZSlpZigkZShlLnBheWxvYWQuZmlsZSkpe3ZhciBpPWUucGF5bG9hZC5maWxlO2UucGF5bG9hZC5maWxlPXtmaWxlczpbaV19fWVsc2UgaWYoc3QoZS5wYXlsb2FkLmZpbGUpJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgdW5pKXt2YXIgcj1lLnBheWxvYWQuZmlsZS50ZW1wRmlsZXNbMF07ZS5wYXlsb2FkLmZpbGU9e2ZpbGVzOltyXX19dmFyIHU9bmV3IE5hKHtpbWFnZUZvcm1hdDpCZS5VTktOT1dOLHV1aWQ6dGhpcy5fZ2VuZXJhdGVVVUlEKGUucGF5bG9hZC5maWxlKSxmaWxlOmUucGF5bG9hZC5maWxlfSksYz10aGlzLl9nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQodCk7cmV0dXJuIG4uc2V0RWxlbWVudCh1KSxuLnNldE5pY2tBbmRBdmF0YXIoYyksbi5zZXROYW1lQ2FyZCh0aGlzLl9nZXROYW1lQ2FyZEJ5R3JvdXBJRChuKSksdGhpcy5fbWVzc2FnZU9wdGlvbnNNYXAuc2V0KG4uY2xpZW50U2VxdWVuY2UsZSksbn19LHtrZXk6XCJjcmVhdGVBdWRpb01lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnBheWxvYWQuZmlsZTtpZihhZSl7dmFyIG49e3VybDp0LnRlbXBGaWxlUGF0aCxuYW1lOnQudGVtcEZpbGVQYXRoLnNsaWNlKHQudGVtcEZpbGVQYXRoLmxhc3RJbmRleE9mKFwiL1wiKSsxKSxzaXplOnQuZmlsZVNpemUsc2Vjb25kOnBhcnNlSW50KHQuZHVyYXRpb24pLzFlMyx0eXBlOnQudGVtcEZpbGVQYXRoLnNsaWNlKHQudGVtcEZpbGVQYXRoLmxhc3RJbmRleE9mKFwiLlwiKSsxKS50b0xvd2VyQ2FzZSgpfTtlLnBheWxvYWQuZmlsZT1ufXZhciBvPXRoaXMuZ2V0TXlVc2VySUQoKTtlLmN1cnJlbnRVc2VyPW8sZS5zZW5kZXJUaW55SUQ9dGhpcy5nZXRNeVRpbnlJRCgpO3ZhciBzPW5ldyBXYShlKSxhPW5ldyBHYSh7c2Vjb25kOk1hdGguZmxvb3IodC5kdXJhdGlvbi8xZTMpLHNpemU6dC5maWxlU2l6ZXx8dC5zaXplLHVybDp0LnRlbXBGaWxlUGF0aCx1dWlkOnRoaXMuX2dlbmVyYXRlVVVJRChlLnBheWxvYWQuZmlsZSl9KSxpPXRoaXMuX2dldE5pY2tBbmRBdmF0YXJCeVVzZXJJRChvKTtyZXR1cm4gcy5zZXRFbGVtZW50KGEpLHMuc2V0Tmlja0FuZEF2YXRhcihpKSxzLnNldE5hbWVDYXJkKHRoaXMuX2dldE5hbWVDYXJkQnlHcm91cElEKHMpKSx0aGlzLl9tZXNzYWdlT3B0aW9uc01hcC5zZXQocy5jbGllbnRTZXF1ZW5jZSxlKSxzfX0se2tleTpcImNyZWF0ZVZpZGVvTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZ2V0TXlVc2VySUQoKTtlLmN1cnJlbnRVc2VyPXQsZS5zZW5kZXJUaW55SUQ9dGhpcy5nZXRNeVRpbnlJRCgpLGUucGF5bG9hZC5maWxlLnRodW1iVXJsPVwiXCIsZS5wYXlsb2FkLmZpbGUudGh1bWJTaXplPTA7dmFyIG49e307aWYoYWUpe2lmKHRlKXJldHVybiB2b2lkIHRoaXMub3V0cHV0V2FybmluZyhcIlZpZGVvVW5zdXBwb3J0ZWRJbkFsaXBheVwiKTtpZigkZShlLnBheWxvYWQuZmlsZSkpcmV0dXJuIHZvaWQgdGhpcy5vdXRwdXRXYXJuaW5nKFwiRmlsZVVuc3VwcG9ydGVkSW5NUFwiLFwiY3JlYXRlVmlkZW9NZXNzYWdlXCIpO3ZhciBvPWUucGF5bG9hZC5maWxlO2F0KG8udGVtcEZpbGVzKSYmKG89by50ZW1wRmlsZXNbMF0pLG4udXJsPW8udGVtcEZpbGVQYXRoLG4ubmFtZT1vLnRlbXBGaWxlUGF0aC5zbGljZShvLnRlbXBGaWxlUGF0aC5sYXN0SW5kZXhPZihcIi9cIikrMSksbi5zaXplPW8uc2l6ZXx8MSxuLnNlY29uZD1vLmR1cmF0aW9ufHwwLG4udHlwZT1vLnRlbXBGaWxlUGF0aC5zbGljZShvLnRlbXBGaWxlUGF0aC5sYXN0SW5kZXhPZihcIi5cIikrMSkudG9Mb3dlckNhc2UoKX1lbHNlIGlmKGllKXtpZigkZShlLnBheWxvYWQuZmlsZSkpe3ZhciBzPWUucGF5bG9hZC5maWxlO2UucGF5bG9hZC5maWxlLmZpbGVzPVtzXX1lbHNlIGlmKHN0KGUucGF5bG9hZC5maWxlKSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHVuaSl7dmFyIGE9ZS5wYXlsb2FkLmZpbGUudGVtcEZpbGU7ZS5wYXlsb2FkLmZpbGUuZmlsZXM9W2FdfXZhciBpPWUucGF5bG9hZC5maWxlO24udXJsPXdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGkuZmlsZXNbMF0pLG4ubmFtZT1pLmZpbGVzWzBdLm5hbWUsbi5zaXplPWkuZmlsZXNbMF0uc2l6ZXx8MSxuLnNlY29uZD1pLmZpbGVzWzBdLmR1cmF0aW9ufHwwLG4udHlwZT1pLmZpbGVzWzBdLnR5cGUuc3BsaXQoXCIvXCIpWzFdfWUucGF5bG9hZC5maWxlLnZpZGVvRmlsZT1uO3ZhciByPW5ldyBXYShlKSx1PW5ldyB4YSh7dmlkZW9Gb3JtYXQ6bi50eXBlLHZpZGVvU2Vjb25kOnd0KG4uc2Vjb25kLDApLHZpZGVvU2l6ZTpuLnNpemUscmVtb3RlVmlkZW9Vcmw6XCJcIix2aWRlb1VybDpuLnVybCx2aWRlb1VVSUQ6dGhpcy5fZ2VuZXJhdGVVVUlEKGUucGF5bG9hZC5maWxlLnZpZGVvRmlsZSksdGh1bWJVVUlEOnRoaXMuX2dlbmVyYXRlVVVJRChlLnBheWxvYWQuZmlsZS52aWRlb0ZpbGUpLHRodW1iV2lkdGg6ZS5wYXlsb2FkLmZpbGUud2lkdGh8fDIwMCx0aHVtYkhlaWdodDplLnBheWxvYWQuZmlsZS5oZWlnaHR8fDIwMCx0aHVtYlVybDplLnBheWxvYWQuZmlsZS50aHVtYlVybCx0aHVtYlNpemU6ZS5wYXlsb2FkLmZpbGUudGh1bWJTaXplLHRodW1iRm9ybWF0OmUucGF5bG9hZC5maWxlLnRodW1iVXJsLnNsaWNlKGUucGF5bG9hZC5maWxlLnRodW1iVXJsLmxhc3RJbmRleE9mKFwiLlwiKSsxKS50b0xvd2VyQ2FzZSgpfSksYz10aGlzLl9nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQodCk7cmV0dXJuIHIuc2V0RWxlbWVudCh1KSxyLnNldE5pY2tBbmRBdmF0YXIoYyksci5zZXROYW1lQ2FyZCh0aGlzLl9nZXROYW1lQ2FyZEJ5R3JvdXBJRChyKSksdGhpcy5fbWVzc2FnZU9wdGlvbnNNYXAuc2V0KHIuY2xpZW50U2VxdWVuY2UsZSkscn19LHtrZXk6XCJjcmVhdGVDdXN0b21NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRNeVVzZXJJRCgpO2UuY3VycmVudFVzZXI9dCxlLnNlbmRlclRpbnlJRD10aGlzLmdldE15VGlueUlEKCk7dmFyIG49bmV3IFdhKGUpLG89bmV3IHFhKHtkYXRhOmUucGF5bG9hZC5kYXRhLGRlc2NyaXB0aW9uOmUucGF5bG9hZC5kZXNjcmlwdGlvbixleHRlbnNpb246ZS5wYXlsb2FkLmV4dGVuc2lvbn0pLHM9dGhpcy5fZ2V0Tmlja0FuZEF2YXRhckJ5VXNlcklEKHQpO3JldHVybiBuLnNldEVsZW1lbnQobyksbi5zZXROaWNrQW5kQXZhdGFyKHMpLG4uc2V0TmFtZUNhcmQodGhpcy5fZ2V0TmFtZUNhcmRCeUdyb3VwSUQobikpLG59fSx7a2V5OlwiY3JlYXRlRmFjZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldE15VXNlcklEKCk7ZS5jdXJyZW50VXNlcj10LGUuc2VuZGVyVGlueUlEPXRoaXMuZ2V0TXlUaW55SUQoKTt2YXIgbj1uZXcgV2EoZSksbz1uZXcgT2EoZS5wYXlsb2FkKSxzPXRoaXMuX2dldE5pY2tBbmRBdmF0YXJCeVVzZXJJRCh0KTtyZXR1cm4gbi5zZXRFbGVtZW50KG8pLG4uc2V0Tmlja0FuZEF2YXRhcihzKSxuLnNldE5hbWVDYXJkKHRoaXMuX2dldE5hbWVDYXJkQnlHcm91cElEKG4pKSxufX0se2tleTpcImNyZWF0ZU1lcmdlck1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldE15VXNlcklEKCk7ZS5jdXJyZW50VXNlcj10LGUuc2VuZGVyVGlueUlEPXRoaXMuZ2V0TXlUaW55SUQoKTt2YXIgbj10aGlzLl9nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQodCksbz1uZXcgV2EoZSkscz1uZXcgSGEoZS5wYXlsb2FkKTtyZXR1cm4gby5zZXRFbGVtZW50KHMpLG8uc2V0Tmlja0FuZEF2YXRhcihuKSxvLnNldE5hbWVDYXJkKHRoaXMuX2dldE5hbWVDYXJkQnlHcm91cElEKG8pKSxvLnNldFJlbGF5RmxhZyghMCksb319LHtrZXk6XCJjcmVhdGVGb3J3YXJkTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUudG8sbj1lLmNvbnZlcnNhdGlvblR5cGUsbz1lLnByaW9yaXR5LHM9ZS5wYXlsb2FkLGE9ZS5uZWVkUmVhZFJlY2VpcHQsaT1lLnJlY2VpdmVyTGlzdCxyPXRoaXMuZ2V0TXlVc2VySUQoKSx1PXRoaXMuX2dldE5pY2tBbmRBdmF0YXJCeVVzZXJJRChyKTtpZihzLnR5cGU9PT1FLk1TR19HUlBfVElQKXJldHVybiBaYSh7Y29kZTpoYS5NRVNTQUdFX0ZPUldBUkRfVFlQRV9JTlZBTElEfSk7dmFyIGM9e3RvOnQsY29udmVyc2F0aW9uVHlwZTpuLGNvbnZlcnNhdGlvbklEOlwiXCIuY29uY2F0KG4pLmNvbmNhdCh0KSxwcmlvcml0eTpvLGlzUGxhY2VNZXNzYWdlOjAsc3RhdHVzOlF0LlVOU0VORCxjdXJyZW50VXNlcjpyLHNlbmRlclRpbnlJRDp0aGlzLmdldE15VGlueUlEKCksY2xvdWRDdXN0b21EYXRhOmUuY2xvdWRDdXN0b21EYXRhfHxzLmNsb3VkQ3VzdG9tRGF0YXx8XCJcIixuZWVkUmVhZFJlY2VpcHQ6YSxyZWNlaXZlckxpc3Q6aSxpc1N1cHBvcnRFeHRlbnNpb246ZS5pc1N1cHBvcnRFeHRlbnNpb258fCExfSxsPW5ldyBXYShjKTtyZXR1cm4gbC5zZXRFbGVtZW50KHMuZ2V0RWxlbWVudHMoKVswXSksbC5zZXROaWNrQW5kQXZhdGFyKHUpLGwuc2V0TmFtZUNhcmQodGhpcy5fZ2V0TmFtZUNhcmRCeUdyb3VwSUQocykpLGwuc2V0UmVsYXlGbGFnKCEwKSxsfX0se2tleTpcImRvd25sb2FkTWVyZ2VyTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tZXJnZXJNZXNzYWdlSGFuZGxlci5kb3dubG9hZE1lcmdlck1lc3NhZ2UoZSl9fSx7a2V5OlwiY3JlYXRlRmlsZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihhZSl7aWYoIVgmJiFRJiYhb2UpcmV0dXJuO3ZhciBuPXJlLmdldFN5c3RlbUluZm9TeW5jKCkuU0RLVmVyc2lvbjtpZihYJiZHdChuLFwiMi41LjBcIik8MClyZXR1cm4gdm9pZCB0aGlzLm91dHB1dFdhcm5pbmcoXCJXWENob29zZU1lc3NhZ2VGaWxlXCIpO2lmKFEmJkd0KG4sXCIxLjE4LjBcIik8MClyZXR1cm4gdm9pZCB0aGlzLm91dHB1dFdhcm5pbmcoXCJRUUNob29zZU1lc3NhZ2VGaWxlXCIpfWlmKGllfHxvZSl7aWYoJGUoZS5wYXlsb2FkLmZpbGUpKXt2YXIgbz1lLnBheWxvYWQuZmlsZTtlLnBheWxvYWQuZmlsZT17ZmlsZXM6W29dfX1lbHNlIGlmKHN0KGUucGF5bG9hZC5maWxlKSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHVuaSl7dmFyIHM9ZS5wYXlsb2FkLmZpbGUsYT1zLnRlbXBGaWxlcyxpPXMuZmlsZXMscj1udWxsO2F0KGEpP3I9YVswXTphdChpKSYmKHI9aVswXSksZS5wYXlsb2FkLmZpbGU9e2ZpbGVzOltyXX19fWVsc2UgaWYoWHx8USl7dmFyIHU9ZS5wYXlsb2FkLmZpbGUudGVtcEZpbGVzLGM9dCh0KHt9LHVbMF0pLHt9LHt1cmw6dVswXS5wYXRofSk7ZS5wYXlsb2FkLmZpbGU9e2ZpbGVzOltjXX19dmFyIGw9dGhpcy5nZXRNeVVzZXJJRCgpO2UuY3VycmVudFVzZXI9bCxlLnNlbmRlclRpbnlJRD10aGlzLmdldE15VGlueUlEKCk7dmFyIGQ9bmV3IFdhKGUpLHA9bmV3IEZhKHt1dWlkOnRoaXMuX2dlbmVyYXRlVVVJRChlLnBheWxvYWQuZmlsZSksZmlsZTplLnBheWxvYWQuZmlsZX0pLGc9dGhpcy5fZ2V0Tmlja0FuZEF2YXRhckJ5VXNlcklEKGwpO3JldHVybiBkLnNldEVsZW1lbnQocCksZC5zZXROaWNrQW5kQXZhdGFyKGcpLGQuc2V0TmFtZUNhcmQodGhpcy5fZ2V0TmFtZUNhcmRCeUdyb3VwSUQoZCkpLHRoaXMuX21lc3NhZ2VPcHRpb25zTWFwLnNldChkLmNsaWVudFNlcXVlbmNlLGUpLGR9fSx7a2V5OlwiY3JlYXRlTG9jYXRpb25NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5nZXRNeVVzZXJJRCgpO2UuY3VycmVudFVzZXI9dCxlLnNlbmRlclRpbnlJRD10aGlzLmdldE15VGlueUlEKCk7dmFyIG49bmV3IFdhKGUpLG89bmV3IFZhKGUucGF5bG9hZCkscz10aGlzLl9nZXROaWNrQW5kQXZhdGFyQnlVc2VySUQodCk7cmV0dXJuIG4uc2V0RWxlbWVudChvKSxuLnNldE5pY2tBbmRBdmF0YXIocyksbi5zZXROYW1lQ2FyZCh0aGlzLl9nZXROYW1lQ2FyZEJ5R3JvdXBJRChuKSksbn19LHtrZXk6XCJfb25DYW5ub3RGaW5kTW9kdWxlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5Olwic2VuZE1lc3NhZ2VJbnN0YW5jZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcztpZighMT09PXRoaXMuZ2V0TW9kdWxlKG9vKS5maWx0ZXJNZXNzYWdlKGUsdCkpcmV0dXJuIHRoaXMuX29uU2VuZE1lc3NhZ2VGYWlsZWQoZSxuZXcgamEoe2NvZGU6aGEuUFJPRkFOSVRZX0ZPVU5EfSkpO3ZhciBvLHM9bnVsbDtzd2l0Y2goZS5jb252ZXJzYXRpb25UeXBlKXtjYXNlIEUuQ09OVl9DMkM6aWYoIShzPXRoaXMuZ2V0TW9kdWxlKFVuKSkpcmV0dXJuIHRoaXMuX29uQ2Fubm90RmluZE1vZHVsZSgpO2JyZWFrO2Nhc2UgRS5DT05WX0dST1VQOmlmKCEocz10aGlzLmdldE1vZHVsZShQbikpKXJldHVybiB0aGlzLl9vbkNhbm5vdEZpbmRNb2R1bGUoKTtpZihEdCh7Z3JvdXBJRDplLnRvfSkpe3ZhciBhPXMuZ2V0TG9jYWxHcm91cFByb2ZpbGUoZS50byk7aWYoYSYmYS5pc1N1cHBvcnRUb3BpYylyZXR1cm4gWmEoe2NvZGU6aGEuTUVTU0FHRV9TRU5EX0dST1VQX1dJVEhfVE9QSUNfRkFJTH0pfWJyZWFrO2RlZmF1bHQ6cmV0dXJuIFphKHtjb2RlOmhhLk1FU1NBR0VfU0VORF9JTlZBTElEX0NPTlZFUlNBVElPTl9UWVBFfSl9dmFyIGk9dGhpcy5nZXRNb2R1bGUoV24pLHI9dGhpcy5nZXRNb2R1bGUoUG4pO3JldHVybiBpLnVwbG9hZChlKS50aGVuKChmdW5jdGlvbigpe24uX2dldFNlbmRNZXNzYWdlU3BlY2lmaWVkS2V5KGUpPT09eWEmJm4uZ2V0TW9kdWxlKGVvKS5hZGRTdWNjZXNzQ291bnQoSWEpO3JldHVybiByLmd1YXJkRm9yQVZDaGF0Um9vbShlKS50aGVuKChmdW5jdGlvbigpe2lmKCFlLmlzU2VuZGFibGUoKSlyZXR1cm4gWmEoe2NvZGU6aGEuTUVTU0FHRV9GSUxFX1VSTF9JU19FTVBUWX0pO24uX2FkZFNlbmRNZXNzYWdlVG90YWxDb3VudChlKSxvPURhdGUubm93KCk7dmFyIGE9ZnVuY3Rpb24oZSl7dmFyIHQ9XCJ1dGYtOFwiO2llJiZkb2N1bWVudCYmKHQ9ZG9jdW1lbnQuY2hhcnNldC50b0xvd2VyQ2FzZSgpKTt2YXIgbixvLHM9MDtpZihvPWUubGVuZ3RoLFwidXRmLThcIj09PXR8fFwidXRmOFwiPT09dClmb3IodmFyIGE9MDthPG87YSsrKShuPWUuY29kZVBvaW50QXQoYSkpPD0xMjc/cys9MTpuPD0yMDQ3P3MrPTI6bjw9NjU1MzU/cys9Mzoocys9NCxhKyspO2Vsc2UgaWYoXCJ1dGYtMTZcIj09PXR8fFwidXRmMTZcIj09PXQpZm9yKHZhciBpPTA7aTxvO2krKykobj1lLmNvZGVQb2ludEF0KGkpKTw9NjU1MzU/cys9Mjoocys9NCxpKyspO2Vsc2Ugcz1lLnJlcGxhY2UoL1teXFx4MDAtXFx4ZmZdL2csXCJhYVwiKS5sZW5ndGg7cmV0dXJuIHN9KEpTT04uc3RyaW5naWZ5KGUpKTtyZXR1cm4gZS50eXBlPT09RS5NU0dfTUVSR0VSJiZhPjExMjY0P24uX21lcmdlck1lc3NhZ2VIYW5kbGVyLnVwbG9hZE1lcmdlck1lc3NhZ2UoZSxhKS50aGVuKChmdW5jdGlvbihvKXt2YXIgcz1uLl9tZXJnZXJNZXNzYWdlSGFuZGxlci5jcmVhdGVNZXJnZXJNZXNzYWdlUGFjayhlLHQsbyk7cmV0dXJuIG4ucmVxdWVzdChzKX0pKToobi5nZXRNb2R1bGUocW4pLnNldE1lc3NhZ2VSYW5kb20oZSksZS5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0MyQ3x8ZS5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0dST1VQP3Muc2VuZE1lc3NhZ2UoZSx0KTp2b2lkIDApfSkpLnRoZW4oKGZ1bmN0aW9uKGEpe3ZhciBpPWEuZGF0YSxyPWkudGltZSx1PWkuc2VxdWVuY2UsYz1pLnJlYWRSZWNlaXB0Q29kZTtldChjKSYmMCE9PWMmJihuZXcgQWEoXCJzZW5kTWVzc2FnZVdpdGhSZWNlaXB0XCIpLnNldE1lc3NhZ2UoXCJmcm9tOlwiLmNvbmNhdChlLmZyb20sXCIgdG86XCIpLmNvbmNhdChlLnRvLFwiIHNlcXVlbmNlOlwiKS5jb25jYXQodSxcIiByZWFkUmVjZWlwdENvZGU6XCIpLmNvbmNhdChjKSkuZW5kKCksVmUudyhcIlwiLmNvbmNhdChuLl9uLFwiLnNlbmRNZXNzYWdlSW5zdGFuY2UgcmVhZFJlY2VpcHRDb2RlOlwiKS5jb25jYXQoYyxcIiBtZXNzYWdlOlwiKS5jb25jYXQobi5nZXRFcnJvck1lc3NhZ2UoYykpKSk7bi5fYWRkU2VuZE1lc3NhZ2VTdWNjZXNzQ291bnQoZSxvKSxuLl9tZXNzYWdlT3B0aW9uc01hcC5kZWxldGUoZS5jbGllbnRTZXF1ZW5jZSk7dmFyIGw9bi5nZXRNb2R1bGUocW4pO2Uuc3RhdHVzPVF0LlNVQ0NFU1MsZS50aW1lPXI7dmFyIGQ9ITE7aWYoZS5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0dST1VQKWUuc2VxdWVuY2U9dTtlbHNlIGlmKGUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9DMkMpe3ZhciBwPWwuZ2V0TGF0ZXN0TWVzc2FnZVNlbnRCeU1lKGUuY29udmVyc2F0aW9uSUQpO2lmKHApe3ZhciBnPXAubmljayxoPXAuYXZhdGFyO2c9PT1lLm5pY2smJmg9PT1lLmF2YXRhcnx8KGQ9ITApfX1pZihkJiZsLm1vZGlmeU1lc3NhZ2VTZW50QnlNZSh7Y29udmVyc2F0aW9uSUQ6ZS5jb252ZXJzYXRpb25JRCxsYXRlc3ROaWNrOmUubmljayxsYXRlc3RBdmF0YXI6ZS5hdmF0YXJ9KSxzLmlzT25saW5lTWVzc2FnZShlLHQpKWUuX29ubGluZU9ubHlGbGFnPSEwO2Vsc2V7bC5hcHBlbmRUb01lc3NhZ2VMaXN0KGUpO3ZhciBfPWU7c3QodCkmJnN0KHQubWVzc2FnZUNvbnRyb2xJbmZvKSYmKCEwPT09dC5tZXNzYWdlQ29udHJvbEluZm8uZXhjbHVkZWRGcm9tTGFzdE1lc3NhZ2UmJihlLl9pc0V4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlPSEwLF89XCJcIiksITA9PT10Lm1lc3NhZ2VDb250cm9sSW5mby5leGNsdWRlZEZyb21VbnJlYWRDb3VudCYmKGUuX2lzRXhjbHVkZWRGcm9tVW5yZWFkQ291bnQ9ITApKTt2YXIgZj1lLmNvbnZlcnNhdGlvblR5cGU7aWYoa3QoZS50bykpZj1FLkNPTlZfVE9QSUMsbi5nZXRNb2R1bGUoRm4pLm9uTWVzc2FnZVNlbnQoe2dyb3VwSUQ6eHQoZS50byksdG9waWNJRDplLnRvLGxhc3RNZXNzYWdlOl99KTtsLm9uTWVzc2FnZVNlbnQoe2NvbnZlcnNhdGlvbk9wdGlvbnNMaXN0Olt7Y29udmVyc2F0aW9uSUQ6ZS5jb252ZXJzYXRpb25JRCx1bnJlYWRDb3VudDowLHR5cGU6ZixzdWJUeXBlOmUuY29udmVyc2F0aW9uU3ViVHlwZSxsYXN0TWVzc2FnZTpffV19KX1yZXR1cm4gZS5nZXRSZWxheUZsYWcoKXx8XCJUSU1JbWFnZUVsZW1cIiE9PWUudHlwZXx8UHQoZS5wYXlsb2FkLmltYWdlSW5mb0FycmF5KSxZYSh7bWVzc2FnZTplfSl9KSl9KSkuY2F0Y2goKGZ1bmN0aW9uKHQpe3JldHVybiBuLl9vblNlbmRNZXNzYWdlRmFpbGVkKGUsdCl9KSl9fSx7a2V5OlwiX29uU2VuZE1lc3NhZ2VGYWlsZWRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Uuc3RhdHVzPVF0LkZBSUwsdGhpcy5nZXRNb2R1bGUocW4pLmRlbGV0ZU1lc3NhZ2VSYW5kb20oZSksdGhpcy5fYWRkU2VuZE1lc3NhZ2VGYWlsQ291bnRPblVzZXIoZSx0KTt2YXIgbj1uZXcgQWEoXCJzZW5kTWVzc2FnZVwiKTtyZXR1cm4gbi5zZXRNZXNzYWdlKFwidGpnX2lkOlwiLmNvbmNhdCh0aGlzLmdlbmVyYXRlVGpnSUQoZSksXCIgdHlwZTpcIikuY29uY2F0KGUudHlwZSxcIiBmcm9tOlwiKS5jb25jYXQoZS5mcm9tLFwiIHRvOlwiKS5jb25jYXQoZS50bykpLHRoaXMucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89dihlLDIpLHM9b1swXSxhPW9bMV07bi5zZXRFcnJvcih0LHMsYSkuZW5kKCl9KSksVmUuZShcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vblNlbmRNZXNzYWdlRmFpbGVkIGVycm9yOlwiKSx0KSxaYShuZXcgamEoe2NvZGU6dCYmdC5jb2RlP3QuY29kZTpoYS5NRVNTQUdFX1NFTkRfRkFJTCxtZXNzYWdlOnQmJnQubWVzc2FnZT90Lm1lc3NhZ2U6dm9pZCAwLGRhdGE6e21lc3NhZ2U6ZX19KSl9fSx7a2V5OlwiX2dldFNlbmRNZXNzYWdlU3BlY2lmaWVkS2V5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoW0UuTVNHX0lNQUdFLEUuTVNHX0FVRElPLEUuTVNHX1ZJREVPLEUuTVNHX0ZJTEVdLmluY2x1ZGVzKGUudHlwZSkpcmV0dXJuIHlhO2lmKGUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9DMkMpcmV0dXJuIHZhO2lmKGUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9HUk9VUCl7dmFyIHQ9dGhpcy5nZXRNb2R1bGUoUG4pLmdldExvY2FsR3JvdXBQcm9maWxlKGUudG8pO2lmKCF0KXJldHVybjt2YXIgbj10LnR5cGU7cmV0dXJuIFR0KG4pP01hOm1hfX19LHtrZXk6XCJfYWRkU2VuZE1lc3NhZ2VUb3RhbENvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0U2VuZE1lc3NhZ2VTcGVjaWZpZWRLZXkoZSk7dCYmdGhpcy5nZXRNb2R1bGUoZW8pLmFkZFRvdGFsQ291bnQodCl9fSx7a2V5OlwiX2FkZFNlbmRNZXNzYWdlU3VjY2Vzc0NvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1NYXRoLmFicyhEYXRlLm5vdygpLXQpLG89dGhpcy5fZ2V0U2VuZE1lc3NhZ2VTcGVjaWZpZWRLZXkoZSk7aWYobyl7dmFyIHM9dGhpcy5nZXRNb2R1bGUoZW8pO3MuYWRkU3VjY2Vzc0NvdW50KG8pLHMuYWRkQ29zdChvLG4pfX19LHtrZXk6XCJfYWRkU2VuZE1lc3NhZ2VGYWlsQ291bnRPblVzZXJcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuLG8scz10LmNvZGUsYT12b2lkIDA9PT1zPy0xOnMsaT10aGlzLmdldE1vZHVsZShlbykscj10aGlzLl9nZXRTZW5kTWVzc2FnZVNwZWNpZmllZEtleShlKTtyPT09eWEmJihuPWEsbz0hMSx2ci5pbmNsdWRlcyhuKSYmKG89ITApLG8pP2kuYWRkRmFpbGVkQ291bnRPZlVzZXJTaWRlKElhKTptcihhKSYmciYmaS5hZGRGYWlsZWRDb3VudE9mVXNlclNpZGUocil9fSx7a2V5OlwicmVzZW5kTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlLmlzUmVzZW5kPSEwLGUuc3RhdHVzPVF0LlVOU0VORCx0aGlzLnNlbmRNZXNzYWdlSW5zdGFuY2UoZSl9fSx7a2V5OlwicmV2b2tlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1udWxsO2lmKGUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9DMkM/bj10aGlzLmdldE1vZHVsZShVbik6ZS5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0dST1VQJiYobj10aGlzLmdldE1vZHVsZShQbikpLCFuKXJldHVybiB0aGlzLl9vbkNhbm5vdEZpbmRNb2R1bGUoKTt2YXIgbz1uZXcgQWEoXCJyZXZva2VNZXNzYWdlXCIpO28uc2V0TWVzc2FnZShcInRqZ19pZDpcIi5jb25jYXQodGhpcy5nZW5lcmF0ZVRqZ0lEKGUpLFwiIHR5cGU6XCIpLmNvbmNhdChlLnR5cGUsXCIgZnJvbTpcIikuY29uY2F0KGUuZnJvbSxcIiB0bzpcIikuY29uY2F0KGUudG8pKTt2YXIgcz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJyZXZva2VNZXNzYWdlXCIpO3JldHVybiBuLnJldm9rZU1lc3NhZ2UoZSkudGhlbigoZnVuY3Rpb24obil7dmFyIGE9bi5kYXRhLnJlY2FsbFJldExpc3Q7aWYoIXp0KGEpJiYwIT09YVswXS5yZXRDb2RlKXt2YXIgaT1uZXcgamEoe2NvZGU6YVswXS5yZXRDb2RlLGRhdGE6e21lc3NhZ2U6ZX19KTtyZXR1cm4gby5zZXRDb2RlKGkuY29kZSkuc2V0TW9yZU1lc3NhZ2UoaS5tZXNzYWdlKS5lbmQoKSxaYShpKX1yZXR1cm4gVmUuaShcIlwiLmNvbmNhdChzLFwiIG9rLiBJRDpcIikuY29uY2F0KGUuSUQpKSxlLmlzUmV2b2tlZD0hMCxvLmVuZCgpLHQuZ2V0TW9kdWxlKHFuKS5vbk1lc3NhZ2VSZXZva2VkKFtlXSksWWEoe21lc3NhZ2U6ZX0pfSkpLmNhdGNoKChmdW5jdGlvbihuKXt0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PXYoZSwyKSxzPXRbMF0sYT10WzFdO28uc2V0RXJyb3IobixzLGEpLmVuZCgpfSkpO3ZhciBhPW5ldyBqYSh7Y29kZTpuJiZuLmNvZGU/bi5jb2RlOmhhLk1FU1NBR0VfUkVWT0tFX0ZBSUwsbWVzc2FnZTpuJiZuLm1lc3NhZ2U/bi5tZXNzYWdlOnZvaWQgMCxkYXRhOnttZXNzYWdlOmV9fSk7cmV0dXJuIFZlLncoXCJcIi5jb25jYXQocyxcIiBmYWlsZWQuIGVycm9yOlwiKSxuKSxaYShhKX0pKX19LHtrZXk6XCJkZWxldGVNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPW51bGwsbz1lWzBdLHM9by5jb252ZXJzYXRpb25JRCxhPVwiXCIsaT1bXSxyPVtdO2lmKG8uY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9DMkMpbj10aGlzLmdldE1vZHVsZShVbiksYT1zLnJlcGxhY2UoRS5DT05WX0MyQyxcIlwiKSxlLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UmJmUuc3RhdHVzPT09UXQuU1VDQ0VTUyYmZS5jb252ZXJzYXRpb25JRD09PXMmJihlLl9vbmxpbmVPbmx5RmxhZ3x8aS5wdXNoKFwiXCIuY29uY2F0KGUuc2VxdWVuY2UsXCJfXCIpLmNvbmNhdChlLnJhbmRvbSxcIl9cIikuY29uY2F0KGUudGltZSkpLHIucHVzaChlKSl9KSk7ZWxzZSBpZihvLmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfR1JPVVApbj10aGlzLmdldE1vZHVsZShQbiksYT1zLnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpLGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZSYmZS5zdGF0dXM9PT1RdC5TVUNDRVNTJiZlLmNvbnZlcnNhdGlvbklEPT09cyYmKGUuX29ubGluZU9ubHlGbGFnfHxpLnB1c2goXCJcIi5jb25jYXQoZS5zZXF1ZW5jZSkpLHIucHVzaChlKSl9KSk7ZWxzZSBpZihvLmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfU1lTVEVNKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfREVMRVRFX0dST1VQX1NZU1RFTV9OT1RJQ0V9KTtpZighbilyZXR1cm4gdGhpcy5fb25DYW5ub3RGaW5kTW9kdWxlKCk7aWYoMD09PWkubGVuZ3RoKXJldHVybiB0aGlzLl9vbk1lc3NhZ2VEZWxldGVkKHIpO2kubGVuZ3RoPjMwJiYoaT1pLnNsaWNlKDAsMzApLHI9ci5zbGljZSgwLDMwKSk7dmFyIHU9bmV3IEFhKFwiZGVsZXRlTWVzc2FnZVwiKTt1LnNldE1lc3NhZ2UoXCJ0bzpcIi5jb25jYXQoYSxcIiBjb3VudDpcIikuY29uY2F0KGkubGVuZ3RoKSk7dmFyIGM9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZGVsZXRlTWVzc2FnZVwiKTtyZXR1cm4gbi5kZWxldGVNZXNzYWdlKHt0bzphLGtleUxpc3Q6aX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiB1LmVuZCgpLFZlLmkoXCJcIi5jb25jYXQoYyxcIiBva1wiKSksdC5fb25NZXNzYWdlRGVsZXRlZChyKX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7dC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTt1LnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS53KFwiXCIuY29uY2F0KGMsXCIgZmFpbGVkLiBlcnJvcjpcIiksZSk7dmFyIG49bmV3IGphKHtjb2RlOmUmJmUuY29kZT9lLmNvZGU6aGEuTUVTU0FHRV9ERUxFVEVfRkFJTCxtZXNzYWdlOmUmJmUubWVzc2FnZT9lLm1lc3NhZ2U6dm9pZCAwfSk7cmV0dXJuIFphKG4pfSkpfX0se2tleTpcIl9vbk1lc3NhZ2VEZWxldGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKHFuKS5vbk1lc3NhZ2VEZWxldGVkKGUpLFhhKHttZXNzYWdlTGlzdDplfSl9fSx7a2V5OlwidHJhbnNsYXRlVGV4dFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInRyYW5zbGF0ZVRleHRcIiksbz1lLnNvdXJjZVRleHRMaXN0LHM9ZS5zb3VyY2VMYW5ndWFnZSxhPWUudGFyZ2V0TGFuZ3VhZ2UsaT1uZXcgQWEoXCJ0cmFuc2xhdGVUZXh0XCIpO3JldHVybiBpLnNldE1lc3NhZ2UoXCJzb3VyY2VMYW5ndWFnZTpcIi5jb25jYXQocyxcIiB0YXJnZXRMYW5ndWFnZTpcIikuY29uY2F0KGEpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpnYSxyZXF1ZXN0RGF0YTp7c291cmNlVGV4dExpc3Q6byxzb3VyY2U6c3x8XCJhdXRvXCIsdGFyZ2V0OmEsZnJvbTp0aGlzLmdldE15VGlueUlEKCksU0RLQXBwSUQ6dGhpcy5nZXRTREtBcHBJRCgpfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBvPWUuZGF0YSxzPW8uZXJyb3IsYT1vLnJlcXVlc3RJRCxyPW8udHJhbnNsYXRlZFRleHRMaXN0O2lmKDA9PT1zLmNvZGUpcmV0dXJuIGkuZW5kKCksVmUuaShcIlwiLmNvbmNhdChuLFwiIG9rLiByZXF1ZXN0SUQ6XCIpLmNvbmNhdChhKSksWWEoe3RyYW5zbGF0ZWRUZXh0TGlzdDpyfSk7dGhyb3cgdCh0KHt9LHMpLHt9LHtyZXF1ZXN0SUQ6YX0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gaS5zZXRDb2RlKGUuY29kZSkuc2V0TW9yZU1lc3NhZ2UoZS5yZXF1ZXN0SUQpLmVuZCgpLFZlLncoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYSh7Y29kZTpoYS5UUkFOU0xBVEVfVEVYVF9GQUlMfSl9KSl9fSx7a2V5OlwibW9kaWZ5UmVtb3RlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1udWxsLG89ZS5jb252ZXJzYXRpb25UeXBlLHM9ZS50bztpZih0aGlzLmdldE1vZHVsZShQbikuaXNNZXNzYWdlRnJvbU9yVG9BVkNoYXRyb29tKHMpKXJldHVybiBaYSh7Y29kZTpoYS5NRVNTQUdFX01PRElGWV9ESVNBQkxFRF9JTl9BVkNIQVRST09NLGRhdGE6e21lc3NhZ2U6ZX19KTtpZighMT09PXRoaXMuZ2V0TW9kdWxlKG9vKS5maWx0ZXJNZXNzYWdlKGUpKXJldHVybiBaYSh7Y29kZTpoYS5QUk9GQU5JVFlfRk9VTkQsZGF0YTp7bWVzc2FnZTplfX0pO289PT1FLkNPTlZfQzJDP249dGhpcy5nZXRNb2R1bGUoVW4pOm89PT1FLkNPTlZfR1JPVVAmJihuPXRoaXMuZ2V0TW9kdWxlKFBuKSk7dmFyIGE9bmV3IEFhKFwibW9kaWZ5TWVzc2FnZVwiKTthLnNldE1lc3NhZ2UoXCJ0bzpcIi5jb25jYXQocykpO3ZhciBpPVwiXCIuY29uY2F0KHRoaXMuX24sXCIubW9kaWZ5UmVtb3RlTWVzc2FnZVwiKTtyZXR1cm4gbi5tb2RpZnlSZW1vdGVNZXNzYWdlKGUpLnRoZW4oKGZ1bmN0aW9uKG4pe2EuZW5kKCksVmUuaShcIlwiLmNvbmNhdChpLFwiIG9rXCIpKTt2YXIgbz10Ll9vbk1vZGlmeVJlbW90ZU1lc3NhZ2VSZXNwKGUsbi5kYXRhKTtyZXR1cm4gWWEoe21lc3NhZ2U6b30pfSkpLmNhdGNoKChmdW5jdGlvbihuKXtpZihhLnNldENvZGUobi5jb2RlKS5zZXRNb3JlTWVzc2FnZShuLm1lc3NhZ2UpLmVuZCgpLFZlLncoXCJcIi5jb25jYXQoaSxcIiBmYWlsZWQuIGVycm9yOlwiKSxuKSwyMDAyNz09PW4uY29kZSl7dmFyIG89dC5fb25Nb2RpZnlSZW1vdGVNZXNzYWdlUmVzcChlLG4uZGF0YSk7cmV0dXJuIFphKHtjb2RlOmhhLk1FU1NBR0VfTU9ESUZZX0NPTkZMSUNULGRhdGE6e21lc3NhZ2U6b319KX1yZXR1cm4gWmEoe2NvZGU6bi5jb2RlLG1lc3NhZ2U6bi5tZXNzYWdlLGRhdGE6e21lc3NhZ2U6ZX19KX0pKX19LHtrZXk6XCJfb25Nb2RpZnlSZW1vdGVNZXNzYWdlUmVzcFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7VmUuZChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vbk1vZGlmeVJlbW90ZU1lc3NhZ2VSZXNwIG9wdGlvbnM6XCIpLHQpO3ZhciBuPWUuY29udmVyc2F0aW9uVHlwZSxvPWUuZnJvbSxzPWUudG8sYT1lLnJhbmRvbSxpPWUuc2VxdWVuY2Uscj1lLnRpbWUsdT10LmVsZW1lbnRzLGM9dC5tZXNzYWdlVmVyc2lvbixsPXQuY2xvdWRDdXN0b21EYXRhLGQ9dm9pZCAwPT09bD9cIlwiOmw7cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKHFuKS5vbk1lc3NhZ2VNb2RpZmllZCh7Y29udmVyc2F0aW9uVHlwZTpuLGZyb206byx0bzpzLHRpbWU6cixyYW5kb206YSxzZXF1ZW5jZTppLGVsZW1lbnRzOnUsY2xvdWRDdXN0b21EYXRhOmQsbWVzc2FnZVZlcnNpb246Y30pfX0se2tleTpcIl9nZW5lcmF0ZVVVSURcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLmdldE1vZHVsZSh4biksbj1cIlwiLmNvbmNhdCh0LmdldFNES0FwcElEKCksXCItXCIpLmNvbmNhdCh0LmdldFVzZXJJRCgpLFwiLVwiKS5jb25jYXQoZnVuY3Rpb24oKXtmb3IodmFyIGU9XCJcIix0PTMyO3Q+MDstLXQpZSs9ZnRbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnZ0KV07cmV0dXJuIGV9KCkpLG89ZS5uYW1lfHxlLnZhbHVlfHxlLnVybHx8ZS50ZW1wRmlsZVBhdGgscz1vJiZvLnNsaWNlKG8ubGFzdEluZGV4T2YoXCIuXCIpKzEpO3JldHVybiBzJiYobj1cIlwiLmNvbmNhdChuLFwiLlwiKS5jb25jYXQocykpLG59fSx7a2V5OlwiZ2V0TWVzc2FnZU9wdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tZXNzYWdlT3B0aW9uc01hcC5nZXQoZSl9fSx7a2V5OlwiX2dldE5pY2tBbmRBdmF0YXJCeVVzZXJJRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldE1vZHVsZShHbikuZ2V0Tmlja0FuZEF2YXRhckJ5VXNlcklEKGUpfX0se2tleTpcIl9nZXROYW1lQ2FyZEJ5R3JvdXBJRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9HUk9VUCl7dmFyIHQ9dGhpcy5nZXRNb2R1bGUoUG4pO2lmKHQpcmV0dXJuIHQuZ2V0TXlOYW1lQ2FyZEJ5R3JvdXBJRChlLnRvKX1yZXR1cm5cIlwifX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX21lc3NhZ2VPcHRpb25zTWFwLmNsZWFyKCl9fV0pLHN9KHVvKSx5cj1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9uPVwiTWVzc2FnZUV4dGVuc2lvbk1vZHVsZVwiLHMubWVzc2FnZUV4dGVuc2lvbk1hcD1uZXcgTWFwLHMuZ2xvYmFsU2VxTWFwPW5ldyBNYXAscy5nZXRNZXNzYWdlRXh0ZW5zaW9uc01hcD1uZXcgTWFwLHN9cmV0dXJuIGEobixbe2tleTpcIm9uTWVzc2FnZUV4dGVuc2lvbk5vdGlmeVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLmRhdGFMaXN0LG89bi5tZXNzYWdlSW5mbyxzPW4ub3BlcmF0ZVR5cGUsYT1uLm9wZXJhdGVSZXN1bHRMaXN0LGk9bi50aW55SUQscj1uLmdsb2JhbFNlcXVlbmNlLHU9by5jbGllbnRUaW1lLGM9by5yYW5kb20sbD1cIlwiLmNvbmNhdChpLFwiLVwiKS5jb25jYXQodSxcIi1cIikuY29uY2F0KGMpLGQ9W10scD1bXTtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25NZXNzYWdlRXh0ZW5zaW9uTm90aWZ5IG1lc3NhZ2VJRDpcIikuY29uY2F0KGwsXCIgb3BlcmF0ZVR5cGU6XCIpLmNvbmNhdChzLFwiIGdsb2JhbFNlcXVlbmNlOlwiKS5jb25jYXQocikpLHRoaXMuX3VwZGF0ZUdsb2JhbFNlcXVlbmNlKGwscik7dmFyIGc9ITEsaD0hMTthLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBuPWUuZXh0ZW5zaW9ucyxvPXZvaWQgMD09PW4/W106bixhPWUuY2xlYXJTZXF1ZW5jZTtpZigxPT09cylnPSEwLG8uZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZC5wdXNoKHtrZXk6ZS5rZXksdmFsdWU6ZS52YWx1ZX0pfSkpLHQuX3VwZGF0ZUxvY2FsRXh0ZW5zaW9uKGwsbyk7ZWxzZSBpZigyPT09cyloPSEwLG8uZm9yRWFjaCgoZnVuY3Rpb24oZSl7cC5wdXNoKGUua2V5KX0pKSx0Ll91cGRhdGVMb2NhbEV4dGVuc2lvbihsLG8pO2Vsc2UgaWYoMz09PXMpe2lmKGg9ITAsdC5faGFzTG9jYWxFeHRlbnNpb24obCkpdC5fZ2V0TG9jYWxFeHRlbnNpb24obCkuZm9yRWFjaCgoZnVuY3Rpb24oZSx0KXtlLnNlcTw9YSYmIXp0KGUudmFsdWUpJiZwLnB1c2godCl9KSk7dC5fY2xlYXJMb2NhbEV4dGVuc2lvbihsLGEpfX0pKSxnJiZ0aGlzLmVtaXRPdXRlckV2ZW50KGsuTUVTU0FHRV9FWFRFTlNJT05TX1VQREFURUQse21lc3NhZ2VJRDpsLGV4dGVuc2lvbnM6ZH0pLGgmJnRoaXMuZW1pdE91dGVyRXZlbnQoay5NRVNTQUdFX0VYVEVOU0lPTlNfREVMRVRFRCx7bWVzc2FnZUlEOmwsa2V5TGlzdDpwfSl9fSx7a2V5Olwic2V0TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7aWYoIXRoaXMuY2FuSVVzZShCLk1TR19FWFQpKXJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfVVNFX0NPTU1FUkNJQUxfQUJJTElUWX0pO3ZhciBvPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuXCIpLmNvbmNhdChcInNldE1lc3NhZ2VFeHRlbnNpb25zXCIpLHM9ZS5JRCxhPWUuY29udmVyc2F0aW9uSUQsaT1lLnNlcXVlbmNlLHI9ZS50aW1lLHU9bSh0KTt0Lmxlbmd0aD4yMCYmKHU9dC5zbGljZSgwLDIwKSxWZS53KFwiXCIuY29uY2F0KG8sXCIuIHRoZSBsZW5ndGggb2YgZXh0ZW5zaW9ucyBjYW5ub3QgZXhjZWVkIDIwLlwiKSkpO3ZhciBjPVwiY29udmVyc2F0aW9uSUQ6XCIuY29uY2F0KGEsXCIgbWVzc2FnZUlEOlwiKS5jb25jYXQocyxcIiBzZXF1ZW5jZTpcIikuY29uY2F0KGksXCIgdGltZTpcIikuY29uY2F0KHIsXCIgY291bnQ6XCIpLmNvbmNhdCh1Lmxlbmd0aCksbD1uZXcgQWEoXCJzZXRNZXNzYWdlRXh0ZW5zaW9uc1wiKTtyZXR1cm4gbC5zZXRNZXNzYWdlKGMpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBcIikuY29uY2F0KGMpKSx0aGlzLl9tb2RpZnlNZXNzYWdlRXh0ZW5zaW9ucyhlLHUpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PWUucmVzdWx0TGlzdCxuPWUuc3VjY2Vzc0NvdW50LHM9ZS5mYWlsdXJlQ291bnQsYT1cInN1Y2Nlc3MgY291bnQ6XCIuY29uY2F0KG4sXCIgZmFpbCBjb3VudDpcIikuY29uY2F0KHMpO3JldHVybiBsLnNldE1vcmVNZXNzYWdlKGEpLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQobyxcIiBvay4gXCIpLmNvbmNhdChhKSksWWEoe2V4dGVuc2lvbnM6dH0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gbi5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtsLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG8sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiZ2V0TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzO2lmKCF0aGlzLmNhbklVc2UoQi5NU0dfRVhUKSlyZXR1cm4gWmEoe2NvZGU6aGEuQ0FOTk9UX1VTRV9DT01NRVJDSUFMX0FCSUxJVFl9KTt2YXIgbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLlwiKS5jb25jYXQoXCJnZXRNZXNzYWdlRXh0ZW5zaW9uc1wiKSxvPWUuSUQscz1lLmNvbnZlcnNhdGlvbklELGE9ZS5zZXF1ZW5jZSxpPWUudGltZSxyPVwiY29udmVyc2F0aW9uSUQ6XCIuY29uY2F0KHMsXCIgbWVzc2FnZUlEOlwiKS5jb25jYXQobyxcIiBzZXF1ZW5jZTpcIikuY29uY2F0KGEsXCIgdGltZTpcIikuY29uY2F0KGkpLHU9bmV3IEFhKFwiZ2V0TWVzc2FnZUV4dGVuc2lvbnNcIik7dS5zZXRNZXNzYWdlKHIpLFZlLmwoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KHIpKTt2YXIgYz12b2lkIDA7cmV0dXJuIHRoaXMuZ2V0TWVzc2FnZUV4dGVuc2lvbnNNYXAuaGFzKG8pJiYoYz10aGlzLl9nZXRHbG9iYWxTZXF1ZW5jZShvKSksdGhpcy5fZ2V0TWVzc2FnZUV4dGVuc2lvbnMoZSxjKS50aGVuKChmdW5jdGlvbihlKXtyZXR1cm4gdS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suIHRvdGFsIGNvdW50OlwiKS5jb25jYXQoZS5sZW5ndGgpKSxpdChjKSYmZS5sZW5ndGg+MCYmdC5nZXRNZXNzYWdlRXh0ZW5zaW9uc01hcC5zZXQobywxKSxZYSh7ZXh0ZW5zaW9uczplfSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiB0LnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO3Uuc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobixcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJkZWxldGVNZXNzYWdlRXh0ZW5zaW9uc1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcztpZighdGhpcy5jYW5JVXNlKEIuTVNHX0VYVCkpcmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9VU0VfQ09NTUVSQ0lBTF9BQklMSVRZfSk7dmFyIG89XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiZGVsZXRlTWVzc2FnZUV4dGVuc2lvbnNcIikscz1bXSxhPTM7enQodCl8fChhPTIsdC5mb3JFYWNoKChmdW5jdGlvbihlKXtzLnB1c2goe2tleTplLHZhbHVlOlwiXCIsc2VxOjB9KX0pKSk7dmFyIGk9ZS5JRCxyPWUuY29udmVyc2F0aW9uSUQsdT1lLnNlcXVlbmNlLGM9ZS50aW1lLGw9XCJjb252ZXJzYXRpb25JRDpcIi5jb25jYXQocixcIiBtZXNzYWdlSUQ6XCIpLmNvbmNhdChpLFwiIHNlcXVlbmNlOlwiKS5jb25jYXQodSxcIiB0aW1lOlwiKS5jb25jYXQoYyxcIiBvcGVyYXRlVHlwZTpcIikuY29uY2F0KGEpLGQ9bmV3IEFhKFwiZGVsZXRlTWVzc2FnZUV4dGVuc2lvbnNcIik7cmV0dXJuIGQuc2V0TWVzc2FnZShsKSxWZS5sKFwiXCIuY29uY2F0KG8sXCIgXCIpLmNvbmNhdChsKSksdGhpcy5fbW9kaWZ5TWVzc2FnZUV4dGVuc2lvbnMoZSxzLGEpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PWUucmVzdWx0TGlzdCxuPWUuc3VjY2Vzc0NvdW50LHM9ZS5mYWlsdXJlQ291bnQsaT1cIlwiO3JldHVybiAyPT09YSYmKGk9XCJzdWNjZXNzIGNvdW50OlwiLmNvbmNhdChuLFwiIGZhaWwgY291bnQ6XCIpLmNvbmNhdChzKSksZC5zZXRNb3JlTWVzc2FnZShcIlwiLmNvbmNhdChpKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChvLFwiIG9rLiBcIikuY29uY2F0KGkpKSxZYSh7ZXh0ZW5zaW9uczp0fSl9KSkuY2F0Y2goKGZ1bmN0aW9uKGUpe3JldHVybiBuLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKHQpe3ZhciBuPXYodCwyKSxvPW5bMF0scz1uWzFdO2Quc2V0RXJyb3IoZSxvLHMpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQobyxcIiBmYWlsZWQuIGVycm9yOlwiKSxlKSxaYShlKX0pKX19LHtrZXk6XCJfbW9kaWZ5TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMsbz1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06MSxzPWt0KGUudG8pP0UuQ09OVl9UT1BJQzplLmNvbnZlcnNhdGlvblR5cGUsYT12b2lkIDA7MyE9PW8mJihhPXRoaXMuX2dldFJlcXVlc3RFeHRlbnNpb25zKGUsdCkpO3ZhciBpPW51bGw7c3dpdGNoKHMpe2Nhc2UgRS5DT05WX0MyQzppPXRoaXMuZ2V0TW9kdWxlKFVuKTticmVhaztjYXNlIEUuQ09OVl9HUk9VUDppPXRoaXMuZ2V0TW9kdWxlKFBuKTticmVhaztjYXNlIEUuQ09OVl9UT1BJQzppPXRoaXMuZ2V0TW9kdWxlKEZuKTticmVhaztkZWZhdWx0OnJldHVybiBaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX1yZXR1cm4gaS5tb2RpZnlNZXNzYWdlRXh0ZW5zaW9ucyhlLGEsbykudGhlbigoZnVuY3Rpb24odCl7dmFyIG89dC5kYXRhLHM9by5leHRlbnNpb25zLGE9by5zZXEsaT1bXSxyPTAsdT0wLGM9W107cmV0dXJuKHM9enQocyk/W106cykuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5lcnJvckNvZGUsbj1lLmV4dGVuc2lvbixvPW4ua2V5LHM9bi52YWx1ZSxhPW4uc2VxO2kucHVzaCh7Y29kZTp0LGtleTpvLHZhbHVlOnN9KSwwPT09dD9yKys6dSsrLGMucHVzaCh7a2V5Om8sdmFsdWU6cyxzZXE6YX0pfSkpLG4uX3VwZGF0ZUdsb2JhbFNlcXVlbmNlKGUuSUQsYSksYy5sZW5ndGg+MCYmKG4uX3VwZGF0ZUxvY2FsRXh0ZW5zaW9uKGUuSUQsYyksYz1udWxsKSx7cmVzdWx0TGlzdDppLHN1Y2Nlc3NDb3VudDpyLGZhaWx1cmVDb3VudDp1fX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7cmV0dXJuIFphKGUpfSkpfX0se2tleTpcIl9nZXRSZXF1ZXN0RXh0ZW5zaW9uc1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49W107aWYodGhpcy5faGFzTG9jYWxFeHRlbnNpb24oZS5JRCkpe3ZhciBvPXRoaXMuX2dldExvY2FsRXh0ZW5zaW9uKGUuSUQpO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUua2V5LHM9ZS52YWx1ZSxhPTA7by5oYXModCkmJihhPW8uZ2V0KHQpLnNlcSksbi5wdXNoKHtrZXk6dCx2YWx1ZTpzLHNlcTphfSl9KSksbn1yZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1lLmtleSxvPWUudmFsdWU7bi5wdXNoKHtrZXk6dCx2YWx1ZTpvLHNlcTowfSl9KSksbn19LHtrZXk6XCJfZ2V0TWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMsbz1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9nZXRNZXNzYWdlRXh0ZW5zaW9uc1wiKSxzPWUuSUQsYT1lLnRvLGk9bnVsbDtzd2l0Y2goa3QoYSk/RS5DT05WX1RPUElDOmUuY29udmVyc2F0aW9uVHlwZSl7Y2FzZSBFLkNPTlZfQzJDOmk9dGhpcy5nZXRNb2R1bGUoVW4pO2JyZWFrO2Nhc2UgRS5DT05WX0dST1VQOmk9dGhpcy5nZXRNb2R1bGUoUG4pO2JyZWFrO2Nhc2UgRS5DT05WX1RPUElDOmk9dGhpcy5nZXRNb2R1bGUoRm4pO2JyZWFrO2RlZmF1bHQ6cmV0dXJuIFphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX01PRFVMRX0pfXJldHVybiBpLmdldE1lc3NhZ2VFeHRlbnNpb25zKGUsdCkudGhlbigoZnVuY3Rpb24odCl7dmFyIGE9dC5kYXRhLGk9YS5leHRlbnNpb25zLHI9YS5jb21wbGV0ZUZsYWcsdT1hLmdsb2JhbFNlcXVlbmNlLGM9YS5jbGVhclNlcXVlbmNlO2lmKGk9enQoaSk/W106aSxWZS5sKFwiXCIuY29uY2F0KG8sXCIgb2suIGNvbXBsZXRlRmxhZzpcIikuY29uY2F0KHIsXCIgZ2xvYmFsU2VxdWVuY2U6XCIpLmNvbmNhdCh1LFwiIGNsZWFyU2VxdWVuY2U6XCIpLmNvbmNhdChjLFwiIGNvdW50OlwiKS5jb25jYXQoaS5sZW5ndGgpKSxuLl91cGRhdGVMb2NhbEV4dGVuc2lvbihzLGkpLG4uX2NsZWFyTG9jYWxFeHRlbnNpb24ocyxjKSxuLl91cGRhdGVHbG9iYWxTZXF1ZW5jZShzLHUpLDEhPT1yKXt2YXIgbD1pLnNsaWNlKC0xKVswXS5zZXErMTtyZXR1cm4gbi5fZ2V0TWVzc2FnZUV4dGVuc2lvbnMoZSxsKX1yZXR1cm4gbi5fZ2V0TG9jYWxFeHRlbnNpb25zKHMpfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gWmEoZSl9KSl9fSx7a2V5OlwiX2hhc0xvY2FsRXh0ZW5zaW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubWVzc2FnZUV4dGVuc2lvbk1hcC5oYXMoZSl9fSx7a2V5OlwiX2dldExvY2FsRXh0ZW5zaW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubWVzc2FnZUV4dGVuc2lvbk1hcC5nZXQoZSl9fSx7a2V5OlwiX3VwZGF0ZUxvY2FsRXh0ZW5zaW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9oYXNMb2NhbEV4dGVuc2lvbihlKXx8dGhpcy5tZXNzYWdlRXh0ZW5zaW9uTWFwLnNldChlLG5ldyBNYXApO3ZhciBuPXRoaXMuX2dldExvY2FsRXh0ZW5zaW9uKGUpO3QuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5rZXksbz1lLnZhbHVlLHM9dm9pZCAwPT09bz9cIlwiOm8sYT1lLnNlcTtuLnNldCh0LHt2YWx1ZTpzLHNlcTphfSl9KSl9fSx7a2V5OlwiX2NsZWFyTG9jYWxFeHRlbnNpb25cIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKCEodDw9MCkmJnRoaXMuX2hhc0xvY2FsRXh0ZW5zaW9uKGUpKXt2YXIgbj10aGlzLl9nZXRMb2NhbEV4dGVuc2lvbihlKTtuLmZvckVhY2goKGZ1bmN0aW9uKGUsbyl7ZS5zZXE8PXQmJm4uZGVsZXRlKG8pfSkpfX19LHtrZXk6XCJfZ2V0TG9jYWxFeHRlbnNpb25zXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9W107dGhpcy5faGFzTG9jYWxFeHRlbnNpb24oZSkmJnRoaXMuX2dldExvY2FsRXh0ZW5zaW9uKGUpLmZvckVhY2goKGZ1bmN0aW9uKGUsbil7dmFyIG89ZS52YWx1ZTt6dChvKXx8dC5wdXNoKHtrZXk6bix2YWx1ZTpvfSl9KSk7cmV0dXJuIHR9fSx7a2V5OlwiX2dldEdsb2JhbFNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZ2xvYmFsU2VxTWFwLmdldChlKX19LHtrZXk6XCJfdXBkYXRlR2xvYmFsU2VxdWVuY2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuZ2xvYmFsU2VxTWFwLnNldChlLHQpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMubWVzc2FnZUV4dGVuc2lvbk1hcC5jbGVhcigpLHRoaXMuZ2xvYmFsU2VxTWFwLmNsZWFyKCksdGhpcy5nZXRNZXNzYWdlRXh0ZW5zaW9uc01hcC5jbGVhcigpfX1dKSxufSh1byksSXI9ZnVuY3Rpb24oZSl7cihuLGUpO3ZhciB0PWYobik7ZnVuY3Rpb24gbihlKXt2YXIgcztyZXR1cm4gbyh0aGlzLG4pLChzPXQuY2FsbCh0aGlzLGUpKS5fbj1cIkNvbWJvTWVzc2FnZU1vZHVsZVwiLHN9cmV0dXJuIGEobixbe2tleTpcInNlbmRNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPXRoaXMuX2NvbnN0cnVjdE1lc3NhZ2VJbnN0YW5jZShlKTtpZihudWxsPT09bilyZXR1cm4gWmEoe2NvZGU6aGEuTUVTU0FHRV9TRU5EX0ZBSUx9KTt0aGlzLl9hZGRTZW5kTWVzc2FnZVRvdGFsQ291bnQobik7dmFyIG89RGF0ZS5ub3coKTtyZXR1cm4gdGhpcy5nZXRNb2R1bGUocW4pLnNldE1lc3NhZ2VSYW5kb20obiksdGhpcy5fc2VuZENvbWJvTWVzc2FnZShuLGUpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBzPWUuZGF0YSxhPXMudGltZSxpPXMuc2VxdWVuY2Uscj1zLnJlYWRSZWNlaXB0Q29kZTtldChyKSYmMCE9PXImJihuZXcgQWEoXCJzZW5kTWVzc2FnZVdpdGhSZWNlaXB0XCIpLnNldE1lc3NhZ2UoXCJmcm9tOlwiLmNvbmNhdChuLmZyb20sXCIgdG86XCIpLmNvbmNhdChuLnRvLFwiIHNlcXVlbmNlOlwiKS5jb25jYXQoaSxcIiByZWFkUmVjZWlwdENvZGU6XCIpLmNvbmNhdChyKSkuZW5kKCksVmUudyhcIlwiLmNvbmNhdCh0Ll9uLFwiLnNlbmRNZXNzYWdlIHJlYWRSZWNlaXB0Q29kZTpcIikuY29uY2F0KHIsXCIgbWVzc2FnZTpcIikuY29uY2F0KHQuZ2V0RXJyb3JNZXNzYWdlKHIpKSkpO3QuX2FkZFNlbmRNZXNzYWdlU3VjY2Vzc0NvdW50KG4sbyk7dmFyIHU9dC5nZXRNb2R1bGUocW4pO24uc3RhdHVzPVF0LlNVQ0NFU1Msbi50aW1lPWEsbi5jb252ZXJzYXRpb25UeXBlPT09RS5DT05WX0dST1VQJiYobi5zZXF1ZW5jZT1pKSx1LmFwcGVuZFRvTWVzc2FnZUxpc3Qobik7dmFyIGM9bjtyZXR1cm4hMD09PW4uX2lzRXhjbHVkZWRGcm9tTGFzdE1lc3NhZ2UmJihjPVwiXCIpLHUub25NZXNzYWdlU2VudCh7Y29udmVyc2F0aW9uT3B0aW9uc0xpc3Q6W3tjb252ZXJzYXRpb25JRDpuLmNvbnZlcnNhdGlvbklELHVucmVhZENvdW50OjAsdHlwZTpuLmNvbnZlcnNhdGlvblR5cGUsc3ViVHlwZTpuLmNvbnZlcnNhdGlvblN1YlR5cGUsbGFzdE1lc3NhZ2U6Y31dfSksWWEoe21lc3NhZ2U6bn0pfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5fb25TZW5kTWVzc2FnZUZhaWxlZChuLGUpfSkpfX0se2tleTpcIl9zZW5kQ29tYm9NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLl9tLmdldE1vZHVsZSh6biksbz1cIlwiO3JldHVybiBlLmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfQzJDJiYobz1cIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELlNFTkRfTUVTU0FHRSkpLGUuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9HUk9VUCYmKG89XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuU0VORF9HUk9VUF9NRVNTQUdFKSksbi5zZW5kQ29tYm9NZXNzYWdlKHtzZXJ2Y21kOm8sZGF0YTp0fSl9fSx7a2V5OlwiX2NvbnN0cnVjdE1lc3NhZ2VJbnN0YW5jZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2NvbnN0cnVjdE1lc3NhZ2VJbnN0YW5jZVwiKSxuPW51bGw7dHJ5e3ZhciBvPXRoaXMuZ2V0TXlVc2VySUQoKSxzPXt9O2lmKHMuc2VuZGVyVGlueUlEPXRoaXMuZ2V0TXlUaW55SUQoKSxzLmN1cnJlbnRVc2VyPW8scy5mcm9tPWUuRnJvbV9BY2NvdW50fHxvLGUuR3JvdXBJZD8ocy5jb252ZXJzYXRpb25JRD1cIlwiLmNvbmNhdChFLkNPTlZfR1JPVVApLmNvbmNhdChlLkdyb3VwSWQpLHMuY29udmVyc2F0aW9uVHlwZT1FLkNPTlZfR1JPVVAscy50bz1lLkdyb3VwSWQpOmUuVG9fQWNjb3VudCYmKHMuY29udmVyc2F0aW9uSUQ9XCJcIi5jb25jYXQoRS5DT05WX0MyQykuY29uY2F0KGUuVG9fQWNjb3VudCkscy5jb252ZXJzYXRpb25UeXBlPUUuQ09OVl9DMkMscy50bz1lLlRvX0FjY291bnQpLHMudGltZT1lLk1zZ1RpbWVTdGFtcHx8MCxzLnJhbmRvbT1lLlJhbmRvbXx8ZS5Nc2dSYW5kb218fDAscy5wcmlvcml0eT1lLk1zZ1ByaW9yaXR5LG50KGUuQ2xvdWRDdXN0b21EYXRhKSYmZS5DbG91ZEN1c3RvbURhdGEubGVuZ3RoPjAmJihzLmNsb3VkQ3VzdG9tRGF0YT1lLkNsb3VkQ3VzdG9tRGF0YSksYXQoZS5TZW5kTXNnQ29udHJvbCkmJihzLm1lc3NhZ2VDb250cm9sSW5mbz17fSxlLlNlbmRNc2dDb250cm9sLmluY2x1ZGVzKFwiTm9VbnJlYWRcIikmJihzLm1lc3NhZ2VDb250cm9sSW5mby5leGNsdWRlZEZyb21VbnJlYWRDb3VudD0xKSxlLlNlbmRNc2dDb250cm9sLmluY2x1ZGVzKFwiTm9MYXN0TXNnXCIpJiYocy5tZXNzYWdlQ29udHJvbEluZm8uZXhjbHVkZWRGcm9tTGFzdE1lc3NhZ2U9MSkpLHMuY29udmVyc2F0aW9uVHlwZT09PUUuQ09OVl9HUk9VUCYmYXQoZS5Ub19BY2NvdW50KSYmZS5Ub19BY2NvdW50Lmxlbmd0aD4wKXt2YXIgYT1lLlRvX0FjY291bnQ7ZS5Ub19BY2NvdW50Lmxlbmd0aD41MCYmKGE9ZS5Ub19BY2NvdW50LnNsaWNlKDAsNTApLFZlLncoXCJcIi5jb25jYXQodCxcIiBUb19BY2NvdW50IG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIDUwLlwiKSkpLHMucmVjZWl2ZXJMaXN0PW0oYSksZS5Ub19BY2NvdW50PW0oYSl9MSE9PWUuSXNOZWVkUmVhZFJlY2VpcHQmJjEhPT1lLk5lZWRSZWFkUmVjZWlwdHx8KHMubmVlZFJlYWRSZWNlaXB0PSEwKSwxPT09ZS5TdXBwb3J0TWVzc2FnZUV4dGVuc2lvbiYmKHMuaXNTdXBwb3J0RXh0ZW5zaW9uPSEwKSwobj1uZXcgV2EocykpLnN0YXR1cz1RdC5VTlNFTkQsZS5Nc2dDbGllbnRUaW1lPW4uY2xpZW50VGltZSxuLmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfQzJDJiYoZS5Nc2dTZXE9bi5zZXF1ZW5jZSk7Zm9yKHZhciBpLHI9ZS5Nc2dCb2R5Lmxlbmd0aCx1PTA7dTxyO3UrKylcIlRJTVRleHRFbGVtXCI9PT0oaT1lLk1zZ0JvZHlbdV0pLk1zZ1R5cGU/bi5zZXRUZXh0RWxlbWVudChpLk1zZ0NvbnRlbnQuVGV4dCk6XCJUSU1DdXN0b21FbGVtXCI9PT1pLk1zZ1R5cGU/bi5zZXRDdXN0b21FbGVtZW50KHtkYXRhOmkuTXNnQ29udGVudC5EYXRhfHxcIlwiLGRlc2NyaXB0aW9uOmkuTXNnQ29udGVudC5EZXNjfHxcIlwiLGV4dGVuc2lvbjppLk1zZ0NvbnRlbnQuRXh0fHxcIlwifSk6XCJUSU1GYWNlRWxlbVwiPT09aS5Nc2dUeXBlJiZuLnNldEZhY2VFbGVtZW50KHtpbmRleDppLk1zZ0NvbnRlbnQuSW5kZXgsZGF0YTppLk1zZ0NvbnRlbnQuRGF0YX0pO3ZhciBjPW4uZ2V0RWxlbWVudHMoKTtuLnBheWxvYWQ9Y1swXS5jb250ZW50LG4udHlwZT1jWzBdLnR5cGV9Y2F0Y2gobCl7bj1udWxsLFZlLmUoXCJcIi5jb25jYXQodCxcIiBmYWlsZWQuIGVycm9yOlwiKSxsKX1yZXR1cm4gbn19LHtrZXk6XCJfb25TZW5kTWVzc2FnZUZhaWxlZFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7ZS5zdGF0dXM9UXQuRkFJTCx0aGlzLmdldE1vZHVsZShxbikuZGVsZXRlTWVzc2FnZVJhbmRvbShlKSx0aGlzLl9hZGRTZW5kTWVzc2FnZUZhaWxDb3VudE9uVXNlcihlLHQpO3ZhciBuPW5ldyBBYShcInNlbmRNZXNzYWdlXCIpO3JldHVybiBuLnNldE1lc3NhZ2UoXCJ0amdfaWQ6XCIuY29uY2F0KHRoaXMuZ2VuZXJhdGVUamdJRChlKSxcIiB0eXBlOlwiKS5jb25jYXQoZS50eXBlLFwiIGZyb206XCIpLmNvbmNhdChlLmZyb20sXCIgdG86XCIpLmNvbmNhdChlLnRvKSksdGhpcy5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbihlKXt2YXIgbz12KGUsMikscz1vWzBdLGE9b1sxXTtuLnNldEVycm9yKHQscyxhKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uU2VuZE1lc3NhZ2VGYWlsZWQgZXJyb3I6XCIpLHQpLFphKG5ldyBqYSh7Y29kZTp0JiZ0LmNvZGU/dC5jb2RlOmhhLk1FU1NBR0VfU0VORF9GQUlMLG1lc3NhZ2U6dCYmdC5tZXNzYWdlP3QubWVzc2FnZTp2b2lkIDAsZGF0YTp7bWVzc2FnZTplfX0pKX19LHtrZXk6XCJfZ2V0U2VuZE1lc3NhZ2VTcGVjaWZpZWRLZXlcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihlLmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfQzJDKXJldHVybiB2YTtpZihlLmNvbnZlcnNhdGlvblR5cGU9PT1FLkNPTlZfR1JPVVApe3ZhciB0PXRoaXMuZ2V0TW9kdWxlKFBuKS5nZXRMb2NhbEdyb3VwUHJvZmlsZShlLnRvKTtpZighdClyZXR1cm47dmFyIG49dC50eXBlO3JldHVybiBUdChuKT9NYTptYX19fSx7a2V5OlwiX2FkZFNlbmRNZXNzYWdlVG90YWxDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dldFNlbmRNZXNzYWdlU3BlY2lmaWVkS2V5KGUpO3QmJnRoaXMuZ2V0TW9kdWxlKGVvKS5hZGRUb3RhbENvdW50KHQpfX0se2tleTpcIl9hZGRTZW5kTWVzc2FnZVN1Y2Nlc3NDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49TWF0aC5hYnMoRGF0ZS5ub3coKS10KSxvPXRoaXMuX2dldFNlbmRNZXNzYWdlU3BlY2lmaWVkS2V5KGUpO2lmKG8pe3ZhciBzPXRoaXMuZ2V0TW9kdWxlKGVvKTtzLmFkZFN1Y2Nlc3NDb3VudChvKSxzLmFkZENvc3QobyxuKX19fSx7a2V5OlwiX2FkZFNlbmRNZXNzYWdlRmFpbENvdW50T25Vc2VyXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj10LmNvZGUsbz12b2lkIDA9PT1uPy0xOm4scz10aGlzLmdldE1vZHVsZShlbyksYT10aGlzLl9nZXRTZW5kTWVzc2FnZVNwZWNpZmllZEtleShlKTttcihvKSYmYSYmcy5hZGRGYWlsZWRDb3VudE9mVXNlclNpZGUoYSl9fV0pLG59KHVvKSxDcj1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9uPVwiUGx1Z2luTW9kdWxlXCIscy5wbHVnaW5zPXt9LHN9cmV0dXJuIGEobixbe2tleTpcInJlZ2lzdGVyUGx1Z2luXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihuKXt0LnBsdWdpbnNbbl09ZVtuXX0pKSxuZXcgQWEoXCJyZWdpc3RlclBsdWdpblwiKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KE9iamVjdC5rZXlzKGUpKSkuZW5kKCl9fSx7a2V5OlwiZ2V0UGx1Z2luXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucGx1Z2luc1tlXX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7fX1dKSxufSh1byksVHI9ZnVuY3Rpb24oZSl7cihzLGUpO3ZhciBuPWYocyk7ZnVuY3Rpb24gcyhlKXt2YXIgdDtyZXR1cm4gbyh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIlN5bmNVbnJlYWRNZXNzYWdlTW9kdWxlXCIsdC5fY29va2llPVwiXCIsdC5fb25saW5lU3luY0ZsYWc9ITEsdC5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpLm9uKGVpLHQuX29uTG9naW5TdWNjZXNzLGgodCkpLHR9cmV0dXJuIGEocyxbe2tleTpcIl9vbkxvZ2luU3VjY2Vzc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX3N0YXJ0U3luYyh7Y29va2llOnRoaXMuX2Nvb2tpZSxzeW5jRmxhZzowLGlzT25saW5lU3luYzowfSl9fSx7a2V5OlwiX3N0YXJ0U3luY1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMsbz1lLmNvb2tpZSxzPWUuc3luY0ZsYWcsYT1lLmlzT25saW5lU3luYyxpPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3N0YXJ0U3luY1wiKTtWZS5sKFwiXCIuY29uY2F0KGksXCIgY29va2llOlwiKS5jb25jYXQobyxcIiBzeW5jRmxhZzpcIikuY29uY2F0KHMsXCIgaXNPbmxpbmVTeW5jOlwiKS5jb25jYXQoYSkpLHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOmhvLHJlcXVlc3REYXRhOntjb29raWU6byxzeW5jRmxhZzpzLGlzT25saW5lU3luYzphfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBvPWUuZGF0YSxzPW8uY29va2llLGE9by5zeW5jRmxhZztuLl9jb29raWU9cyx6dChzKXx8KDA9PT1hfHwxPT09YT8obi5fZGlzcGF0Y2hVbnJlYWRNZXNzYWdlKHQodCh7fSxlLmRhdGEpLHt9LHtpc1N5bmNpbmdFbmRlZDohMX0pKSxuLl9zdGFydFN5bmMoe2Nvb2tpZTpzLHN5bmNGbGFnOmEsaXNPbmxpbmVTeW5jOjB9KSk6Mj09PWEmJm4uX2Rpc3BhdGNoVW5yZWFkTWVzc2FnZSh0KHQoe30sZS5kYXRhKSx7fSx7aXNTeW5jaW5nRW5kZWQ6ITB9KSkpfSkpLmNhdGNoKChmdW5jdGlvbihlKXtWZS5lKFwiXCIuY29uY2F0KGksXCIgZmFpbGVkLiBlcnJvcjpcIiksZSl9KSl9fSx7a2V5OlwiX2Rpc3BhdGNoVW5yZWFkTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UuZXZlbnRBcnJheSYmdGhpcy5nZXRNb2R1bGUoem4pLm9uTWVzc2FnZSh7aGVhZDp7fSxib2R5OntldmVudEFycmF5OmUuZXZlbnRBcnJheSxpc0luc3RhbnRNZXNzYWdlOnRoaXMuX29ubGluZVN5bmNGbGFnLGlzU3luY2luZ0VuZGVkOmUuaXNTeW5jaW5nRW5kZWR9fSk7dGhpcy5nZXRNb2R1bGUoVW4pLm9uTmV3QzJDTWVzc2FnZSh7ZGF0YUxpc3Q6ZS5tZXNzYWdlTGlzdCxpc0luc3RhbnRNZXNzYWdlOiEhZS5pc1N5bmNpbmdFbmRlZCYmdGhpcy5fb25saW5lU3luY0ZsYWcsQzJDUmVtYWluaW5nVW5yZWFkTGlzdDplLkMyQ1JlbWFpbmluZ1VucmVhZExpc3QsQzJDUGFpclVucmVhZExpc3Q6ZS5DMkNQYWlyVW5yZWFkTGlzdH0pfX0se2tleTpcInN0YXJ0T25saW5lU3luY1wiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnN0YXJ0T25saW5lU3luY1wiKSksdGhpcy5fb25saW5lU3luY0ZsYWc9ITAsdGhpcy5fc3RhcnRTeW5jKHtjb29raWU6dGhpcy5fY29va2llLHN5bmNGbGFnOjAsaXNPbmxpbmVTeW5jOjF9KX19LHtrZXk6XCJzdGFydFN5bmNPblJlY29ubmVjdGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuc3RhcnRTeW5jT25SZWNvbm5lY3RlZC5cIikpLHRoaXMuX29ubGluZVN5bmNGbGFnPSEwLHRoaXMuX3N0YXJ0U3luYyh7Y29va2llOnRoaXMuX2Nvb2tpZSxzeW5jRmxhZzowLGlzT25saW5lU3luYzowfSl9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSksdGhpcy5fb25saW5lU3luY0ZsYWc9ITEsdGhpcy5fY29va2llPVwiXCJ9fV0pLHN9KHVvKSxEcj17cmVxdWVzdDp7dG9BY2NvdW50OlwiVG9fQWNjb3VudFwiLGZyb21BY2NvdW50OlwiRnJvbV9BY2NvdW50XCIsdG86XCJUb19BY2NvdW50XCIsZnJvbTpcIkZyb21fQWNjb3VudFwiLGdyb3VwSUQ6XCJHcm91cElkXCIsZ3JvdXBBdFVzZXJJRDpcIkdyb3VwQXRfQWNjb3VudFwiLGV4dGVuc2lvbjpcIkV4dFwiLGRhdGE6XCJEYXRhXCIsZGVzY3JpcHRpb246XCJEZXNjXCIsZWxlbWVudHM6XCJNc2dCb2R5XCIsc2l6ZVR5cGU6XCJUeXBlXCIsZG93bmxvYWRGbGFnOlwiRG93bmxvYWRfRmxhZ1wiLHRodW1iVVVJRDpcIlRodW1iVVVJRFwiLHZpZGVvVVVJRDpcIlZpZGVvVVVJRFwiLHJlbW90ZUF1ZGlvVXJsOlwiVXJsXCIscmVtb3RlVmlkZW9Vcmw6XCJWaWRlb1VybFwiLHZpZGVvVXJsOlwiXCIsaW1hZ2VVcmw6XCJVUkxcIixmaWxlVXJsOlwiVXJsXCIsdXVpZDpcIlVVSURcIixwcmlvcml0eTpcIk1zZ1ByaW9yaXR5XCIscmVjZWl2ZXJVc2VySUQ6XCJUb19BY2NvdW50XCIscmVjZWl2ZXJHcm91cElEOlwiR3JvdXBJZFwiLG1lc3NhZ2VTZW5kZXI6XCJTZW5kZXJJZFwiLG1lc3NhZ2VSZWNlaXZlcjpcIlJlY2VpdmVySWRcIixuaWNrOlwiRnJvbV9BY2NvdW50Tmlja1wiLGF2YXRhcjpcIkZyb21fQWNjb3VudEhlYWR1cmxcIixtZXNzYWdlTnVtYmVyOlwiTXNnTnVtXCIscGJEb3dubG9hZEtleTpcIlBiTXNnS2V5XCIsZG93bmxvYWRLZXk6XCJKc29uTXNnS2V5XCIsYXBwbGljYXRpb25UeXBlOlwiUGVuZGVuY3lUeXBlXCIsdXNlcklETGlzdDpcIlRvX0FjY291bnRcIixncm91cE5hbWVMaXN0OlwiR3JvdXBOYW1lXCIsdXNlcklEOlwiVG9fQWNjb3VudFwiLGdyb3VwQXR0cmlidXRlTGlzdDpcIkdyb3VwQXR0clwiLG1haW5TZXF1ZW5jZTpcIkF0dHJNYWluU2VxXCIsYXZDaGF0Um9vbUtleTpcIkJ5dGVzS2V5XCIsYXR0cmlidXRlQ29udHJvbDpcIkF0dHJDb250cm9sXCIsc2VxdWVuY2U6XCJzZXFcIixtZXNzYWdlQ29udHJvbEluZm86XCJTZW5kTXNnQ29udHJvbFwiLHVwZGF0ZVNlcXVlbmNlOlwiVXBkYXRlU2VxXCIsY2xpZW50VGltZTpcIk1zZ0NsaWVudFRpbWVcIixzZXF1ZW5jZUxpc3Q6XCJNc2dTZXFMaXN0XCIsdG9waWNJRDpcIlRvcGljSWRcIixjdXN0b21EYXRhOlwiQ3VzdG9tU3RyaW5nXCIsaXNTdXBwb3J0VG9waWM6XCJTdXBwb3J0VG9waWNcIixpc1dlYlVuaWFwcDpcImlzX3dlYl91bmlhcHBcIixpc1N1cHBvcnRFeHRlbnNpb246XCJTdXBwb3J0TWVzc2FnZUV4dGVuc2lvblwiLG1lc3NhZ2VTZXF1ZW5jZTpcIk1zZ1NlcVwiLG1lc3NhZ2VLZXk6XCJNc2dLZXlcIixzdGFydFNlcXVlbmNlOlwic3RhcnRTZXFcIixzaW1wbGlmaWVkTWVzc2FnZTpcIkRvd25zaXplRmxhZ1wifSxyZXNwb25zZTp7TXNnUHJpb3JpdHk6XCJwcmlvcml0eVwiLFRodW1iVVVJRDpcInRodW1iVVVJRFwiLFZpZGVvVVVJRDpcInZpZGVvVVVJRFwiLERvd25sb2FkX0ZsYWc6XCJkb3dubG9hZEZsYWdcIixHcm91cElkOlwiZ3JvdXBJRFwiLE1lbWJlcl9BY2NvdW50OlwidXNlcklEXCIsTXNnTGlzdDpcIm1lc3NhZ2VMaXN0XCIsU3luY0ZsYWc6XCJzeW5jRmxhZ1wiLFRvX0FjY291bnQ6XCJ0b1wiLEZyb21fQWNjb3VudDpcImZyb21cIixNc2dTZXE6XCJzZXF1ZW5jZVwiLE1zZ1JhbmRvbTpcInJhbmRvbVwiLE1zZ1RpbWU6XCJ0aW1lXCIsTXNnVGltZVN0YW1wOlwidGltZVwiLE1zZ0NvbnRlbnQ6XCJjb250ZW50XCIsTXNnQm9keTpcImVsZW1lbnRzXCIsRnJvbV9BY2NvdW50TmljazpcIm5pY2tcIixGcm9tX0FjY291bnRIZWFkdXJsOlwiYXZhdGFyXCIsR3JvdXBXaXRoZHJhd0luZm9BcnJheTpcInJldm9rZWRJbmZvc1wiLEdyb3VwUmVhZEluZm9BcnJheTpcImdyb3VwTWVzc2FnZVJlYWROb3RpY2VcIixMYXN0UmVhZE1zZ1NlcTpcImxhc3RNZXNzYWdlU2VxXCIsV2l0aGRyYXdDMmNNc2dOb3RpZnk6XCJjMmNNZXNzYWdlUmV2b2tlZE5vdGlmeVwiLEMyY1dpdGhkcmF3SW5mb0FycmF5OlwicmV2b2tlZEluZm9zXCIsQzJjUmVhZGVkUmVjZWlwdDpcImMyY01lc3NhZ2VSZWFkUmVjZWlwdFwiLFJlYWRDMmNNc2dOb3RpZnk6XCJjMmNNZXNzYWdlUmVhZE5vdGljZVwiLExhc3RSZWFkVGltZTpcInBlZXJSZWFkVGltZVwiLE1zZ1JhbmQ6XCJyYW5kb21cIixNc2dUeXBlOlwidHlwZVwiLE1zZ1Nob3c6XCJtZXNzYWdlU2hvd1wiLE5leHRNc2dTZXE6XCJuZXh0TWVzc2FnZVNlcVwiLEZhY2VVcmw6XCJhdmF0YXJcIixQcm9maWxlRGF0YU1vZDpcInByb2ZpbGVNb2RpZnlcIixQcm9maWxlX0FjY291bnQ6XCJ1c2VySURcIixWYWx1ZUJ5dGVzOlwidmFsdWVcIixWYWx1ZU51bTpcInZhbHVlXCIsTm90aWNlU2VxOlwibm90aWNlU2VxdWVuY2VcIixOb3RpZnlTZXE6XCJub3RpZnlTZXF1ZW5jZVwiLE1zZ0Zyb21fQWNjb3VudEV4dHJhSW5mbzpcIm1lc3NhZ2VGcm9tQWNjb3VudEV4dHJhSW5mb3JtYXRpb25cIixPcGVyYXRvcl9BY2NvdW50Olwib3BlcmF0b3JJRFwiLE9wVHlwZTpcIm9wZXJhdGlvblR5cGVcIixSZXBvcnRUeXBlOlwib3BlcmF0aW9uVHlwZVwiLFVzZXJJZDpcInVzZXJJRFwiLFVzZXJfQWNjb3VudDpcInVzZXJJRFwiLExpc3RfQWNjb3VudDpcInVzZXJJRExpc3RcIixNc2dPcGVyYXRvck1lbWJlckV4dHJhSW5mbzpcIm9wZXJhdG9ySW5mb1wiLE1zZ01lbWJlckV4dHJhSW5mbzpcIm1lbWJlckluZm9MaXN0XCIsSW1hZ2VVcmw6XCJhdmF0YXJcIixOaWNrTmFtZTpcIm5pY2tcIixNc2dHcm91cE5ld0luZm86XCJuZXdHcm91cFByb2ZpbGVcIixNc2dBcHBEZWZpbmVkRGF0YTpcImdyb3VwQ3VzdG9tRmllbGRcIixPd25lcl9BY2NvdW50Olwib3duZXJJRFwiLEdyb3VwRmFjZVVybDpcImF2YXRhclwiLEdyb3VwSW50cm9kdWN0aW9uOlwiaW50cm9kdWN0aW9uXCIsR3JvdXBOb3RpZmljYXRpb246XCJub3RpZmljYXRpb25cIixHcm91cEFwcGx5Sm9pbk9wdGlvbjpcImpvaW5PcHRpb25cIixNc2dLZXk6XCJtZXNzYWdlS2V5XCIsR3JvdXBJbmZvOlwiZ3JvdXBQcm9maWxlXCIsU2h1dHVwVGltZTpcIm11dGVUaW1lXCIsRGVzYzpcImRlc2NyaXB0aW9uXCIsRXh0OlwiZXh0ZW5zaW9uXCIsR3JvdXBBdF9BY2NvdW50OlwiZ3JvdXBBdFVzZXJJRFwiLE1zZ051bTpcIm1lc3NhZ2VOdW1iZXJcIixQYk1zZ0tleTpcInBiRG93bmxvYWRLZXlcIixKc29uTXNnS2V5OlwiZG93bmxvYWRLZXlcIixNc2dNb2RpZmllZEZsYWc6XCJpc01vZGlmaWVkXCIsUGVuZGVuY3lJdGVtOlwiYXBwbGljYXRpb25JdGVtXCIsUGVuZGVuY3lUeXBlOlwiYXBwbGljYXRpb25UeXBlXCIsQWRkVGltZTpcInRpbWVcIixBZGRTb3VyY2U6XCJzb3VyY2VcIixBZGRXb3JkaW5nOlwid29yZGluZ1wiLFByb2ZpbGVJbUltYWdlOlwiYXZhdGFyXCIsUGVuZGVuY3lBZGQ6XCJmcmllbmRBcHBsaWNhdGlvbkFkZGVkXCIsRnJpZW5QZW5jeWREZWxfQWNjb3VudDpcImZyaWVuZEFwcGxpY2F0aW9uRGVsZXRlZFVzZXJJRExpc3RcIixQZWVyX0FjY291bnQ6XCJ1c2VySURcIixHcm91cEF0dHI6XCJncm91cEF0dHJpYnV0ZUxpc3RcIixHcm91cEF0dHJBcnk6XCJncm91cEF0dHJpYnV0ZUxpc3RcIixBdHRyTWFpblNlcTpcIm1haW5TZXF1ZW5jZVwiLHNlcTpcInNlcXVlbmNlXCIsR3JvdXBBdHRyT3B0aW9uOlwiZ3JvdXBBdHRyaWJ1dGVPcHRpb25cIixCeXRlc0NoYW5nZWRLZXlzOlwiY2hhbmdlZEtleUxpc3RcIixHcm91cEF0dHJJbmZvOlwiZ3JvdXBBdHRyaWJ1dGVMaXN0XCIsR3JvdXBBdHRyU2VxOlwibWFpblNlcXVlbmNlXCIsUHVzaENoYW5nZWRBdHRyVmFsRmxhZzpcImlzV2l0aENoYW5nZWRBdHRyaWJ1dGVJbmZvXCIsU3ViS2V5U2VxOlwic2VxdWVuY2VcIixWYWw6XCJ2YWx1ZVwiLE1zZ0dyb3VwRnJvbUNhcmROYW1lOlwic2VuZGVyTmFtZUNhcmRcIixNc2dHcm91cEZyb21OaWNrTmFtZTpcInNlbmRlck5pY2tcIixDMmNOaWNrOlwicGVlck5pY2tcIixDMmNJbWFnZTpcInBlZXJBdmF0YXJcIixTZW5kTXNnQ29udHJvbDpcIm1lc3NhZ2VDb250cm9sSW5mb1wiLE5vTGFzdE1zZzpcImV4Y2x1ZGVkRnJvbUxhc3RNZXNzYWdlXCIsTm9VbnJlYWQ6XCJleGNsdWRlZEZyb21VbnJlYWRDb3VudFwiLFVwZGF0ZVNlcTpcInVwZGF0ZVNlcXVlbmNlXCIsTXV0ZU5vdGlmaWNhdGlvbnM6XCJtdXRlRmxhZ1wiLE1zZ0NsaWVudFRpbWU6XCJjbGllbnRUaW1lXCIsVGlueUlkOlwidGlueUlEXCIsR3JvdXBNc2dSZWNlaXB0TGlzdDpcInJlYWRSZWNlaXB0TGlzdFwiLFJlYWROdW06XCJyZWFkQ291bnRcIixVbnJlYWROdW06XCJ1bnJlYWRDb3VudFwiLFRvcGljSWQ6XCJ0b3BpY0lEXCIsTWlsbGlvbkdyb3VwRmxhZzpcImNvbW11bml0eVR5cGVcIixTdXBwb3J0VG9waWM6XCJpc1N1cHBvcnRUb3BpY1wiLE1zZ1RvcGljTmV3SW5mbzpcIm5ld1RvcGljSW5mb1wiLFNodXR1cEFsbDpcIm11dGVBbGxNZW1iZXJzXCIsQ3VzdG9tU3RyaW5nOlwiY3VzdG9tRGF0YVwiLFRvcGljRmFjZVVybDpcImF2YXRhclwiLFRvcGljSW50cm9kdWN0aW9uOlwiaW50cm9kdWN0aW9uXCIsVG9waWNOb3RpZmljYXRpb246XCJub3RpZmljYXRpb25cIixUb3BpY0lkQXJyYXk6XCJ0b3BpY0lETGlzdFwiLE1zZ1ZlcnNpb246XCJtZXNzYWdlVmVyc2lvblwiLEMyY01zZ01vZE5vdGlmeXM6XCJjMmNNZXNzYWdlTW9kaWZpZWRcIixHcm91cE1zZ01vZE5vdGlmeXM6XCJncm91cE1lc3NhZ2VNb2RpZmllZFwiLEFwcGx5Sm9pbk9wdGlvbjpcImpvaW5PcHRpb25cIixNc2dGbGFnOlwibWVzc2FnZVJlbWluZFR5cGVcIixBdEluZm9MaXN0OlwiZ3JvdXBBdEluZm9MaXN0XCIsQXRGbGFnTGlzdDpcImdyb3VwQXRUeXBlXCIsQXRNc2dTZXE6XCJzZXF1ZW5jZVwiLEJhbkR1cmF0aW9uOlwiZHVyYXRpb25cIixCYW5EZXNjcmlwdGlvbjpcInJlYXNvblwiLE5vdFZpc2libGU6XCJpbnZpc2libGVcIixCeXRlc1RhZzpcInRhZ1wiLEJ5dGVzVmFsdWU6XCJ2YWx1ZVwiLFJwdEJ5dGVzVmFsdWU6XCJ2YWx1ZVwiLExhdGVzdFNlcTpcImdsb2JhbFNlcXVlbmNlXCIsQ2xlYXJTZXE6XCJjbGVhclNlcXVlbmNlXCIsU3VwcG9ydE1lc3NhZ2VFeHRlbnNpb246XCJpc1N1cHBvcnRFeHRlbnNpb25cIixFeHRlbnNpb25MaXN0OlwiZXh0ZW5zaW9uc1wiLEdyb3VwQ291bnRlcjpcImNvdW50ZXJMaXN0XCIsUmV2b2tlcl9BY2NvdW50OlwicmV2b2tlclwiLE1zZ0V4dGVuc2lvbk5vdGlmeTpcIm1lc3NhZ2VFeHRlbnNpb25Ob3RpZnlcIixFeHRlbnNpb25DMmNNc2dJbmZvOlwibWVzc2FnZUluZm9cIixFeHRlbnNpb25Hcm91cE1zZ0luZm86XCJtZXNzYWdlSW5mb1wiLE1zZ09wdFR5cGU6XCJvcGVyYXRlVHlwZVwiLFNldEtWSW5mbzpcIm9wZXJhdGVSZXN1bHRMaXN0XCIsRGVsZXRlS1ZJbmZvOlwib3BlcmF0ZVJlc3VsdExpc3RcIixDbGVhcktWSW5mbzpcIm9wZXJhdGVSZXN1bHRMaXN0XCIsTXNnS2V5VmFsdWU6XCJleHRlbnNpb25zXCIsQ2xlYXJNc2dTZXE6XCJjbGVhclNlcXVlbmNlXCIsTXNnTGFzdFNlcTpcImdsb2JhbFNlcXVlbmNlXCIsSW52aXRlSm9pbk9wdGlvbjpcImludml0ZU9wdGlvblwiLE1lbWJlckxpc3RfQWNjb3VudDpcImludml0ZWVMaXN0XCIsTXNnTWVtYmVyRXh0cmFJbmZvTGlzdDpcImludml0ZWVJbmZvTGlzdFwiLEU6XCJldmVudFwiLEdJbmY6XCJncm91cFByb2ZpbGVcIixNQ1Q6XCJjbGllbnRUaW1lXCIsTVI6XCJyYW5kb21cIixNUDpcInByaW9yaXR5XCIsTVRTOlwidGltZVwiLEdJZDpcImdyb3VwSURcIixNUzpcInNlcXVlbmNlXCIsQ0NEOlwiY2xvdWRDdXN0b21EYXRhXCIsRl9BY2NvdW50OlwiZnJvbVwiLEZfSGQ6XCJhdmF0YXJcIixGX05OOlwibmlja1wiLEdOOlwiZ3JvdXBOYW1lXCIsR1Q6XCJncm91cFR5cGVcIixJc1N5czpcImlzU3lzdGVtTWVzc2FnZVwiLE9wSW5mOlwib3BlcmF0b3JJbmZvXCIsSW1nOlwiYXZhdGFyXCIsTk46XCJuaWNrXCIsT25saW5lSW5mOlwib25saW5lTWVtYmVySW5mb1wiLEVUOlwiZXhwaXJlVGltZVwiLE51bTpcIm9ubGluZU1lbWJlck51bVwiLE9wdDpcIm9wZXJhdGlvblR5cGVcIixPX0FjY291bnQ6XCJvcGVyYXRvcklEXCIsUlQ6XCJvcGVyYXRpb25UeXBlXCIsVURGOlwidXNlckRlZmluZWRGaWVsZFwiLExfQWNjb3VudDpcInVzZXJJRExpc3RcIn0saWdub3JlS2V5V29yZDpbXCJDMkNcIixcIklEXCIsXCJVU1BcIl19O2Z1bmN0aW9uIGtyKGUsdCl7aWYoXCJzdHJpbmdcIiE9dHlwZW9mIGUmJiFBcnJheS5pc0FycmF5KGUpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJFeHBlY3RlZCB0aGUgaW5wdXQgdG8gYmUgYHN0cmluZyB8IHN0cmluZ1tdYFwiKTt0PU9iamVjdC5hc3NpZ24oe3Bhc2NhbENhc2U6ITF9LHQpO3ZhciBuO3JldHVybiAwPT09KGU9QXJyYXkuaXNBcnJheShlKT9lLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIGUudHJpbSgpfSkpLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGUubGVuZ3RofSkpLmpvaW4oXCItXCIpOmUudHJpbSgpKS5sZW5ndGg/XCJcIjoxPT09ZS5sZW5ndGg/dC5wYXNjYWxDYXNlP2UudG9VcHBlckNhc2UoKTplLnRvTG93ZXJDYXNlKCk6KGUhPT1lLnRvTG93ZXJDYXNlKCkmJihlPUVyKGUpKSxlPWUucmVwbGFjZSgvXltfLlxcLSBdKy8sXCJcIikudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXy5cXC0gXSsoXFx3fCQpL2csKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQudG9VcHBlckNhc2UoKX0pKS5yZXBsYWNlKC9cXGQrKFxcd3wkKS9nLChmdW5jdGlvbihlKXtyZXR1cm4gZS50b1VwcGVyQ2FzZSgpfSkpLG49ZSx0LnBhc2NhbENhc2U/bi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStuLnNsaWNlKDEpOm4pfXZhciBFcj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9ITEsbj0hMSxvPSExLHM9MDtzPGUubGVuZ3RoO3MrKyl7dmFyIGE9ZVtzXTt0JiYvW2EtekEtWl0vLnRlc3QoYSkmJmEudG9VcHBlckNhc2UoKT09PWE/KGU9ZS5zbGljZSgwLHMpK1wiLVwiK2Uuc2xpY2UocyksdD0hMSxvPW4sbj0hMCxzKyspOm4mJm8mJi9bYS16QS1aXS8udGVzdChhKSYmYS50b0xvd2VyQ2FzZSgpPT09YT8oZT1lLnNsaWNlKDAscy0xKStcIi1cIitlLnNsaWNlKHMtMSksbz1uLG49ITEsdD0hMCk6KHQ9YS50b0xvd2VyQ2FzZSgpPT09YSYmYS50b1VwcGVyQ2FzZSgpIT09YSxvPW4sbj1hLnRvVXBwZXJDYXNlKCk9PT1hJiZhLnRvTG93ZXJDYXNlKCkhPT1hKX1yZXR1cm4gZX07ZnVuY3Rpb24gU3IoZSx0KXt2YXIgbj0wO3JldHVybiBmdW5jdGlvbiBlKHQsbyl7aWYoKytuPjEwMClyZXR1cm4gbi0tLHQ7aWYoYXQodCkpe3ZhciBzPXQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gb3QodCk/ZSh0LG8pOnR9KSk7cmV0dXJuIG4tLSxzfWlmKG90KHQpKXt2YXIgYT0oaT10LHI9ZnVuY3Rpb24oZSx0KXtpZighZHQodCkpcmV0dXJuITE7aWYoKHM9dCkhPT1rcihzKSlmb3IodmFyIG49MDtuPERyLmlnbm9yZUtleVdvcmQubGVuZ3RoJiYhdC5pbmNsdWRlcyhEci5pZ25vcmVLZXlXb3JkW25dKTtuKyspO3ZhciBzO3JldHVybiBpdChvW3RdKT9mdW5jdGlvbihlKXtyZXR1cm5cIk9QUE9DaGFubmVsSURcIj09PWU/ZTplWzBdLnRvVXBwZXJDYXNlKCkra3IoZSkuc2xpY2UoMSl9KHQpOm9bdF19LHU9T2JqZWN0LmNyZWF0ZShudWxsKSxPYmplY3Qua2V5cyhpKS5mb3JFYWNoKChmdW5jdGlvbihlKXt2YXIgdD1yKGlbZV0sZSk7dCYmKHVbdF09aVtlXSl9KSksdSk7cmV0dXJuIGE9QXQoYSwoZnVuY3Rpb24odCxuKXtyZXR1cm4gYXQodCl8fG90KHQpP2UodCxvKTp0fSkpLG4tLSxhfXZhciBpLHIsdX0oZSx0KX1mdW5jdGlvbiBMcihlLHQpe2lmKGF0KGUpKXJldHVybiBlLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIG90KGUpP0xyKGUsdCk6ZX0pKTtpZihvdChlKSl7dmFyIG49KG89ZSxzPWZ1bmN0aW9uKGUsbil7cmV0dXJuIGl0KHRbbl0pP2tyKG4pOnRbbl19LGE9e30sT2JqZWN0LmtleXMobykuZm9yRWFjaCgoZnVuY3Rpb24oZSl7YVtzKG9bZV0sZSldPW9bZV19KSksYSk7cmV0dXJuIG49QXQobiwoZnVuY3Rpb24oZSl7cmV0dXJuIGF0KGUpfHxvdChlKT9McihlLHQpOmV9KSl9dmFyIG8scyxhfXZhciBBcj1TdHJpbmcuZnJvbUNoYXJDb2RlLFJyPWZ1bmN0aW9uKGUpe3ZhciB0PTB8ZS5jaGFyQ29kZUF0KDApO2lmKDU1Mjk2PD10KWlmKHQ8NTYzMjApe3ZhciBuPTB8ZS5jaGFyQ29kZUF0KDEpO2lmKDU2MzIwPD1uJiZuPD01NzM0Myl7aWYoKHQ9KHQ8PDEwKStuLTU2NjEzODg4fDApPjY1NTM1KXJldHVybiBBcigyNDB8dD4+PjE4LDEyOHx0Pj4+MTImNjMsMTI4fHQ+Pj42JjYzLDEyOHw2MyZ0KX1lbHNlIHQ9NjU1MzN9ZWxzZSB0PD01NzM0MyYmKHQ9NjU1MzMpO3JldHVybiB0PD0yMDQ3P0FyKDE5Mnx0Pj4+NiwxMjh8NjMmdCk6QXIoMjI0fHQ+Pj4xMiwxMjh8dD4+PjYmNjMsMTI4fDYzJnQpfSxOcj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9dm9pZCAwPT09ZT9cIlwiOihcIlwiK2UpLnJlcGxhY2UoL1tcXHg4MC1cXHVEN2ZmXFx1REMwMC1cXHVGRkZGXXxbXFx1RDgwMC1cXHVEQkZGXVtcXHVEQzAwLVxcdURGRkZdPy9nLFJyKSxuPTB8dC5sZW5ndGgsbz1uZXcgVWludDhBcnJheShuKSxzPTA7czxuO3M9cysxfDApb1tzXT0wfHQuY2hhckNvZGVBdChzKTtyZXR1cm4gb30sT3I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9oYW5kbGVyPXQ7dmFyIG49dC5nZXRVUkwoKTtpZih0aGlzLl9zb2NrZXQ9bnVsbCx0aGlzLl93b3JrZXJTb2NrZXQ9bnVsbCx0aGlzLl9pZD1fdCgpLHRoaXMuX2hhbmRsZXIuZ2V0SXNXb3JrZXJFbmFibGVkKCkpe3ZhciBzPVVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoWyc7bGV0IF9zb2NrZXQgPSBudWxsO29ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7ICBpZiAoZXZlbnQuZGF0YS5jbWQgPT09IFwic3RhcnRcIikgeyAgICBjb25zdCB1cmwgPSBldmVudC5kYXRhLnVybDsgICAgX3NvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsKTsgICAgX3NvY2tldC5iaW5hcnlUeXBlID0gXCJhcnJheWJ1ZmZlclwiOyAgICBfc29ja2V0Lm9ub3BlbiA9IGZ1bmN0aW9uKCkgeyAgICAgIHBvc3RNZXNzYWdlKHsgY2FsbGJhY2s6IFwib25PcGVuXCIsIGV4dGVuc2lvbnM6IF9zb2NrZXQuZXh0ZW5zaW9ucyB9KTsgICAgfTsgICAgX3NvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oZSkgeyAgICAgIHBvc3RNZXNzYWdlKHsgY2FsbGJhY2s6IFwib25PcGVuXCIsIGU6IHsgY29kZTogZS5jb2RlLCByZWFzb246IGUucmVhc29uIH0gfSk7ICAgIH07ICAgIF9zb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24oZSkgeyAgICAgIHBvc3RNZXNzYWdlKHsgY2FsbGJhY2s6IFwib25NZXNzYWdlXCIsIGRhdGE6IGUuZGF0YSB9KTsgICAgfTsgICAgX3NvY2tldC5vbmVycm9yID0gZnVuY3Rpb24oZSkgeyAgICAgIHBvc3RNZXNzYWdlKHsgY2FsbGJhY2s6IFwib25FcnJvclwiLCBlOiB7IGlzVHJ1c3RlZDogXCJ0cnVlXCIgfSB9KTsgICAgfTsgIH0gZWxzZSBpZiAoZXZlbnQuZGF0YS5jbWQgPT09IFwic2VuZE1lc3NhZ2VcIikgeyAgICBpZiAoX3NvY2tldCAhPT0gbnVsbCkgeyAgICAgIF9zb2NrZXQuc2VuZChldmVudC5kYXRhLmRhdGEpOyAgICB9ICB9IGVsc2UgaWYgKGV2ZW50LmRhdGEuY21kID09PSBcInN0b3BcIikgeyAgICBpZiAoX3NvY2tldCAhPT0gbnVsbCkgeyAgICAgIF9zb2NrZXQuY2xvc2UoZXZlbnQuZGF0YS5jb2RlKTsgICAgICBfc29ja2V0ID0gbnVsbDsgICAgfSAgfX07J10se3R5cGU6XCJhcHBsaWNhdGlvbi9qYXZhc2NyaXB0OyBjaGFyc2V0PXV0Zi04XCJ9KSk7dGhpcy5fd29ya2VyU29ja2V0PW5ldyBXb3JrZXIocyk7dmFyIGE9dGhpczt0aGlzLl93b3JrZXJTb2NrZXQub25tZXNzYWdlPWZ1bmN0aW9uKGUpe3ZhciB0PWUuZGF0YSxuPXQuY2FsbGJhY2ssbz10LmUscz10LmV4dGVuc2lvbnM7XCJvbk9wZW5cIj09PW4/YS5fb25PcGVuKHMpOlwib25DbG9zZVwiPT09bj9hLl9vbkNsb3NlKG8pOlwib25FcnJvclwiPT09bj9hLl9vbkVycm9yKG8pOlwib25NZXNzYWdlXCI9PT1uJiZhLl9vbk1lc3NhZ2UoZS5kYXRhKX0sdGhpcy5fd29ya2VyU29ja2V0LnBvc3RNZXNzYWdlKHtjbWQ6XCJzdGFydFwiLGlkOnRoaXMuX2lkLHVybDpufSl9ZWxzZSBhZT90ZT8ocmUuY29ubmVjdFNvY2tldCh7dXJsOm4saGVhZGVyOntcImNvbnRlbnQtdHlwZVwiOlwiYXBwbGljYXRpb24vanNvblwifX0pLHJlLm9uU29ja2V0Q2xvc2UodGhpcy5fb25DbG9zZS5iaW5kKHRoaXMpKSxyZS5vblNvY2tldE9wZW4odGhpcy5fb25PcGVuLmJpbmQodGhpcykpLHJlLm9uU29ja2V0TWVzc2FnZSh0aGlzLl9vbk1lc3NhZ2UuYmluZCh0aGlzKSkscmUub25Tb2NrZXRFcnJvcih0aGlzLl9vbkVycm9yLmJpbmQodGhpcykpKToodGhpcy5fc29ja2V0PXJlLmNvbm5lY3RTb2NrZXQoe3VybDpuLGhlYWRlcjp7XCJjb250ZW50LXR5cGVcIjpcImFwcGxpY2F0aW9uL2pzb25cIn0sY29tcGxldGU6ZnVuY3Rpb24oKXt9fSksdGhpcy5fc29ja2V0Lm9uQ2xvc2UodGhpcy5fb25DbG9zZS5iaW5kKHRoaXMpKSx0aGlzLl9zb2NrZXQub25PcGVuKHRoaXMuX29uT3Blbi5iaW5kKHRoaXMpKSx0aGlzLl9zb2NrZXQub25NZXNzYWdlKHRoaXMuX29uTWVzc2FnZS5iaW5kKHRoaXMpKSx0aGlzLl9zb2NrZXQub25FcnJvcih0aGlzLl9vbkVycm9yLmJpbmQodGhpcykpKTppZSYmKHRoaXMuX3NvY2tldD1uZXcgV2ViU29ja2V0KG4pLHRoaXMuX3NvY2tldC5iaW5hcnlUeXBlPVwiYXJyYXlidWZmZXJcIix0aGlzLl9zb2NrZXQub25vcGVuPXRoaXMuX29uT3Blbi5iaW5kKHRoaXMsdGhpcy5fc29ja2V0LmV4dGVuc2lvbnMpLHRoaXMuX3NvY2tldC5vbm1lc3NhZ2U9dGhpcy5fb25NZXNzYWdlLmJpbmQodGhpcyksdGhpcy5fc29ja2V0Lm9uY2xvc2U9dGhpcy5fb25DbG9zZS5iaW5kKHRoaXMpLHRoaXMuX3NvY2tldC5vbmVycm9yPXRoaXMuX29uRXJyb3IuYmluZCh0aGlzKSk7dGhpcy5fY2FuSVVzZUJpbmFyeUZyYW1lPXQuY2FuSVVzZUJpbmFyeUZyYW1lKCl9cmV0dXJuIGEoZSxbe2tleTpcImdldElEXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faWR9fSx7a2V5OlwiX29uT3BlblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2hhbmRsZXIub25PcGVuKHtpZDp0aGlzLl9pZCxyZXM6SlNPTi5zdHJpbmdpZnkoZSl9KX19LHtrZXk6XCJfb25DbG9zZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2hhbmRsZXIub25DbG9zZSh7aWQ6dGhpcy5faWQsZTplfSl9fSx7a2V5OlwiX29uTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0O3Q9dGhpcy5fY2FuSVVzZUJpbmFyeUZyYW1lP3RoaXMuX2lzQXBwQ29tcHJlc3NlZERhdGEoZS5kYXRhKT90aGlzLl9oYW5kbGVyLmluZmxhdGUoZS5kYXRhKTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9bmV3IFVpbnQ4QXJyYXkoZSksbj1cIlwiLG89MCxzPXQubGVuZ3RoO288czspe3ZhciBhPXRbb10saT0wLHI9MDtpZihhPD0xMjc/KGk9MCxyPTI1NSZhKTphPD0yMjM/KGk9MSxyPTMxJmEpOmE8PTIzOT8oaT0yLHI9MTUmYSk6YTw9MjQ0JiYoaT0zLHI9NyZhKSxzLW8taT4wKWZvcih2YXIgdT0wO3U8aTspcj1yPDw2fDYzJihhPXRbbyt1KzFdKSx1Kz0xO2Vsc2Ugcj02NTUzMyxpPXMtbztuKz1TdHJpbmcuZnJvbUNvZGVQb2ludChyKSxvKz1pKzF9cmV0dXJuIG59KGUuZGF0YSk6ZS5kYXRhLHRoaXMuX2hhbmRsZXIub25NZXNzYWdlKHtkYXRhOnR9KX19LHtrZXk6XCJfaXNBcHBDb21wcmVzc2VkRGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBVaW50OEFycmF5KGUpO3JldHVybiA2Nz09PXRbMF0mJjc5PT09dFsxXSYmNzc9PT10WzJdJiY4MD09PXRbM119fSx7a2V5OlwiX29uRXJyb3JcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9oYW5kbGVyLm9uRXJyb3Ioe2lkOnRoaXMuX2lkLGU6ZX0pfX0se2tleTpcInNldElzV29ya2VyRW5hYmxlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2lzV29ya2VyRW5hYmxlZD0hMH19LHtrZXk6XCJjbG9zZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuX3dvcmtlclNvY2tldCYmKHRoaXMuX3dvcmtlclNvY2tldC5wb3N0TWVzc2FnZSh7Y21kOlwic3RvcFwiLGNvZGU6ZX0pLHRoaXMuX3dvcmtlclNvY2tldC50ZXJtaW5hdGUoKSx0aGlzLl93b3JrZXJTb2NrZXQ9bnVsbCksdGUpcmV0dXJuIHJlLm9mZlNvY2tldENsb3NlKCkscmUub2ZmU29ja2V0TWVzc2FnZSgpLHJlLm9mZlNvY2tldE9wZW4oKSxyZS5vZmZTb2NrZXRFcnJvcigpLHZvaWQgcmUuY2xvc2VTb2NrZXQoKTt0aGlzLl9zb2NrZXQmJihhZT8odGhpcy5fc29ja2V0Lm9uQ2xvc2UoKGZ1bmN0aW9uKCl7fSkpLHRoaXMuX3NvY2tldC5vbk9wZW4oKGZ1bmN0aW9uKCl7fSkpLHRoaXMuX3NvY2tldC5vbk1lc3NhZ2UoKGZ1bmN0aW9uKCl7fSkpLHRoaXMuX3NvY2tldC5vbkVycm9yKChmdW5jdGlvbigpe30pKSk6aWUmJih0aGlzLl9zb2NrZXQub25vcGVuPW51bGwsdGhpcy5fc29ja2V0Lm9ubWVzc2FnZT1udWxsLHRoaXMuX3NvY2tldC5vbmNsb3NlPW51bGwsdGhpcy5fc29ja2V0Lm9uZXJyb3I9bnVsbCksZWU/dGhpcy5fc29ja2V0LmNsb3NlKHtjb2RlOmV9KTp0aGlzLl9zb2NrZXQuY2xvc2UoZSksdGhpcy5fc29ja2V0PW51bGwpfX0se2tleTpcInNlbmRcIix2YWx1ZTpmdW5jdGlvbihlKXtpZih0aGlzLl93b3JrZXJTb2NrZXQpdGhpcy5fd29ya2VyU29ja2V0LnBvc3RNZXNzYWdlKHtjbWQ6XCJzZW5kTWVzc2FnZVwiLGRhdGE6dGhpcy5fY2FuSVVzZUJpbmFyeUZyYW1lP05yKGUuZGF0YSkuYnVmZmVyOmUuZGF0YX0pO2Vsc2V7aWYodGUpcmV0dXJuIHZvaWQgcmUuc2VuZFNvY2tldE1lc3NhZ2Uoe2RhdGE6ZS5kYXRhLGZhaWw6ZnVuY3Rpb24oKXtlLmZhaWwmJmUucmVxdWVzdElEJiZlLmZhaWwoZS5yZXF1ZXN0SUQpfX0pO3RoaXMuX3NvY2tldCYmKGFlP3RoaXMuX3NvY2tldC5zZW5kKHtkYXRhOnRoaXMuX2NhbklVc2VCaW5hcnlGcmFtZT9OcihlLmRhdGEpLmJ1ZmZlcjplLmRhdGEsZmFpbDpmdW5jdGlvbigpe2UuZmFpbCYmZS5yZXF1ZXN0SUQmJmUuZmFpbChlLnJlcXVlc3RJRCl9fSk6aWUmJnRoaXMuX3NvY2tldC5zZW5kKHRoaXMuX2NhbklVc2VCaW5hcnlGcmFtZT9OcihlLmRhdGEpOmUuZGF0YSkpfX19XSksZX0oKSxHcj00ZTMsVXI9NDAwMSxQcj1bXCJrZXlNYXBcIl0sYnI9W1wia2V5TWFwXCJdLHdyPVwiY29ubmVjdGVkXCIsRnI9XCJjb25uZWN0aW5nXCIscXI9XCJkaXNjb25uZWN0ZWRcIix4cj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpLHRoaXMuX2NoYW5uZWxNb2R1bGU9dCx0aGlzLl9uPVwiU29ja2V0SGFuZGxlclwiLHRoaXMuX3Byb21pc2VNYXA9bmV3IE1hcCx0aGlzLl9yZWFkeVN0YXRlPXFyLHRoaXMuX3NpbXBsZVJlcXVlc3RNYXA9bmV3IE1hcCx0aGlzLk1BWF9TSVpFPTEwMCx0aGlzLl9zdGFydFNlcXVlbmNlPV90KCksdGhpcy5fc3RhcnRUcz0wLHRoaXMuX3JlQ29ubmVjdEZsYWc9ITEsdGhpcy5fbmV4dFBpbmdUcz0wLHRoaXMuX3JlQ29ubmVjdENvdW50PTAsdGhpcy5NQVhfUkVDT05ORUNUX0NPVU5UPTMsdGhpcy5fc29ja2V0SUQ9LTEsdGhpcy5fcmFuZG9tPTAsdGhpcy5fc29ja2V0PW51bGwsdGhpcy5fdXJsPVwiXCIsdGhpcy5fb25PcGVuVHM9MCx0aGlzLl9jYW5JVXNlQmluYXJ5RnJhbWU9ITAsdGhpcy5faXNXb3JrZXJFbmFibGVkPSEwLHRoaXMuX3NldFdlYnNvY2tldEhvc3QoKSx0aGlzLl9pbml0Q29ubmVjdGlvbigpfXJldHVybiBhKGUsW3trZXk6XCJfc2V0V2Vic29ja2V0SG9zdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fY2hhbm5lbE1vZHVsZS5nZXRNb2R1bGUoeG4pLHQ9Rzt0aGlzLl9jaGFubmVsTW9kdWxlLmlzT3ZlcnNlYSgpJiYodD1VKSxlLmlzU2luZ2Fwb3JlU2l0ZSgpP3Q9UDplLmlzS29yZWFTaXRlKCk/dD1iOmUuaXNHZXJtYW55U2l0ZSgpP3Q9dzplLmlzSW5kaWFTaXRlKCk/dD1GOmUuaXNKYXBhblNpdGUoKT90PXE6ZS5pc1VTQVNpdGUoKSYmKHQ9eCksVi5IT1NULnNldEN1cnJlbnQodCl9fSx7a2V5OlwiX2luaXRDb25uZWN0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oKXtpdChWLkhPU1QuQ1VSUkVOVC5CQUNLVVApfHxcIlwiPT09dGhpcy5fdXJsP3RoaXMuX3VybD1WLkhPU1QuQ1VSUkVOVC5ERUZBVUxUOnRoaXMuX3VybD09PVYuSE9TVC5DVVJSRU5ULkRFRkFVTFQ/dGhpcy5fdXJsPVYuSE9TVC5DVVJSRU5ULkJBQ0tVUDp0aGlzLl91cmw9PT1WLkhPU1QuQ1VSUkVOVC5CQUNLVVA/dGhpcy5fdXJsPXRoaXMuX2NhbklVc2VBbnlDYXN0KCk/Vi5IT1NULkNVUlJFTlQuQU5ZQ0FTVDpWLkhPU1QuQ1VSUkVOVC5ERUZBVUxUOnRoaXMuX3VybD09PVYuSE9TVC5DVVJSRU5ULkFOWUNBU1QmJihWLkhPU1QuQ1VSUkVOVC5BTllDQVNUPVwiXCIsdGhpcy5fdXJsPVYuSE9TVC5DVVJSRU5ULkRFRkFVTFQpO3ZhciBlPXRoaXMuX2NoYW5uZWxNb2R1bGUuZ2V0TW9kdWxlKHhuKS5nZXRQcm94eVNlcnZlcigpO3p0KGUpfHwodGhpcy5fdXJsPWUpLHRoaXMuX2Nvbm5lY3QoKSx0aGlzLl9uZXh0UGluZ1RzPTB9fSx7a2V5OlwiX2NhbklVc2VBbnlDYXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gaWUmJlYuSE9TVC5DVVJSRU5ULkFOWUNBU1R9fSx7a2V5Olwib25DaGVja1RpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7ZSUxPT0wJiZ0aGlzLl9jaGVja1Byb21pc2VNYXAoKX19LHtrZXk6XCJfY2hlY2tQcm9taXNlTWFwXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzOzAhPT10aGlzLl9wcm9taXNlTWFwLnNpemUmJnRoaXMuX3Byb21pc2VNYXAuZm9yRWFjaCgoZnVuY3Rpb24odCxuKXt2YXIgbz10LnJlamVjdCxzPXQudGltZXN0YW1wLGE9MTVlMzstMSE9PW4uaW5kZXhPZihjbyk/YT05ZTQ6LTEhPT1uLmluZGV4T2YoSHMpJiYoYT0zZTMpLERhdGUubm93KCktcz49YSYmKFZlLmwoXCJcIi5jb25jYXQoZS5fbixcIi5fY2hlY2tQcm9taXNlTWFwIHJlcXVlc3QgdGltZW91dCwgZGVsZXRlIHJlcXVlc3RJRDpcIikuY29uY2F0KG4pKSxlLl9wcm9taXNlTWFwLmRlbGV0ZShuKSxvKG5ldyBqYSh7Y29kZTpoYS5ORVRXT1JLX1RJTUVPVVR9KSksZS5fY2hhbm5lbE1vZHVsZS5vblJlcXVlc3RUaW1lb3V0KG4pKX0pKX19LHtrZXk6XCJvbk9wZW5cIix2YWx1ZTpmdW5jdGlvbihlKXtpZihcIlwiIT09dGhpcy5fcmVhZHlTdGF0ZSl7dGhpcy5fb25PcGVuVHM9RGF0ZS5ub3coKTt2YXIgdD1lLmlkLG49ZS5yZXM7dGhpcy5fc29ja2V0SUQ9dDt2YXIgbz1EYXRlLm5vdygpLXRoaXMuX3N0YXJ0VHMscz1cInNvY2tldElEOlwiLmNvbmNhdCh0LFwiIHJlczpcIikuY29uY2F0KG4pO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fb25PcGVuIGNvc3Q6XCIpLmNvbmNhdChvLFwiIG1zLiBcIikuY29uY2F0KHMpKSxuZXcgQWEoXCJ3c09uT3BlblwiKS5zZXRNZXNzYWdlKG8pLnNldENvc3RUaW1lKG8pLnNldE1vcmVNZXNzYWdlKHMpLmVuZCgpLGUuaWQ9PT10aGlzLl9zb2NrZXRJRCYmKHRoaXMuX3JlYWR5U3RhdGU9d3IsdGhpcy5fcmVDb25uZWN0Q291bnQ9MCx0aGlzLl9yZXNlbmQoKSwhMD09PXRoaXMuX3JlQ29ubmVjdEZsYWcmJih0aGlzLl9jaGFubmVsTW9kdWxlLm9uUmVjb25uZWN0ZWQoKSx0aGlzLl9yZUNvbm5lY3RGbGFnPSExKSx0aGlzLl9jaGFubmVsTW9kdWxlLm9uT3BlbigpKX19fSx7a2V5Olwib25DbG9zZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBBYShcIndzT25DbG9zZVwiKSxuPWUuaWQsbz1lLmUscz1cInNvdXJjZVNvY2tldElEOlwiLmNvbmNhdChuLFwiIGN1cnJlbnRTb2NrZXRJRDpcIikuY29uY2F0KHRoaXMuX3NvY2tldElELFwiIGNvZGU6XCIpLmNvbmNhdChvLmNvZGUsXCIgcmVhc29uOlwiKS5jb25jYXQoby5yZWFzb24pLGE9MDswIT09dGhpcy5fb25PcGVuVHMmJihhPURhdGUubm93KCktdGhpcy5fb25PcGVuVHMpLHQuc2V0TWVzc2FnZShhKS5zZXRDb3N0VGltZShhKS5zZXRNb3JlTWVzc2FnZShzKS5zZXRDb2RlKG8uY29kZSkuZW5kKCksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vbkNsb3NlIFwiKS5jb25jYXQocyxcIiBvbmxpbmVUaW1lOlwiKS5jb25jYXQoYSkpLG49PT10aGlzLl9zb2NrZXRJRCYmKHRoaXMuX3JlYWR5U3RhdGU9cXIsYTwxZTM/dGhpcy5fY2hhbm5lbE1vZHVsZS5vblJlY29ubmVjdEZhaWxlZCgpOnRoaXMuX2NoYW5uZWxNb2R1bGUub25DbG9zZSgpKX19LHtrZXk6XCJvbkVycm9yXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5pZCxuPWUuZSxvPVwic291cmNlU29ja2V0SUQ6XCIuY29uY2F0KHQsXCIgY3VycmVudFNvY2tldElEOlwiKS5jb25jYXQodGhpcy5fc29ja2V0SUQpO25ldyBBYShcIndzT25FcnJvclwiKS5zZXRNZXNzYWdlKG4uZXJyTXNnfHxndChuKSkuc2V0TW9yZU1lc3NhZ2Uobykuc2V0TGV2ZWwoXCJlcnJvclwiKS5lbmQoKSxWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uRXJyb3JcIiksbixvKSx0PT09dGhpcy5fc29ja2V0SUQmJih0aGlzLl9yZWFkeVN0YXRlPVwiXCIsdGhpcy5fY2hhbm5lbE1vZHVsZS5vbkVycm9yKCkpfX0se2tleTpcIm9uTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0O3RyeXt0PUpTT04ucGFyc2UoZS5kYXRhKX1jYXRjaChjKXtuZXcgQWEoXCJqc29uUGFyc2VFcnJvclwiKS5zZXRNZXNzYWdlKGUuZGF0YSkuZW5kKCl9aWYodCYmdC5oZWFkKXt2YXIgbj10aGlzLl9nZXRSZXF1ZXN0SURGcm9tSGVhZCh0LmhlYWQpLG89dC5ib2R5O2lmKCF0aGlzLl9pc1RSVENDb21tYW5kKG4pKXt2YXIgcz1idCh0LmhlYWQpO289THIodC5ib2R5LHRoaXMuX2dldFJlc3BvbnNlS2V5TWFwKHMpKX1pZihWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25NZXNzYWdlIHJldDpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KG8pLFwiIHJlcXVlc3RJRDpcIikuY29uY2F0KG4sXCIgaGFzOlwiKS5jb25jYXQodGhpcy5fcHJvbWlzZU1hcC5oYXMobikpKSx0aGlzLl9zZXROZXh0UGluZ1RzKCksdGhpcy5fcHJvbWlzZU1hcC5oYXMobikpe3ZhciBhPXRoaXMuX3Byb21pc2VNYXAuZ2V0KG4pLGk9YS5yZXNvbHZlLHI9YS5yZWplY3QsdT1hLnRpbWVzdGFtcDtyZXR1cm4gdGhpcy5fcHJvbWlzZU1hcC5kZWxldGUobiksdGhpcy5fY2FsY1JUVCh1KSx2b2lkKG8uZXJyb3JDb2RlJiYwIT09by5lcnJvckNvZGU/KHRoaXMuX2NoYW5uZWxNb2R1bGUub25FcnJvckNvZGVOb3RaZXJvKG8pLHIobmV3IGphKHtjb2RlOm8uZXJyb3JDb2RlLG1lc3NhZ2U6by5lcnJvckluZm98fFwiXCIsZGF0YTpuLmluY2x1ZGVzKFJvKXx8bi5pbmNsdWRlcyh5cyk/e2VsZW1lbnRzOm8uZWxlbWVudHMsbWVzc2FnZVZlcnNpb246by5tZXNzYWdlVmVyc2lvbixjbG91ZEN1c3RvbURhdGE6by5jbG91ZEN1c3RvbURhdGF9OnZvaWQgMH0pKSk6aShZYShvKSkpfXRoaXMuX2NoYW5uZWxNb2R1bGUub25NZXNzYWdlKHtoZWFkOnQuaGVhZCxib2R5Om99KX19fSx7a2V5OlwiX2lzVFJUQ0NvbW1hbmRcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9dGhpcy5fY2hhbm5lbE1vZHVsZS5nZXRNb2R1bGUoc28pLmdldENvbW1hbmRMaXN0KCksbj0hMSxvPTA7bzx0Lmxlbmd0aDtvKyspaWYoZS5zdGFydHNXaXRoKHRbb10pKXtuPSEwO2JyZWFrfXJldHVybiBufX0se2tleTpcIl9jYWxjUlRUXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9RGF0ZS5ub3coKS1lO3RoaXMuX2NoYW5uZWxNb2R1bGUuZ2V0TW9kdWxlKGVvKS5hZGRSVFQodCl9fSx7a2V5OlwiX2Nvbm5lY3RcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3N0YXJ0VHM9RGF0ZS5ub3coKSx0aGlzLl9vbk9wZW5Ucz0wLHRoaXMuX3NvY2tldD1uZXcgT3IodGhpcyksdGhpcy5fc29ja2V0SUQ9dGhpcy5fc29ja2V0LmdldElEKCksdGhpcy5fcmVhZHlTdGF0ZT1GcixWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2Nvbm5lY3QgaXNXb3JrZXJFbmFibGVkOlwiKS5jb25jYXQodGhpcy5nZXRJc1dvcmtlckVuYWJsZWQoKSxcIiBzb2NrZXRJRDpcIikuY29uY2F0KHRoaXMuX3NvY2tldElELFwiIHVybDpcIikuY29uY2F0KHRoaXMuZ2V0VVJMKCkpKSxuZXcgQWEoXCJ3c0Nvbm5lY3RcIikuc2V0TWVzc2FnZShcInNvY2tldElEOlwiLmNvbmNhdCh0aGlzLl9zb2NrZXRJRCxcIiB1cmw6XCIpLmNvbmNhdCh0aGlzLmdldFVSTCgpKSkuZW5kKCl9fSx7a2V5OlwiZ2V0VVJMXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jaGFubmVsTW9kdWxlLmlzRGV2TW9kZSgpJiYodGhpcy5fY2FuSVVzZUJpbmFyeUZyYW1lPSExKTt2YXIgZT1PdCgpOyh0ZXx8WCYmXCJ3aW5kb3dzXCI9PT1lfHxvZSkmJih0aGlzLl9jYW5JVXNlQmluYXJ5RnJhbWU9ITEpO3ZhciB0PS0xO1wiaW9zXCI9PT1lP3Q9bWV8fC0xOlwiYW5kcm9pZFwiPT09ZSYmKHQ9eWV8fC0xKTt2YXIgbj10aGlzLl9jaGFubmVsTW9kdWxlLmdldE1vZHVsZSh4biksbz10aGlzLl9jaGFubmVsTW9kdWxlLmdldFBsYXRmb3JtKCkscz1uLmdldFNES0FwcElEKCksYT1uLmdldEluc3RhbmNlSUQoKSxpPVwic2RrYXBwaWQ9XCIuY29uY2F0KHMsXCImaW5zdGFuY2VpZD1cIikuY29uY2F0KGEsXCImcmFuZG9tPVwiKS5jb25jYXQodGhpcy5fZ2V0UmFuZG9tKCksXCImcGxhdGZvcm09XCIpLmNvbmNhdChvLFwiJmhvc3Q9XCIpLmNvbmNhdChlKStcIiZ2ZXJzaW9uPVwiLmNvbmNhdCh0LFwiJnNka3ZlcnNpb249XCIpLmNvbmNhdChcIjIuMjcuNlwiKTtyZXR1cm4gWiYmKGkrPVwiJmlzbWluaWdhbWU9MVwiKSx0aGlzLl9jaGFubmVsTW9kdWxlLmNhbklVc2VJbmZsYXRlKCkmJihpKz1cIiZjb21wcmVzcz1nemlwXCIpLHRoaXMuX2NhbklVc2VCaW5hcnlGcmFtZT9cIlwiLmNvbmNhdCh0aGlzLl91cmwsXCIvYmluZm8/XCIpLmNvbmNhdChpKTpcIlwiLmNvbmNhdCh0aGlzLl91cmwsXCIvaW5mbz9cIikuY29uY2F0KGkpfX0se2tleTpcIl9jbG9zZUNvbm5lY3Rpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2Nsb3NlQ29ubmVjdGlvbiBzb2NrZXRJRDpcIikuY29uY2F0KHRoaXMuX3NvY2tldElEKSksdGhpcy5fc29ja2V0JiYodGhpcy5fc29ja2V0LmNsb3NlKGUpLHRoaXMuX3NvY2tldElEPS0xLHRoaXMuX3NvY2tldD1udWxsLHRoaXMuX3JlYWR5U3RhdGU9cXIpfX0se2tleTpcIl9yZXNlbmRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYoVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9yZXNlbmQgcmVDb25uZWN0RmxhZzpcIikuY29uY2F0KHRoaXMuX3JlQ29ubmVjdEZsYWcpLFwicHJvbWlzZU1hcC5zaXplOlwiLmNvbmNhdCh0aGlzLl9wcm9taXNlTWFwLnNpemUsXCIgc2ltcGxlUmVxdWVzdE1hcC5zaXplOlwiKS5jb25jYXQodGhpcy5fc2ltcGxlUmVxdWVzdE1hcC5zaXplKSksdGhpcy5fcHJvbWlzZU1hcC5zaXplPjAmJnRoaXMuX3Byb21pc2VNYXAuZm9yRWFjaCgoZnVuY3Rpb24odCxuKXt2YXIgbz10LnVwbGlua0RhdGEscz10LnJlc29sdmUsYT10LnJlamVjdDtlLl9wcm9taXNlTWFwLnNldChuLHtyZXNvbHZlOnMscmVqZWN0OmEsdGltZXN0YW1wOkRhdGUubm93KCksdXBsaW5rRGF0YTpvfSksZS5fZXhlY3V0ZShuLG8pfSkpLHRoaXMuX3NpbXBsZVJlcXVlc3RNYXAuc2l6ZT4wKXt2YXIgdCxuPUQodGhpcy5fc2ltcGxlUmVxdWVzdE1hcCk7dHJ5e2ZvcihuLnMoKTshKHQ9bi5uKCkpLmRvbmU7KXt2YXIgbz12KHQudmFsdWUsMikscz1vWzBdLGE9b1sxXTt0aGlzLl9leGVjdXRlKHMsYSl9fWNhdGNoKGkpe24uZShpKX1maW5hbGx5e24uZigpfXRoaXMuX3NpbXBsZVJlcXVlc3RNYXAuY2xlYXIoKX19fSx7a2V5Olwic2VuZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7ZS5oZWFkLnNlcT10aGlzLl9nZXRTZXF1ZW5jZSgpLGUuaGVhZC5yZXF0aW1lPU1hdGguZmxvb3IoRGF0ZS5ub3coKS8xZTMpLGUua2V5TWFwO3ZhciBuPWcoZSxQciksbz10aGlzLl9nZXRSZXF1ZXN0SURGcm9tSGVhZChlLmhlYWQpLHM9SlNPTi5zdHJpbmdpZnkobik7cmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihlLGEpeyh0Ll9wcm9taXNlTWFwLnNldChvLHtyZXNvbHZlOmUscmVqZWN0OmEsdGltZXN0YW1wOkRhdGUubm93KCksdXBsaW5rRGF0YTpzfSksVmUuZChcIlwiLmNvbmNhdCh0Ll9uLFwiLnNlbmQgdXBsaW5rRGF0YTpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KG4pLFwiIHJlcXVlc3RJRDpcIikuY29uY2F0KG8sXCIgcmVhZHlTdGF0ZTpcIikuY29uY2F0KHQuX3JlYWR5U3RhdGUpKSx0Ll9yZWFkeVN0YXRlIT09d3IpP3QuX3JlQ29ubmVjdCgpOih0Ll9leGVjdXRlKG8scyksdC5fY2hhbm5lbE1vZHVsZS5nZXRNb2R1bGUoZW8pLmFkZFJlcXVlc3RDb3VudCgpKX0pKX19LHtrZXk6XCJzaW1wbHlTZW5kXCIsdmFsdWU6ZnVuY3Rpb24oZSl7ZS5oZWFkLnNlcT10aGlzLl9nZXRTZXF1ZW5jZSgpLGUuaGVhZC5yZXF0aW1lPU1hdGguZmxvb3IoRGF0ZS5ub3coKS8xZTMpLGUua2V5TWFwO3ZhciB0PWcoZSxiciksbj10aGlzLl9nZXRSZXF1ZXN0SURGcm9tSGVhZChlLmhlYWQpLG89SlNPTi5zdHJpbmdpZnkodCk7dGhpcy5fcmVhZHlTdGF0ZSE9PXdyPyh0aGlzLl9zaW1wbGVSZXF1ZXN0TWFwLnNpemU8dGhpcy5NQVhfU0laRT90aGlzLl9zaW1wbGVSZXF1ZXN0TWFwLnNldChuLG8pOlZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5zaW1wbHlTZW5kLiBzaW1wbGVSZXF1ZXN0TWFwIGlzIGZ1bGwsIGRyb3AgcmVxdWVzdCFcIikpLHRoaXMuX3JlQ29ubmVjdCgpKTp0aGlzLl9leGVjdXRlKG4sbyl9fSx7a2V5OlwiX2V4ZWN1dGVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX3NvY2tldC5zZW5kKHtkYXRhOnQsZmFpbDphZT90aGlzLl9vblNlbmRGYWlsLmJpbmQodGhpcyk6dm9pZCAwLHJlcXVlc3RJRDplfSl9fSx7a2V5OlwiX29uU2VuZEZhaWxcIix2YWx1ZTpmdW5jdGlvbihlKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uU2VuZEZhaWwgcmVxdWVzdElEOlwiKS5jb25jYXQoZSkpfX0se2tleTpcIl9nZXRTZXF1ZW5jZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU7aWYodGhpcy5fc3RhcnRTZXF1ZW5jZTwyNDE1OTE5MTAzKXJldHVybiBlPXRoaXMuX3N0YXJ0U2VxdWVuY2UsdGhpcy5fc3RhcnRTZXF1ZW5jZSs9MSwyNDE1OTE5MTAzPT09dGhpcy5fc3RhcnRTZXF1ZW5jZSYmKHRoaXMuX3N0YXJ0U2VxdWVuY2U9X3QoKSksZX19LHtrZXk6XCJfZ2V0UmVxdWVzdElERnJvbUhlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5zZXJ2Y21kK2Uuc2VxfX0se2tleTpcIl9nZXRSZXNwb25zZUtleU1hcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPXRoaXMuX2NoYW5uZWxNb2R1bGUuZ2V0S2V5TWFwKGUpO3JldHVybiB0KHQoe30sRHIucmVzcG9uc2UpLG4ucmVzcG9uc2UpfX0se2tleTpcIl9yZUNvbm5lY3RcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3JlYWR5U3RhdGUhPT13ciYmdGhpcy5fcmVhZHlTdGF0ZSE9PUZyJiZ0aGlzLmZvcmNlZFJlY29ubmVjdCgpfX0se2tleTpcImZvcmNlZFJlY29ubmVjdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZm9yY2VkUmVjb25uZWN0XCIpO1ZlLmwoXCJcIi5jb25jYXQodCxcIiBjb3VudDpcIikuY29uY2F0KHRoaXMuX3JlQ29ubmVjdENvdW50LFwiIHJlYWR5U3RhdGU6XCIpLmNvbmNhdCh0aGlzLl9yZWFkeVN0YXRlKSksdGhpcy5fcmVDb25uZWN0RmxhZz0hMCx0aGlzLl9yZXNldFJhbmRvbSgpLHRoaXMuX3JlQ29ubmVjdENvdW50PHRoaXMuTUFYX1JFQ09OTkVDVF9DT1VOVD8odGhpcy5fcmVDb25uZWN0Q291bnQrPTEsdGhpcy5fY2xvc2VDb25uZWN0aW9uKFVyKSx0aGlzLl9pbml0Q29ubmVjdGlvbigpKToodGhpcy5fcmVDb25uZWN0Q291bnQ9MCx0aGlzLl9jaGFubmVsTW9kdWxlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKG4pe3ZhciBvPXYobiwyKSxzPW9bMF07b1sxXSxzPyhWZS53KFwiXCIuY29uY2F0KHQsXCIgZGlzY29ubmVjdGVkIGZyb20gd3NzZXJ2ZXIgYnV0IG5ldHdvcmsgaXMgb2ssIGNvbnRpbnVlLi4uXCIpKSxlLl9jbG9zZUNvbm5lY3Rpb24oVXIpLGUuX2luaXRDb25uZWN0aW9uKCkpOmUuX2NoYW5uZWxNb2R1bGUub25SZWNvbm5lY3RGYWlsZWQoKX0pKSl9fSx7a2V5OlwiZ2V0UmVjb25uZWN0RmxhZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlQ29ubmVjdEZsYWd9fSx7a2V5OlwiX3NldE5leHRQaW5nVHNcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX25leHRQaW5nVHM9RGF0ZS5ub3coKSsxZTR9fSx7a2V5OlwiZ2V0TmV4dFBpbmdUc1wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX25leHRQaW5nVHN9fSx7a2V5OlwiaXNDb25uZWN0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWFkeVN0YXRlPT09d3J9fSx7a2V5OlwiY2FuSVVzZUJpbmFyeUZyYW1lXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2FuSVVzZUJpbmFyeUZyYW1lfX0se2tleTpcImluZmxhdGVcIix2YWx1ZTpmdW5jdGlvbihlKXtpZih0aGlzLl9jaGFubmVsTW9kdWxlLmNhbklVc2VJbmZsYXRlKCkpcmV0dXJuIHRoaXMuX2NoYW5uZWxNb2R1bGUuZ2V0TW9kdWxlKHJvKS5pbmZsYXRlKGUpfX0se2tleTpcInNldElzV29ya2VyRW5hYmxlZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5zZXRJc1dvcmtlckVuYWJsZWQgZmxhZzpcIikuY29uY2F0KGUpKSx0aGlzLl9pc1dvcmtlckVuYWJsZWQ9ZX19LHtrZXk6XCJnZXRJc1dvcmtlckVuYWJsZWRcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1dvcmtlckVuYWJsZWQmJlNlfX0se2tleTpcIl9nZXRSYW5kb21cIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5fcmFuZG9tJiYodGhpcy5fcmFuZG9tPU1hdGgucmFuZG9tKCkpLHRoaXMuX3JhbmRvbX19LHtrZXk6XCJfcmVzZXRSYW5kb21cIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3JhbmRvbT0wfX0se2tleTpcImNsb3NlXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuY2xvc2VcIikpLHRoaXMuX2Nsb3NlQ29ubmVjdGlvbihHciksdGhpcy5fcHJvbWlzZU1hcC5jbGVhcigpLHRoaXMuX3N0YXJ0U2VxdWVuY2U9X3QoKSx0aGlzLl9yZWFkeVN0YXRlPXFyLHRoaXMuX3NpbXBsZVJlcXVlc3RNYXAuY2xlYXIoKSx0aGlzLl9yZUNvbm5lY3RGbGFnPSExLHRoaXMuX3JlQ29ubmVjdENvdW50PTAsdGhpcy5fb25PcGVuVHM9MCx0aGlzLl91cmw9XCJcIix0aGlzLl9yYW5kb209MCx0aGlzLl9jYW5JVXNlQmluYXJ5RnJhbWU9ITAsdGhpcy5faXNXb3JrZXJFbmFibGVkPSEwfX1dKSxlfSgpLFZyPWZ1bmN0aW9uKGUpe3IobixlKTt2YXIgdD1mKG4pO2Z1bmN0aW9uIG4oZSl7dmFyIHM7aWYobyh0aGlzLG4pLChzPXQuY2FsbCh0aGlzLGUpKS5fbj1cIkNoYW5uZWxNb2R1bGVcIixzLl9zb2NrZXRIYW5kbGVyPW5ldyB4cihoKHMpKSxzLl9wcm9iaW5nPSExLHMuX2lzQXBwU2hvd2luZz0hMCxzLl9wcmV2aW91c1N0YXRlPUUuTkVUX1NUQVRFX0NPTk5FQ1RFRCxhZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgcmUub25BcHBTaG93JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiByZS5vbkFwcEhpZGUpe3ZhciBhPXMuX29uQXBwSGlkZS5iaW5kKGgocykpLGk9cy5fb25BcHBTaG93LmJpbmQoaChzKSk7XCJmdW5jdGlvblwiPT10eXBlb2YgcmUub2ZmQXBwSGlkZSYmcmUub2ZmQXBwSGlkZShhKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiByZS5vZmZBcHBTaG93JiZyZS5vZmZBcHBTaG93KGkpLHJlLm9uQXBwSGlkZShhKSxyZS5vbkFwcFNob3coaSl9cmV0dXJuIHMuX3RpbWVyRm9yTm90TG9nZ2VkSW49LTEscy5fdGltZXJGb3JOb3RMb2dnZWRJbj1zZXRJbnRlcnZhbChzLm9uQ2hlY2tUaW1lci5iaW5kKGgocykpLDFlMykscy5fZmF0YWxFcnJvckZsYWc9ITEsc31yZXR1cm4gYShuLFt7a2V5Olwib25DaGVja1RpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc29ja2V0SGFuZGxlciYmKHRoaXMuaXNMb2dnZWRJbigpPyh0aGlzLl90aW1lckZvck5vdExvZ2dlZEluPjAmJihjbGVhckludGVydmFsKHRoaXMuX3RpbWVyRm9yTm90TG9nZ2VkSW4pLHRoaXMuX3RpbWVyRm9yTm90TG9nZ2VkSW49LTEpLHRoaXMuX3NvY2tldEhhbmRsZXIub25DaGVja1RpbWVyKGUpKTp0aGlzLl9zb2NrZXRIYW5kbGVyLm9uQ2hlY2tUaW1lcigxKSx0aGlzLl9jaGVja05leHRQaW5nKCkpfX0se2tleTpcIm9uRXJyb3JDb2RlTm90WmVyb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZ2V0TW9kdWxlKHpuKS5vbkVycm9yQ29kZU5vdFplcm8oZSl9fSx7a2V5Olwib25NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5nZXRNb2R1bGUoem4pLm9uTWVzc2FnZShlKX19LHtrZXk6XCJzZW5kXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3NvY2tldEhhbmRsZXI/dGhpcy5fcHJldmlvdXNTdGF0ZSE9PUUuTkVUX1NUQVRFX0NPTk5FQ1RFRCYmZS5oZWFkLnNlcnZjbWQuaW5jbHVkZXMoQnMpPyh0aGlzLnJlQ29ubmVjdCgpLHRoaXMuX3NlbmRMb2dWaWFIVFRQKGUpKTp0aGlzLl9zb2NrZXRIYW5kbGVyLnNlbmQoZSk6UHJvbWlzZS5yZWplY3QoKX19LHtrZXk6XCJfc2VuZExvZ1ZpYUhUVFBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1WLkhPU1QuQ1VSUkVOVC5TVEFUO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24obixvKXt2YXIgcz1cIlwiLmNvbmNhdCh0LFwiL3Y0L2ltb3BlbnN0YXQvdGltX3dlYl9yZXBvcnRfdjI/c2RrYXBwaWQ9XCIpLmNvbmNhdChlLmhlYWQuc2RrYXBwaWQsXCImcmVxdGltZT1cIikuY29uY2F0KERhdGUubm93KCkpLGE9SlNPTi5zdHJpbmdpZnkoZS5ib2R5KSxpPVwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLThcIjtpZihhZSlyZS5yZXF1ZXN0KHt1cmw6cyxkYXRhOmEsbWV0aG9kOlwiUE9TVFwiLHRpbWVvdXQ6M2UzLGhlYWRlcjp7XCJjb250ZW50LXR5cGVcIjppfSxzdWNjZXNzOmZ1bmN0aW9uKCl7bigpfSxmYWlsOmZ1bmN0aW9uKCl7byhuZXcgamEoe2NvZGU6aGEuTkVUV09SS19FUlJPUn0pKX19KTtlbHNle3ZhciByPW5ldyBYTUxIdHRwUmVxdWVzdCx1PXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ci5hYm9ydCgpLG8obmV3IGphKHtjb2RlOmhhLk5FVFdPUktfVElNRU9VVH0pKX0pLDNlMyk7ci5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXs0PT09ci5yZWFkeVN0YXRlJiYoY2xlYXJUaW1lb3V0KHUpLDIwMD09PXIuc3RhdHVzfHwzMDQ9PT1yLnN0YXR1cz9uKCk6byhuZXcgamEoe2NvZGU6aGEuTkVUV09SS19FUlJPUn0pKSl9LHIub3BlbihcIlBPU1RcIixzLCEwKSxyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LXR5cGVcIixpKSxyLnNlbmQoYSl9fSkpfX0se2tleTpcInNpbXBseVNlbmRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fc29ja2V0SGFuZGxlcj90aGlzLl9zb2NrZXRIYW5kbGVyLnNpbXBseVNlbmQoZSk6UHJvbWlzZS5yZWplY3QoKX19LHtrZXk6XCJvbk9wZW5cIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3BpbmcoKX19LHtrZXk6XCJvbkNsb3NlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9zb2NrZXRIYW5kbGVyJiYodGhpcy5fc29ja2V0SGFuZGxlci5nZXRSZWNvbm5lY3RGbGFnKCkmJnRoaXMuX2VtaXROZXRTdGF0ZUNoYW5nZUV2ZW50KEUuTkVUX1NUQVRFX0RJU0NPTk5FQ1RFRCkpO3RoaXMucmVDb25uZWN0KCl9fSx7a2V5Olwib25FcnJvclwiLHZhbHVlOmZ1bmN0aW9uKCl7YWUmJiFvZSYmdGhpcy5vdXRwdXRXYXJuaW5nKFwiRG9tYWluTmFtZUluTVBcIiksdGhpcy5fZW1pdE5ldFN0YXRlQ2hhbmdlRXZlbnQoRS5ORVRfU1RBVEVfRElTQ09OTkVDVEVEKX19LHtrZXk6XCJnZXRLZXlNYXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5nZXRNb2R1bGUoem4pLmdldEtleU1hcChlKX19LHtrZXk6XCJfb25BcHBIaWRlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9pc0FwcFNob3dpbmc9ITF9fSx7a2V5OlwiX29uQXBwU2hvd1wiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5faXNBcHBTaG93aW5nPSEwfX0se2tleTpcIm9uUmVxdWVzdFRpbWVvdXRcIix2YWx1ZTpmdW5jdGlvbihlKXt9fSx7a2V5Olwib25SZWNvbm5lY3RlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLm9uUmVjb25uZWN0ZWRcIikpLHRoaXMuX20ucmVzdGFydFRpbWVyKCksdGhpcy5nZXRNb2R1bGUoem4pLm9uUmVjb25uZWN0ZWQoKSx0aGlzLl9lbWl0TmV0U3RhdGVDaGFuZ2VFdmVudChFLk5FVF9TVEFURV9DT05ORUNURUQpfX0se2tleTpcIm9uUmVjb25uZWN0RmFpbGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIub25SZWNvbm5lY3RGYWlsZWRcIikpLHRoaXMuX2VtaXROZXRTdGF0ZUNoYW5nZUV2ZW50KEUuTkVUX1NUQVRFX0RJU0NPTk5FQ1RFRCl9fSx7a2V5Olwic2V0SXNXb3JrZXJFbmFibGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc29ja2V0SGFuZGxlciYmdGhpcy5fc29ja2V0SGFuZGxlci5zZXRJc1dvcmtlckVuYWJsZWQoITEpfX0se2tleTpcIm9mZmxpbmVcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2VtaXROZXRTdGF0ZUNoYW5nZUV2ZW50KEUuTkVUX1NUQVRFX0RJU0NPTk5FQ1RFRCl9fSx7a2V5OlwicmVDb25uZWN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXSYmYXJndW1lbnRzWzBdLHQ9ITE7dGhpcy5fc29ja2V0SGFuZGxlciYmKHQ9dGhpcy5fc29ja2V0SGFuZGxlci5nZXRSZWNvbm5lY3RGbGFnKCkpO3ZhciBuPVwiZm9yY2VkRmxhZzpcIi5jb25jYXQoZSxcIiBmYXRhbEVycm9yRmxhZzpcIikuY29uY2F0KHRoaXMuX2ZhdGFsRXJyb3JGbGFnLFwiIHByZXZpb3VzU3RhdGU6XCIpLmNvbmNhdCh0aGlzLl9wcmV2aW91c1N0YXRlLFwiIHJlY29ubmVjdEZsYWc6XCIpLmNvbmNhdCh0KTtpZihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVDb25uZWN0IFwiKS5jb25jYXQobikpLCF0aGlzLl9mYXRhbEVycm9yRmxhZyYmdGhpcy5fc29ja2V0SGFuZGxlcil7aWYoITA9PT1lKXRoaXMuX3NvY2tldEhhbmRsZXIuZm9yY2VkUmVjb25uZWN0KCk7ZWxzZXtpZih0aGlzLl9wcmV2aW91c1N0YXRlPT09RS5ORVRfU1RBVEVfQ09OTkVDVElORyYmdClyZXR1cm47dGhpcy5fc29ja2V0SGFuZGxlci5mb3JjZWRSZWNvbm5lY3QoKX10aGlzLl9lbWl0TmV0U3RhdGVDaGFuZ2VFdmVudChFLk5FVF9TVEFURV9DT05ORUNUSU5HKX19fSx7a2V5OlwiX2VtaXROZXRTdGF0ZUNoYW5nZUV2ZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcHJldmlvdXNTdGF0ZSE9PWUmJihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2VtaXROZXRTdGF0ZUNoYW5nZUV2ZW50IGZyb20gXCIpLmNvbmNhdCh0aGlzLl9wcmV2aW91c1N0YXRlLFwiIHRvIFwiKS5jb25jYXQoZSkpLHRoaXMuX3ByZXZpb3VzU3RhdGU9ZSx0aGlzLmVtaXRPdXRlckV2ZW50KGsuTkVUX1NUQVRFX0NIQU5HRSx7c3RhdGU6ZX0pKX19LHtrZXk6XCJfcGluZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztpZighMCE9PXRoaXMuX3Byb2Jpbmcpe3RoaXMuX3Byb2Jpbmc9ITA7dmFyIHQ9dGhpcy5nZXRNb2R1bGUoem4pLmdldFByb3RvY29sRGF0YSh7cHJvdG9jb2xOYW1lOkhzfSk7dGhpcy5zZW5kKHQpLnRoZW4oKGZ1bmN0aW9uKCl7ZS5fcHJvYmluZz0hMX0pKS5jYXRjaCgoZnVuY3Rpb24odCl7aWYoVmUudyhcIlwiLmNvbmNhdChlLl9uLFwiLl9waW5nIGZhaWxlZC4gZXJyb3I6XCIpLHQpLGUuX3Byb2Jpbmc9ITEsdCYmNjAwMDI9PT10LmNvZGUpcmV0dXJuIG5ldyBBYShcImVycm9yXCIpLnNldE1lc3NhZ2UoXCJjb2RlOlwiLmNvbmNhdCh0LmNvZGUsXCIgbWVzc2FnZTpcIikuY29uY2F0KHQubWVzc2FnZSkpLnNldE5ldHdvcmtUeXBlKGUuZ2V0TW9kdWxlKEhuKS5nZXROZXR3b3JrVHlwZSgpKS5lbmQoKSxlLl9mYXRhbEVycm9yRmxhZz0hMCx2b2lkIGUuX2VtaXROZXRTdGF0ZUNoYW5nZUV2ZW50KEUuTkVUX1NUQVRFX0RJU0NPTk5FQ1RFRCk7ZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtWZS5sKFwiXCIuY29uY2F0KGUuX24sXCIuX3BpbmcgZmFpbGVkLiBwcm9iZSBuZXR3b3JrLCBpc0FwcFNob3dpbmc6XCIpLmNvbmNhdChlLl9pc0FwcFNob3dpbmcsXCIgb25saW5lOlwiKS5jb25jYXQobyxcIiBuZXR3b3JrVHlwZTpcIikuY29uY2F0KHMpKSxvP2UucmVDb25uZWN0KCk6ZS5fZW1pdE5ldFN0YXRlQ2hhbmdlRXZlbnQoRS5ORVRfU1RBVEVfRElTQ09OTkVDVEVEKX0pKX0pKX19fSx7a2V5OlwiX2NoZWNrTmV4dFBpbmdcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3NvY2tldEhhbmRsZXImJih0aGlzLl9zb2NrZXRIYW5kbGVyLmlzQ29ubmVjdGVkKCkmJkRhdGUubm93KCk+PXRoaXMuX3NvY2tldEhhbmRsZXIuZ2V0TmV4dFBpbmdUcygpJiZ0aGlzLl9waW5nKCkpfX0se2tleTpcImNhbklVc2VJbmZsYXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbS5jYW5JVXNlSW5mbGF0ZSgpfX0se2tleTpcImRlYWxsb2NcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3NvY2tldEhhbmRsZXImJih0aGlzLl9zb2NrZXRIYW5kbGVyLmNsb3NlKCksdGhpcy5fc29ja2V0SGFuZGxlcj1udWxsKSx0aGlzLl90aW1lckZvck5vdExvZ2dlZEluPi0xJiZjbGVhckludGVydmFsKHRoaXMuX3RpbWVyRm9yTm90TG9nZ2VkSW4pfX0se2tleTpcIm9uUmVzdEFwaUtpY2tlZE91dFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fc29ja2V0SGFuZGxlciYmKHRoaXMuX3NvY2tldEhhbmRsZXIuY2xvc2UoKSx0aGlzLnJlQ29ubmVjdCghMCkpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX3ByZXZpb3VzU3RhdGU9RS5ORVRfU1RBVEVfQ09OTkVDVEVELHRoaXMuX3Byb2Jpbmc9ITEsdGhpcy5fZmF0YWxFcnJvckZsYWc9ITEsdGhpcy5fdGltZXJGb3JOb3RMb2dnZWRJbj1zZXRJbnRlcnZhbCh0aGlzLm9uQ2hlY2tUaW1lci5iaW5kKHRoaXMpLDFlMyl9fV0pLG59KHVvKSxCcj1bXCJhMlwiLFwidGlueWlkXCJdLEhyPVtcImEyXCIsXCJ0aW55aWRcIl0sS3I9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9uPVwiUHJvdG9jb2xIYW5kbGVyXCIsdGhpcy5fc2Vzc2lvbk1vZHVsZT10LHRoaXMuX2NvbmZpZ01hcD1uZXcgTWFwLHRoaXMuX2ZpbGxDb25maWdNYXAoKX1yZXR1cm4gYShlLFt7a2V5OlwiX2ZpbGxDb25maWdNYXBcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2NvbmZpZ01hcC5jbGVhcigpO3ZhciBlPXRoaXMuX3Nlc3Npb25Nb2R1bGUuZ2VuQ29tbW9uSGVhZCgpLG49dGhpcy5fc2Vzc2lvbk1vZHVsZS5nZW5Db3NTcGVjaWZpZWRIZWFkKCksbz10aGlzLl9zZXNzaW9uTW9kdWxlLmdlblNTT1JlcG9ydEhlYWQoKSxzPXRoaXMuX3Nlc3Npb25Nb2R1bGUuaXNJbnRsKCk7dGhpcy5fY29uZmlnTWFwLnNldChjbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLklNX09QRU5fU1RBVFVTLFwiLlwiKS5jb25jYXQoVi5DTUQuTE9HSU4pfSksYm9keTp7c3RhdGU6XCJPbmxpbmVcIixpc1dlYlVuaWFwcDowLGRldmljZUJyYW5kOjB9LGtleU1hcDp7cmVxdWVzdDp7ZGV2aWNlQnJhbmQ6XCJJbnN0VHlwZVwifSxyZXNwb25zZTp7SW5zdElkOlwiaW5zdGFuY2VJRFwiLEhlbGxvSW50ZXJ2YWw6XCJoZWxsb0ludGVydmFsXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGxvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuSU1fT1BFTl9TVEFUVVMsXCIuXCIpLmNvbmNhdChWLkNNRC5MT0dPVVQpfSksYm9keTp7dHlwZTowfSxrZXlNYXA6e3JlcXVlc3Q6e3R5cGU6XCJ3c2xvZ291dF90eXBlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHBvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuSU1fT1BFTl9TVEFUVVMsXCIuXCIpLmNvbmNhdChWLkNNRC5IRUxMTyl9KSxib2R5Ontpc1dlYlVuaWFwcDowfSxrZXlNYXA6e3Jlc3BvbnNlOntOZXdJbnN0SW5mbzpcIm5ld0luc3RhbmNlSW5mb1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChnbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlNUQVRfU0VSVklDRSxcIi5cIikuY29uY2F0KFYuQ01ELktJQ0tfT1RIRVIpfSksYm9keTp7fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHFzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuSU1fQ09TX1NJR04sXCIuXCIpLmNvbmNhdChWLkNNRC5DT1NfU0lHTil9KSxib2R5OntjbWQ6XCJvcGVuX2ltX2Nvc19zdmNcIixzdWJDbWQ6XCJnZXRfY29zX3Rva2VuXCIsZHVyYXRpb246MzAwLHZlcnNpb246Mn0sa2V5TWFwOntyZXF1ZXN0Ont1c2VyU2lnOlwidXNlcnNpZ1wiLHN1YkNtZDpcInN1Yl9jbWRcIixjbWQ6XCJjbWRcIixkdXJhdGlvbjpcImR1cmF0aW9uXCIsdmVyc2lvbjpcInZlcnNpb25cIn0scmVzcG9uc2U6e2V4cGlyZWRfdGltZTpcImV4cGlyZWRUaW1lXCIsYnVja2V0X25hbWU6XCJidWNrZXROYW1lXCIsc2Vzc2lvbl90b2tlbjpcInNlc3Npb25Ub2tlblwiLHRtcF9zZWNyZXRfaWQ6XCJzZWNyZXRJZFwiLHRtcF9zZWNyZXRfa2V5Olwic2VjcmV0S2V5XCJ9fX19KG4pKSx0aGlzLl9jb25maWdNYXAuc2V0KHhzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuQ1VTVE9NX1VQTE9BRCxcIi5cIikuY29uY2F0KFYuQ01ELkNPU19QUkVfU0lHKX0pLGJvZHk6e2ZpbGVUeXBlOnZvaWQgMCxmaWxlTmFtZTp2b2lkIDAsdXBsb2FkTWV0aG9kOjAsZHVyYXRpb246OTAwfSxrZXlNYXA6e3JlcXVlc3Q6e3VzZXJTaWc6XCJ1c2Vyc2lnXCIsZmlsZVR5cGU6XCJmaWxlX3R5cGVcIixmaWxlTmFtZTpcImZpbGVfbmFtZVwiLHVwbG9hZE1ldGhvZDpcInVwbG9hZF9tZXRob2RcIn0scmVzcG9uc2U6e2V4cGlyZWRfdGltZTpcImV4cGlyZWRUaW1lXCIscmVxdWVzdF9pZDpcInJlcXVlc3RJZFwiLGhlYWRfdXJsOlwiaGVhZFVybFwiLHVwbG9hZF91cmw6XCJ1cGxvYWRVcmxcIixkb3dubG9hZF91cmw6XCJkb3dubG9hZFVybFwiLGNpX3VybDpcImNpVXJsXCIsc25hcHNob3RfdXJsOlwicmVxdWVzdFNuYXBzaG90VXJsXCJ9fX19KG4pKSx0aGlzLl9jb25maWdNYXAuc2V0KFZzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuQ1VTVE9NX1VQTE9BRCxcIi5cIikuY29uY2F0KFYuQ01ELlZJREVPX0NPVkVSKX0pLGJvZHk6e3ZlcnNpb246MSxwbGF0Zm9ybTp2b2lkIDAsY292ZXJOYW1lOnZvaWQgMCxyZXF1ZXN0U25hcHNob3RVcmw6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e3ZlcnNpb246XCJ2ZXJzaW9uXCIscGxhdGZvcm06XCJwbGF0Zm9ybVwiLGNvdmVyTmFtZTpcImNvdmVyX25hbWVcIixyZXF1ZXN0U25hcHNob3RVcmw6XCJzbmFwc2hvdF91cmxcIn0scmVzcG9uc2U6e2Vycm9yX2NvZGU6XCJlcnJvckNvZGVcIixlcnJvcl9tc2c6XCJlcnJvckluZm9cIixkb3dubG9hZF91cmw6XCJzbmFwc2hvdFVybFwifX19fShuKSksdGhpcy5fY29uZmlnTWFwLnNldChRcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLklNX0NPTkZJR19NQU5BR0VSLFwiLlwiKS5jb25jYXQoVi5DTUQuRkVUQ0hfQ09NTUVSQ0lBTF9DT05GSUcpfSksYm9keTp7U0RLQXBwSUQ6MH0sa2V5TWFwOntyZXF1ZXN0OntTREtBcHBJRDpcInVpbnQzMl9zZGthcHBpZFwifSxyZXNwb25zZTp7aW50MzJfZXJyb3JfY29kZTpcImVycm9yQ29kZVwiLHN0cl9lcnJvcl9tZXNzYWdlOlwiZXJyb3JNZXNzYWdlXCIsc3RyX3B1cmNoYXNlX2JpdHM6XCJwdXJjaGFzZUJpdHNcIix1aW50MzJfZXhwaXJlZF90aW1lOlwiZXhwaXJlZFRpbWVcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoJHMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9DT05GSUdfTUFOQUdFUixcIi5cIikuY29uY2F0KFYuQ01ELlBVU0hFRF9DT01NRVJDSUFMX0NPTkZJRyl9KSxib2R5Ont9LGtleU1hcDp7cmVzcG9uc2U6e2ludDMyX2Vycm9yX2NvZGU6XCJlcnJvckNvZGVcIixzdHJfZXJyb3JfbWVzc2FnZTpcImVycm9yTWVzc2FnZVwiLHN0cl9wdXJjaGFzZV9iaXRzOlwicHVyY2hhc2VCaXRzXCIsdWludDMyX2V4cGlyZWRfdGltZTpcImV4cGlyZWRUaW1lXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFhzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuSU1fQ09ORklHX01BTkFHRVIsXCIuXCIpLmNvbmNhdChWLkNNRC5GRVRDSF9DTE9VRF9DT05UUk9MX0NPTkZJRyl9KSxib2R5OntTREtBcHBJRDowLHZlcnNpb246MH0sa2V5TWFwOntyZXF1ZXN0OntTREtBcHBJRDpcInVpbnQzMl9zZGthcHBpZFwiLHZlcnNpb246XCJ1aW50NjRfdmVyc2lvblwifSxyZXNwb25zZTp7aW50MzJfZXJyb3JfY29kZTpcImVycm9yQ29kZVwiLHN0cl9lcnJvcl9tZXNzYWdlOlwiZXJyb3JNZXNzYWdlXCIsc3RyX2pzb25fY29uZmlnOlwiY2xvdWRDb250cm9sQ29uZmlnXCIsdWludDMyX2V4cGlyZWRfdGltZTpcImV4cGlyZWRUaW1lXCIsdWludDMyX3Nka2FwcGlkOlwiU0RLQXBwSURcIix1aW50NjRfdmVyc2lvbjpcInZlcnNpb25cIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoWnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9DT05GSUdfTUFOQUdFUixcIi5cIikuY29uY2F0KFYuQ01ELlBVU0hFRF9DTE9VRF9DT05UUk9MX0NPTkZJRyl9KSxib2R5Ont9LGtleU1hcDp7cmVzcG9uc2U6e2ludDMyX2Vycm9yX2NvZGU6XCJlcnJvckNvZGVcIixzdHJfZXJyb3JfbWVzc2FnZTpcImVycm9yTWVzc2FnZVwiLHN0cl9qc29uX2NvbmZpZzpcImNsb3VkQ29udHJvbENvbmZpZ1wiLHVpbnQzMl9leHBpcmVkX3RpbWU6XCJleHBpcmVkVGltZVwiLHVpbnQzMl9zZGthcHBpZDpcIlNES0FwcElEXCIsdWludDY0X3ZlcnNpb246XCJ2ZXJzaW9uXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGVhLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1ZFUkxPQURfUFVTSCxcIi5cIikuY29uY2F0KFYuQ01ELk9WRVJMT0FEX05PVElGWSl9KSxib2R5Ont9LGtleU1hcDp7cmVzcG9uc2U6e092ZXJMb2FkU2VydkNtZDpcIm92ZXJsb2FkQ29tbWFuZFwiLERlbGF5U2VjczpcIndhaXRpbmdUaW1lXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGhvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9NRVNTQUdFUyl9KSxib2R5Ontjb29raWU6XCJcIixzeW5jRmxhZzowLG5lZWRBYnN0cmFjdDoxLGlzT25saW5lU3luYzowLG5lZWRTaWduYWxpbmc6MX0sa2V5TWFwOntyZXF1ZXN0Ontmcm9tQWNjb3VudDpcIkZyb21fQWNjb3VudFwiLHRvQWNjb3VudDpcIlRvX0FjY291bnRcIixmcm9tOlwiRnJvbV9BY2NvdW50XCIsdG86XCJUb19BY2NvdW50XCIsdGltZTpcIk1zZ1RpbWVTdGFtcFwiLHNlcXVlbmNlOlwiTXNnU2VxXCIscmFuZG9tOlwiTXNnUmFuZG9tXCIsZWxlbWVudHM6XCJNc2dCb2R5XCJ9LHJlc3BvbnNlOntNc2dMaXN0OlwibWVzc2FnZUxpc3RcIixTeW5jRmxhZzpcInN5bmNGbGFnXCIsVG9fQWNjb3VudDpcInRvXCIsRnJvbV9BY2NvdW50OlwiZnJvbVwiLENsaWVudFNlcTpcImNsaWVudFNlcXVlbmNlXCIsTXNnU2VxOlwic2VxdWVuY2VcIixOb3RpY2VTZXE6XCJub3RpY2VTZXF1ZW5jZVwiLE5vdGlmeVNlcTpcIm5vdGlmeVNlcXVlbmNlXCIsTXNnUmFuZG9tOlwicmFuZG9tXCIsTXNnVGltZVN0YW1wOlwidGltZVwiLE1zZ0NvbnRlbnQ6XCJjb250ZW50XCIsVG9Hcm91cElkOlwidG9cIixNc2dLZXk6XCJtZXNzYWdlS2V5XCIsR3JvdXBUaXBzOlwiZ3JvdXBUaXBzXCIsTXNnQm9keTpcImVsZW1lbnRzXCIsTXNnVHlwZTpcInR5cGVcIixDMkNSZW1haW5pbmdVbnJlYWRDb3VudDpcIkMyQ1JlbWFpbmluZ1VucmVhZExpc3RcIixDMkNQYWlyVW5yZWFkQ291bnQ6XCJDMkNQYWlyVW5yZWFkTGlzdFwifX19fShlKSksc3x8KHRoaXMuX2NvbmZpZ01hcC5zZXQoX28sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNLFwiLlwiKS5jb25jYXQoVi5DTUQuQklHX0RBVEFfSEFMTFdBWV9BVVRIX0tFWSl9KSxib2R5Ont9fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQocGEsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9NU0dfQVVESVRfTUdSLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX1JQT0ZBTklUWV9MSVNUKX0pLGJvZHk6e3ZlcnNpb246MCxkZXZpY2VJRDpcIlwiLHN0YXJ0SW5kZXg6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e3ZlcnNpb246XCJ1aW50NjRfdmVyc2lvblwiLGRldmljZUlEOlwic3RyX2RldmljZV9pZFwiLHN0YXJ0SW5kZXg6XCJ1aW50NjRfc3RhcnRfaW5kZXhcIn0scmVzcG9uc2U6e21zZ19jbWRfZXJyb3JfY29kZTpcImVycm9ySW5mb1wiLHN0cl9lcnJfbXNnOlwiZXJyb3JNZXNzYWdlXCIsdWludDMyX2NvZGU6XCJlcnJvckNvZGVcIixtc2dfc2NlbmVfY3RsX2NvbmZpZzpcImZpbHRlckNvbmZpZ1wiLHVpbnQ2NF9jMmNfY3VzdG9tX21zZ19mbGFnOlwiYzJjX2N1c3RvbV9tZXNzYWdlXCIsdWludDY0X2MyY190ZXh0X21zZ19mbGFnOlwiYzJjX3RleHRfbWVzc2FnZVwiLHVpbnQ2NF9ncm91cF9jdXN0b21fbXNnX2ZsYWc6XCJncm91cF9jdXN0b21fbWVzc2FnZVwiLHVpbnQ2NF9ncm91cF90ZXh0X21zZ19mbGFnOlwiZ3JvdXBfdGV4dF9tZXNzYWdlXCIsdWludDY0X2dyb3VwX2luZm9fZmxhZzpcImdyb3VwX3Byb2ZpbGVcIix1aW50NjRfZ3JvdXBfbWVtYmVyX2luZm9fZmxhZzpcImdyb3VwX21lbWJlcl9wcm9maWxlXCIsdWludDY0X3JlbGF0aW9uX2NoYWluX2ZsYWc6XCJzbnNcIix1aW50NjRfdXNlcl9pbmZvX2ZsYWc6XCJ1c2VyX3Byb2ZpbGVcIixycHRfbXNnX2RpcnR5X3dvcmQ6XCJsZXhpY29uXCIsc3RyX2RpcnR5X3dvcmQ6XCJwcm9mYW5pdHlcIixzdHJfcmVwbGFjZWRfY29udGVudDpcInJlcGxhY2VtZW50XCIsdWludDY0X2ZpbHRlcl90eXBlOlwiZmlsdGVyVHlwZVwiLHVpbnQ2NF9pZDpcImlkXCIsdWludDY0X3dvcmRfdHlwZTpcInByb2Zhbml0eVR5cGVcIix1aW50NjRfY29tcGxldGVfZmxhZzpcImNvbXBsZXRlRmxhZ1wiLHVpbnQ2NF9uZXh0X3N0YXJ0X2luZGV4OlwibmV4dFN0YXJ0SW5kZXhcIix1aW50NjRfdmVyc2lvbjpcInZlcnNpb25cIix1aW50NjRfZXhwaXJlZF90aW1lOlwiZXhwaXJlZFRpbWVcIn19fX0oZSkpKSx0aGlzLl9jb25maWdNYXAuc2V0KGZvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELlNFTkRfTUVTU0FHRSl9KSxib2R5Ontmcm9tQWNjb3VudDpcIlwiLHRvQWNjb3VudDpcIlwiLG1zZ1NlcTowLG1zZ1JhbmRvbTowLG1zZ0JvZHk6W10sY2xvdWRDdXN0b21EYXRhOnZvaWQgMCxuaWNrOlwiXCIsYXZhdGFyOlwiXCIsbXNnTGlmZVRpbWU6dm9pZCAwLG9mZmxpbmVQdXNoSW5mbzp7cHVzaEZsYWc6MCx0aXRsZTpcIlwiLGRlc2M6XCJcIixleHQ6XCJcIixhcG5zSW5mbzp7YmFkZ2VNb2RlOjAsaXNWb2lwUHVzaDp2b2lkIDB9LGFuZHJvaWRJbmZvOntPUFBPQ2hhbm5lbElEOlwiXCJ9fSxtZXNzYWdlQ29udHJvbEluZm86dm9pZCAwLGNsaWVudFRpbWU6dm9pZCAwLG5lZWRSZWFkUmVjZWlwdDowLGlzU3VwcG9ydEV4dGVuc2lvbjowfSxrZXlNYXA6e3JlcXVlc3Q6e2Zyb21BY2NvdW50OlwiRnJvbV9BY2NvdW50XCIsdG9BY2NvdW50OlwiVG9fQWNjb3VudFwiLG1zZ1RpbWVTdGFtcDpcIk1zZ1RpbWVTdGFtcFwiLG1zZ1NlcTpcIk1zZ1NlcVwiLG1zZ1JhbmRvbTpcIk1zZ1JhbmRvbVwiLG1zZ0JvZHk6XCJNc2dCb2R5XCIsY291bnQ6XCJNYXhDbnRcIixsYXN0TWVzc2FnZVRpbWU6XCJMYXN0TXNnVGltZVwiLG1lc3NhZ2VLZXk6XCJNc2dLZXlcIixwZWVyQWNjb3VudDpcIlBlZXJfQWNjb3VudFwiLGRhdGE6XCJEYXRhXCIsZGVzY3JpcHRpb246XCJEZXNjXCIsZXh0ZW5zaW9uOlwiRXh0XCIsdHlwZTpcIk1zZ1R5cGVcIixjb250ZW50OlwiTXNnQ29udGVudFwiLHNpemVUeXBlOlwiVHlwZVwiLHV1aWQ6XCJVVUlEXCIsdXJsOlwiXCIsaW1hZ2VVcmw6XCJVUkxcIixmaWxlVXJsOlwiVXJsXCIscmVtb3RlQXVkaW9Vcmw6XCJVcmxcIixyZW1vdGVWaWRlb1VybDpcIlZpZGVvVXJsXCIsdGh1bWJVVUlEOlwiVGh1bWJVVUlEXCIsdmlkZW9VVUlEOlwiVmlkZW9VVUlEXCIsdmlkZW9Vcmw6XCJcIixkb3dubG9hZEZsYWc6XCJEb3dubG9hZF9GbGFnXCIsbmljazpcIkZyb21fQWNjb3VudE5pY2tcIixhdmF0YXI6XCJGcm9tX0FjY291bnRIZWFkdXJsXCIsZnJvbTpcIkZyb21fQWNjb3VudFwiLHRpbWU6XCJNc2dUaW1lU3RhbXBcIixtZXNzYWdlUmFuZG9tOlwiTXNnUmFuZG9tXCIsbWVzc2FnZVNlcXVlbmNlOlwiTXNnU2VxXCIsZWxlbWVudHM6XCJNc2dCb2R5XCIsY2xpZW50U2VxdWVuY2U6XCJDbGllbnRTZXFcIixwYXlsb2FkOlwiTXNnQ29udGVudFwiLG1lc3NhZ2VMaXN0OlwiTXNnTGlzdFwiLG1lc3NhZ2VOdW1iZXI6XCJNc2dOdW1cIixhYnN0cmFjdExpc3Q6XCJBYnN0cmFjdExpc3RcIixtZXNzYWdlQm9keTpcIk1zZ0JvZHlcIixuZWVkUmVhZFJlY2VpcHQ6XCJJc05lZWRSZWFkUmVjZWlwdFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldCh2byxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuU0VORF9HUk9VUF9NRVNTQUdFKX0pLGJvZHk6e2Zyb21BY2NvdW50OlwiXCIsZ3JvdXBJRDpcIlwiLHJhbmRvbTowLGNsaWVudFNlcXVlbmNlOjAscHJpb3JpdHk6XCJcIixtc2dCb2R5OltdLGNsb3VkQ3VzdG9tRGF0YTp2b2lkIDAsb25saW5lT25seUZsYWc6MCxvZmZsaW5lUHVzaEluZm86e3B1c2hGbGFnOjAsdGl0bGU6XCJcIixkZXNjOlwiXCIsZXh0OlwiXCIsYXBuc0luZm86e2JhZGdlTW9kZTowLGlzVm9pcFB1c2g6dm9pZCAwfSxhbmRyb2lkSW5mbzp7T1BQT0NoYW5uZWxJRDpcIlwifX0sZ3JvdXBBdEluZm86W10sbWVzc2FnZUNvbnRyb2xJbmZvOnZvaWQgMCxjbGllbnRUaW1lOnZvaWQgMCxuZWVkUmVhZFJlY2VpcHQ6MCx0b3BpY0lEOnZvaWQgMCxyZWNlaXZlckxpc3Q6dm9pZCAwLGlzU3VwcG9ydEV4dGVuc2lvbjowfSxrZXlNYXA6e3JlcXVlc3Q6e3RvOlwiR3JvdXBJZFwiLGV4dGVuc2lvbjpcIkV4dFwiLGRhdGE6XCJEYXRhXCIsZGVzY3JpcHRpb246XCJEZXNjXCIscmFuZG9tOlwiUmFuZG9tXCIsc2VxdWVuY2U6XCJSZXFNc2dTZXFcIixjb3VudDpcIlJlcU1zZ051bWJlclwiLHR5cGU6XCJNc2dUeXBlXCIscHJpb3JpdHk6XCJNc2dQcmlvcml0eVwiLGNvbnRlbnQ6XCJNc2dDb250ZW50XCIsZWxlbWVudHM6XCJNc2dCb2R5XCIsc2l6ZVR5cGU6XCJUeXBlXCIsdXVpZDpcIlVVSURcIix1cmw6XCJcIixpbWFnZVVybDpcIlVSTFwiLGZpbGVVcmw6XCJVcmxcIixyZW1vdGVBdWRpb1VybDpcIlVybFwiLHJlbW90ZVZpZGVvVXJsOlwiVmlkZW9VcmxcIix0aHVtYlVVSUQ6XCJUaHVtYlVVSURcIix2aWRlb1VVSUQ6XCJWaWRlb1VVSURcIix2aWRlb1VybDpcIlwiLGRvd25sb2FkRmxhZzpcIkRvd25sb2FkX0ZsYWdcIixjbGllbnRTZXF1ZW5jZTpcIkNsaWVudFNlcVwiLGZyb206XCJGcm9tX0FjY291bnRcIix0aW1lOlwiTXNnVGltZVN0YW1wXCIsbWVzc2FnZVJhbmRvbTpcIk1zZ1JhbmRvbVwiLG1lc3NhZ2VTZXF1ZW5jZTpcIk1zZ1NlcVwiLHBheWxvYWQ6XCJNc2dDb250ZW50XCIsbWVzc2FnZUxpc3Q6XCJNc2dMaXN0XCIsbWVzc2FnZU51bWJlcjpcIk1zZ051bVwiLGFic3RyYWN0TGlzdDpcIkFic3RyYWN0TGlzdFwiLG1lc3NhZ2VCb2R5OlwiTXNnQm9keVwiLG5lZWRSZWFkUmVjZWlwdDpcIk5lZWRSZWFkUmVjZWlwdFwiLHJlY2VpdmVyTGlzdDpcIlRvX0FjY291bnRcIn0scmVzcG9uc2U6e01zZ1RpbWU6XCJ0aW1lXCIsTXNnU2VxOlwic2VxdWVuY2VcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoVG8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNLFwiLlwiKS5jb25jYXQoVi5DTUQuUkVWT0tFX0MyQ19NRVNTQUdFKX0pLGJvZHk6e21zZ0luZm86e2Zyb21BY2NvdW50OlwiXCIsdG9BY2NvdW50OlwiXCIsbXNnVGltZVN0YW1wOjAsbXNnU2VxOjAsbXNnUmFuZG9tOjB9fSxrZXlNYXA6e3JlcXVlc3Q6e21zZ0luZm86XCJNc2dJbmZvXCIsbXNnVGltZVN0YW1wOlwiTXNnVGltZVN0YW1wXCIsbXNnU2VxOlwiTXNnU2VxXCIsbXNnUmFuZG9tOlwiTXNnUmFuZG9tXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGlzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5SRVZPS0VfR1JPVVBfTUVTU0FHRSl9KSxib2R5Ontncm91cElEOlwiXCIsbXNnU2VxTGlzdDp2b2lkIDAsdG9waWNJRDpcIlwifSxrZXlNYXA6e3JlcXVlc3Q6e21zZ1NlcUxpc3Q6XCJNc2dTZXFMaXN0XCIsbXNnU2VxOlwiTXNnU2VxXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFNvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9DMkNfUk9BTV9NRVNTQUdFUyl9KSxib2R5OntwZWVyQWNjb3VudDpcIlwiLGNvdW50OjE1LGxhc3RNZXNzYWdlVGltZTowLG1lc3NhZ2VLZXk6XCJcIix3aXRoUmVjYWxsZWRNZXNzYWdlOjEsZGlyZWN0aW9uOjB9LGtleU1hcDp7cmVxdWVzdDp7bWVzc2FnZUtleTpcIk1zZ0tleVwiLHBlZXJBY2NvdW50OlwiUGVlcl9BY2NvdW50XCIsY291bnQ6XCJNYXhDbnRcIixsYXN0TWVzc2FnZVRpbWU6XCJMYXN0TXNnVGltZVwiLHdpdGhSZWNhbGxlZE1lc3NhZ2U6XCJXaXRoUmVjYWxsZWRNc2dcIixkaXJlY3Rpb246XCJHZXREaXJlY3Rpb25cIn0scmVzcG9uc2U6e0xhc3RNc2dUaW1lOlwibGFzdE1lc3NhZ2VUaW1lXCIsSXNOZWVkUmVhZFJlY2VpcHQ6XCJuZWVkUmVhZFJlY2VpcHRcIixJc1BlZXJSZWFkOlwicmVhZFJlY2VpcHRTZW50QnlQZWVyXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFJvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELk1PRElGWV9DMkNfTUVTU0FHRSl9KSxib2R5Ontmcm9tOlwiXCIsdG86XCJcIixzZXF1ZW5jZTowLHJhbmRvbTowLHRpbWU6MCx2ZXJzaW9uOjAsZWxlbWVudHM6dm9pZCAwLGNsb3VkQ3VzdG9tRGF0YTp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7c2VxdWVuY2U6XCJNc2dTZXFcIixyYW5kb206XCJNc2dSYW5kb21cIix0aW1lOlwiTXNnVGltZVwiLHZlcnNpb246XCJNc2dWZXJzaW9uXCIsdHlwZTpcIk1zZ1R5cGVcIixjb250ZW50OlwiTXNnQ29udGVudFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChjcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX0dST1VQX1JPQU1fTUVTU0FHRVMpfSksYm9keTp7d2l0aFJlY2FsbGVkTXNnOjEsZ3JvdXBJRDpcIlwiLGNvdW50OjE1LHNlcXVlbmNlOlwiXCIsdG9waWNJRDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7c2VxdWVuY2U6XCJSZXFNc2dTZXFcIixjb3VudDpcIlJlcU1zZ051bWJlclwiLHdpdGhSZWNhbGxlZE1lc3NhZ2U6XCJXaXRoUmVjYWxsZWRNc2dcIn0scmVzcG9uc2U6e1JhbmRvbTpcInJhbmRvbVwiLE1zZ1RpbWU6XCJ0aW1lXCIsTXNnU2VxOlwic2VxdWVuY2VcIixSZXFNc2dTZXE6XCJzZXF1ZW5jZVwiLFJzcE1zZ0xpc3Q6XCJtZXNzYWdlTGlzdFwiLElzUGxhY2VNc2c6XCJpc1BsYWNlTWVzc2FnZVwiLElzU3lzdGVtTXNnOlwiaXNTeXN0ZW1NZXNzYWdlXCIsVG9Hcm91cElkOlwidG9cIixFbnVtRnJvbV9BY2NvdW50VHlwZTpcImZyb21BY2NvdW50VHlwZVwiLEVudW1Ub19BY2NvdW50VHlwZTpcInRvQWNjb3VudFR5cGVcIixHcm91cENvZGU6XCJncm91cENvZGVcIixNc2dQcmlvcml0eTpcInByaW9yaXR5XCIsTXNnQm9keTpcImVsZW1lbnRzXCIsTXNnVHlwZTpcInR5cGVcIixNc2dDb250ZW50OlwiY29udGVudFwiLElzRmluaXNoZWQ6XCJjb21wbGV0ZVwiLERvd25sb2FkX0ZsYWc6XCJkb3dubG9hZEZsYWdcIixDbGllbnRTZXE6XCJjbGllbnRTZXF1ZW5jZVwiLFRodW1iVVVJRDpcInRodW1iVVVJRFwiLFZpZGVvVVVJRDpcInZpZGVvVVVJRFwiLFRvVG9waWNJZDpcInRvcGljSURcIixJbnZpc2libGVNc2dTZXE6XCJpbnZpc2libGVTZXF1ZW5jZUxpc3RcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoRG8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNLFwiLlwiKS5jb25jYXQoVi5DTUQuU0VUX0MyQ19NRVNTQUdFX1JFQUQpfSksYm9keTp7QzJDTXNnUmVhZGVkOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OntsYXN0TWVzc2FnZVRpbWU6XCJMYXN0ZWRNc2dUaW1lXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGtvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELlNFVF9DMkNfUEVFUl9NVVRFX05PVElGSUNBVElPTlMpfSksYm9keTp7dXNlcklETGlzdDp2b2lkIDAsbXV0ZUZsYWc6MH0sa2V5TWFwOntyZXF1ZXN0Ont1c2VySURMaXN0OlwiUGVlcl9BY2NvdW50XCIsbXV0ZUZsYWc6XCJNdXRlX05vdGlmaWNhdGlvbnNcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoRW8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX0MyQ19QRUVSX01VVEVfTk9USUZJQ0FUSU9OUyl9KSxib2R5Ont1cGRhdGVTZXF1ZW5jZTowfSxrZXlNYXA6e3Jlc3BvbnNlOntNdXRlTm90aWZpY2F0aW9uc0xpc3Q6XCJtdXRlRmxhZ0xpc3RcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQocnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELlNFVF9HUk9VUF9NRVNTQUdFX1JFQUQpfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsbWVzc2FnZVJlYWRTZXE6dm9pZCAwLHRvcGljSUQ6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e21lc3NhZ2VSZWFkU2VxOlwiTXNnUmVhZGVkU2VxXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHVzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELlNFVF9BTExfTUVTU0FHRV9SRUFEKX0pLGJvZHk6e3JlYWRBbGxDMkNNZXNzYWdlOjAsZ3JvdXBNZXNzYWdlUmVhZEluZm9MaXN0OltdfSxrZXlNYXA6e3JlcXVlc3Q6e3JlYWRBbGxDMkNNZXNzYWdlOlwiQzJDUmVhZEFsbE1zZ1wiLGdyb3VwTWVzc2FnZVJlYWRJbmZvTGlzdDpcIkdyb3VwUmVhZEluZm9cIixtZXNzYWdlU2VxdWVuY2U6XCJNc2dTZXFcIn0scmVzcG9uc2U6e0MyQ1JlYWRBbGxNc2c6XCJyZWFkQWxsQzJDTWVzc2FnZVwiLEdyb3VwUmVhZEluZm9BcnJheTpcImdyb3VwTWVzc2FnZVJlYWRJbmZvTGlzdFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChBbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLk9QRU5fSU0sXCIuXCIpLmNvbmNhdChWLkNNRC5ERUxFVEVfQzJDX01FU1NBR0UpfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIix0bzpcIlwiLGtleUxpc3Q6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e2tleUxpc3Q6XCJNc2dLZXlMaXN0XCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KE1zLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5ERUxFVEVfR1JPVVBfTUVTU0FHRSl9KSxib2R5Ontncm91cElEOlwiXCIsZGVsZXRlcjpcIlwiLGtleUxpc3Q6dm9pZCAwLHRvcGljSUQ6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e2RlbGV0ZXI6XCJEZWxldGVyX0FjY291bnRcIixrZXlMaXN0OlwiU2Vxc1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChnYSxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLklNX09QRU5fVFJBTlNMQVRFLFwiLlwiKS5jb25jYXQoVi5DTUQuVFJBTlNMQVRFX1RFWFQpfSksYm9keTp7c291cmNlVGV4dExpc3Q6dm9pZCAwLFNES0FwcElEOjAsZnJvbTowLHNvdXJjZTpcIlwiLHRhcmdldDpcIlwifSxrZXlNYXA6e3JlcXVlc3Q6e3NvdXJjZVRleHRMaXN0OlwiU291cmNlVGV4dFwiLFNES0FwcElEOlwiU2RrQXBwSWRcIixmcm9tOlwiRnJvbUFjY291bnRcIn0scmVzcG9uc2U6e1RhcmdldFRleHQ6XCJ0cmFuc2xhdGVkVGV4dExpc3RcIixSZXF1ZXN0SWQ6XCJyZXF1ZXN0SURcIixDbWRFcnJvckNvZGU6XCJlcnJvclwiLEVycm9yQ29kZTpcImNvZGVcIixFcnJvckluZm86XCJtZXNzYWdlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHlzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELk1PRElGWV9HUk9VUF9NRVNTQUdFKX0pLGJvZHk6e2dyb3VwSUQ6XCJcIix0b3BpY0lEOnZvaWQgMCxzZXF1ZW5jZTowLHZlcnNpb246MCxlbGVtZW50czp2b2lkIDAsY2xvdWRDdXN0b21EYXRhOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OntzZXF1ZW5jZTpcIk1zZ1NlcVwiLHZlcnNpb246XCJNc2dWZXJzaW9uXCIsdHlwZTpcIk1zZ1R5cGVcIixjb250ZW50OlwiTXNnQ29udGVudFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChscyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX1JFQURfUkVDRUlQVCl9KSxib2R5Ontncm91cElEOlwiXCIsc2VxdWVuY2VMaXN0OnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OntzZXF1ZW5jZTpcIk1zZ1NlcVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChwcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLk9QRU5fSU0sXCIuXCIpLmNvbmNhdChWLkNNRC5TRU5EX0MyQ19SRUFEX1JFQ0VJUFQpfSksYm9keTp7cGVlckFjY291bnQ6XCJcIixtZXNzYWdlSW5mb0xpc3Q6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e3BlZXJBY2NvdW50OlwiUGVlcl9BY2NvdW50XCIsbWVzc2FnZUluZm9MaXN0OlwiQzJDTXNnSW5mb1wiLGZyb21BY2NvdW50OlwiRnJvbV9BY2NvdW50XCIsdG9BY2NvdW50OlwiVG9fQWNjb3VudFwiLHNlcXVlbmNlOlwiTXNnU2VxXCIscmFuZG9tOlwiTXNnUmFuZG9tXCIsdGltZTpcIk1zZ1RpbWVcIixjbGllbnRUaW1lOlwiTXNnQ2xpZW50VGltZVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChkcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuU0VORF9SRUFEX1JFQ0VJUFQpfSksYm9keTp7Z3JvdXBJRDpcIlwiLHNlcXVlbmNlTGlzdDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7c2VxdWVuY2VMaXN0OlwiTXNnU2VxTGlzdFwiLHNlcXVlbmNlOlwiTXNnU2VxXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGdzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfUkVBRF9SRUNFSVBUX0RFVEFJTCl9KSxib2R5Ontncm91cElEOlwiXCIsc2VxdWVuY2U6dm9pZCAwLGZsYWc6MCxjdXJzb3I6MCxjb3VudDowfSxrZXlNYXA6e3JlcXVlc3Q6e3NlcXVlbmNlOlwiTXNnU2VxXCIsY291bnQ6XCJOdW1cIn0scmVzcG9uc2U6e1JlYWRMaXN0OlwicmVhZFVzZXJJRExpc3RcIixSZWFkX0FjY291bnQ6XCJ1c2VySURcIixVbnJlYWRMaXN0OlwidW5yZWFkVXNlcklETGlzdFwiLFVucmVhZF9BY2NvdW50OlwidXNlcklEXCIsSXNGaW5pc2g6XCJpc0NvbXBsZXRlZFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChObyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLk9QRU5fSU1fTVNHX0VYVCxcIi5cIikuY29uY2F0KFYuQ01ELk1PRElGWV9DMkNfTUVTU0FHRV9FWFRFTlNJT05TKX0pLGJvZHk6e2Zyb206dm9pZCAwLHRvOnZvaWQgMCxtZXNzYWdlS2V5OnZvaWQgMCxvcGVyYXRlVHlwZTp2b2lkIDAsZXh0ZW5zaW9uTGlzdDp2b2lkIDB9fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoT28sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNX01TR19FWFQsXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfQzJDX01FU1NBR0VfRVhURU5TSU9OUyl9KSxib2R5Ontmcm9tOnZvaWQgMCx0bzp2b2lkIDAsbWVzc2FnZUtleTp2b2lkIDAsc3RhcnRTZXF1ZW5jZTp2b2lkIDB9fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoRXMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNX01TR19FWFQsXCIuXCIpLmNvbmNhdChWLkNNRC5NT0RJRllfR1JPVVBfTUVTU0FHRV9FWFRFTlNJT05TKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLHRvcGljSUQ6dm9pZCAwLG1lc3NhZ2VTZXF1ZW5jZTp2b2lkIDAsb3BlcmF0ZVR5cGU6dm9pZCAwLGV4dGVuc2lvbkxpc3Q6dm9pZCAwfX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFNzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTV9NU0dfRVhULFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX0dST1VQX01FU1NBR0VfRVhURU5TSU9OUyl9KSxib2R5Ontncm91cElEOnZvaWQgMCx0b3BpY0lEOnZvaWQgMCxtZXNzYWdlU2VxdWVuY2U6dm9pZCAwLHN0YXJ0U2VxdWVuY2U6dm9pZCAwfX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KExvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9QRUVSX1JFQURfVElNRSl9KSxib2R5Ont1c2VySURMaXN0OnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont1c2VySURMaXN0OlwiVG9fQWNjb3VudFwifSxyZXNwb25zZTp7UmVhZFRpbWU6XCJwZWVyUmVhZFRpbWVMaXN0XCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFVvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuUkVDRU5UX0NPTlRBQ1QsXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfQ09OVkVSU0FUSU9OX0xJU1QpfSksYm9keTp7ZnJvbUFjY291bnQ6dm9pZCAwLGNvdW50OjB9LGtleU1hcDp7cmVxdWVzdDp7fSxyZXNwb25zZTp7U2Vzc2lvbkl0ZW06XCJjb252ZXJzYXRpb25zXCIsVG9BY2NvdW50OlwiZ3JvdXBJRFwiLFRvX0FjY291bnQ6XCJ1c2VySURcIixVbnJlYWRNc2dDb3VudDpcInVucmVhZENvdW50XCIsTXNnR3JvdXBSZWFkZWRTZXE6XCJtZXNzYWdlUmVhZFNlcVwiLEMyY1BlZXJSZWFkVGltZTpcImMyY1BlZXJSZWFkVGltZVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChHbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlJFQ0VOVF9DT05UQUNULFwiLlwiKS5jb25jYXQoVi5DTUQuUEFHSU5HX0dFVF9DT05WRVJTQVRJT05fTElTVCl9KSxib2R5Ontmcm9tQWNjb3VudDp2b2lkIDAsdGltZVN0YW1wOnZvaWQgMCxzdGFydEluZGV4OnZvaWQgMCxwaW5uZWRUaW1lU3RhbXA6dm9pZCAwLHBpbm5lZFN0YXJ0SW5kZXg6dm9pZCAwLG9yZGVyVHlwZTp2b2lkIDAsbWVzc2FnZUFzc2lzdEZsYWc6NCxhc3Npc3RGbGFnOjE1fSxrZXlNYXA6e3JlcXVlc3Q6e21lc3NhZ2VBc3Npc3RGbGFnOlwiTXNnQXNzaXN0RmxhZ3NcIixhc3Npc3RGbGFnOlwiQXNzaXN0RmxhZ3NcIixwaW5uZWRUaW1lU3RhbXA6XCJUb3BUaW1lU3RhbXBcIixwaW5uZWRTdGFydEluZGV4OlwiVG9wU3RhcnRJbmRleFwifSxyZXNwb25zZTp7U2Vzc2lvbkl0ZW06XCJjb252ZXJzYXRpb25zXCIsVG9BY2NvdW50OlwiZ3JvdXBJRFwiLFRvX0FjY291bnQ6XCJ1c2VySURcIixVbnJlYWRNc2dDb3VudDpcInVucmVhZENvdW50XCIsTXNnR3JvdXBSZWFkZWRTZXE6XCJtZXNzYWdlUmVhZFNlcVwiLEMyY1BlZXJSZWFkVGltZTpcImMyY1BlZXJSZWFkVGltZVwiLExhc3RNc2dGbGFnczpcImxhc3RNZXNzYWdlRmxhZ1wiLFRvcEZsYWdzOlwiaXNQaW5uZWRcIixUb3BUaW1lU3RhbXA6XCJwaW5uZWRUaW1lU3RhbXBcIixUb3BTdGFydEluZGV4OlwicGlubmVkU3RhcnRJbmRleFwiLEdyb3VwSWQ6XCJjb252R3JvdXBJRFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChQbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlJFQ0VOVF9DT05UQUNULFwiLlwiKS5jb25jYXQoVi5DTUQuREVMRVRFX0NPTlZFUlNBVElPTil9KSxib2R5Ontmcm9tQWNjb3VudDpcIlwiLGNvbnZlcnNhdGlvbkxpc3Q6dm9pZCAwLGNsZWFySGlzdG9yeU1lc3NhZ2U6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e3RvR3JvdXBJRDpcIlRvR3JvdXBpZFwiLGNsZWFySGlzdG9yeU1lc3NhZ2U6XCJDbGVhclJhbWJsZVwiLGNvbnZlcnNhdGlvbkxpc3Q6XCJDb250YWN0SXRlbVwifSxyZXNwb25zZTp7UmVzdWx0SXRlbTpcInJlc3VsdExpc3RcIixUb0dyb3VwaWQ6XCJncm91cElEXCIsUmVzdWx0Q29kZTpcImNvZGVcIixSZXN1bHRJbmZvOlwiaW5mb1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChibyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlJFQ0VOVF9DT05UQUNULFwiLlwiKS5jb25jYXQoVi5DTUQuQ0xFQVJfSElTVE9SWV9NRVNTQUdFKX0pLGJvZHk6e2Zyb21BY2NvdW50OlwiXCIsdG9BY2NvdW50OnZvaWQgMCx0eXBlOjEsdG9Hcm91cElEOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont0b0dyb3VwSUQ6XCJUb0dyb3VwaWRcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQod28sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5SRUNFTlRfQ09OVEFDVCxcIi5cIikuY29uY2F0KFYuQ01ELlBJTl9DT05WRVJTQVRJT04pfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIixvcGVyYXRpb25UeXBlOjEsaXRlbUxpc3Q6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e2l0ZW1MaXN0OlwiUmVjZW50Q29udGFjdEl0ZW1cIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoRm8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNLFwiLlwiKS5jb25jYXQoVi5DTUQuREVMRVRFX0dST1VQX0FUX1RJUFMpfSksYm9keTp7bWVzc2FnZUxpc3RUb0RlbGV0ZTp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7bWVzc2FnZUxpc3RUb0RlbGV0ZTpcIkRlbE1zZ0xpc3RcIixtZXNzYWdlU2VxOlwiTXNnU2VxXCIsbWVzc2FnZVJhbmRvbTpcIk1zZ1JhbmRvbVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChxbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlJFQ0VOVF9DT05UQUNULFwiLlwiKS5jb25jYXQoVi5DTUQuTUFSS19DT05WRVJTQVRJT04pfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIixpdGVtTGlzdDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7aXRlbUxpc3Q6XCJNYXJrSXRlbVwiLG9wZXJhdGlvblR5cGU6XCJPcHRUeXBlXCIsZ3JvdXBJRDpcIlRvR3JvdXBJZFwifSxyZXNwb25zZTp7VG9Hcm91cElkOlwiZ3JvdXBJRFwiLE9wdFR5cGU6XCJvcGVyYXRpb25UeXBlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHhvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuUkVDRU5UX0NPTlRBQ1QsXCIuXCIpLmNvbmNhdChWLkNNRC5NQVJLX0NPTlZFUlNBVElPTil9KSxib2R5Ontmcm9tQWNjb3VudDpcIlwiLGl0ZW1MaXN0OnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OntpdGVtTGlzdDpcIk1hcmtJdGVtXCIsb3BlcmF0aW9uVHlwZTpcIk9wdFR5cGVcIixncm91cElEOlwiVG9Hcm91cElkXCJ9LHJlc3BvbnNlOntUb0dyb3VwSWQ6XCJncm91cElEXCIsT3B0VHlwZTpcIm9wZXJhdGlvblR5cGVcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoVm8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5SRUNFTlRfQ09OVEFDVCxcIi5cIikuY29uY2F0KFYuQ01ELkNSRUFURV9DT05WRVJTQVRJT05fR1JPVVApfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIixpdGVtTGlzdDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7aXRlbUxpc3Q6XCJHcm91cENvbnRhY3RJdGVtXCIsZ3JvdXBJRDpcIlRvR3JvdXBJZFwifSxyZXNwb25zZTp7R3JvdXBJZDpcImNvbnZHcm91cElEXCIsVG9Hcm91cElkOlwiZ3JvdXBJRFwiLE9wdFR5cGU6XCJvcGVyYXRpb25UeXBlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KEJvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuUkVDRU5UX0NPTlRBQ1QsXCIuXCIpLmNvbmNhdChWLkNNRC5ERUxFVEVfQ09OVkVSU0FUSU9OX0dST1VQKX0pLGJvZHk6e2Zyb21BY2NvdW50OlwiXCIsZ3JvdXBOYW1lOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont9LHJlc3BvbnNlOntHcm91cElkOlwiY29udkdyb3VwSURcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoSG8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5SRUNFTlRfQ09OVEFDVCxcIi5cIikuY29uY2F0KFYuQ01ELlVQREFURV9DT05WRVJTQVRJT05fR1JPVVApfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIix1cGRhdGVUeXBlOnZvaWQgMCx1cGRhdGVHcm91cDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7b2xkTmFtZTpcIk9sZEdyb3VwTmFtZVwiLG5ld05hbWU6XCJOZXdHcm91cE5hbWVcIixncm91cElEOlwiVG9Hcm91cElkXCIsb3BlcmF0aW9uVHlwZTpcIkNvbnRhY3RPcHRUeXBlXCIsZ3JvdXBOYW1lOlwiT2xkR3JvdXBOYW1lXCIsdXBkYXRlSXRlbTpcIkNvbnRhY3RVcGRhdGVJdGVtXCJ9LHJlc3BvbnNlOntDb250YWN0T3B0VHlwZTpcIm9wZXJhdGlvblR5cGVcIixUb0dyb3VwSWQ6XCJncm91cElEXCIsR3JvdXBJZDpcImNvbnZHcm91cElEXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KEtvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuUkVDRU5UX0NPTlRBQ1QsXCIuXCIpLmNvbmNhdChWLkNNRC5VUERBVEVfQ09OVkVSU0FUSU9OX0dST1VQKX0pLGJvZHk6e2Zyb21BY2NvdW50OlwiXCIsdXBkYXRlVHlwZTp2b2lkIDAsdXBkYXRlR3JvdXA6e2dyb3VwTmFtZTp2b2lkIDAsdXBkYXRlR3JvdXBUeXBlOnZvaWQgMCx1cGRhdGVJdGVtOnZvaWQgMH19LGtleU1hcDp7cmVxdWVzdDp7fSxyZXNwb25zZTp7fX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChXbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlJFQ0VOVF9DT05UQUNULFwiLlwiKS5jb25jYXQoVi5DTUQuVVBEQVRFX0NPTlZFUlNBVElPTl9HUk9VUCl9KSxib2R5Ontmcm9tQWNjb3VudDpcIlwiLHVwZGF0ZVR5cGU6dm9pZCAwLHVwZGF0ZUdyb3VwOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont9LHJlc3BvbnNlOnt9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFlvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuUkVDRU5UX0NPTlRBQ1QsXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfQ09OVkVSU0FUSU9OX0dST1VQX0xJU1QpfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIixzdGFydFRpbWU6dm9pZCAwLHN0YXJ0SW5kZXg6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e30scmVzcG9uc2U6e0dyb3VwSWQ6XCJjb252R3JvdXBJRFwiLFRvR3JvdXBJZDpcImdyb3VwSURcIixPcHRUeXBlOlwib3BlcmF0aW9uVHlwZVwiLEN1c3RvbU1hcms6XCJjdXN0b21EYXRhXCIsQ29udGFjdEdyb3VwSWQ6XCJjb252R3JvdXBJRExpc3RcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQobW8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5QUk9GSUxFLFwiLlwiKS5jb25jYXQoVi5DTUQuUE9SVFJBSVRfR0VUKX0pLGJvZHk6e2Zyb21BY2NvdW50OlwiXCIsdXNlckl0ZW06W119LGtleU1hcDp7cmVxdWVzdDp7dG9BY2NvdW50OlwiVG9fQWNjb3VudFwiLHN0YW5kYXJkU2VxdWVuY2U6XCJTdGFuZGFyZFNlcXVlbmNlXCIsY3VzdG9tU2VxdWVuY2U6XCJDdXN0b21TZXF1ZW5jZVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChNbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLlBST0ZJTEUsXCIuXCIpLmNvbmNhdChWLkNNRC5QT1JUUkFJVF9TRVQpfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIixwcm9maWxlSXRlbTpbe3RhZzpIZS5OSUNLLHZhbHVlOlwiXCJ9LHt0YWc6SGUuR0VOREVSLHZhbHVlOlwiXCJ9LHt0YWc6SGUuQUxMT1dUWVBFLHZhbHVlOlwiXCJ9LHt0YWc6SGUuQVZBVEFSLHZhbHVlOlwiXCJ9XX0sa2V5TWFwOntyZXF1ZXN0Ont0b0FjY291bnQ6XCJUb19BY2NvdW50XCIsc3RhbmRhcmRTZXF1ZW5jZTpcIlN0YW5kYXJkU2VxdWVuY2VcIixjdXN0b21TZXF1ZW5jZTpcIkN1c3RvbVNlcXVlbmNlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHlvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuRlJJRU5ELFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX0JMQUNLTElTVCl9KSxib2R5Ontmcm9tQWNjb3VudDpcIlwiLHN0YXJ0SW5kZXg6MCxtYXhMaW1pdGVkOjMwLGxhc3RTZXF1ZW5jZTowfSxrZXlNYXA6e3Jlc3BvbnNlOntDdXJydWVudFNlcXVlbmNlOlwiY3VycmVudFNlcXVlbmNlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KElvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuRlJJRU5ELFwiLlwiKS5jb25jYXQoVi5DTUQuQUREX0JMQUNLTElTVCl9KSxib2R5Ontmcm9tQWNjb3VudDpcIlwiLHRvQWNjb3VudDpbXX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChDbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkZSSUVORCxcIi5cIikuY29uY2F0KFYuQ01ELkRFTEVURV9CTEFDS0xJU1QpfSksYm9keTp7ZnJvbUFjY291bnQ6XCJcIix0b0FjY291bnQ6W119fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoYWEsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVRVUyxcIi5cIikuY29uY2F0KFYuQ01ELlNFVF9TRUxGX1NUQVRVUyl9KSxib2R5OntjdXN0b21TdGF0dXM6XCJcIn0sa2V5TWFwOnt9fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoaWEsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVRVUyxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9VU0VSX1NUQVRVUyl9KSxib2R5Ont1c2VySURMaXN0OnZvaWQgMH0sa2V5TWFwOntyZXNwb25zZTp7VXNlclN0YXR1c0xpc3Q6XCJzdWNjZXNzVXNlckxpc3RcIixFcnJvckxpc3Q6XCJmYWlsdXJlVXNlckxpc3RcIixUb19BY2NvdW50OlwidXNlcklEXCIsSW52YWxpZF9BY2NvdW50OlwiaW52YWxpZFVzZXJJRFwiLFN0YXR1czpcInN0YXR1c1R5cGVcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQocmEsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVRVUyxcIi5cIikuY29uY2F0KFYuQ01ELlNVQlNDUklCRV9VU0VSX1NUQVRVUyl9KSxib2R5Ont1c2VySURMaXN0OnZvaWQgMH0sa2V5TWFwOntyZXNwb25zZTp7RXJyb3JMaXN0OlwiZmFpbHVyZVVzZXJMaXN0XCIsVG9fQWNjb3VudDpcInVzZXJJRFwiLEludmFsaWRfQWNjb3VudDpcImludmFsaWRVc2VySURcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQodWEsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVRVUyxcIi5cIikuY29uY2F0KFYuQ01ELlVOU1VCU0NSSUJFX1VTRVJfU1RBVFVTKX0pLGJvZHk6e3VzZXJJRExpc3Q6dm9pZCAwLHVuc3Vic2NyaWJlQWxsOnZvaWQgMH0sa2V5TWFwOntyZXNwb25zZTp7RXJyb3JMaXN0OlwiZmFpbHVyZVVzZXJMaXN0XCIsVG9fQWNjb3VudDpcInVzZXJJRFwiLEludmFsaWRfQWNjb3VudDpcImludmFsaWRVc2VySURcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoam8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9KT0lORURfR1JPVVBTKX0pLGJvZHk6e21lbWJlckFjY291bnQ6XCJcIixsaW1pdDp2b2lkIDAsb2Zmc2V0OnZvaWQgMCxncm91cFR5cGU6dm9pZCAwLHJlc3BvbnNlRmlsdGVyOntncm91cEJhc2VJbmZvRmlsdGVyOnZvaWQgMCxzZWxmSW5mb0ZpbHRlcjp2b2lkIDB9LGlzU3VwcG9ydFRvcGljOjB9LGtleU1hcDp7cmVxdWVzdDp7bWVtYmVyQWNjb3VudDpcIk1lbWJlcl9BY2NvdW50XCJ9LHJlc3BvbnNlOntHcm91cElkTGlzdDpcImdyb3Vwc1wiLE5vVW5yZWFkU2VxTGlzdDpcImV4Y2x1ZGVkVW5yZWFkU2VxdWVuY2VMaXN0XCIsTXNnU2VxOlwicmVhZGVkU2VxdWVuY2VcIixMYXN0UmVjYWxsVGltZTpcIl9sYXN0UmV2b2tlZFRpbWVcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoem8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9HUk9VUF9JTkZPKX0pLGJvZHk6e2dyb3VwSURMaXN0OnZvaWQgMCxyZXNwb25zZUZpbHRlcjp7Z3JvdXBCYXNlSW5mb0ZpbHRlcjpbXCJUeXBlXCIsXCJOYW1lXCIsXCJJbnRyb2R1Y3Rpb25cIixcIk5vdGlmaWNhdGlvblwiLFwiRmFjZVVybFwiLFwiT3duZXJfQWNjb3VudFwiLFwiQ3JlYXRlVGltZVwiLFwiSW5mb1NlcVwiLFwiTGFzdEluZm9UaW1lXCIsXCJMYXN0TXNnVGltZVwiLFwiTWVtYmVyTnVtXCIsXCJNYXhNZW1iZXJOdW1cIixcIkFwcGx5Sm9pbk9wdGlvblwiLFwiTmV4dE1zZ1NlcVwiLFwiU2h1dFVwQWxsTWVtYmVyXCJdLGdyb3VwQ3VzdG9tRmllbGRGaWx0ZXI6dm9pZCAwLG1lbWJlckluZm9GaWx0ZXI6dm9pZCAwLG1lbWJlckN1c3RvbUZpZWxkRmlsdGVyOnZvaWQgMH19LGtleU1hcDp7cmVxdWVzdDp7Z3JvdXBJRExpc3Q6XCJHcm91cElkTGlzdFwiLGdyb3VwQ3VzdG9tRmllbGQ6XCJBcHBEZWZpbmVkRGF0YVwiLG1lbWJlckN1c3RvbUZpZWxkOlwiQXBwTWVtYmVyRGVmaW5lZERhdGFcIixncm91cEN1c3RvbUZpZWxkRmlsdGVyOlwiQXBwRGVmaW5lZERhdGFGaWx0ZXJfR3JvdXBcIixtZW1iZXJDdXN0b21GaWVsZEZpbHRlcjpcIkFwcERlZmluZWREYXRhRmlsdGVyX0dyb3VwTWVtYmVyXCJ9LHJlc3BvbnNlOntHcm91cElkTGlzdDpcImdyb3Vwc1wiLEFwcERlZmluZWREYXRhOlwiZ3JvdXBDdXN0b21GaWVsZFwiLEFwcE1lbWJlckRlZmluZWREYXRhOlwibWVtYmVyQ3VzdG9tRmllbGRcIixBcHBEZWZpbmVkRGF0YUZpbHRlcl9Hcm91cDpcImdyb3VwQ3VzdG9tRmllbGRGaWx0ZXJcIixBcHBEZWZpbmVkRGF0YUZpbHRlcl9Hcm91cE1lbWJlcjpcIm1lbWJlckN1c3RvbUZpZWxkRmlsdGVyXCIsSW5mb1NlcTpcImluZm9TZXF1ZW5jZVwiLE1lbWJlckxpc3Q6XCJtZW1iZXJzXCIsR3JvdXBJbmZvOlwiZ3JvdXBzXCIsU2h1dFVwVW50aWw6XCJtdXRlVW50aWxcIixTaHV0VXBBbGxNZW1iZXI6XCJtdXRlQWxsTWVtYmVyc1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChKbyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuQ1JFQVRFX0dST1VQKX0pLGJvZHk6e3R5cGU6dm9pZCAwLG5hbWU6dm9pZCAwLGdyb3VwSUQ6dm9pZCAwLG93bmVySUQ6dm9pZCAwLGludHJvZHVjdGlvbjp2b2lkIDAsbm90aWZpY2F0aW9uOnZvaWQgMCxtYXhNZW1iZXJOdW06dm9pZCAwLGpvaW5PcHRpb246dm9pZCAwLG1lbWJlckxpc3Q6dm9pZCAwLGdyb3VwQ3VzdG9tRmllbGQ6dm9pZCAwLG1lbWJlckN1c3RvbUZpZWxkOnZvaWQgMCx3ZWJQdXNoRmxhZzoxLGF2YXRhcjpcIlwiLGlzU3VwcG9ydFRvcGljOnZvaWQgMCxpbnZpdGVPcHRpb246dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e293bmVySUQ6XCJPd25lcl9BY2NvdW50XCIsdXNlcklEOlwiTWVtYmVyX0FjY291bnRcIixhdmF0YXI6XCJGYWNlVXJsXCIsbWF4TWVtYmVyTnVtOlwiTWF4TWVtYmVyQ291bnRcIixqb2luT3B0aW9uOlwiQXBwbHlKb2luT3B0aW9uXCIsZ3JvdXBDdXN0b21GaWVsZDpcIkFwcERlZmluZWREYXRhXCIsbWVtYmVyQ3VzdG9tRmllbGQ6XCJBcHBNZW1iZXJEZWZpbmVkRGF0YVwiLGludml0ZU9wdGlvbjpcIkludml0ZUpvaW5PcHRpb25cIn0scmVzcG9uc2U6e0h1Z2VHcm91cEZsYWc6XCJhdkNoYXRSb29tRmxhZ1wiLE92ZXJKb2luZWRHcm91cExpbWl0X0FjY291bnQ6XCJvdmVyTGltaXRVc2VySURMaXN0XCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFhvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5ERVNUUk9ZX0dST1VQKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwfX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFpvLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5NT0RJRllfR1JPVVBfSU5GTyl9KSxib2R5Ontncm91cElEOnZvaWQgMCxuYW1lOnZvaWQgMCxpbnRyb2R1Y3Rpb246dm9pZCAwLG5vdGlmaWNhdGlvbjp2b2lkIDAsYXZhdGFyOnZvaWQgMCxqb2luT3B0aW9uOnZvaWQgMCxncm91cEN1c3RvbUZpZWxkOnZvaWQgMCxtdXRlQWxsTWVtYmVyczp2b2lkIDAsaW52aXRlT3B0aW9uOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ontncm91cEN1c3RvbUZpZWxkOlwiQXBwRGVmaW5lZERhdGFcIixtdXRlQWxsTWVtYmVyczpcIlNodXRVcEFsbE1lbWJlclwiLGpvaW5PcHRpb246XCJBcHBseUpvaW5PcHRpb25cIixhdmF0YXI6XCJGYWNlVXJsXCIsaW52aXRlT3B0aW9uOlwiSW52aXRlSm9pbk9wdGlvblwifSxyZXNwb25zZTp7QXBwRGVmaW5lZERhdGE6XCJncm91cEN1c3RvbUZpZWxkXCIsU2h1dFVwQWxsTWVtYmVyOlwibXV0ZUFsbE1lbWJlcnNcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoUW8sZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkFQUExZX0pPSU5fR1JPVVApfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsYXBwbHlNZXNzYWdlOnZvaWQgMCx1c2VyRGVmaW5lZEZpZWxkOnZvaWQgMCx3ZWJQdXNoRmxhZzoxLGhpc3RvcnlNZXNzYWdlRmxhZzp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7YXBwbHlNZXNzYWdlOlwiQXBwbHlNc2dcIixoaXN0b3J5TWVzc2FnZUZsYWc6XCJIdWdlR3JvdXBIaXN0b3J5TXNnRmxhZ1wifSxyZXNwb25zZTp7SHVnZUdyb3VwRmxhZzpcImF2Q2hhdFJvb21GbGFnXCIsQVZDaGF0Um9vbUtleTpcImF2Q2hhdFJvb21LZXlcIixSc3BNc2dMaXN0OlwibWVzc2FnZUxpc3RcIixUb0dyb3VwSWQ6XCJ0b1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldCgkbyxmdW5jdGlvbihlKXtyZXR1cm4gZS5hMixlLnRpbnlpZCx7aGVhZDp0KHQoe30sZyhlLEJyKSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkJJR19HUk9VUF9OT19BVVRILFwiLlwiKS5jb25jYXQoVi5DTUQuQVBQTFlfSk9JTl9HUk9VUCl9KSxib2R5Ontncm91cElEOnZvaWQgMCxhcHBseU1lc3NhZ2U6dm9pZCAwLHVzZXJEZWZpbmVkRmllbGQ6dm9pZCAwLHdlYlB1c2hGbGFnOjF9LGtleU1hcDp7cmVxdWVzdDp7YXBwbHlNZXNzYWdlOlwiQXBwbHlNc2dcIn0scmVzcG9uc2U6e0h1Z2VHcm91cEZsYWc6XCJhdkNoYXRSb29tRmxhZ1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChlcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuUVVJVF9HUk9VUCl9KSxib2R5Ontncm91cElEOnZvaWQgMH19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldCh0cyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuU0VBUkNIX0dST1VQX0JZX0lEKX0pLGJvZHk6e2dyb3VwSURMaXN0OnZvaWQgMCxyZXNwb25zZUZpbHRlcjp7Z3JvdXBCYXNlUHVibGljSW5mb0ZpbHRlcjpbXCJUeXBlXCIsXCJOYW1lXCIsXCJJbnRyb2R1Y3Rpb25cIixcIk5vdGlmaWNhdGlvblwiLFwiRmFjZVVybFwiLFwiQ3JlYXRlVGltZVwiLFwiT3duZXJfQWNjb3VudFwiLFwiTGFzdEluZm9UaW1lXCIsXCJMYXN0TXNnVGltZVwiLFwiTmV4dE1zZ1NlcVwiLFwiTWVtYmVyTnVtXCIsXCJNYXhNZW1iZXJOdW1cIixcIkFwcGx5Sm9pbk9wdGlvblwiLFwiSW52aXRlSm9pbk9wdGlvblwiXX19LGtleU1hcDp7cmVzcG9uc2U6e319fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQobnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkNIQU5HRV9HUk9VUF9PV05FUil9KSxib2R5Ontncm91cElEOnZvaWQgMCxuZXdPd25lcklEOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OntuZXdPd25lcklEOlwiTmV3T3duZXJfQWNjb3VudFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChvcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuSEFORExFX0FQUExZX0pPSU5fR1JPVVApfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsYXBwbGljYW50OnZvaWQgMCxoYW5kbGVBY3Rpb246dm9pZCAwLGhhbmRsZU1lc3NhZ2U6dm9pZCAwLGF1dGhlbnRpY2F0aW9uOnZvaWQgMCxtZXNzYWdlS2V5OnZvaWQgMCx1c2VyRGVmaW5lZEZpZWxkOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OnthcHBsaWNhbnQ6XCJBcHBsaWNhbnRfQWNjb3VudFwiLGhhbmRsZUFjdGlvbjpcIkhhbmRsZU1zZ1wiLGhhbmRsZU1lc3NhZ2U6XCJBcHByb3ZhbE1zZ1wiLG1lc3NhZ2VLZXk6XCJNc2dLZXlcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoc3MsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkhBTkRMRV9JTlZJVEVfSk9JTl9HUk9VUCl9KSxib2R5Ontncm91cElEOnZvaWQgMCxhcHBsaWNhbnQ6dm9pZCAwLGludml0ZWU6dm9pZCAwLGhhbmRsZUFjdGlvbjp2b2lkIDAsaGFuZGxlTWVzc2FnZTp2b2lkIDAsYXV0aGVudGljYXRpb246dm9pZCAwLHVzZXJEZWZpbmVkRmllbGQ6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e2FwcGxpY2FudDpcIkFwcGxpY2FudF9BY2NvdW50XCIsaW52aXRlZTpcIkludml0ZWRfQWNjb3VudFwiLGhhbmRsZUFjdGlvbjpcIkhhbmRsZU1zZ1wiLGhhbmRsZU1lc3NhZ2U6XCJBcHByb3ZhbE1zZ1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChhcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuSEFORExFX0dST1VQX0lOVklUQVRJT04pfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsaW52aXRlcjp2b2lkIDAsaGFuZGxlQWN0aW9uOnZvaWQgMCxoYW5kbGVNZXNzYWdlOnZvaWQgMCxhdXRoZW50aWNhdGlvbjp2b2lkIDAsbWVzc2FnZUtleTp2b2lkIDAsdXNlckRlZmluZWRGaWVsZDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7aW52aXRlcjpcIkludml0ZXJfQWNjb3VudFwiLGhhbmRsZUFjdGlvbjpcIkhhbmRsZU1zZ1wiLGhhbmRsZU1lc3NhZ2U6XCJBcHByb3ZhbE1zZ1wiLG1lc3NhZ2VLZXk6XCJNc2dLZXlcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoaHMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9HUk9VUF9BUFBMSUNBVElPTil9KSxib2R5OntzdGFydFRpbWU6dm9pZCAwLGxpbWl0OnZvaWQgMCxoYW5kbGVBY2NvdW50OnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0OntoYW5kbGVBY2NvdW50OlwiSGFuZGxlX0FjY291bnRcIn0scmVzcG9uc2U6e1RvX0FjY291bnQ6XCJ1c2VySURcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoX3MsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5PUEVOX0lNLFwiLlwiKS5jb25jYXQoVi5DTUQuREVMRVRFX0dST1VQX1NZU1RFTV9NRVNTQUdFKX0pLGJvZHk6e21lc3NhZ2VMaXN0VG9EZWxldGU6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e21lc3NhZ2VMaXN0VG9EZWxldGU6XCJEZWxNc2dMaXN0XCIsbWVzc2FnZVNlcTpcIk1zZ1NlcVwiLG1lc3NhZ2VSYW5kb206XCJNc2dSYW5kb21cIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoZnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5CSUdfR1JPVVBfTE9OR19QT0xMSU5HLFwiLlwiKS5jb25jYXQoVi5DTUQuQVZDSEFUUk9PTV9MT05HX1BPTEwpfSksYm9keTp7VVNQOjEsc3RhcnRTZXE6MSxzdGFydEJyb2FkY2FzdFNlcTp2b2lkIDAsaG9sZFRpbWU6OTAsa2V5OnZvaWQgMCxzaW1wbGlmaWVkTWVzc2FnZTp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7VVNQOlwiVVNQXCJ9LHJlc3BvbnNlOntUb0dyb3VwSWQ6XCJncm91cElEXCIsUnNwQnJvYWRjYXN0TXNnTGlzdDpcImJyb2FkY2FzdE1lc3NhZ2VMaXN0XCIsSXNTeXN0ZW1Nc2c6XCJpc1N5c3RlbU1lc3NhZ2VcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQodnMsZnVuY3Rpb24oZSl7cmV0dXJuIGUuYTIsZS50aW55aWQse2hlYWQ6dCh0KHt9LGcoZSxIcikpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5CSUdfR1JPVVBfTE9OR19QT0xMSU5HX05PX0FVVEgsXCIuXCIpLmNvbmNhdChWLkNNRC5BVkNIQVRST09NX0xPTkdfUE9MTCl9KSxib2R5OntVU1A6MSxzdGFydFNlcToxLGhvbGRUaW1lOjkwLGtleTp2b2lkIDAsc2ltcGxpZmllZE1lc3NhZ2U6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e1VTUDpcIlVTUFwifSxyZXNwb25zZTp7VG9Hcm91cElkOlwiZ3JvdXBJRFwiLFJzcEJyb2FkY2FzdE1zZ0xpc3Q6XCJicm9hZGNhc3RNZXNzYWdlTGlzdFwiLElzU3lzdGVtTXNnOlwiaXNTeXN0ZW1NZXNzYWdlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KG1zLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfT05MSU5FX01FTUJFUl9OVU0pfSksYm9keTp7Z3JvdXBJRDp2b2lkIDB9fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoSXMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELlNFVF9HUk9VUF9BVFRSSUJVVEVTKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLGdyb3VwQXR0cmlidXRlTGlzdDp2b2lkIDAsbWFpblNlcXVlbmNlOnZvaWQgMCxhdkNoYXRSb29tS2V5OnZvaWQgMCxhdHRyaWJ1dGVDb250cm9sOltcIlJhY2VDb25mbGljdFwiXX0sa2V5TWFwOntyZXF1ZXN0OntrZXk6XCJrZXlcIix2YWx1ZTpcInZhbHVlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KENzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5NT0RJRllfR1JPVVBfQVRUUklCVVRFUyl9KSxib2R5Ontncm91cElEOnZvaWQgMCxncm91cEF0dHJpYnV0ZUxpc3Q6dm9pZCAwLG1haW5TZXF1ZW5jZTp2b2lkIDAsYXZDaGF0Um9vbUtleTp2b2lkIDAsYXR0cmlidXRlQ29udHJvbDpbXCJSYWNlQ29uZmxpY3RcIl19LGtleU1hcDp7cmVxdWVzdDp7a2V5Olwia2V5XCIsdmFsdWU6XCJ2YWx1ZVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChUcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuREVMRVRFX0dST1VQX0FUVFJJQlVURVMpfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsZ3JvdXBBdHRyaWJ1dGVMaXN0OnZvaWQgMCxtYWluU2VxdWVuY2U6dm9pZCAwLGF2Q2hhdFJvb21LZXk6dm9pZCAwLGF0dHJpYnV0ZUNvbnRyb2w6W1wiUmFjZUNvbmZsaWN0XCJdfSxrZXlNYXA6e3JlcXVlc3Q6e2tleTpcImtleVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChEcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuQ0xFQVJfR1JPVVBfQVRUUklCVVRFUyl9KSxib2R5Ontncm91cElEOnZvaWQgMCxtYWluU2VxdWVuY2U6dm9pZCAwLGF2Q2hhdFJvb21LZXk6dm9pZCAwLGF0dHJpYnV0ZUNvbnRyb2w6W1wiUmFjZUNvbmZsaWN0XCJdfX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGtzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVBfQVRUUixcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9HUk9VUF9BVFRSSUJVVEVTKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLGF2Q2hhdFJvb21LZXk6dm9pZCAwLGdyb3VwVHlwZToxfSxrZXlNYXA6e3JlcXVlc3Q6e2F2Q2hhdFJvb21LZXk6XCJLZXlcIixncm91cFR5cGU6XCJHcm91cFR5cGVcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoTHMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELkdFVF9HUk9VUF9OT1RJRlkpfSksYm9keTp7bm90aWZ5VHlwZToxLGdyb3VwSUQ6XCJcIixiZWdpblRpbWU6MCxlbmRUaW1lOjAsbGltaXQ6MjB9LGtleU1hcDp7cmVxdWVzdDp7fSxyZXNwb25zZTp7TmV4dE1zZ1RpbWU6XCJuZXh0UmV2b2tlZFRpbWVcIixOb3RpZnlNc2dMaXN0Olwibm90aWZ5TGlzdFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChBcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuVVBEQVRFX0dST1VQX0NPVU5URVIpfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsY291bnRlckxpc3Q6dm9pZCAwLGF2Q2hhdFJvb21LZXk6dm9pZCAwLG1vZGU6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e2NvdW50ZXJMaXN0OlwiR3JvdXBDb3VudGVyXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFJzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfR1JPVVBfQ09VTlRFUil9KSxib2R5Ontncm91cElEOnZvaWQgMCxrZXlMaXN0OltdLGF2Q2hhdFJvb21LZXk6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e2tleUxpc3Q6XCJHcm91cENvdW50ZXJLZXlzXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHRhLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVBfQ09NTVVOSVRZLFwiLlwiKS5jb25jYXQoVi5DTUQuQ1JFQVRFX1RPUElDKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLHRvcGljTmFtZTp2b2lkIDAsYXZhdGFyOnZvaWQgMCxjdXN0b21EYXRhOnZvaWQgMCx0b3BpY0lEOnZvaWQgMCxub3RpZmljYXRpb246dm9pZCAwLGludHJvZHVjdGlvbjp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7YXZhdGFyOlwiRmFjZVVybFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChuYSxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQX0NPTU1VTklUWSxcIi5cIikuY29uY2F0KFYuQ01ELkRFTEVURV9UT1BJQyl9KSxib2R5Ontncm91cElEOnZvaWQgMCx0b3BpY0lETGlzdDp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7dG9waWNJRExpc3Q6XCJUb3BpY0lkTGlzdFwifSxyZXNwb25zZTp7RGVzdHJveVJlc3VsdEl0ZW06XCJyZXN1bHRMaXN0XCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KG9hLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVBfQ09NTVVOSVRZLFwiLlwiKS5jb25jYXQoVi5DTUQuVVBEQVRFX1RPUElDX1BST0ZJTEUpfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsdG9waWNJRDp2b2lkIDAsYXZhdGFyOnZvaWQgMCxjdXN0b21EYXRhOnZvaWQgMCxub3RpZmljYXRpb246dm9pZCAwLGludHJvZHVjdGlvbjp2b2lkIDAsbXV0ZUFsbE1lbWJlcnM6dm9pZCAwLHRvcGljTmFtZTp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7YXZhdGFyOlwiRmFjZVVybFwiLG11dGVBbGxNZW1iZXJzOlwiU2h1dFVwQWxsTWVtYmVyXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KHNhLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVBfQ09NTVVOSVRZLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX1RPUElDX0xJU1QpfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsdG9waWNJRExpc3Q6dm9pZCAwLE1lbWJlckluZm9GaWx0ZXI6W1wiTm9VbnJlYWRTZXFMaXN0XCJdfSxrZXlNYXA6e3JlcXVlc3Q6e3RvcGljSURMaXN0OlwiVG9waWNJZExpc3RcIn0scmVzcG9uc2U6e1RvcGljQW5kU2VsZkluZm86XCJ0b3BpY0luZm9MaXN0XCIsVG9waWNJbmZvOlwidG9waWNcIixHcm91cElEOlwiZ3JvdXBJRFwiLFNodXRVcFRpbWU6XCJtdXRlVGltZVwiLFNodXRVcEFsbEZsYWc6XCJtdXRlQWxsTWVtYmVyc1wiLExhc3RNc2dUaW1lOlwibGFzdE1lc3NhZ2VUaW1lXCIsTXNnU2VxOlwicmVhZGVkU2VxdWVuY2VcIixMYXN0TXNnU2VxOlwic2VxdWVuY2VcIixOb1VucmVhZFNlcUxpc3Q6XCJleGNsdWRlZFVucmVhZFNlcXVlbmNlTGlzdFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChOcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX0dST1VQX01FTUJFUl9MSVNUKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLGxpbWl0OjAsb2Zmc2V0OnZvaWQgMCxuZXh0OnZvaWQgMCxtZW1iZXJSb2xlRmlsdGVyOnZvaWQgMCxtZW1iZXJJbmZvRmlsdGVyOltcIlJvbGVcIixcIk5hbWVDYXJkXCIsXCJTaHV0VXBVbnRpbFwiLFwiSm9pblRpbWVcIl0sbWVtYmVyQ3VzdG9tRmllbGRGaWx0ZXI6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e21lbWJlckN1c3RvbUZpZWxkRmlsdGVyOlwiQXBwRGVmaW5lZERhdGFGaWx0ZXJfR3JvdXBNZW1iZXJcIn0scmVzcG9uc2U6e0FwcE1lbWJlckRlZmluZWREYXRhOlwibWVtYmVyQ3VzdG9tRmllbGRcIixBcHBEZWZpbmVkRGF0YUZpbHRlcl9Hcm91cE1lbWJlcjpcIm1lbWJlckN1c3RvbUZpZWxkRmlsdGVyXCIsTWVtYmVyTGlzdDpcIm1lbWJlcnNcIixTaHV0VXBVbnRpbDpcIm11dGVVbnRpbFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChPcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQX0FWQ0hBVFJPT00sXCIuXCIpLmNvbmNhdChWLkNNRC5HRVRfQVZDSEFUUk9PTV9NRU1CRVJfTElTVCl9KSxib2R5Ontncm91cElEOnZvaWQgMCxvZmZzZXQ6dm9pZCAwLGZpbHRlcjp2b2lkIDB9LGtleU1hcDp7cmVxdWVzdDp7b2Zmc2V0OlwiVGltZXN0YW1wXCIsZmlsdGVyOlwiTWFya1wifSxyZXNwb25zZTp7TmV4dFRpbWVzdGFtcDpcIm9mZnNldFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChHcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuR0VUX0dST1VQX01FTUJFUl9JTkZPKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLHVzZXJJRExpc3Q6dm9pZCAwLG1lbWJlckluZm9GaWx0ZXI6dm9pZCAwLG1lbWJlckN1c3RvbUZpZWxkRmlsdGVyOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont1c2VySURMaXN0OlwiTWVtYmVyX0xpc3RfQWNjb3VudFwiLG1lbWJlckN1c3RvbUZpZWxkRmlsdGVyOlwiQXBwRGVmaW5lZERhdGFGaWx0ZXJfR3JvdXBNZW1iZXJcIn0scmVzcG9uc2U6e01lbWJlckxpc3Q6XCJtZW1iZXJzXCIsU2h1dFVwVW50aWw6XCJtdXRlVW50aWxcIixBcHBEZWZpbmVkRGF0YUZpbHRlcl9Hcm91cE1lbWJlcjpcIm1lbWJlckN1c3RvbUZpZWxkRmlsdGVyXCIsQXBwTWVtYmVyRGVmaW5lZERhdGE6XCJtZW1iZXJDdXN0b21GaWVsZFwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChVcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuQUREX0dST1VQX01FTUJFUil9KSxib2R5Ontncm91cElEOnZvaWQgMCxzaWxlbmNlOnZvaWQgMCx1c2VySURMaXN0OnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont1c2VySUQ6XCJNZW1iZXJfQWNjb3VudFwiLHVzZXJJRExpc3Q6XCJNZW1iZXJMaXN0XCJ9LHJlc3BvbnNlOntNZW1iZXJMaXN0OlwibWVtYmVyc1wifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChQcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLkdST1VQLFwiLlwiKS5jb25jYXQoVi5DTUQuREVMRVRFX0dST1VQX01FTUJFUil9KSxib2R5Ontncm91cElEOnZvaWQgMCx1c2VySURMaXN0OnZvaWQgMCxyZWFzb246dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e3VzZXJJRExpc3Q6XCJNZW1iZXJUb0RlbF9BY2NvdW50XCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGJzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuR1JPVVAsXCIuXCIpLmNvbmNhdChWLkNNRC5CQU5fQVZDSEFUUk9PTV9NRU1CRVIpfSksYm9keTp7Z3JvdXBJRDp2b2lkIDAsdXNlcklETGlzdDp2b2lkIDAsZHVyYXRpb246dm9pZCAwLHJlYXNvbjpcIlwifSxrZXlNYXA6e3JlcXVlc3Q6e3VzZXJJRExpc3Q6XCJNZW1iZXJzX0FjY291bnRcIixkdXJhdGlvbjpcIkR1cmF0aW9uXCIscmVhc29uOlwiRGVzY3JpcHRpb25cIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQod3MsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUCxcIi5cIikuY29uY2F0KFYuQ01ELk1PRElGWV9HUk9VUF9NRU1CRVJfSU5GTyl9KSxib2R5Ontncm91cElEOnZvaWQgMCx0b3BpY0lEOnZvaWQgMCx1c2VySUQ6dm9pZCAwLG1lc3NhZ2VSZW1pbmRUeXBlOnZvaWQgMCxuYW1lQ2FyZDp2b2lkIDAscm9sZTp2b2lkIDAsbWVtYmVyQ3VzdG9tRmllbGQ6dm9pZCAwLG11dGVUaW1lOnZvaWQgMH0sa2V5TWFwOntyZXF1ZXN0Ont1c2VySUQ6XCJNZW1iZXJfQWNjb3VudFwiLG1lbWJlckN1c3RvbUZpZWxkOlwiQXBwTWVtYmVyRGVmaW5lZERhdGFcIixtdXRlVGltZTpcIlNodXRVcFRpbWVcIixtZXNzYWdlUmVtaW5kVHlwZTpcIk1zZ0ZsYWdcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoRnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5HUk9VUF9BVkNIQVRST09NLFwiLlwiKS5jb25jYXQoVi5DTUQuTUFSS19BVkNIQVRST09NX01FTUJFUl9JTkZPKX0pLGJvZHk6e2dyb3VwSUQ6dm9pZCAwLG9wZXJhdGlvblR5cGU6MSxtZW1iZXJMaXN0OltdfSxrZXlNYXA6e3JlcXVlc3Q6e29wZXJhdGlvblR5cGU6XCJDb21tYW5kVHlwZVwiLG1lbWJlckxpc3Q6XCJNZW1iZXJMaXN0XCIsbWFya1R5cGU6XCJNYXJrc1wiLHVzZXJJRDpcIk1lbWJlcl9BY2NvdW50XCJ9LHJlc3BvbnNlOntDb21tYW5kVHlwZTpcIm9wZXJhdGlvblR5cGVcIixNYXJrczpcIm1hcmtUeXBlXCIsTWVtYmVyX0FjY291bnQ6XCJ1c2VySURcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoQnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVQsXCIuXCIpLmNvbmNhdChWLkNNRC5USU1fV0VCX1JFUE9SVF9WMil9KSxib2R5OntoZWFkZXI6e30sZXZlbnQ6W10scXVhbGl0eTpbXX0sa2V5TWFwOntyZXF1ZXN0OntTREtUeXBlOlwic2RrX3R5cGVcIixTREtWZXJzaW9uOlwic2RrX3ZlcnNpb25cIixkZXZpY2VUeXBlOlwiZGV2aWNlX3R5cGVcIixwbGF0Zm9ybTpcInBsYXRmb3JtXCIsaW5zdGFuY2VJRDpcImluc3RhbmNlX2lkXCIsdHJhY2VJRDpcInRyYWNlX2lkXCIsU0RLQXBwSUQ6XCJzZGtfYXBwX2lkXCIsdXNlcklEOlwidXNlcl9pZFwiLHRpbnlJRDpcInRpbnlfaWRcIixleHRlbnNpb246XCJleHRlbnNpb25cIix0aW1lc3RhbXA6XCJ0aW1lc3RhbXBcIixuZXR3b3JrVHlwZTpcIm5ldHdvcmtfdHlwZVwiLGV2ZW50VHlwZTpcImV2ZW50X3R5cGVcIixjb2RlOlwiZXJyb3JfY29kZVwiLG1lc3NhZ2U6XCJlcnJvcl9tZXNzYWdlXCIsbW9yZU1lc3NhZ2U6XCJtb3JlX21lc3NhZ2VcIixkdXBsaWNhdGU6XCJkdXBsaWNhdGVcIixjb3N0VGltZTpcImNvc3RfdGltZVwiLGxldmVsOlwibGV2ZWxcIixxdWFsaXR5VHlwZTpcInF1YWxpdHlfdHlwZVwiLHJlcG9ydEluZGV4OlwicmVwb3J0X2luZGV4XCIsd2hvbGVQZXJpb2Q6XCJ3aG9sZV9wZXJpb2RcIix0b3RhbENvdW50OlwidG90YWxfY291bnRcIixydHRDb3VudDpcInN1Y2Nlc3NfY291bnRfYnVzaW5lc3NcIixzdWNjZXNzUmF0ZU9mUmVxdWVzdDpcInBlcmNlbnRfYnVzaW5lc3NcIixjb3VudExlc3NUaGFuMVNlY29uZDpcInN1Y2Nlc3NfY291bnRfYnVzaW5lc3NcIixwZXJjZW50T2ZDb3VudExlc3NUaGFuMVNlY29uZDpcInBlcmNlbnRfYnVzaW5lc3NcIixjb3VudExlc3NUaGFuM1NlY29uZDpcInN1Y2Nlc3NfY291bnRfcGxhdGZvcm1cIixwZXJjZW50T2ZDb3VudExlc3NUaGFuM1NlY29uZDpcInBlcmNlbnRfcGxhdGZvcm1cIixzdWNjZXNzQ291bnRPZkJ1c2luZXNzOlwic3VjY2Vzc19jb3VudF9idXNpbmVzc1wiLHN1Y2Nlc3NSYXRlT2ZCdXNpbmVzczpcInBlcmNlbnRfYnVzaW5lc3NcIixzdWNjZXNzQ291bnRPZlBsYXRmb3JtOlwic3VjY2Vzc19jb3VudF9wbGF0Zm9ybVwiLHN1Y2Nlc3NSYXRlT2ZQbGF0Zm9ybTpcInBlcmNlbnRfcGxhdGZvcm1cIixzdWNjZXNzQ291bnRPZk1lc3NhZ2VSZWNlaXZlZDpcInN1Y2Nlc3NfY291bnRfYnVzaW5lc3NcIixzdWNjZXNzUmF0ZU9mTWVzc2FnZVJlY2VpdmVkOlwicGVyY2VudF9idXNpbmVzc1wiLGF2Z1JUVDpcImF2ZXJhZ2VfdmFsdWVcIixhdmdEZWxheTpcImF2ZXJhZ2VfdmFsdWVcIixhdmdWYWx1ZTpcImF2ZXJhZ2VfdmFsdWVcIix1aVBsYXRmb3JtOlwidWlfcGxhdGZvcm1cIn19fX0obykpLHRoaXMuX2NvbmZpZ01hcC5zZXQoSHMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5IRUFSVEJFQVQsXCIuXCIpLmNvbmNhdChWLkNNRC5BTElWRSl9KSxib2R5Ont9fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoS3MsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1BVU0gsXCIuXCIpLmNvbmNhdChWLkNNRC5NRVNTQUdFX1BVU0gpfSksYm9keTp7fSxrZXlNYXA6e3Jlc3BvbnNlOntDMmNNc2dBcnJheTpcIkMyQ01lc3NhZ2VBcnJheVwiLEdyb3VwTXNnQXJyYXk6XCJncm91cE1lc3NhZ2VBcnJheVwiLEdyb3VwVGlwczpcImdyb3VwVGlwc1wiLEMyY05vdGlmeU1zZ0FycmF5OlwiQzJDTm90aWZ5TWVzc2FnZUFycmF5XCIsQzJjTXNnSW5mbzpcIkMyQ1JlYWRSZWNlaXB0QXJyYXlcIixDbGllbnRTZXE6XCJjbGllbnRTZXF1ZW5jZVwiLE1zZ1ByaW9yaXR5OlwicHJpb3JpdHlcIixOb3RpY2VTZXE6XCJub3RpY2VTZXF1ZW5jZVwiLE1zZ0NvbnRlbnQ6XCJjb250ZW50XCIsTXNnVHlwZTpcInR5cGVcIixNc2dCb2R5OlwiZWxlbWVudHNcIixUb0dyb3VwSWQ6XCJ0b1wiLERlc2M6XCJkZXNjcmlwdGlvblwiLEV4dDpcImV4dGVuc2lvblwiLElzU3luY01zZzpcImlzU3luY01lc3NhZ2VcIixGbGFnOlwibmVlZFN5bmNcIixOZWVkQWNrOlwibmVlZEFja1wiLFBlbmRlbmN5QWRkX0FjY291bnQ6XCJ1c2VySURcIixQcm9maWxlSW1OaWNrOlwibmlja1wiLFBlbmRlbmN5VHlwZTpcImFwcGxpY2F0aW9uVHlwZVwiLEMyQ1JlYWRBbGxNc2c6XCJyZWFkQWxsQzJDTWVzc2FnZVwiLElzTmVlZFJlYWRSZWNlaXB0OlwibmVlZFJlYWRSZWNlaXB0XCIsU3RhdHVzOlwic3RhdHVzVHlwZVwifX19fShlKSksdGhpcy5fY29uZmlnTWFwLnNldChXcyxmdW5jdGlvbihlKXtyZXR1cm57aGVhZDp0KHQoe30sZSkse30se3NlcnZjbWQ6XCJcIi5jb25jYXQoVi5OQU1FLklNX09QRU5fUFVTSCxcIi5cIikuY29uY2F0KFYuQ01ELk1VTFRJX01FU1NBR0VfUFVTSCl9KSxib2R5Ont9LGtleU1hcDp7cmVzcG9uc2U6e0dyb3VwTXNnQXJyYXk6XCJncm91cE1lc3NhZ2VBcnJheVwiLEdyb3VwVGlwczpcImdyb3VwVGlwc1wiLENsaWVudFNlcTpcImNsaWVudFNlcXVlbmNlXCIsTXNnUHJpb3JpdHk6XCJwcmlvcml0eVwiLE5vdGljZVNlcTpcIm5vdGljZVNlcXVlbmNlXCIsTXNnQ29udGVudDpcImNvbnRlbnRcIixNc2dUeXBlOlwidHlwZVwiLE1zZ0JvZHk6XCJlbGVtZW50c1wiLFRvR3JvdXBJZDpcInRvXCIsRGVzYzpcImRlc2NyaXB0aW9uXCIsRXh0OlwiZXh0ZW5zaW9uXCIsSXNTeW5jTXNnOlwiaXNTeW5jTWVzc2FnZVwiLEZsYWc6XCJuZWVkU3luY1wiLE5lZWRBY2s6XCJuZWVkQWNrXCIsUGVuZGVuY3lUeXBlOlwiYXBwbGljYXRpb25UeXBlXCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KFlzLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuT1BFTl9JTSxcIi5cIikuY29uY2F0KFYuQ01ELk1FU1NBR0VfUFVTSF9BQ0spfSksYm9keTp7c2Vzc2lvbkRhdGE6dm9pZCAwfSxrZXlNYXA6e3JlcXVlc3Q6e3Nlc3Npb25EYXRhOlwiU2Vzc2lvbkRhdGFcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoanMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVRVUyxcIi5cIikuY29uY2F0KFYuQ01ELlNUQVRVU19GT1JDRV9PRkZMSU5FKX0pLGJvZHk6e30sa2V5TWFwOntyZXNwb25zZTp7QzJjTm90aWZ5TXNnQXJyYXk6XCJDMkNOb3RpZnlNZXNzYWdlQXJyYXlcIixOb3RpY2VTZXE6XCJub3RpY2VTZXF1ZW5jZVwiLEtpY2tvdXRNc2dOb3RpZnk6XCJraWNrb3V0TXNnTm90aWZ5XCIsTmV3SW5zdEluZm86XCJuZXdJbnN0YW5jZUluZm9cIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoSnMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9MT05HX01FU1NBR0UsXCIuXCIpLmNvbmNhdChWLkNNRC5ET1dOTE9BRF9NRVJHRVJfTUVTU0FHRSl9KSxib2R5Ontkb3dubG9hZEtleTpcIlwifSxrZXlNYXA6e3Jlc3BvbnNlOntEYXRhOlwiZGF0YVwiLERlc2M6XCJkZXNjcmlwdGlvblwiLEV4dDpcImV4dGVuc2lvblwiLERvd25sb2FkX0ZsYWc6XCJkb3dubG9hZEZsYWdcIixUaHVtYlVVSUQ6XCJ0aHVtYlVVSURcIixWaWRlb1VVSUQ6XCJ2aWRlb1VVSURcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQoenMsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9MT05HX01FU1NBR0UsXCIuXCIpLmNvbmNhdChWLkNNRC5VUExPQURfTUVSR0VSX01FU1NBR0UpfSksYm9keTp7bWVzc2FnZUxpc3Q6W119LGtleU1hcDp7cmVxdWVzdDp7ZnJvbUFjY291bnQ6XCJGcm9tX0FjY291bnRcIix0b0FjY291bnQ6XCJUb19BY2NvdW50XCIsbXNnVGltZVN0YW1wOlwiTXNnVGltZVN0YW1wXCIsbXNnU2VxOlwiTXNnU2VxXCIsbXNnUmFuZG9tOlwiTXNnUmFuZG9tXCIsbXNnQm9keTpcIk1zZ0JvZHlcIix0eXBlOlwiTXNnVHlwZVwiLGNvbnRlbnQ6XCJNc2dDb250ZW50XCIsZGF0YTpcIkRhdGFcIixkZXNjcmlwdGlvbjpcIkRlc2NcIixleHRlbnNpb246XCJFeHRcIixzaXplVHlwZTpcIlR5cGVcIix1dWlkOlwiVVVJRFwiLHVybDpcIlwiLGltYWdlVXJsOlwiVVJMXCIsZmlsZVVybDpcIlVybFwiLHJlbW90ZUF1ZGlvVXJsOlwiVXJsXCIscmVtb3RlVmlkZW9Vcmw6XCJWaWRlb1VybFwiLHRodW1iVVVJRDpcIlRodW1iVVVJRFwiLHZpZGVvVVVJRDpcIlZpZGVvVVVJRFwiLHZpZGVvVXJsOlwiXCIsZG93bmxvYWRGbGFnOlwiRG93bmxvYWRfRmxhZ1wiLGZyb206XCJGcm9tX0FjY291bnRcIix0aW1lOlwiTXNnVGltZVN0YW1wXCIsbWVzc2FnZVJhbmRvbTpcIk1zZ1JhbmRvbVwiLG1lc3NhZ2VTZXF1ZW5jZTpcIk1zZ1NlcVwiLGVsZW1lbnRzOlwiTXNnQm9keVwiLGNsaWVudFNlcXVlbmNlOlwiQ2xpZW50U2VxXCIscGF5bG9hZDpcIk1zZ0NvbnRlbnRcIixtZXNzYWdlTGlzdDpcIk1zZ0xpc3RcIixtZXNzYWdlTnVtYmVyOlwiTXNnTnVtXCIsYWJzdHJhY3RMaXN0OlwiQWJzdHJhY3RMaXN0XCIsbWVzc2FnZUJvZHk6XCJNc2dCb2R5XCJ9fX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGRhLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuSU1fT1BFTl9TVEFUVVMsXCIuXCIpLmNvbmNhdChWLkNNRC5TRVRfVE9LRU4pfSksYm9keTp7dG9rZW5JRDpcIlwiLHB1c2hNc2c6MCxzZGtBcHBJRDowLGJ1c2luZXNzSUQ6XCJcIixkZXZpY2VCcmFuZDpcIlwiLGRldmljZVRva2VuOlwiXCIsaXNUcG5zOjAsaXNXZWJVbmlhcHA6MH0sa2V5TWFwOntyZXF1ZXN0Ont0b2tlbklEOlwiVG9rZW5JRFwiLHB1c2hNc2c6XCJQdXNoTXNnXCIsc2RrQXBwSUQ6XCJFbnRlclZlcnNpb25cIixidXNpbmVzc0lEOlwiQnVzaUlEXCIsZGV2aWNlQnJhbmQ6XCJJbnN0VHlwZVwiLGRldmljZVRva2VuOlwiVmFyVG9rZW5cIixpc1RwbnM6XCJJc1RwbnNcIn19fX0oZSkpLHRoaXMuX2NvbmZpZ01hcC5zZXQobGEsZnVuY3Rpb24oZSl7cmV0dXJue2hlYWQ6dCh0KHt9LGUpLHt9LHtzZXJ2Y21kOlwiXCIuY29uY2F0KFYuTkFNRS5JTV9PUEVOX1NUQVRVUyxcIi5cIikuY29uY2F0KFYuQ01ELlNUQVRfRk9SRUdST1VORCl9KSxib2R5Ontpc1dlYlVuaWFwcDowfX19KGUpKSx0aGlzLl9jb25maWdNYXAuc2V0KGNhLGZ1bmN0aW9uKGUpe3JldHVybntoZWFkOnQodCh7fSxlKSx7fSx7c2VydmNtZDpcIlwiLmNvbmNhdChWLk5BTUUuSU1fT1BFTl9TVEFUVVMsXCIuXCIpLmNvbmNhdChWLkNNRC5TVEFUX0JBQ0tHUk9VTkQpfSksYm9keTp7QzJDVW5yZWFkOjAsR3JvdXBVbnJlYWQ6MCxpc1dlYlVuaWFwcDowfSxrZXlNYXA6e3JlcXVlc3Q6e2MyY1VucmVhZENvdW50OlwiQzJjVW5yZWFkXCIsZ3JvdXBVbnJlYWRDb3VudDpcIkdycFVucmVhZFwifX19fShlKSl9fSx7a2V5OlwiaGFzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NvbmZpZ01hcC5oYXMoZSl9fSx7a2V5OlwiZ2V0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NvbmZpZ01hcC5nZXQoZSl9fSx7a2V5OlwidXBkYXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9maWxsQ29uZmlnTWFwKCl9fSx7a2V5OlwiZ2V0S2V5TWFwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaGFzKGUpP3RoaXMuZ2V0KGUpLmtleU1hcHx8e306KFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRLZXlNYXAgdW5rbm93biBwcm90b2NvbE5hbWU6XCIpLmNvbmNhdChlKSkse30pfX0se2tleTpcImdldFByb3RvY29sRGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUucHJvdG9jb2xOYW1lLG49ZS5yZXF1ZXN0RGF0YSxvPXRoaXMuZ2V0KHQpLHM9bnVsbDtpZihuKXt2YXIgYT10aGlzLl9zaW1wbGVEZWVwQ29weShvKSxpPXRoaXMuX3VwZGF0ZVNlcnZpY2UobixhKSxyPWkuYm9keSx1PU9iamVjdC5jcmVhdGUobnVsbCk7Zm9yKHZhciBjIGluIHIpaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHIsYykpe2lmKHVbY109cltjXSx2b2lkIDA9PT1uW2NdKWNvbnRpbnVlO3VbY109bltjXX1pLmJvZHk9dSxzPXRoaXMuX2dldFVwbGlua0RhdGEoaSl9ZWxzZSBzPXRoaXMuX2dldFVwbGlua0RhdGEobyk7cmV0dXJuIHN9fSx7a2V5OlwiX2dldFVwbGlua0RhdGFcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9yZXF1ZXN0RGF0YUNsZWFuZXIoZSksbj1idCh0LmhlYWQpLG89U3IodC5ib2R5LHRoaXMuX2dldFJlcXVlc3RLZXlNYXAobikpO3JldHVybiB0LmJvZHk9byx0fX0se2tleTpcIl91cGRhdGVTZXJ2aWNlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1idCh0LmhlYWQpO2lmKHRoaXMuX2lzRnJvbUdyb3VwUmVxdWVzdCh0KSl7dmFyIG89ZS50eXBlLHM9ZS5ncm91cElELGE9dm9pZCAwPT09cz92b2lkIDA6cyxpPWUuZ3JvdXBJRExpc3Qscj12b2lkIDA9PT1pP1tdOmk7aXQoYSkmJihhPXJbMF18fFwiXCIpLER0KHt0eXBlOm8sZ3JvdXBJRDphfSkmJih0LmhlYWQuc2VydmNtZD1cIlwiLmNvbmNhdChWLk5BTUUuR1JPVVBfQ09NTVVOSVRZLFwiLlwiKS5jb25jYXQobikpfXJldHVybiB0fX0se2tleTpcIl9pc0Zyb21Hcm91cFJlcXVlc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5oZWFkLnNlcnZjbWQuaW5jbHVkZXMoVi5OQU1FLkdST1VQKXx8ZS5oZWFkLnNlcnZjbWQuaW5jbHVkZXMoVi5OQU1FLkdST1VQX0FUVFIpfX0se2tleTpcIl9nZXRSZXF1ZXN0S2V5TWFwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIG49dGhpcy5nZXRLZXlNYXAoZSk7cmV0dXJuIHQodCh7fSxEci5yZXF1ZXN0KSxuLnJlcXVlc3QpfX0se2tleTpcIl9yZXF1ZXN0RGF0YUNsZWFuZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1BcnJheS5pc0FycmF5KGUpP1tdOk9iamVjdC5jcmVhdGUobnVsbCk7Zm9yKHZhciBvIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbykmJmR0KG8pJiZudWxsIT09ZVtvXSYmdm9pZCAwIT09ZVtvXSYmKFwib2JqZWN0XCIhPT1uKGVbb10pP3Rbb109ZVtvXTp0W29dPXRoaXMuX3JlcXVlc3REYXRhQ2xlYW5lci5iaW5kKHRoaXMpKGVbb10pKTtyZXR1cm4gdH19LHtrZXk6XCJfc2ltcGxlRGVlcENvcHlcIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQsbj1PYmplY3Qua2V5cyhlKSxvPXt9LHM9MCxhPW4ubGVuZ3RoO3M8YTtzKyspdD1uW3NdLGF0KGVbdF0pP29bdF09QXJyYXkuZnJvbShlW3RdKTpvdChlW3RdKT9vW3RdPXRoaXMuX3NpbXBsZURlZXBDb3B5KGVbdF0pOm9bdF09ZVt0XTtyZXR1cm4gb319XSksZX0oKSxXcj1bWXNdLFlyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fc2Vzc2lvbk1vZHVsZT10LHRoaXMuX249XCJEb3dubGlua0hhbmRsZXJcIix0aGlzLl9ldmVudEhhbmRsZXJNYXA9bmV3IE1hcCx0aGlzLl9ldmVudEhhbmRsZXJNYXAuc2V0KFwiQzJDTWVzc2FnZUFycmF5XCIsdGhpcy5fYzJjTWVzc2FnZUFycmF5SGFuZGxlci5iaW5kKHRoaXMpKSx0aGlzLl9ldmVudEhhbmRsZXJNYXAuc2V0KFwiZ3JvdXBNZXNzYWdlQXJyYXlcIix0aGlzLl9ncm91cE1lc3NhZ2VBcnJheUhhbmRsZXIuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRIYW5kbGVyTWFwLnNldChcImdyb3VwVGlwc1wiLHRoaXMuX2dyb3VwVGlwc0hhbmRsZXIuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRIYW5kbGVyTWFwLnNldChcIkMyQ05vdGlmeU1lc3NhZ2VBcnJheVwiLHRoaXMuX0MyQ05vdGlmeU1lc3NhZ2VBcnJheUhhbmRsZXIuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRIYW5kbGVyTWFwLnNldChcIkMyQ1JlYWRSZWNlaXB0QXJyYXlcIix0aGlzLl9DMkNSZWFkUmVjZWlwdEFycmF5SGFuZGxlci5iaW5kKHRoaXMpKSx0aGlzLl9ldmVudEhhbmRsZXJNYXAuc2V0KFwicHJvZmlsZU1vZGlmeVwiLHRoaXMuX3Byb2ZpbGVIYW5kbGVyLmJpbmQodGhpcykpLHRoaXMuX2V2ZW50SGFuZGxlck1hcC5zZXQoXCJmcmllbmRMaXN0TW9kXCIsdGhpcy5fcmVsYXRpb25DaGFpbkhhbmRsZXIuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRIYW5kbGVyTWFwLnNldChcInJlY2VudENvbnRhY3RNb2RcIix0aGlzLl9yZWNlbnRDb250YWN0SGFuZGxlci5iaW5kKHRoaXMpKSx0aGlzLl9ldmVudEhhbmRsZXJNYXAuc2V0KFwicmVhZEFsbEMyQ01lc3NhZ2VcIix0aGlzLl9hbGxNZXNzYWdlUmVhZEhhbmRsZXIuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRIYW5kbGVyTWFwLnNldChcImMyY01lc3NhZ2VNb2RpZmllZFwiLHRoaXMuX2MyY01lc3NhZ2VNb2RpZmllZEhhbmRsZXIuYmluZCh0aGlzKSksdGhpcy5fZXZlbnRIYW5kbGVyTWFwLnNldChcImdyb3VwTWVzc2FnZU1vZGlmaWVkXCIsdGhpcy5fZ3JvdXBNZXNzYWdlTW9kaWZpZWRIYW5kbGVyLmJpbmQodGhpcykpLHRoaXMuX2V2ZW50SGFuZGxlck1hcC5zZXQoXCJ1c2VyU3RhdHVzTGlzdFwiLHRoaXMuX3VzZXJTdGF0dXNMaXN0SGFuZGxlci5iaW5kKHRoaXMpKSx0aGlzLl9ldmVudEhhbmRsZXJNYXAuc2V0KFwibWVzc2FnZUV4dGVuc2lvbk5vdGlmeVwiLHRoaXMuX21lc3NhZ2VFeHRlbnNpb25Ob3RpZnlIYW5kbGVyLmJpbmQodGhpcykpLHRoaXMuX2tleXM9bSh0aGlzLl9ldmVudEhhbmRsZXJNYXAua2V5cygpKX1yZXR1cm4gYShlLFt7a2V5OlwiX2MyY01lc3NhZ2VBcnJheUhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShVbik7aWYodCl7aWYoZS5kYXRhTGlzdC5mb3JFYWNoKChmdW5jdGlvbihlKXtpZigxPT09ZS5pc1N5bmNNZXNzYWdlKXt2YXIgdD1lLmZyb207ZS5mcm9tPWUudG8sZS50bz10fX0pKSwxPT09ZS5uZWVkU3luYyl0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShqbikuc3RhcnRPbmxpbmVTeW5jKCk7dC5vbk5ld0MyQ01lc3NhZ2Uoe2RhdGFMaXN0OmUuZGF0YUxpc3QsaXNJbnN0YW50TWVzc2FnZTohMH0pfX19LHtrZXk6XCJfYzJjTWVzc2FnZU1vZGlmaWVkSGFuZGxlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX3Nlc3Npb25Nb2R1bGUuZ2V0TW9kdWxlKFVuKTt0JiZ0Lm9uQzJDTWVzc2FnZU1vZGlmaWVkKGUpfX0se2tleTpcIl9ncm91cE1lc3NhZ2VBcnJheUhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShQbik7dCYmdC5vbk5ld0dyb3VwTWVzc2FnZSh7ZXZlbnQ6ZS5ldmVudCxkYXRhTGlzdDplLmRhdGFMaXN0LGlzSW5zdGFudE1lc3NhZ2U6ITB9KX19LHtrZXk6XCJfZ3JvdXBNZXNzYWdlTW9kaWZpZWRIYW5kbGVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fc2Vzc2lvbk1vZHVsZS5nZXRNb2R1bGUoUG4pO3QmJnQub25Hcm91cE1lc3NhZ2VNb2RpZmllZChlKX19LHtrZXk6XCJfZ3JvdXBUaXBzSGFuZGxlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX3Nlc3Npb25Nb2R1bGUuZ2V0TW9kdWxlKFBuKTtpZih0KXt2YXIgbj1lLmV2ZW50LG89ZS5kYXRhTGlzdCxzPWUuaXNJbnN0YW50TWVzc2FnZSxhPXZvaWQgMD09PXN8fHMsaT1lLmlzU3luY2luZ0VuZGVkO3N3aXRjaChuKXtjYXNlIDQ6Y2FzZSA2OnQub25OZXdHcm91cFRpcHMoe2V2ZW50Om4sZGF0YUxpc3Q6b30pO2JyZWFrO2Nhc2UgNTpmb3IodmFyIHI9MDtyPG8ubGVuZ3RoO3IrKylpZihhdChvW3JdLmVsZW1lbnRzLnJldm9rZWRJbmZvcykpdC5vbkdyb3VwTWVzc2FnZVJldm9rZWQoe2RhdGFMaXN0Om99KTtlbHNlIGlmKGF0KG9bcl0uZWxlbWVudHMuZ3JvdXBNZXNzYWdlUmVhZE5vdGljZSkpdC5vbkdyb3VwTWVzc2FnZVJlYWROb3RpY2Uoe2RhdGFMaXN0Om99KTtlbHNle2lmKCFhdChvW3JdLmVsZW1lbnRzLnJlYWRSZWNlaXB0TGlzdCkpe3Qub25OZXdHcm91cFN5c3RlbU5vdGljZSh7ZGF0YUxpc3Q6byxpc0luc3RhbnRNZXNzYWdlOmEsaXNTeW5jaW5nRW5kZWQ6aX0pO2JyZWFrfXQub25SZWFkUmVjZWlwdExpc3Qoe2RhdGFMaXN0Om99KX1icmVhaztjYXNlIDEyOnRoaXMuX3Nlc3Npb25Nb2R1bGUuZ2V0TW9kdWxlKHFuKS5vbk5ld0dyb3VwQXRUaXBzKHtkYXRhTGlzdDpvfSk7YnJlYWs7ZGVmYXVsdDpWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2dyb3VwVGlwc0hhbmRsZXIgdW5rbm93biBldmVudDpcIikuY29uY2F0KG4sXCIgZGF0YUxpc3Q6XCIpLG8pfX19fSx7a2V5OlwiX0MyQ05vdGlmeU1lc3NhZ2VBcnJheUhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49ZS5kYXRhTGlzdDtpZihhdChuKSl7dmFyIG89dGhpcy5fc2Vzc2lvbk1vZHVsZS5nZXRNb2R1bGUoVW4pO24uZm9yRWFjaCgoZnVuY3Rpb24oZSl7aWYoc3QoZSkpaWYoZS5oYXNPd25Qcm9wZXJ0eShcImtpY2tvdXRNc2dOb3RpZnlcIikpe3ZhciBzPWUua2lja291dE1zZ05vdGlmeSxhPXMua2lja1R5cGUsaT1zLm5ld0luc3RhbmNlSW5mbyxyPXZvaWQgMD09PWk/e306aTsxPT09YT90Ll9zZXNzaW9uTW9kdWxlLm9uTXVsdGlwbGVBY2NvdW50S2lja2VkT3V0KHIpOjI9PT1hP3QuX3Nlc3Npb25Nb2R1bGUub25NdWx0aXBsZURldmljZUtpY2tlZE91dChyKTozPT09YSYmdC5fc2Vzc2lvbk1vZHVsZS5vblJlc3RBcGlLaWNrZWRPdXQocil9ZWxzZSBpZihlLmhhc093blByb3BlcnR5KFwiYzJjTWVzc2FnZVJldm9rZWROb3RpZnlcIikpbyYmby5vbkMyQ01lc3NhZ2VSZXZva2VkKHtkYXRhTGlzdDpufSk7ZWxzZSBpZihlLmhhc093blByb3BlcnR5KFwiYzJjTWVzc2FnZVJlYWRSZWNlaXB0XCIpKW8mJm8ub25DMkNNZXNzYWdlUmVhZFJlY2VpcHQoe2RhdGFMaXN0Om59KTtlbHNlIGlmKGUuaGFzT3duUHJvcGVydHkoXCJjMmNNZXNzYWdlUmVhZE5vdGljZVwiKSlvJiZvLm9uQzJDTWVzc2FnZVJlYWROb3RpY2Uoe2RhdGFMaXN0Om59KTtlbHNlIGlmKGUuaGFzT3duUHJvcGVydHkoXCJtdXRlTm90aWZpY2F0aW9uc1N5bmNcIikpe3QuX3Nlc3Npb25Nb2R1bGUuZ2V0TW9kdWxlKHFuKS5vbkMyQ01lc3NhZ2VSZW1pbmRUeXBlU3luY2VkKHtkYXRhTGlzdDpufSl9fSkpfX19LHtrZXk6XCJfQzJDUmVhZFJlY2VpcHRBcnJheUhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShVbikub25SZWFkUmVjZWlwdExpc3QoZSl9fSx7a2V5OlwiX3Byb2ZpbGVIYW5kbGVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fc2Vzc2lvbk1vZHVsZS5nZXRNb2R1bGUoR24pLm9uUHJvZmlsZU1vZGlmaWVkKHtkYXRhTGlzdDplLmRhdGFMaXN0fSk7dmFyIHQ9dGhpcy5fc2Vzc2lvbk1vZHVsZS5nZXRNb2R1bGUoYm4pO3QmJnQub25GcmllbmRQcm9maWxlTW9kaWZpZWQoe2RhdGFMaXN0OmUuZGF0YUxpc3R9KX19LHtrZXk6XCJfcmVsYXRpb25DaGFpbkhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShHbikub25SZWxhdGlvbkNoYWluTW9kaWZpZWQoe2RhdGFMaXN0OmUuZGF0YUxpc3R9KTt2YXIgdD10aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShibik7dCYmdC5vblJlbGF0aW9uQ2hhaW5Nb2RpZmllZCh7ZGF0YUxpc3Q6ZS5kYXRhTGlzdH0pfX0se2tleTpcIl9yZWNlbnRDb250YWN0SGFuZGxlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZGF0YUxpc3Q7aWYoYXQodCkpe3ZhciBuPXRoaXMuX3Nlc3Npb25Nb2R1bGUuZ2V0TW9kdWxlKHFuKTtuJiZ0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUucHVzaFR5cGU7aWYoMT09PXQpe3ZhciBvPWUucmVjZW50Q29udGFjdERlbGV0ZUl0ZW07bi5vbkNvbnZlcnNhdGlvbkRlbGV0ZWQoby5yZWNlbnRDb250YWN0TGlzdCl9ZWxzZSBpZigyPT09dCl7dmFyIHM9ZS5yZWNlbnRDb250YWN0VG9wSXRlbTtuLm9uQ29udmVyc2F0aW9uUGlubmVkKHMucmVjZW50Q29udGFjdExpc3QpfWVsc2UgaWYoMz09PXQpe3ZhciBhPWUucmVjZW50Q29udGFjdFRvcEl0ZW07bi5vbkNvbnZlcnNhdGlvblVucGlubmVkKGEucmVjZW50Q29udGFjdExpc3QpfWVsc2UgaWYoND09PXQpe3ZhciBpPWUucmVjZW50Q29udGFjdE1hcmtDb250YWN0O24ub25Db252ZXJzYXRpb25NYXJrVXBkYXRlZChpLnJlY2VudENvbnRhY3RNYXJrQ29udGFjdEl0ZW0pfWVsc2UgaWYoNT09PXQpe3ZhciByPWUucmVjZW50Q29udGFjdENyZWF0ZUNvbnRhY3RHcm91cDtuLm9uQ29udmVyc2F0aW9uR3JvdXBDcmVhdGVkKHIubXNnQ29udGFjdEdyb3VwQ29udGFjdEl0ZW0pfWVsc2UgaWYoNj09PXQpe3ZhciB1PWUucmVjZW50Q29udGFjdERlbENvbnRhY3RHcm91cDtuLm9uQ29udmVyc2F0aW9uR3JvdXBEZWxldGVkKHUubXNnR3JvdXBJdGVtKX1lbHNlIGlmKDc9PT10KXt2YXIgYz1lLnJlY2VudENvbnRhY3RVcGRhdGVDb250YWN0R3JvdXAsbD1jLnVwZGF0ZVR5cGUsZD1jLm1zZ1VwZGF0ZUdyb3VwLHA9Yy5tc2dVcGRhdGVDb250YWN0O2lmKDE9PT1sKXt2YXIgZz1kLnVwZGF0ZUdyb3VwVHlwZTsxPT09Zz9uLm9uQ29udmVyc2F0aW9uR3JvdXBOYW1lVXBkYXRlZChkKToyPT09ZyYmbi5vbkNvbnZlcnNhdGlvbkluR3JvdXBVcGRhdGVkKGQpfWVsc2UgMj09PWwmJm4ub25Db252ZXJzYXRpb25BZGRlZFRvT3JEZWxldGVkRnJvbUdyb3VwKHApfX0pKX19fSx7a2V5OlwiX2FsbE1lc3NhZ2VSZWFkSGFuZGxlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZGF0YUxpc3Qsbj10aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShxbik7biYmbi5vblB1c2hlZEFsbE1lc3NhZ2VSZWFkKHQpfX0se2tleTpcIl91c2VyU3RhdHVzTGlzdEhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShHbikub25Vc2VyU3RhdHVzVXBkYXRlZChlKX19LHtrZXk6XCJfbWVzc2FnZUV4dGVuc2lvbk5vdGlmeUhhbmRsZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShPbikub25NZXNzYWdlRXh0ZW5zaW9uTm90aWZ5KGUpfX0se2tleTpcIm9uTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLmJvZHk7aWYodGhpcy5fZmlsdGVyTWVzc2FnZUZyb21JTU9wZW5QdXNoKGUpKXt2YXIgbz1uLmV2ZW50QXJyYXkscz1uLmlzSW5zdGFudE1lc3NhZ2UsYT1uLmlzU3luY2luZ0VuZGVkLGk9bi5uZWVkU3luYztpZihhdChvKSlmb3IodmFyIHI9bnVsbCx1PW51bGwsYz0wLGw9MCxkPW8ubGVuZ3RoO2w8ZDtsKyspe2M9KHI9b1tsXSkuZXZlbnQ7dmFyIHA9T2JqZWN0LmtleXMocikuZmluZCgoZnVuY3Rpb24oZSl7cmV0dXJuLTEhPT10Ll9rZXlzLmluZGV4T2YoZSl9KSk7cD8odT0xND09PWM/e3JlYWRBbGxDMkNNZXNzYWdlOnJbcF0sZ3JvdXBNZXNzYWdlUmVhZEluZm9MaXN0OnIuZ3JvdXBNZXNzYWdlUmVhZE5vdGljZXx8W119OjE2PT09Yz97dXNlcklEOnIudXNlcklELHJlYWRSZWNlaXB0TGlzdDpyW3BdfTpyW3BdLHRoaXMuX2V2ZW50SGFuZGxlck1hcC5nZXQocCkoe2V2ZW50OmMsZGF0YUxpc3Q6dSxpc0luc3RhbnRNZXNzYWdlOnMsaXNTeW5jaW5nRW5kZWQ6YSxuZWVkU3luYzppfSkpOlZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbk1lc3NhZ2UgdW5rbm93biBldmVudEl0ZW06XCIpLmNvbmNhdChyKSl9fX19LHtrZXk6XCJfZmlsdGVyTWVzc2FnZUZyb21JTU9wZW5QdXNoXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5oZWFkLG49ZS5ib2R5LG89dC5zZXJ2Y21kLHM9ITE7aWYoaXQobyl8fChzPW8uaW5jbHVkZXMoVi5OQU1FLklNX0NPTkZJR19NQU5BR0VSKXx8by5pbmNsdWRlcyhWLk5BTUUuT1ZFUkxPQURfUFVTSCl8fG8uaW5jbHVkZXMoVi5OQU1FLlNUQVRfU0VSVklDRSkpLCFzKXJldHVybiEwO2lmKG8uaW5jbHVkZXMoVi5DTUQuUFVTSEVEX0NMT1VEX0NPTlRST0xfQ09ORklHKSl0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE1vZHVsZShabikub25QdXNoZWRDbG91ZENvbnRyb2xDb25maWcobik7ZWxzZSBpZihvLmluY2x1ZGVzKFYuQ01ELlBVU0hFRF9DT01NRVJDSUFMX0NPTkZJRykpe3RoaXMuX3Nlc3Npb25Nb2R1bGUuZ2V0TW9kdWxlKHRvKS5vblB1c2hlZENvbmZpZyhuKX1lbHNlIGlmKG8uaW5jbHVkZXMoVi5DTUQuT1ZFUkxPQURfTk9USUZZKSl0aGlzLl9zZXNzaW9uTW9kdWxlLm9uUHVzaGVkU2VydmVyT3ZlcmxvYWQobik7ZWxzZSBpZihvLmluY2x1ZGVzKFYuQ01ELktJQ0tfT1RIRVIpKXt2YXIgYT1EYXRlLm5vdygpO3RoaXMuX3Nlc3Npb25Nb2R1bGUucmVMb2dpbk9uS2lja090aGVyKCk7dmFyIGk9bmV3IEFhKFwia2lja090aGVyXCIpLHI9dGhpcy5fc2Vzc2lvbk1vZHVsZS5nZXRNb2R1bGUoUm4pLmdldExhc3RXc0hlbGxvVHMoKSx1PWEtcjtpLnNldE1lc3NhZ2UoXCJsYXN0IHdzaGVsbG8gdGltZTpcIi5jb25jYXQocixcIiBkaWZmOlwiKS5jb25jYXQodSxcIm1zXCIpKS5zZXROZXR3b3JrVHlwZSh0aGlzLl9zZXNzaW9uTW9kdWxlLmdldE5ldHdvcmtUeXBlKCkpLmVuZCgpfXJldHVybiExfX1dKSxlfSgpLGpyPVt7Y21kOlYuQ01ELkdFVF9HUk9VUF9JTkZPLGludGVydmFsOjEsY291bnQ6MjB9LHtjbWQ6Vi5DTUQuR0VUX0FWQ0hBVFJPT01fTUVNQkVSX0xJU1QsaW50ZXJ2YWw6Myxjb3VudDoxfSx7Y21kOlYuQ01ELkdFVF9HUk9VUF9BUFBMSUNBVElPTixpbnRlcnZhbDoxLGNvdW50OjE1fSx7Y21kOlYuQ01ELkdFVF9UT1BJQ19MSVNULGludGVydmFsOjEsY291bnQ6MTB9LHtjbWQ6Vi5DTUQuU0VUX0dST1VQX0FUVFJJQlVURVMsaW50ZXJ2YWw6NSxjb3VudDoxMH0se2NtZDpWLkNNRC5NT0RJRllfR1JPVVBfQVRUUklCVVRFUyxpbnRlcnZhbDo1LGNvdW50OjEwfSx7Y21kOlYuQ01ELkRFTEVURV9HUk9VUF9BVFRSSUJVVEVTLGludGVydmFsOjUsY291bnQ6MTB9LHtjbWQ6Vi5DTUQuQ0xFQVJfR1JPVVBfQVRUUklCVVRFUyxpbnRlcnZhbDo1LGNvdW50OjEwfSx7Y21kOlYuQ01ELkdFVF9HUk9VUF9BVFRSSUJVVEVTLGludGVydmFsOjUsY291bnQ6MjB9LHtjbWQ6Vi5DTUQuVVBEQVRFX0dST1VQX0NPVU5URVIsaW50ZXJ2YWw6NSxjb3VudDoyMH0se2NtZDpWLkNNRC5HRVRfR1JPVVBfQ09VTlRFUixpbnRlcnZhbDo1LGNvdW50OjIwfSx7Y21kOlYuQ01ELlNFVF9BTExfTUVTU0FHRV9SRUFELGludGVydmFsOjEsY291bnQ6MX0se2NtZDpWLkNNRC5HRVRfVVNFUl9TVEFUVVMsaW50ZXJ2YWw6NSxjb3VudDoyMH0se2NtZDpWLkNNRC5TVUJTQ1JJQkVfVVNFUl9TVEFUVVMsaW50ZXJ2YWw6NSxjb3VudDoyMH0se2NtZDpWLkNNRC5VTlNVQlNDUklCRV9VU0VSX1NUQVRVUyxpbnRlcnZhbDo1LGNvdW50OjIwfV0senI9ZnVuY3Rpb24oZSl7cihzLGUpO3ZhciBuPWYocyk7ZnVuY3Rpb24gcyhlKXt2YXIgdDtyZXR1cm4gbyh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIlNlc3Npb25Nb2R1bGVcIix0Ll9wbGF0Zm9ybT10LmdldFBsYXRmb3JtKCksdC5fcHJvdG9jb2xIYW5kbGVyPW5ldyBLcihoKHQpKSx0Ll9tZXNzYWdlRGlzcGF0Y2hlcj1uZXcgWXIoaCh0KSksdC5fY29tbWFuZEZyZXF1ZW5jeUxpbWl0TWFwPW5ldyBNYXAsdC5fY29tbWFuZFJlcXVlc3RJbmZvTWFwPW5ldyBNYXAsdC5fc2VydmVyT3ZlcmxvYWRJbmZvTWFwPW5ldyBNYXAsdC5faW5pdCgpLHQuZ2V0SW5uZXJFbWl0dGVySW5zdGFuY2UoKS5vbih0aSx0Ll9vbkNsb3VkQ29uZmlnVXBkYXRlZCxoKHQpKSx0fXJldHVybiBhKHMsW3trZXk6XCJfaW5pdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fdXBkYXRlQ29tbWFuZEZyZXF1ZW5jeUxpbWl0TWFwKGpyKX19LHtrZXk6XCJfb25DbG91ZENvbmZpZ1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0Q2xvdWRDb25maWcoXCJjbWRfZnJlcXVlbmN5X2xpbWl0XCIpO2l0KGUpfHwoZT1KU09OLnBhcnNlKGUpLHRoaXMuX3VwZGF0ZUNvbW1hbmRGcmVxdWVuY3lMaW1pdE1hcChlKSl9fSx7a2V5OlwiX3VwZGF0ZUNvbW1hbmRGcmVxdWVuY3lMaW1pdE1hcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Ll9jb21tYW5kRnJlcXVlbmN5TGltaXRNYXAuc2V0KGUuY21kLHtpbnRlcnZhbDplLmludGVydmFsLGNvdW50OmUuY291bnR9KX0pKX19LHtrZXk6XCJ1cGRhdGVQcm90b2NvbENvbmZpZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fcHJvdG9jb2xIYW5kbGVyLnVwZGF0ZSgpfX0se2tleTpcInJlcXVlc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVxdWVzdCBvcHRpb25zOlwiKSxlKTt2YXIgdD1lLnByb3RvY29sTmFtZSxuPWUudGpnSUQ7aWYoIXRoaXMuX3Byb3RvY29sSGFuZGxlci5oYXModCkpcmV0dXJuIFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXF1ZXN0IHVua25vd24gcHJvdG9jb2w6XCIpLmNvbmNhdCh0KSksWmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfUFJPVE9DT0x9KTt2YXIgbz10aGlzLmdldFByb3RvY29sRGF0YShlKSxzPW8uaGVhZC5zZXJ2Y21kO2lmKHRoaXMuX2lzRnJlcXVlbmN5T3ZlckxpbWl0KHMpKXJldHVybiBaYSh7Y29kZTpoYS5PVkVSX0ZSRVFVRU5DWV9MSU1JVH0pO2lmKHRoaXMuX2lzU2VydmVyT3ZlcmxvYWQocykpcmV0dXJuIFphKHtjb2RlOmhhLk9QRU5fU0VSVklDRV9PVkVSTE9BRF9FUlJPUn0pO3p0KG4pfHwoby5oZWFkLnRqZ0lEPW4pO3ZhciBhPXRoaXMuZ2V0TW9kdWxlKEpuKTtyZXR1cm4gV3IuaW5jbHVkZXModCk/YS5zaW1wbHlTZW5kKG8pOmEuc2VuZChvKX19LHtrZXk6XCJnZXRLZXlNYXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fcHJvdG9jb2xIYW5kbGVyLmdldEtleU1hcChlKX19LHtrZXk6XCJnZW5Db21tb25IZWFkXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldE1vZHVsZSh4bik7cmV0dXJue3ZlcjpcInY0XCIscGxhdGZvcm06dGhpcy5fcGxhdGZvcm0sd2Vic2RrYXBwaWQ6Tyx3ZWJzZGt2ZXJzaW9uOk4sYTI6ZS5nZXRBMktleSgpfHx2b2lkIDAsdGlueWlkOmUuZ2V0VGlueUlEKCl8fHZvaWQgMCxzdGF0dXNfaW5zdGlkOmUuZ2V0U3RhdHVzSW5zdGFuY2VJRCgpLHNka2FwcGlkOmUuZ2V0U0RLQXBwSUQoKSxjb250ZW50dHlwZTplLmdldENvbnRlbnRUeXBlKCkscmVxdGltZTowLGlkZW50aWZpZXI6ZS5nZXRBMktleSgpP3ZvaWQgMDplLmdldFVzZXJJRCgpLHVzZXJzaWc6ZS5nZXRBMktleSgpP3ZvaWQgMDplLmdldFVzZXJTaWcoKSxzZGthYmlsaXR5OjE5MjM3MSx0amdJRDpcIlwifX19LHtrZXk6XCJnZW5Db3NTcGVjaWZpZWRIZWFkXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldE1vZHVsZSh4bik7cmV0dXJue3ZlcjpcInY0XCIscGxhdGZvcm06dGhpcy5fcGxhdGZvcm0sd2Vic2RrYXBwaWQ6Tyx3ZWJzZGt2ZXJzaW9uOk4sc2RrYXBwaWQ6ZS5nZXRTREtBcHBJRCgpLGNvbnRlbnR0eXBlOmUuZ2V0Q29udGVudFR5cGUoKSxyZXF0aW1lOjAsaWRlbnRpZmllcjplLmdldFVzZXJJRCgpLHVzZXJzaWc6ZS5nZXRVc2VyU2lnKCksc3RhdHVzX2luc3RpZDplLmdldFN0YXR1c0luc3RhbmNlSUQoKSxzZGthYmlsaXR5OjE5MjM3MX19fSx7a2V5OlwiZ2VuU1NPUmVwb3J0SGVhZFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRNb2R1bGUoeG4pO3JldHVybnt2ZXI6XCJ2NFwiLHBsYXRmb3JtOnRoaXMuX3BsYXRmb3JtLHdlYnNka2FwcGlkOk8sd2Vic2RrdmVyc2lvbjpOLHNka2FwcGlkOmUuZ2V0U0RLQXBwSUQoKSxjb250ZW50dHlwZTpcIlwiLHJlcXRpbWU6MCxpZGVudGlmaWVyOlwiXCIsdXNlcnNpZzpcIlwiLHN0YXR1c19pbnN0aWQ6ZS5nZXRTdGF0dXNJbnN0YW5jZUlEKCksc2RrYWJpbGl0eToxOTIzNzF9fX0se2tleTpcImdldFByb3RvY29sRGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9wcm90b2NvbEhhbmRsZXIuZ2V0UHJvdG9jb2xEYXRhKGUpfX0se2tleTpcInRyYW5zXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIG49ZS5zZXJ2Y21kLG89ZS5kYXRhLHM9e2hlYWQ6dCh0KHt9LHRoaXMuZ2VuQ29tbW9uSGVhZCgpKSx7fSx7c2VydmNtZDpufSksYm9keTpvfTtyZXR1cm4gdGhpcy5nZXRNb2R1bGUoSm4pLnNlbmQocyl9fSx7a2V5Olwic2VuZENvbWJvTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciBuPWUuc2VydmNtZCxvPWUuZGF0YSxzPXtoZWFkOnQodCh7fSx0aGlzLmdlbkNvbW1vbkhlYWQoKSkse30se3NlcnZjbWQ6bn0pLGJvZHk6b307cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKEpuKS5zZW5kKHMpfX0se2tleTpcIm9uRXJyb3JDb2RlTm90WmVyb1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZXJyb3JDb2RlO2lmKHQ9PT1oYS5IRUxMT19BTlNXRVJfS0lDS0VEX09VVCl7dmFyIG49ZS5raWNrVHlwZSxvPWUubmV3SW5zdGFuY2VJbmZvLHM9dm9pZCAwPT09bz97fTpvOzE9PT1uP3RoaXMub25NdWx0aXBsZUFjY291bnRLaWNrZWRPdXQocyk6Mj09PW4/dGhpcy5vbk11bHRpcGxlRGV2aWNlS2lja2VkT3V0KHMpOjM9PT1uJiZ0aGlzLm9uUmVzdEFwaUtpY2tlZE91dChzKX10IT09aGEuTUVTU0FHRV9BMktFWV9FWFBJUkVEJiZ0IT09aGEuQUNDT1VOVF9BMktFWV9FWFBJUkVEfHwodGhpcy5fb25Vc2VyU2lnRXhwaXJlZCgpLHRoaXMuZ2V0TW9kdWxlKEpuKS5yZUNvbm5lY3QoKSl9fSx7a2V5Olwib25NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ib2R5LG49dC5uZWVkQWNrLG89dm9pZCAwPT09bj8wOm4scz10LnNlc3Npb25EYXRhOzE9PT1vJiZ0aGlzLl9zZW5kQUNLKHMpLHRoaXMuX21lc3NhZ2VEaXNwYXRjaGVyLm9uTWVzc2FnZShlKX19LHtrZXk6XCJvblJlY29ubmVjdGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9yZUxvZ2luT25SZWNvbm5lY3RlZCgpfX0se2tleTpcInJlTG9naW5PbktpY2tPdGhlclwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlTG9naW5PbktpY2tPdGhlclwiKSksdGhpcy5fcmVMb2dpbigpfX0se2tleTpcIl9yZUxvZ2luT25SZWNvbm5lY3RlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9yZUxvZ2luT25SZWNvbm5lY3RlZFwiKSksdGhpcy5fcmVMb2dpbigpfX0se2tleTpcIl9yZUxvZ2luXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2lmKHRoaXMuaXNMb2dnZWRJbigpKXt2YXIgdD0wLG49dGhpcy5nZXRNb2R1bGUobm8pO24uY2FuSVVzZU9mZmxpbmVQdXNoKCkmJih0PW4uZ2V0VW5pQXBwUGxhdGZvcm0oKSksdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6Y28scmVxdWVzdERhdGE6e2lzV2ViVW5pYXBwOnR9fSkudGhlbigoZnVuY3Rpb24odCl7dmFyIG49dC5kYXRhLmluc3RhbmNlSUQ7ZS5nZXRNb2R1bGUoeG4pLnNldFN0YXR1c0luc3RhbmNlSUQobiksVmUubChcIlwiLmNvbmNhdChlLl9uLFwiLl9yZUxvZ2luIG9rLlwiKSksZS5nZXRNb2R1bGUocW4pLnN5bmNDb252ZXJzYXRpb25MaXN0KCkudGhlbigoZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KGUuX24sXCIuX3JlTG9naW4sIHN5bmMgY29udmVyc2F0aW9uIGxpc3Qgb2suXCIpKSxlLmdldE1vZHVsZSgkbikuc3RhcnQoKX0pKSxlLmdldE1vZHVsZShQbikudXBkYXRlTG9jYWxNYWluU2VxdWVuY2VPblJlY29ubmVjdGVkKCk7dmFyIG89ZS5nZXRNb2R1bGUoRm4pO28ucmVzZXRHZXRUb3BpY1RpbWUoKSxvLmdldFRvcGljTGlzdE9uUmVjb25uZWN0ZWQoKX0pKX19fSx7a2V5Olwib25NdWx0aXBsZUFjY291bnRLaWNrZWRPdXRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmdldE1vZHVsZShSbikub25NdWx0aXBsZUFjY291bnRLaWNrZWRPdXQoZSl9fSx7a2V5Olwib25NdWx0aXBsZURldmljZUtpY2tlZE91dFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZ2V0TW9kdWxlKFJuKS5vbk11bHRpcGxlRGV2aWNlS2lja2VkT3V0KGUpfX0se2tleTpcIl9vblVzZXJTaWdFeHBpcmVkXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLmdldE1vZHVsZShSbikub25Vc2VyU2lnRXhwaXJlZCgpfX0se2tleTpcIm9uUmVzdEFwaUtpY2tlZE91dFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuZ2V0TW9kdWxlKFJuKS5vblJlc3RBcGlLaWNrZWRPdXQoZSl9fSx7a2V5OlwiX3NlbmRBQ0tcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpZcyxyZXF1ZXN0RGF0YTp7c2Vzc2lvbkRhdGE6ZX19KX19LHtrZXk6XCJfaXNGcmVxdWVuY3lPdmVyTGltaXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnNwbGl0KFwiLlwiKVsxXTtpZighdGhpcy5fY29tbWFuZEZyZXF1ZW5jeUxpbWl0TWFwLmhhcyh0KSlyZXR1cm4hMTtpZighdGhpcy5fY29tbWFuZFJlcXVlc3RJbmZvTWFwLmhhcyh0KSlyZXR1cm4gdGhpcy5fY29tbWFuZFJlcXVlc3RJbmZvTWFwLnNldCh0LHtzdGFydFRpbWU6RGF0ZS5ub3coKSxyZXF1ZXN0Q291bnQ6MX0pLCExO3ZhciBuPXRoaXMuX2NvbW1hbmRGcmVxdWVuY3lMaW1pdE1hcC5nZXQodCksbz1uLmNvdW50LHM9bi5pbnRlcnZhbCxhPXRoaXMuX2NvbW1hbmRSZXF1ZXN0SW5mb01hcC5nZXQodCksaT1hLnN0YXJ0VGltZSxyPWEucmVxdWVzdENvdW50O2lmKERhdGUubm93KCktaT4xZTMqcylyZXR1cm4gdGhpcy5fY29tbWFuZFJlcXVlc3RJbmZvTWFwLnNldCh0LHtzdGFydFRpbWU6RGF0ZS5ub3coKSxyZXF1ZXN0Q291bnQ6MX0pLCExO3IrPTEsdGhpcy5fY29tbWFuZFJlcXVlc3RJbmZvTWFwLnNldCh0LHtzdGFydFRpbWU6aSxyZXF1ZXN0Q291bnQ6cn0pO3ZhciB1PSExO3JldHVybiByPm8mJih1PSEwKSx1fX0se2tleTpcIl9pc1NlcnZlck92ZXJsb2FkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoIXRoaXMuX3NlcnZlck92ZXJsb2FkSW5mb01hcC5oYXMoZSkpcmV0dXJuITE7dmFyIHQ9dGhpcy5fc2VydmVyT3ZlcmxvYWRJbmZvTWFwLmdldChlKSxuPXQub3ZlcmxvYWRUaW1lLG89dC53YWl0aW5nVGltZSxzPSExO3JldHVybiBEYXRlLm5vdygpLW48PTFlMypvP3M9ITA6KHRoaXMuX3NlcnZlck92ZXJsb2FkSW5mb01hcC5kZWxldGUoZSkscz0hMSksc319LHtrZXk6XCJvblB1c2hlZFNlcnZlck92ZXJsb2FkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5vdmVybG9hZENvbW1hbmQsbj1lLndhaXRpbmdUaW1lO3RoaXMuX3NlcnZlck92ZXJsb2FkSW5mb01hcC5zZXQodCx7b3ZlcmxvYWRUaW1lOkRhdGUubm93KCksd2FpdGluZ1RpbWU6bn0pLFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vblB1c2hlZFNlcnZlck92ZXJsb2FkIHdhaXRpbmdUaW1lOlwiKS5jb25jYXQobixcInNcIikpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX3VwZGF0ZUNvbW1hbmRGcmVxdWVuY3lMaW1pdE1hcChqciksdGhpcy5fY29tbWFuZFJlcXVlc3RJbmZvTWFwLmNsZWFyKCksdGhpcy5fc2VydmVyT3ZlcmxvYWRJbmZvTWFwLmNsZWFyKCl9fV0pLHN9KHVvKSxKcj1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9uPVwiTWVzc2FnZUxvc3NEZXRlY3Rpb25Nb2R1bGVcIixzLl9tYXliZUxvc3RTZXF1ZW5jZXNNYXA9bmV3IE1hcCxzLl9maXJzdFJvdW5kUmV0PVtdLHN9cmV0dXJuIGEobixbe2tleTpcIm9uTWVzc2FnZU1heWJlTG9zdFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXt0aGlzLl9tYXliZUxvc3RTZXF1ZW5jZXNNYXAuaGFzKGUpfHx0aGlzLl9tYXliZUxvc3RTZXF1ZW5jZXNNYXAuc2V0KGUsW10pO2Zvcih2YXIgbz10aGlzLl9tYXliZUxvc3RTZXF1ZW5jZXNNYXAuZ2V0KGUpLHM9MDtzPG47cysrKS0xPT09by5pbmRleE9mKHQrcykmJm8ucHVzaCh0K3MpfX0se2tleTpcImRldGVjdEZpcnN0Um91bmRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuX21heWJlTG9zdFNlcXVlbmNlc01hcC5nZXQoZSk7aWYoIXp0KG4pJiYhenQodCkpe3ZhciBvPW4uZmlsdGVyKChmdW5jdGlvbihlKXtyZXR1cm4tMT09PXQuaW5kZXhPZihlKX0pKTswPT09by5sZW5ndGg/VmUuaShcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmRldGVjdEZpcnN0Um91bmQgbm8gbWVzc2FnZSBsb3NzLiBjb252ZXJzYXRpb25JRDpcIikuY29uY2F0KGUpKTp0aGlzLl9maXJzdFJvdW5kUmV0PXRoaXMuX2ZpcnN0Um91bmRSZXQuY29uY2F0KG8pLG4ubGVuZ3RoPTB9fX0se2tleTpcImRldGVjdFNlY29uZFJvdW5kXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtpZighenQodGhpcy5fZmlyc3RSb3VuZFJldCkmJiF6dCh0KSl7dmFyIG49dGhpcy5fZmlyc3RSb3VuZFJldC5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybi0xPT09dC5pbmRleE9mKGUpfSkpO3RoaXMuX2ZpcnN0Um91bmRSZXQubGVuZ3RoPTA7dmFyIG8scz1uLmxlbmd0aDtpZigwIT09cylzPD01P289ZStcIi1cIituLmpvaW4oXCItXCIpOihuLnNvcnQoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUtdH0pKSxvPWUrXCIgc3RhcnQ6XCIrblswXStcIiBlbmQ6XCIrbltzLTFdK1wiIGNvdW50OlwiK3MpLG5ldyBBYShcIm1lc3NhZ2VMb3NzXCIpLnNldE1lc3NhZ2Uobykuc2V0TmV0d29ya1R5cGUodGhpcy5nZXROZXR3b3JrVHlwZSgpKS5zZXRMZXZlbChcIndhcm5pbmdcIikuZW5kKCksVmUuaShcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmRldGVjdFNlY29uZFJvdW5kIG1lc3NhZ2UgbG9zcyBkZXRlY3RlZC4gY29udmVyc2F0aW9uSUQ6XCIpLmNvbmNhdChlLFwiIGxvc3RTZXF1ZW5jZXM6XCIpLmNvbmNhdChuKSl9fX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX21heWJlTG9zdFNlcXVlbmNlc01hcC5jbGVhcigpLHRoaXMuX2ZpcnN0Um91bmRSZXQubGVuZ3RoPTB9fV0pLG59KHVvKSxYcj1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9uPVwiQ2xvdWRDb250cm9sTW9kdWxlXCIscy5fY2xvdWRDb25maWc9bmV3IE1hcCxzLl9leHBpcmVkVGltZT0wLHMuX3ZlcnNpb249MCxzLl9pc0ZldGNoaW5nPSExLHN9cmV0dXJuIGEobixbe2tleTpcImdldENsb3VkQ29uZmlnXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGl0KGUpP3RoaXMuX2Nsb3VkQ29uZmlnOnRoaXMuX2Nsb3VkQ29uZmlnLmhhcyhlKT90aGlzLl9jbG91ZENvbmZpZy5nZXQoZSk6dm9pZCAwfX0se2tleTpcIl9jYW5GZXRjaENvbmZpZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNMb2dnZWRJbigpJiYhdGhpcy5faXNGZXRjaGluZyYmRGF0ZS5ub3coKT49dGhpcy5fZXhwaXJlZFRpbWV9fSx7a2V5OlwiZmV0Y2hDb25maWdcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMsdD10aGlzLl9jYW5GZXRjaENvbmZpZygpO2lmKFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5mZXRjaENvbmZpZyBjYW5GZXRjaENvbmZpZzpcIikuY29uY2F0KHQpKSx0KXt2YXIgbj1uZXcgQWEoXCJmZXRjaENsb3VkQ29udHJvbENvbmZpZ1wiKSxvPXRoaXMuZ2V0TW9kdWxlKHhuKS5nZXRTREtBcHBJRCgpO3RoaXMuX2lzRmV0Y2hpbmc9ITAsdGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6WHMscmVxdWVzdERhdGE6e1NES0FwcElEOm8sdmVyc2lvbjp0aGlzLl92ZXJzaW9ufX0pLnRoZW4oKGZ1bmN0aW9uKHQpe2UuX2lzRmV0Y2hpbmc9ITEsbi5zZXRNZXNzYWdlKFwidmVyc2lvbjpcIi5jb25jYXQoZS5fdmVyc2lvbixcIiBuZXdWZXJzaW9uOlwiKS5jb25jYXQodC5kYXRhLnZlcnNpb24sXCIgY29uZmlnOlwiKS5jb25jYXQodC5kYXRhLmNsb3VkQ29udHJvbENvbmZpZykpLnNldE5ldHdvcmtUeXBlKGUuZ2V0TmV0d29ya1R5cGUoKSkuZW5kKCksVmUubChcIlwiLmNvbmNhdChlLl9uLFwiLmZldGNoQ29uZmlnIG9rXCIpKSxlLl9wYXJzZUNsb3VkQ29udHJvbENvbmZpZyh0LmRhdGEpfSkpLmNhdGNoKChmdW5jdGlvbih0KXtlLl9pc0ZldGNoaW5nPSExLGUucHJvYmVOZXR3b3JrKCkudGhlbigoZnVuY3Rpb24oZSl7dmFyIG89dihlLDIpLHM9b1swXSxhPW9bMV07bi5zZXRFcnJvcih0LHMsYSkuZW5kKCl9KSksVmUubChcIlwiLmNvbmNhdChlLl9uLFwiLmZldGNoQ29uZmlnIGZhaWxlZC4gZXJyb3I6XCIpLHQpLGUuX3NldEV4cGlyZWRUaW1lT25SZXNwb25zZUVycm9yKDEyZTQpfSkpfX19LHtrZXk6XCJvblB1c2hlZENsb3VkQ29udHJvbENvbmZpZ1wiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vblB1c2hlZENsb3VkQ29udHJvbENvbmZpZ1wiKSksbmV3IEFhKFwicHVzaGVkQ2xvdWRDb250cm9sQ29uZmlnXCIpLnNldE5ldHdvcmtUeXBlKHRoaXMuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcIm5ld1ZlcnNpb246XCIuY29uY2F0KGUudmVyc2lvbixcIiBjb25maWc6XCIpLmNvbmNhdChlLmNsb3VkQ29udHJvbENvbmZpZykpLmVuZCgpLHRoaXMuX3BhcnNlQ2xvdWRDb250cm9sQ29uZmlnKGUpfX0se2tleTpcIm9uQ2hlY2tUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NhbkZldGNoQ29uZmlnKCkmJnRoaXMuZmV0Y2hDb25maWcoKX19LHtrZXk6XCJfcGFyc2VDbG91ZENvbnRyb2xDb25maWdcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLG49XCJcIi5jb25jYXQodGhpcy5fbixcIi5fcGFyc2VDbG91ZENvbnRyb2xDb25maWdcIiksbz1lLmVycm9yQ29kZSxzPWUuZXJyb3JNZXNzYWdlLGE9ZS5jbG91ZENvbnRyb2xDb25maWcsaT1lLnZlcnNpb24scj1lLmV4cGlyZWRUaW1lO2lmKDA9PT1vKXtpZih0aGlzLl92ZXJzaW9uIT09aSl7dmFyIHU9bnVsbDt0cnl7dT1KU09OLnBhcnNlKGEpfWNhdGNoKGMpe3RoaXMuaXNQcml2YXRlTmV0V29yaygpfHxWZS5lKFwiXCIuY29uY2F0KG4sXCIgSlNPTiBwYXJzZSBlcnJvci4gY2xvdWRDb250cm9sQ29uZmlnOlwiKSxhKX11JiYodGhpcy5fY2xvdWRDb25maWcuY2xlYXIoKSxPYmplY3Qua2V5cyh1KS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Ll9jbG91ZENvbmZpZy5zZXQoZSx1W2VdKX0pKSx0aGlzLl92ZXJzaW9uPWksdGhpcy5lbWl0SW5uZXJFdmVudCh0aSkpfXRoaXMuX2V4cGlyZWRUaW1lPURhdGUubm93KCkrMWUzKnJ9ZWxzZSBpdChvKT8oVmUubChcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gSW52YWxpZCBtZXNzYWdlIGZvcm1hdDpcIiksZSksdGhpcy5fc2V0RXhwaXJlZFRpbWVPblJlc3BvbnNlRXJyb3IoMzZlNSkpOihWZS5lKFwiXCIuY29uY2F0KG4sXCIgZXJyb3JDb2RlOlwiKS5jb25jYXQobyxcIiBlcnJvck1lc3NhZ2U6XCIpLmNvbmNhdChzKSksdGhpcy5fc2V0RXhwaXJlZFRpbWVPblJlc3BvbnNlRXJyb3IoMTJlNCkpfX0se2tleTpcIl9zZXRFeHBpcmVkVGltZU9uUmVzcG9uc2VFcnJvclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2V4cGlyZWRUaW1lPURhdGUubm93KCkrZX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKSx0aGlzLl9jbG91ZENvbmZpZy5jbGVhcigpLHRoaXMuX2V4cGlyZWRUaW1lPTAsdGhpcy5fdmVyc2lvbj0wLHRoaXMuX2lzRmV0Y2hpbmc9ITF9fV0pLG59KHVvKSxacj1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9uPVwiUmVjb3Zlck1lc3NhZ2VNb2R1bGVcIixzLlBVTExfTElNSVRfQ09VTlQ9MTUsc31yZXR1cm4gYShuLFt7a2V5Olwic3RhcnRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3JlY292ZXJHcm91cENoYXQoKSx0aGlzLl9yZWNvdmVyQzJDQ2hhdCgpfX0se2tleTpcIl9yZWNvdmVyR3JvdXBDaGF0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZSx0LG49dGhpcyxvPXRoaXMuX2dldExvY2FsQ29udmVyc2F0aW9uTGlzdCgpLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGUudHlwZT09PUUuQ09OVl9HUk9VUCYmZS5ncm91cFByb2ZpbGUudHlwZSE9PUUuR1JQX0FWQ0hBVFJPT019KSkscz10aGlzLmdldE1vZHVsZShxbiksYT0wLGk9MCxyPTA7by5mb3JFYWNoKChmdW5jdGlvbihvKXt2YXIgdT1vLmNvbnZlcnNhdGlvbklELGM9by5sYXN0TWVzc2FnZTt0PXUucmVwbGFjZShFLkNPTlZfR1JPVVAsXCJcIiksZT1zLmdldExvY2FsTGFzdE1lc3NhZ2UodSksYyYmMCE9PWMubGFzdFNlcXVlbmNlJiZlPyhpPWMubGFzdFNlcXVlbmNlLGE9ZS5zZXF1ZW5jZSxyPWktYSxhPjAmJnI+PTEmJnI8MzAwP24uX3JlY292ZXJHcm91cE1lc3NhZ2Uoe2dyb3VwSUQ6dCxsb2NhbExhc3RNZXNzYWdlU2VxdWVuY2U6YSxyZW1vdGVMYXN0TWVzc2FnZVNlcXVlbmNlOml9KTpuLl9nZXRHcm91cE5vdGlmeSh0KSk6bi5fZ2V0R3JvdXBOb3RpZnkodCl9KSl9fSx7a2V5OlwiX3JlY292ZXJDMkNDaGF0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZSx0PXRoaXMsbj10aGlzLl9nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKS5maWx0ZXIoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT1FLkNPTlZfQzJDfSkpLG89dGhpcy5nZXRNb2R1bGUocW4pLHM9MCxhPTAsaT0wLHI9W1Byb21pc2UucmVzb2x2ZSgpXTtuLmZvckVhY2goKGZ1bmN0aW9uKG4pe3ZhciB1PW4uY29udmVyc2F0aW9uSUQsYz1uLmxhc3RNZXNzYWdlO2U9by5nZXRMb2NhbExhc3RNZXNzYWdlKHUpLGMmJjAhPT1jLmxhc3RUaW1lJiZlJiYoYT1jLmxhc3RUaW1lLHM9ZS50aW1lLGk9YS1zLHM+MCYmaT49MSYmaTw9NjAwJiZyLnB1c2godC5fcmVjb3ZlckMyQ01lc3NhZ2Uoe2NvbnZlcnNhdGlvbklEOnUsbG9jYWxMYXN0TWVzc2FnZVRpbWU6cyxyZW1vdGVMYXN0TWVzc2FnZVRpbWU6YX0pKSl9KSksUHJvbWlzZS5hbGwocikudGhlbigoZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHQuX24sXCIuX3JlY292ZXJDMkNDaGF0IGFsbCBwcm9taXNlIGZ1bGZpbGxlZCwgc3RhcnQgdG8gc3luYyB1bnJlYWQgbWVzc2FnZXNcIikpLHQuZ2V0TW9kdWxlKGpuKS5zdGFydFN5bmNPblJlY29ubmVjdGVkKCl9KSl9fSx7a2V5OlwiX2dldExvY2FsQ29udmVyc2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TW9kdWxlKHFuKS5nZXRMb2NhbENvbnZlcnNhdGlvbkxpc3QoKX19LHtrZXk6XCJfcmVjb3Zlckdyb3VwTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9yZWNvdmVyR3JvdXBNZXNzYWdlXCIpO1ZlLmwoXCJcIi5jb25jYXQobixcIiBvcHRpb25zOlwiKSxlKTt2YXIgbz1lLmdyb3VwSUQscz1lLmxvY2FsTGFzdE1lc3NhZ2VTZXF1ZW5jZSxhPWUucmVtb3RlTGFzdE1lc3NhZ2VTZXF1ZW5jZTt0aGlzLl9nZXRHcm91cFJvbWFpbmdNZXNzYWdlKHtncm91cElEOm8sc2VxdWVuY2U6c30pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBzPWUuZGF0YSxpPXMuY29tcGxldGUscj1zLm1lc3NhZ2VMaXN0O2lmKCFpdChyKSl7dmFyIHU9clswXS5zZXF1ZW5jZTtWZS5sKFwiXCIuY29uY2F0KG4sXCIgcGtnTGFzdE1lc3NhZ2VTZXF1ZW5jZTpcIikuY29uY2F0KHUsXCIgY29tcGxldGU6XCIpLmNvbmNhdChpKSksdTxhJiYyIT09aSYmdC5fcmVjb3Zlckdyb3VwTWVzc2FnZSh7Z3JvdXBJRDpvLGxvY2FsTGFzdE1lc3NhZ2VTZXF1ZW5jZTp1LHJlbW90ZUxhc3RNZXNzYWdlU2VxdWVuY2U6YX0pLG5ldyBBYShcInJlY292ZXJNZXNzYWdlXCIpLnNldE5ldHdvcmtUeXBlKHQuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcImdyb3VwSUQ6XCIuY29uY2F0KG8sXCIgY29tcGxldGU6XCIpLmNvbmNhdChpLFwiIG1lc3NhZ2VMaXN0IGxlbmd0aDpcIikuY29uY2F0KHIubGVuZ3RoKSkuZW5kKCk7dmFyIGM9dC5nZXRNb2R1bGUoUG4pO3IubGVuZ3RoPjEmJnIuc29ydCgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5zZXF1ZW5jZS10LnNlcXVlbmNlfSkpO2Zvcih2YXIgbD0wO2w8ci5sZW5ndGg7bCsrKXt2YXIgZD1yW2xdO2QuZnJvbSE9PUUuQ09OVl9TWVNURU0/Yy5vbk5ld0dyb3VwTWVzc2FnZSh7ZGF0YUxpc3Q6W2RdLGlzSW5zdGFudE1lc3NhZ2U6ITEsdXBkYXRlVW5yZWFkQ291bnQ6ITF9KTpjLm9uTmV3R3JvdXBUaXBzKHtldmVudDpkLmV2ZW50LGRhdGFMaXN0OltkXX0pfXQuX2dldEdyb3VwTm90aWZ5KG8pfX0pKX19LHtrZXk6XCJfZ2V0R3JvdXBOb3RpZnlcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmdldE1vZHVsZShQbikuZ2V0R3JvdXBOb3RpZnkoZSl9fSx7a2V5OlwiX2dldEdyb3VwUm9tYWluZ01lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmdyb3VwSUQsbj1lLnNlcXVlbmNlO3JldHVybiB0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpjcyxyZXF1ZXN0RGF0YTp7Z3JvdXBJRDp0LGNvdW50OnRoaXMuUFVMTF9MSU1JVF9DT1VOVCxzZXF1ZW5jZTpuK3RoaXMuUFVMTF9MSU1JVF9DT1VOVC0xfX0pfX0se2tleTpcIl9yZWNvdmVyQzJDTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9yZWNvdmVyQzJDTWVzc2FnZVwiKTtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3JlY292ZXJDMkNNZXNzYWdlIG9wdGlvbnM6XCIpLGUpO3ZhciBvPWUuY29udmVyc2F0aW9uSUQscz1lLmxvY2FsTGFzdE1lc3NhZ2VUaW1lLGE9ZS5yZW1vdGVMYXN0TWVzc2FnZVRpbWU7cmV0dXJuIHRoaXMuX2dldEMyQ1JvYW1pbmdNZXNzYWdlKHtjb252ZXJzYXRpb25JRDpvLHRpbWU6c30pLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBzPWUuZGF0YSxpPXMuY29tcGxldGUscj1zLm1lc3NhZ2VMaXN0O2lmKCFpdChyKSl7dmFyIHU9ci5sZW5ndGg7bmV3IEFhKFwicmVjb3Zlck1lc3NhZ2VcIikuc2V0TmV0d29ya1R5cGUodC5nZXROZXR3b3JrVHlwZSgpKS5zZXRNZXNzYWdlKFwiXCIuY29uY2F0KG8sXCIgY29tcGxldGU6XCIpLmNvbmNhdChpLFwiIG1lc3NhZ2VMaXN0IGxlbmd0aDpcIikuY29uY2F0KHUpKS5lbmQoKSx0LmdldE1vZHVsZShVbikub25OZXdDMkNNZXNzYWdlKHtkYXRhTGlzdDpyLGlzSW5zdGFudE1lc3NhZ2U6ITB9KTt2YXIgYz1yW3UtMV0udGltZTtpZihWZS5sKFwiXCIuY29uY2F0KG4sXCIgcGtnTGFzdE1lc3NhZ2VUaW1lOlwiKS5jb25jYXQoYyxcIiBjb21wbGV0ZTpcIikuY29uY2F0KGkpKSxjPGEmJjEhPT1pKXJldHVybiB0Ll9yZWNvdmVyQzJDTWVzc2FnZSh7Y29udmVyc2F0aW9uSUQ6byxsb2NhbExhc3RNZXNzYWdlVGltZTpjLHJlbW90ZUxhc3RNZXNzYWdlVGltZTphfSl9fSkpfX0se2tleTpcIl9nZXRDMkNSb2FtaW5nTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuY29udmVyc2F0aW9uSUQsbj1lLnRpbWU7cmV0dXJuIHRoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOlNvLHJlcXVlc3REYXRhOntwZWVyQWNjb3VudDp0LnJlcGxhY2UoRS5DT05WX0MyQyxcIlwiKSxjb3VudDp0aGlzLlBVTExfTElNSVRfQ09VTlQrMSxsYXN0TWVzc2FnZVRpbWU6bixkaXJlY3Rpb246MX19KX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKX19XSksbn0odW8pLFFyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe28odGhpcyxlKSx0aGlzLl9uPVwiQXZnRTJFRGVsYXlcIix0aGlzLl9lMmVEZWxheUFycmF5PVtdfXJldHVybiBhKGUsW3trZXk6XCJhZGRNZXNzYWdlRGVsYXlcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD13ZSgpLWU7dD49MCYmdGhpcy5fZTJlRGVsYXlBcnJheS5wdXNoKHQpfX0se2tleTpcIl9jYWxjQXZnXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtpZigwPT09dClyZXR1cm4gMDt2YXIgbj0wO3JldHVybiBlLmZvckVhY2goKGZ1bmN0aW9uKGUpe24rPWV9KSksd3Qobi90LDEpfX0se2tleTpcIl9jYWxjQ291bnRXaXRoTGltaXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmUyZURlbGF5QXJyYXksbj1lLm1pbixvPWUubWF4O3JldHVybiB0LmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIG48PWUmJmU8b30pKS5sZW5ndGh9fSx7a2V5OlwiX2NhbGNQZXJjZW50XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj13dChlL3QqMTAwLDIpO3JldHVybiBuPjEwMCYmKG49MTAwKSxufX0se2tleTpcIl9jaGVja0UyRURlbGF5RXhjZXB0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmZpbHRlcigoZnVuY3Rpb24oZSl7cmV0dXJuIGU+dH0pKTtpZihuLmxlbmd0aD4wKXt2YXIgbz1uLmxlbmd0aCxzPU1hdGgubWluLmFwcGx5KE1hdGgsbShuKSksYT1NYXRoLm1heC5hcHBseShNYXRoLG0obikpLGk9dGhpcy5fY2FsY0F2ZyhuLG8pLHI9d3Qoby9lLmxlbmd0aCoxMDAsMik7aWYocj41MCluZXcgQWEoXCJtZXNzYWdlRTJFRGVsYXlFeGNlcHRpb25cIikuc2V0TWVzc2FnZShcImNvdW50OlwiLmNvbmNhdChvLFwiIG1pbjpcIikuY29uY2F0KHMsXCIgbWF4OlwiKS5jb25jYXQoYSxcIiBhdmc6XCIpLmNvbmNhdChpLFwiIHBlcmNlbnQ6XCIpLmNvbmNhdChyKSkuc2V0TGV2ZWwoXCJ3YXJuaW5nXCIpLmVuZCgpfX19LHtrZXk6XCJnZXRTdGF0UmVzdWx0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9lMmVEZWxheUFycmF5Lmxlbmd0aDtpZigwPT09ZSlyZXR1cm4gbnVsbDt2YXIgdD1tKHRoaXMuX2UyZURlbGF5QXJyYXkpLG49dGhpcy5fY2FsY0NvdW50V2l0aExpbWl0KHtlMmVEZWxheUFycmF5OnQsbWluOjAsbWF4OjF9KSxvPXRoaXMuX2NhbGNDb3VudFdpdGhMaW1pdCh7ZTJlRGVsYXlBcnJheTp0LG1pbjoxLG1heDozfSkscz10aGlzLl9jYWxjUGVyY2VudChuLGUpLGE9dGhpcy5fY2FsY1BlcmNlbnQobyxlKSxpPXRoaXMuX2NhbGNBdmcodCxlKTtyZXR1cm4gdGhpcy5fY2hlY2tFMkVEZWxheUV4Y2VwdGlvbih0LDMpLHQubGVuZ3RoPTAsdGhpcy5yZXNldCgpLHt0b3RhbENvdW50OmUsY291bnRMZXNzVGhhbjFTZWNvbmQ6bixwZXJjZW50T2ZDb3VudExlc3NUaGFuMVNlY29uZDpzLGNvdW50TGVzc1RoYW4zU2Vjb25kOm8scGVyY2VudE9mQ291bnRMZXNzVGhhbjNTZWNvbmQ6YSxhdmdEZWxheTppfX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZTJlRGVsYXlBcnJheS5sZW5ndGg9MH19XSksZX0oKSwkcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtvKHRoaXMsZSksdGhpcy5fbj1cIkF2Z1JUVFwiLHRoaXMuX3JlcXVlc3RDb3VudD0wLHRoaXMuX3J0dEFycmF5PVtdfXJldHVybiBhKGUsW3trZXk6XCJhZGRSZXF1ZXN0Q291bnRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3JlcXVlc3RDb3VudCs9MX19LHtrZXk6XCJhZGRSVFRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9ydHRBcnJheS5wdXNoKGUpfX0se2tleTpcIl9jYWxjVG90YWxDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3JlcXVlc3RDb3VudH19LHtrZXk6XCJfY2FsY1JUVENvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUubGVuZ3RofX0se2tleTpcIl9jYWxjU3VjY2Vzc1JhdGVPZlJlcXVlc3RcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKDA9PT10KXJldHVybiAwO3ZhciBuPXd0KGUvdCoxMDAsMik7cmV0dXJuIG4+MTAwJiYobj0xMDApLG59fSx7a2V5OlwiX2NhbGNBdmdcIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKDA9PT10KXJldHVybiAwO3ZhciBuPTA7cmV0dXJuIGUuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bis9ZX0pKSxwYXJzZUludChuL3QpfX0se2tleTpcIl9jYWxjTWF4XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCxtKHRoaXMuX3J0dEFycmF5KSl9fSx7a2V5OlwiX2NhbGNNaW5cIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBNYXRoLm1pbi5hcHBseShNYXRoLG0odGhpcy5fcnR0QXJyYXkpKX19LHtrZXk6XCJnZXRTdGF0UmVzdWx0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9jYWxjVG90YWxDb3VudCgpLHQ9bSh0aGlzLl9ydHRBcnJheSk7aWYoMD09PWUpcmV0dXJuIG51bGw7dmFyIG49dGhpcy5fY2FsY1JUVENvdW50KHQpLG89dGhpcy5fY2FsY1N1Y2Nlc3NSYXRlT2ZSZXF1ZXN0KG4sZSkscz10aGlzLl9jYWxjQXZnKHQsbik7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXRTdGF0UmVzdWx0IG1heDpcIikuY29uY2F0KHRoaXMuX2NhbGNNYXgoKSxcIiBtaW46XCIpLmNvbmNhdCh0aGlzLl9jYWxjTWluKCksXCIgYXZnOlwiKS5jb25jYXQocykpLHRoaXMucmVzZXQoKSx7dG90YWxDb3VudDplLHJ0dENvdW50Om4sc3VjY2Vzc1JhdGVPZlJlcXVlc3Q6byxhdmdSVFQ6c319fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3JlcXVlc3RDb3VudD0wLHRoaXMuX3J0dEFycmF5Lmxlbmd0aD0wfX1dKSxlfSgpLGV1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe28odGhpcyxlKSx0aGlzLl9tYXA9bmV3IE1hcH1yZXR1cm4gYShlLFt7a2V5OlwiaW5pdE1hcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7ZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Ll9tYXAuc2V0KGUse3RvdGFsQ291bnQ6MCxzdWNjZXNzQ291bnQ6MCxmYWlsZWRDb3VudE9mVXNlclNpZGU6MCxjb3N0QXJyYXk6W10sZmlsZVNpemVBcnJheTpbXX0pfSkpfX0se2tleTpcImFkZFRvdGFsQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4hKGl0KGUpfHwhdGhpcy5fbWFwLmhhcyhlKSkmJih0aGlzLl9tYXAuZ2V0KGUpLnRvdGFsQ291bnQrPTEsITApfX0se2tleTpcImFkZFN1Y2Nlc3NDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiEoaXQoZSl8fCF0aGlzLl9tYXAuaGFzKGUpKSYmKHRoaXMuX21hcC5nZXQoZSkuc3VjY2Vzc0NvdW50Kz0xLCEwKX19LHtrZXk6XCJhZGRGYWlsZWRDb3VudE9mVXNlclNpZGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4hKGl0KGUpfHwhdGhpcy5fbWFwLmhhcyhlKSkmJih0aGlzLl9tYXAuZ2V0KGUpLmZhaWxlZENvdW50T2ZVc2VyU2lkZSs9MSwhMCl9fSx7a2V5OlwiYWRkQ29zdFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIShpdChlKXx8IXRoaXMuX21hcC5oYXMoZSkpJiYodGhpcy5fbWFwLmdldChlKS5jb3N0QXJyYXkucHVzaCh0KSwhMCl9fSx7a2V5OlwiYWRkRmlsZVNpemVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiEoaXQoZSl8fCF0aGlzLl9tYXAuaGFzKGUpKSYmKHRoaXMuX21hcC5nZXQoZSkuZmlsZVNpemVBcnJheS5wdXNoKHQpLCEwKX19LHtrZXk6XCJfY2FsY1N1Y2Nlc3NSYXRlT2ZCdXNpbmVzc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGl0KGUpfHwhdGhpcy5fbWFwLmhhcyhlKSlyZXR1cm4tMTt2YXIgdD10aGlzLl9tYXAuZ2V0KGUpLG49d3QodC5zdWNjZXNzQ291bnQvdC50b3RhbENvdW50KjEwMCwyKTtyZXR1cm4gbj4xMDAmJihuPTEwMCksbn19LHtrZXk6XCJfY2FsY1N1Y2Nlc3NSYXRlT2ZQbGF0Zm9ybVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGl0KGUpfHwhdGhpcy5fbWFwLmhhcyhlKSlyZXR1cm4tMTt2YXIgdD10aGlzLl9tYXAuZ2V0KGUpLG49dGhpcy5fY2FsY1N1Y2Nlc3NDb3VudE9mUGxhdGZvcm0oZSkvdC50b3RhbENvdW50KjEwMDtyZXR1cm4obj13dChuLDIpKT4xMDAmJihuPTEwMCksbn19LHtrZXk6XCJfY2FsY1RvdGFsQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSl8fCF0aGlzLl9tYXAuaGFzKGUpPy0xOnRoaXMuX21hcC5nZXQoZSkudG90YWxDb3VudH19LHtrZXk6XCJfY2FsY1N1Y2Nlc3NDb3VudE9mQnVzaW5lc3NcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gaXQoZSl8fCF0aGlzLl9tYXAuaGFzKGUpPy0xOnRoaXMuX21hcC5nZXQoZSkuc3VjY2Vzc0NvdW50fX0se2tleTpcIl9jYWxjU3VjY2Vzc0NvdW50T2ZQbGF0Zm9ybVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKGl0KGUpfHwhdGhpcy5fbWFwLmhhcyhlKSlyZXR1cm4tMTt2YXIgdD10aGlzLl9tYXAuZ2V0KGUpO3JldHVybiB0LnN1Y2Nlc3NDb3VudCt0LmZhaWxlZENvdW50T2ZVc2VyU2lkZX19LHtrZXk6XCJfY2FsY0F2Z1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBpdChlKXx8IXRoaXMuX21hcC5oYXMoZSk/LTE6ZT09PUlhP3RoaXMuX2NhbGNBdmdTcGVlZChlKTp0aGlzLl9jYWxjQXZnQ29zdChlKX19LHtrZXk6XCJfY2FsY0F2Z0Nvc3RcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9tYXAuZ2V0KGUpLmNvc3RBcnJheS5sZW5ndGg7aWYoMD09PXQpcmV0dXJuIDA7dmFyIG49MDtyZXR1cm4gdGhpcy5fbWFwLmdldChlKS5jb3N0QXJyYXkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bis9ZX0pKSxwYXJzZUludChuL3QpfX0se2tleTpcIl9jYWxjQXZnU3BlZWRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD0wLG49MDtyZXR1cm4gdGhpcy5fbWFwLmdldChlKS5jb3N0QXJyYXkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dCs9ZX0pKSx0aGlzLl9tYXAuZ2V0KGUpLmZpbGVTaXplQXJyYXkuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bis9ZX0pKSxwYXJzZUludCgxZTMqbi90KX19LHtrZXk6XCJnZXRTdGF0UmVzdWx0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fY2FsY1RvdGFsQ291bnQoZSk7aWYoMD09PXQpcmV0dXJuIG51bGw7dmFyIG49dGhpcy5fY2FsY1N1Y2Nlc3NDb3VudE9mQnVzaW5lc3MoZSksbz10aGlzLl9jYWxjU3VjY2Vzc1JhdGVPZkJ1c2luZXNzKGUpLHM9dGhpcy5fY2FsY1N1Y2Nlc3NDb3VudE9mUGxhdGZvcm0oZSksYT10aGlzLl9jYWxjU3VjY2Vzc1JhdGVPZlBsYXRmb3JtKGUpLGk9dGhpcy5fY2FsY0F2ZyhlKTtyZXR1cm4gdGhpcy5yZXNldChlKSx7dG90YWxDb3VudDp0LHN1Y2Nlc3NDb3VudE9mQnVzaW5lc3M6bixzdWNjZXNzUmF0ZU9mQnVzaW5lc3M6byxzdWNjZXNzQ291bnRPZlBsYXRmb3JtOnMsc3VjY2Vzc1JhdGVPZlBsYXRmb3JtOmEsYXZnVmFsdWU6aX19fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbihlKXtpdChlKT90aGlzLl9tYXAuY2xlYXIoKTp0aGlzLl9tYXAuc2V0KGUse3RvdGFsQ291bnQ6MCxzdWNjZXNzQ291bnQ6MCxmYWlsZWRDb3VudE9mVXNlclNpZGU6MCxjb3N0QXJyYXk6W10sZmlsZVNpemVBcnJheTpbXX0pfX1dKSxlfSgpLHR1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe28odGhpcyxlKSx0aGlzLl9sYXN0TWFwPW5ldyBNYXAsdGhpcy5fY3VycmVudE1hcD1uZXcgTWFwfXJldHVybiBhKGUsW3trZXk6XCJpbml0TWFwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QuX2xhc3RNYXAuc2V0KGUsbmV3IE1hcCksdC5fY3VycmVudE1hcC5zZXQoZSxuZXcgTWFwKX0pKX19LHtrZXk6XCJhZGRNZXNzYWdlU2VxdWVuY2VcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmtleSxuPWUubWVzc2FnZTtpZihpdCh0KXx8IXRoaXMuX2xhc3RNYXAuaGFzKHQpfHwhdGhpcy5fY3VycmVudE1hcC5oYXModCkpcmV0dXJuITE7dmFyIG89bi5jb252ZXJzYXRpb25JRCxzPW4uc2VxdWVuY2UsYT1vLnJlcGxhY2UoRS5DT05WX0dST1VQLFwiXCIpO2lmKDA9PT10aGlzLl9sYXN0TWFwLmdldCh0KS5zaXplKXRoaXMuX2FkZEN1cnJlbnRNYXAoZSk7ZWxzZSBpZih0aGlzLl9sYXN0TWFwLmdldCh0KS5oYXMoYSkpe3ZhciBpPXRoaXMuX2xhc3RNYXAuZ2V0KHQpLmdldChhKSxyPWkubGVuZ3RoLTE7cz5pWzBdJiZzPGlbcl0/KGkucHVzaChzKSxpLnNvcnQoKSx0aGlzLl9sYXN0TWFwLmdldCh0KS5zZXQoYSxpKSk6dGhpcy5fYWRkQ3VycmVudE1hcChlKX1lbHNlIHRoaXMuX2FkZEN1cnJlbnRNYXAoZSk7cmV0dXJuITB9fSx7a2V5OlwiX2FkZEN1cnJlbnRNYXBcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmtleSxuPWUubWVzc2FnZSxvPW4uY29udmVyc2F0aW9uSUQscz1uLnNlcXVlbmNlLGE9by5yZXBsYWNlKEUuQ09OVl9HUk9VUCxcIlwiKTt0aGlzLl9jdXJyZW50TWFwLmdldCh0KS5oYXMoYSl8fHRoaXMuX2N1cnJlbnRNYXAuZ2V0KHQpLnNldChhLFtdKSx0aGlzLl9jdXJyZW50TWFwLmdldCh0KS5nZXQoYSkucHVzaChzKX19LHtrZXk6XCJfY29weURhdGFcIix2YWx1ZTpmdW5jdGlvbihlKXtpZighaXQoZSkpe3RoaXMuX2xhc3RNYXAuc2V0KGUsbmV3IE1hcCk7dmFyIHQsbj10aGlzLl9sYXN0TWFwLmdldChlKSxvPUQodGhpcy5fY3VycmVudE1hcC5nZXQoZSkpO3RyeXtmb3Ioby5zKCk7ISh0PW8ubigpKS5kb25lOyl7dmFyIHM9dih0LnZhbHVlLDIpLGE9c1swXSxpPXNbMV07bi5zZXQoYSxpKX19Y2F0Y2gocil7by5lKHIpfWZpbmFsbHl7by5mKCl9bj1udWxsLHRoaXMuX2N1cnJlbnRNYXAuc2V0KGUsbmV3IE1hcCl9fX0se2tleTpcImdldFN0YXRSZXN1bHRcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihpdCh0aGlzLl9jdXJyZW50TWFwLmdldChlKSl8fGl0KHRoaXMuX2xhc3RNYXAuZ2V0KGUpKSlyZXR1cm4gbnVsbDtpZigwPT09dGhpcy5fbGFzdE1hcC5nZXQoZSkuc2l6ZSlyZXR1cm4gdGhpcy5fY29weURhdGEoZSksbnVsbDt2YXIgdD0wLG49MDtpZih0aGlzLl9sYXN0TWFwLmdldChlKS5mb3JFYWNoKChmdW5jdGlvbihlLG8pe3ZhciBzPW0oZS52YWx1ZXMoKSksYT1zLmxlbmd0aCxpPXNbYS0xXS1zWzBdKzE7dCs9aSxuKz1hfSkpLDA9PT10KXJldHVybiBudWxsO3ZhciBvPXd0KG4vdCoxMDAsMik7cmV0dXJuIG8+MTAwJiYobz0xMDApLHRoaXMuX2NvcHlEYXRhKGUpLHt0b3RhbENvdW50OnQsc3VjY2Vzc0NvdW50T2ZNZXNzYWdlUmVjZWl2ZWQ6bixzdWNjZXNzUmF0ZU9mTWVzc2FnZVJlY2VpdmVkOm99fX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jdXJyZW50TWFwLmNsZWFyKCksdGhpcy5fbGFzdE1hcC5jbGVhcigpfX1dKSxlfSgpLG51PWZ1bmN0aW9uKGUpe3IocyxlKTt2YXIgbj1mKHMpO2Z1bmN0aW9uIHMoZSl7dmFyIHQ7byh0aGlzLHMpLCh0PW4uY2FsbCh0aGlzLGUpKS5fbj1cIlF1YWxpdHlTdGF0TW9kdWxlXCIsdC5UQUc9XCJpbS1zc29sb2ctcXVhbGl0eS1zdGF0XCIsdC5yZXBvcnRJbmRleD0wLHQud2hvbGVQZXJpb2Q9ITEsdC5fcXVhbGl0eUl0ZW1zPVtfYSxmYSx2YSxtYSxNYSx5YSxJYSxDYSxUYSxEYV0sdC5fbWVzc2FnZVNlbnRJdGVtcz1bdmEsbWEsTWEseWEsSWFdLHQuX21lc3NhZ2VSZWNlaXZlZEl0ZW1zPVtDYSxUYSxEYV0sdC5SRVBPUlRfSU5URVJWQUw9MTIwLHQuUkVQT1JUX1NES0FQUElEX0JMQUNLTElTVD1bXSx0LlJFUE9SVF9USU5ZSURfV0hJVEVMSVNUPVtdLHQuX3N0YXRJbmZvQXJyPVtdLHQuX2F2Z1JUVD1uZXcgJHIsdC5fYXZnRTJFRGVsYXk9bmV3IFFyLHQuX3JhdGVNZXNzYWdlU2VudD1uZXcgZXUsdC5fcmF0ZU1lc3NhZ2VSZWNlaXZlZD1uZXcgdHU7dmFyIGE9dC5nZXRJbm5lckVtaXR0ZXJJbnN0YW5jZSgpO3JldHVybiBhLm9uKGVpLHQuX29uTG9naW5TdWNjZXNzLGgodCkpLGEub24odGksdC5fb25DbG91ZENvbmZpZ1VwZGF0ZWQsaCh0KSksdH1yZXR1cm4gYShzLFt7a2V5OlwiX29uTG9naW5TdWNjZXNzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX3JhdGVNZXNzYWdlU2VudC5pbml0TWFwKHRoaXMuX21lc3NhZ2VTZW50SXRlbXMpLHRoaXMuX3JhdGVNZXNzYWdlUmVjZWl2ZWQuaW5pdE1hcCh0aGlzLl9tZXNzYWdlUmVjZWl2ZWRJdGVtcyk7dmFyIHQ9dGhpcy5nZXRNb2R1bGUoVm4pLG49dC5nZXRJdGVtKHRoaXMuVEFHLCExKTshenQobikmJnV0KG4uZm9yRWFjaCkmJihWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX29uTG9naW5TdWNjZXNzIGdldCBxdWFsaXR5IHN0YXQgbG9ncyBmcm9tIGxvY2FsIHN0b3JhZ2UsIGNvdW50OlwiKS5jb25jYXQobi5sZW5ndGgpKSxuLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UuX3N0YXRJbmZvQXJyLnB1c2godCl9KSksdC5yZW1vdmVJdGVtKHRoaXMuVEFHLCExKSl9fSx7a2V5OlwiX29uQ2xvdWRDb25maWdVcGRhdGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmdldENsb3VkQ29uZmlnKFwicV9ycHRfaW50ZXJ2YWxcIiksdD10aGlzLmdldENsb3VkQ29uZmlnKFwicV9ycHRfc2RrYXBwaWRfYmxcIiksbj10aGlzLmdldENsb3VkQ29uZmlnKFwicV9ycHRfdGlueWlkX3dsXCIpO2l0KGUpfHwodGhpcy5SRVBPUlRfSU5URVJWQUw9TnVtYmVyKGUpKSxpdCh0KXx8KHRoaXMuUkVQT1JUX1NES0FQUElEX0JMQUNLTElTVD10LnNwbGl0KFwiLFwiKS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBOdW1iZXIoZSl9KSkpLGl0KG4pfHwodGhpcy5SRVBPUlRfVElOWUlEX1dISVRFTElTVD1uLnNwbGl0KFwiLFwiKSl9fSx7a2V5Olwib25DaGVja1RpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5pc0xvZ2dlZEluKCkmJmUldGhpcy5SRVBPUlRfSU5URVJWQUw9PTAmJih0aGlzLndob2xlUGVyaW9kPSEwLHRoaXMuX3JlcG9ydCgpKX19LHtrZXk6XCJhZGRSZXF1ZXN0Q291bnRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2F2Z1JUVC5hZGRSZXF1ZXN0Q291bnQoKX19LHtrZXk6XCJhZGRSVFRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9hdmdSVFQuYWRkUlRUKGUpfX0se2tleTpcImFkZE1lc3NhZ2VEZWxheVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2F2Z0UyRURlbGF5LmFkZE1lc3NhZ2VEZWxheShlKX19LHtrZXk6XCJhZGRUb3RhbENvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcmF0ZU1lc3NhZ2VTZW50LmFkZFRvdGFsQ291bnQoZSl8fFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5hZGRUb3RhbENvdW50IGludmFsaWQga2V5OlwiKSxlKX19LHtrZXk6XCJhZGRTdWNjZXNzQ291bnRcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9yYXRlTWVzc2FnZVNlbnQuYWRkU3VjY2Vzc0NvdW50KGUpfHxWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIuYWRkU3VjY2Vzc0NvdW50IGludmFsaWQga2V5OlwiKSxlKX19LHtrZXk6XCJhZGRGYWlsZWRDb3VudE9mVXNlclNpZGVcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9yYXRlTWVzc2FnZVNlbnQuYWRkRmFpbGVkQ291bnRPZlVzZXJTaWRlKGUpfHxWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIuYWRkRmFpbGVkQ291bnRPZlVzZXJTaWRlIGludmFsaWQga2V5OlwiKSxlKX19LHtrZXk6XCJhZGRDb3N0XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9yYXRlTWVzc2FnZVNlbnQuYWRkQ29zdChlLHQpfHxWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIuYWRkQ29zdCBpbnZhbGlkIGtleSBvciBjb3N0OlwiKSxlLHQpfX0se2tleTpcImFkZEZpbGVTaXplXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9yYXRlTWVzc2FnZVNlbnQuYWRkRmlsZVNpemUoZSx0KXx8VmUudyhcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLmFkZEZpbGVTaXplIGludmFsaWQga2V5IG9yIHNpemU6XCIpLGUsdCl9fSx7a2V5OlwiYWRkTWVzc2FnZVNlcXVlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fcmF0ZU1lc3NhZ2VSZWNlaXZlZC5hZGRNZXNzYWdlU2VxdWVuY2UoZSl8fFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5hZGRNZXNzYWdlU2VxdWVuY2UgaW52YWxpZCBrZXk6XCIpLGUua2V5KX19LHtrZXk6XCJfZ2V0UXVhbGl0eUl0ZW1cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj17fSxvPVNhW3RoaXMuZ2V0TmV0d29ya1R5cGUoKV07aXQobykmJihvPTgpO3ZhciBzPXtxdWFsaXR5VHlwZTprYVtlXSx0aW1lc3RhbXA6UGUoKSxuZXR3b3JrVHlwZTpvLGV4dGVuc2lvbjpcIlwifTtzd2l0Y2goZSl7Y2FzZSBfYTpuPXRoaXMuX2F2Z1JUVC5nZXRTdGF0UmVzdWx0KCk7YnJlYWs7Y2FzZSBmYTpuPXRoaXMuX2F2Z0UyRURlbGF5LmdldFN0YXRSZXN1bHQoKTticmVhaztjYXNlIHZhOmNhc2UgbWE6Y2FzZSBNYTpjYXNlIHlhOmNhc2UgSWE6bj10aGlzLl9yYXRlTWVzc2FnZVNlbnQuZ2V0U3RhdFJlc3VsdChlKTticmVhaztjYXNlIENhOmNhc2UgVGE6Y2FzZSBEYTpuPXRoaXMuX3JhdGVNZXNzYWdlUmVjZWl2ZWQuZ2V0U3RhdFJlc3VsdChlKX1yZXR1cm4gbnVsbD09PW4/bnVsbDp0KHQoe30scyksbil9fSx7a2V5OlwiX3JlcG9ydFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1bXSxvPW51bGw7aXQoZSk/dGhpcy5fcXVhbGl0eUl0ZW1zLmZvckVhY2goKGZ1bmN0aW9uKGUpe251bGwhPT0obz10Ll9nZXRRdWFsaXR5SXRlbShlKSkmJihvLnJlcG9ydEluZGV4PXQucmVwb3J0SW5kZXgsby53aG9sZVBlcmlvZD10Lndob2xlUGVyaW9kLG4ucHVzaChvKSl9KSk6bnVsbCE9PShvPXRoaXMuX2dldFF1YWxpdHlJdGVtKGUpKSYmKG8ucmVwb3J0SW5kZXg9dGhpcy5yZXBvcnRJbmRleCxvLndob2xlUGVyaW9kPXRoaXMud2hvbGVQZXJpb2Qsbi5wdXNoKG8pKSxWZS5kKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3JlcG9ydFwiKSxuKSx0aGlzLl9zdGF0SW5mb0Fyci5sZW5ndGg+MCYmKG49bi5jb25jYXQodGhpcy5fc3RhdEluZm9BcnIpLHRoaXMuX3N0YXRJbmZvQXJyPVtdKTt2YXIgcz10aGlzLmdldE1vZHVsZSh4biksYT1zLmdldFNES0FwcElEKCksaT1zLmdldFRpbnlJRCgpO0Z0KHRoaXMuUkVQT1JUX1NES0FQUElEX0JMQUNLTElTVCxhKSYmIXF0KHRoaXMuUkVQT1JUX1RJTllJRF9XSElURUxJU1QsaSkmJihuPVtdKSxuLmxlbmd0aD4wJiZ0aGlzLl9kb1JlcG9ydChuKX19LHtrZXk6XCJfZG9SZXBvcnRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLG89e2hlYWRlcjpvcih0aGlzKSxxdWFsaXR5OmV9O3RoaXMucmVxdWVzdCh7cHJvdG9jb2xOYW1lOkJzLHJlcXVlc3REYXRhOnQoe30sbyl9KS50aGVuKChmdW5jdGlvbigpe24ucmVwb3J0SW5kZXgrKyxuLndob2xlUGVyaW9kPSExfSkpLmNhdGNoKChmdW5jdGlvbih0KXtWZS53KFwiXCIuY29uY2F0KG4uX24sXCIuX2RvUmVwb3J0LCBvbmxpbmU6XCIpLmNvbmNhdChuLmdldE5ldHdvcmtUeXBlKCksXCIgZXJyb3I6XCIpLHQpLG4uX3N0YXRJbmZvQXJyPW4uX3N0YXRJbmZvQXJyLmNvbmNhdChlKSxuLl9mbHVzaEF0T25jZSgpfSkpfX0se2tleTpcIl9mbHVzaEF0T25jZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5nZXRNb2R1bGUoVm4pLHQ9ZS5nZXRJdGVtKHRoaXMuVEFHLCExKSxuPXRoaXMuX3N0YXRJbmZvQXJyLG89XCJcIi5jb25jYXQodGhpcy5fbixcIi5fZmx1c2hBdE9uY2VcIik7aWYoenQodCkpVmUubChcIlwiLmNvbmNhdChvLFwiIGNvdW50OlwiKS5jb25jYXQobi5sZW5ndGgpKSxlLnNldEl0ZW0odGhpcy5UQUcsbiwhMCwhMSk7ZWxzZXt2YXIgcz1uLmNvbmNhdCh0KTtzLmxlbmd0aD4xMCYmKHM9cy5zbGljZSgwLDEwKSksVmUubChcIlwiLmNvbmNhdChvLFwiIGNvdW50OlwiKS5jb25jYXQocy5sZW5ndGgpKSxlLnNldEl0ZW0odGhpcy5UQUcscywhMCwhMSl9dGhpcy5fc3RhdEluZm9BcnI9W119fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSksdGhpcy5fcmVwb3J0KCksdGhpcy5yZXBvcnRJbmRleD0wLHRoaXMud2hvbGVQZXJpb2Q9ITEsdGhpcy5SRVBPUlRfU0RLQVBQSURfQkxBQ0tMSVNUPVtdLHRoaXMuUkVQT1JUX1RJTllJRF9XSElURUxJU1Q9W10sdGhpcy5fYXZnUlRULnJlc2V0KCksdGhpcy5fYXZnRTJFRGVsYXkucmVzZXQoKSx0aGlzLl9yYXRlTWVzc2FnZVNlbnQucmVzZXQoKSx0aGlzLl9yYXRlTWVzc2FnZVJlY2VpdmVkLnJlc2V0KCl9fV0pLHN9KHVvKSxvdT1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9uPVwiV29ya2VyVGltZXJNb2R1bGVcIixzLl9pc1dvcmtlckVuYWJsZWQ9ITAscy5fd29ya2VyVGltZXI9bnVsbCxzLl90aW1lcklEPS0xLHMuX2luaXQoKSxzLmdldElubmVyRW1pdHRlckluc3RhbmNlKCkub24odGkscy5fb25DbG91ZENvbmZpZ1VwZGF0ZWQsaChzKSksc31yZXR1cm4gYShuLFt7a2V5OlwiaXNXb3JrZXJFbmFibGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNXb3JrZXJFbmFibGVkJiZTZX19LHtrZXk6XCJzdGFydFdvcmtlclRpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuc3RhcnRXb3JrZXJUaW1lclwiKSksdGhpcy5fd29ya2VyVGltZXImJnRoaXMuX3dvcmtlclRpbWVyLnBvc3RNZXNzYWdlKFwic3RhcnRcIil9fSx7a2V5Olwic3RvcFdvcmtlclRpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuc3RvcFdvcmtlclRpbWVyXCIpKSx0aGlzLl93b3JrZXJUaW1lciYmdGhpcy5fd29ya2VyVGltZXIucG9zdE1lc3NhZ2UoXCJzdG9wXCIpfX0se2tleTpcIl9pbml0XCIsdmFsdWU6ZnVuY3Rpb24oKXtpZihTZSl7dmFyIGU9VVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbJ2xldCBpbnRlcnZhbCA9IC0xO29ubWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7ICBpZiAoZXZlbnQuZGF0YSA9PT0gXCJzdGFydFwiKSB7ICAgIGlmIChpbnRlcnZhbCA+IDApIHsgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTsgICAgfSAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHsgICAgICBwb3N0TWVzc2FnZShcIlwiKTsgICAgfSwgMTAwMCk7ICAgIHBvc3RNZXNzYWdlKGludGVydmFsKTsgIH0gZWxzZSBpZiAoZXZlbnQuZGF0YSA9PT0gXCJzdG9wXCIpIHsgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7ICAgIGludGVydmFsID0gLTE7ICB9fTsnXSx7dHlwZTpcImFwcGxpY2F0aW9uL2phdmFzY3JpcHQ7IGNoYXJzZXQ9dXRmLThcIn0pKTt0aGlzLl93b3JrZXJUaW1lcj1uZXcgV29ya2VyKGUpO3ZhciB0PXRoaXM7dGhpcy5fd29ya2VyVGltZXIub25tZXNzYWdlPWZ1bmN0aW9uKGUpe2UuZGF0YT8odC5fdGltZXJJRD1lLmRhdGEsVmUubChcIlwiLmNvbmNhdCh0Ll9uLFwiLl9pbml0IHNlZWQ6XCIpLmNvbmNhdCh0Ll90aW1lcklEKSkpOnQuX20ub25DaGVja1RpbWVyKCl9fX19LHtrZXk6XCJfb25DbG91ZENvbmZpZ1VwZGF0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0Q2xvdWRDb25maWcoXCJlbmFibGVfd29ya2VyXCIpO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fb25DbG91ZENvbmZpZ1VwZGF0ZWQgZW5hYmxlV29ya2VyOlwiKS5jb25jYXQoZSkpLGl0KGUpfHxcIjFcIj09PWU/IXRoaXMuX2lzV29ya2VyRW5hYmxlZCYmU2UmJih0aGlzLl9pc1dvcmtlckVuYWJsZWQ9ITAsdGhpcy5zdGFydFdvcmtlclRpbWVyKCksdGhpcy5fbS5vbldvcmtlclRpbWVyRW5hYmxlZCgpKTp0aGlzLl9pc1dvcmtlckVuYWJsZWQmJlNlJiYodGhpcy5faXNXb3JrZXJFbmFibGVkPSExLHRoaXMuc3RvcFdvcmtlclRpbWVyKCksdGhpcy5fbS5vbldvcmtlclRpbWVyRGlzYWJsZWQoKSl9fSx7a2V5OlwidGVybWluYXRlXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIudGVybWluYXRlXCIpKSx0aGlzLl93b3JrZXJUaW1lciYmKHRoaXMuX3dvcmtlclRpbWVyLnRlcm1pbmF0ZSgpLHRoaXMuX3dvcmtlclRpbWVyPW51bGwsdGhpcy5fdGltZXJJRD0tMSl9fSx7a2V5OlwiZ2V0VGltZXJJRFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RpbWVySUR9fSx7a2V5OlwicmVzZXRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5yZXNldFwiKSl9fV0pLG59KHVvKSxzdT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtvKHRoaXMsZSksdGhpcy5fbj1cIlB1cmNoYXNlZEZlYXR1cmVIYW5kbGVyXCIsdGhpcy5fcHVyY2hhc2VkRmVhdHVyZU1hcD1uZXcgTWFwfXJldHVybiBhKGUsW3trZXk6XCJpc1ZhbGlkUHVyY2hhc2VCaXRzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwic3RyaW5nXCI9PXR5cGVvZiBlJiZlLmxlbmd0aD49MSYmZS5sZW5ndGg8PTY0JiYvWzAxXXsxLDY0fS8udGVzdChlKX19LHtrZXk6XCJwYXJzZVB1cmNoYXNlQml0c1wiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuaXNWYWxpZFB1cmNoYXNlQml0cyhlKSl7dGhpcy5fcHVyY2hhc2VkRmVhdHVyZU1hcC5jbGVhcigpO2Zvcih2YXIgdD1udWxsLG49ZS5sZW5ndGgtMSxvPTA7bj49MDtuLS0sbysrKXQ9bzwzMj9uZXcgTCgwLE1hdGgucG93KDIsbykpLnRvU3RyaW5nKCk6bmV3IEwoTWF0aC5wb3coMixvLTMyKSwwKS50b1N0cmluZygpLFwiMVwiPT09ZVtuXT90aGlzLl9wdXJjaGFzZWRGZWF0dXJlTWFwLnNldCh0LCEwKTp0aGlzLl9wdXJjaGFzZWRGZWF0dXJlTWFwLnNldCh0LCExKX1lbHNlIFZlLncoXCJcIi5jb25jYXQodGhpcy5fbixcIi5wYXJzZVB1cmNoYXNlQml0cyBpbnZhbGlkIHB1cmNoYXNlYml0czpcIikuY29uY2F0KGUpKX19LHtrZXk6XCJoYXNQdXJjaGFzZWRGZWF0dXJlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuISF0aGlzLl9wdXJjaGFzZWRGZWF0dXJlTWFwLmdldChlKX19LHtrZXk6XCJpc0ZlYXR1cmVFbmFibGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXBhcnNlSW50KGUpLnRvU3RyaW5nKDIpLG49dm9pZCAwLG89ITAscz10Lmxlbmd0aC0xLGE9MDtzPj0wO3MtLSxhKyspaWYoXCIxXCI9PT10LmNoYXJBdChzKSYmKG49YTwzMj9uZXcgTCgwLE1hdGgucG93KDIsYSkpLnRvU3RyaW5nKCk6bmV3IEwoTWF0aC5wb3coMixhLTMyKSwwKS50b1N0cmluZygpLCF0aGlzLl9wdXJjaGFzZWRGZWF0dXJlTWFwLmdldChuKSkpe289ITE7YnJlYWt9cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5pc0ZlYXR1cmVFbmFibGVkIGRlY2ltYWxOdW1iZXI6XCIpLmNvbmNhdChlLFwiIGJpbmFyeVN0cmluZzpcIikuY29uY2F0KHQsXCIgcmV0OlwiKS5jb25jYXQobykpLFhhKHtlbmFibGVkOm99KX19LHtrZXk6XCJjbGVhclwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fcHVyY2hhc2VkRmVhdHVyZU1hcC5jbGVhcigpfX1dKSxlfSgpLGF1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fbT10LHRoaXMuX249XCJDb21tZXJjaWFsQ29uZmlnTW9kdWxlXCIsdGhpcy5fZXhwaXJlZFRpbWU9MCx0aGlzLl9pc0ZldGNoaW5nPSExLHRoaXMuX3B1cmNoYXNlZEZlYXR1cmVIYW5kbGVyPW5ldyBzdX1yZXR1cm4gYShlLFt7a2V5OlwiX2NhbkZldGNoXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHhuKS5pc0xvZ2dlZEluKCk/IXRoaXMuX2lzRmV0Y2hpbmcmJkRhdGUubm93KCk+PXRoaXMuX2V4cGlyZWRUaW1lOih0aGlzLl9leHBpcmVkVGltZT1EYXRlLm5vdygpKzJlMywhMSl9fSx7a2V5Olwib25DaGVja1RpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fY2FuRmV0Y2goKSYmdGhpcy5mZXRjaENvbmZpZygpfX0se2tleTpcImZldGNoQ29uZmlnXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5fY2FuRmV0Y2goKSxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZmV0Y2hDb25maWdcIik7aWYoVmUubChcIlwiLmNvbmNhdChuLFwiIGNhbkZldGNoOlwiKS5jb25jYXQodCkpLHQpe3ZhciBvPXRoaXMuX2dldE1vZHVsZShIbikscz1uZXcgQWEoXCJmZXRjaENvbW1lcmNpYWxDb25maWdcIik7cy5zZXROZXR3b3JrVHlwZShvLmdldE5ldHdvcmtUeXBlKCkpO3ZhciBhPXRoaXMuX2dldE1vZHVsZSh4bikuZ2V0U0RLQXBwSUQoKSxpPXRoaXMuX2dldE1vZHVsZSh6bik7dGhpcy5faXNGZXRjaGluZz0hMCxpLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpRcyxyZXF1ZXN0RGF0YTp7U0RLQXBwSUQ6YX19KS50aGVuKChmdW5jdGlvbih0KXtzLnNldE1lc3NhZ2UoXCJwdXJjaGFzZUJpdHM6XCIuY29uY2F0KHQuZGF0YS5wdXJjaGFzZUJpdHMpKS5lbmQoKSxWZS5sKFwiXCIuY29uY2F0KG4sXCIgb2suXCIpKSxlLl9wYXJzZUNvbmZpZyh0LmRhdGEpLGUuX2lzRmV0Y2hpbmc9ITF9KSkuY2F0Y2goKGZ1bmN0aW9uKHQpe28ucHJvYmUoKS50aGVuKChmdW5jdGlvbihlKXt2YXIgbj12KGUsMiksbz1uWzBdLGE9blsxXTtzLnNldEVycm9yKHQsbyxhKS5lbmQoKX0pKSxlLl9pc0ZldGNoaW5nPSExfSkpfX19LHtrZXk6XCJvblB1c2hlZENvbmZpZ1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVwiXCIuY29uY2F0KHRoaXMuX24sXCIub25QdXNoZWRDb25maWcgZGF0YTpcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KGUpKTtWZS5sKFwiXCIuY29uY2F0KHQpKSxuZXcgQWEoXCJwdXNoZWRDb21tZXJjaWFsQ29uZmlnXCIpLnNldE5ldHdvcmtUeXBlKHRoaXMuX2dldE1vZHVsZShIbikuZ2V0TmV0d29ya1R5cGUoKSkuc2V0TWVzc2FnZShcInB1cmNoYXNlQml0czpcIi5jb25jYXQoZS5wdXJjaGFzZUJpdHMpKS5lbmQoKSx0aGlzLl9wYXJzZUNvbmZpZyhlKX19LHtrZXk6XCJfcGFyc2VDb25maWdcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1cIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9wYXJzZUNvbmZpZ1wiKSxuPWUuZXJyb3JDb2RlLG89ZS5lcnJvck1lc3NhZ2Uscz1lLnB1cmNoYXNlQml0cyxhPWUuZXhwaXJlZFRpbWU7MD09PW4/KHRoaXMuX3B1cmNoYXNlZEZlYXR1cmVIYW5kbGVyLnBhcnNlUHVyY2hhc2VCaXRzKHMpLHRoaXMuX2V4cGlyZWRUaW1lPURhdGUubm93KCkrMWUzKmEpOml0KG4pPyhWZS5sKFwiXCIuY29uY2F0KHQsXCIgZmFpbGVkLiBJbnZhbGlkIG1lc3NhZ2UgZm9ybWF0OlwiKSxlKSx0aGlzLl9zZXRFeHBpcmVkVGltZU9uUmVzcG9uc2VFcnJvcigzNmU1KSk6KFZlLmUoXCJcIi5jb25jYXQodCxcIiBlcnJvckNvZGU6XCIpLmNvbmNhdChuLFwiIGVycm9yTWVzc2FnZTpcIikuY29uY2F0KG8pKSx0aGlzLl9zZXRFeHBpcmVkVGltZU9uUmVzcG9uc2VFcnJvcigxMmU0KSl9fSx7a2V5OlwiX3NldEV4cGlyZWRUaW1lT25SZXNwb25zZUVycm9yXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZXhwaXJlZFRpbWU9RGF0ZS5ub3coKStlfX0se2tleTpcImNhbklVc2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fcHVyY2hhc2VkRmVhdHVyZUhhbmRsZXIuaGFzUHVyY2hhc2VkRmVhdHVyZShlKX19LHtrZXk6XCJpc0ZlYXR1cmVFbmFibGVkXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3B1cmNoYXNlZEZlYXR1cmVIYW5kbGVyLmlzRmVhdHVyZUVuYWJsZWQoZSl9fSx7a2V5OlwiX2dldE1vZHVsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZShlKX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKSx0aGlzLl9leHBpcmVkVGltZT0wLHRoaXMuX2lzRmV0Y2hpbmc9ITEsdGhpcy5fcHVyY2hhc2VkRmVhdHVyZUhhbmRsZXIuY2xlYXIoKX19XSksZX0oKSxpdT1mdW5jdGlvbihlKXtyKG4sZSk7dmFyIHQ9ZihuKTtmdW5jdGlvbiBuKGUpe3ZhciBzO3JldHVybiBvKHRoaXMsbiksKHM9dC5jYWxsKHRoaXMsZSkpLl9tPWUscy5fbj1cIk9mZmxpbmVQdXNoTW9kdWxlXCIscy5fb2ZmbGluZVB1c2hQbHVnaW49dm9pZCAwLHMuX2FuZHJvaWRQdXNoQ29uZmlnPXtodWF3ZWlQdXNoQnVzc2luZXNzSWQ6XCJcIix4aWFvbWlQdXNoQnVzc2luZXNzSWQ6XCJcIix4aWFvbWlQdXNoQXBwSWQ6XCJcIix4aWFvbWlQdXNoQXBwS2V5OlwiXCIsbWVpenVQdXNoQnVzc2luZXNzSWQ6XCJcIixtZWl6dVB1c2hBcHBJZDpcIlwiLG1laXp1UHVzaEFwcEtleTpcIlwiLHZpdm9QdXNoQnVzc2luZXNzSWQ6XCJcIixmY21QdXNoQnVzc2luZXNzSWQ6XCJcIixvcHBvUHVzaEJ1c3NpbmVzc0lkOlwiXCIsb3Bwb1B1c2hBcHBLZXk6XCJcIixvcHBvUHVzaEFwcFNlY3JldDpcIlwiLGhvbm9yUHVzaEJ1c3NpbmVzc0lkOlwiXCJ9LHMuX2RldmljZVRva2VuPVwiXCIscy5fYnVzaW5lc3NJRD0wLHMuX2lvc0J1c2luZXNzSUQ9MCxzLl9jMmNVbnJlYWRDb3VudD0wLHMuX2dyb3VwVW5yZWFkQ291bnQ9MCxzLl9pc1dlYlVuaWFwcD0wLHN9cmV0dXJuIGEobixbe2tleTpcInJlZ2lzdGVyUGx1Z2luXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYob2Upe3RoaXMuX29mZmxpbmVQdXNoUGx1Z2luPWVbXCJ0aW0tb2ZmbGluZS1wdXNoLXBsdWdpblwiXTt2YXIgdD1lLm9mZmxpbmVQdXNoQ29uZmlnfHx7fSxuPXQuaHVhd2VpQnVzaW5lc3NJRCxvPXQueGlhb21pQnVzaW5lc3NJRCxzPXQueGlhb21pQXBwSUQsYT10LnhpYW9taUFwcEtleSxpPXQubWVpenVCdXNpbmVzc0lELHI9dC5tZWl6dUFwcElELHU9dC5tZWl6dUFwcEtleSxjPXQudml2b0J1c2luZXNzSUQsbD10Lm9wcG9CdXNpbmVzc0lELGQ9dC5vcHBvQXBwS2V5LHA9dC5vcHBvQXBwU2VjcmV0LGc9dC5ob25vckJ1c2luZXNzSUQsaD10Lmlvc0J1c2luZXNzSUQ7dGhpcy5fYW5kcm9pZFB1c2hDb25maWcuaHVhd2VpUHVzaEJ1c3NpbmVzc0lkPW4sdGhpcy5fYW5kcm9pZFB1c2hDb25maWcueGlhb21pUHVzaEJ1c3NpbmVzc0lkPW8sdGhpcy5fYW5kcm9pZFB1c2hDb25maWcueGlhb21pUHVzaEFwcElkPXMsdGhpcy5fYW5kcm9pZFB1c2hDb25maWcueGlhb21pUHVzaEFwcEtleT1hLHRoaXMuX2FuZHJvaWRQdXNoQ29uZmlnLm1laXp1UHVzaEJ1c3NpbmVzc0lkPWksdGhpcy5fYW5kcm9pZFB1c2hDb25maWcubWVpenVQdXNoQXBwSWQ9cix0aGlzLl9hbmRyb2lkUHVzaENvbmZpZy5tZWl6dVB1c2hBcHBLZXk9dSx0aGlzLl9hbmRyb2lkUHVzaENvbmZpZy52aXZvUHVzaEJ1c3NpbmVzc0lkPWMsdGhpcy5fYW5kcm9pZFB1c2hDb25maWcub3Bwb1B1c2hCdXNzaW5lc3NJZD1sLHRoaXMuX2FuZHJvaWRQdXNoQ29uZmlnLm9wcG9QdXNoQXBwS2V5PWQsdGhpcy5fYW5kcm9pZFB1c2hDb25maWcub3Bwb1B1c2hBcHBTZWNyZXQ9cCx0aGlzLl9hbmRyb2lkUHVzaENvbmZpZy5ob25vclB1c2hCdXNzaW5lc3NJZD1nLG5ldyBBYShcInJlZ2lzdGVyUGx1Z2luXCIpLnNldE1lc3NhZ2UoXCJ0aW0tb2ZmbGluZS1wdXNoLXBsdWdpblwiKS5zZXRNb3JlTWVzc2FnZShcImlzRXhpc3Q6XCIuY29uY2F0KCFpdCh0aGlzLl9vZmZsaW5lUHVzaFBsdWdpbikpKS5lbmQoITApLFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwicmVnaXN0ZXJQbHVnaW5cIixcIiBvay4gb2ZmbGluZVB1c2hDb25maWc6XCIpLmNvbmNhdChKU09OLnN0cmluZ2lmeShlLm9mZmxpbmVQdXNoQ29uZmlnKSkpLHRoaXMuX2lvc0J1c2luZXNzSUQ9aCx0aGlzLl9zZXRBcHBTaG93TGlzdGVuZXIoKX1lbHNlIHRoaXMub3V0cHV0V2FybmluZyhcIk9mZmxpbmVQdXNoSW5VbmlhcHBcIil9fSx7a2V5OlwiaW5pdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5faXNXZWJVbmlhcHA9dGhpcy5nZXRVbmlBcHBQbGF0Zm9ybSgpLHRoaXMuX2dldERldmljZVRva2VuKCl9fSx7a2V5OlwiX2dldERldmljZVRva2VuXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX2dldERldmljZVRva2VuXCIpO2lmKHV0KHRoaXMuX29mZmxpbmVQdXNoUGx1Z2luLmdldERldmljZVRva2VuKSl7dmFyIG49XCJhbmRyb2lkUHVzaENvbmZpZzpcIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkodGhpcy5fYW5kcm9pZFB1c2hDb25maWcpLFwiLCBpb3NCdXNpbmVzc0lEOlwiKS5jb25jYXQodGhpcy5faW9zQnVzaW5lc3NJRCk7VmUubChcIlwiLmNvbmNhdCh0LFwiIHN0YXJ0LiBcIikuY29uY2F0KG4pKSxuZXcgQWEoXCJfZ2V0RGV2aWNlVG9rZW5cIikuc2V0TWVzc2FnZShcIlwiLmNvbmNhdChuKSkuZW5kKCEwKSx0aGlzLl9vZmZsaW5lUHVzaFBsdWdpbi5nZXREZXZpY2VUb2tlbih0aGlzLl9hbmRyb2lkUHVzaENvbmZpZywoZnVuY3Rpb24obyl7dmFyIHM9bmV3IEFhKFwiZ2V0RGV2aWNlVG9rZW5SZXNcIiksYT1vLmNvZGUsaT1vLm1zZztpZigwPT09YSl7dmFyIHI9by5kYXRhLHU9ci5kZXZpY2VUb2tlbixjPXIuZGV2aWNlQnJhbmQsbD1yLmRldmljZVR5cGUsZD1yLmJ1c3NpbmVzc0lkO2UuX2RldmljZVRva2VuPXUsZS5fYnVzaW5lc3NJRD1kfHxlLl9pb3NCdXNpbmVzc0lELG49XCJkZXZpY2VUb2tlbjpcIi5jb25jYXQodSxcIiwgZGV2aWNlQnJhbmQ6XCIpLmNvbmNhdChjfHxsLFwiLCBidXNpbmVzc0lEOlwiKS5jb25jYXQoZS5fYnVzaW5lc3NJRCksVmUubChcIlwiLmNvbmNhdCh0LFwiIG9rLiBcIikuY29uY2F0KG4pKSxzLnNldE1lc3NhZ2UobikuZW5kKCEwKSxlLl9zZXRUb2tlbigpfWVsc2Ugcy5zZXRNZXNzYWdlKFwiY29kZTpcIi5jb25jYXQoYSxcIiwgbXNnOlwiKS5jb25jYXQoaSkpLmVuZCghMCksVmUuZShcIlwiLmNvbmNhdCh0LFwiIGZhaWxlZC4gZXJyb3I6XCIpLG8pfSkpfWVsc2UgVmUuZShcIlwiLmNvbmNhdCh0LFwiIGdldERldmljZVRva2VuIGlzIG5vdCBhIGZ1bmN0aW9uXCIpKX19LHtrZXk6XCJjYW5JVXNlT2ZmbGluZVB1c2hcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBvZSYmIWl0KHRoaXMuX29mZmxpbmVQdXNoUGx1Z2luKX19LHtrZXk6XCJfc2V0QXBwU2hvd0xpc3RlbmVyXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX3NldEFwcFNob3dMaXN0ZW5lclwiKTtpdCh0aGlzLl9vZmZsaW5lUHVzaFBsdWdpbik/VmUuZShcIlwiLmNvbmNhdCh0LFwiIG9mZmxpbmVQdXNoUGx1Z2luIGlzIHVuZGVmaW5lZFwiKSk6dXQodGhpcy5fb2ZmbGluZVB1c2hQbHVnaW4uc2V0QXBwU2hvd0xpc3RlbmVyKT8obmV3IEFhKFwiX3NldEFwcFNob3dMaXN0ZW5lclwiKS5lbmQoITApLFZlLmwoXCJcIi5jb25jYXQodCxcIiBzdGFydFwiKSksdGhpcy5fb2ZmbGluZVB1c2hQbHVnaW4uc2V0QXBwU2hvd0xpc3RlbmVyKChmdW5jdGlvbihuKXt2YXIgbz0obnx8e30pLmFwcFNob3c7bmV3IEFhKFwic2V0QXBwU2hvd0xpc3RlbmVyUmVzXCIpLnNldE1lc3NhZ2UoXCJhcHBTaG93OlwiLmNvbmNhdChvKSkuZW5kKCEwKSxWZS5sKFwiXCIuY29uY2F0KHQsXCIgb2suIGFwcFNob3c6XCIpLmNvbmNhdChvKSksZS5fbS5pc1JlYWR5KCkmJigwPT09bz8oZS5fZ2V0Q29udlVucmVhZENvdW50KCksZS5fb25CYWNrZ3JvdW5kKCkpOjE9PT1vJiZlLl9vbkZvcmVncm91bmQoKSl9KSkpOlZlLmUoXCJcIi5jb25jYXQodCxcIiBzZXRBcHBTaG93TGlzdGVuZXIgaXMgbm90IGEgZnVuY3Rpb25cIikpfX0se2tleTpcImdldERldmljZUJyYW5kXCIsdmFsdWU6ZnVuY3Rpb24oKXtpZighaXQodGhpcy5fb2ZmbGluZVB1c2hQbHVnaW4pJiZ1dCh0aGlzLl9vZmZsaW5lUHVzaFBsdWdpbi5nZXREZXZpY2VUeXBlKSl7dmFyIGU9KHRoaXMuX29mZmxpbmVQdXNoUGx1Z2luLmdldERldmljZVR5cGUoKXx8e30pLmRldmljZVR5cGU7cmV0dXJuIFZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5nZXREZXZpY2VCcmFuZCBvay4gZGV2aWNlVHlwZTpcIikuY29uY2F0KGUpKSxlfX19LHtrZXk6XCJfc2V0VG9rZW5cIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlLHQ9dGhpcyxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3NldFRva2VuXCIpLG89dGhpcy5nZXRNb2R1bGUoeG4pLHM9MSxhPVwiXCIsaT1cIlwiO3p0KHRoaXMuX2RldmljZVRva2VuKSYmKHM9MCk7dmFyIHI9dGhpcy5nZXRVbmlBcHBQbGF0Zm9ybSgpLHU9dGhpcy5nZXREZXZpY2VCcmFuZCgpO3I9PT1SLklPU3x8cj09PVIuSVBBRHx8cj09PVIuTUFDP2k9dGhpcy5fZGV2aWNlVG9rZW46cj09PVIuQU5EUk9JRCYmKGE9dGhpcy5fZGV2aWNlVG9rZW4pO3ZhciBjPW5ldyBBYShcIm9mZmxpbmVQdXNoU2V0VG9rZW5cIik7cmV0dXJuIGU9XCJkZXZpY2VUb2tlbjpcIi5jb25jYXQoaXx8YSxcIiwgYnVzaW5lc3NJRDpcIikuY29uY2F0KHRoaXMuX2J1c2luZXNzSUQsXCIsIFwiKStcImRldmljZUJyYW5kOlwiLmNvbmNhdCh1LFwiLCBpc1dlYlVuaWFwcDpcIikuY29uY2F0KHRoaXMuX2lzV2ViVW5pYXBwLFwiLCBwdXNoTXNnOlwiKS5jb25jYXQocyxcIiwgcGxhdGZvcm06XCIpLmNvbmNhdChyKSxjLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQoZSkpLFZlLmwoXCJcIi5jb25jYXQobixcIiBcIikuY29uY2F0KGUpKSx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpkYSxyZXF1ZXN0RGF0YTp7dG9rZW5JRDphLHB1c2hNc2c6cyxzZGtBcHBJRDpvLmdldFNES0FwcElEKCksYnVzaW5lc3NJRDpwYXJzZUludCh0aGlzLl9idXNpbmVzc0lEKSxkZXZpY2VCcmFuZDp1LGRldmljZVRva2VuOmksaXNXZWJVbmlhcHA6dGhpcy5faXNXZWJVbmlhcHB9fSkudGhlbigoZnVuY3Rpb24oZSl7cmV0dXJuIGMuZW5kKCksVmUubChcIlwiLmNvbmNhdChuLFwiIG9rXCIpKSxlfSkpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gdC5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbih0KXt2YXIgbj12KHQsMiksbz1uWzBdLHM9blsxXTtjLnNldEVycm9yKGUsbyxzKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksZSksWmEoZSl9KSl9fSx7a2V5OlwiX2dldENvbnZVbnJlYWRDb3VudFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9jMmNVbnJlYWRDb3VudD0wLHRoaXMuX2dyb3VwVW5yZWFkQ291bnQ9MCx0aGlzLmdldE1vZHVsZShxbikuZ2V0TG9jYWxDb252ZXJzYXRpb25MaXN0KCkuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC50eXBlPT09RS5DT05WX0MyQyYmKGUuX2MyY1VucmVhZENvdW50Kz10LnVucmVhZENvdW50KSx0LnR5cGU9PT1FLkNPTlZfR1JPVVAmJihlLl9ncm91cFVucmVhZENvdW50Kz10LnVucmVhZENvdW50KX0pKX19LHtrZXk6XCJfb25CYWNrZ3JvdW5kXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX29uQmFja2dyb3VuZFwiKSxuPW5ldyBBYShcIl9vbkJhY2tncm91bmRcIik7dGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6Y2EscmVxdWVzdERhdGE6e2MyY1VucmVhZENvdW50OnRoaXMuX2MyY1VucmVhZENvdW50LGdyb3VwVW5yZWFkQ291bnQ6dGhpcy5fZ3JvdXBVbnJlYWRDb3VudCxpc1dlYlVuaWFwcDp0aGlzLl9pc1dlYlVuaWFwcH19KS50aGVuKChmdW5jdGlvbihvKXtyZXR1cm4gbi5zZXRNZXNzYWdlKFwiYzJjVW5yZWFkQ291bnQ6IFwiLmNvbmNhdChlLl9jMmNVbnJlYWRDb3VudCxcIiwgZ3JvdXBVbnJlYWRDb3VudDogXCIpLmNvbmNhdChlLl9ncm91cFVucmVhZENvdW50KSkuZW5kKCksVmUubChcIlwiLmNvbmNhdCh0LFwiIG9rXCIpKSxvfSkpLmNhdGNoKChmdW5jdGlvbihvKXtlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciB0PXYoZSwyKSxzPXRbMF0sYT10WzFdO24uc2V0RXJyb3IobyxzLGEpLmVuZCgpfSkpLFZlLmUoXCJcIi5jb25jYXQodCxcIiBmYWlsZWQuIGVycm9yOlwiKSxvKX0pKX19LHtrZXk6XCJfb25Gb3JlZ3JvdW5kXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9XCJcIi5jb25jYXQodGhpcy5fbixcIi5cIikuY29uY2F0KFwiX29uRm9yZWdyb3VuZFwiKSxuPW5ldyBBYShcIl9vbkZvcmVncm91bmRcIik7dGhpcy5yZXF1ZXN0KHtwcm90b2NvbE5hbWU6bGEscmVxdWVzdERhdGE6e2lzV2ViVW5pYXBwOnRoaXMuX2lzV2ViVW5pYXBwfX0pLnRoZW4oKGZ1bmN0aW9uKGUpe3JldHVybiBuLmVuZCgpLFZlLmwoXCJcIi5jb25jYXQodCxcIiBva1wiKSksZX0pKS5jYXRjaCgoZnVuY3Rpb24obyl7ZS5wcm9iZU5ldHdvcmsoKS50aGVuKChmdW5jdGlvbihlKXt2YXIgdD12KGUsMikscz10WzBdLGE9dFsxXTtuLnNldEVycm9yKG8scyxhKS5lbmQoKX0pKSxWZS5lKFwiXCIuY29uY2F0KHQsXCIgZmFpbGVkLiBlcnJvcjpcIiksbyl9KSl9fSx7a2V5OlwiZ2V0VW5pQXBwUGxhdGZvcm1cIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXVuaS5nZXRTeXN0ZW1JbmZvU3luYygpLnBsYXRmb3JtLHQ9dGhpcy5nZXREZXZpY2VCcmFuZCgpO3JldHVyblwiaW9zXCI9PT1lP1IuSU9TOlwiYW5kcm9pZFwiPT09ZT9SLkFORFJPSUQ6MTAwMj09PXQ/Ui5JUEFEOjEwMDE9PT10P1IuTUFDOnZvaWQgMH19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZGV2aWNlVG9rZW49XCJcIix0aGlzLl9idXNpbmVzc0lEPTAsdGhpcy5fYzJjVW5yZWFkQ291bnQ9MCx0aGlzLl9ncm91cFVucmVhZENvdW50PTAsdGhpcy5faXNXZWJVbmlhcHA9MCxWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpfX1dKSxufSh1bykscnU9ZnVuY3Rpb24oZSl7cihuLGUpO3ZhciB0PWYobik7ZnVuY3Rpb24gbihlKXt2YXIgcztyZXR1cm4gbyh0aGlzLG4pLChzPXQuY2FsbCh0aGlzLGUpKS5fbj1cIlByb2Zhbml0eUZpbHRlck1vZHVsZVwiLHMuX3BsdWdpbj1udWxsLHMuX2ZpbHRlckNvbmZpZ01hcD1uZXcgTWFwLHMuX3N0YXJ0SW5kZXg9MCxzLl92ZXJzaW9uPTAscy5fY2FuSVVzZUxleGljb249ITEscy5faXNGZXRjaGluZz0hMSxzLl9leHBpcmVkVGltZT0wLHN9cmV0dXJuIGEobixbe2tleTpcImluaXRcIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0TW9kdWxlKFluKS5nZXRQbHVnaW4oXCJ0aW0tcHJvZmFuaXR5LWZpbHRlci1wbHVnaW5cIik7ZT8odGhpcy5fcGx1Z2luPW5ldyBlKHtsb2dnZXI6VmUsaXNBcnJheTphdCxpc01hcDpRZSxpc0Rldk1vZGU6dGhpcy5pc0Rldk1vZGUoKX0pLHRoaXMuX2dldExleGljb24oKSk6dGhpcy5vdXRwdXRXYXJuaW5nKFwiUHJvZmFuaXR5UGx1Z2luTm90Rm91bmRcIil9fSx7a2V5Olwib25DaGVja1RpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9wbHVnaW4mJnRoaXMuX2NhbklVc2VMZXhpY29uJiZ0aGlzLmlzTG9nZ2VkSW4oKSYmIXRoaXMuX2lzRmV0Y2hpbmcmJkRhdGUubm93KCk+PXRoaXMuX2V4cGlyZWRUaW1lJiZ0aGlzLl9nZXRMZXhpY29uKCl9fSx7a2V5OlwiZmlsdGVyTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49ITA7aWYoIXRoaXMuX3BsdWdpbnx8IXRoaXMuX2NhbklVc2VMZXhpY29uKXJldHVybiBuO2lmKHQmJnQubWVzc2FnZUNvbnRyb2xJbmZvJiYhMD09PXQubWVzc2FnZUNvbnRyb2xJbmZvLmV4Y2x1ZGVkRnJvbUNvbnRlbnRNb2RlcmF0aW9uKXJldHVybiBuO3ZhciBvPWUudHlwZSxzPWUuY29udmVyc2F0aW9uVHlwZTtpZihvIT09RS5NU0dfVEVYVCYmbyE9PUUuTVNHX0NVU1RPTSlyZXR1cm4gbjt2YXIgYSxpPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZmlsdGVyTWVzc2FnZVwiKTtpZihWZS5sKFwiXCIuY29uY2F0KGkpKSxvPT09RS5NU0dfVEVYVCl7aWYocz09PUUuQ09OVl9DMkM/YT1IOnM9PT1FLkNPTlZfR1JPVVAmJihhPVcpLCF0aGlzLl9pc0NvbmZpZ09uKGEpKXJldHVybiBuO3ZhciByPXRoaXMuX3BsdWdpbi5maWx0ZXIoZS5wYXlsb2FkLnRleHQpLHU9ci50eXBlLGM9ci5tb2RpZmllZFRleHQ7MT09PXU/bj0hMToyPT09dSYmKGUucGF5bG9hZC50ZXh0PWMpfWVsc2UgaWYobz09PUUuTVNHX0NVU1RPTSl7aWYocz09PUUuQ09OVl9DMkM/YT1LOnM9PT1FLkNPTlZfR1JPVVAmJihhPVkpLCF0aGlzLl9pc0NvbmZpZ09uKGEpKXJldHVybiBuO3ZhciBsPXRoaXMuX3BsdWdpbi5maWx0ZXIoZS5wYXlsb2FkLmRhdGEpLGQ9dGhpcy5fcGx1Z2luLmZpbHRlcihlLnBheWxvYWQuZGVzY3JpcHRpb24pLHA9dGhpcy5fcGx1Z2luLmZpbHRlcihlLnBheWxvYWQuZXh0ZW5zaW9uKTsxPT09bC50eXBlfHwxPT09ZC50eXBlfHwxPT09cC50eXBlP249ITE6KDI9PT1sLnR5cGUmJihlLnBheWxvYWQuZGF0YT1sLm1vZGlmaWVkVGV4dCksMj09PWQudHlwZSYmKGUucGF5bG9hZC5kZXNjcmlwdGlvbj1kLm1vZGlmaWVkVGV4dCksMj09PXAudHlwZSYmKGUucGF5bG9hZC5leHRlbnNpb249cC5tb2RpZmllZFRleHQpKX1yZXR1cm4gVmUubChcIlwiLmNvbmNhdChpLFwiIGRvbmUuIGlzQWxsb3dlZFRvU2VuZDpcIikuY29uY2F0KG4pKSxufX0se2tleTpcImZpbHRlclRleHRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuZmlsdGVyVGV4dFwiKSxvPXtpc0FsbG93ZWRUb1NlbmQ6ITAsbW9kaWZpZWRUZXh0OmV9O2lmKCF0aGlzLl9wbHVnaW58fCF0aGlzLl9jYW5JVXNlTGV4aWNvbilyZXR1cm4gbztpZighdGhpcy5faXNDb25maWdPbih0KSlyZXR1cm4gbztWZS5sKFwiXCIuY29uY2F0KG4pKTt2YXIgcz10aGlzLl9wbHVnaW4uZmlsdGVyKGUpLGE9cy50eXBlLGk9cy5tb2RpZmllZFRleHQ7cmV0dXJuIDE9PT1hP28uaXNBbGxvd2VkVG9TZW5kPSExOjI9PT1hJiYoby5tb2RpZmllZFRleHQ9aSksVmUubChcIlwiLmNvbmNhdChuLFwiIGRvbmUuIHJldDpcIiksbyksb319LHtrZXk6XCJfZ2V0TGV4aWNvblwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PW5ldyBBYShcInByb2Zhbml0eUZpbHRlclwiKSxuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2dldExleGljb25cIik7dGhpcy5faXNGZXRjaGluZz0hMCx0aGlzLnJlcXVlc3Qoe3Byb3RvY29sTmFtZTpwYSxyZXF1ZXN0RGF0YTp7c3RhcnRJbmRleDp0aGlzLl9zdGFydEluZGV4LHZlcnNpb246dGhpcy5fdmVyc2lvbn19KS50aGVuKChmdW5jdGlvbihvKXt2YXIgcz1vLmRhdGEsYT1zLmVycm9ySW5mbyxpPXMuZmlsdGVyQ29uZmlnLHI9cy5sZXhpY29uLHU9cy5zdHJUb2tlbixjPXMuY29tcGxldGVGbGFnLGw9cy5uZXh0U3RhcnRJbmRleCxkPXMudmVyc2lvbixwPXMuZXhwaXJlZFRpbWUsZz1hLmVycm9yQ29kZSxoPWEuZXJyb3JNZXNzYWdlO3JldHVybiAwIT09Zz8oZS5faXNGZXRjaGluZz0hMSxWZS53KFwiXCIuY29uY2F0KG4sXCIgZmFpbGVkLiBlcnJvcjpcIiksYSksdm9pZCB0LnNldENvZGUoZykuc2V0TWVzc2FnZShoKS5lbmQoKSk6KGUuX29uRmlsdGVyQ29uZmlnKGkpLGUuX2dldFRva2VuKHUpLDE9PT1jPyhWZS5sKFwiXCIuY29uY2F0KG4sXCIgZG9uZS4gdmVyc2lvbjpcIikuY29uY2F0KGQsXCIgZXhwaXJlZFRpbWU6XCIpLmNvbmNhdChwKSksZS5fdmVyc2lvbj1kLGUuX2NhbklVc2VMZXhpY29uPSEwLGUuX2lzRmV0Y2hpbmc9ITEsZS5fZXhwaXJlZFRpbWU9RGF0ZS5ub3coKSsxZTMqcCx2b2lkIGUuX3BsdWdpbi5vbkxleGljb25Db21wbGV0ZWQocikpOihlLl9zdGFydEluZGV4PWwsZS5fcGx1Z2luLm9uTGV4aWNvblNsaWNlZChyKSx2b2lkIGUuX2dldExleGljb24oKSkpfSkpLmNhdGNoKChmdW5jdGlvbihvKXtlLnByb2JlTmV0d29yaygpLnRoZW4oKGZ1bmN0aW9uKGUpe3ZhciBuPXYoZSwyKSxzPW5bMF0sYT1uWzFdO3Quc2V0RXJyb3IobyxzLGEpLmVuZCgpfSkpLGUuX2lzRmV0Y2hpbmc9ITEsVmUubChcIlwiLmNvbmNhdChuLFwiIGZhaWxlZC4gZXJyb3I6XCIpLG8pfSkpfX0se2tleTpcIl9vbkZpbHRlckNvbmZpZ1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7enQoZSl8fCh0aGlzLl9maWx0ZXJDb25maWdNYXAuY2xlYXIoKSxPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbihuKXt0Ll9maWx0ZXJDb25maWdNYXAuc2V0KG4sZVtuXSl9KSksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9vbkZpbHRlckNvbmZpZy4ga2V5czpcIikuY29uY2F0KEFycmF5LmZyb20odGhpcy5fZmlsdGVyQ29uZmlnTWFwLmtleXMoKSksXCIgdmFsdWVzOlwiKS5jb25jYXQoQXJyYXkuZnJvbSh0aGlzLl9maWx0ZXJDb25maWdNYXAudmFsdWVzKCkpKSkpfX0se2tleTpcIl9pc0NvbmZpZ09uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIDE9PT10aGlzLl9maWx0ZXJDb25maWdNYXAuZ2V0KGUpfX0se2tleTpcIl9nZXRUb2tlblwiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKG50KGUpKXt2YXIgdD1lLmxlbmd0aCxuPVwiXCI7aWYodCUyPT0wKWZvcih2YXIgbz0wO288PXQtMTtvKz0yKW4rPWVbbysxXSxuKz1lW29dO2Vsc2V7Zm9yKHZhciBzPTA7czx0LTE7cys9MiluKz1lW3MrMV0sbis9ZVtzXTtuKz1lW3QtMV19dGhpcy5fcGx1Z2luLm9uVG9rZW4obil9fX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLHRoaXMuX3BsdWdpbiYmKHRoaXMuX3BsdWdpbi5yZXNldCgpLHRoaXMuX3BsdWdpbj1udWxsKSx0aGlzLl9maWx0ZXJDb25maWdNYXAuY2xlYXIoKSx0aGlzLl9zdGFydEluZGV4PTAsdGhpcy5fdmVyc2lvbj0wLHRoaXMuX2NhbklVc2VMZXhpY29uPSExLHRoaXMuX2lzRmV0Y2hpbmc9ITEsdGhpcy5fZXhwaXJlZFRpbWU9MH19XSksbn0odW8pLHV1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtvKHRoaXMsZSksdGhpcy5fbT10LHRoaXMuX249XCJUcmFuc0NtZE1vZHVsZVwiLHRoaXMuX1RSVENDb21tYW5kTGlzdD1bXCJ0dWlfcm9vbV9zdnIuKlwiXSx0aGlzLl9tLmdldElubmVyRW1pdHRlckluc3RhbmNlKCkub24odGksdGhpcy5fb25DbG91ZENvbmZpZ1VwZGF0ZWQsdGhpcyl9cmV0dXJuIGEoZSxbe2tleTpcIl9vbkNsb3VkQ29uZmlnVXBkYXRlZFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PXRoaXMuX20uZ2V0TW9kdWxlKFpuKS5nZXRDbG91ZENvbmZpZyhcInJ0Y19jbWRcIik7aXQodCl8fCh0PUpTT04ucGFyc2UodCkpLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UuX1RSVENDb21tYW5kTGlzdC5pbmNsdWRlcyh0KXx8ZS5fVFJUQ0NvbW1hbmRMaXN0LnB1c2godCl9KSl9fSx7a2V5Olwic2VuZFRSVENDdXN0b21EYXRhXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5zZXJ2aWNlQ29tbWFuZCxuPWUuZGF0YSxvPVwiXCIuY29uY2F0KFYuTkFNRS5UVUlST09NX1NWUixcIi4qXCIpO3JldHVybiBpdCh0KXx8KG89dCksdGhpcy5fVFJUQ0NvbW1hbmRMaXN0LmluY2x1ZGVzKG8pP3RoaXMuX3RyYW5zKHtzZXJ2Y21kOm8sZGF0YTpufSk6WmEoe2NvZGU6aGEuSU5WQUxJRF9UUlRDX0NNRH0pfX0se2tleTpcIl90cmFuc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe1ZlLmQoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fdHJhbnMuIG9wdGlvbnM6XCIpLmNvbmNhdChKU09OLnN0cmluZ2lmeShlKSkpO3ZhciB0PWUuc2VydmNtZCxuPWUuZGF0YTtyZXR1cm4gdGhpcy5fbS5nZXRNb2R1bGUoem4pLnRyYW5zKHtzZXJ2Y21kOnQsZGF0YTpudChuKT9KU09OLnBhcnNlKG4pOm59KX19LHtrZXk6XCJnZXRDb21tYW5kTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX1RSVENDb21tYW5kTGlzdH19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKX19XSksZX0oKSxjdT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpLHRoaXMuX209dCx0aGlzLl9uPVwiRXJyb3JNZXNzYWdlTW9kdWxlXCIsdGhpcy5USU1fRVJST1JfQVNTSVNUQU5DRT1cInRpbV9lcnJvcl9hc3Npc3RhbmNlXCIsdGhpcy5TVE9SQUdFX0VYUElSRVNfVElNRT02MDQ4ZTUsdGhpcy5fbWFwPW5ldyBNYXAsdGhpcy5faW5pdCgpfXJldHVybiBhKGUsW3trZXk6XCJfaW5pdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZ2V0U3RvcmFnZU1vZHVsZSgpLmdldEl0ZW0odGhpcy5USU1fRVJST1JfQVNTSVNUQU5DRSwhMSk7aWYoZSl7dmFyIHQ7dHJ5e3Q9SlNPTi5wYXJzZShlKX1jYXRjaChuKXt0aGlzLl9nZXRTdG9yYWdlTW9kdWxlKCkucmVtb3ZlSXRlbSh0aGlzLlRJTV9FUlJPUl9BU1NJU1RBTkNFLCExKSxWZS53KFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2luaXQgZXJyb3I6XCIpLG4pfXQmJih0aGlzLl9uZWVkVG9VcGRhdGUodCk/dGhpcy5fZmV0Y2goKTp0aGlzLl9maWxsTWFwKHQubWVzc2FnZSkpfWVsc2UgdGhpcy5fZmV0Y2goKX19LHtrZXk6XCJfbmVlZFRvVXBkYXRlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5sb2NhbFNhdmVkVGltZSxuPWUubG9jYWxTYXZlZFZlcnNpb24sbz10JiYobmV3IERhdGUpLmdldFRpbWUoKS10Pj10aGlzLlNUT1JBR0VfRVhQSVJFU19USU1FLHM9IW58fFwiMi4yNy42XCIhPT1uO3JldHVybiBWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX25lZWRUb1VwZGF0ZSBpc1RpbWVvdXQ6XCIpLmNvbmNhdChvLFwiIGlzRGlmZmVyZW50VmVyc2lvbjpcIikuY29uY2F0KHMpKSxvfHxzfX0se2tleTpcIl9mZXRjaFwiLHZhbHVlOmZ1bmN0aW9uKCl7aWYoIXRoaXMuX20uZ2V0TW9kdWxlKHhuKS5pc1ByaXZhdGVOZXRXb3JrKCkpe3ZhciBlPVwiaHR0cHM6Ly93ZWIuc2RrLnFjbG91ZC5jb20vaW0vZG93bmxvYWQvZXJyb3ItbWVzc2FnZS8wLjAuMS90aW0tZXJyb3ItbWVzc2FnZS50eHRcIix0PVwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLThcIixuPVwiXCIuY29uY2F0KHRoaXMuX24sXCIuX2ZldGNoIG9rIGluXCIpLG89dGhpcztpZihhZSlyZS5yZXF1ZXN0KHt1cmw6ZSxtZXRob2Q6XCJHRVRcIix0aW1lb3V0OjNlMyxoZWFkZXI6e1wiY29udGVudC10eXBlXCI6dH0sZGF0YVR5cGU6XCJ0ZXh0XCIsc3VjY2VzczpmdW5jdGlvbihlKXtvLl9maWxsQW5kU2F2ZShlLmRhdGEpLFZlLmwoXCJcIi5jb25jYXQobixcIiBtaW5pIHByb2dyYW1cIikpfSxmYWlsOmZ1bmN0aW9uKCl7fX0pO2Vsc2V7dmFyIHM9bmV3IFhNTEh0dHBSZXF1ZXN0LGE9c2V0VGltZW91dCgoZnVuY3Rpb24oKXtzLmFib3J0KCl9KSwzZTMpO3Mub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXMucmVhZHlTdGF0ZSYmKGNsZWFyVGltZW91dChhKSwyMDAhPT1zLnN0YXR1cyYmMzA0IT09cy5zdGF0dXN8fChWZS5sKFwiXCIuY29uY2F0KG4sXCIgYnJvd3NlclwiKSksby5fZmlsbEFuZFNhdmUocy5yZXNwb25zZVRleHQpKSl9LHMub3BlbihcIkdFVFwiLGUsITApLHMuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtdHlwZVwiLHQpLHMuc2VuZCgpfX19fSx7a2V5OlwiX2ZpbGxBbmRTYXZlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fZmlsbE1hcChlKSx0aGlzLl9nZXRTdG9yYWdlTW9kdWxlKCkuc2V0SXRlbSh0aGlzLlRJTV9FUlJPUl9BU1NJU1RBTkNFLEpTT04uc3RyaW5naWZ5KHttZXNzYWdlOmUsbG9jYWxTYXZlZFRpbWU6KG5ldyBEYXRlKS5nZXRUaW1lKCksbG9jYWxTYXZlZFZlcnNpb246XCIyLjI3LjZcIn0pLCEwLCExKX19LHtrZXk6XCJfZ2V0U3RvcmFnZU1vZHVsZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uZ2V0TW9kdWxlKFZuKX19LHtrZXk6XCJfZmlsbE1hcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX21hcC5jbGVhcigpO2Zvcih2YXIgdCxuLG8scz1lLnNwbGl0KFwiO1xcblwiKSxhPXMubGVuZ3RoLGk9bmV3IFJlZ0V4cCgvJy9nKSxyPTA7cjxhO3IrKylpZih0PXNbcl0uaW5kZXhPZihcIjpcIiksbj1zW3JdLnNsaWNlKDAsdCksbz1zW3JdLnNsaWNlKHQrMSxzW3JdLmxlbmd0aCksIW4uc3RhcnRzV2l0aChcIi8vXCIpKXtpZihpdChvKSljb250aW51ZTt0aGlzLl9tYXAuc2V0KG4sby5yZXBsYWNlKGksXCJcIikpfX19LHtrZXk6XCJnZXRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLmlzSW50bCxuPWUua2V5LG89ZS5yZXBsYWNlbWVudDEscz1lLnJlcGxhY2VtZW50MixhPVwiXCIuY29uY2F0KG4sdD9cIl9lblwiOlwiX2NuXCIpOyF0aGlzLl9tYXAuaGFzKGEpJiZ0aGlzLl9tYXAuaGFzKG4pJiYoYT1uKTt2YXIgaT1cIlwiO3JldHVybiB0aGlzLl9tYXAuaGFzKGEpPyhpPXRoaXMuX21hcC5nZXQoYSksaXQobyl8fChpPWkucmVwbGFjZShcIiRyZXBsYWNlbWVudDFcIixvKSksaXQocyl8fChpPWkucmVwbGFjZShcIiRyZXBsYWNlbWVudDJcIixzKSksaSk6aX19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKX19XSksZX0oKSxsdT1jcigoZnVuY3Rpb24oZSx0KXt2YXIgbz1cInVuZGVmaW5lZFwiIT10eXBlb2YgVWludDhBcnJheSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIFVpbnQxNkFycmF5JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgSW50MzJBcnJheTtmdW5jdGlvbiBzKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfXQuYXNzaWduPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7dC5sZW5ndGg7KXt2YXIgbz10LnNoaWZ0KCk7aWYobyl7aWYoXCJvYmplY3RcIiE9PW4obykpdGhyb3cgbmV3IFR5cGVFcnJvcihvK1wibXVzdCBiZSBub24tb2JqZWN0XCIpO2Zvcih2YXIgYSBpbiBvKXMobyxhKSYmKGVbYV09b1thXSl9fXJldHVybiBlfSx0LnNocmlua0J1Zj1mdW5jdGlvbihlLHQpe3JldHVybiBlLmxlbmd0aD09PXQ/ZTplLnN1YmFycmF5P2Uuc3ViYXJyYXkoMCx0KTooZS5sZW5ndGg9dCxlKX07dmFyIGE9e2FycmF5U2V0OmZ1bmN0aW9uKGUsdCxuLG8scyl7aWYodC5zdWJhcnJheSYmZS5zdWJhcnJheSllLnNldCh0LnN1YmFycmF5KG4sbitvKSxzKTtlbHNlIGZvcih2YXIgYT0wO2E8bzthKyspZVtzK2FdPXRbbithXX0sZmxhdHRlbkNodW5rczpmdW5jdGlvbihlKXt2YXIgdCxuLG8scyxhLGk7Zm9yKG89MCx0PTAsbj1lLmxlbmd0aDt0PG47dCsrKW8rPWVbdF0ubGVuZ3RoO2ZvcihpPW5ldyBVaW50OEFycmF5KG8pLHM9MCx0PTAsbj1lLmxlbmd0aDt0PG47dCsrKWE9ZVt0XSxpLnNldChhLHMpLHMrPWEubGVuZ3RoO3JldHVybiBpfX0saT17YXJyYXlTZXQ6ZnVuY3Rpb24oZSx0LG4sbyxzKXtmb3IodmFyIGE9MDthPG87YSsrKWVbcythXT10W24rYV19LGZsYXR0ZW5DaHVua3M6ZnVuY3Rpb24oZSl7cmV0dXJuW10uY29uY2F0LmFwcGx5KFtdLGUpfX07dC5zZXRUeXBlZD1mdW5jdGlvbihlKXtlPyh0LkJ1Zjg9VWludDhBcnJheSx0LkJ1ZjE2PVVpbnQxNkFycmF5LHQuQnVmMzI9SW50MzJBcnJheSx0LmFzc2lnbih0LGEpKToodC5CdWY4PUFycmF5LHQuQnVmMTY9QXJyYXksdC5CdWYzMj1BcnJheSx0LmFzc2lnbih0LGkpKX0sdC5zZXRUeXBlZChvKX0pKTtsdS5hc3NpZ24sbHUuc2hyaW5rQnVmLGx1LnNldFR5cGVkLGx1LkJ1ZjgsbHUuQnVmMTYsbHUuQnVmMzI7dmFyIGR1PWZ1bmN0aW9uKGUsdCxuLG8pe2Zvcih2YXIgcz02NTUzNSZlfDAsYT1lPj4+MTYmNjU1MzV8MCxpPTA7MCE9PW47KXtuLT1pPW4+MmUzPzJlMzpuO2Rve2E9YSsocz1zK3RbbysrXXwwKXwwfXdoaWxlKC0taSk7cyU9NjU1MjEsYSU9NjU1MjF9cmV0dXJuIHN8YTw8MTZ8MH07dmFyIHB1PWZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQ9W10sbj0wO248MjU2O24rKyl7ZT1uO2Zvcih2YXIgbz0wO288ODtvKyspZT0xJmU/Mzk4ODI5MjM4NF5lPj4+MTplPj4+MTt0W25dPWV9cmV0dXJuIHR9KCk7dmFyIGd1PWZ1bmN0aW9uKGUsdCxuLG8pe3ZhciBzPXB1LGE9bytuO2VePS0xO2Zvcih2YXIgaT1vO2k8YTtpKyspZT1lPj4+OF5zWzI1NSYoZV50W2ldKV07cmV0dXJuLTFeZX0saHU9ZnVuY3Rpb24oZSx0KXt2YXIgbixvLHMsYSxpLHIsdSxjLGwsZCxwLGcsaCxfLGYsdixtLE0seSxJLEMsVCxELGssRTtuPWUuc3RhdGUsbz1lLm5leHRfaW4saz1lLmlucHV0LHM9bysoZS5hdmFpbF9pbi01KSxhPWUubmV4dF9vdXQsRT1lLm91dHB1dCxpPWEtKHQtZS5hdmFpbF9vdXQpLHI9YSsoZS5hdmFpbF9vdXQtMjU3KSx1PW4uZG1heCxjPW4ud3NpemUsbD1uLndoYXZlLGQ9bi53bmV4dCxwPW4ud2luZG93LGc9bi5ob2xkLGg9bi5iaXRzLF89bi5sZW5jb2RlLGY9bi5kaXN0Y29kZSx2PSgxPDxuLmxlbmJpdHMpLTEsbT0oMTw8bi5kaXN0Yml0cyktMTtlOmRve2g8MTUmJihnKz1rW28rK108PGgsaCs9OCxnKz1rW28rK108PGgsaCs9OCksTT1fW2cmdl07dDpmb3IoOzspe2lmKGc+Pj49eT1NPj4+MjQsaC09eSwwPT09KHk9TT4+PjE2JjI1NSkpRVthKytdPTY1NTM1Jk07ZWxzZXtpZighKDE2JnkpKXtpZigwPT0oNjQmeSkpe009X1soNjU1MzUmTSkrKGcmKDE8PHkpLTEpXTtjb250aW51ZSB0fWlmKDMyJnkpe24ubW9kZT0xMjticmVhayBlfWUubXNnPVwiaW52YWxpZCBsaXRlcmFsL2xlbmd0aCBjb2RlXCIsbi5tb2RlPTMwO2JyZWFrIGV9ST02NTUzNSZNLCh5Jj0xNSkmJihoPHkmJihnKz1rW28rK108PGgsaCs9OCksSSs9ZyYoMTw8eSktMSxnPj4+PXksaC09eSksaDwxNSYmKGcrPWtbbysrXTw8aCxoKz04LGcrPWtbbysrXTw8aCxoKz04KSxNPWZbZyZtXTtuOmZvcig7Oyl7aWYoZz4+Pj15PU0+Pj4yNCxoLT15LCEoMTYmKHk9TT4+PjE2JjI1NSkpKXtpZigwPT0oNjQmeSkpe009ZlsoNjU1MzUmTSkrKGcmKDE8PHkpLTEpXTtjb250aW51ZSBufWUubXNnPVwiaW52YWxpZCBkaXN0YW5jZSBjb2RlXCIsbi5tb2RlPTMwO2JyZWFrIGV9aWYoQz02NTUzNSZNLGg8KHkmPTE1KSYmKGcrPWtbbysrXTw8aCwoaCs9OCk8eSYmKGcrPWtbbysrXTw8aCxoKz04KSksKEMrPWcmKDE8PHkpLTEpPnUpe2UubXNnPVwiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2tcIixuLm1vZGU9MzA7YnJlYWsgZX1pZihnPj4+PXksaC09eSxDPih5PWEtaSkpe2lmKCh5PUMteSk+bCYmbi5zYW5lKXtlLm1zZz1cImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrXCIsbi5tb2RlPTMwO2JyZWFrIGV9aWYoVD0wLEQ9cCwwPT09ZCl7aWYoVCs9Yy15LHk8SSl7SS09eTtkb3tFW2ErK109cFtUKytdfXdoaWxlKC0teSk7VD1hLUMsRD1FfX1lbHNlIGlmKGQ8eSl7aWYoVCs9YytkLXksKHktPWQpPEkpe0ktPXk7ZG97RVthKytdPXBbVCsrXX13aGlsZSgtLXkpO2lmKFQ9MCxkPEkpe0ktPXk9ZDtkb3tFW2ErK109cFtUKytdfXdoaWxlKC0teSk7VD1hLUMsRD1FfX19ZWxzZSBpZihUKz1kLXkseTxJKXtJLT15O2Rve0VbYSsrXT1wW1QrK119d2hpbGUoLS15KTtUPWEtQyxEPUV9Zm9yKDtJPjI7KUVbYSsrXT1EW1QrK10sRVthKytdPURbVCsrXSxFW2ErK109RFtUKytdLEktPTM7SSYmKEVbYSsrXT1EW1QrK10sST4xJiYoRVthKytdPURbVCsrXSkpfWVsc2V7VD1hLUM7ZG97RVthKytdPUVbVCsrXSxFW2ErK109RVtUKytdLEVbYSsrXT1FW1QrK10sSS09M313aGlsZShJPjIpO0kmJihFW2ErK109RVtUKytdLEk+MSYmKEVbYSsrXT1FW1QrK10pKX1icmVha319YnJlYWt9fXdoaWxlKG88cyYmYTxyKTtvLT1JPWg+PjMsZyY9KDE8PChoLT1JPDwzKSktMSxlLm5leHRfaW49byxlLm5leHRfb3V0PWEsZS5hdmFpbF9pbj1vPHM/cy1vKzU6NS0oby1zKSxlLmF2YWlsX291dD1hPHI/ci1hKzI1NzoyNTctKGEtciksbi5ob2xkPWcsbi5iaXRzPWh9LF91PVszLDQsNSw2LDcsOCw5LDEwLDExLDEzLDE1LDE3LDE5LDIzLDI3LDMxLDM1LDQzLDUxLDU5LDY3LDgzLDk5LDExNSwxMzEsMTYzLDE5NSwyMjcsMjU4LDAsMF0sZnU9WzE2LDE2LDE2LDE2LDE2LDE2LDE2LDE2LDE3LDE3LDE3LDE3LDE4LDE4LDE4LDE4LDE5LDE5LDE5LDE5LDIwLDIwLDIwLDIwLDIxLDIxLDIxLDIxLDE2LDcyLDc4XSx2dT1bMSwyLDMsNCw1LDcsOSwxMywxNywyNSwzMyw0OSw2NSw5NywxMjksMTkzLDI1NywzODUsNTEzLDc2OSwxMDI1LDE1MzcsMjA0OSwzMDczLDQwOTcsNjE0NSw4MTkzLDEyMjg5LDE2Mzg1LDI0NTc3LDAsMF0sbXU9WzE2LDE2LDE2LDE2LDE3LDE3LDE4LDE4LDE5LDE5LDIwLDIwLDIxLDIxLDIyLDIyLDIzLDIzLDI0LDI0LDI1LDI1LDI2LDI2LDI3LDI3LDI4LDI4LDI5LDI5LDY0LDY0XSxNdT1mdW5jdGlvbihlLHQsbixvLHMsYSxpLHIpe3ZhciB1LGMsbCxkLHAsZyxoLF8sZix2PXIuYml0cyxtPTAsTT0wLHk9MCxJPTAsQz0wLFQ9MCxEPTAsaz0wLEU9MCxTPTAsTD1udWxsLEE9MCxSPW5ldyBsdS5CdWYxNigxNiksTj1uZXcgbHUuQnVmMTYoMTYpLE89bnVsbCxHPTA7Zm9yKG09MDttPD0xNTttKyspUlttXT0wO2ZvcihNPTA7TTxvO00rKylSW3RbbitNXV0rKztmb3IoQz12LEk9MTU7ST49MSYmMD09PVJbSV07SS0tKTtpZihDPkkmJihDPUkpLDA9PT1JKXJldHVybiBzW2ErK109MjA5NzE1MjAsc1thKytdPTIwOTcxNTIwLHIuYml0cz0xLDA7Zm9yKHk9MTt5PEkmJjA9PT1SW3ldO3krKyk7Zm9yKEM8eSYmKEM9eSksaz0xLG09MTttPD0xNTttKyspaWYoazw8PTEsKGstPVJbbV0pPDApcmV0dXJuLTE7aWYoaz4wJiYoMD09PWV8fDEhPT1JKSlyZXR1cm4tMTtmb3IoTlsxXT0wLG09MTttPDE1O20rKylOW20rMV09TlttXStSW21dO2ZvcihNPTA7TTxvO00rKykwIT09dFtuK01dJiYoaVtOW3RbbitNXV0rK109TSk7aWYoMD09PWU/KEw9Tz1pLGc9MTkpOjE9PT1lPyhMPV91LEEtPTI1NyxPPWZ1LEctPTI1NyxnPTI1Nik6KEw9dnUsTz1tdSxnPS0xKSxTPTAsTT0wLG09eSxwPWEsVD1DLEQ9MCxsPS0xLGQ9KEU9MTw8QyktMSwxPT09ZSYmRT44NTJ8fDI9PT1lJiZFPjU5MilyZXR1cm4gMTtmb3IoOzspe2g9bS1ELGlbTV08Zz8oXz0wLGY9aVtNXSk6aVtNXT5nPyhfPU9bRytpW01dXSxmPUxbQStpW01dXSk6KF89OTYsZj0wKSx1PTE8PG0tRCx5PWM9MTw8VDtkb3tzW3ArKFM+PkQpKyhjLT11KV09aDw8MjR8Xzw8MTZ8ZnwwfXdoaWxlKDAhPT1jKTtmb3IodT0xPDxtLTE7UyZ1Oyl1Pj49MTtpZigwIT09dT8oUyY9dS0xLFMrPXUpOlM9MCxNKyssMD09LS1SW21dKXtpZihtPT09SSlicmVhazttPXRbbitpW01dXX1pZihtPkMmJihTJmQpIT09bCl7Zm9yKDA9PT1EJiYoRD1DKSxwKz15LGs9MTw8KFQ9bS1EKTtUK0Q8SSYmISgoay09UltUK0RdKTw9MCk7KVQrKyxrPDw9MTtpZihFKz0xPDxULDE9PT1lJiZFPjg1Mnx8Mj09PWUmJkU+NTkyKXJldHVybiAxO3NbbD1TJmRdPUM8PDI0fFQ8PDE2fHAtYXwwfX1yZXR1cm4gMCE9PVMmJihzW3ArU109bS1EPDwyNHw2NDw8MTZ8MCksci5iaXRzPUMsMH07ZnVuY3Rpb24geXUoZSl7cmV0dXJuKGU+Pj4yNCYyNTUpKyhlPj4+OCY2NTI4MCkrKCg2NTI4MCZlKTw8OCkrKCgyNTUmZSk8PDI0KX1mdW5jdGlvbiBJdSgpe3RoaXMubW9kZT0wLHRoaXMubGFzdD0hMSx0aGlzLndyYXA9MCx0aGlzLmhhdmVkaWN0PSExLHRoaXMuZmxhZ3M9MCx0aGlzLmRtYXg9MCx0aGlzLmNoZWNrPTAsdGhpcy50b3RhbD0wLHRoaXMuaGVhZD1udWxsLHRoaXMud2JpdHM9MCx0aGlzLndzaXplPTAsdGhpcy53aGF2ZT0wLHRoaXMud25leHQ9MCx0aGlzLndpbmRvdz1udWxsLHRoaXMuaG9sZD0wLHRoaXMuYml0cz0wLHRoaXMubGVuZ3RoPTAsdGhpcy5vZmZzZXQ9MCx0aGlzLmV4dHJhPTAsdGhpcy5sZW5jb2RlPW51bGwsdGhpcy5kaXN0Y29kZT1udWxsLHRoaXMubGVuYml0cz0wLHRoaXMuZGlzdGJpdHM9MCx0aGlzLm5jb2RlPTAsdGhpcy5ubGVuPTAsdGhpcy5uZGlzdD0wLHRoaXMuaGF2ZT0wLHRoaXMubmV4dD1udWxsLHRoaXMubGVucz1uZXcgbHUuQnVmMTYoMzIwKSx0aGlzLndvcms9bmV3IGx1LkJ1ZjE2KDI4OCksdGhpcy5sZW5keW49bnVsbCx0aGlzLmRpc3RkeW49bnVsbCx0aGlzLnNhbmU9MCx0aGlzLmJhY2s9MCx0aGlzLndhcz0wfWZ1bmN0aW9uIEN1KGUpe3ZhciB0O3JldHVybiBlJiZlLnN0YXRlPyh0PWUuc3RhdGUsZS50b3RhbF9pbj1lLnRvdGFsX291dD10LnRvdGFsPTAsZS5tc2c9XCJcIix0LndyYXAmJihlLmFkbGVyPTEmdC53cmFwKSx0Lm1vZGU9MSx0Lmxhc3Q9MCx0LmhhdmVkaWN0PTAsdC5kbWF4PTMyNzY4LHQuaGVhZD1udWxsLHQuaG9sZD0wLHQuYml0cz0wLHQubGVuY29kZT10LmxlbmR5bj1uZXcgbHUuQnVmMzIoODUyKSx0LmRpc3Rjb2RlPXQuZGlzdGR5bj1uZXcgbHUuQnVmMzIoNTkyKSx0LnNhbmU9MSx0LmJhY2s9LTEsMCk6LTJ9ZnVuY3Rpb24gVHUoZSl7dmFyIHQ7cmV0dXJuIGUmJmUuc3RhdGU/KCh0PWUuc3RhdGUpLndzaXplPTAsdC53aGF2ZT0wLHQud25leHQ9MCxDdShlKSk6LTJ9ZnVuY3Rpb24gRHUoZSx0KXt2YXIgbixvO3JldHVybiBlJiZlLnN0YXRlPyhvPWUuc3RhdGUsdDwwPyhuPTAsdD0tdCk6KG49MSsodD4+NCksdDw0OCYmKHQmPTE1KSksdCYmKHQ8OHx8dD4xNSk/LTI6KG51bGwhPT1vLndpbmRvdyYmby53Yml0cyE9PXQmJihvLndpbmRvdz1udWxsKSxvLndyYXA9bixvLndiaXRzPXQsVHUoZSkpKTotMn1mdW5jdGlvbiBrdShlLHQpe3ZhciBuLG87cmV0dXJuIGU/KG89bmV3IEl1LGUuc3RhdGU9byxvLndpbmRvdz1udWxsLDAhPT0obj1EdShlLHQpKSYmKGUuc3RhdGU9bnVsbCksbik6LTJ9dmFyIEV1LFN1LEx1PSEwO2Z1bmN0aW9uIEF1KGUpe2lmKEx1KXt2YXIgdDtmb3IoRXU9bmV3IGx1LkJ1ZjMyKDUxMiksU3U9bmV3IGx1LkJ1ZjMyKDMyKSx0PTA7dDwxNDQ7KWUubGVuc1t0KytdPTg7Zm9yKDt0PDI1NjspZS5sZW5zW3QrK109OTtmb3IoO3Q8MjgwOyllLmxlbnNbdCsrXT03O2Zvcig7dDwyODg7KWUubGVuc1t0KytdPTg7Zm9yKE11KDEsZS5sZW5zLDAsMjg4LEV1LDAsZS53b3JrLHtiaXRzOjl9KSx0PTA7dDwzMjspZS5sZW5zW3QrK109NTtNdSgyLGUubGVucywwLDMyLFN1LDAsZS53b3JrLHtiaXRzOjV9KSxMdT0hMX1lLmxlbmNvZGU9RXUsZS5sZW5iaXRzPTksZS5kaXN0Y29kZT1TdSxlLmRpc3RiaXRzPTV9ZnVuY3Rpb24gUnUoZSx0LG4sbyl7dmFyIHMsYT1lLnN0YXRlO3JldHVybiBudWxsPT09YS53aW5kb3cmJihhLndzaXplPTE8PGEud2JpdHMsYS53bmV4dD0wLGEud2hhdmU9MCxhLndpbmRvdz1uZXcgbHUuQnVmOChhLndzaXplKSksbz49YS53c2l6ZT8obHUuYXJyYXlTZXQoYS53aW5kb3csdCxuLWEud3NpemUsYS53c2l6ZSwwKSxhLnduZXh0PTAsYS53aGF2ZT1hLndzaXplKTooKHM9YS53c2l6ZS1hLnduZXh0KT5vJiYocz1vKSxsdS5hcnJheVNldChhLndpbmRvdyx0LG4tbyxzLGEud25leHQpLChvLT1zKT8obHUuYXJyYXlTZXQoYS53aW5kb3csdCxuLW8sbywwKSxhLnduZXh0PW8sYS53aGF2ZT1hLndzaXplKTooYS53bmV4dCs9cyxhLnduZXh0PT09YS53c2l6ZSYmKGEud25leHQ9MCksYS53aGF2ZTxhLndzaXplJiYoYS53aGF2ZSs9cykpKSwwfXZhciBOdT17aW5mbGF0ZVJlc2V0OlR1LGluZmxhdGVSZXNldDI6RHUsaW5mbGF0ZVJlc2V0S2VlcDpDdSxpbmZsYXRlSW5pdDpmdW5jdGlvbihlKXtyZXR1cm4ga3UoZSwxNSl9LGluZmxhdGVJbml0MjprdSxpbmZsYXRlOmZ1bmN0aW9uKGUsdCl7dmFyIG4sbyxzLGEsaSxyLHUsYyxsLGQscCxnLGgsXyxmLHYsbSxNLHksSSxDLFQsRCxrLEU9MCxTPW5ldyBsdS5CdWY4KDQpLEw9WzE2LDE3LDE4LDAsOCw3LDksNiwxMCw1LDExLDQsMTIsMywxMywyLDE0LDEsMTVdO2lmKCFlfHwhZS5zdGF0ZXx8IWUub3V0cHV0fHwhZS5pbnB1dCYmMCE9PWUuYXZhaWxfaW4pcmV0dXJuLTI7MTI9PT0obj1lLnN0YXRlKS5tb2RlJiYobi5tb2RlPTEzKSxpPWUubmV4dF9vdXQscz1lLm91dHB1dCx1PWUuYXZhaWxfb3V0LGE9ZS5uZXh0X2luLG89ZS5pbnB1dCxyPWUuYXZhaWxfaW4sYz1uLmhvbGQsbD1uLmJpdHMsZD1yLHA9dSxUPTA7ZTpmb3IoOzspc3dpdGNoKG4ubW9kZSl7Y2FzZSAxOmlmKDA9PT1uLndyYXApe24ubW9kZT0xMzticmVha31mb3IoO2w8MTY7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1pZigyJm4ud3JhcCYmMzU2MTU9PT1jKXtuLmNoZWNrPTAsU1swXT0yNTUmYyxTWzFdPWM+Pj44JjI1NSxuLmNoZWNrPWd1KG4uY2hlY2ssUywyLDApLGM9MCxsPTAsbi5tb2RlPTI7YnJlYWt9aWYobi5mbGFncz0wLG4uaGVhZCYmKG4uaGVhZC5kb25lPSExKSwhKDEmbi53cmFwKXx8KCgoMjU1JmMpPDw4KSsoYz4+OCkpJTMxKXtlLm1zZz1cImluY29ycmVjdCBoZWFkZXIgY2hlY2tcIixuLm1vZGU9MzA7YnJlYWt9aWYoOCE9KDE1JmMpKXtlLm1zZz1cInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kXCIsbi5tb2RlPTMwO2JyZWFrfWlmKGwtPTQsQz04KygxNSYoYz4+Pj00KSksMD09PW4ud2JpdHMpbi53Yml0cz1DO2Vsc2UgaWYoQz5uLndiaXRzKXtlLm1zZz1cImludmFsaWQgd2luZG93IHNpemVcIixuLm1vZGU9MzA7YnJlYWt9bi5kbWF4PTE8PEMsZS5hZGxlcj1uLmNoZWNrPTEsbi5tb2RlPTUxMiZjPzEwOjEyLGM9MCxsPTA7YnJlYWs7Y2FzZSAyOmZvcig7bDwxNjspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fWlmKG4uZmxhZ3M9Yyw4IT0oMjU1Jm4uZmxhZ3MpKXtlLm1zZz1cInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kXCIsbi5tb2RlPTMwO2JyZWFrfWlmKDU3MzQ0Jm4uZmxhZ3Mpe2UubXNnPVwidW5rbm93biBoZWFkZXIgZmxhZ3Mgc2V0XCIsbi5tb2RlPTMwO2JyZWFrfW4uaGVhZCYmKG4uaGVhZC50ZXh0PWM+PjgmMSksNTEyJm4uZmxhZ3MmJihTWzBdPTI1NSZjLFNbMV09Yz4+PjgmMjU1LG4uY2hlY2s9Z3Uobi5jaGVjayxTLDIsMCkpLGM9MCxsPTAsbi5tb2RlPTM7Y2FzZSAzOmZvcig7bDwzMjspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fW4uaGVhZCYmKG4uaGVhZC50aW1lPWMpLDUxMiZuLmZsYWdzJiYoU1swXT0yNTUmYyxTWzFdPWM+Pj44JjI1NSxTWzJdPWM+Pj4xNiYyNTUsU1szXT1jPj4+MjQmMjU1LG4uY2hlY2s9Z3Uobi5jaGVjayxTLDQsMCkpLGM9MCxsPTAsbi5tb2RlPTQ7Y2FzZSA0OmZvcig7bDwxNjspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fW4uaGVhZCYmKG4uaGVhZC54ZmxhZ3M9MjU1JmMsbi5oZWFkLm9zPWM+PjgpLDUxMiZuLmZsYWdzJiYoU1swXT0yNTUmYyxTWzFdPWM+Pj44JjI1NSxuLmNoZWNrPWd1KG4uY2hlY2ssUywyLDApKSxjPTAsbD0wLG4ubW9kZT01O2Nhc2UgNTppZigxMDI0Jm4uZmxhZ3Mpe2Zvcig7bDwxNjspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fW4ubGVuZ3RoPWMsbi5oZWFkJiYobi5oZWFkLmV4dHJhX2xlbj1jKSw1MTImbi5mbGFncyYmKFNbMF09MjU1JmMsU1sxXT1jPj4+OCYyNTUsbi5jaGVjaz1ndShuLmNoZWNrLFMsMiwwKSksYz0wLGw9MH1lbHNlIG4uaGVhZCYmKG4uaGVhZC5leHRyYT1udWxsKTtuLm1vZGU9NjtjYXNlIDY6aWYoMTAyNCZuLmZsYWdzJiYoKGc9bi5sZW5ndGgpPnImJihnPXIpLGcmJihuLmhlYWQmJihDPW4uaGVhZC5leHRyYV9sZW4tbi5sZW5ndGgsbi5oZWFkLmV4dHJhfHwobi5oZWFkLmV4dHJhPW5ldyBBcnJheShuLmhlYWQuZXh0cmFfbGVuKSksbHUuYXJyYXlTZXQobi5oZWFkLmV4dHJhLG8sYSxnLEMpKSw1MTImbi5mbGFncyYmKG4uY2hlY2s9Z3Uobi5jaGVjayxvLGcsYSkpLHItPWcsYSs9ZyxuLmxlbmd0aC09Zyksbi5sZW5ndGgpKWJyZWFrIGU7bi5sZW5ndGg9MCxuLm1vZGU9NztjYXNlIDc6aWYoMjA0OCZuLmZsYWdzKXtpZigwPT09cilicmVhayBlO2c9MDtkb3tDPW9bYStnKytdLG4uaGVhZCYmQyYmbi5sZW5ndGg8NjU1MzYmJihuLmhlYWQubmFtZSs9U3RyaW5nLmZyb21DaGFyQ29kZShDKSl9d2hpbGUoQyYmZzxyKTtpZig1MTImbi5mbGFncyYmKG4uY2hlY2s9Z3Uobi5jaGVjayxvLGcsYSkpLHItPWcsYSs9ZyxDKWJyZWFrIGV9ZWxzZSBuLmhlYWQmJihuLmhlYWQubmFtZT1udWxsKTtuLmxlbmd0aD0wLG4ubW9kZT04O2Nhc2UgODppZig0MDk2Jm4uZmxhZ3Mpe2lmKDA9PT1yKWJyZWFrIGU7Zz0wO2Rve0M9b1thK2crK10sbi5oZWFkJiZDJiZuLmxlbmd0aDw2NTUzNiYmKG4uaGVhZC5jb21tZW50Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKEMpKX13aGlsZShDJiZnPHIpO2lmKDUxMiZuLmZsYWdzJiYobi5jaGVjaz1ndShuLmNoZWNrLG8sZyxhKSksci09ZyxhKz1nLEMpYnJlYWsgZX1lbHNlIG4uaGVhZCYmKG4uaGVhZC5jb21tZW50PW51bGwpO24ubW9kZT05O2Nhc2UgOTppZig1MTImbi5mbGFncyl7Zm9yKDtsPDE2Oyl7aWYoMD09PXIpYnJlYWsgZTtyLS0sYys9b1thKytdPDxsLGwrPTh9aWYoYyE9PSg2NTUzNSZuLmNoZWNrKSl7ZS5tc2c9XCJoZWFkZXIgY3JjIG1pc21hdGNoXCIsbi5tb2RlPTMwO2JyZWFrfWM9MCxsPTB9bi5oZWFkJiYobi5oZWFkLmhjcmM9bi5mbGFncz4+OSYxLG4uaGVhZC5kb25lPSEwKSxlLmFkbGVyPW4uY2hlY2s9MCxuLm1vZGU9MTI7YnJlYWs7Y2FzZSAxMDpmb3IoO2w8MzI7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1lLmFkbGVyPW4uY2hlY2s9eXUoYyksYz0wLGw9MCxuLm1vZGU9MTE7Y2FzZSAxMTppZigwPT09bi5oYXZlZGljdClyZXR1cm4gZS5uZXh0X291dD1pLGUuYXZhaWxfb3V0PXUsZS5uZXh0X2luPWEsZS5hdmFpbF9pbj1yLG4uaG9sZD1jLG4uYml0cz1sLDI7ZS5hZGxlcj1uLmNoZWNrPTEsbi5tb2RlPTEyO2Nhc2UgMTI6aWYoNT09PXR8fDY9PT10KWJyZWFrIGU7Y2FzZSAxMzppZihuLmxhc3Qpe2M+Pj49NyZsLGwtPTcmbCxuLm1vZGU9Mjc7YnJlYWt9Zm9yKDtsPDM7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1zd2l0Y2gobi5sYXN0PTEmYyxsLT0xLDMmKGM+Pj49MSkpe2Nhc2UgMDpuLm1vZGU9MTQ7YnJlYWs7Y2FzZSAxOmlmKEF1KG4pLG4ubW9kZT0yMCw2PT09dCl7Yz4+Pj0yLGwtPTI7YnJlYWsgZX1icmVhaztjYXNlIDI6bi5tb2RlPTE3O2JyZWFrO2Nhc2UgMzplLm1zZz1cImludmFsaWQgYmxvY2sgdHlwZVwiLG4ubW9kZT0zMH1jPj4+PTIsbC09MjticmVhaztjYXNlIDE0OmZvcihjPj4+PTcmbCxsLT03Jmw7bDwzMjspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fWlmKCg2NTUzNSZjKSE9KGM+Pj4xNl42NTUzNSkpe2UubXNnPVwiaW52YWxpZCBzdG9yZWQgYmxvY2sgbGVuZ3Roc1wiLG4ubW9kZT0zMDticmVha31pZihuLmxlbmd0aD02NTUzNSZjLGM9MCxsPTAsbi5tb2RlPTE1LDY9PT10KWJyZWFrIGU7Y2FzZSAxNTpuLm1vZGU9MTY7Y2FzZSAxNjppZihnPW4ubGVuZ3RoKXtpZihnPnImJihnPXIpLGc+dSYmKGc9dSksMD09PWcpYnJlYWsgZTtsdS5hcnJheVNldChzLG8sYSxnLGkpLHItPWcsYSs9Zyx1LT1nLGkrPWcsbi5sZW5ndGgtPWc7YnJlYWt9bi5tb2RlPTEyO2JyZWFrO2Nhc2UgMTc6Zm9yKDtsPDE0Oyl7aWYoMD09PXIpYnJlYWsgZTtyLS0sYys9b1thKytdPDxsLGwrPTh9aWYobi5ubGVuPTI1NysoMzEmYyksYz4+Pj01LGwtPTUsbi5uZGlzdD0xKygzMSZjKSxjPj4+PTUsbC09NSxuLm5jb2RlPTQrKDE1JmMpLGM+Pj49NCxsLT00LG4ubmxlbj4yODZ8fG4ubmRpc3Q+MzApe2UubXNnPVwidG9vIG1hbnkgbGVuZ3RoIG9yIGRpc3RhbmNlIHN5bWJvbHNcIixuLm1vZGU9MzA7YnJlYWt9bi5oYXZlPTAsbi5tb2RlPTE4O2Nhc2UgMTg6Zm9yKDtuLmhhdmU8bi5uY29kZTspe2Zvcig7bDwzOyl7aWYoMD09PXIpYnJlYWsgZTtyLS0sYys9b1thKytdPDxsLGwrPTh9bi5sZW5zW0xbbi5oYXZlKytdXT03JmMsYz4+Pj0zLGwtPTN9Zm9yKDtuLmhhdmU8MTk7KW4ubGVuc1tMW24uaGF2ZSsrXV09MDtpZihuLmxlbmNvZGU9bi5sZW5keW4sbi5sZW5iaXRzPTcsRD17Yml0czpuLmxlbmJpdHN9LFQ9TXUoMCxuLmxlbnMsMCwxOSxuLmxlbmNvZGUsMCxuLndvcmssRCksbi5sZW5iaXRzPUQuYml0cyxUKXtlLm1zZz1cImludmFsaWQgY29kZSBsZW5ndGhzIHNldFwiLG4ubW9kZT0zMDticmVha31uLmhhdmU9MCxuLm1vZGU9MTk7Y2FzZSAxOTpmb3IoO24uaGF2ZTxuLm5sZW4rbi5uZGlzdDspe2Zvcig7dj0oRT1uLmxlbmNvZGVbYyYoMTw8bi5sZW5iaXRzKS0xXSk+Pj4xNiYyNTUsbT02NTUzNSZFLCEoKGY9RT4+PjI0KTw9bCk7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1pZihtPDE2KWM+Pj49ZixsLT1mLG4ubGVuc1tuLmhhdmUrK109bTtlbHNle2lmKDE2PT09bSl7Zm9yKGs9ZisyO2w8azspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fWlmKGM+Pj49ZixsLT1mLDA9PT1uLmhhdmUpe2UubXNnPVwiaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdFwiLG4ubW9kZT0zMDticmVha31DPW4ubGVuc1tuLmhhdmUtMV0sZz0zKygzJmMpLGM+Pj49MixsLT0yfWVsc2UgaWYoMTc9PT1tKXtmb3Ioaz1mKzM7bDxrOyl7aWYoMD09PXIpYnJlYWsgZTtyLS0sYys9b1thKytdPDxsLGwrPTh9bC09ZixDPTAsZz0zKyg3JihjPj4+PWYpKSxjPj4+PTMsbC09M31lbHNle2ZvcihrPWYrNztsPGs7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1sLT1mLEM9MCxnPTExKygxMjcmKGM+Pj49ZikpLGM+Pj49NyxsLT03fWlmKG4uaGF2ZStnPm4ubmxlbituLm5kaXN0KXtlLm1zZz1cImludmFsaWQgYml0IGxlbmd0aCByZXBlYXRcIixuLm1vZGU9MzA7YnJlYWt9Zm9yKDtnLS07KW4ubGVuc1tuLmhhdmUrK109Q319aWYoMzA9PT1uLm1vZGUpYnJlYWs7aWYoMD09PW4ubGVuc1syNTZdKXtlLm1zZz1cImludmFsaWQgY29kZSAtLSBtaXNzaW5nIGVuZC1vZi1ibG9ja1wiLG4ubW9kZT0zMDticmVha31pZihuLmxlbmJpdHM9OSxEPXtiaXRzOm4ubGVuYml0c30sVD1NdSgxLG4ubGVucywwLG4ubmxlbixuLmxlbmNvZGUsMCxuLndvcmssRCksbi5sZW5iaXRzPUQuYml0cyxUKXtlLm1zZz1cImludmFsaWQgbGl0ZXJhbC9sZW5ndGhzIHNldFwiLG4ubW9kZT0zMDticmVha31pZihuLmRpc3RiaXRzPTYsbi5kaXN0Y29kZT1uLmRpc3RkeW4sRD17Yml0czpuLmRpc3RiaXRzfSxUPU11KDIsbi5sZW5zLG4ubmxlbixuLm5kaXN0LG4uZGlzdGNvZGUsMCxuLndvcmssRCksbi5kaXN0Yml0cz1ELmJpdHMsVCl7ZS5tc2c9XCJpbnZhbGlkIGRpc3RhbmNlcyBzZXRcIixuLm1vZGU9MzA7YnJlYWt9aWYobi5tb2RlPTIwLDY9PT10KWJyZWFrIGU7Y2FzZSAyMDpuLm1vZGU9MjE7Y2FzZSAyMTppZihyPj02JiZ1Pj0yNTgpe2UubmV4dF9vdXQ9aSxlLmF2YWlsX291dD11LGUubmV4dF9pbj1hLGUuYXZhaWxfaW49cixuLmhvbGQ9YyxuLmJpdHM9bCxodShlLHApLGk9ZS5uZXh0X291dCxzPWUub3V0cHV0LHU9ZS5hdmFpbF9vdXQsYT1lLm5leHRfaW4sbz1lLmlucHV0LHI9ZS5hdmFpbF9pbixjPW4uaG9sZCxsPW4uYml0cywxMj09PW4ubW9kZSYmKG4uYmFjaz0tMSk7YnJlYWt9Zm9yKG4uYmFjaz0wO3Y9KEU9bi5sZW5jb2RlW2MmKDE8PG4ubGVuYml0cyktMV0pPj4+MTYmMjU1LG09NjU1MzUmRSwhKChmPUU+Pj4yNCk8PWwpOyl7aWYoMD09PXIpYnJlYWsgZTtyLS0sYys9b1thKytdPDxsLGwrPTh9aWYodiYmMD09KDI0MCZ2KSl7Zm9yKE09Zix5PXYsST1tO3Y9KEU9bi5sZW5jb2RlW0krKChjJigxPDxNK3kpLTEpPj5NKV0pPj4+MTYmMjU1LG09NjU1MzUmRSwhKE0rKGY9RT4+PjI0KTw9bCk7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1jPj4+PU0sbC09TSxuLmJhY2srPU19aWYoYz4+Pj1mLGwtPWYsbi5iYWNrKz1mLG4ubGVuZ3RoPW0sMD09PXYpe24ubW9kZT0yNjticmVha31pZigzMiZ2KXtuLmJhY2s9LTEsbi5tb2RlPTEyO2JyZWFrfWlmKDY0JnYpe2UubXNnPVwiaW52YWxpZCBsaXRlcmFsL2xlbmd0aCBjb2RlXCIsbi5tb2RlPTMwO2JyZWFrfW4uZXh0cmE9MTUmdixuLm1vZGU9MjI7Y2FzZSAyMjppZihuLmV4dHJhKXtmb3Ioaz1uLmV4dHJhO2w8azspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGMrPW9bYSsrXTw8bCxsKz04fW4ubGVuZ3RoKz1jJigxPDxuLmV4dHJhKS0xLGM+Pj49bi5leHRyYSxsLT1uLmV4dHJhLG4uYmFjays9bi5leHRyYX1uLndhcz1uLmxlbmd0aCxuLm1vZGU9MjM7Y2FzZSAyMzpmb3IoO3Y9KEU9bi5kaXN0Y29kZVtjJigxPDxuLmRpc3RiaXRzKS0xXSk+Pj4xNiYyNTUsbT02NTUzNSZFLCEoKGY9RT4+PjI0KTw9bCk7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1pZigwPT0oMjQwJnYpKXtmb3IoTT1mLHk9dixJPW07dj0oRT1uLmRpc3Rjb2RlW0krKChjJigxPDxNK3kpLTEpPj5NKV0pPj4+MTYmMjU1LG09NjU1MzUmRSwhKE0rKGY9RT4+PjI0KTw9bCk7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1jPj4+PU0sbC09TSxuLmJhY2srPU19aWYoYz4+Pj1mLGwtPWYsbi5iYWNrKz1mLDY0JnYpe2UubXNnPVwiaW52YWxpZCBkaXN0YW5jZSBjb2RlXCIsbi5tb2RlPTMwO2JyZWFrfW4ub2Zmc2V0PW0sbi5leHRyYT0xNSZ2LG4ubW9kZT0yNDtjYXNlIDI0OmlmKG4uZXh0cmEpe2ZvcihrPW4uZXh0cmE7bDxrOyl7aWYoMD09PXIpYnJlYWsgZTtyLS0sYys9b1thKytdPDxsLGwrPTh9bi5vZmZzZXQrPWMmKDE8PG4uZXh0cmEpLTEsYz4+Pj1uLmV4dHJhLGwtPW4uZXh0cmEsbi5iYWNrKz1uLmV4dHJhfWlmKG4ub2Zmc2V0Pm4uZG1heCl7ZS5tc2c9XCJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFja1wiLG4ubW9kZT0zMDticmVha31uLm1vZGU9MjU7Y2FzZSAyNTppZigwPT09dSlicmVhayBlO2lmKGc9cC11LG4ub2Zmc2V0Pmcpe2lmKChnPW4ub2Zmc2V0LWcpPm4ud2hhdmUmJm4uc2FuZSl7ZS5tc2c9XCJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFja1wiLG4ubW9kZT0zMDticmVha31nPm4ud25leHQ/KGctPW4ud25leHQsaD1uLndzaXplLWcpOmg9bi53bmV4dC1nLGc+bi5sZW5ndGgmJihnPW4ubGVuZ3RoKSxfPW4ud2luZG93fWVsc2UgXz1zLGg9aS1uLm9mZnNldCxnPW4ubGVuZ3RoO2c+dSYmKGc9dSksdS09ZyxuLmxlbmd0aC09Zztkb3tzW2krK109X1toKytdfXdoaWxlKC0tZyk7MD09PW4ubGVuZ3RoJiYobi5tb2RlPTIxKTticmVhaztjYXNlIDI2OmlmKDA9PT11KWJyZWFrIGU7c1tpKytdPW4ubGVuZ3RoLHUtLSxuLm1vZGU9MjE7YnJlYWs7Y2FzZSAyNzppZihuLndyYXApe2Zvcig7bDwzMjspe2lmKDA9PT1yKWJyZWFrIGU7ci0tLGN8PW9bYSsrXTw8bCxsKz04fWlmKHAtPXUsZS50b3RhbF9vdXQrPXAsbi50b3RhbCs9cCxwJiYoZS5hZGxlcj1uLmNoZWNrPW4uZmxhZ3M/Z3Uobi5jaGVjayxzLHAsaS1wKTpkdShuLmNoZWNrLHMscCxpLXApKSxwPXUsKG4uZmxhZ3M/Yzp5dShjKSkhPT1uLmNoZWNrKXtlLm1zZz1cImluY29ycmVjdCBkYXRhIGNoZWNrXCIsbi5tb2RlPTMwO2JyZWFrfWM9MCxsPTB9bi5tb2RlPTI4O2Nhc2UgMjg6aWYobi53cmFwJiZuLmZsYWdzKXtmb3IoO2w8MzI7KXtpZigwPT09cilicmVhayBlO3ItLSxjKz1vW2ErK108PGwsbCs9OH1pZihjIT09KDQyOTQ5NjcyOTUmbi50b3RhbCkpe2UubXNnPVwiaW5jb3JyZWN0IGxlbmd0aCBjaGVja1wiLG4ubW9kZT0zMDticmVha31jPTAsbD0wfW4ubW9kZT0yOTtjYXNlIDI5OlQ9MTticmVhayBlO2Nhc2UgMzA6VD0tMzticmVhayBlO2Nhc2UgMzE6cmV0dXJuLTQ7Y2FzZSAzMjpkZWZhdWx0OnJldHVybi0yfXJldHVybiBlLm5leHRfb3V0PWksZS5hdmFpbF9vdXQ9dSxlLm5leHRfaW49YSxlLmF2YWlsX2luPXIsbi5ob2xkPWMsbi5iaXRzPWwsKG4ud3NpemV8fHAhPT1lLmF2YWlsX291dCYmbi5tb2RlPDMwJiYobi5tb2RlPDI3fHw0IT09dCkpJiZSdShlLGUub3V0cHV0LGUubmV4dF9vdXQscC1lLmF2YWlsX291dCksZC09ZS5hdmFpbF9pbixwLT1lLmF2YWlsX291dCxlLnRvdGFsX2luKz1kLGUudG90YWxfb3V0Kz1wLG4udG90YWwrPXAsbi53cmFwJiZwJiYoZS5hZGxlcj1uLmNoZWNrPW4uZmxhZ3M/Z3Uobi5jaGVjayxzLHAsZS5uZXh0X291dC1wKTpkdShuLmNoZWNrLHMscCxlLm5leHRfb3V0LXApKSxlLmRhdGFfdHlwZT1uLmJpdHMrKG4ubGFzdD82NDowKSsoMTI9PT1uLm1vZGU/MTI4OjApKygyMD09PW4ubW9kZXx8MTU9PT1uLm1vZGU/MjU2OjApLCgwPT09ZCYmMD09PXB8fDQ9PT10KSYmMD09PVQmJihUPS01KSxUfSxpbmZsYXRlRW5kOmZ1bmN0aW9uKGUpe2lmKCFlfHwhZS5zdGF0ZSlyZXR1cm4tMjt2YXIgdD1lLnN0YXRlO3JldHVybiB0LndpbmRvdyYmKHQud2luZG93PW51bGwpLGUuc3RhdGU9bnVsbCwwfSxpbmZsYXRlR2V0SGVhZGVyOmZ1bmN0aW9uKGUsdCl7dmFyIG47cmV0dXJuIGUmJmUuc3RhdGU/MD09KDImKG49ZS5zdGF0ZSkud3JhcCk/LTI6KG4uaGVhZD10LHQuZG9uZT0hMSwwKTotMn0saW5mbGF0ZVNldERpY3Rpb25hcnk6ZnVuY3Rpb24oZSx0KXt2YXIgbixvPXQubGVuZ3RoO3JldHVybiBlJiZlLnN0YXRlPzAhPT0obj1lLnN0YXRlKS53cmFwJiYxMSE9PW4ubW9kZT8tMjoxMT09PW4ubW9kZSYmZHUoMSx0LG8sMCkhPT1uLmNoZWNrPy0zOlJ1KGUsdCxvLG8pPyhuLm1vZGU9MzEsLTQpOihuLmhhdmVkaWN0PTEsMCk6LTJ9LGluZmxhdGVJbmZvOlwicGFrbyBpbmZsYXRlIChmcm9tIE5vZGVjYSBwcm9qZWN0KVwifSxPdT0hMCxHdT0hMDt0cnl7U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLFswXSl9Y2F0Y2goYWMpe091PSExfXRyeXtTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoMSkpfWNhdGNoKGFjKXtHdT0hMX1mb3IodmFyIFV1PW5ldyBsdS5CdWY4KDI1NiksUHU9MDtQdTwyNTY7UHUrKylVdVtQdV09UHU+PTI1Mj82OlB1Pj0yNDg/NTpQdT49MjQwPzQ6UHU+PTIyND8zOlB1Pj0xOTI/MjoxO1V1WzI1NF09VXVbMjU0XT0xO2Z1bmN0aW9uIGJ1KGUsdCl7aWYodDw2NTUzNCYmKGUuc3ViYXJyYXkmJkd1fHwhZS5zdWJhcnJheSYmT3UpKXJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbHUuc2hyaW5rQnVmKGUsdCkpO2Zvcih2YXIgbj1cIlwiLG89MDtvPHQ7bysrKW4rPVN0cmluZy5mcm9tQ2hhckNvZGUoZVtvXSk7cmV0dXJuIG59dmFyIHd1PWZ1bmN0aW9uKGUpe3ZhciB0LG4sbyxzLGEsaT1lLmxlbmd0aCxyPTA7Zm9yKHM9MDtzPGk7cysrKTU1Mjk2PT0oNjQ1MTImKG49ZS5jaGFyQ29kZUF0KHMpKSkmJnMrMTxpJiY1NjMyMD09KDY0NTEyJihvPWUuY2hhckNvZGVBdChzKzEpKSkmJihuPTY1NTM2KyhuLTU1Mjk2PDwxMCkrKG8tNTYzMjApLHMrKykscis9bjwxMjg/MTpuPDIwNDg/MjpuPDY1NTM2PzM6NDtmb3IodD1uZXcgbHUuQnVmOChyKSxhPTAscz0wO2E8cjtzKyspNTUyOTY9PSg2NDUxMiYobj1lLmNoYXJDb2RlQXQocykpKSYmcysxPGkmJjU2MzIwPT0oNjQ1MTImKG89ZS5jaGFyQ29kZUF0KHMrMSkpKSYmKG49NjU1MzYrKG4tNTUyOTY8PDEwKSsoby01NjMyMCkscysrKSxuPDEyOD90W2ErK109bjpuPDIwNDg/KHRbYSsrXT0xOTJ8bj4+PjYsdFthKytdPTEyOHw2MyZuKTpuPDY1NTM2Pyh0W2ErK109MjI0fG4+Pj4xMix0W2ErK109MTI4fG4+Pj42JjYzLHRbYSsrXT0xMjh8NjMmbik6KHRbYSsrXT0yNDB8bj4+PjE4LHRbYSsrXT0xMjh8bj4+PjEyJjYzLHRbYSsrXT0xMjh8bj4+PjYmNjMsdFthKytdPTEyOHw2MyZuKTtyZXR1cm4gdH0sRnU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PW5ldyBsdS5CdWY4KGUubGVuZ3RoKSxuPTAsbz10Lmxlbmd0aDtuPG87bisrKXRbbl09ZS5jaGFyQ29kZUF0KG4pO3JldHVybiB0fSxxdT1mdW5jdGlvbihlLHQpe3ZhciBuLG8scyxhLGk9dHx8ZS5sZW5ndGgscj1uZXcgQXJyYXkoMippKTtmb3Iobz0wLG49MDtuPGk7KWlmKChzPWVbbisrXSk8MTI4KXJbbysrXT1zO2Vsc2UgaWYoKGE9VXVbc10pPjQpcltvKytdPTY1NTMzLG4rPWEtMTtlbHNle2ZvcihzJj0yPT09YT8zMTozPT09YT8xNTo3O2E+MSYmbjxpOylzPXM8PDZ8NjMmZVtuKytdLGEtLTthPjE/cltvKytdPTY1NTMzOnM8NjU1MzY/cltvKytdPXM6KHMtPTY1NTM2LHJbbysrXT01NTI5NnxzPj4xMCYxMDIzLHJbbysrXT01NjMyMHwxMDIzJnMpfXJldHVybiBidShyLG8pfSx4dT1mdW5jdGlvbihlLHQpe3ZhciBuO2ZvcigodD10fHxlLmxlbmd0aCk+ZS5sZW5ndGgmJih0PWUubGVuZ3RoKSxuPXQtMTtuPj0wJiYxMjg9PSgxOTImZVtuXSk7KW4tLTtyZXR1cm4gbjwwfHwwPT09bj90Om4rVXVbZVtuXV0+dD9uOnR9LFZ1PXtaX05PX0ZMVVNIOjAsWl9QQVJUSUFMX0ZMVVNIOjEsWl9TWU5DX0ZMVVNIOjIsWl9GVUxMX0ZMVVNIOjMsWl9GSU5JU0g6NCxaX0JMT0NLOjUsWl9UUkVFUzo2LFpfT0s6MCxaX1NUUkVBTV9FTkQ6MSxaX05FRURfRElDVDoyLFpfRVJSTk86LTEsWl9TVFJFQU1fRVJST1I6LTIsWl9EQVRBX0VSUk9SOi0zLFpfQlVGX0VSUk9SOi01LFpfTk9fQ09NUFJFU1NJT046MCxaX0JFU1RfU1BFRUQ6MSxaX0JFU1RfQ09NUFJFU1NJT046OSxaX0RFRkFVTFRfQ09NUFJFU1NJT046LTEsWl9GSUxURVJFRDoxLFpfSFVGRk1BTl9PTkxZOjIsWl9STEU6MyxaX0ZJWEVEOjQsWl9ERUZBVUxUX1NUUkFURUdZOjAsWl9CSU5BUlk6MCxaX1RFWFQ6MSxaX1VOS05PV046MixaX0RFRkxBVEVEOjh9LEJ1PXsyOlwibmVlZCBkaWN0aW9uYXJ5XCIsMTpcInN0cmVhbSBlbmRcIiwwOlwiXCIsXCItMVwiOlwiZmlsZSBlcnJvclwiLFwiLTJcIjpcInN0cmVhbSBlcnJvclwiLFwiLTNcIjpcImRhdGEgZXJyb3JcIixcIi00XCI6XCJpbnN1ZmZpY2llbnQgbWVtb3J5XCIsXCItNVwiOlwiYnVmZmVyIGVycm9yXCIsXCItNlwiOlwiaW5jb21wYXRpYmxlIHZlcnNpb25cIn07dmFyIEh1PWZ1bmN0aW9uKCl7dGhpcy5pbnB1dD1udWxsLHRoaXMubmV4dF9pbj0wLHRoaXMuYXZhaWxfaW49MCx0aGlzLnRvdGFsX2luPTAsdGhpcy5vdXRwdXQ9bnVsbCx0aGlzLm5leHRfb3V0PTAsdGhpcy5hdmFpbF9vdXQ9MCx0aGlzLnRvdGFsX291dD0wLHRoaXMubXNnPVwiXCIsdGhpcy5zdGF0ZT1udWxsLHRoaXMuZGF0YV90eXBlPTIsdGhpcy5hZGxlcj0wfTt2YXIgS3U9ZnVuY3Rpb24oKXt0aGlzLnRleHQ9MCx0aGlzLnRpbWU9MCx0aGlzLnhmbGFncz0wLHRoaXMub3M9MCx0aGlzLmV4dHJhPW51bGwsdGhpcy5leHRyYV9sZW49MCx0aGlzLm5hbWU9XCJcIix0aGlzLmNvbW1lbnQ9XCJcIix0aGlzLmhjcmM9MCx0aGlzLmRvbmU9ITF9LFd1PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7ZnVuY3Rpb24gWXUoZSl7aWYoISh0aGlzIGluc3RhbmNlb2YgWXUpKXJldHVybiBuZXcgWXUoZSk7dGhpcy5vcHRpb25zPWx1LmFzc2lnbih7Y2h1bmtTaXplOjE2Mzg0LHdpbmRvd0JpdHM6MCx0bzpcIlwifSxlfHx7fSk7dmFyIHQ9dGhpcy5vcHRpb25zO3QucmF3JiZ0LndpbmRvd0JpdHM+PTAmJnQud2luZG93Qml0czwxNiYmKHQud2luZG93Qml0cz0tdC53aW5kb3dCaXRzLDA9PT10LndpbmRvd0JpdHMmJih0LndpbmRvd0JpdHM9LTE1KSksISh0LndpbmRvd0JpdHM+PTAmJnQud2luZG93Qml0czwxNil8fGUmJmUud2luZG93Qml0c3x8KHQud2luZG93Qml0cys9MzIpLHQud2luZG93Qml0cz4xNSYmdC53aW5kb3dCaXRzPDQ4JiYwPT0oMTUmdC53aW5kb3dCaXRzKSYmKHQud2luZG93Qml0c3w9MTUpLHRoaXMuZXJyPTAsdGhpcy5tc2c9XCJcIix0aGlzLmVuZGVkPSExLHRoaXMuY2h1bmtzPVtdLHRoaXMuc3RybT1uZXcgSHUsdGhpcy5zdHJtLmF2YWlsX291dD0wO3ZhciBuPU51LmluZmxhdGVJbml0Mih0aGlzLnN0cm0sdC53aW5kb3dCaXRzKTtpZihuIT09VnUuWl9PSyl0aHJvdyBuZXcgRXJyb3IoQnVbbl0pO2lmKHRoaXMuaGVhZGVyPW5ldyBLdSxOdS5pbmZsYXRlR2V0SGVhZGVyKHRoaXMuc3RybSx0aGlzLmhlYWRlciksdC5kaWN0aW9uYXJ5JiYoXCJzdHJpbmdcIj09dHlwZW9mIHQuZGljdGlvbmFyeT90LmRpY3Rpb25hcnk9d3UodC5kaWN0aW9uYXJ5KTpcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT1XdS5jYWxsKHQuZGljdGlvbmFyeSkmJih0LmRpY3Rpb25hcnk9bmV3IFVpbnQ4QXJyYXkodC5kaWN0aW9uYXJ5KSksdC5yYXcmJihuPU51LmluZmxhdGVTZXREaWN0aW9uYXJ5KHRoaXMuc3RybSx0LmRpY3Rpb25hcnkpKSE9PVZ1LlpfT0spKXRocm93IG5ldyBFcnJvcihCdVtuXSl9ZnVuY3Rpb24ganUoZSx0KXt2YXIgbj1uZXcgWXUodCk7aWYobi5wdXNoKGUsITApLG4uZXJyKXRocm93IG4ubXNnfHxCdVtuLmVycl07cmV0dXJuIG4ucmVzdWx0fVl1LnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGUsdCl7dmFyIG4sbyxzLGEsaSxyPXRoaXMuc3RybSx1PXRoaXMub3B0aW9ucy5jaHVua1NpemUsYz10aGlzLm9wdGlvbnMuZGljdGlvbmFyeSxsPSExO2lmKHRoaXMuZW5kZWQpcmV0dXJuITE7bz10PT09fn50P3Q6ITA9PT10P1Z1LlpfRklOSVNIOlZ1LlpfTk9fRkxVU0gsXCJzdHJpbmdcIj09dHlwZW9mIGU/ci5pbnB1dD1GdShlKTpcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT1XdS5jYWxsKGUpP3IuaW5wdXQ9bmV3IFVpbnQ4QXJyYXkoZSk6ci5pbnB1dD1lLHIubmV4dF9pbj0wLHIuYXZhaWxfaW49ci5pbnB1dC5sZW5ndGg7ZG97aWYoMD09PXIuYXZhaWxfb3V0JiYoci5vdXRwdXQ9bmV3IGx1LkJ1ZjgodSksci5uZXh0X291dD0wLHIuYXZhaWxfb3V0PXUpLChuPU51LmluZmxhdGUocixWdS5aX05PX0ZMVVNIKSk9PT1WdS5aX05FRURfRElDVCYmYyYmKG49TnUuaW5mbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLGMpKSxuPT09VnUuWl9CVUZfRVJST1ImJiEwPT09bCYmKG49VnUuWl9PSyxsPSExKSxuIT09VnUuWl9TVFJFQU1fRU5EJiZuIT09VnUuWl9PSylyZXR1cm4gdGhpcy5vbkVuZChuKSx0aGlzLmVuZGVkPSEwLCExO3IubmV4dF9vdXQmJigwIT09ci5hdmFpbF9vdXQmJm4hPT1WdS5aX1NUUkVBTV9FTkQmJigwIT09ci5hdmFpbF9pbnx8byE9PVZ1LlpfRklOSVNIJiZvIT09VnUuWl9TWU5DX0ZMVVNIKXx8KFwic3RyaW5nXCI9PT10aGlzLm9wdGlvbnMudG8/KHM9eHUoci5vdXRwdXQsci5uZXh0X291dCksYT1yLm5leHRfb3V0LXMsaT1xdShyLm91dHB1dCxzKSxyLm5leHRfb3V0PWEsci5hdmFpbF9vdXQ9dS1hLGEmJmx1LmFycmF5U2V0KHIub3V0cHV0LHIub3V0cHV0LHMsYSwwKSx0aGlzLm9uRGF0YShpKSk6dGhpcy5vbkRhdGEobHUuc2hyaW5rQnVmKHIub3V0cHV0LHIubmV4dF9vdXQpKSkpLDA9PT1yLmF2YWlsX2luJiYwPT09ci5hdmFpbF9vdXQmJihsPSEwKX13aGlsZSgoci5hdmFpbF9pbj4wfHwwPT09ci5hdmFpbF9vdXQpJiZuIT09VnUuWl9TVFJFQU1fRU5EKTtyZXR1cm4gbj09PVZ1LlpfU1RSRUFNX0VORCYmKG89VnUuWl9GSU5JU0gpLG89PT1WdS5aX0ZJTklTSD8obj1OdS5pbmZsYXRlRW5kKHRoaXMuc3RybSksdGhpcy5vbkVuZChuKSx0aGlzLmVuZGVkPSEwLG49PT1WdS5aX09LKTpvIT09VnUuWl9TWU5DX0ZMVVNIfHwodGhpcy5vbkVuZChWdS5aX09LKSxyLmF2YWlsX291dD0wLCEwKX0sWXUucHJvdG90eXBlLm9uRGF0YT1mdW5jdGlvbihlKXt0aGlzLmNodW5rcy5wdXNoKGUpfSxZdS5wcm90b3R5cGUub25FbmQ9ZnVuY3Rpb24oZSl7ZT09PVZ1LlpfT0smJihcInN0cmluZ1wiPT09dGhpcy5vcHRpb25zLnRvP3RoaXMucmVzdWx0PXRoaXMuY2h1bmtzLmpvaW4oXCJcIik6dGhpcy5yZXN1bHQ9bHUuZmxhdHRlbkNodW5rcyh0aGlzLmNodW5rcykpLHRoaXMuY2h1bmtzPVtdLHRoaXMuZXJyPWUsdGhpcy5tc2c9dGhpcy5zdHJtLm1zZ307dmFyIHp1PXtJbmZsYXRlOll1LGluZmxhdGU6anUsaW5mbGF0ZVJhdzpmdW5jdGlvbihlLHQpe3JldHVybih0PXR8fHt9KS5yYXc9ITAsanUoZSx0KX0sdW5nemlwOmp1fSxKdT17fTsoMCxsdS5hc3NpZ24pKEp1LHp1LFZ1KTt2YXIgWHU9SnUsWnU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9tPXQsdGhpcy5fbj1cIkluZmxhdGVNb2R1bGVcIix0aGlzLl9iTG9nRm9ySW5mbGF0ZU9LPSExLHRoaXMuX2JMb2dGb3JJbmZsYXRlRXJyb3I9ITF9cmV0dXJuIGEoZSxbe2tleTpcImluZmxhdGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdCxuPW5ldyBVaW50OEFycmF5KGUpLnNsaWNlKDQpLG89RGF0ZS5ub3coKTt0cnl7dD1YdS5pbmZsYXRlKG4se3RvOlwic3RyaW5nXCJ9KSx0aGlzLl9iTG9nRm9ySW5mbGF0ZU9LfHwodGhpcy5fYkxvZ0ZvckluZmxhdGVPSz0hMCxuZXcgQWEoXCJpbmZsYXRlT0tcIikuZW5kKCkpfWNhdGNoKGkpe2lmKHRoaXMuX2JMb2dGb3JJbmZsYXRlRXJyb3IpcmV0dXJuO3JldHVybiB0aGlzLl9iTG9nRm9ySW5mbGF0ZUVycm9yPSEwLHZvaWQgbmV3IEFhKFwiaW5mbGF0ZUVycm9yXCIpLnNldE1lc3NhZ2UoaSkuZW5kKCl9dmFyIHM9bi5sZW5ndGgrNCxhPXQubGVuZ3RoO3JldHVybiBWZS5kKFwiaW5mbGF0ZSBvay4gemlwcGVkOlwiLmNvbmNhdChzLFwiIHVuemlwcGVkOlwiKS5jb25jYXQoYSkrXCIgY29tcHJlc3Npb24gcmF0aW86XCIuY29uY2F0KE1hdGgucm91bmQoMTAwKihhLXMpL2EpLFwiJSBjb3N0OlwiKS5jb25jYXQoRGF0ZS5ub3coKS1vKSksdH19LHtrZXk6XCJyZXNldFwiLHZhbHVlOmZ1bmN0aW9uKCl7VmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLnJlc2V0XCIpKSx0aGlzLl9iTG9nRm9ySW5mbGF0ZU9LPSExLHRoaXMuX2JMb2dGb3JJbmZsYXRlRXJyb3I9ITF9fV0pLGV9KCksUXU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKTt2YXIgbj1uZXcgQWEoXCJzZGtDb25zdHJ1Y3RcIik7dGhpcy5fbj1cIk1vZHVsZU1hbmFnZXJcIix0aGlzLl9pc1JlYWR5PSExLHRoaXMuX3JlYXNvbj1oYS5VU0VSX05PVF9MT0dHRURfSU4sdGhpcy5fc3RhcnRMb2dpblRzPTAsdGhpcy5fbW9kdWxlTWFwPW5ldyBNYXAsdGhpcy5faW5uZXJFbWl0dGVyPW51bGwsdGhpcy5fb3V0ZXJFbWl0dGVyPW51bGwsdGhpcy5fY2hlY2tDb3VudD0wLHRoaXMuX2NoZWNrVGltZXI9LTEsdGhpcy5fbW9kdWxlTWFwLnNldCh4bixuZXcgUWkodGhpcyx0KSksdGhpcy5fbW9kdWxlTWFwLnNldChybyxuZXcgWnUodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQodG8sbmV3IGF1KHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KFpuLG5ldyBYcih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChRbixuZXcgb3UodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoZW8sbmV3IG51KHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KEpuLG5ldyBWcih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldCh6bixuZXcgenIodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoUm4sbmV3ICRpKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KE5uLG5ldyBNcih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChPbixuZXcgeXIodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoYW8sbmV3IElyKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KEduLG5ldyBaaSh0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChVbixuZXcgUWEodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQocW4sbmV3IE1pKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KFBuLG5ldyBxaSh0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldCh3bixuZXcgVmkodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoRm4sbmV3IFdpKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KFZuLG5ldyB0cih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChpbyxuZXcgY3UodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoQm4sbmV3IHNyKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KEhuLG5ldyB1cih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChLbixuZXcgZHIodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoV24sbmV3IGdyKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KFluLG5ldyBDcih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChqbixuZXcgVHIodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQoWG4sbmV3IEpyKHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KCRuLG5ldyBacih0aGlzKSksdGhpcy5fbW9kdWxlTWFwLnNldChubyxuZXcgaXUodGhpcykpLHRoaXMuX21vZHVsZU1hcC5zZXQob28sbmV3IHJ1KHRoaXMpKSx0aGlzLl9tb2R1bGVNYXAuc2V0KHNvLG5ldyB1dSh0aGlzKSksdGhpcy5fZXZlbnRUaHJvdHRsZU1hcD1uZXcgTWFwO3ZhciBzPXQuaW5zdGFuY2VJRCxhPXQub3ZlcnNlYSxpPXQuU0RLQXBwSUQscj1cImluc3RhbmNlSUQ6XCIuY29uY2F0KHMsXCIgU0RLQXBwSUQ6XCIpLmNvbmNhdChpLFwiIGhvc3Q6XCIpLmNvbmNhdChPdCgpLFwiIG92ZXJzZWE6XCIpLmNvbmNhdChhLFwiIGluQnJvd3NlcjpcIikuY29uY2F0KGllLFwiIGluTWluaUFwcDpcIikuY29uY2F0KGFlKStcIiBjYW5JVXNlSW5mbGF0ZTpcIi5jb25jYXQodGhpcy5jYW5JVXNlSW5mbGF0ZSgpKStcIiB3b3JrZXJBdmFpbGFibGU6XCIuY29uY2F0KFNlLFwiIFVzZXJBZ2VudDpcIikuY29uY2F0KHVlKTtBYS5iaW5kRXZlbnRTdGF0TW9kdWxlKHRoaXMuX21vZHVsZU1hcC5nZXQoQm4pKSxuLnNldE1lc3NhZ2UoXCJcIi5jb25jYXQocixcIiBcIikuY29uY2F0KGZ1bmN0aW9uKCl7dmFyIGU9XCJcIjtpZihhZSl0cnl7dmFyIHQ9cmUuZ2V0U3lzdGVtSW5mb1N5bmMoKSxuPXQubW9kZWwsbz10LnZlcnNpb24scz10LnN5c3RlbSxhPXQucGxhdGZvcm0saT10LlNES1ZlcnNpb247ZT1cIm1vZGVsOlwiLmNvbmNhdChuLFwiIHZlcnNpb246XCIpLmNvbmNhdChvLFwiIHN5c3RlbTpcIikuY29uY2F0KHMsXCIgcGxhdGZvcm06XCIpLmNvbmNhdChhLFwiIFNES1ZlcnNpb246XCIpLmNvbmNhdChpKX1jYXRjaChyKXtlPVwiXCJ9cmV0dXJuIGV9KCkpKS5lbmQoKSxWZS5pKFwiU0RLIFwiLmNvbmNhdChyKSksamEucHJvdG90eXBlLl9nZXRFcnJvck1lc3NhZ2U9dGhpcy5nZXRFcnJvck1lc3NhZ2UuYmluZCh0aGlzKSx0aGlzLl9yZWFkeUxpc3Q9dm9pZCAwLHRoaXMuX3Nzb0xvZ0ZvclJlYWR5PW51bGwsdGhpcy5faW5pdFJlYWR5TGlzdCgpfXJldHVybiBhKGUsW3trZXk6XCJfc3RhcnRUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fbW9kdWxlTWFwLmdldChRbiksdD1lLmlzV29ya2VyRW5hYmxlZCgpO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5zdGFydFRpbWVyIGlzV29ya2VyRW5hYmxlZDpcIikuY29uY2F0KHQsXCIgc2VlZDpcIikuY29uY2F0KHRoaXMuX2NoZWNrVGltZXIpKSx0P2Uuc3RhcnRXb3JrZXJUaW1lcigpOnRoaXMuX3N0YXJ0TWFpblRocmVhZFRpbWVyKCl9fSx7a2V5OlwiX3N0YXJ0TWFpblRocmVhZFRpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jaGVja1RpbWVyPDAmJih0aGlzLl9jaGVja1RpbWVyPXNldEludGVydmFsKHRoaXMub25DaGVja1RpbWVyLmJpbmQodGhpcyksMWUzKSksVmUubChcIlwiLmNvbmNhdCh0aGlzLl9uLFwiLl9zdGFydE1haW5UaHJlYWRUaW1lciBzZWVkOlwiKS5jb25jYXQodGhpcy5fY2hlY2tUaW1lcikpfX0se2tleTpcInN0b3BUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fbW9kdWxlTWFwLmdldChRbiksdD1lLmlzV29ya2VyRW5hYmxlZCgpO1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5zdG9wVGltZXIgaXNXb3JrZXJFbmFibGVkOlwiKS5jb25jYXQodCxcIiBzZWVkOlwiKS5jb25jYXQodGhpcy5fY2hlY2tUaW1lcikpLHQ/ZS5zdG9wV29ya2VyVGltZXIoKTp0aGlzLl9zdG9wTWFpblRocmVhZFRpbWVyKCl9fSx7a2V5OlwiX3N0b3BNYWluVGhyZWFkVGltZXJcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5fc3RvcE1haW5UaHJlYWRUaW1lclwiKSksdGhpcy5fY2hlY2tUaW1lcj4wJiYoY2xlYXJJbnRlcnZhbCh0aGlzLl9jaGVja1RpbWVyKSx0aGlzLl9jaGVja1RpbWVyPS0xLHRoaXMuX2NoZWNrQ291bnQ9MCl9fSx7a2V5OlwiX3N0b3BNYWluVGhyZWFkU29ja2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3N0b3BNYWluVGhyZWFkU29ja2V0XCIpKTt2YXIgZT10aGlzLl9tb2R1bGVNYXAuZ2V0KEpuKTtlLnNldElzV29ya2VyRW5hYmxlZCghMCksZS5yZUNvbm5lY3QoKX19LHtrZXk6XCJfc3RhcnRNYWluVGhyZWFkU29ja2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIuX3N0YXJ0TWFpblRocmVhZFNvY2tldFwiKSk7dmFyIGU9dGhpcy5fbW9kdWxlTWFwLmdldChKbik7ZS5zZXRJc1dvcmtlckVuYWJsZWQoITEpLGUucmVDb25uZWN0KCl9fSx7a2V5Olwib25Xb3JrZXJUaW1lckVuYWJsZWRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbldvcmtlclRpbWVyRW5hYmxlZCwgZGlzYWJsZSBtYWluIHRocmVhZCB0aW1lciBhbmQgc29ja2V0XCIpKSx0aGlzLl9zdG9wTWFpblRocmVhZFRpbWVyKCksdGhpcy5fc3RvcE1haW5UaHJlYWRTb2NrZXQoKX19LHtrZXk6XCJvbldvcmtlclRpbWVyRGlzYWJsZWRcIix2YWx1ZTpmdW5jdGlvbigpe1ZlLmwoXCJcIi5jb25jYXQodGhpcy5fbixcIi5vbldvcmtlclRpbWVyRGlzYWJsZWQsIGVuYWJsZSBtYWluIHRocmVhZCB0aW1lciBhbmQgc29ja2V0XCIpKSx0aGlzLl9zdGFydE1haW5UaHJlYWRUaW1lcigpLHRoaXMuX3N0YXJ0TWFpblRocmVhZFNvY2tldCgpfX0se2tleTpcIm9uQ2hlY2tUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fY2hlY2tDb3VudCs9MTt2YXIgZSx0PUQodGhpcy5fbW9kdWxlTWFwKTt0cnl7Zm9yKHQucygpOyEoZT10Lm4oKSkuZG9uZTspe3ZhciBuPXYoZS52YWx1ZSwyKVsxXTtuLm9uQ2hlY2tUaW1lciYmbi5vbkNoZWNrVGltZXIodGhpcy5fY2hlY2tDb3VudCl9fWNhdGNoKG8pe3QuZShvKX1maW5hbGx5e3QuZigpfX19LHtrZXk6XCJfaW5pdFJlYWR5TGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9yZWFkeUxpc3Q9W3RoaXMuX21vZHVsZU1hcC5nZXQoUm4pLHRoaXMuX21vZHVsZU1hcC5nZXQocW4pXSx0aGlzLl9yZWFkeUxpc3QuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC5yZWFkeSgoZnVuY3Rpb24oKXtyZXR1cm4gZS5fb25Nb2R1bGVSZWFkeSgpfSkpfSkpfX0se2tleTpcIl9vbk1vZHVsZVJlYWR5XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT0hMDtpZih0aGlzLl9yZWFkeUxpc3QuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC5pc1JlYWR5KCl8fChlPSExKX0pKSxlJiYhdGhpcy5faXNSZWFkeSl7dGhpcy5faXNSZWFkeT0hMCx0aGlzLl9vdXRlckVtaXR0ZXIuZW1pdChrLlNES19SRUFEWSk7dmFyIHQ9RGF0ZS5ub3coKS10aGlzLl9zdGFydExvZ2luVHM7VmUudyhcIlNESyBpcyByZWFkeS4gY29zdCBcIi5jb25jYXQodCxcIiBtc1wiKSksdGhpcy5fc3RhcnRMb2dpblRzPURhdGUubm93KCk7dmFyIG49dGhpcy5fbW9kdWxlTWFwLmdldChIbikuZ2V0TmV0d29ya1R5cGUoKSxvPXRoaXMuX3Nzb0xvZ0ZvclJlYWR5LmdldFN0YXJ0VHMoKStVZTt0aGlzLl9zc29Mb2dGb3JSZWFkeS5zZXROZXR3b3JrVHlwZShuKS5zZXRNZXNzYWdlKHQpLnN0YXJ0KG8pLmVuZCgpfX19LHtrZXk6XCJsb2dpblwiLHZhbHVlOmZ1bmN0aW9uKCl7MD09PXRoaXMuX3N0YXJ0TG9naW5UcyYmKGJlKCksdGhpcy5fc3RhcnRMb2dpblRzPURhdGUubm93KCksdGhpcy5fc3RhcnRUaW1lcigpLHRoaXMuX21vZHVsZU1hcC5nZXQoSG4pLnN0YXJ0KCksdGhpcy5fc3NvTG9nRm9yUmVhZHk9bmV3IEFhKFwic2RrUmVhZHlcIiksdGhpcy5fcmVhc29uPWhhLkxPR0dJTkdfSU4pfX0se2tleTpcIm9uTG9naW5GYWlsZWRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3N0YXJ0TG9naW5Ucz0wfX0se2tleTpcImdldE91dGVyRW1pdHRlckluc3RhbmNlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09PXRoaXMuX291dGVyRW1pdHRlciYmKHRoaXMuX291dGVyRW1pdHRlcj1uZXcgbHIsSmEodGhpcy5fb3V0ZXJFbWl0dGVyKSx0aGlzLl9vdXRlckVtaXR0ZXIuX2VtaXQ9dGhpcy5fb3V0ZXJFbWl0dGVyLmVtaXQsdGhpcy5fb3V0ZXJFbWl0dGVyLmVtaXQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzO2lmKGU9PT1rLkNPTlZFUlNBVElPTl9MSVNUX1VQREFURUR8fGU9PT1rLkZSSUVORF9MSVNUX1VQREFURUR8fGU9PT1rLkdST1VQX0xJU1RfVVBEQVRFRHx8ZT09PWsuVE9UQUxfVU5SRUFEX01FU1NBR0VfQ09VTlRfVVBEQVRFRClpZih0aGlzLl9ldmVudFRocm90dGxlTWFwLmhhcyhlKSl7dmFyIG89RGF0ZS5ub3coKSxzPXRoaXMuX2V2ZW50VGhyb3R0bGVNYXAuZ2V0KGUpO28tcy5sYXN0PD0xZTM/KHMudGltZW91dElEJiZjbGVhclRpbWVvdXQocy50aW1lb3V0SUQpLHMudGltZW91dElEPXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7cy5sYXN0PURhdGUubm93KCksbi5fb3V0ZXJFbWl0dGVyLl9lbWl0LmFwcGx5KG4uX291dGVyRW1pdHRlcixbZSx7bmFtZTplLGRhdGE6bi5fZ2V0RXZlbnREYXRhKGUpfV0pfSksMWUzKSk6KHMubGFzdD1vLHRoaXMuX291dGVyRW1pdHRlci5fZW1pdC5hcHBseSh0aGlzLl9vdXRlckVtaXR0ZXIsW2Use25hbWU6ZSxkYXRhOnRoaXMuX2dldEV2ZW50RGF0YShlKX1dKSl9ZWxzZSB0aGlzLl9ldmVudFRocm90dGxlTWFwLnNldChlLHtsYXN0OkRhdGUubm93KCksdGltZW91dElEOi0xfSksdGhpcy5fb3V0ZXJFbWl0dGVyLl9lbWl0LmFwcGx5KHRoaXMuX291dGVyRW1pdHRlcixbZSx7bmFtZTplLGRhdGE6dGhpcy5fZ2V0RXZlbnREYXRhKGUpfV0pO2Vsc2UgdGhpcy5fb3V0ZXJFbWl0dGVyLl9lbWl0LmFwcGx5KHRoaXMuX291dGVyRW1pdHRlcixbZSx7bmFtZTplLGRhdGE6YXJndW1lbnRzWzFdfV0pfS5iaW5kKHRoaXMpKSx0aGlzLl9vdXRlckVtaXR0ZXJ9fSx7a2V5OlwiX2dldEV2ZW50RGF0YVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlPT09ay5DT05WRVJTQVRJT05fTElTVF9VUERBVEVEP3RoaXMuX21vZHVsZU1hcC5nZXQocW4pLmdldExvY2FsQ29udmVyc2F0aW9uTGlzdCgpOmU9PT1rLkZSSUVORF9MSVNUX1VQREFURUQ/dGhpcy5fbW9kdWxlTWFwLmdldChibikuZ2V0TG9jYWxGcmllbmRMaXN0KCExKTplPT09ay5HUk9VUF9MSVNUX1VQREFURUQ/dGhpcy5fbW9kdWxlTWFwLmdldChQbikuZ2V0TG9jYWxHcm91cExpc3QoKTplPT09ay5UT1RBTF9VTlJFQURfTUVTU0FHRV9DT1VOVF9VUERBVEVEP3RoaXMuX21vZHVsZU1hcC5nZXQocW4pLmdldFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50KCk6dm9pZCAwfX0se2tleTpcImdldElubmVyRW1pdHRlckluc3RhbmNlXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09PXRoaXMuX2lubmVyRW1pdHRlciYmKHRoaXMuX2lubmVyRW1pdHRlcj1uZXcgbHIsdGhpcy5faW5uZXJFbWl0dGVyLl9lbWl0PXRoaXMuX2lubmVyRW1pdHRlci5lbWl0LHRoaXMuX2lubmVyRW1pdHRlci5lbWl0PWZ1bmN0aW9uKGUsdCl7dmFyIG47bj1zdChhcmd1bWVudHNbMV0pJiZhcmd1bWVudHNbMV0uZGF0YT9bZSx7bmFtZTphcmd1bWVudHNbMF0sZGF0YTphcmd1bWVudHNbMV0uZGF0YX1dOltlLHtuYW1lOmFyZ3VtZW50c1swXSxkYXRhOmFyZ3VtZW50c1sxXX1dLHRoaXMuX2lubmVyRW1pdHRlci5fZW1pdC5hcHBseSh0aGlzLl9pbm5lckVtaXR0ZXIsbil9LmJpbmQodGhpcykpLHRoaXMuX2lubmVyRW1pdHRlcn19LHtrZXk6XCJoYXNNb2R1bGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbW9kdWxlTWFwLmhhcyhlKX19LHtrZXk6XCJnZXRNb2R1bGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbW9kdWxlTWFwLmdldChlKX19LHtrZXk6XCJjYW5JVXNlSW5mbGF0ZVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLl9tb2R1bGVNYXAuZ2V0KHJvKX19LHtrZXk6XCJpc1JlYWR5XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNSZWFkeX19LHtrZXk6XCJpc0ludGxcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldE1vZHVsZSh4bikuaXNJbnRsKCl9fSx7a2V5OlwiZ2V0Tm90UmVhZHlSZWFzb25cIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZWFzb259fSx7a2V5Olwic2V0Tm90UmVhZHlSZWFzb25cIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9yZWFzb249ZX19LHtrZXk6XCJnZXRFcnJvck1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMuX21vZHVsZU1hcC5nZXQoaW8pLmdldCh7a2V5OmUscmVwbGFjZW1lbnQxOnQscmVwbGFjZW1lbnQyOm4saXNJbnRsOnRoaXMuaXNJbnRsKCl9KX19LHtrZXk6XCJvdXRwdXRXYXJuaW5nXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciBvPXRoaXMuZ2V0RXJyb3JNZXNzYWdlKGUsdCxuKTtvJiZWZS53KG8pfX0se2tleTpcIm9uRXJyb3JcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1cImNvZGU6XCIuY29uY2F0KGUuY29kZSxcIiBtZXNzYWdlOlwiKS5jb25jYXQoZS5tZXNzYWdlKTtWZS53KFwiT29wcyEgXCIuY29uY2F0KHQpKSxuZXcgQWEoXCJlcnJvclwiKS5zZXRNZXNzYWdlKHQpLnNldE5ldHdvcmtUeXBlKHRoaXMuZ2V0TW9kdWxlKEhuKS5nZXROZXR3b3JrVHlwZSgpKS5zZXRMZXZlbChcImVycm9yXCIpLmVuZCgpLHRoaXMuZ2V0T3V0ZXJFbWl0dGVySW5zdGFuY2UoKS5lbWl0KGsuRVJST1IsZSl9fSx7a2V5OlwicmVzdGFydFRpbWVyXCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzdGFydFRpbWVyXCIpKSx0aGlzLnN0b3BUaW1lcigpLHRoaXMuX3N0YXJ0VGltZXIoKSx0aGlzLmdldE1vZHVsZShQbikucmVzdGFydFBvbGxpbmcoKX19LHtrZXk6XCJnZXRUaW1lcklEXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9tb2R1bGVNYXAuZ2V0KFFuKTtyZXR1cm4gZS5pc1dvcmtlckVuYWJsZWQoKT9lLmdldFRpbWVySUQoKTp0aGlzLl9jaGVja1RpbWVyfX0se2tleTpcImdldFBvbGxpbmdUaW1lcklEXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX21vZHVsZU1hcC5nZXQoUG4pLmdldFBvbGxpbmdUaW1lcklEKGUpfX0se2tleTpcInJlc2V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtWZS5sKFwiXCIuY29uY2F0KHRoaXMuX24sXCIucmVzZXRcIikpLGJlKCk7dmFyIGUsdD1EKHRoaXMuX21vZHVsZU1hcCk7dHJ5e2Zvcih0LnMoKTshKGU9dC5uKCkpLmRvbmU7KXt2YXIgbj12KGUudmFsdWUsMilbMV07bi5yZXNldCYmbi5yZXNldCgpfX1jYXRjaChpKXt0LmUoaSl9ZmluYWxseXt0LmYoKX10aGlzLl9zdGFydExvZ2luVHM9MCx0aGlzLl9pbml0UmVhZHlMaXN0KCksdGhpcy5faXNSZWFkeT0hMSx0aGlzLnN0b3BUaW1lcigpLHRoaXMuX291dGVyRW1pdHRlci5lbWl0KGsuU0RLX05PVF9SRUFEWSk7dmFyIG8scz1EKHRoaXMuX2V2ZW50VGhyb3R0bGVNYXApO3RyeXtmb3Iocy5zKCk7IShvPXMubigpKS5kb25lOyl7dmFyIGE9dihvLnZhbHVlLDIpWzFdO2EudGltZW91dElEJiZjbGVhclRpbWVvdXQoYS50aW1lb3V0SUQpfX1jYXRjaChpKXtzLmUoaSl9ZmluYWxseXtzLmYoKX10aGlzLl9ldmVudFRocm90dGxlTWFwLmNsZWFyKCl9fV0pLGV9KCksJHU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe28odGhpcyxlKSx0aGlzLl9mdW5jTWFwPW5ldyBNYXAsdGhpcy5fbT10fXJldHVybiBhKGUsW3trZXk6XCJkZWZlbnNlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06dm9pZCAwO2lmKFwic3RyaW5nXCIhPXR5cGVvZiBlKXJldHVybiBudWxsO2lmKDA9PT1lLmxlbmd0aClyZXR1cm4gbnVsbDtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiB0KXJldHVybiBudWxsO2lmKHRoaXMuX2Z1bmNNYXAuaGFzKGUpJiZ0aGlzLl9mdW5jTWFwLmdldChlKS5oYXModCkpcmV0dXJuIHRoaXMuX2Z1bmNNYXAuZ2V0KGUpLmdldCh0KTt0aGlzLl9mdW5jTWFwLmhhcyhlKXx8dGhpcy5fZnVuY01hcC5zZXQoZSxuZXcgTWFwKTt2YXIgbz1udWxsO3JldHVybiB0aGlzLl9mdW5jTWFwLmdldChlKS5oYXModCk/bz10aGlzLl9mdW5jTWFwLmdldChlKS5nZXQodCk6KG89dGhpcy5fcGFjayhlLHQsbiksdGhpcy5fZnVuY01hcC5nZXQoZSkuc2V0KHQsbykpLG99fSx7a2V5OlwiZGVmZW5zZU9uY2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTp2b2lkIDA7cmV0dXJuXCJmdW5jdGlvblwiIT10eXBlb2YgdD9udWxsOnRoaXMuX3BhY2soZSx0LG4pfX0se2tleTpcImZpbmRcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVyblwic3RyaW5nXCIhPXR5cGVvZiBlfHwwPT09ZS5sZW5ndGh8fFwiZnVuY3Rpb25cIiE9dHlwZW9mIHQ/bnVsbDp0aGlzLl9mdW5jTWFwLmhhcyhlKSYmdGhpcy5fZnVuY01hcC5nZXQoZSkuaGFzKHQpP3RoaXMuX2Z1bmNNYXAuZ2V0KGUpLmdldCh0KToodGhpcy5fbS5vdXRwdXRXYXJuaW5nKFwiTGlzdGVuZXJGbk5vdEZvdW5kXCIsZSksbnVsbCl9fSx7a2V5OlwiZGVsZXRlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYoISF0aGlzLl9mdW5jTWFwLmhhcyhlKSYmKCEhdGhpcy5fZnVuY01hcC5nZXQoZSkuaGFzKHQpJiYodGhpcy5fZnVuY01hcC5nZXQoZSkuZGVsZXRlKHQpLDA9PT10aGlzLl9mdW5jTWFwLmdldChlKS5zaXplJiZ0aGlzLl9mdW5jTWFwLmRlbGV0ZShlKSwhMCkpKX19LHtrZXk6XCJfcGFja1wiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgbz10aGlzO3JldHVybiBmdW5jdGlvbigpe3RyeXt0LmFwcGx5KG4sQXJyYXkuZnJvbShhcmd1bWVudHMpKX1jYXRjaCh1KXt2YXIgcz1PYmplY3QudmFsdWVzKGspLmluZGV4T2YoZSksYT1cIkNhbGxiYWNrRXJyb3JcIjtpZigtMSE9PXMpe3ZhciBpPU9iamVjdC5rZXlzKGspW3NdO28uX20ub3V0cHV0V2FybmluZyhhLGksdSl9dmFyIHI9bmV3IEFhKGEpO3Iuc2V0TWVzc2FnZShcImV2ZW50TmFtZTpcIi5jb25jYXQoZSkpLnNldE1vcmVNZXNzYWdlKHUubWVzc2FnZSkuZW5kKCl9fX19XSksZX0oKSxlYz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7byh0aGlzLGUpO3ZhciBuPXtTREtBcHBJRDp0LlNES0FwcElELHVubGltaXRlZEFWQ2hhdFJvb206dC51bmxpbWl0ZWRBVkNoYXRSb29tfHwhMSxzY2VuZTp0LnNjZW5lfHxcIlwiLG92ZXJzZWE6dC5vdmVyc2VhfHwhMSxpbnN0YW5jZUlEOk50KCksZGV2TW9kZTp0LmRldk1vZGV8fCExLHByb3h5U2VydmVyOnQucHJveHlTZXJ2ZXJ8fHZvaWQgMCxmaWxlVXBsb2FkUHJveHk6dC5maWxlVXBsb2FkUHJveHl8fHZvaWQgMCxmaWxlRG93bmxvYWRQcm94eTp0LmZpbGVEb3dubG9hZFByb3h5fHx0LmZpbGVVcGxvYWRQcm94eXx8dm9pZCAwfTt0aGlzLl9tPW5ldyBRdShuKSx0aGlzLl9zYWZldHlDYWxsYmFja0ZhY3Rvcnk9bmV3ICR1KHRoaXMuX20pfXJldHVybiBhKGUsW3trZXk6XCJvbkVycm9yXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fbS5vbkVycm9yKGUpfX0se2tleTpcImxvZ2luXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX20ubG9naW4oKSx0aGlzLl9nZXRNb2R1bGUoUm4pLmxvZ2luKGUpfX0se2tleTpcImxvZ291dFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKFJuKS5sb2dvdXQoKS50aGVuKChmdW5jdGlvbih0KXtyZXR1cm4gZS5fbS5yZXNldCgpLHR9KSl9fSx7a2V5OlwiaXNSZWFkeVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uaXNSZWFkeSgpfX0se2tleTpcImlzSW50bFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX20uaXNJbnRsKCl9fSx7a2V5OlwiZ2V0Tm90UmVhZHlSZWFzb25cIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9tLmdldE5vdFJlYWR5UmVhc29uKCl9fSx7a2V5OlwiZ2V0RXJyb3JNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB0aGlzLl9tLmdldEVycm9yTWVzc2FnZShlLHQsbil9fSx7a2V5OlwiX2dldE1vZHVsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tLmdldE1vZHVsZShlKX19LHtrZXk6XCJkZXN0cm95XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3JldHVybiB0aGlzLmxvZ291dCgpLmZpbmFsbHkoKGZ1bmN0aW9uKCl7ZS5fbS5zdG9wVGltZXIoKSxlLl9nZXRNb2R1bGUoUW4pLnRlcm1pbmF0ZSgpLGUuX2dldE1vZHVsZShKbikuZGVhbGxvYygpO3ZhciB0PWUuX20uZ2V0T3V0ZXJFbWl0dGVySW5zdGFuY2UoKSxuPWUuX2dldE1vZHVsZSh4bik7dC5lbWl0KGsuU0RLX0RFU1RST1kse1NES0FwcElEOm4uZ2V0U0RLQXBwSUQoKX0pfSkpfX0se2tleTpcIm9uXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe1ZlLmQoXCJvblwiLFwiZXZlbnROYW1lOlwiLmNvbmNhdChlKSksdGhpcy5fbS5nZXRPdXRlckVtaXR0ZXJJbnN0YW5jZSgpLm9uKGUsdGhpcy5fc2FmZXR5Q2FsbGJhY2tGYWN0b3J5LmRlZmVuc2UoZSx0LG4pLG4pfX0se2tleTpcIm9uY2VcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7VmUuZChcIm9uY2VcIixcImV2ZW50TmFtZTpcIi5jb25jYXQoZSkpLHRoaXMuX20uZ2V0T3V0ZXJFbWl0dGVySW5zdGFuY2UoKS5vbmNlKGUsdGhpcy5fc2FmZXR5Q2FsbGJhY2tGYWN0b3J5LmRlZmVuc2VPbmNlKGUsdCxuKSxufHx0aGlzKX19LHtrZXk6XCJvZmZcIix2YWx1ZTpmdW5jdGlvbihlLHQsbixvKXtWZS5kKFwib2ZmXCIsXCJldmVudE5hbWU6XCIuY29uY2F0KGUpKTt2YXIgcz10aGlzLl9zYWZldHlDYWxsYmFja0ZhY3RvcnkuZmluZChlLHQpO251bGwhPT1zJiYodGhpcy5fbS5nZXRPdXRlckVtaXR0ZXJJbnN0YW5jZSgpLm9mZihlLHMsbixvKSx0aGlzLl9zYWZldHlDYWxsYmFja0ZhY3RvcnkuZGVsZXRlKGUsdCkpfX0se2tleTpcInJlZ2lzdGVyUGx1Z2luXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aXQoZVtcInRpbS1vZmZsaW5lLXB1c2gtcGx1Z2luXCJdKT90aGlzLl9nZXRNb2R1bGUoWW4pLnJlZ2lzdGVyUGx1Z2luKGUpOnRoaXMuX2dldE1vZHVsZShubykucmVnaXN0ZXJQbHVnaW4oZSl9fSx7a2V5Olwic2V0TG9nTGV2ZWxcIix2YWx1ZTpmdW5jdGlvbihlKXtpZihlPD0wKXt2YXIgdD10aGlzLmdldEVycm9yTWVzc2FnZShcIlRJTV9BU0NJSV9BUlRcIik7dCYmY29uc29sZS5sb2codCk7dmFyIG49dGhpcy5nZXRFcnJvck1lc3NhZ2UoXCJBUElfUkVGRVJcIik7aWYobil7S3QoKT9jb25zb2xlLmxvZyhcIiVjIFwiLmNvbmNhdChcIklNIFNESyBBUEkgLT5cIixcIiAlY1wiKSxcImJhY2tncm91bmQ6I2ZmOWQwMDsgcGFkZGluZzoxcHg7IGJvcmRlci1yYWRpdXM6M3B4OyBjb2xvcjogI2ZmZlwiLFwiYmFja2dyb3VuZDp0cmFuc3BhcmVudFwiLG4pOmNvbnNvbGUubG9nKFwiSU0gU0RLIEFQSSAtPlwiLG4pfXZhciBvPXRoaXMuZ2V0RXJyb3JNZXNzYWdlKFwiRE9DU19HVUlERVwiKTtvJiZjb25zb2xlLmxvZyhvKX1WZS5zZXRMZXZlbChlKX19LHtrZXk6XCJjcmVhdGVUZXh0TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoTm4pLmNyZWF0ZVRleHRNZXNzYWdlKGUpfX0se2tleTpcImNyZWF0ZVRleHRBdE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS5jcmVhdGVUZXh0TWVzc2FnZShlKX19LHtrZXk6XCJjcmVhdGVJbWFnZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS5jcmVhdGVJbWFnZU1lc3NhZ2UoZSl9fSx7a2V5OlwiY3JlYXRlQXVkaW9NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShObikuY3JlYXRlQXVkaW9NZXNzYWdlKGUpfX0se2tleTpcImNyZWF0ZVZpZGVvTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoTm4pLmNyZWF0ZVZpZGVvTWVzc2FnZShlKX19LHtrZXk6XCJjcmVhdGVDdXN0b21NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShObikuY3JlYXRlQ3VzdG9tTWVzc2FnZShlKX19LHtrZXk6XCJjcmVhdGVGYWNlTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoTm4pLmNyZWF0ZUZhY2VNZXNzYWdlKGUpfX0se2tleTpcImNyZWF0ZUZpbGVNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShObikuY3JlYXRlRmlsZU1lc3NhZ2UoZSl9fSx7a2V5OlwiY3JlYXRlTG9jYXRpb25NZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShObikuY3JlYXRlTG9jYXRpb25NZXNzYWdlKGUpfX0se2tleTpcImNyZWF0ZU1lcmdlck1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS5jcmVhdGVNZXJnZXJNZXNzYWdlKGUpfX0se2tleTpcImRvd25sb2FkTWVyZ2VyTWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGUhPT1FLk1TR19NRVJHRVI/WmEoe2NvZGU6aGEuTUVTU0FHRV9NRVJHRVJfVFlQRV9JTlZBTElEfSk6enQoZS5wYXlsb2FkLmRvd25sb2FkS2V5KT9aYSh7Y29kZTpoYS5NRVNTQUdFX01FUkdFUl9LRVlfSU5WQUxJRH0pOnRoaXMuX2dldE1vZHVsZShObikuZG93bmxvYWRNZXJnZXJNZXNzYWdlKGUpLmNhdGNoKChmdW5jdGlvbihlKXtyZXR1cm4gWmEoe2NvZGU6aGEuTUVTU0FHRV9NRVJHRVJfRE9XTkxPQURfRkFJTH0pfSkpfX0se2tleTpcImNyZWF0ZUZvcndhcmRNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShObikuY3JlYXRlRm9yd2FyZE1lc3NhZ2UoZSl9fSx7a2V5Olwic2VuZE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiBlIGluc3RhbmNlb2YgV2E/dGhpcy5fZ2V0TW9kdWxlKE5uKS5zZW5kTWVzc2FnZUluc3RhbmNlKGUsdCk6WmEoe2NvZGU6aGEuTUVTU0FHRV9TRU5EX05FRURfTUVTU0FHRV9JTlNUQU5DRX0pfX0se2tleTpcImNhbGxFeHBlcmltZW50YWxBUElcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVyblwic2VuZENvbWJvTWVzc2FnZVwiPT09ZT90aGlzLl9nZXRNb2R1bGUoYW8pLnNlbmRNZXNzYWdlKHQpOlwiaGFuZGxlR3JvdXBJbnZpdGF0aW9uXCI9PT1lP3RoaXMuX2dldE1vZHVsZShQbikuaGFuZGxlR3JvdXBJbnZpdGF0aW9uKHQpOlwiaXNDb21tZXJjaWFsQWJpbGl0eUVuYWJsZWRcIj09PWU/dGhpcy5fZ2V0TW9kdWxlKHRvKS5pc0ZlYXR1cmVFbmFibGVkKHQpOlwiaXNJbnRsXCI9PT1lP3RoaXMuaXNJbnRsKCk6XCJzZW5kVFJUQ0N1c3RvbURhdGFcIj09PWU/dGhpcy5fZ2V0TW9kdWxlKHNvKS5zZW5kVFJUQ0N1c3RvbURhdGEodCk6XCJnZXRUaW1lcklEXCI9PT1lP3RoaXMuX20uZ2V0VGltZXJJRCgpOlwiZ2V0UG9sbGluZ1RpbWVySURcIj09PWU/dGhpcy5fbS5nZXRQb2xsaW5nVGltZXJJRCh0KTpaYSh7Y29kZTpoYS5JTlZBTElEX09QRVJBVElPTn0pfX0se2tleTpcInJldm9rZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS5yZXZva2VNZXNzYWdlKGUpfX0se2tleTpcInJlc2VuZE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS5yZXNlbmRNZXNzYWdlKGUpfX0se2tleTpcImRlbGV0ZU1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS5kZWxldGVNZXNzYWdlKGUpfX0se2tleTpcInRyYW5zbGF0ZVRleHRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE5uKS50cmFuc2xhdGVUZXh0KGUpfX0se2tleTpcInNldE1lc3NhZ2VFeHRlbnNpb25zXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKE9uKS5zZXRNZXNzYWdlRXh0ZW5zaW9ucyhlLHQpfX0se2tleTpcImdldE1lc3NhZ2VFeHRlbnNpb25zXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShPbikuZ2V0TWVzc2FnZUV4dGVuc2lvbnMoZSl9fSx7a2V5OlwiZGVsZXRlTWVzc2FnZUV4dGVuc2lvbnNcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoT24pLmRlbGV0ZU1lc3NhZ2VFeHRlbnNpb25zKGUsdCl9fSx7a2V5OlwibW9kaWZ5TWVzc2FnZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoTm4pLm1vZGlmeVJlbW90ZU1lc3NhZ2UoZSl9fSx7a2V5OlwiZ2V0TWVzc2FnZUxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5nZXRNZXNzYWdlTGlzdChlKX19LHtrZXk6XCJnZXRNZXNzYWdlTGlzdEhvcHBpbmdcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5nZXRNZXNzYWdlTGlzdEhvcHBpbmcoZSl9fSx7a2V5Olwic2VuZE1lc3NhZ2VSZWFkUmVjZWlwdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUocW4pLnNlbmRSZWFkUmVjZWlwdChlKX19LHtrZXk6XCJnZXRNZXNzYWdlUmVhZFJlY2VpcHRMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShxbikuZ2V0UmVhZFJlY2VpcHRMaXN0KGUpfX0se2tleTpcImdldEdyb3VwTWVzc2FnZVJlYWRNZW1iZXJMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZ2V0UmVhZFJlY2VpcHREZXRhaWwoZSl9fSx7a2V5OlwiZmluZE1lc3NhZ2VcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5maW5kTWVzc2FnZShlKX19LHtrZXk6XCJzZXRNZXNzYWdlUmVhZFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUocW4pLnNldE1lc3NhZ2VSZWFkKGUpfX0se2tleTpcImdldENvbnZlcnNhdGlvbkxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5nZXRDb252ZXJzYXRpb25MaXN0KGUpfX0se2tleTpcImdldENvbnZlcnNhdGlvblByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5nZXRDb252ZXJzYXRpb25Qcm9maWxlKGUpfX0se2tleTpcImRlbGV0ZUNvbnZlcnNhdGlvblwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUocW4pLmRlbGV0ZUNvbnZlcnNhdGlvbihlKX19LHtrZXk6XCJjbGVhckhpc3RvcnlNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShxbikuY2xlYXJIaXN0b3J5TWVzc2FnZShlKX19LHtrZXk6XCJwaW5Db252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5waW5Db252ZXJzYXRpb24oZSl9fSx7a2V5Olwic2V0QWxsTWVzc2FnZVJlYWRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5zZXRBbGxNZXNzYWdlUmVhZChlKX19LHtrZXk6XCJzZXRNZXNzYWdlUmVtaW5kVHlwZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUocW4pLnNldE1lc3NhZ2VSZW1pbmRUeXBlKGUpfX0se2tleTpcImdldFRvdGFsVW5yZWFkTWVzc2FnZUNvdW50XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5nZXRUb3RhbFVucmVhZE1lc3NhZ2VDb3VudCgpfX0se2tleTpcInNldENvbnZlcnNhdGlvbkN1c3RvbURhdGFcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5zZXRDb252ZXJzYXRpb25DdXN0b21EYXRhKGUpfX0se2tleTpcIm1hcmtDb252ZXJzYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5tYXJrQ29udmVyc2F0aW9uKGUpfX0se2tleTpcImdldENvbnZlcnNhdGlvbkdyb3VwTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShxbikuZ2V0Q29udmVyc2F0aW9uR3JvdXBMaXN0KCl9fSx7a2V5OlwiY3JlYXRlQ29udmVyc2F0aW9uR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5jcmVhdGVDb252ZXJzYXRpb25Hcm91cChlKX19LHtrZXk6XCJkZWxldGVDb252ZXJzYXRpb25Hcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUocW4pLmRlbGV0ZUNvbnZlcnNhdGlvbkdyb3VwKGUpfX0se2tleTpcInJlbmFtZUNvbnZlcnNhdGlvbkdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShxbikucmVuYW1lQ29udmVyc2F0aW9uR3JvdXAoZSl9fSx7a2V5OlwiYWRkQ29udmVyc2F0aW9uc1RvR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHFuKS5hZGRDb252ZXJzYXRpb25zVG9Hcm91cChlKX19LHtrZXk6XCJkZWxldGVDb252ZXJzYXRpb25zRnJvbUdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShxbikuZGVsZXRlQ29udmVyc2F0aW9uc0Zyb21Hcm91cChlKX19LHtrZXk6XCJnZXRNeVByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoR24pLmdldE15UHJvZmlsZSgpfX0se2tleTpcImdldFVzZXJQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShHbikuZ2V0VXNlclByb2ZpbGUoZSl9fSx7a2V5OlwidXBkYXRlTXlQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShHbikudXBkYXRlTXlQcm9maWxlKGUpfX0se2tleTpcImdldEJsYWNrbGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShHbikuZ2V0TG9jYWxCbGFja2xpc3QoKX19LHtrZXk6XCJhZGRUb0JsYWNrbGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoR24pLmFkZEJsYWNrbGlzdChlKX19LHtrZXk6XCJyZW1vdmVGcm9tQmxhY2tsaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShHbikuZGVsZXRlQmxhY2tsaXN0KGUpfX0se2tleTpcInNldFNlbGZTdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKEduKS5zZXRTZWxmU3RhdHVzKGUpfX0se2tleTpcImdldFVzZXJTdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKEduKS5nZXRVc2VyU3RhdHVzKGUpfX0se2tleTpcInN1YnNjcmliZVVzZXJTdGF0dXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKEduKS5zdWJzY3JpYmVVc2VyU3RhdHVzKGUpfX0se2tleTpcInVuc3Vic2NyaWJlVXNlclN0YXR1c1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoR24pLnVuc3Vic2NyaWJlVXNlclN0YXR1cyhlKX19LHtrZXk6XCJnZXRGcmllbmRMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiBlP2UuZ2V0TG9jYWxGcmllbmRMaXN0KCk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5OlwiYWRkRnJpZW5kXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0TW9kdWxlKGJuKTtyZXR1cm4gdD90LmFkZEZyaWVuZChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJkZWxldGVGcmllbmRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiB0P3QuZGVsZXRlRnJpZW5kKGUpOlphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX01PRFVMRX0pfX0se2tleTpcImNoZWNrRnJpZW5kXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0TW9kdWxlKGJuKTtyZXR1cm4gdD90LmNoZWNrRnJpZW5kKGUpOlphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX01PRFVMRX0pfX0se2tleTpcImdldEZyaWVuZFByb2ZpbGVcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiB0P3QuZ2V0RnJpZW5kUHJvZmlsZShlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJ1cGRhdGVGcmllbmRcIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiB0P3QudXBkYXRlRnJpZW5kKGUpOlphKHtjb2RlOmhhLkNBTk5PVF9GSU5EX01PRFVMRX0pfX0se2tleTpcImdldEZyaWVuZEFwcGxpY2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZ2V0TW9kdWxlKGJuKTtyZXR1cm4gZT9lLmdldExvY2FsRnJpZW5kQXBwbGljYXRpb25MaXN0KCk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5OlwiYWNjZXB0RnJpZW5kQXBwbGljYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiB0P3QuYWNjZXB0RnJpZW5kQXBwbGljYXRpb24oZSk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5OlwicmVmdXNlRnJpZW5kQXBwbGljYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiB0P3QucmVmdXNlRnJpZW5kQXBwbGljYXRpb24oZSk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5OlwiZGVsZXRlRnJpZW5kQXBwbGljYXRpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiB0P3QuZGVsZXRlRnJpZW5kQXBwbGljYXRpb24oZSk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5Olwic2V0RnJpZW5kQXBwbGljYXRpb25SZWFkXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiBlP2Uuc2V0RnJpZW5kQXBwbGljYXRpb25SZWFkKCk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5OlwiZ2V0RnJpZW5kR3JvdXBMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9nZXRNb2R1bGUoYm4pO3JldHVybiBlP2UuZ2V0TG9jYWxGcmllbmRHcm91cExpc3QoKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJjcmVhdGVGcmllbmRHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dldE1vZHVsZShibik7cmV0dXJuIHQ/dC5jcmVhdGVGcmllbmRHcm91cChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJkZWxldGVGcmllbmRHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dldE1vZHVsZShibik7cmV0dXJuIHQ/dC5kZWxldGVGcmllbmRHcm91cChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJhZGRUb0ZyaWVuZEdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0TW9kdWxlKGJuKTtyZXR1cm4gdD90LmFkZFRvRnJpZW5kR3JvdXAoZSk6WmEoe2NvZGU6aGEuQ0FOTk9UX0ZJTkRfTU9EVUxFfSl9fSx7a2V5OlwicmVtb3ZlRnJvbUZyaWVuZEdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5fZ2V0TW9kdWxlKGJuKTtyZXR1cm4gdD90LnJlbW92ZUZyb21GcmllbmRHcm91cChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJyZW5hbWVGcmllbmRHcm91cFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2dldE1vZHVsZShibik7cmV0dXJuIHQ/dC5yZW5hbWVGcmllbmRHcm91cChlKTpaYSh7Y29kZTpoYS5DQU5OT1RfRklORF9NT0RVTEV9KX19LHtrZXk6XCJnZXRHcm91cExpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKFBuKS5nZXRHcm91cExpc3QoZSl9fSx7a2V5OlwiZ2V0R3JvdXBQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZ2V0R3JvdXBQcm9maWxlKGUpfX0se2tleTpcImNyZWF0ZUdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuY3JlYXRlR3JvdXAoZSl9fSx7a2V5OlwiZGlzbWlzc0dyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZGlzbWlzc0dyb3VwKGUpfX0se2tleTpcInVwZGF0ZUdyb3VwUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoUG4pLnVwZGF0ZUdyb3VwUHJvZmlsZShlKX19LHtrZXk6XCJqb2luR3JvdXBcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKFBuKS5qb2luR3JvdXAoZSl9fSx7a2V5OlwicXVpdEdyb3VwXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikucXVpdEdyb3VwKGUpfX0se2tleTpcInNlYXJjaEdyb3VwQnlJRFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoUG4pLnNlYXJjaEdyb3VwQnlJRChlKX19LHtrZXk6XCJnZXRHcm91cE9ubGluZU1lbWJlckNvdW50XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZ2V0R3JvdXBPbmxpbmVNZW1iZXJDb3VudChlKX19LHtrZXk6XCJjaGFuZ2VHcm91cE93bmVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuY2hhbmdlR3JvdXBPd25lcihlKX19LHtrZXk6XCJnZXRHcm91cEFwcGxpY2F0aW9uTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZ2V0R3JvdXBBcHBsaWNhdGlvbkxpc3QoKX19LHtrZXk6XCJoYW5kbGVHcm91cEFwcGxpY2F0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuaGFuZGxlR3JvdXBBcHBsaWNhdGlvbihlKX19LHtrZXk6XCJpbml0R3JvdXBBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuaW5pdEdyb3VwQXR0cmlidXRlcyhlKX19LHtrZXk6XCJzZXRHcm91cEF0dHJpYnV0ZXNcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKFBuKS5zZXRHcm91cEF0dHJpYnV0ZXMoZSl9fSx7a2V5OlwiZGVsZXRlR3JvdXBBdHRyaWJ1dGVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZGVsZXRlR3JvdXBBdHRyaWJ1dGVzKGUpfX0se2tleTpcImdldEdyb3VwQXR0cmlidXRlc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoUG4pLmdldEdyb3VwQXR0cmlidXRlcyhlKX19LHtrZXk6XCJzZXRHcm91cENvdW50ZXJzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuc2V0R3JvdXBDb3VudGVycyhlKX19LHtrZXk6XCJpbmNyZWFzZUdyb3VwQ291bnRlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoUG4pLmluY3JlYXNlR3JvdXBDb3VudGVyKGUpfX0se2tleTpcImRlY3JlYXNlR3JvdXBDb3VudGVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShQbikuZGVjcmVhc2VHcm91cENvdW50ZXIoZSl9fSx7a2V5OlwiZ2V0R3JvdXBDb3VudGVyc1wiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoUG4pLmdldEdyb3VwQ291bnRlcnMoZSl9fSx7a2V5OlwiZ2V0R3JvdXBNZW1iZXJMaXN0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZSh3bikuZ2V0R3JvdXBNZW1iZXJMaXN0KGUpfX0se2tleTpcImdldEdyb3VwTWVtYmVyUHJvZmlsZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUod24pLmdldEdyb3VwTWVtYmVyUHJvZmlsZShlKX19LHtrZXk6XCJhZGRHcm91cE1lbWJlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUod24pLmFkZEdyb3VwTWVtYmVyKGUpfX0se2tleTpcImRlbGV0ZUdyb3VwTWVtYmVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZSh3bikuZGVsZXRlR3JvdXBNZW1iZXIoZSl9fSx7a2V5Olwic2V0R3JvdXBNZW1iZXJNdXRlVGltZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUod24pLnNldEdyb3VwTWVtYmVyTXV0ZVRpbWUoZSl9fSx7a2V5Olwic2V0R3JvdXBNZW1iZXJSb2xlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZSh3bikuc2V0R3JvdXBNZW1iZXJSb2xlKGUpfX0se2tleTpcInNldEdyb3VwTWVtYmVyTmFtZUNhcmRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHduKS5zZXRHcm91cE1lbWJlck5hbWVDYXJkKGUpfX0se2tleTpcInNldEdyb3VwTWVtYmVyQ3VzdG9tRmllbGRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHduKS5zZXRHcm91cE1lbWJlckN1c3RvbUZpZWxkKGUpfX0se2tleTpcIm1hcmtHcm91cE1lbWJlckxpc3RcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKHduKS5tYXJrR3JvdXBNZW1iZXJMaXN0KGUpfX0se2tleTpcImdldEpvaW5lZENvbW11bml0eUxpc3RcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoRm4pLmdldEpvaW5lZENvbW11bml0eUxpc3QoKX19LHtrZXk6XCJjcmVhdGVUb3BpY0luQ29tbXVuaXR5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShGbikuY3JlYXRlVG9waWNJbkNvbW11bml0eShlKX19LHtrZXk6XCJkZWxldGVUb3BpY0Zyb21Db21tdW5pdHlcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZ2V0TW9kdWxlKEZuKS5kZWxldGVUb3BpY0Zyb21Db21tdW5pdHkoZSl9fSx7a2V5OlwidXBkYXRlVG9waWNQcm9maWxlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2dldE1vZHVsZShGbikudXBkYXRlVG9waWNQcm9maWxlKGUpfX0se2tleTpcImdldFRvcGljTGlzdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9nZXRNb2R1bGUoRm4pLmdldFRvcGljTGlzdChlKX19XSksZX0oKSx0Yz17bG9naW46MSxsb2dvdXQ6MSxkZXN0cm95OjEsb246MSxvZmY6MSxyZWFkeToxLHNldExvZ0xldmVsOjEsam9pbkdyb3VwOjEscXVpdEdyb3VwOjEscmVnaXN0ZXJQbHVnaW46MSxnZXRHcm91cE9ubGluZU1lbWJlckNvdW50OjF9O2Z1bmN0aW9uIG5jKGUsdCl7aWYoZS5pc1JlYWR5KCl8fDE9PT10Y1t0XSlyZXR1cm4hMDt2YXIgbj1lLmdldE5vdFJlYWR5UmVhc29uKCksbz17Y29kZTpuLG1lc3NhZ2U6XCJcIi5jb25jYXQoZS5nZXRFcnJvck1lc3NhZ2UobiksXCIgfCBcIikuY29uY2F0KHQsXCIgfCBcIikuY29uY2F0KGUuZ2V0RXJyb3JNZXNzYWdlKGhhLlNES19JU19OT1RfUkVBRFkpKX07cmV0dXJuIGUub25FcnJvcihvKSxvfXZhciBvYz17fSxzYz17fTtyZXR1cm4gc2MuY3JlYXRlPWZ1bmN0aW9uKGUpe3ZhciBuPTAsbz1lLlNES0FwcElEO2lmKGV0KG8pKW49bztlbHNlIGlmKG49cGFyc2VJbnQobyksaXNOYU4obykpcmV0dXJuIFZlLmUoXCJcIi5jb25jYXQoXCJUSU0uY3JlYXRlXCIsXCIgZmFpbGVkLiBGYWlsZWQgdG8gcGFyc2UgdGhlIFNES0FwcElELCBwbGVhc2UgY2hlY2sgdGhlIGFyZ3VtZW50c1wiKSksbnVsbDtpZihuJiZvY1tuXSlyZXR1cm4gb2Nbbl07VmUubChcIlwiLmNvbmNhdChcIlRJTS5jcmVhdGVcIikpO3ZhciBzPW5ldyBlYyh0KHQoe30sZSkse30se1NES0FwcElEOm59KSk7cy5vbihrLlNES19ERVNUUk9ZLChmdW5jdGlvbihlKXtvY1tlLmRhdGEuU0RLQXBwSURdPW51bGwsZGVsZXRlIG9jW2UuZGF0YS5TREtBcHBJRF19KSk7dmFyIGE9ZnVuY3Rpb24oZSl7dmFyIHQ9T2JqZWN0LmNyZWF0ZShudWxsKTtyZXR1cm4gT2JqZWN0LmtleXMoQW4pLmZvckVhY2goKGZ1bmN0aW9uKG4pe2lmKGVbbl0pe3ZhciBvPW5ldyBTO3Rbbl09ZnVuY3Rpb24oKXt2YXIgdD1BcnJheS5mcm9tKGFyZ3VtZW50cyk7cmV0dXJuIG8udXNlKChmdW5jdGlvbih0LG8pe3ZhciBzPW5jKGUsbik7cmV0dXJuITA9PT1zP28oKTpaYShzKX0pKS51c2UoKGZ1bmN0aW9uKGUsdCl7aWYoITA9PT1KdChlLExuW25dLG4pKXJldHVybiB0KCl9KSkudXNlKChmdW5jdGlvbih0LG8pe3JldHVybiBlW25dLmFwcGx5KGUsdCl9KSksby5ydW4odCl9fX0pKSx0fShzKTtyZXR1cm4gb2Nbbl09YSxMbi5ob29rR2V0QVBJVGlwcyhzLmdldEVycm9yTWVzc2FnZS5iaW5kKHMpKSxWZS5sKFwiXCIuY29uY2F0KFwiVElNLmNyZWF0ZVwiLFwiIG9rXCIpKSxhfSxzYy5UWVBFUz1FLHNjLkVWRU5UPWssc2MuVkVSU0lPTj1cIjIuMjcuNlwiLFZlLmwoXCJUSU0uVkVSU0lPTjpcIi5jb25jYXQoc2MuVkVSU0lPTikpLHNjfSkpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/tim-js-sdk/tim-js.js\n");

/***/ })

}]);